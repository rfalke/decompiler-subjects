//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <assert.h>
#include <ctype.h>
#include <errno.h>
#include <grp.h>
#include <iconv.h>
#include <langinfo.h>
#include <libintl.h>
#include <locale.h>
#include <netdb.h>
#include <pwd.h>
#include <signal.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stropts.h>
#include <sys/select.h>
#include <sys/stat.h>
#include <sys/syslog.h>
#include <sys/time.h>
#include <sys/wait.h>
#include <termios.h>
#include <time.h>
#include <unistd.h>

// ---------------- Integer Types Definitions -----------------

typedef int8_t int3_t;

// ----------------- Float Types Definitions ------------------

typedef float float32_t;
typedef double float64_t;
typedef long double float80_t;

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

struct _TYPEDEF_fd_set {
    int32_t e0[1];
};

struct _TYPEDEF_sigset_t {
    int32_t e0[1];
};

struct addrinfo {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    struct sockaddr * e5;
    char * e6;
    struct addrinfo * e7;
};

struct group {
    char * e0;
    char * e1;
    int32_t e2;
    char ** e3;
};

struct hostent {
    char * e0;
    char ** e1;
    int32_t e2;
    int32_t e3;
    char ** e4;
};

struct passwd {
    char * e0;
    char * e1;
    int32_t e2;
    int32_t e3;
    char * e4;
    char * e5;
    char * e6;
};

struct sigaction {
    void (*e0)(int32_t);
    int32_t e1;
    void (*e2)();
    struct _TYPEDEF_sigset_t e3;
};

struct sockaddr {
    int32_t e0;
    char e1[14];
};

struct stat64 {
    int64_t e0;
    int64_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int64_t e6;
    int64_t e7;
    int64_t e8;
    int32_t e9;
    int32_t e10;
    int64_t e11;
    int32_t e12;
    int32_t e13;
    int32_t e14;
    int32_t e15;
    int32_t e16;
    int32_t e17;
    int32_t e18;
    int32_t e19;
};

struct termios {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    char e4;
    char e5[1];
};

struct timeval {
    int32_t e0;
    int32_t e1;
};

// ------------------- Function Prototypes --------------------

int32_t __divdi3(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t __i686_get_pc_thunk_bx(int32_t a1);
char * actual_filename(char * cfg_filename, char * parent_filename, char * dft_filename);
int32_t add_it(char * text, int32_t len);
void add_item_to_list(char * buffer, int32_t ** list_ptr, int32_t special);
void add_to_reject_list(char * target);
void add_to_table(char * target);
void add_to_traverse_list(char * fname, char * prev_link_name);
void add_trusted(char * str, int32_t type);
void addlbl(char * text);
void adjust_search_result(int32_t * doc, int32_t tentative_result, int32_t start_line);
int32_t * ALLOC_IN_POOL(int32_t ** ppoolptr, int32_t request);
char anchor_has_target(int32_t * a, char * target);
char anchor_is_numbered(int32_t * Anchor_ptr);
void append_close_tag(char * tagname, int32_t ** head, int32_t ** tail);
void append_open_tag(char * tagname, char * classname, int32_t ** head, int32_t ** tail);
int32_t are_different(int32_t * doc1, int32_t * doc2);
int32_t are_identical(int32_t * doc, int32_t * doc1);
int32_t arg_eqs_parse(char * a, char * b, char ** c);
char * attr_to_string(uint32_t code);
void BeginInternalPage(struct _IO_FILE * fp0, char * Title, char * HelpURL);
int32_t best_reverse_keymap(int32_t lac);
int32_t boolean_choice(int32_t cur_choice, int32_t line, int32_t column, char ** choices);
int32_t * break_data(int32_t * data);
char * build_command(char * line, char * dirname, char * arg);
int32_t BuildCommand(int32_t * cmd, char * controlstring, char * TmpFileName, char * params);
void cache_tag_styles(void);
char cannot_stat(char * name);
void cannot_transcode(char * had_warning, char * target_csname);
int32_t cell2char(char * s, uint32_t cells);
int32_t change_form_link(int32_t cur, int32_t * newdoc2, char * refresh_screen, char use_last_tfpos, char immediate_submit);
int32_t change_form_link_ex(int32_t cur, int32_t * newdoc2, char * refresh_screen, char use_last_tfpos, char immediate_submit, char redraw_only);
void change_sug_filename(char * fname);
int32_t check_color(char * color, int32_t the_default);
int32_t check_form_specialchars(char * value);
int32_t check_if_base64_needed(int32_t submit_method, int32_t * data);
char * check_if_write_lynxrc(char ** table);
int32_t check_next_target_in_links(int32_t * cur, char * target);
int32_t check_prev_target_in_links(int32_t * cur, char * target);
char * CheckDir(char * path);
void clean_extra_history(void);
char * Cleanse(char * s);
void cleanup(void);
void cleanup_files(void);
void cleanup_sig(int32_t sig);
void clear_tags(void);
int32_t clip_grab(void);
void comma_append(char ** dst, char * src);
char compare_type(char * tst, char * cmp, int32_t len);
void con_clear_unimap(int32_t fordefault);
void con_clear_unimap_str(int32_t fordefault);
int32_t con_insert_unipair(uint16_t unicode, int16_t fontpos, int32_t fordefault);
int32_t con_insert_unipair_str(uint16_t unicode, char * replace_str, int32_t fordefault);
void con_set_default_unimap(void);
char confirm_by_pages(char * prompt, uint32_t lines_in_file, int32_t lines_per_page);
char confirm_post_resub(char * address, char * title, int32_t if_imgmap, int32_t if_file);
int32_t conv_uni_to_pc(int32_t ucs, int32_t usedefault);
int32_t conv_uni_to_str(char * outbuf, int32_t buflen, int32_t ucs, int32_t usedefault);
char convert_explorer(char * address);
char * convert_mosaic_bookmark_file(char * filename_buffer);
char * convert_to_base64(char * src, int32_t len);
void convert_to_spaces(char * string, char condense);
void cookie_domain_flag_set(char * domainstr, int32_t flag);
void copy_address(int32_t * dst, int32_t * src);
int32_t create_directory(char * current_location);
int32_t create_file(char * current_location);
char * Current_Dir(char * pathname);
void curses_style(int32_t style, int32_t dir);
void curses_w_style(int32_t * win, int32_t style, int32_t dir);
int32_t decode_mono_code(int32_t mono_code);
void deleteLinks(int32_t * me);
char DidWrap(int32_t y0, int32_t x0);
char dir_has_same_owner(int32_t * info, int32_t owner);
char * DirectoryOf(char * pathname);
int32_t dired_options(int32_t * doc, char ** newfile);
int32_t display_line(int32_t * line, int32_t * text, int32_t scrline, char * target);
void display_page(int32_t * text, int32_t line_number, char * target);
void display_scrollbar(int32_t * text);
void display_title(int32_t * text);
int32_t do_change_link(void);
void do_check_goto_URL(char * user_input_buffer, char ** old_user_input, char * force_load);
char do_check_recall(int32_t ch, char * user_input_buffer, char ** old_user_input, int32_t URLTotal, int32_t * URLNum, int32_t recall, char * FirstURLRecall);
void do_cleanup_after_delete(void);
void do_read_cfg(char * cfg_filename, char * parent_filename, uint32_t nesting_level, struct _IO_FILE * fp0, char (*allowed)[207]);
int32_t do_www_search(int32_t * doc);
int32_t DontCheck(void);
int32_t DoTraversal(int32_t c, char * crawl_ok);
void draw_option(int32_t * win, int32_t entry, int32_t width, char reversed, int32_t num_choices, int32_t number, char * value);
void dt_Number(struct _IO_FILE * fp0, char * label, int32_t number, char * units);
void dt_String(struct _IO_FILE * fp, char * label, char * value);
int32_t dumbterm(char * terminal2);
void dump_hostent(char * msgprefix, struct hostent * phost);
void dump_traversal_history(void);
void edit_bookmarks(void);
int32_t edit_current_file(char * newfile, int32_t cur, int32_t lineno2);
void edit_temporary_file(char * filename, char * position, char * message);
int32_t EditBinding(uint32_t xlkc);
char editor_can_position(void);
void ena_csi(char flag);
int32_t encode_color_attr(uint32_t color_attr);
void EndInternalPage(struct _IO_FILE * fp0);
char * escape_or_quote_name(char * name, uint32_t quoting, char * MultipartContentType);
char * escape_or_quote_value(char * value, uint32_t quoting);
char * EUC_TO_SJIS(char * src, char * dst);
char exec_ok(char * source, char * linktext, int32_t type);
void exit_immediately(int32_t code);
void exit_immediately_with_error_message(int32_t state, char first_file);
void exit_with_perror(char * msg);
int32_t ExitWithError(char * txt);
void explain_keypad_mode(struct _IO_FILE * fp);
void extra_cfg_link(struct _IO_FILE * fp, char * href, char * name);
void extract_body(char ** dst, char * src);
void extract_field(char ** dst, char * src, char * keyword);
void extract_subject(char * dst, char * src);
void failed_init(char * tag, int32_t lexeme);
char failsMailcap(int32_t * pres, int32_t * anchor);
int32_t fancy_mouse(int32_t * win, int32_t row, int32_t * position);
void fill_edited_line(int32_t prompting, uint32_t length, uint32_t ch);
int32_t fill_rehostent(char * rehostent, int32_t rehostentsize, struct hostent * phost);
void final_perror(char * msg, char clean_flag);
int32_t find_best_target_cs(char ** best_csname, int32_t cs_from, char * acceptstring);
int32_t find_cached_style(int32_t cur, int32_t flag);
char * find_colon(char * buffer);
int32_t * find_domain_entry(char * name);
int32_t find_link_near_col(int32_t col, int32_t delta);
char * FindLeadingTilde(char * pathname, char embedded);
int32_t * FindTempfileByFP(struct _IO_FILE * fp);
int32_t * FindTempfileByName(char * name);
int32_t finish_ExtEditForm(int32_t * form_link, int32_t * start_anchor, char * ed_temp, int32_t orig_cnt);
int32_t fix_httplike_urls(int32_t * doc, int32_t type);
char * fmt_keys(int32_t lkc_first, int32_t lkc_second);
int32_t fmt_tempname(char * result, char * prefix, char * suffix);
int32_t follow_link_number(int32_t c, int32_t cur, int32_t * doc, int32_t * num);
int32_t form_getstr(int32_t cur, char use_last_tfpos, char redraw_only);
void form_noviceline(int32_t disabled);
void format(char ** result, char * fmt, char * parm);
char * format_command(char * command, char * param);
void FormatChoiceNum(char * dst, int32_t num_choices, int32_t choice, char * value);
void FormList_delete(int32_t * forms);
void free_address(int32_t * doc);
void free_all_item_lists(void);
void free_colorstylestuff(void);
void free_form_fields(int32_t * input_field);
void free_HTAAGlobals(void);
void free_item_list(int32_t ** ptr);
void free_lynx_cfg(void);
void free_NNTP_AuthInfo(void);
void FreeCachedStyles(void);
void freeCookie(int32_t * co);
char from_hex(char c);
int32_t function_804a784(int32_t a1, int32_t a2);
int32_t function_804a7a4(int32_t * a1, int32_t a2);
int32_t function_804a854(int32_t a1);
int32_t function_804a8b4(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_804a8f4(int32_t a1, int32_t a2);
int32_t function_804a914(int32_t a1, int32_t a2, int32_t a3);
int32_t function_804a934(int32_t a1, int32_t a2);
int32_t function_804a964(void);
int32_t function_804a9c4(void);
int32_t function_804aa84(void);
int32_t function_804aa94(int32_t a1, int32_t a2);
int32_t function_804aab4(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t function_804ab84(int32_t a1);
int32_t function_804ab94(int32_t a1, int32_t a2);
int32_t function_804abb4(void);
int32_t function_804ac04(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7);
int32_t function_804ac24(int32_t a1, int32_t a2);
int32_t function_804ac64(int32_t a1, int32_t a2, int32_t a3);
int32_t function_804aca4(int32_t a1, int32_t * a2, int32_t * a3);
int32_t function_804acb4(int32_t * a1);
int32_t function_804acc4(int32_t a1, int32_t a2);
int32_t function_804ace4(int32_t a1);
int32_t function_804ad84(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t function_804ade4(int32_t a1);
int32_t function_804ae04(int32_t a1, int32_t a2, int32_t a3);
int32_t function_804af04(void);
int32_t function_804af84(void);
int32_t function_804afb4(int32_t a1, int32_t a2, int32_t a3);
int32_t function_804aff4(int32_t a1);
int32_t function_804b034(int32_t a1, int32_t a2);
int32_t function_804b094(int32_t a1, int32_t a2);
int32_t function_804b0e4(void);
int32_t function_804b144(int32_t a1, int32_t * a2, int32_t a3);
int32_t function_804b194(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9);
int32_t function_804b1f4(int32_t * a1, int32_t a2);
int32_t function_804b214(int32_t a1, int32_t a2);
int32_t function_804b264(int32_t a1, int32_t a2, int32_t a3);
int32_t function_804b2a4(int32_t a1);
int32_t function_804b324(int32_t a1, int32_t a2);
int32_t function_804b364(void);
int32_t function_804b394(void);
int32_t function_804b3b4(int32_t a1, int32_t a2);
int32_t function_804b3e4(int32_t a1, int32_t a2);
int32_t function_804b404(int32_t a1, int32_t a2, int32_t a3);
int32_t gen_options(char ** newfile);
char * get_bookmark_filename(char ** URL);
char * get_clip_grab(void);
void get_clip_release(void);
int32_t get_color_pair(int32_t n);
char * get_filename(char * prompt, char * buf, int32_t bufsize);
void get_host_details(void);
int32_t get_mouse_link(void);
int32_t get_physical(char * addr, int32_t * anchor);
int32_t get_popup_number(char * msg, int32_t * c, int32_t * rel);
int32_t * get_prev_anchor(int32_t * a);
float64_t get_trans_q(int32_t cs_from, char * givenmime);
char getBool(char * src);
int32_t GetCachedStyle(int32_t y, int32_t x);
int32_t GetColumn(void);
char * GetCommand(char * s, char ** t);
int32_t getfile(int32_t * doc, int32_t * target);
char * GetFileName(void);
int32_t getLYhndl_byCP(char * prefix, char * codepage);
char GetOptValues(int32_t * table, char * value, int32_t * result);
char GetStdin(char ** buf, char marker);
void goto_line(int32_t nextline);
char * guess_content_type(char * filename);
int32_t half_match(char * trial_type, char * target);
int32_t handle_LYK_ACTIVATE(int32_t * c, int32_t cmd, char * try_internal, char * refresh_screen, char * force_load, int32_t real_cmd);
void handle_LYK_ADD_BOOKMARK(char * refresh_screen, int32_t * old_c, int32_t real_c);
void handle_LYK_CHDIR(void);
void handle_LYK_CLEAR_AUTH(int32_t * old_c, int32_t real_c);
int32_t handle_LYK_COMMAND(char * user_input_buffer);
void handle_LYK_COMMENT(char * refresh_screen, char ** owner_address_p, int32_t * old_c, int32_t real_c);
char handle_LYK_COOKIE_JAR(int32_t * cmd);
void handle_LYK_CREATE(void);
void handle_LYK_DEL_BOOKMARK(char * refresh_screen, int32_t * old_c, int32_t real_c);
void handle_LYK_digit(int32_t c, char * force_load, char * user_input_buffer, int32_t * old_c, int32_t real_c, char * try_internal);
void handle_LYK_DIRED_MENU(char * refresh_screen, int32_t * old_c, int32_t real_c);
void handle_LYK_DOWN_HALF(int32_t * old_c, int32_t real_c);
void handle_LYK_DOWN_LINK(int32_t * follow_col, int32_t * old_c, int32_t real_c);
void handle_LYK_DOWN_TWO(int32_t * old_c, int32_t real_c);
void handle_LYK_DOWN_xxx(int32_t * old_c, int32_t real_c, int32_t scroll_by);
int32_t handle_LYK_DOWNLOAD(int32_t * cmd, int32_t * old_c, int32_t real_c);
int32_t handle_LYK_DWIMEDIT(int32_t * cmd, int32_t * old_c, int32_t real_c);
void handle_LYK_DWIMHELP(char ** cshelpfile);
int32_t handle_LYK_ECGOTO(int32_t * ch, char * user_input_buffer, char ** old_user_input, int32_t * old_c, int32_t real_c);
void handle_LYK_EDIT(int32_t * old_c, int32_t real_c);
void handle_LYK_EDIT_TEXTAREA(char * refresh_screen, int32_t * old_c, int32_t real_c);
int32_t handle_LYK_ELGOTO(int32_t * ch, char * user_input_buffer, char ** old_user_input, int32_t * old_c, int32_t real_c);
void handle_LYK_EXTERN_LINK(char * refresh_screen);
void handle_LYK_EXTERN_PAGE(char * refresh_screen);
char handle_LYK_FASTBACKW_LINK(int32_t * cmd, int32_t * old_c, int32_t real_c);
void handle_LYK_FASTFORW_LINK(int32_t * old_c, int32_t real_c);
void handle_LYK_FIRST_LINK(void);
char handle_LYK_GOTO(int32_t * ch, char * user_input_buffer, char ** old_user_input, int32_t * recall, int32_t * URLTotal, int32_t * URLNum, char * FirstURLRecall, int32_t * old_c, int32_t real_c);
void handle_LYK_GROW_TEXTAREA(char * refresh_screen);
char handle_LYK_HEAD(int32_t * cmd);
void handle_LYK_HELP(char ** cshelpfile);
void handle_LYK_HISTORICAL(void);
char handle_LYK_HISTORY(char ForcePush);
char handle_LYK_IMAGE_TOGGLE(int32_t * cmd);
void handle_LYK_INDEX(int32_t * old_c, int32_t real_c);
void handle_LYK_INDEX_SEARCH(char * force_load, char ForcePush, int32_t * old_c, int32_t real_c);
char handle_LYK_INFO(int32_t * cmd);
char handle_LYK_INLINE_TOGGLE(int32_t * cmd);
void handle_LYK_INSERT_FILE(char * refresh_screen, int32_t * old_c, int32_t real_c);
char handle_LYK_JUMP(int32_t c, char * user_input_buffer, char ** old_user_input, int32_t * recall, char * FirstURLRecall, int32_t * URLNum, int32_t * URLTotal, int32_t * ch, int32_t * old_c, int32_t real_c);
void handle_LYK_KEYMAP(char * vi_keys_flag, char * emacs_keys_flag, int32_t * old_c, int32_t real_c);
void handle_LYK_LAST_LINK(void);
void handle_LYK_LEFT_LINK(void);
char handle_LYK_LINEWRAP_TOGGLE(int32_t * cmd, char * flag);
char handle_LYK_LIST(int32_t * cmd);
void handle_LYK_MAIN_MENU(int32_t * old_c, int32_t real_c);
void handle_LYK_MINIMAL(void);
void handle_LYK_MODIFY(char * refresh_screen);
char handle_LYK_NESTED_TABLES(int32_t * cmd);
void handle_LYK_NEXT_LINK(int32_t c, int32_t * old_c, int32_t real_c);
void handle_LYK_NEXT_PAGE(int32_t * old_c, int32_t real_c);
char handle_LYK_NOCACHE(int32_t * old_c, int32_t real_c);
char handle_LYK_OPTIONS(int32_t * cmd, char * refresh_screen);
void handle_LYK_PREV_LINK(int32_t * arrowup, int32_t * old_c, int32_t real_c);
void handle_LYK_PREV_PAGE(int32_t * old_c, int32_t real_c);
void handle_LYK_PRINT(char * ForcePush, int32_t * old_c, int32_t real_c);
char handle_LYK_QUIT(void);
char handle_LYK_RAW_TOGGLE(int32_t * cmd);
void handle_LYK_RELOAD(int32_t real_cmd);
void handle_LYK_REMOVE(char * refresh_screen);
void handle_LYK_RIGHT_LINK(void);
void handle_LYK_SHELL(char * refresh_screen, int32_t * old_c, int32_t real_c);
void handle_LYK_SHIFT_LEFT(char * flag, int32_t count);
void handle_LYK_SHIFT_RIGHT(char * flag, int32_t count);
void handle_LYK_SOFT_DQUOTES(void);
void handle_LYK_SOURCE(char ** ownerS_address_p);
void handle_LYK_SWITCH_DTD(void);
void handle_LYK_TAG_LINK(void);
void handle_LYK_TOGGLE_HELP(void);
void handle_LYK_TOOLBAR(char * try_internal, char * force_load, int32_t * old_c, int32_t real_c);
void handle_LYK_TRACE_LOG(char * trace_flag_ptr);
void handle_LYK_TRACE_TOGGLE(void);
void handle_LYK_UP_HALF(int32_t * arrowup, int32_t * old_c, int32_t real_c);
void handle_LYK_UP_LINK(int32_t * follow_col, int32_t * arrowup, int32_t * old_c, int32_t real_c);
void handle_LYK_UP_TWO(int32_t * arrowup, int32_t * old_c, int32_t real_c);
void handle_LYK_UP_xxx(int32_t * arrowup, int32_t * old_c, int32_t real_c, int32_t scroll_by);
void handle_LYK_UPLOAD(void);
void handle_LYK_VIEW_BOOKMARK(char * refresh_screen, int32_t * old_c, int32_t real_c);
char handle_LYK_VLINKS(int32_t * cmd, char * newdoc_link_is_absolute);
void handle_LYK_WHEREIS(int32_t cmd, char * refresh_screen);
void handle_NEXT_DOC(void);
int32_t handle_PREV_DOC(int32_t * cmd, int32_t * old_c, int32_t real_c);
int32_t hash_code(char * string);
int32_t hash_code_aggregate_char(unsigned char c, int32_t hash);
int32_t hash_code_aggregate_lower_str(char * string, int32_t hash_was);
int32_t hash_code_lowercase_on_fly(char * string);
int16_t HASH_FUNCTION(char * cp_address);
char have8bit(char * Title);
char havevisible(char * Title);
int32_t header_prompt(char * label, char ** result, uint32_t limit);
char hex(int32_t i);
char historytarget(int32_t * newdoc2);
char * Home_Dir(void);
char * HomeEnv(void);
char host_matches(char * A, char * B);
void HStyle_addStyle(char * buffer);
void HTAA_clearProtections(void);
char * HTAA_GidToName(int32_t gid);
int32_t * HTAA_parseGroupDef(struct _IO_FILE * fp);
void HTAA_parseProtFile(int32_t * prot, struct _IO_FILE * fp);
void HTAA_printGroupDef(int32_t * group_def);
void HTAA_setCurrentProtection(char * cur_docname, char * prot_filename, char * ids);
void HTAA_setDefaultProtection(char * cur_docname, char * prot_filename, char * ids);
void HTAA_setIds(int32_t * prot, char * ids);
char * HTAA_UidToName(int32_t uid);
void HTAAForwardAuth_reset(void);
int32_t * HTAAProt_new(char * cur_docname, char * prot_filename, char * ids);
int32_t HTAAScheme_enum(char * name);
char * HTAAScheme_name(int32_t scheme);
void HTAAServer_delete(int32_t * killme);
void HTAASetup_delete(int32_t * killme);
void HTAccessInit(void);
void HTAddGotoURL(char * url);
void HTAddParam(char ** result, char * command, int32_t number, char * parameter);
void HTAddSearchQuery(char * query);
void HTAddSugFilename(char * fname);
void HTAddToCmd(char ** result, char * command, int32_t number, char * string);
void HTAddXpand(char ** result, char * command, int32_t number, char * parameter);
char * HTAfterCommandArg(char * command, int32_t number);
void HTAlert(char * Msg);
char * HTAlloc(char * ptr, int32_t length);
void HTAlwaysAlert(char * extra_prefix, char * Msg);
char * HTAnchor_address(int32_t * me);
char * HTAnchor_citehost(int32_t * me);
void HTAnchor_clearSourceCache(int32_t * me);
char * HTAnchor_content_base(int32_t * me);
char * HTAnchor_content_encoding(int32_t * me);
char * HTAnchor_content_location(int32_t * me);
char * HTAnchor_content_type(int32_t * me);
int32_t * HTAnchor_copyUCInfoStage(int32_t * me, int32_t to_stage, int32_t from_stage, int32_t set_by);
char * HTAnchor_date(int32_t * me);
char HTAnchor_delete(int32_t * me);
void HTAnchor_delete_links(int32_t * me);
int32_t * HTAnchor_document(int32_t * me);
int32_t * HTAnchor_findAddress(int32_t * newdoc2);
int32_t * HTAnchor_findAddress_in_adult_table(int32_t * newdoc2);
int32_t * HTAnchor_findNamedChild(int32_t * parent, char * tag);
int32_t * HTAnchor_findSimpleAddress(char * url);
int32_t * HTAnchor_followLink(int32_t * me);
int32_t * HTAnchor_format(int32_t * me);
int32_t * HTAnchor_getUCInfoStage(int32_t * me, int32_t which_stage);
int32_t HTAnchor_getUCLYhndl(int32_t * me, int32_t which_stage);
char HTAnchor_isIndex(int32_t * me);
char HTAnchor_isISMAPScript(int32_t * me);
char * HTAnchor_last_modified(int32_t * me);
char * HTAnchor_messageID(int32_t * me);
char * HTAnchor_owner(int32_t * me);
int32_t * HTAnchor_parent(int32_t * me);
char * HTAnchor_physical(int32_t * me);
char * HTAnchor_protocol(int32_t * me);
int32_t * HTAnchor_resetUCInfoStage(int32_t * me, int32_t LYhndl, int32_t which_stage, int32_t set_by);
char * HTAnchor_RevTitle(int32_t * me);
char HTAnchor_safe(int32_t * me);
char * HTAnchor_server(int32_t * me);
void HTAnchor_setDocument(int32_t * me, int32_t * doc);
void HTAnchor_setOwner(int32_t * me, char * owner);
void HTAnchor_setPhysical(int32_t * me, char * physical);
void HTAnchor_setProtocol(int32_t * me, char * protocol);
int32_t * HTAnchor_setUCInfoStage(int32_t * me, int32_t LYhndl, int32_t which_stage, int32_t set_by);
char * HTAnchor_style(int32_t * me);
char * HTAnchor_subject(int32_t * me);
char * HTAnchor_SugFname(int32_t * me);
char * HTAnchor_title(int32_t * me);
void HTAssocList_add(int32_t * alist, char * name, char * value);
void HTAssocList_delete(int32_t * alist);
int32_t * HTAssocList_new(void);
int32_t * HTAtom_for(char * string);
char HTBEquivalent(int32_t * s, int32_t * t);
int32_t * HTBprintf(int32_t ** pstr, char * fmt, ...);
void HTBTElement_free(int32_t * element);
void HTBTree_add(int32_t * tree, char * object);
void HTBTree_free(int32_t * tree);
int32_t * HTBTree_new(int32_t (*comp)(char *, char *));
int32_t * HTBTree_next(int32_t * tree, int32_t * ele);
char * HTBTree_search(int32_t * tree, char * object);
char HTcan_reparse_document(void);
int32_t * HTCharsetFormat(int32_t * format2, int32_t * anchor, int32_t default_LYhndl);
void HTCheckFnameForCompression(char ** fname, int32_t * anchor, char strip_ok);
int32_t HTCheckForInterrupt(void);
int32_t * HTChildAnchor_new(int32_t * parent);
void HTChunkClear(int32_t * ch);
int32_t * HTChunkCreate(int32_t grow);
int32_t * HTChunkCreate2(int32_t grow, int32_t needed);
void HTChunkFree(int32_t * ch);
void HTChunkInit(int32_t * ch, int32_t grow);
void HTChunkPutb(int32_t * ch, char * b, int32_t l);
void HTChunkPutc(int32_t * ch, char c);
void HTChunkPuts(int32_t * ch, char * s);
char HTChunkRealloc(int32_t * ch, int32_t growby);
void HTChunkTerminate(int32_t * ch);
void HTClearFTPPassword(void);
void HTClearHTTPAuthInfo(void);
void HTClearNNTPAuthInfo(void);
int32_t HTCompressFileType(char * filename, char * dots, int32_t * rootlen);
char * HTCompressTypeToSuffix(uint32_t method);
char HTConfirm(char * Msg);
char HTConfirmCookie(int32_t * de, char * server, char * name, char * value);
int32_t HTConfirmDefault(char * Msg, int32_t Dft);
int32_t HTContentToCompressType(int32_t * anchor);
int32_t HTContentTypeToCompressType(char * ct);
int32_t HTCountCommandArgs(char * command);
void HTDisplayPartial(void);
char HTdocument_settings_changed(void);
char HTEditable(char * filename);
int32_t HTEncodingToCompressType(char * coding);
void HTEndParam(char ** result, char * command, int32_t number);
char * HTEscape(char * str, char mask);
char * HTEscapeSP(char * str, char mask);
char * HTEscapeUnsafe(char * str);
void HText_activateRadioButton(int32_t * form);
int32_t HText_anchorRelativeTo(int32_t * text, int32_t top_lineno, int32_t anchor_number);
char HText_AreDifferent(int32_t * anchor, char * full_address);
char HText_canScrollDown(void);
int32_t * HText_childNextNumber(int32_t number, char ** prev);
int32_t HText_closestAnchor(int32_t * text, int32_t offset);
void HText_DisableCurrentForm(void);
void HText_ExpandTextarea(int32_t * form_link, int32_t newlines);
int32_t HText_ExtEditForm(int32_t * form_link);
void HText_FormDescNumber(int32_t number, char ** desc);
void HText_free(int32_t * self);
int32_t HText_getAbsLineNumber(int32_t * text, int32_t anchor_number);
char * HText_getContentBase(void);
char * HText_getContentLocation(void);
char * HText_getDate(void);
char HText_getFirstTargetInLine(int32_t * text, int32_t line_num, char utf_flag, int32_t * offset, int32_t * tLen, char ** data, char * target);
char * HText_getLastModified(void);
char * HText_getMessageID(void);
int32_t HText_getNumOfBytes(void);
int32_t HText_getNumOfLines(void);
char * HText_getOwner(void);
int32_t HText_getPreferredTopLine(int32_t * text, int32_t line_number);
char * HText_getRevTitle(void);
char * HText_getServer(void);
char * HText_getStyle(void);
char * HText_getSugFname(void);
char * HText_getTitle(void);
int32_t HText_getTopOfScreen(void);
void HText_halt(void);
char HText_hasNoCacheSet(int32_t * text);
char HText_hasToolbar(int32_t * text);
char HText_hasUTF8OutputSet(int32_t * text);
char HText_HaveUserChangedForms(int32_t * text);
char * HText_HiddenLinkAt(int32_t * text, int32_t number);
int32_t HText_HiddenLinkCount(int32_t * text);
int32_t HText_InsertFile(int32_t * form_link);
int32_t HText_LinksInLines(int32_t * text, int32_t line_num, int32_t Lines);
int32_t HText_locateAnchor(int32_t * text, int32_t anchor_number);
void HText_pageDisplay(int32_t line_num, char * target);
char HText_pageHasPrevTarget(void);
char HText_POSTReplyLoaded(int32_t * doc);
void HText_ResetForm(int32_t * form);
char HText_select(int32_t * text);
void HText_setMainTextOwner(char * owner);
void HText_setNoCache(int32_t * text);
void HText_setStale(int32_t * text);
int32_t HText_sourceAnchors(int32_t * text);
int32_t HText_SubmitForm(int32_t * submit_item, int32_t * doc, char * link_name, char * link_value);
char HText_TAHasMoreLines(int32_t curlink, int32_t direction);
void HText_trimHightext(int32_t * text, char final, int32_t stop_before);
int32_t HTFileCopy(struct _IO_FILE * fp, int32_t * sink);
int32_t * HTFileFormat(char * filename, int32_t ** pencoding, char ** pdesc);
void HTFileInit(void);
void HTFilterPresentations(void);
char HTFindPoundSelector(char * selector);
int32_t * HTFindPresentation(int32_t * rep_in, int32_t * rep_out, int32_t * fill_in, int32_t * anchor);
void HTFinishDisplayPartial(void);
int32_t HTForcedPrompt(int32_t option, char * msg, int32_t dft);
void HTFormatInit(void);
int32_t HTGetLine(char * s, int32_t n, struct _IO_FILE * f);
int32_t HTGetLinkInfo(int32_t number, int32_t want_go, int32_t * go_line, int32_t * linknum, char ** hightext, char ** lname);
int32_t HTGetLinkOrFieldStart(int32_t curlink, int32_t * go_line, int32_t * linknum, int32_t direction, char ta_skip);
char * HTGetProgramPath(int32_t code);
int32_t HTGetRelLinkNum(int32_t num, int32_t rel, int32_t cur);
void HTGetWord(char * word, char * line, char stop, char stop2);
char * HTHostName(void);
void HTInfoMsg(char * Msg);
void HTInitProgramPaths(void);
int32_t HTisDocumentSource(void);
char HTLastConfirmCancelled(void);
void HTList_addObject(int32_t * me, char * newObject);
int32_t * HTList_appendList(int32_t * start, int32_t * tail);
void HTList_appendObject(int32_t * me, char * newObject);
int32_t HTList_count(int32_t * me);
void HTList_delete(int32_t * me);
void HTList_insertObjectAt(int32_t * me, char * newObject, int32_t pos);
void HTList_linkObject(int32_t * me, char * newObject, int32_t * newNode);
int32_t * HTList_new(void);
char * HTList_objectAt(int32_t * me, int32_t position);
char * HTList_removeFirstObject(int32_t * me);
char * HTList_removeLastObject(int32_t * me);
char HTList_removeObject(int32_t * me, char * oldObject);
char * HTList_removeObjectAt(int32_t * me, int32_t position);
int32_t * HTList_reverse(int32_t * start);
char * HTList_unlinkLastObject(int32_t * me);
char HTList_unlinkObject(int32_t * me, char * oldObject);
int32_t HTLoad(char * addr, int32_t * anchor, int32_t * format_out, int32_t * sink);
char HTLoadAbsolute(int32_t * docaddr);
char HTLoadDocument(char * full_address, int32_t * anchor, int32_t * format_out, int32_t * sink);
char * HTLoadedDocumentBookmark(void);
char * HTLoadedDocumentCharset(void);
char HTLoadedDocumentEightbit(void);
char HTLoadedDocumentIsHEAD(void);
char HTLoadedDocumentIsSafe(void);
int32_t * HTLoadedDocumentPost_data(void);
char * HTLoadedDocumentTitle(void);
char * HTLoadedDocumentURL(void);
int32_t HTLoadError(int32_t * sink, int32_t number, char * message);
int32_t HTLoadExtensionsConfigFile(char * fn);
char HTLoadRelative(char * relative_name, int32_t * here);
int32_t HTLoadTypesConfigFile(char * fn, int32_t media);
int32_t HTMainText_Get_UCLYhndl(void);
void HTMake822Word(char ** str, int32_t quoted);
void HTMark_asSource(void);
int32_t HTMemCopy(int32_t * chunk, int32_t * sink);
void html_src_clean_data(void);
void html_src_clean_item(int32_t l);
void html_src_on_lynxcfg_reload(void);
int32_t html_src_parse_tagspec(char * ts, int32_t lexeme, char checkonly, char isstart);
int32_t html_src_tag_index(char * tagname);
int32_t HTMLGetEntityUCValue(char * name);
void HTMLSetCharacterHandling(int32_t i);
void HTMLSetDisplayCharsetMatchLocale(int32_t i);
void HTMLSetHaveCJKCharacterSet(int32_t i);
void HTMLSetRawModeDefault(int32_t i);
void HTMLSetUseDefaultRawMode(int32_t i, char modeflag);
void HTMLSRC_init_caches(char dont_exit);
void HTMLUseCharacterSet(int32_t i);
char * HTnameOfFile_WWW(char * name, char WWW_prefix, char expand_all);
char * HTNextField(char ** pstr);
char * HTNextTok(char ** pstr, char * delims, char * bracks, char * found);
int32_t * HTParentAnchor0_new(char * address, int16_t hash);
void HTParentAnchor_free(int32_t * me);
int32_t * HTParentAnchor_new(int32_t * parent);
char * HTParse(char * aName, char * relatedName, int32_t wanted);
char * HTParseAnchor(char * aName);
int32_t HTParseFile(int32_t * rep_in, int32_t * format_out, int32_t * anchor, struct _IO_FILE * fp, int32_t * sink);
int32_t HTParseMem(int32_t * rep_in, int32_t * format_out, int32_t * anchor, int32_t * chunk, int32_t * sink);
char * HTParsePort(char * host, int32_t * portp);
void HTPreparsedFormatInit(void);
void HTProgress(char * Msg);
char * HTProgressUnits(int32_t rate);
char * HTQuoteParameter(char * parameter);
void HTReadProgress(int64_t bytes, int64_t total);
char HTRegisterProtocol(int32_t * protocol);
char * HTRelative(char * aName, char * relatedName);
void HTReorderPresentation(int32_t * rep_in, int32_t * rep_out);
char HTreparse_document(void);
void HTSABCat(int32_t ** dest, char * src, int32_t len);
void HTSABCat0(int32_t ** dest, char * src);
void HTSABCopy(int32_t ** dest, char * src, int32_t len);
void HTSABCopy0(int32_t ** dest, char * src);
char HTSABEql(int32_t * a, int32_t * b);
void HTSABFree(int32_t ** ptr);
char * HTSACat(char ** dest, char * src);
char * HTSACopy(char ** dest, char * src);
char HTSearch(char * keywords, int32_t * here);
char HTSEquivalent(char * s, char * t);
void HTSetConversion(char * representation_in, char * representation_out, int32_t * (*converter)(int32_t, int32_t *, int32_t *), float32_t quality, float32_t secs, float32_t secs_per_byte, int32_t maxbytes, int32_t media);
void HTSetPresentation(char * representation, char * command, char * testcommand, float64_t quality, float64_t secs, float64_t secs_per_byte, int32_t maxbytes, int32_t media);
void HTSetProgramPath(int32_t code, char * path);
void HTSetSuffix5(char * suffix, char * representation, char * encoding, char * desc, float64_t value);
void HTSimplify(char * filename);
char * HTSprintf(char ** pstr, char * fmt, ...);
char * HTSprintf0(char ** pstr, char * fmt, ...);
int32_t HTStat(char * filename, int32_t * data);
int32_t * HTStreamStack(int32_t * rep_in, int32_t * rep_out, int32_t * sink, int32_t * anchor);
char * HTStrip(char * s);
void HTSwitchDTD(int32_t new_flag);
char * HTTranslate(char * required);
void HTuncache_current_document(void);
char * HTUnEscape(char * str);
char * HTUnEscapeSome(char * str, char * do_trans);
char * HTURLPath_toFile(char * name, char expand_all, char is_remote);
void HTUserMsg(char * Msg);
void HTUserMsg2(char * Msg2, char * Arg);
int32_t ignore_trailing_slash(char * a);
void ImageMapList_free(int32_t * theList);
int32_t increment_tagged_htline(int32_t * ht, int32_t * a, int32_t * lx_val, int32_t * old_val, int32_t incr, int32_t mode);
void initialise_default_stylesheet(void);
char inlocaldomain(void);
void insert_new_textarea_anchor(int32_t ** curr_anchor, int32_t ** exit_htline);
struct _IO_FILE * InternalPageFP(char * filename, int32_t reuse_flag);
int32_t is_EUC_JP(char * euc);
char is_prefix(char * a, char * b);
int32_t IS_SJIS_STR(char * str);
char is_true(char * string);
int32_t is_url(char * filename);
char IsFormsTextarea(int32_t * form, int32_t * anchor_ptr);
char isLynxOptionsPage(char * address, char * portion);
char IsOurFile(char * name);
char IsOurSymlink(char * name);
char * JIS_TO_SJIS1(unsigned char HI, char LO, char * SJCODE);
char * key_for_func(int32_t func);
char * key_for_func_ext(int32_t lac, int32_t context_code);
int32_t lex(struct _IO_FILE * fp);
char * lex_verbose(int32_t lex_item);
int32_t line_num_in_text(int32_t * text, int32_t * line);
int32_t * line_num_to_anchor(uint32_t line_num);
char link_has_target(int32_t cur, char * target);
void load_a_file(char * val_used, int32_t ** result);
int32_t local_create(int32_t * doc);
int32_t local_dired(int32_t * doc);
int32_t local_modify(int32_t * doc, char ** newpath);
int32_t local_remove(int32_t * doc);
char looks_like_password(char * first, char * last);
char * lookup_color(int32_t code);
int32_t * lookup_config(char * name);
int32_t * lookup_config2(char * name);
char * lookup_external(char * param, char only_overriders);
char lookup_link(char * target);
char lookup_reject(char * target);
int32_t lstat64(int32_t a1, int32_t * a2);
char * LY_check_calloc(int32_t nmemb, int32_t size);
void LY_close_temp(int32_t * p);
char * LYAbsOrHomePath(char ** fname);
void LYAddHilite(int32_t cur, char * text, int32_t x);
void LYAddHiText(int32_t * a, char * text, int32_t x);
void LYAddHtmlSep(char ** path);
void LYAddJumpShortcut(int32_t * historyp, char * shortcut);
void LYAddMETAcharsetToFD(struct _IO_FILE * fd, int32_t disp_chndl);
void LYAddPathSep(char ** path);
void LYAddPathToHome(char * fbuffer, uint32_t fbuffer_size, char * fname);
char * LYAddPathToSave(char * fname);
char LYAddSchemeForURL(char ** AllocatedString, char * default_scheme);
void LYAddToCloset(int32_t recall, char * str);
void LYAddVisitedLink(int32_t * doc);
int32_t LYAdjHiTextPos(int32_t * a, uint32_t count);
void LYAllocHistory(int32_t entries);
struct _IO_FILE * LYAppendToTxtFile(char * name);
int32_t LYarrayLength(char ** list);
void LYAttrset(int32_t * win, int32_t color, int32_t mono);
void LYbox(int32_t * win, char formfield);
char LYCanDoHEAD(char * address);
char LYCanReadFile(char * filename);
char LYCanWriteFile(char * filename);
int32_t LYCharSetsDeclared(void);
void LYCheckBibHost(void);
int32_t LYCheckForProxyURL(char * filename);
void LYCheckMail(void);
char LYCheckUserAgent(void);
void LYCleanupTemp(void);
void LYclear(void);
void LYClearHiText(int32_t * a);
void LYCloseCloset(int32_t recall);
void LYCloseCmdLogfile(void);
char LYCloseInput(struct _IO_FILE * fp);
void LYCloselog(void);
char LYCloseOutput(struct _IO_FILE * fp);
void LYCloseTemp(char * name);
void LYCloseTempFP(struct _IO_FILE * fp);
void LYCloseTracelog(void);
void LYclrtoeol(void);
int32_t * LYcommandList(void);
void LYCompleteExit(void);
void LYConfigCookies(void);
int32_t LYConsoleInputFD(char need_selectable);
void LYConvertToURL(char ** AllocatedString, int32_t fixit);
int32_t LYCopyFile(char * src, char * dst);
void LYCopyHiText(int32_t * a, int32_t * b);
char * LYCopyValue(char * s);
void LYDownload(char * line);
int32_t LYdownload_options(char ** newfile, char * data_file);
char * LYDownLoadAddress(void);
int32_t LYEdit1(int32_t * edit, int32_t ch, int32_t action, char maxMessage);
int32_t LYEditInsert(int32_t * edit, char * s, int32_t len, int32_t map, char maxMessage);
int32_t LYEditKeyForAction(int32_t lac, int32_t * pmodkey);
int32_t LYEditmapDeclared(void);
void LYEnsureAbsoluteURL(char ** href, char * name, int32_t fixit);
void LYEntify(char ** str, char isTITLE);
void LYerase(void);
void LYEscapeStartfile(char ** buffer);
int32_t LYExecv(char * path, char ** argv, char * msg);
void LYexit(int32_t status);
char LYExpandHostForURL(char ** AllocatedString, char * prefix_list, char * suffix_list);
void LYExtSignal(int32_t sig, void (*handler)(int32_t));
void LYFakeZap(char set);
void LYFillLocalFileURL(char ** href, char * base);
char * LYFindInCloset(int32_t recall, char * base);
void LYFindLocaleCharset(void);
void LYFixCursesOn(char * reason);
char LYFixCursesOnForAccess(char * addr, char * physical);
void LYformTitle(char ** dst, char * src);
void LYFreeDocInfo(int32_t * doc);
void LYFreeHilites(uint32_t first, uint32_t last);
void LYFreePostData(int32_t * doc);
void LYFreeStringList(int32_t * list);
int32_t LYgetattrs(int32_t * win);
int32_t LYgetch(void);
int32_t LYgetch_choice(void);
int32_t LYgetch_for(int32_t code);
int32_t LYgetch_input(void);
int32_t LYgetch_single(void);
char * LYGetContentType(char * name, char * params);
char LYgetEnum(int32_t * table, char * name, int32_t * result);
char * LYGetEnv(char * name);
void LYGetFileInfo(char * filename, int32_t ** pfile_anchor, int32_t ** pformat, int32_t ** pencoding, char ** pdesc, char ** pcharset, int32_t * pfile_cs);
int32_t LYGetHilitePos(int32_t cur, uint32_t count);
char * LYGetHiliteStr(int32_t cur, uint32_t count);
int32_t LYGetHiTextPos(int32_t * a, uint32_t count);
char * LYGetHiTextStr(int32_t * a, uint32_t count);
struct hostent * LYGetHostByName(char * str);
int32_t LYGetNewline(void);
int32_t LYgetstr(char * inputline, int32_t hidden, uint32_t bufsize, int32_t recall);
char * LYgetTableString(int32_t code);
char * LYgetXDisplay(void);
int32_t LYhandlePopupList(int32_t cur_choice, int32_t ly, int32_t lx, char ** choices, int32_t width, int32_t i_length, int32_t disabled, char for_mouse);
char LYHaveCmdScript(void);
char LYHaveSubBookmarks(void);
void LYhighlight(int32_t flag, int32_t cur, char * target);
int32_t LYhist_next(int32_t * doc, int32_t * newdoc2);
void LYhist_prev(int32_t * doc);
void LYhist_prev_register(int32_t * doc);
int32_t LYindex2MBM(uint32_t n);
char LYisAbsPath(char * path);
char LYisLocalAlias(char * filename);
char LYisLocalFile(char * filename);
char LYisLocalHost(char * filename);
char LYisNonAlnumKeyname(uint32_t ch, int32_t KeyName);
char LYisRootPath(char * path);
char LYIsUIPage3(char * url, int32_t type, uint32_t flagparam);
char * LYJump(uint32_t key);
char * LYKeycodeToString(int32_t c, char upper8);
int32_t LYKeyForEditAction(int32_t lec);
char * LYLastPathSep(char * path);
char * LYLineeditHelpURL(void);
void LYLoadCookies(char * cookie_file);
void LYLocalFileToURL(char ** target, char * source);
void LYLowerCase(char * arg_buffer);
char LYMailcapUsesPctS(char * controlstring);
char LYMainLoop_pageDisplay(int32_t line_num);
char * LYmbcs_skip_cells(char * data, int32_t n_cells, char utf_flag);
char * LYmbcs_skip_glyphs(char * data, int32_t n_glyphs, char utf_flag);
int32_t LYmbcsstrlen(char * str, char utf_flag, char count_gcells);
char * LYmbcsstrncpy(char * dst, char * src, int32_t n_bytes, int32_t n_glyphs, char utf_flag);
int32_t LYMBM2index(uint32_t ch);
void LYMBM_statusline(char * text);
void LYMenuVisitedLinks(struct _IO_FILE * fp0, int32_t disable_all);
int32_t LYmouse_menu(int32_t x, int32_t y, int32_t atlink, int32_t code);
void LYmove(int32_t y, int32_t x);
void LYmsec_delay(int32_t msec);
struct _IO_FILE * LYNewBinFile(char * name);
struct _IO_FILE * LYNewTxtFile(char * name);
char * LYno_attr_char_case_strstr(char * chptr, char * tarptr);
char * LYno_attr_char_strstr(char * chptr, char * tarptr);
char * LYno_attr_mbcs_case_strstr(char * chptr, char * tarptr, char utf_flag, char count_gcells, int32_t * nstartp, int32_t * nendp);
char * LYno_attr_mbcs_strstr(char * chptr, char * tarptr, char utf_flag, char count_gcells, int32_t * nstartp, int32_t * nendp);
void LYnormalColor(void);
void LYnoVideo(int32_t a);
int32_t lynx_cfg_infopage(int32_t * newdoc2);
int32_t lynx_color_cfg_attr(uint32_t code);
int32_t lynx_compile_opts(int32_t * newdoc2);
void lynx_enable_mouse(int32_t state);
void lynx_force_repaint(void);
void lynx_init_color_pair(int32_t n);
void lynx_init_colors(void);
int32_t lynx_initialize_keymaps(void);
void lynx_map_color(int32_t n);
void lynx_nl2crlf(int32_t normal);
void lynx_setup_colors(void);
void lynx_start_bold(void);
void lynx_start_h1_color(void);
void lynx_start_prompt_color(void);
void lynx_start_radio_color(void);
void lynx_start_reverse(void);
void lynx_start_title_color(void);
void lynx_start_underline(void);
void lynx_stop_all_colors(void);
void lynx_stop_bold(void);
void lynx_stop_h1_color(void);
void lynx_stop_link_color(int32_t flag, int32_t pending);
void lynx_stop_prompt_color(void);
void lynx_stop_radio_color(void);
void lynx_stop_reverse(void);
void lynx_stop_title_color(void);
void lynx_stop_underline(void);
struct _IO_FILE * LYOpenCFG(char * cfg_filename, char * parent_filename, char * dft_filename);
void LYOpenCmdLogfile(uint32_t argc, char ** argv);
void LYOpenCmdScript(void);
void LYOpenlog(char * banner);
struct _IO_FILE * LYOpenScratch(char * result, char * prefix);
struct _IO_FILE * LYOpenTemp(char * result, char * suffix, char * mode);
struct _IO_FILE * LYOpenTempRewrite(char * fname, char * suffix, char * mode);
char LYOpenTraceLog(void);
void LYoptions(void);
void LYpaddstr(int32_t * the_window, int32_t width, char * the_string);
char * LYPathLeaf(char * pathname);
char LYPathOffHomeOK(char * fbuffer, uint32_t fbuffer_size);
struct _IO_FILE * LYPipeToMailer(void);
void LYpop(int32_t * doc);
void LYpop_num(uint32_t number, int32_t * doc);
void LYPrintImgMaps(struct _IO_FILE * fp);
int32_t LYpush(int32_t * doc, char force_push);
char * LYputEnum(int32_t * table, int32_t value);
int32_t LYRead_Jumpfile(int32_t * jtp);
int32_t LYReadCmdKey(int32_t mode);
char * LYReduceBlanks(char * buffer);
void LYrefresh(void);
void LYRefreshEdit(int32_t * edit);
void LYRegisterLynxProtocols(void);
void LYRegisterUIPage(char * url, int32_t type);
void LYRelaxFilePermissions(char * name);
char * LYRemoveBlanks(char * buffer);
void LYRemoveFromCloset(int32_t * list);
int32_t LYRemoveTemp(char * name);
int32_t LYReopenInput(void);
struct _IO_FILE * LYReopenTemp(char * name);
char LYReopenTracelog(char * trace_flag_ptr);
int32_t LYReverseKeymap(int32_t KeyName);
char * LYSafeGets(char ** src, struct _IO_FILE * fp);
int32_t LYscreenHeight(void);
int32_t LYscreenWidth(void);
void LYSetConfigValue(char * name, char * value);
void LYSetDisplayLines(void);
void LYSetHilite(int32_t cur, char * text);
void LYSetHiText(int32_t * a, char * text, int32_t len);
void LYSetLastTFPos(int32_t pos);
void LYSetNewline(int32_t value);
void LYSetupEdit(int32_t * edit, char * old, int32_t maxstr, int32_t maxdsp);
void LYsetXDisplay(char * new_display);
int32_t LYShowInfo(int32_t * doc, int32_t * newdoc2, char * owner_address2);
int32_t LYShowVisitedLinks(char ** newfile);
char * LYSkipBlanks(char * buffer);
char * LYSkipCBlanks(char * buffer);
char * LYSkipNonBlanks(char * buffer);
char * LYSkipQuoted(char * s);
char * LYSkipToken(char * s);
char * LYSkipValue(char * s);
void LYSleepAlert(void);
void LYSleepDebug(void);
void LYSleepInfo(void);
void LYSleepMsg(void);
void LYSleepReplay(void);
int32_t * LYstartPopup(int32_t * top_y, int32_t * left_x, int32_t * height, int32_t * width);
void LYstartTargetEmphasis(void);
void LYstatusline_messages_on_exit(char ** buf);
void LYStdinArgs_free(void);
void LYstopTargetEmphasis(void);
void LYstore_message(char * message);
void LYstore_message2(char * message, char * argument);
void LYStoreCookies(char * cookie_file);
void LYstowCursor(int32_t * win, int32_t row, int32_t col);
int32_t LYstrCells(char * string);
int32_t LYstrExtent(char * string, int32_t len, int32_t maxCells);
int32_t LYstrExtent2(char * string, int32_t len);
int32_t * LYStringToKcmd(char * name);
int32_t LYStringToKeycode(char * src);
char * LYstrncpy(char * dst, char * src, int32_t n);
char * LYstrsep(char ** stringp, char * delim);
char * LYstrstr(char * chptr, char * tarptr);
void LYsubwindow(int32_t * param);
void LYSyslog(char * arg);
char * LYSysShell(void);
int32_t LYSystem(char * command);
char LYSystemMail(void);
int32_t LYTestMailcapCommand(char * testcommand, char * params);
char * LYTildeExpand(char ** pathname, char embedded);
char LYToggleSigDfl(int32_t sig, struct sigaction * where, int32_t to_dfl);
int32_t * LYtopwindow(void);
void LYTrimAllStartfile(char * buffer);
void LYTrimHead(char * str);
void LYTrimHtmlSep(char * path);
void LYTrimLeading(char * buffer);
char * LYTrimNewline(char * buffer);
void LYTrimPathSep(char * path);
void LYTrimRelFromAbsPath(char * path);
char LYTrimStartfile(char * buffer);
void LYTrimTail(char * str);
void LYTrimTrailing(char * buffer);
char ** LYUCFullyTranslateString(char ** str, int32_t cs_from, int32_t cs_to, char do_ent, char use_lynx_specials, char plain_space, char hidden, char Back, int32_t stype);
int32_t LYUCPopAssumed(void);
void LYUCPushAssumed(int32_t * anchor);
char LYUCTranslateBackFormData(char ** str, int32_t cs_from, int32_t cs_to, char plain_space);
int32_t LYUpload(char * line);
int32_t LYUpload_options(char ** newfile, char * directory);
void LYUpperCase(char * arg_buffer);
char LYValidateFilename(char * result, char * given);
int32_t LYValidateOutput(char * filename);
char * LYVersionDate(void);
char LYVersionIsRelease(void);
char * LYVersionStatus(void);
void LYwaddnstr(int32_t * w, char * src, int32_t len);
char LYwouldPush(char * title, char * docurl);
void LYWriteCmdKey(int32_t ch);
void mailform(char * mailto_address, char * mailto_subject, char * mailto_content, char * mailto_type);
void mailmsg(int32_t cur, char * owner_address2, char * filename, char * linkname);
int32_t mainloop(void);
int32_t make_directory(char * path);
int32_t match_item_by_name(int32_t * ptr, char * name, char only_overriders);
char * match_op(char * prefix, char * data);
int32_t mbcs_glyphs(char * s, int32_t len);
int32_t mbcs_skip(char * s, int32_t pos);
char mem_is_avail(int32_t factor, uint32_t bytes);
int32_t modify_location(char * testpath);
int32_t modify_name(char * testpath);
int32_t modify_tagged(char * testpath);
void move_address(int32_t * dst, int32_t * src);
int32_t move_file(char * source, char * target);
int32_t * newCookie(void);
struct _IO_FILE * NewCookieFile(char * cookie_file);
char * NewSecureValue(void);
char not_already_exists(char * name);
char * novice_lines(int32_t lineno2);
void noviceline(int32_t more_flag);
char ok_file_or_dir(int32_t * sb);
char ok_lstat(char * name, int32_t * sb);
char ok_stat(char * name, int32_t * sb);
struct _IO_FILE * OpenHiddenFile(char * name, char * mode);
char ** options_list(int32_t * opt_ptr);
int32_t options_width(char ** list);
void outofmem(char * fname, char * func);
char override_proxy(char * addr);
int32_t * parse_address_part(struct _IO_FILE * fp);
char parse_arg(char ** argv, int32_t mask, int32_t * countp);
void parse_attributes(char * mono, char * fg, char * bg, uint32_t style, char * element);
void parse_either(char * attrs, int32_t dft_color, int32_t * monop, int32_t * colorp);
int32_t * parse_item(struct _IO_FILE * fp);
int32_t * parse_item_list(struct _IO_FILE * fp);
void parse_restrictions(char * s);
void parse_style(char * param);
int32_t * parse_user_part(struct _IO_FILE * fp);
void parse_userstyles(void);
int32_t PassesTest(int32_t * mc);
int32_t peek_mouse_levent(void);
int32_t peek_mouse_link(void);
void PerFormInfo_free(int32_t * form);
int32_t permit_bits(char * string_mode);
int32_t permit_location(char * destpath, char * srcpath, char ** newpath);
void POOL_FREE(int32_t * poolptr);
int32_t popup_choice(int32_t cur_choice, int32_t line, int32_t column, char ** choices, int32_t i_length, int32_t disabled, char for_mouse);
int32_t postoptions(int32_t * newdoc2);
void print_crawl_to_fd(struct _IO_FILE * fp, char * thelink, char * thetitle);
void print_help_and_exit(int32_t exit_status);
void print_help_strings(char * name, char * help, char * value, char option);
void print_hidden_refs(struct _IO_FILE * fp, int32_t refs, uint32_t hidden_links);
void print_item(int32_t * item);
void print_item_list(int32_t * item_list);
int32_t print_options(char ** newfile, char * printed_url, int32_t lines_in_file);
void print_refs(struct _IO_FILE * fp, char titles, int32_t refs);
void print_wwwfile_to_fd(struct _IO_FILE * fp, char is_email, char is_reply);
int32_t printfile(int32_t * newdoc2);
void printlist(struct _IO_FILE * fp, char titles);
int32_t ProcessMailcapEntry(struct _IO_FILE * fp, int32_t * mc, int32_t media);
int32_t ProcessMailcapFile(char * file, int32_t media);
int32_t put_clip(char * s);
void PutLabel(struct _IO_FILE * fp, char * name, char * value);
void PutOptValues(struct _IO_FILE * fp, int32_t value, int32_t * table);
void read_cfg(char * cfg_filename, char * parent_filename, int32_t nesting_level, struct _IO_FILE * fp0);
int32_t read_keymap_file(void);
void read_rc(struct _IO_FILE * fp);
int32_t readit(int32_t fd, char * buffer, int32_t length);
int32_t RecallFilename(char * filename, char * first, int32_t * now, int32_t * total, int32_t flag);
void redraw_lines_of_link(int32_t cur);
void redraw_part_of_line(int32_t * line, char * str, int32_t len, int32_t * text);
int32_t * RefCachedStyle(int32_t y, int32_t x);
void reinsertEdit(int32_t * edit, char * result);
void reload_read_cfg(void);
void remember_column(int32_t * edit, int32_t offset);
int32_t RememberTestResult(int32_t mode, char * cmd, int32_t result);
void remove_backslashes(char * buf);
void remove_bookmark_link(uint32_t cur, char * cur_bookmark_page);
int32_t remove_directory(char * path);
int32_t remove_file(char * path);
void remove_most_blanks(char * buffer);
int32_t remove_single(char * testpath);
int32_t remove_special_attr_chars(char * buf);
int32_t remove_tagged(void);
void remove_tildes(char * string);
char * render_item(char * s, char * path, char * dir, char * buf, int32_t bufsize, char url_syntax);
void repaint_main_statusline(int32_t for_what);
char * repairJIStoEUC(char * src, char ** dstp);
char reparse_document(void);
char reparse_or_reload(int32_t * cmd);
int32_t repeat_to_delta(int32_t n);
void reply_by_mail(char * mail_address, char * filename, char * title, char * refid);
void reset_any_keys(int32_t * table, uint32_t size);
void reset_dired_menu(void);
void reset_emacs_keys(void);
void reset_numbers_as_arrows(void);
void reset_signals(void);
void reset_vi_keys(void);
void ResetCachedStyles(void);
void ResetPartialLinenos(int32_t * text);
char rule_cond_ok(int32_t * r);
char run_external(char * param, char only_overriders);
void SafeHTUnEscape(char * string);
int32_t safeUCGetLYhndl_byMIME(char * value);
char same_anchor_or_field(int32_t numberA, int32_t * formA, int32_t numberB, int32_t * formB, char ta_same);
int32_t sametext(char * een, char * twee);
void save_bookmark_link(char * address, char * title);
void save_gid_info(char * name, int32_t user);
int32_t save_rc(struct _IO_FILE * fp);
void save_uid_info(char * name, int32_t user);
void scan(char * name, int32_t * parts);
int32_t select_menu_multi_bookmarks(void);
int32_t select_multi_bookmarks(void);
void send_file_to_file(int32_t * newdoc2, char * content_base, char * sug_filename);
void send_file_to_mail(int32_t * newdoc2, char * content_base, char * content_location);
void send_file_to_printer(int32_t * newdoc2, char * content_base, char * sug_filename, int32_t printer_number);
void send_file_to_screen(int32_t * newdoc2, char * content_base, char Lpansi);
void set_address(int32_t * doc, char * address);
void set_any_keys(int32_t * table, uint32_t size);
int32_t set_clicked_link(int32_t x, int32_t y, int32_t code, int32_t clicks);
char set_curdoc_link(int32_t nextlink);
void set_curdoc_link_by_mouse(int32_t nextlink);
void set_default_bookmark_page(char * value);
void set_emacs_keys(void);
void set_environ(int32_t name, char * value, char * no_value);
void Set_HTCJK(char * inMIMEname, char * outMIMEname);
void set_inverse_transl(int32_t i);
void set_numbers_as_arrows(void);
int16_t * set_translate(int32_t m);
void set_vi_keys(void);
void SetCachedStyle(int32_t y, int32_t x, int32_t value);
void setHashStyle(int32_t style, int32_t color, int32_t cattr, int32_t mono, char * element);
void SetLocale(void);
void setStyle(int32_t style, int32_t color, int32_t cattr, int32_t mono);
char setup(char * terminal2);
void setup_vtXXX_keymap(void);
void SetupChosenShowColor(void);
void SetupFilename(char * filename, char * sug_filename);
int32_t SGML_offset(void);
int32_t * SGMLFindTag(int32_t * dtd, char * s);
void show_addresses(char * addresses);
void show_bookmark_not_defined(void);
void show_choice(char * choice, int32_t width);
void show_formlink_statusline(int32_t * form, int32_t for_what);
void show_main_statusline(int32_t curlink, int32_t for_what);
char show_whereis_targets(int32_t flag, int32_t cur, int32_t count, char * target, char TargetEmphasisON, char utf_flag);
int32_t showhistory(char ** newfile);
int32_t showlist(int32_t * newdoc2, char titles);
void showtags(int32_t * t);
void size_change(int32_t sig);
char * SJIS_TO_EUC1(char HI, char LO, char * data);
char * SJIS_TO_JIS1(unsigned char HI, char LO, char * JCODE);
char * SNACopy(char ** dest, char * src, int32_t n);
char ** sortedList(int32_t * list, char ignorecase);
char * sprint_bytes(char * s, int64_t n, char * was_units);
char * sprint_tbuf(char * s, int32_t t);
void srcmode_for_next_retrieval(int32_t mode);
void start_curses(void);
int32_t stat64(int32_t a1, int32_t * a2);
void status_link(char * curlink_name, char show_more, char show_indx);
void statusline(char * text);
int32_t Stbl_getStartLineDeep(int32_t * me);
void stop_curses(void);
void store_cookie(int32_t * co, char * hostname2, char * path);
char * StrAllocVsprintf(char ** pstr, int32_t dst_len, char * fmt, char ** ap);
int32_t strcasecomp(char * a, char * b);
int32_t strcasecomp8(char * a, char * b);
char * strchr_or_end(char * string, int32_t ch);
int32_t string_to_attr(char * name);
char * strip_trailing_slash(char * dirname);
char strn_dash_equ(char * p1, char * p2, int32_t len);
int32_t strncasecomp(char * a, char * b, int32_t n);
int32_t strncasecomp8(char * a, char * b, int32_t n);
void strtolower(char * i);
char * stub_HTAnchor_address(int32_t * me);
void style_deleteStyleList(void);
void style_initialiseHashTable(void);
int32_t style_readFromFile(char * filename);
int32_t style_readFromFileREC(char * lss_filename, char * parent_filename);
int32_t StyleToCols(int32_t * text, int32_t * line, int32_t nstyle);
char * subject_translate8bit(char * source);
int32_t SuffixIs(char * filename, char * suffix);
char * suggested_filename(int32_t * newdoc2);
void summarize_x_display(char * display_option);
void syntax_error(struct _IO_FILE * fp, char * msg, int32_t lex_item);
void tagflag(int32_t flag, int32_t cur);
char textsearch(int32_t * cur_doc, char * prev_target2, int32_t target_size, int32_t direction);
char * title_convert8bit(char * Title);
char * TO_EUC(char * jis, char * euc);
void TO_SJIS(char * arg, char * sjis);
void to_stack(char * str);
void toggle_novice_line(void);
int32_t touch_file(char * path);
void trace_bstring(int32_t * data);
void trace_bstring2(char * text, int32_t size);
void trace_history(char * tag);
void trace_setting_change(char * name, int32_t prev_setting, int32_t new_setting);
struct _IO_FILE * TraceFP(void);
void TracelogOpenFailed(void);
char trim_comma(char * address);
void TrimCommand(char * command);
char * TrimLowercase(char * buffer);
int32_t TrimmedLength(char * string);
char * trimPoundSelector(char * address);
void turn_trace_back_on(char * trace_flag_ptr);
void UC_Charset_NoUctb_Setup(char * UC_MIMEcharset, char * UC_LYNXcharset, int32_t trydefault, int32_t lowest_eight, int32_t UC_rawuni, int32_t codepage);
void UC_Charset_Setup(char * UC_MIMEcharset, char * UC_LYNXcharset, char * unicount, int16_t * unitable, int32_t nnuni, int32_t replacedesc, int32_t lowest_eight, int32_t UC_rawuni, int32_t codepage);
void UC_con_set_trans(int32_t UC_charset_in_hndl, int32_t Gn, int32_t update_flag);
int32_t UC_con_set_unimap(int32_t UC_charset_out_hndl, int32_t update_flag);
int32_t UC_con_set_unimap_str(int16_t ct, int32_t * list, int32_t fordefault);
int32_t UC_FindGN_byMIME(char * UC_MIMEcharset);
int32_t UC_MapGN(int32_t UChndl, int32_t update_flag);
int32_t UC_NoUctb_Register_with_LYCharSets(char * UC_MIMEcharset, char * UC_LYNXcharset, int32_t lowest_eightbit, int32_t UC_rawuni, int32_t codepage);
int32_t UC_Register_with_LYCharSets(int32_t s, char * UC_MIMEcharset, char * UC_LYNXcharset, int32_t lowest_eightbit);
char ** UC_setup_LYCharSets_repl(int32_t UC_charset_in_hndl, uint32_t lowest8);
int32_t UC_valid_UC_charset(int32_t UC_charset_hndl);
char UCCanTranslateFromTo(int32_t from, int32_t to);
char UCCanTranslateUniTo(int32_t to);
char UCCanUniTranslateFrom(int32_t from);
void UCconsole_map_init(void);
int32_t UCGetLYhndl_byMIME(char * value);
int32_t UCGetUniFromUtf8String(char ** ppuni);
void UCInit(void);
char UCNeedNotTranslate(int32_t from, int32_t to);
char * UCPutUtf8ToBuffer(char * q, uint32_t code, char terminate);
void UCreset_allocated_LYCharSets(void);
int32_t UCReverseTransChar(unsigned char ch_out, int32_t charset_in, int32_t charset_out);
void UCSetBoxChars(int32_t cset, int32_t * pvert_out, int32_t * phori_out, int32_t vert_in, int32_t hori_in);
void UCSetTransParams(int32_t * pT, int32_t cs_in, int32_t * p_in, int32_t cs_out, int32_t * p_out);
int32_t UCTransChar(unsigned char ch_in, int32_t charset_in, int32_t charset_out);
int32_t UCTransCharStr(char * outbuf, uint32_t buflen, unsigned char ch_in, int32_t charset_in, int32_t charset_out, int32_t chk_single_flag);
int32_t UCTransJPToUni(char * inbuf, int32_t buflen, int32_t charset_in);
void UCTransParams_clear(int32_t * pT);
int32_t UCTransToUni(unsigned char ch_in, int32_t charset_in);
int32_t UCTransUniChar(int32_t unicode, int32_t charset_out);
int32_t UCTransUniCharStr(char * outbuf, int32_t buflen, uint32_t unicode, int32_t charset_out, int32_t chk_single_flag);
int32_t UniToLowerCase(int32_t upper);
void unlex(int32_t lex_item);
void update_subsequent_anchors(int32_t newlines, int32_t * start_anchor, int32_t * start_htline, int32_t start_tag);
void UpdateBoundary(char ** Boundary, int32_t * data);
int32_t UPPER8(uint32_t ch1, uint32_t ch2);
char useMemoryCache(void);
void user_message(char * message, char * argument);
char useSourceCache(void);
int32_t utf8_length(char utf_flag, char * data);
char valid_hostname(char * name);
void validate_x_display(void);
char ValidCachedStyle(int32_t y, int32_t x);
int32_t * whichRecall(int32_t recall);
int32_t widest_choice(char ** choices);
char * will_save_cookies(void);
char * will_save_images(void);
char will_save_rc(char * name);
int32_t wrap_reparse_document(void);
void write_hyphen(struct _IO_FILE * fp);
void write_list(struct _IO_FILE * fp, char * list);
void write_offset(struct _IO_FILE * fp, int32_t * line);
void WriteInternalTitle(struct _IO_FILE * fp0, char * Title);
int32_t www_search_backward(int32_t start_line, int32_t * doc, char * target, int32_t * line, int32_t count);
int32_t www_search_forward(int32_t start_line, int32_t * doc, char * target, int32_t * line, int32_t count);
void www_user_search(int32_t start_line, int32_t * doc, char * target, int32_t direction);
char * wwwName(char * pathname);
int32_t XYdist(int32_t x1, int32_t y1, int32_t x2, int32_t y2, int32_t dx2);

// --------------------- Global Variables ---------------------

int32_t AlertSecs = 0; // 0x81caaa8
int32_t Arg_Table = 0x8150cb7; // 0x8194d20
int32_t BibP_bibhost = 0; // 0x81ae9ac
char BibP_bibhost_available = 0; // 0x81ae9a8
char BibP_bibhost_checked = 0; // 0x81ae9a9
int32_t BibP_globalserver = 0; // 0x81ae9b0
int32_t BookmarkPage = 0; // 0x81ae8ac
char * Color_Strings[16] = {
    "\xf5\x97\x15\b\xfb\x97\x15\b\xff\x97\x15\b\x05\x98\x15\b\v\x98\x15\b\x10\x98\x15\b\x18\x98\x15\b\x1d\x98\x15\b'\x98\x15\b,\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "\xfb\x97\x15\b\xff\x97\x15\b\x05\x98\x15\b\v\x98\x15\b\x10\x98\x15\b\x18\x98\x15\b\x1d\x98\x15\b'\x98\x15\b,\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "\xff\x97\x15\b\x05\x98\x15\b\v\x98\x15\b\x10\x98\x15\b\x18\x98\x15\b\x1d\x98\x15\b'\x98\x15\b,\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "\x05\x98\x15\b\v\x98\x15\b\x10\x98\x15\b\x18\x98\x15\b\x1d\x98\x15\b'\x98\x15\b,\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "\v\x98\x15\b\x10\x98\x15\b\x18\x98\x15\b\x1d\x98\x15\b'\x98\x15\b,\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "\x10\x98\x15\b\x18\x98\x15\b\x1d\x98\x15\b'\x98\x15\b,\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "\x18\x98\x15\b\x1d\x98\x15\b'\x98\x15\b,\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "\x1d\x98\x15\b'\x98\x15\b,\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "'\x98\x15\b,\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    ",\x98\x15\b6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "6\x98\x15\bB\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "B\x98\x15\bI\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "I\x98\x15\bT\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "T\x98\x15\bb\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "b\x98\x15\bm\x98\x15\b\xc2\x99\x15\b\x01",
    "m\x98\x15\b\xc2\x99\x15\b\x01"
}; // 0x8196040
int32_t Config_Table = 0x815fe35; // 0x81976a0
char DTD_recovery = 0; // 0x81aea05
char * DTD_recovery_string = "\xfc\x8a\x15\b"; // 0x8195be8
int32_t DTD_type_values = 1; // 0x8195c00
int32_t DebugSecs = 0; // 0x81caad0
char DisplayCharsetMatchLocale = 1; // 0x819ade0
char FileInitAlreadyDone = 0; // 0x81ae9ef
int32_t * First_tree = NULL; // 0x81afcec
int32_t * Goto_URLs = NULL; // 0x81aea28
char HEAD_request = 0; // 0x81ae893
int32_t HTAAForwardAuth = 0; // 0x81b9464
int32_t HTAA_composeAuthResult = 0; // 0x81b9448
int32_t HTCJK = 0; // 0x81b4080
int32_t HTCSO = 0x81901d3; // 0x81aa2f0
int32_t HTCacheSize = 10; // 0x8194c4c
int32_t HTClientHost = 0; // 0x81b3380
int32_t HTCurSelectGroup = 0; // 0x81ac164
int32_t HTDirAccess = 2; // 0x81a9d40
int32_t HTFTP = 0x8180ccf; // 0x81a9e24
int32_t HTFile = 0x818071c; // 0x81a9e30
int32_t HTFinger = 0x8190ca9; // 0x81aa320
char HTFormDisabled = 0; // 0x81ac190
int32_t HTFormNumber = 0; // 0x81ac15c
int32_t HTGopher = 0x8190508; // 0x81aa2e4
int32_t * HTInternalLink = NULL; // 0x81aea20
int32_t HTL_tagspecs = 0; // 0x81fb4e0
char * HTL_tagspecs_defaults[12] = {
    "\x1c\xf5\x16\b7\xf5\x16\bN\xf5\x16\bh\xf5\x16\b\x83\xf5\x16\b\x9f\xf5\x16\b\xb9\xf5\x16\b\xd1\xf5\x16\b\xeb\xf5\x16\b\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "7\xf5\x16\bN\xf5\x16\bh\xf5\x16\b\x83\xf5\x16\b\x9f\xf5\x16\b\xb9\xf5\x16\b\xd1\xf5\x16\b\xeb\xf5\x16\b\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "N\xf5\x16\bh\xf5\x16\b\x83\xf5\x16\b\x9f\xf5\x16\b\xb9\xf5\x16\b\xd1\xf5\x16\b\xeb\xf5\x16\b\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "h\xf5\x16\b\x83\xf5\x16\b\x9f\xf5\x16\b\xb9\xf5\x16\b\xd1\xf5\x16\b\xeb\xf5\x16\b\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "\x83\xf5\x16\b\x9f\xf5\x16\b\xb9\xf5\x16\b\xd1\xf5\x16\b\xeb\xf5\x16\b\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "\x9f\xf5\x16\b\xb9\xf5\x16\b\xd1\xf5\x16\b\xeb\xf5\x16\b\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "\xb9\xf5\x16\b\xd1\xf5\x16\b\xeb\xf5\x16\b\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "\xd1\xf5\x16\b\xeb\xf5\x16\b\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "\xeb\xf5\x16\b\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "\x05\xf6\x16\b\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "\x1f\xf6\x16\b<\xf6\x16\b\x02",
    "<\xf6\x16\b\x02"
}; // 0x819c000
char (*HTLibraryVersion)[5] = "2.14"; // 0x81aa184
int32_t HTML_dtd = 0x81b42e0; // 0x818b128
int32_t * HTMainAnchor = NULL; // 0x81ac144
int32_t * HTMainText = NULL; // 0x81ac140
int32_t HTNNTP = 0x818f5f1; // 0x81aa22c
int32_t HTNews = 0x818ea5f; // 0x81aa220
int32_t HTNewsPost = 0x818f229; // 0x81aa238
int32_t HTNewsReply = 0x818f5f6; // 0x81aa244
int32_t HTNoDataOK = 0; // 0x81ae7ec
int32_t * HTOutputFormat = NULL; // 0x81b338c
int32_t * HTOutputStream = NULL; // 0x81b3390
char HTPassEightBitNum = 0; // 0x81b4085
char HTPassEightBitRaw = 0; // 0x81b4084
char HTPassHighCtrlNum = 0; // 0x81b4087
char HTPassHighCtrlRaw = 0; // 0x81b4086
char HTPermitRedir = 0; // 0x81b3389
int32_t * HTPresentations = NULL; // 0x81b7f44
int32_t HTRlogin = 0x8190793; // 0x81aa308
int32_t HTSNews = 0x818f600; // 0x81aa250
int32_t HTSNewsPost = 0x818f20b; // 0x81aa25c
int32_t HTSNewsReply = 0x818f215; // 0x81aa268
int32_t * HTSuffixes = NULL; // 0x81b33c4
int32_t HTTP = 0x817f980; // 0x81a9d10
int32_t HTTPS = 0x817f5fe; // 0x81a9d1c
int32_t HTTag_unrecognized = 0; // 0x81b42a0
int32_t HTTelnet = 0x8190a2d; // 0x81aa2fc
int32_t HTTn3270 = 0x819079a; // 0x81aa314
int32_t HTfileSortMethod = 0; // 0x81b3440
char HTlex_buffer[40]; // 0x81fb640
int32_t HTlex_line = 1; // 0x81aa3c0
int32_t * HTlogfile = NULL; // 0x81b3384
int32_t HomeDir = 0; // 0x81af44c
int32_t InfoSecs = 0; // 0x81caaac
int32_t * JThead = NULL; // 0x81b0480
int32_t LATIN1 = -1; // 0x81a97d4
char LYAcceptAllCookies = 0; // 0x81ae894
int32_t LYAcceptEncoding = 15; // 0x8194c9c
int32_t LYAcceptMedia = 1; // 0x8194ca0
int32_t LYAutoUncacheDirLists = 2; // 0x8194c44
int32_t LYCacheSource = 0; // 0x81ac14c
int32_t LYCacheSourceForAborted = 0; // 0x81ac150
char LYCancelDownload = 0; // 0x81b007c
char LYCancelledFetch = 0; // 0x81ae895
int32_t LYCharSet_UC = -1; // 0x819b380
char ** LYCharSets[60] = {
    (char **)0x819ae00,
    (char **)0x819afc0,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL
}; // 0x819b180
int32_t LYChosenShowColor = -1; // 0x8195940
int32_t LYCookieFile = 0; // 0x81ae9b8
int32_t LYCookieSAcceptDomains = 0; // 0x81ae8c0
int32_t LYCookieSaveFile = 0; // 0x81ae9bc
char LYCursesON = 0; // 0x81af034
char LYDefaultRawMode = 0; // 0x81caac4
char LYHaveCJKCharacterSet = 0; // 0x81b064c
int32_t LYHiddenLinks = 1; // 0x8194ca4
int32_t LYHostName = 0; // 0x81ae8d8
char LYJumpFileURL = 0; // 0x81ae820
char * LYLineEditors[3] = {
    "\xa0\xa3\x19\b@\xa6\x19\b\xe0\xa8\x19\bh\x95\x16\bx\x95\x16\b\x8b\x95\x16\b",
    "@\xa6\x19\b\xe0\xa8\x19\bh\x95\x16\bx\x95\x16\b\x8b\x95\x16\b",
    "\xe0\xa8\x19\bh\x95\x16\bx\x95\x16\b\x8b\x95\x16\b"
}; // 0x819adac
char * LYLineeditHelpURLs[3] = {
    "keystrokes/edit_help.html.gz",
    "keystrokes/alt_edit_help.html.gz.gz",
    "keystrokes/bashlike_edit_help.html.gz.gz"
}; // 0x819adc8
char * LYLineeditNames[3] = {
    "Default Binding",
    "Alternate Bindings",
    "Bash-like Bindings"
}; // 0x819adb8
int32_t LYLocalDomain = 0; // 0x81ae8dc
char LYLocaleCharset = 0; // 0x81ae9e1
int32_t LYLynxCGI = 0x816942b; // 0x819a380
int32_t LYLynxCookies = 0x816ee98; // 0x819bde0
int32_t LYLynxIMGmap = 0x816df45; // 0x819bd8c
int32_t LYLynxKeymap = 0x8164d87; // 0x8198ffc
int32_t LYLynxStatusMessages = 0x815e613; // 0x8197280
char LYMBMBlocked = 0; // 0x81ae898
int32_t LYMultiBookmarks = 0; // 0x81ae990
char LYNewsPosting = 1; // 0x8194c6d
char LYNoCc = 0; // 0x81ae9dd
char LYNoCore = 0; // 0x81ae9f4
char LYNoRefererForThis = 0; // 0x81ae899
char LYNoRefererHeader = 0; // 0x81ae89a
char LYNonRestartingSIGWINCH = 0; // 0x81ae9ed
int32_t LYNumCharsets = 0; // 0x81b0650
char LYOutOfMemory = 0; // 0x81b0380
char LYPermitURL = 0; // 0x81ae821
char LYPreparsedSource = 0; // 0x81ae9de
char LYPrependBase = 0; // 0x81aea0f
char LYPrependBaseToSource = 1; // 0x8194cac
char LYPrependCharsetToSource = 1; // 0x8194cad
char LYQuitDefaultYes = 1; // 0x8194cae
char LYRawMode = 0; // 0x81caacc
char LYRefererWithQuery = 68; // 0x8194c6a
int32_t LYRequestReferer = 0; // 0x81aea30
int32_t LYRequestTitle = 0; // 0x81aea2c
char LYRestricted = 0; // 0x81ae822
char LYReuseTempfiles = 0; // 0x81ae9ee
char LYSelectPopups = 1; // 0x8194c6f
char LYSetCookies = 1; // 0x8194c70
int32_t LYShowColor = -1; // 0x8194c54
char LYShowCursor = 0; // 0x81ae823
char LYShowScrollbar = 0; // 0x81ac154
char LYShowTransferRate = 1; // 0x8194c95
int32_t LYStatusLine = -1; // 0x8194c78
int32_t * LYStdinArgs = NULL; // 0x81aea10
char (*LYToolbarName)[18] = "LynxPseudoToolbar"; // 0x81990a8
int32_t * LYTraceLogFP = NULL; // 0x81ae9d4
int32_t LYTraceLogPath = 0; // 0x81ae9d8
int32_t LYTransferName = 0; // 0x81ae9c0
int32_t LYTransferRate = 2; // 0x8194c98
char LYUnderlineLinks = 0; // 0x81ae824
char LYUseBuiltinSuffixes = 1; // 0x8194cc4
char LYUseDefSelPop = 1; // 0x8194c71
char LYUseDefShoCur = 1; // 0x8194c5d
char LYUseDefaultRawMode = 1; // 0x8194c72
char LYUseFormsOptions = 1; // 0x8194c5c
char LYUseMouse = 0; // 0x81ae89b
char LYUseNoviceLineTwo = 1; // 0x8196020
char LYUseTraceLog = 1; // 0x8194ca8
int32_t LYUserAgent = 0; // 0x81ae8e0
int32_t LYUserAgentDefault = 0; // 0x81ae8e4
char LYUserSpecifiedURL = 1; // 0x8194c5e
char LYValidDownloadFile[256]; // 0x8197ca0
char LYValidPermitFile[256]; // 0x81a9b00
char LYValidate = 0; // 0x81ae825
char * LYchar_set_names[2] = {
    "Western (ISO-8859-1)",
    "7 bit approximations (US-ASCII)"
}; // 0x819b280
int32_t LYcols = 80; // 0x8194c7c
char LYforce_HTML_mode = 0; // 0x81ae891
char LYforce_no_cache = 0; // 0x81ae826
char LYinternal_flag = 0; // 0x81ae827
char LYisConfiguredForX = 0; // 0x81ae89c
int32_t LYlines = 24; // 0x8194c80
int32_t LYlowest_eightbit[60] = {160, 999, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}; // 0x819bb00
char LYoverride_no_cache = 0; // 0x81ae828
char LYpsrc = 0; // 0x81b1e66
int32_t LYrcShowColor = -1; // 0x8194c58
char LYresubmit_posts = 0; // 0x81ae829
char LYsb_arrow = 1; // 0x8194b80
int32_t LYsb_begin = -1; // 0x8194b84
int32_t LYsb_end = -1; // 0x8194b88
int32_t * LYscreen = NULL; // 0x81af0cc
int32_t LYshiftWin = 0; // 0x81af028
int32_t LYtableCols = 0; // 0x81af030
char LYtrimInputFields = 0; // 0x81ae82a
char LYuseCursesPads = 1; // 0x8195700
char LYuse_default_colors = 1; // 0x8194cc5
int32_t LYwideLines = 0; // 0x81af02c
int32_t * LYwin = NULL; // 0x81af024
int32_t LastTFPos = -1; // 0x819728c
int32_t * Last_by_first = NULL; // 0x81afcf0
int32_t Latest_first = 0; // 0x81afcb0
int32_t Latest_last = 0; // 0x81afccc
int32_t * Latest_tree = NULL; // 0x81afce8
int32_t LynxHome = 0; // 0x81ae8e8
int32_t * LynxMaps = NULL; // 0x81b0694
int32_t LynxSigFile = 0; // 0x81ae8ec
int32_t * MAIL_edit_history = NULL; // 0x81ac0c4
int32_t MBM_A_subbookmark = 0; // 0x81cb1a0
int32_t MBM_A_subdescript = 0; // 0x81cb120
int32_t Masked_Attr = 0; // 0x81af124
int32_t MessageSecs = 0; // 0x81caaa0
int16_t Mod1Binding[274] = {0, 13, 20, 31, 0x101b, 0x1056, 19, 5, 11, 31, 2, 0x101d, 6, 2, 19, 31, 20, 0, 20, 0, 0, 6, 0, 35, 34, 31, 6, 0, 6, 6, 31, 0, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 6, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 0x1016, 31, 0x1017, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 31, 13, 20, 31, 10, 0x1056, 19, 0x1057, 1, 0x1058, 1, 12, 21, 1, 6, 31, 1, 0, 0, 0, 0, 22, 0, 0, 0, 0, 31, 31, 31, 31, 31, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 6, 6, 0x102c, 31, 0x1033, 0x1035, 31, 0, 31, 31, 31, 31}; // 0x819ab80
int16_t * Mod2Binding = (int16_t *)0x819ab80; // 0x819ada4
int16_t * Mod3Binding = (int16_t *)0x819ab80; // 0x819ada8
int32_t Mono_Attrs = 0x8155638; // 0x8195720
int32_t * NNTP_AuthInfo = NULL; // 0x81b8ff8
int32_t Newline = 0; // 0x81aea3c
int32_t NumOfLines_partial = 0; // 0x81aea38
int32_t Old_DTD = 0; // 0x81ae9d0
int32_t * PrevActiveVisitedLink = NULL; // 0x81afca8
int32_t * PrevVisitedLink = NULL; // 0x81afca4
int32_t ReplaySecs = 0; // 0x81caac0
int32_t SSL_cert_file = 0; // 0x81ae9cc
char * SevenBitApproximations[112] = {
    "\xf1\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf6\x96\x16\b\xf9\x96\x16\b\xfb\x96\x16\b\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xf4\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf6\x96\x16\b\xf9\x96\x16\b\xfb\x96\x16\b\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xf4\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf6\x96\x16\b\xf9\x96\x16\b\xfb\x96\x16\b\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xf4\x96\x16\b\xf4\x96\x16\b\xf4\x96\x16\b\xf6\x96\x16\b\xf9\x96\x16\b\xfb\x96\x16\b\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xf4\x96\x16\b\xf4\x96\x16\b\xf6\x96\x16\b\xf9\x96\x16\b\xfb\x96\x16\b\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xf4\x96\x16\b\xf6\x96\x16\b\xf9\x96\x16\b\xfb\x96\x16\b\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xf6\x96\x16\b\xf9\x96\x16\b\xfb\x96\x16\b\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xf9\x96\x16\b\xfb\x96\x16\b\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xfb\x96\x16\b\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xfe\x96\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x01\x97\x16\b\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x01\x97\x16\b\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x01\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x03\x97\x16\b\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x03\x97\x16\b\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x03\x97\x16\b\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x05\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\a\x97\x16\b\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\a\x97\x16\b\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\a\x97\x16\b\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\t\x97\x16\b\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\f\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x0e\x97\x16\b\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x0e\x97\x16\b\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x0e\x97\x16\b\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x10\x97\x16\b\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x13\x97\x16\b\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x15\x97\x16\b\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x15\x97\x16\b\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x17\x97\x16\b\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x19\x97\x16\b\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x1c\x97\x16\bf\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "f\x96\x16\b\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x15\x97\x16\b\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x15\x97\x16\b\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x19\x97\x16\b\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x1f\x97\x16\b\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x1f\x97\x16\b!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "!\x97\x16\b#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "#\x97\x16\b%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "%\x97\x16\b)\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    ")\x97\x16\b-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "-\x97\x16\b1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "1\x97\x16\b\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xc8\x96\x16\b5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "5\x97\x16\b7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "7\x97\x16\b7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "7\x97\x16\b7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "7\x97\x16\b\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x86\x96\x16\b\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x88\x96\x16\b\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x86\x96\x16\b\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x88\x96\x16\b9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "9\x97\x16\b7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "7\x97\x16\b<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "<\x97\x16\bA\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "A\x97\x16\bF\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "F\x97\x16\b\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x94\x96\x16\b\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x86\x96\x16\bK\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "K\x97\x16\bK\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "K\x97\x16\bM\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "M\x97\x16\bO\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "O\x97\x16\bR\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "R\x97\x16\bK\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "K\x97\x16\bT\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "T\x97\x16\b\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xa6\x96\x16\b\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x86\x96\x16\b\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x86\x96\x16\bW\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "W\x97\x16\bY\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "Y\x97\x16\b\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xac\x96\x16\b\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x86\x96\x16\b[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "[\x97\x16\b_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "_\x97\x16\ba\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "a\x97\x16\ba\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "a\x97\x16\ba\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "a\x97\x16\bc\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "c\x97\x16\bf\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "f\x97\x16\ba\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "a\x97\x16\ba\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "a\x97\x16\bi\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "i\x97\x16\bl\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "l\x97\x16\bo\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "o\x97\x16\br\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "r\x97\x16\b\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xc8\x96\x16\bv\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "v\x97\x16\by\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "y\x97\x16\b}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "}\x97\x16\b\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xd0\x96\x16\b\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x80\x97\x16\b\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x83\x97\x16\b\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x86\x97\x16\b\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x89\x97\x16\b\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x88\x96\x16\b\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x8c\x97\x16\b\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x8e\x97\x16\b\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xde\x96\x16\bW\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "W\x97\x16\bW\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "W\x97\x16\bW\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "W\x97\x16\b\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\xc8\x96\x16\b\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x90\x97\x16\b\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x93\x97\x16\b\x95\x97\x16\b\x93\x97\x16\b",
    "\x95\x97\x16\b\x93\x97\x16\b",
    "\x93\x97\x16\b"
}; // 0x819afc0
int32_t TRANSPARENT = -1; // 0x81a97e0
int32_t UCAssume_MIMEcharset = 0; // 0x81ae8f0
char UCForce8bitTOUPPER = 0; // 0x81ae89d
int32_t UCInfo = 0; // 0x81b2140
int32_t UCInitialized = 0; // 0x81b1ec4
int32_t UCLYhndl_HTFile_for_unspec = -1; // 0x81a97c4
int32_t UCLYhndl_for_unrec = -1; // 0x81a97d0
int32_t UCLYhndl_for_unspec = -1; // 0x81a97cc
int32_t UCNumCharsets = 0; // 0x81b1ec0
char UCSaveBookmarksInUnicode = 0; // 0x81ae89e
int32_t UC_GNhandles[4] = {-1, -1, -1, -1}; // 0x81a8fb0
char * UC_GNsetMIMEnames[4] = {
    "\x10\xcb\x17\b\x1b\xcb\x17\b*\xcb\x17\b0\xcb\x17\b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff",
    "\x1b\xcb\x17\b*\xcb\x17\b0\xcb\x17\b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff",
    "*\xcb\x17\b0\xcb\x17\b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff",
    "0\xcb\x17\b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff"
}; // 0x81a8fa0
int16_t * UC_current_unitable = NULL; // 0x81b2000
int32_t * UC_current_unitable_str = NULL; // 0x81b2004
int16_t * UC_default_unitable = NULL; // 0x81b2120
int32_t * UC_default_unitable_str = NULL; // 0x81b2124
int32_t UC_lastautoGN = 0; // 0x81b2128
int16_t * UC_translate = NULL; // 0x81b1ec8
int32_t URLDomainPrefixes = 0; // 0x81ae8f4
int32_t URLDomainSuffixes = 0; // 0x81ae8f8
int32_t * URL_edit_history = NULL; // 0x81ac0c0
int32_t US_ASCII = -1; // 0x81a97d8
int32_t UTF8_handle = -1; // 0x81a97dc
int32_t * Visited_Links = NULL; // 0x81afca0
int32_t Visited_Links_As = 6; // 0x8197060
int32_t WWW_Download_File = 0; // 0x81b0078
int32_t * WWW_SOURCE = NULL; // 0x81aea24
char WWW_TraceFlag = 0; // 0x81b7f28
int32_t WWW_TraceMask = 0; // 0x81b7f2c
int32_t XLoadImageCommand = 0; // 0x81ae9c4
int32_t adult_table = 0; // 0x81b5fe0
int32_t * always_trusted_exec = (int32_t *)0x8194c10; // 0x8194c34
int32_t always_trusted_exec_default = 0x814f4f1; // 0x8194c10
int32_t anonftp_password = 0; // 0x81ae8fc
char * anonftp_password_string = "d\x89\x15\b"; // 0x8195a68
char * assume_char_set_string = "\x9f\x8b\x15\b\xae\x8b\x15\b\xbc\x8b\x15\b\xc5\x8b\x15\b\xd4\x8b\x15\b\xe2\x8b\x15\b"; // 0x8195cb4
int32_t authentication_info = 0; // 0x81ae900
char bold_H1 = 0; // 0x81ae82c
char bold_headers = 0; // 0x81ae82d
int32_t bookmark_page = 0; // 0x81ae908
char bookmark_start = 0; // 0x81ae89f
int32_t bool_values = 0; // 0x81959c0
int32_t buffstack = 0; // 0x81afd00
int32_t * cache = NULL; // 0x81b94a4
int32_t cached_styles_cols = 0; // 0x81b1c18
int32_t * cached_styles_ptr = NULL; // 0x81b1c10
int32_t cached_styles_rows = 0; // 0x81b1c14
int32_t cached_tag_styles[118]; // 0x81fb260
char can_do_colors = 0; // 0x81afa70
char case_sensitive = 0; // 0x81ae82f
char check_mail = 0; // 0x81ae830
char check_realm = 0; // 0x81ae8a0
char * checked_box = "\x91\xcb\x14\b\x95\xcb\x14\b\x99\xcb\x14\b\x9d\xcb\x14\b\x01"; // 0x8194b70
char * checked_radio = "\x99\xcb\x14\b\x9d\xcb\x14\b\x01"; // 0x8194b78
char child_lynx = 0; // 0x81ae831
char clickable_images = 0; // 0x81ae8a1
int32_t * cmd_logfile = NULL; // 0x81ac0e0
int32_t * cmd_script = NULL; // 0x81ac0e4
int32_t colorPairs = 0; // 0x81b1c1c
int32_t compose_auth_stringResult = 0; // 0x81b944c
char conf_cancelled = 0; // 0x81ac130
int32_t configinfo_url = 0; // 0x81afa80
int32_t * cookie_list = NULL; // 0x81b06a4
int32_t cookie_noprompt = 0; // 0x81caab0
char * cookie_prompt_string = "\x1b\x8a\x15\b/\x8a\x15\b"; // 0x8195b50
char * cookies_accept_all_string = "\x9c\x88\x15\b\xa7\x88\x15\b\xaf\x88\x15\b\xbb\x88\x15\b\xc6\x88\x15\b"; // 0x81959f8
char * cookies_ignore_all_string = "\x8c\x88\x15\b\x93\x88\x15\b\x9c\x88\x15\b\xa7\x88\x15\b\xaf\x88\x15\b\xbb\x88\x15\b\xc6\x88\x15\b"; // 0x81959f0
char * cookies_string = "\x80\x88\x15\b\x8c\x88\x15\b\x93\x88\x15\b\x9c\x88\x15\b\xa7\x88\x15\b\xaf\x88\x15\b\xbb\x88\x15\b\xc6\x88\x15\b"; // 0x81959ec
char * cookies_up_to_user_string = "\x93\x88\x15\b\x9c\x88\x15\b\xa7\x88\x15\b\xaf\x88\x15\b\xbb\x88\x15\b\xc6\x88\x15\b"; // 0x81959f4
char crawl = 0; // 0x81ae8a2
int32_t crawl_count = 0; // 0x81ae994
char csi_is_csi = 1; // 0x81944a4
int32_t curdoc = 0; // 0x81aefe0
int32_t current_char_set = -1; // 0x819ade4
int32_t current_docname = 0; // 0x81b9460
int32_t current_hostname = 0; // 0x81b945c
int32_t current_lineedit = 0; // 0x81b0640
int32_t * current_prot = NULL; // 0x81b947c
char debug_display_partial = 0; // 0x81ae9ec
int32_t default_UChndl = -1; // 0x81a97c0
int32_t default_bg = -1; // 0x8196028
char default_color_reset = 0; // 0x81afa79
int32_t default_fg = -1; // 0x8196024
int32_t * default_presentation = NULL; // 0x81b7f48
int32_t * default_prot = NULL; // 0x81b9478
int32_t defmenu = 0; // 0x81a9800
int32_t dfont_replacedesc = 2610; // 0x81764a0
int16_t dfont_unitable[616] = {32, 0x1360, 0x2000, 0x2002, 0x2004, 0x2005, 0x2006, 0x2007, 0x2008, 0x2009, 0x205f, 0x3000, 0x303f, 33, -255, 34, 0x201c, 0x201d, 0x201e, 0x201f, -254, -158, -157, 35, 1488, -253, 36, -252, 37, -251, 38, -250, 39, 769, 0x2019, 0x201a, 0x201b, -249, 40, -248, 41, -247, 42, 638, 0x2721, 0x272a, 0x272b, 0x272c, 0x272d, 0x272e, 0x272f, 0x2730, 0x2731, 0x2732, 0x2733, 0x2734, 0x2735, 0x2736, 0x2737, 0x2738, 0x2739, 0x273a, 0x273b, 0x273c, 0x273d, 0x2742, 0x2743, 0x2744, 0x2745, 0x2746, 0x2747, 0x2748, 0x2749, 0x274a, 0x274b, -246, 43, 726, 0x250c, 0x250d, 0x250e, 0x250f, 0x2510, 0x2511, 0x2512, 0x2513, 0x2514, 0x2515, 0x2516, 0x2517, 0x2518, 0x2519, 0x251a, 0x251b, 0x251c, 0x251d, 0x251e, 0x251f, 0x2520, 0x2521, 0x2522, 0x2523, 0x2524, 0x2525, 0x2526, 0x2527, 0x2528, 0x2529, 0x252a, 0x252b, 0x252c, 0x252d, 0x252e, 0x252f, 0x2530, 0x2531, 0x2532, 0x2533, 0x2534, 0x2535, 0x2536, 0x2537, 0x2538, 0x2539, 0x253a, 0x253b, 0x253c, 0x253d, 0x253e, 0x253f, 0x2540, 0x2541, 0x2542, 0x2543, 0x2544, 0x2545, 0x2546, 0x2547, 0x2548, 0x2549, 0x254a, 0x254b, 0x254c, 0x254d, 0x254e, 0x254f, 0x2550, 0x2551, 0x2552, 0x2553, 0x2554, 0x2555, 0x2556, 0x2557, 0x2558, 0x2559, 0x255a, 0x255b, 0x255c, 0x255d, 0x255e, 0x255f, 0x2560, 0x2561, 0x2562, 0x2563, 0x2564, 0x2565, 0x2566, 0x2567, 0x2568, 0x2569, 0x256a, 0x256b, 0x256c, -245, 44, 806, 807, 0x1363, -244, -156, 45, 727, 809, 0x2010, 0x2011, 0x2013, 0x2015, -243, 46, 802, 803, 0x2024, -242, -159, 47, 823, 824, 0x2215, -241, 48, -240, 49, -239, 50, -238, 51, -237, 52, -236, 53, -235, 54, -234, 55, -233, 56, -232, 57, -231, 58, 720, 1474, 0x1361, -230, 59, 690, 801, -229, 60, -228, 61, -227, 62, -226, 63, 660, -225, 64, 601, -224, 65, 192, 193, 194, 195, 256, 258, 260, 461, 593, 0x1f08, -223, 66, -222, 67, 262, 264, 266, 268, 0x132d, -221, 68, 270, 0x12fd, -220, 69, 200, 201, 202, 203, 274, 276, 278, 280, 282, 603, 0x12a4, -219, 70, -218, 71, 284, 286, 288, 290, 486, 500, 610, 0x131d, -217, 72, 292, 295, 0x1215, -216, 73, 204, 205, 206, 207, 296, 298, 300, 302, 304, 463, 618, 617, 0x12a5, -215, 74, 308, 607, -214, 75, 310, 488, 0x12bd, 0x212a, -213, 76, 313, 315, 317, 619, 620, 671, -212, 77, 625, -211, 78, 209, 323, 325, 327, 331, 0x129d, -210, 79, 210, 211, 212, 213, 332, 334, 465, 490, 596, -209, 80, 0x1335, -208, 81, 611, 0x1255, -207, 82, 340, 342, 344, 602, 640, -206, 83, 346, 348, 350, 352, 643, -205, 84, 354, 356, 0x1325, -204, 85, 217, 218, 219, 360, 362, 364, 366, 370, 467, 631, 650, -203, 86, 652, -202, 87, 372, -201, 88, 0x2611, 0x2612, 0x2713, 0x2714, 0x2717, 0x2718, -200, 89, 221, 374, 376, -199, 90, 377, 379, 381, 541, 0x12e5, -198, 91, 810, -197, 92, -196, 93, -195, 94, 770, -194, 95, -193, 96, 700, 768, 0x2018, -192, 97, 225, 226, 227, 257, 259, 261, 462, 1463, 0x12a3, 0x1f00, -191, 98, 0x1265, -190, 99, 263, 265, 267, 269, 0x127d, -189, 100, 271, 0x12f5, -188, 101, 232, 233, 234, 235, 275, 277, 279, 281, 283, 0x12a0, -187, 102, -186, 103, 285, 287, 289, 291, 487, 501, 609, 0x130d, 0x210a, -185, 104, 293, 1471, 0x1205, 0x210e, -184, 105, 237, 238, 239, 297, 299, 301, 303, 305, 464, 1460, 0x12a2, -183, 106, 309, 496, 669, 0x1305, -182, 107, 311, 489, 0x12ad, -181, 108, 314, 316, 318, 0x120d, -180, 109, 0x121d, -179, 110, 241, 324, 326, 328, 0x1295, -178, 111, 242, 243, 244, 245, 333, 335, 466, 491, 1464, 0x12a6, 0x134d, 0x2134, -177, 112, 0x1355, -176, 113, 0x1245, -175, 114, 341, 343, 345, 633, 0x122d, -174, 115, 347, 349, 351, 353, 0x1235, -173, 116, 355, 357, 0x1275, -172, 117, 249, 250, 251, 361, 363, 365, 367, 371, 468, 1468, 0x12a1, -171, 118, 1520, 0x126d, -170, 119, 373, 0x12cd, -169, 120, -168, 121, 253, 255, 375, 0x12ed, -167, 122, 378, 380, 382, 0x12dd, -166, 123, -165, 124, 781, -164, 125, -163, 126, 771, 820, -162}; // 0x8174160
int16_t dfont_unitable_cp437[247] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 199, 252, 971, 233, 226, 228, 224, 229, 231, 234, 235, 232, 239, 970, 238, 236, 196, 197, 201, 904, 230, 198, 244, 246, 242, 251, 249, 255, 214, 220, 939, 162, 163, 165, 0x20a7, 402, 225, 940, 237, 943, 243, 972, 250, 973, 241, 209, 170, 186, 191, 0x2310, 172, 189, 188, 161, 171, 187, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556, 0x2555, 0x2563, 0x2551, 0x2557, 0x255d, 0x255c, 0x255b, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 0x255e, 0x255f, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 0x2567, 0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256b, 0x256a, 0x2518, 0x250c, 0x2588, 0x2584, 0x258c, 0x2590, 0x2580, 945, 223, 946, 915, 960, 931, 0x2211, 963, 181, 956, 964, 934, 920, 952, 937, 0x2126, 948, 0x221e, 966, 248, 949, 0x2208, 0x220a, 0x2229, 0x2261, 177, 0x2265, 0x2267, 0x2264, 0x2266, 0x2320, 643, 0x2321, 247, 0x2248, 176, 778, 0x2219, 775, 903, 183, 0x2027, 0x221a, 0x207f, 178, 0x25a0, 160}; // 0x81723a0
int16_t dfont_unitable_cp737[231] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 931, 932, 933, 934, 935, 936, 937, 945, 946, 947, 611, 948, 949, 950, 951, 952, 953, 305, 954, 955, 956, 181, 957, 958, 959, 960, 961, 963, 962, 964, 965, 650, 966, 967, 968, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556, 0x2555, 0x2563, 0x2551, 0x2557, 0x255d, 0x255c, 0x255b, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 0x255e, 0x255f, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 0x2567, 0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256b, 0x256a, 0x2518, 0x250c, 0x2588, 0x2584, 0x258c, 0x2590, 0x2580, 969, 940, 941, 942, 970, 943, 972, 973, 971, 252, 974, 902, 904, 905, 906, 908, 910, 911, 177, 0x2265, 0x2264, 938, 939, 247, 0x2248, 176, 0x2219, 775, 903, 183, 0x221a, 0x207f, 178, 0x25a0, 160}; // 0x81726e0
int16_t dfont_unitable_cp775[223] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 262, 252, 233, 257, 228, 291, 229, 263, 322, 275, 342, 343, 299, 377, 196, 197, 201, 230, 198, 333, 246, 290, 162, 346, 347, 214, 220, 248, 163, 216, 215, 164, 256, 298, 243, 379, 380, 378, 0x201d, 166, 169, 174, 172, 189, 188, 321, 171, 187, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 260, 268, 280, 278, 0x2563, 0x2551, 0x2557, 0x255d, 302, 352, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 370, 362, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 381, 261, 269, 281, 279, 303, 353, 371, 363, 382, 0x2518, 0x250c, 0x2588, 0x2584, 0x258c, 0x2590, 0x2580, 211, 223, 332, 323, 245, 213, 181, 324, 310, 311, 315, 316, 326, 274, 325, 0x2019, 173, 177, 0x201c, 190, 182, 167, 247, 0x201e, 176, 0x2219, 183, 185, 179, 178, 0x25a0, 160}; // 0x81729e0
int16_t dfont_unitable_cp850[247] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 199, 252, 971, 233, 941, 226, 228, 224, 229, 231, 234, 235, 232, 239, 970, 238, 236, 196, 197, 201, 904, 230, 198, 244, 246, 242, 251, 249, 255, 214, 220, 939, 248, 163, 216, 215, 402, 225, 940, 237, 943, 243, 972, 250, 973, 241, 209, 170, 186, 191, 174, 172, 189, 188, 161, 171, 187, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 193, 902, 194, 192, 169, 0x2563, 0x2551, 0x2557, 0x255d, 162, 165, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 227, 195, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 164, 240, 208, 202, 203, 200, 305, 953, 205, 906, 206, 207, 938, 0x2518, 0x250c, 0x2588, 0x2584, 166, 204, 0x2580, 211, 908, 223, 212, 210, 245, 213, 181, 956, 254, 222, 218, 219, 217, 253, 221, 175, 772, 180, 769, 173, 177, 0x2017, 819, 190, 182, 167, 247, 184, 807, 176, 778, 168, 776, 183, 775, 903, 0x2027, 185, 179, 178, 0x25a0, 160}; // 0x8172cc0
int16_t dfont_unitable_cp852[251] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 199, 252, 971, 233, 941, 226, 228, 367, 263, 231, 322, 235, 336, 337, 238, 377, 196, 262, 201, 904, 313, 314, 244, 246, 317, 318, 346, 347, 214, 220, 939, 356, 357, 321, 215, 269, 679, 1095, 225, 940, 237, 943, 243, 972, 250, 973, 260, 261, 381, 1046, 382, 1078, 280, 281, 172, 378, 268, 1063, 351, 171, 187, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 193, 902, 194, 282, 350, 0x2563, 0x2551, 0x2557, 0x255d, 379, 380, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 258, 259, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 164, 273, 272, 270, 203, 271, 327, 205, 906, 206, 283, 0x2518, 0x250c, 0x2588, 0x2584, 354, 366, 0x2580, 211, 908, 223, 212, 323, 324, 328, 352, 1064, 353, 1096, 340, 218, 341, 368, 253, 221, 355, 180, 769, 173, 733, 779, 731, 808, 711, 780, 728, 774, 167, 247, 184, 807, 176, 778, 168, 776, 729, 775, 903, 369, 344, 345, 0x25a0, 160}; // 0x8172fe0
int16_t dfont_unitable_cp857[221] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 199, 252, 233, 226, 228, 224, 229, 231, 234, 235, 232, 239, 238, 305, 196, 197, 201, 230, 198, 244, 246, 242, 251, 249, 304, 214, 220, 248, 163, 216, 350, 351, 225, 237, 243, 250, 241, 209, 286, 287, 191, 174, 172, 189, 188, 161, 171, 187, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 193, 194, 192, 169, 0x2563, 0x2551, 0x2557, 0x255d, 162, 165, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 227, 195, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 164, 186, 170, 202, 203, 200, 205, 206, 207, 0x2518, 0x250c, 0x2588, 0x2584, 166, 204, 0x2580, 211, 223, 212, 210, 245, 213, 181, 215, 218, 219, 217, 236, 255, 175, 180, 173, 177, 190, 182, 167, 247, 184, 176, 168, 183, 185, 179, 178, 0x25a0, 160}; // 0x8173300
int16_t dfont_unitable_cp862[224] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 1488, 1489, 1490, 1491, 1492, 1493, 1494, 1495, 1496, 1497, 1498, 1499, 1500, 1501, 1502, 1503, 1504, 1505, 1506, 1507, 1508, 1509, 1510, 1511, 1512, 1513, 1514, 162, 163, 165, 0x20a7, 402, 225, 237, 243, 250, 241, 209, 170, 186, 191, 0x2310, 172, 189, 188, 161, 171, 187, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556, 0x2555, 0x2563, 0x2551, 0x2557, 0x255d, 0x255c, 0x255b, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 0x255e, 0x255f, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 0x2567, 0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256b, 0x256a, 0x2518, 0x250c, 0x2588, 0x2584, 0x258c, 0x2590, 0x2580, 945, 223, 915, 960, 931, 963, 181, 964, 934, 920, 937, 948, 0x221e, 966, 949, 0x2229, 0x2261, 177, 0x2265, 0x2264, 0x2320, 0x2321, 247, 0x2248, 176, 0x2219, 183, 0x221a, 0x207f, 178, 0x25a0, 160}; // 0x81735e0
int16_t dfont_unitable_cp864[218] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 176, 183, 0x2219, 0x221a, 0x2592, 0x2500, 0x2502, 0x253c, 0x2524, 0x252c, 0x251c, 0x2534, 0x2510, 0x250c, 0x2514, 0x2518, 946, 0x221e, 966, 177, 189, 188, 0x2248, 171, 187, -265, -264, -261, -260, 160, 173, -382, 163, 164, -380, -370, -369, -363, -359, 1548, -355, -351, -347, 1632, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, -303, 1563, -335, -331, -327, 1567, 162, -384, -383, -381, -379, -310, -373, -371, -367, -365, -361, -357, -353, -349, -345, -343, -341, -339, -337, -333, -329, -325, -321, -319, -315, -309, -305, 166, 172, 247, 215, -311, 1600, -301, -297, -293, -289, -285, -281, -277, -275, -273, -269, -323, -308, -306, -307, -287, -387, 1617, -283, -279, -276, -272, -270, -304, -299, -267, -266, -291, -295, -271, 0x25a0}; // 0x81738c0
int16_t dfont_unitable_cp866[224] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556, 0x2555, 0x2563, 0x2551, 0x2557, 0x255d, 0x255c, 0x255b, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 0x255e, 0x255f, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 0x2567, 0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256b, 0x256a, 0x2518, 0x250c, 0x2588, 0x2584, 0x258c, 0x2590, 0x2580, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103, 1025, 1105, 1028, 1108, 1031, 1111, 1038, 1118, 176, 0x2219, 183, 0x221a, 0x2116, 164, 0x25a0, 160}; // 0x8173ba0
int16_t dfont_unitable_cp866u[224] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556, 0x2555, 0x2563, 0x2551, 0x2557, 0x255d, 0x255c, 0x255b, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 0x255e, 0x255f, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 0x2567, 0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256b, 0x256a, 0x2518, 0x250c, 0x2588, 0x2584, 0x258c, 0x2590, 0x2580, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103, 1025, 1105, 1168, 1169, 1028, 1108, 1030, 1110, 1031, 1111, 183, 0x221a, 0x2116, 164, 0x25a0, 160}; // 0x817c380
int16_t dfont_unitable_cp869[217] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 902, 183, 172, 166, 0x2018, 701, 0x2019, 700, 904, 0x2015, 905, 906, 938, 908, 910, 939, 169, 911, 178, 179, 940, 163, 941, 942, 943, 970, 912, 972, 973, 913, 914, 915, 916, 917, 918, 919, 189, 920, 921, 171, 187, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 922, 923, 924, 925, 0x2563, 0x2551, 0x2557, 0x255d, 926, 927, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 928, 929, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 931, 932, 933, 934, 935, 936, 937, 945, 946, 947, 0x2518, 0x250c, 0x2588, 0x2584, 948, 949, 0x2580, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 963, 962, 964, 900, 173, 177, 965, 966, 967, 167, 968, 901, 176, 168, 969, 971, 944, 974, 0x25a0, 160}; // 0x8173e80
int16_t dfont_unitable_dec_mcs[176] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 161, 162, 163, 165, 167, 164, 169, 170, 171, 176, 177, 178, 179, 181, 182, 183, 185, 186, 187, 188, 189, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 209, 210, 211, 212, 213, 214, 338, 216, 217, 218, 219, 220, 376, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 241, 242, 243, 244, 245, 246, 339, 248, 249, 250, 251, 252, 255}; // 0x81765c0
int16_t dfont_unitable_hp_roman8[190] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 192, 194, 200, 202, 203, 206, 207, 180, 715, 710, 168, 732, 217, 219, 0x20a4, 175, 221, 253, 176, 199, 231, 209, 241, 161, 191, 164, 163, 165, 167, 402, 162, 226, 234, 244, 251, 225, 233, 243, 250, 224, 232, 242, 249, 228, 235, 246, 252, 197, 238, 216, 198, 229, 237, 248, 230, 196, 236, 214, 220, 201, 239, 223, 212, 193, 195, 227, 208, 240, 205, 204, 211, 210, 213, 245, 352, 353, 218, 376, 255, 222, 254, 183, 181, 182, 190, 0x2014, 188, 189, 170, 186, 171, 0x25a0, 187, 177}; // 0x8176840
int16_t dfont_unitable_iso_8859_1[201] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 0x2007, 161, 162, 163, 164, 165, 166, 167, 168, 776, 169, 170, 171, 172, 173, 174, 175, 772, 176, 778, 177, 178, 179, 180, 181, 956, 182, 183, 775, 903, 0x2027, 184, 807, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 272, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255}; // 0x8176ae0
int16_t dfont_unitable_iso_8859_10[191] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 260, 274, 290, 298, 296, 310, 167, 315, 272, 352, 358, 381, 173, 362, 330, 176, 261, 275, 291, 299, 297, 311, 183, 316, 273, 353, 359, 382, 0x2015, 363, 331, 256, 193, 194, 195, 196, 197, 198, 302, 268, 201, 280, 203, 278, 205, 206, 207, 208, 325, 332, 211, 212, 213, 214, 360, 216, 370, 218, 219, 220, 221, 222, 223, 257, 225, 226, 227, 228, 229, 230, 303, 269, 233, 281, 235, 279, 237, 238, 239, 240, 326, 333, 243, 244, 245, 246, 361, 248, 371, 250, 251, 252, 253, 254, 312}; // 0x8178280
int16_t dfont_unitable_iso_8859_13[191] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 0x201d, 162, 163, 164, 0x201e, 166, 167, 216, 169, 342, 171, 172, 173, 174, 198, 176, 177, 178, 179, 0x201c, 181, 182, 183, 248, 185, 343, 187, 188, 189, 190, 230, 260, 302, 256, 262, 196, 197, 280, 274, 268, 201, 377, 278, 290, 310, 298, 315, 352, 323, 325, 211, 332, 213, 214, 215, 370, 321, 346, 362, 220, 379, 381, 223, 261, 303, 257, 263, 228, 229, 281, 275, 269, 233, 378, 279, 291, 311, 299, 316, 353, 324, 326, 243, 333, 245, 246, 247, 371, 322, 347, 363, 252, 380, 382, 0x2019}; // 0x8178520
int16_t dfont_unitable_iso_8859_14[191] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 0x1e02, 0x1e03, 163, 266, 267, 0x1e0a, 167, 0x1e80, 169, 0x1e82, 0x1e0b, 0x1ef2, 173, 174, 376, 0x1e1e, 0x1e1f, 288, 289, 0x1e40, 0x1e41, 182, 0x1e56, 0x1e81, 0x1e57, 0x1e83, 0x1e60, 0x1ef3, 0x1e84, 0x1e85, 0x1e61, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 372, 209, 210, 211, 212, 213, 214, 0x1e6a, 216, 217, 218, 219, 220, 221, 374, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 373, 241, 242, 243, 244, 245, 246, 0x1e6b, 248, 249, 250, 251, 252, 253, 375, 255}; // 0x81787c0
int16_t dfont_unitable_iso_8859_15[191] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 161, 162, 163, 0x20ac, 165, 352, 167, 353, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 381, 181, 182, 183, 381, 185, 186, 187, 338, 339, 376, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255}; // 0x8178a60
int16_t dfont_unitable_iso_8859_2[209] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 260, 728, 774, 321, 164, 317, 346, 167, 168, 776, 352, 1064, 350, 356, 377, 173, 381, 1046, 379, 176, 778, 261, 731, 808, 322, 180, 318, 347, 711, 780, 184, 807, 353, 1096, 351, 357, 378, 733, 779, 382, 1078, 380, 340, 193, 194, 258, 196, 313, 262, 199, 268, 1063, 201, 280, 203, 282, 205, 206, 270, 272, 208, 323, 327, 211, 212, 336, 214, 215, 183, 344, 366, 218, 368, 220, 221, 354, 223, 341, 225, 226, 259, 228, 314, 263, 231, 269, 679, 1095, 233, 281, 235, 283, 237, 238, 271, 273, 324, 328, 243, 244, 337, 246, 247, 345, 367, 250, 369, 252, 253, 355, 729, 775, 903}; // 0x8176e60
int16_t dfont_unitable_iso_8859_3[184] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 294, 728, 163, 164, 292, 167, 168, 304, 350, 286, 308, 173, 379, 176, 295, 178, 179, 180, 181, 293, 183, 184, 305, 351, 287, 309, 189, 380, 192, 193, 194, 196, 266, 264, 199, 200, 201, 202, 203, 204, 205, 206, 207, 209, 210, 211, 212, 288, 214, 215, 284, 217, 218, 219, 220, 364, 348, 223, 224, 225, 226, 228, 267, 265, 231, 232, 233, 234, 235, 236, 237, 238, 239, 241, 242, 243, 244, 289, 246, 247, 285, 249, 250, 251, 252, 365, 349, 729}; // 0x8177120
int16_t dfont_unitable_iso_8859_4[97] = {160, 260, 312, 342, 164, 296, 315, 167, 168, 352, 274, 290, 358, 173, 381, 175, 176, 261, 731, 343, 180, 297, 316, 711, 184, 353, 275, 291, 359, 330, 382, 331, 256, 193, 194, 195, 196, 197, 198, 302, 268, 201, 280, 203, 278, 205, 206, 298, 272, 208, 325, 332, 310, 212, 213, 214, 215, 216, 370, 218, 219, 220, 360, 362, 223, 257, 225, 226, 227, 228, 229, 230, 303, 269, 233, 281, 235, 279, 237, 238, 299, 273, 326, 333, 311, 244, 245, 246, 247, 248, 371, 250, 251, 252, 361, 363, 729}; // 0x81773a0
int16_t dfont_unitable_iso_8859_5[208] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 1025, 1026, 1027, 1028, 1029, 1030, 304, 1031, 938, 1032, 1033, 1034, 1035, 1036, 173, 1038, 1039, 1040, 1041, 1042, 1043, 915, 1044, 1045, 1046, 381, 1047, 1048, 1049, 1050, 1051, 923, 1052, 1053, 1054, 1055, 928, 1056, 1057, 1058, 1059, 1060, 934, 1061, 1062, 1063, 268, 1064, 352, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 382, 1079, 1080, 1081, 1082, 1083, 955, 1084, 1085, 1086, 1087, 960, 1088, 1089, 1090, 1091, 1092, 966, 1093, 1094, 1095, 269, 1096, 353, 1097, 1098, 1099, 305, 1100, 1101, 1102, 1103, 0x2116, 1105, 1106, 1107, 1108, 1109, 1110, 1111, 970, 1112, 1113, 1114, 1115, 1116, 167, 1118, 1119}; // 0x8177580
int16_t dfont_unitable_iso_8859_6[146] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 164, 1548, 173, 1563, 1567, 1569, 1570, 1571, 1572, 1573, 1574, 1575, 1576, 1577, 1578, 1579, 1580, 1581, 1582, 1583, 1584, 1585, 1586, 1587, 1588, 1589, 1590, 1591, 1592, 1593, 1594, 1600, 1601, 1602, 1603, 1604, 1605, 1606, 1607, 1608, 1609, 1610, 1611, 1612, 1613, 1614, 1615, 1616, 1617, 1618}; // 0x8177840
int16_t dfont_unitable_iso_8859_7[220] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 701, 0x2018, 881, 700, 0x2019, 882, 163, 0x20ac, 0x20af, 166, 167, 168, 169, 890, 171, 172, 173, 0x2015, 176, 177, 178, 179, 900, 901, 902, 0x1fbb, 183, 775, 903, 0x2027, 904, 0x1fc9, 905, 0x1fcb, 906, 0x1fdb, 187, 908, 0x1ff9, 189, 910, 0x1feb, 911, 0x1ffb, 912, 913, 914, 915, 1043, 916, 917, 918, 919, 920, 921, 922, 923, 1051, 924, 925, 926, 927, 928, 1055, 929, 931, 932, 933, 934, 1060, 935, 1061, 936, 937, 938, 939, 940, 0x1f71, 941, 0x1f73, 942, 0x1f75, 943, 0x1f77, 944, 945, 946, 947, 611, 948, 240, 949, 950, 951, 952, 953, 305, 954, 955, 956, 181, 957, 958, 959, 960, 961, 962, 963, 964, 965, 650, 966, 967, 968, 969, 970, 971, 252, 972, 0x1f79, 973, 0x1f7b, 974, 0x1f7d}; // 0x8177a80
int16_t dfont_unitable_iso_8859_8[155] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 162, 163, 164, 165, 166, 167, 168, 169, 215, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 247, 187, 188, 189, 190, 0x2017, 1488, 1489, 1490, 1491, 1492, 1493, 1494, 1495, 1496, 1497, 1498, 1499, 1500, 1501, 1502, 1503, 1504, 1505, 1506, 1507, 1508, 1509, 1510, 1511, 1512, 1513, 1514, 0x200e, 0x200f}; // 0x8177d60
int16_t dfont_unitable_iso_8859_9[205] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 1067, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 160, 161, 162, 163, 164, 165, 166, 167, 168, 776, 169, 170, 171, 172, 173, 174, 175, 772, 176, 778, 177, 178, 179, 180, 181, 956, 182, 183, 775, 903, 184, 807, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 286, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 304, 1048, 1030, 350, 1064, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 287, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 305, 953, 1099, 351, 1096, 255}; // 0x8177fc0
int16_t dfont_unitable_koi8_r[239] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 0x2500, 0x2502, 0x250c, 0x2510, 0x2514, 0x2518, 0x251c, 0x2524, 0x252c, 0x2534, 0x253c, 0x2580, 0x2584, 0x2588, 0x258c, 0x2590, 0x2591, 0x2592, 0x2593, 0x2320, 0x25a0, 0x2219, 0x221a, 0x2248, 0x2264, 0x2265, 160, 0x2321, 176, 178, 183, 0x2027, 247, 0x2550, 0x2551, 0x2552, 1105, 0x2553, 0x2554, 0x2555, 0x2556, 0x2557, 0x2558, 0x2559, 0x255a, 0x255b, 0x255c, 0x255d, 0x255e, 0x255f, 0x2560, 0x2561, 1025, 0x2562, 0x2563, 0x2564, 0x2565, 0x2566, 0x2567, 0x2568, 0x2569, 0x256a, 0x256b, 0x256c, 169, 1102, 1072, 1073, 1094, 1076, 1077, 1092, 966, 1075, 1093, 1080, 1081, 1082, 1083, 955, 1084, 1085, 1086, 1087, 960, 1103, 1088, 1089, 1090, 1091, 1078, 382, 1074, 1100, 1099, 305, 1079, 1096, 353, 1101, 1097, 1095, 269, 1098, 1070, 1040, 1041, 1062, 1044, 1045, 1060, 934, 1043, 915, 1061, 1048, 1049, 1050, 1051, 923, 1052, 1053, 1054, 1055, 928, 1071, 1056, 1057, 1058, 1059, 1046, 381, 1042, 1068, 1067, 1047, 1064, 352, 1069, 1065, 1063, 268, 1066}; // 0x8178d00
int16_t dfont_unitable_koi8_u[224] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 0x2500, 0x2502, 0x250c, 0x2510, 0x2514, 0x2518, 0x251c, 0x2524, 0x252c, 0x2534, 0x253c, 0x2580, 0x2584, 0x2588, 0x258c, 0x2590, 0x2591, 0x2592, 0x2593, 0x2320, 0x25a0, 0x2219, 0x221a, 0x2248, 0x2264, 0x2265, 160, 0x2321, 176, 178, 183, 247, 0x2550, 0x2551, 0x2552, 1105, 1108, 0x2554, 1110, 1111, 0x2557, 0x2558, 0x2559, 0x255a, 0x255b, 1169, 0x255d, 0x255e, 0x255f, 0x2560, 0x2561, 1025, 1028, 0x2563, 1030, 1031, 0x2566, 0x2567, 0x2568, 0x2569, 0x256a, 1168, 0x256c, 169, 1102, 1072, 1073, 1094, 1076, 1077, 1092, 1075, 1093, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1103, 1088, 1089, 1090, 1091, 1078, 1074, 1100, 1099, 1079, 1096, 1101, 1097, 1095, 1098, 1070, 1040, 1041, 1062, 1044, 1045, 1060, 1043, 1061, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1071, 1056, 1057, 1058, 1059, 1046, 1042, 1068, 1067, 1047, 1064, 1069, 1065, 1063, 1066}; // 0x817c660
int16_t dfont_unitable_macintosh[226] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 196, 197, 199, 201, 209, 214, 220, 225, 224, 226, 228, 227, 229, 231, 233, 232, 234, 235, 237, 236, 238, 239, 241, 243, 242, 244, 246, 245, 250, 249, 251, 252, 0x2020, 176, 162, 163, 167, 0x2022, 182, 223, 174, 169, 0x2122, 180, 168, 0x2260, 198, 216, 0x221e, 177, 0x2264, 0x2265, 165, 181, 0x2202, 0x2211, 0x220f, 960, 0x222b, 170, 186, 0x2126, 230, 248, 191, 161, 172, 0x221a, 402, 0x2248, 0x2206, 171, 187, 0x2026, 160, 192, 195, 213, 338, 339, 0x2013, 0x2014, 0x201c, 0x201d, 0x2018, 0x2019, 247, 0x25ca, 255, 376, 0x2044, 164, 0x2039, 0x203a, -1279, -1278, 0x2021, 183, 775, 903, 0x2027, 0x201a, 0x201e, 0x2030, 194, 202, 193, 203, 200, 205, 206, 207, 204, 211, 212, 210, 218, 219, 217, 305, 710, 732, 175, 728, 729, 730, 184, 733, 731, 711}; // 0x8179000
int16_t dfont_unitable_mnemonic[1]; // 0x81792e0
int16_t dfont_unitable_mnemonic_ascii_0[1]; // 0x817b860
int16_t dfont_unitable_next[222] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 160, 192, 193, 194, 195, 196, 197, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 217, 218, 219, 220, 221, 222, 181, 215, 247, 169, 161, 162, 163, 0x2044, 165, 402, 167, 164, 0x2019, 0x201c, 171, 0x2039, 0x203a, -1279, -1278, 174, 0x2013, 0x2020, 0x2021, 183, 166, 182, 0x2022, 0x201a, 0x201e, 0x201d, 187, 0x2026, 0x2030, 172, 191, 185, 715, 180, 710, 732, 175, 728, 729, 168, 178, 730, 184, 179, 733, 731, 711, 0x2014, 177, 188, 189, 190, 224, 225, 226, 227, 228, 229, 231, 232, 233, 234, 235, 236, 198, 237, 170, 238, 239, 240, 241, 321, 216, 338, 186, 242, 243, 244, 245, 246, 230, 249, 250, 251, 305, 252, 253, 322, 248, 339, 223, 254, 255}; // 0x817b580
int16_t dfont_unitable_ptcp154[223] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 1174, 1170, 1262, 1171, 0x201e, 0x2026, 1206, 1198, 1202, 1199, 1184, 1250, 1186, 1178, 1210, 1208, 1175, 0x2018, 0x2019, 0x201c, 0x201d, 0x2022, 0x2013, 0x2014, 1203, 1207, 1185, 1251, 1187, 1179, 1211, 1209, 160, 1038, 1118, 1032, 1256, 1176, 1200, 167, 1025, 169, 1240, 171, 172, 1263, 174, 1180, 176, 1201, 1030, 1110, 1177, 1257, 182, 183, 1105, 0x2116, 1241, 187, 1112, 1194, 1195, 1181, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103}; // 0x817c940
int16_t dfont_unitable_viscii[142] = {0x1eb2, 0x1eb4, 0x1eaa, 9, 10, 12, 13, 0x1ef6, 0x1ef6, 0x1ef4, 0x1ef8, 26, 0x1ef4, 0x1ea0, 0x1eae, 0x1eb0, 0x1eb6, 0x1ea4, 0x1ea6, 0x1ea8, 0x1eac, 0x1ebc, 0x1eb8, 0x1ebe, 0x1ec0, 0x1ec2, 0x1ec4, 0x1ec6, 0x1ed0, 0x1ed2, 0x1ed4, 0x1ed6, 0x1ed8, 0x1ee2, 0x1eda, 0x1edc, 0x1ede, 0x1eca, 0x1ece, 0x1ecc, 0x1ec8, 0x1ee6, 360, 0x1ee4, 0x1ef2, 213, 0x1eaf, 0x1eb1, 0x1eb7, 0x1ea5, 0x1ea7, 0x1ea9, 0x1ead, 0x1ebd, 0x1eb9, 0x1ebf, 0x1ec1, 0x1ec3, 0x1ec5, 0x1ec7, 0x1ed1, 0x1ed3, 0x1ed5, 0x1ed7, 0x1ee0, 416, 0x1ed9, 0x1edd, 0x1edf, 0x1ecb, 0x1ef0, 0x1ee8, 0x1eea, 0x1eec, 417, 0x1edb, 431, 192, 193, 194, 195, 0x1ea2, 258, 0x1eb3, 0x1eb5, 200, 201, 202, 0x1eba, 204, 205, 296, 0x1ef3, 272, 0x1ee9, 210, 211, 212, 0x1ea1, 0x1ef7, 0x1eeb, 0x1eed, 217, 218, 0x1ef9, 0x1ef5, 221, 0x1ee1, 432, 224, 225, 226, 227, 0x1ea3, 259, 0x1eef, 0x1eab, 232, 233, 234, 0x1ebb, 236, 237, 297, 0x1ec9, 273, 240, 0x1ef1, 242, 243, 244, 245, 0x1ecf, 0x1ecd, 0x1ee5, 249, 250, 361, 0x1ee7, 253, 0x1ee3, 0x1eee}; // 0x817c140
int16_t dfont_unitable_windows_1250[235] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 0x20ac, 0x201a, 0x201e, 0x2026, 0x2020, 0x2021, 0x2030, 352, 1064, 0x2039, 346, 356, 381, 1046, 377, 0x2018, 0x2019, 0x201c, 0x201d, 0x2022, 0x2013, 0x2014, 0x2122, 353, 1096, 0x203a, 347, 357, 382, 1078, 378, 160, 711, 780, 728, 774, 321, 164, 260, 166, 167, 168, 776, 169, 350, 171, 172, 173, 174, 379, 176, 778, 177, 731, 808, 322, 180, 181, 956, 182, 183, 184, 807, 261, 351, 187, 317, 733, 779, 318, 380, 340, 193, 194, 258, 196, 313, 262, 199, 268, 1063, 201, 280, 203, 282, 205, 206, 270, 272, 323, 327, 211, 212, 336, 214, 215, 344, 366, 218, 368, 220, 221, 354, 223, 341, 225, 226, 259, 228, 314, 263, 231, 269, 679, 1095, 233, 281, 235, 283, 237, 238, 271, 273, 324, 328, 243, 244, 337, 246, 247, 345, 367, 250, 369, 252, 253, 355, 729, 775, 903}; // 0x8170fa0
int16_t dfont_unitable_windows_1251[222] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 1026, 1027, 0x201a, 1107, 0x201e, 0x2026, 0x2020, 0x2021, 0x20ac, 0x2030, 1033, 0x2039, 1034, 1036, 1035, 1039, 1106, 0x2018, 0x2019, 0x201c, 0x201d, 0x2022, 0x2013, 0x2014, 0x2122, 1113, 0x203a, 1114, 1116, 1115, 1119, 160, 1038, 1118, 1032, 164, 1168, 166, 167, 1025, 169, 1028, 171, 172, 173, 174, 1031, 176, 177, 1030, 1110, 1169, 181, 182, 183, 1105, 0x2116, 1108, 187, 1112, 1029, 1109, 1111, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103}; // 0x81712c0
int16_t dfont_unitable_windows_1252[229] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 0x20ac, 0x201a, 402, 0x201e, 0x2026, 0x2020, 0x2021, 710, 770, 0x2030, 352, 0x2039, 338, 381, 0x2018, 0x2019, 0x201c, 0x201d, 733, 779, 0x2022, 0x2013, 0x2014, 732, 0x2122, 353, 0x203a, 339, 382, 376, 160, 161, 162, 163, 164, 165, 166, 167, 168, 776, 169, 170, 171, 172, 173, 174, 175, 772, 176, 778, 177, 178, 179, 180, 181, 956, 182, 183, 775, 903, 0x2027, 184, 807, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255}; // 0x81715a0
int16_t dfont_unitable_windows_1253[208] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 0x20ac, 0x201a, 402, 0x201e, 0x2026, 0x2020, 0x2021, 0x2030, 0x2039, 0x2018, 701, 0x2019, 700, 0x201c, 0x201d, 0x2022, 0x2013, 0x2014, 0x2122, 0x203a, 160, 901, 902, 163, 164, 165, 166, 167, 168, 169, 171, 172, 173, 174, 0x2015, 176, 177, 178, 179, 900, 181, 182, 183, 904, 905, 906, 187, 908, 189, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974}; // 0x81718a0
int16_t dfont_unitable_windows_1255[200] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 0x20ac, 0x201a, 402, 0x201e, 0x2026, 0x2020, 0x2021, 710, 0x2030, 0x2039, 0x2018, 0x2019, 0x201c, 0x201d, 0x2022, 0x2013, 0x2014, 732, 0x2122, 0x203a, 160, 161, 162, 163, 0x20aa, 165, 166, 167, 168, 169, 215, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 247, 187, 188, 189, 190, 191, 1456, 1457, 1458, 1459, 1460, 1461, 1462, 1463, 1464, 1465, 1467, 1468, 1469, 1470, 1471, 1472, 1473, 1474, 1475, 1520, 1521, 1522, 1523, 1524, 1488, 1489, 1490, 1491, 1492, 1493, 1494, 1495, 1496, 1497, 1498, 1499, 1500, 1501, 1502, 1503, 1504, 1505, 1506, 1507, 1508, 1509, 1510, 1511, 1512, 1513, 1514, 0x200e, 0x200f}; // 0x8171b60
int16_t dfont_unitable_windows_1256[223] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 0x20ac, 1662, 0x201a, 402, 0x201e, 0x2026, 0x2020, 0x2021, 710, 0x2030, 1657, 0x2039, 338, 1670, 1688, 1672, 1711, 0x2018, 0x2019, 0x201c, 0x201d, 0x2022, 0x2013, 0x2014, 1705, 0x2122, 1681, 0x203a, 339, 0x200c, 0x200d, 1722, 160, 1548, 162, 163, 164, 165, 166, 167, 168, 169, 1726, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 1563, 187, 188, 189, 190, 1567, 1729, 1569, 1570, 1571, 1572, 1573, 1574, 1575, 1576, 1577, 1578, 1579, 1580, 1581, 1582, 1583, 1584, 1585, 1586, 1587, 1588, 1589, 1590, 215, 1591, 1592, 1593, 1594, 1600, 1601, 1602, 1603, 224, 1604, 226, 1605, 1606, 1607, 1608, 231, 232, 233, 234, 235, 1609, 1610, 238, 239, 1611, 1612, 1613, 1614, 244, 1615, 1616, 247, 1617, 249, 1618, 251, 252, 0x200e, 0x200f, 1746}; // 0x8171e00
int16_t dfont_unitable_windows_1257[211] = {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 0x20ac, 0x201a, 0x201e, 0x2026, 0x2020, 0x2021, 0x2030, 0x2039, 168, 711, 184, 0x2018, 0x2019, 0x201c, 0x201d, 0x2022, 0x2013, 0x2014, 0x2122, 0x203a, 175, 731, 160, 162, 163, 164, 166, 167, 216, 169, 342, 171, 172, 173, 174, 198, 176, 177, 178, 179, 180, 181, 182, 183, 248, 185, 343, 187, 188, 189, 190, 230, 260, 302, 256, 262, 196, 197, 280, 274, 268, 201, 377, 278, 290, 310, 298, 315, 352, 323, 325, 211, 332, 213, 214, 215, 370, 321, 346, 362, 220, 379, 381, 223, 261, 303, 257, 263, 228, 229, 281, 275, 269, 233, 378, 279, 291, 311, 299, 316, 353, 324, 326, 243, 333, 245, 246, 247, 371, 322, 347, 363, 252, 380, 382, 729}; // 0x81720e0
char did_emacs_keys = 0; // 0x81afdf9
char did_number_keys = 0; // 0x81afdfa
char did_vi_keys = 0; // 0x81afdf8
int32_t dir_list_order = 0; // 0x81ae800
int32_t dir_list_style = 2; // 0x8194c48
char * dired_list_string = "\xe2\x8b\x15\b"; // 0x8195cc8
int32_t dired_list_values = 0; // 0x8195ce0
char * dired_sort_string = "\x13\x8c\x15\b"; // 0x8195d10
int32_t dired_sort_values = 0; // 0x8195d20
int32_t displayStyles = 0; // 0x81caae0
char * display_char_set_string = "\xae\x8b\x15\b\xbc\x8b\x15\b\xc5\x8b\x15\b\xd4\x8b\x15\b\xe2\x8b\x15\b"; // 0x8195cb8
int32_t display_lines = 0; // 0x81caab4
char display_partial = 0; // 0x81aea34
char display_partial_flag = 1; // 0x8194cbc
int32_t * domain_list = NULL; // 0x81b06a0
int32_t * downloaders = NULL; // 0x81ae814
char dump_links_only = 0; // 0x81ae832
char dump_output_immediately = 0; // 0x81ae833
int32_t dump_output_width = 0; // 0x81ae998
int32_t dump_server_status = 0; // 0x81ae99c
char dump_to_stderr = 0; // 0x81ae834
int32_t editor = 0; // 0x81ae90c
char * editor_string = "\xaf\x88\x15\b\xbb\x88\x15\b\xc6\x88\x15\b"; // 0x8195a00
char emacs_keys = 0; // 0x81ae835
char * emacs_keys_string = "\xbb\x88\x15\b\xc6\x88\x15\b"; // 0x8195a04
int32_t emacs_keys_table = 2; // 0x8199040
char empty_string[1]; // 0x81ae80d
char enable_scrollback = 0; // 0x81ae80c
int32_t encoding_values = 0; // 0x8195ea0
char error_logging = 0; // 0x81ae836
int32_t escape_bound = 0; // 0x81b0644
int32_t * externals = NULL; // 0x81ae818
int32_t fake_zap = 0; // 0x81af454
char force_old_UCLYhndl_on_reload = 0; // 0x81b064d
int32_t forced_UCLYhdnl = 0; // 0x81cb210
int32_t form_get_data = 0; // 0x81ae910
int32_t form_post_data = 0; // 0x81ae914
char free_HTAAGlobalsSet = 0; // 0x81b9444
char from_source_cache = 0; // 0x81aea51
int32_t ftp_lasthost = 0; // 0x81ae880
char ftp_ok = 1; // 0x8194c66
char ftp_passive = 1; // 0x8194c68
char * ftp_sort_string = "\xb2\x8c\x15\b"; // 0x8195d84
int32_t ftp_sort_values = 0; // 0x8195da0
int32_t global_extension_map = 0; // 0x81ae918
int32_t global_type_map = 0; // 0x81ae91c
char * g1; // 0x8149c04
char * g2; // 0x8149ea9
char * g3; // 0x814a000
int32_t g4 = 0x415b1b; // 0x814a2b0
char (*g5)[5] = "Quit"; // 0x814a460
int32_t g6 = 14; // 0x814a464
int32_t g7 = 1; // 0x814a468
int16_t * g8 = (int16_t *)0x420061; // 0x814b1e2
char * g9; // 0x814bf74
char * g10; // 0x814c6f9
char * g11 = "YNAV\a\x03"; // 0x814c994
char * g12; // 0x814cbac
char * g13 = " "; // 0x814ccc6
char * g14 = "0"; // 0x814d8ea
int32_t g15 = 0x7325003d; // 0x814e81f
int32_t g16 = 0x646c2500; // 0x814ef17
int32_t g17 = 0x68706f67; // 0x814f245
int32_t g18 = 0x2e2e2e00; // 0x814f6b1
int32_t g19 = 0x786e794c; // 0x814f700
char * g20; // 0x81534e7
char * g21; // 0x815571c
int32_t g22 = 0x4300002f; // 0x815571d
int32_t g23 = 32; // 0x8155a7f
char * g24; // 0x8155b15
char * g25; // 0x8156400
int32_t g26 = 0x74730020; // 0x815656c
char * g28 = "\x01"; // 0x8157068
int32_t g29 = 0x66006b6f; // 0x8157817
int32_t g30 = 0; // 0x81582c0
int32_t g31 = 0x45555254; // 0x815901c
char * g32; // 0x8159cd1
int32_t g33 = 0x5a420031; // 0x815b098
int32_t g34 = 0x49530034; // 0x815b956
int32_t g35 = 0x49530038; // 0x815b971
int32_t g36 = 0x4e550030; // 0x815babf
char (*g37)[13] = "ALT_CHAR_SET"; // 0x815bc40
int32_t g40; // 0x815d4a4
int32_t g41 = 0x41594c00; // 0x815dfd2
int32_t g42 = 0x594c0020; // 0x815e2c8
char * g43; // 0x815f713
int32_t g44 = 0x69355b1b; // 0x815f772
int32_t g45 = 0x69345b1b; // 0x815f77a
char * g46 = "?"; // 0x815fe21
struct _IO_FILE * g47 = (struct _IO_FILE *)0x63636100; // 0x815fe34
int32_t g48 = 0x4e594c00; // 0x8162fea
char * g49; // 0x81646f7
char (*g50)[6] = "<tab>"; // 0x81647e4
char * g51 = "?"; // 0x8164d92
int32_t g52 = 0x200027; // 0x8164d9d
int32_t g53 = 0x73250020; // 0x8164d9f
char * g54; // 0x8168e75
int32_t g55 = 0x7325000a; // 0x8168f21
int32_t g56 = 0x4f004e4f; // 0x8169808
char (*g57)[6] = "AElig"; // 0x816b4e0
int16_t * g58 = (int16_t *)198; // 0x816b4e4
char * g59; // 0x816df60
char * g60 = "\""; // 0x816e24f
int32_t g62 = 0; // 0x816ee24
int32_t g63 = 1; // 0x816ee28
char * g64; // 0x816f168
int32_t g65 = 0; // 0x816f2c0
char (*g66)[7] = "normal"; // 0x816f2c4
char * g67; // 0x816f697
char * g68; // 0x817d5c4
char * g69; // 0x817ea87
int32_t g70 = 0x5448002f; // 0x817eb79
char * g71; // 0x817eecb
char * g72; // 0x817f520
char * g73; // 0x8180464
int32_t g74 = 0x6547006e; // 0x8180872
int32_t g75 = 0x6e69622f; // 0x8180ead
char * g76 = " "; // 0x818229c
char * g77; // 0x81822f1
int32_t g78 = 0x22200022; // 0x81822f8
int32_t g79 = 0x7325002e; // 0x81822fd
char * g80; // 0x818b605
char * g81; // 0x818bb68
char * g82; // 0x818c117
char * g83; // 0x81918b7
int32_t g84 = 0x255b0900; // 0x8192001
char ** g85 = NULL; // 0x8194360
char * g86[11] = {
    "emacs",
    "jed",
    "jmacs",
    "joe",
    "jove",
    "jpico",
    "jstar",
    "nano",
    "pico",
    "rjoe",
    "vi"
}; // 0x8194460
char (*g87)[7] = "setkey"; // 0x8194540
int32_t g89 = 259; // 0x8194564
char g90 = 1; // 0x8194a20
char * g92; // 0x8194a40
int32_t g93 = -1; // 0x8194b40
char * g94; // 0x8194b48
char * g95; // 0x8194b4c
char * g96 = "\xff\xff\xff\xff\xe5\xdb\x14\b"; // 0x8194bf0
char g97 = 1; // 0x8194c3c
char (*g98)[6] = "file:"; // 0x81955a0
int32_t g99; // 0x81955a4
int32_t g100 = 0; // 0x81956a0
char * g101[8] = {
    "Try to fit screen width",
    "No line wrap in columns",
    "Wrap columns at screen width",
    "Wrap columns at 3/4 screen width",
    "Wrap columns at 2/3 screen width",
    "Wrap columns at 1/2 screen width",
    "Wrap columns at 1/3 screen width",
    "Wrap columns at 1/4 screen width"
}; // 0x81956c0
int32_t g102 = 0; // 0x8195724
int32_t g103 = 1; // 0x8195764
int32_t g104 = -1; // 0x8195768
int32_t g105 = 1; // 0x819576c
int32_t g106 = 1; // 0x81957e0
char g107 = 1; // 0x8195800
char g108 = 1; // 0x8195801
int32_t g109 = 3; // 0x8195824
int32_t g110 = 0; // 0x8195828
int32_t g111 = 0; // 0x819582c
char * g112[3] = {
    "Novice",
    "Intermediate",
    "Advanced"
}; // 0x8195944
char * g113[3] = {
    "OFF     ",
    "STANDARD",
    "ADVANCED"
}; // 0x8195954
char * g114[3] = {
    "Numbers act as arrows",
    "Links are numbered",
    "Links and form fields are numbered"
}; // 0x8195964
char * g115[4] = {
    "By Filename",
    "By Type",
    "By Size",
    "By Date"
}; // 0x8195974
char * g116[3] = {
    "Directories first",
    "Files first",
    "Mixed style"
}; // 0x8195988
char * g117[2] = {
    "CASE INSENSITIVE",
    "CASE SENSITIVE"
}; // 0x8195998
char * g118[2] = {
    "OFF",
    "ON"
}; // 0x81959a4
char (*g119)[3] = "ON"; // 0x8195ae0
char * g120[2] = {
    "ALWAYS",
    "ALWAYS"
}; // 0x8195ae8
char * g121[2] = {
    "Do not show rate",
    "rate_off"
}; // 0x8195de4
char (*g122)[9] = "rate_off"; // 0x8195de8
int32_t g123 = 63; // 0x8195f00
char * g124[2] = {
    "set_cookies",
    "accept_all_cookies"
}; // 0x8195f04
char * g125[2] = {
    "make_pseudo_alts_for_inlines",
    "make_links_for_all_images"
}; // 0x8195f10
char * g126; // 0x8195f20
char (*g127)[19] = "accept_all_cookies"; // 0x8196140
char * g128; // 0x8196e40
char * g129; // 0x8196f40
char g130 = 1; // 0x8197040
char * g131; // 0x8197080
char * g132; // 0x8197180
char * g133[4] = {
    "LYNX_PRINT_TITLE",
    "LYNX_PRINT_URL",
    "LYNX_PRINT_DATE",
    "LYNX_PRINT_LASTMOD"
}; // 0x81972a0
char g134 = 1; // 0x81972b0
char ** g135 = NULL; // 0x81972c0
char * g136; // 0x8197da0
int16_t g137 = 31; // 0x8197eb4
int16_t g138 = 0; // 0x81983f4
char (*g139)[9] = "UNMAPPED"; // 0x8198924
int32_t g140 = 0; // 0x8198928
char g141 = 1; // 0x819a378
char * g142[2] = {
    "Alternate Bindings",
    "Bash-like Bindings"
}; // 0x819adbc
char (*g143)[11] = "iso-8859-1"; // 0x819b384
int32_t g144 = 1; // 0x819b388
int32_t g145 = 0; // 0x819b38c
char (*g146)[17] = "0123456789ABCDEF"; // 0x819bd88
int32_t g148 = 256; // 0x819bda4
char (*g149)[8] = "default"; // 0x819bea0
int32_t g150 = -1; // 0x819bea4
int32_t g151 = 0; // 0x819bea8
int32_t g152 = 1; // 0x819bfe4
char * g153; // 0x81a9c00
int32_t g154 = 0; // 0x81a9d00
char (*g155)[17] = "0123456789ABCDEF"; // 0x81a9d04
int32_t g156 = 0; // 0x81a9d64
int64_t g157 = 0; // 0x81aa440
int32_t g158 = 0; // 0x81aa444
int32_t g159 = 0; // 0x81aa450
char ** g160 = NULL; // 0x81aaadc
int32_t g161 = 0; // 0x81aaae0
int32_t g162 = 0; // 0x81aaae4
struct _IO_FILE * g163 = NULL; // 0x81aaae8
char ** g164 = NULL; // 0x81aab00
int32_t g165 = 0; // 0x81aab08
int32_t g166 = 0; // 0x81aabcc
int32_t g167 = 0; // 0x81aabd0
int32_t g168 = 0; // 0x81aabd4
int32_t g169 = 0; // 0x81aabd8
int32_t g170 = 0; // 0x81aabe0
int32_t g171 = 0; // 0x81aaca4
int32_t g172 = 0; // 0x81ab39c
int32_t g173 = 0; // 0x81ab3a0
char * g174; // 0x81ab4a8
char * g175; // 0x81ab8c0
char * g176; // 0x81abcc0
char * g177; // 0x81ac0e8
int32_t g178 = 0; // 0x81ac0f0
char * g179; // 0x81ac0f4
float64_t g180 = 0.0; // 0x81ac0f8
float64_t g181 = 0.0; // 0x81ac100
float64_t g182 = 0.0; // 0x81ac108
char * g183; // 0x81ac110
int64_t g184 = 0; // 0x81ac118
char * g185; // 0x81ac11c
int64_t g186 = 0; // 0x81ac120
char * g187; // 0x81ac124
float64_t g188 = 0.0; // 0x81ac128
float64_t g189 = 0.0; // 0x81ac12c
int32_t g190 = 0; // 0x81ac17c
char g191 = 0; // 0x81ac195
char g192 = 0; // 0x81ac196
struct _IO_FILE * g193 = NULL; // 0x81ac19c
char * g194; // 0x81ac1ac
int32_t g195 = 0; // 0x81ac1b8
char * g196; // 0x81ac1bc
char * g197; // 0x81ac1d4
int32_t g198 = 0; // 0x81ac1dc
char * g199; // 0x81ac1e4
int32_t g200 = 0; // 0x81ac1f0
int32_t g201 = 0; // 0x81ac1f4
int32_t g202 = 0; // 0x81ac978
char * g203; // 0x81ac97c
int32_t g204 = 0; // 0x81ac980
int32_t g205 = 0; // 0x81ac98c
int32_t g206 = 0; // 0x81ac990
int32_t g207 = 0; // 0x81ac994
int32_t g208 = 0; // 0x81ac9b0
char * g209; // 0x81ac9b8
char g210 = 0; // 0x81ac9c2
char g211 = 0; // 0x81ac9c3
int32_t g212 = 0; // 0x81ac9d0
int32_t g213 = 0; // 0x81ac9f8
char g214 = 0; // 0x81ac9fc
char g215 = 0; // 0x81aca0b
char ** g216 = NULL; // 0x81aca30
char g217 = 0; // 0x81aca34
char g218 = 0; // 0x81aca35
char g219 = 0; // 0x81aca36
char g220 = 0; // 0x81aca37
char g221 = 0; // 0x81aca38
char g222 = 0; // 0x81aca39
char g223 = 0; // 0x81aca3a
int16_t g224 = 0; // 0x81aca3c
int16_t g225 = 0; // 0x81aca3e
int16_t g226 = 0; // 0x81aca40
int16_t g227 = 0; // 0x81aca42
char * g228; // 0x81ae904
int32_t g229 = 0; // 0x81ae970
char g230 = 0; // 0x81aea18
int32_t g231 = 0; // 0x81aea60
int32_t g232 = 0; // 0x81aea88
char * g233; // 0x81aeaa0
char * g234; // 0x81aeaa1
char ** g235 = NULL; // 0x81aefa4
int32_t g236 = 0; // 0x81aefa8
char * g237; // 0x81aefac
char * g238; // 0x81aefb0
char g239 = 0; // 0x81aefb4
char g240 = 0; // 0x81aefb5
int32_t g241 = 0; // 0x81aefb8
char * g242; // 0x81aefbc
char g243 = 0; // 0x81aefc0
int32_t g244 = 0; // 0x81aefc4
char ** g245 = NULL; // 0x81aefe4
int32_t g246 = 0; // 0x81aefe8
char * g247; // 0x81aefec
char * g248; // 0x81aeff0
char g249 = 0; // 0x81aeff4
char g250 = 0; // 0x81aeff5
int32_t g251 = 0; // 0x81aeff8
char * g252; // 0x81aeffc
char g253 = 0; // 0x81af000
char * g254; // 0x81af004
int32_t g255 = 0; // 0x81af026
int32_t g256 = 0; // 0x81af029
char * g257; // 0x81af040
int32_t g258 = 0; // 0x81af0d0
int32_t g259 = 0; // 0x81af0d4
int32_t g260 = 0; // 0x81af0d8
struct termios * g261 = NULL; // 0x81af0e0
int32_t g262 = 0; // 0x81af0e4
int32_t g263 = 0; // 0x81af0e8
int32_t g264 = 0; // 0x81af0ec
int32_t g265 = 0; // 0x81af0f0
int32_t g266 = 0; // 0x81af0f4
int32_t g267 = 0; // 0x81af0f8
int32_t g268 = 0; // 0x81af0fc
int32_t g269 = 0; // 0x81af100
int32_t g270 = 0; // 0x81af104
int32_t g271 = 0; // 0x81af108
int32_t g272 = 0; // 0x81af10c
int32_t g273 = 0; // 0x81af110
int32_t g274 = 0; // 0x81af114
int32_t g275 = 0; // 0x81af118
int32_t g276 = 0; // 0x81af11c
char * g277; // 0x81af120
int32_t g278 = 0; // 0x81af144
int32_t g279 = 0; // 0x81af20d
char * g280; // 0x81af240
char ** g281 = NULL; // 0x81af340
int32_t g282 = 0; // 0x81af458
int64_t g283 = 0; // 0x81af45c
char * g284; // 0x81af460
int32_t g285 = 0; // 0x81af944
int32_t g286 = 0; // 0x81af948
int32_t g287 = 0; // 0x81af94c
int32_t g288 = 0; // 0x81af950
int32_t g289 = 0; // 0x81af954
char * g290; // 0x81af958
int32_t g291 = 0; // 0x81af960
int32_t g292 = 0; // 0x81afa60
char * g293; // 0x81afaa0
char * g294; // 0x81afcac
int32_t g295 = 0; // 0x81afcc0
int32_t g296 = 0; // 0x81afcc4
int32_t g297 = 0; // 0x81afcdc
int32_t g298 = 0; // 0x81afce0
int32_t g299 = 0; // 0x81afcf4
int32_t g300 = 0; // 0x81afda0
int32_t g301 = 0; // 0x81afdb4
char * g302; // 0x81afdb8
char * g303; // 0x81afdf4
char * g304; // 0x81b0080
char * g305; // 0x81b0180
char ** g306 = NULL; // 0x81b0280
int32_t g307 = 0; // 0x81b04a0
int32_t g308 = 0; // 0x81b04a1
char * g309; // 0x81b0520
char ** g310 = NULL; // 0x81b06b0
char g311 = 0; // 0x81b06c0
char * g312; // 0x81b06e0
char * g313; // 0x81b06e1
char * g314; // 0x81b1700
char * g315; // 0x81b1800
char * g316; // 0x81b1900
int32_t g317 = 0; // 0x81b212c
int32_t g318 = 0; // 0x81b2130
int32_t g319 = 0; // 0x81b2131
int32_t g320 = 0; // 0x81b2132
int32_t g321 = 0; // 0x81b2134
char * g322; // 0x81b2138
int32_t g323 = 0; // 0x81b2144
int32_t g324 = 0; // 0x81b2148
int32_t g325 = 0; // 0x81b214c
int32_t g326 = 0; // 0x81b2150
int16_t * g327 = NULL; // 0x81b2154
int32_t g328 = 0; // 0x81b2158
int32_t g329 = 0; // 0x81b215c
int32_t g330 = 0; // 0x81b2160
int32_t g331 = 0; // 0x81b2164
int32_t g332 = 0; // 0x81b2168
int32_t g333 = 0; // 0x81b216c
int32_t g334 = 0; // 0x81b2170
int32_t g335 = 0; // 0x81b2174
int32_t g336 = 0; // 0x81b2178
char * g337; // 0x81b3280
char * g338; // 0x81b3fe0
int32_t g339 = 0; // 0x81b3fec
int32_t g340 = 0; // 0x81b40a0
int32_t g341 = 0; // 0x81b41dc
char * g342; // 0x81b94c0
int32_t g343 = 0; // 0x81b9aa4
char * g344; // 0x81b9ab4
int32_t g345 = 0; // 0x81b9ab8
int32_t g346 = 0; // 0x81b9abc
int32_t g347 = 0; // 0x81b9ac0
int32_t g348 = 0; // 0x81b9ac4
int32_t g349 = 0; // 0x81b9ac8
int32_t g350 = 0; // 0x81b9acc
int32_t g351 = 0; // 0x81b9ad0
int32_t g352 = 0; // 0x81b9ad4
int16_t * g353 = NULL; // 0x81b9adc
int32_t g354 = 0; // 0x81b9ae0
int32_t g355 = 0; // 0x81caae4
int32_t g356 = 0; // 0x81caae8
int32_t g357 = 0; // 0x81cb0e0
int32_t g358 = 0; // 0x81cb248
int32_t g359 = 0; // 0x81cb24c
int32_t g360 = 0; // 0x81cb250
char goto_buffer = 0; // 0x81ae837
char had_restrictions_all = 0; // 0x81ae84b
char had_restrictions_default = 0; // 0x81ae84a
int32_t hashStyles = 0; // 0x81cb240
int32_t * hash_table[101]; // 0x81b5e40
int32_t hashtable_contents_valid = 0; // 0x81b1ee0
int32_t hashtable_str_contents_valid = 0; // 0x81b1ee4
int32_t have_levent = 0; // 0x81ac0c8
char have_read_cfg = 0; // 0x81afa78
int32_t helpfile = 0; // 0x81ae920
int32_t helpfilepath = 0; // 0x81ae924
char historical_comments = 0; // 0x81ae838
int32_t * history = NULL; // 0x81caabc
int32_t homepage = 0; // 0x81ae928
int32_t hostname = 0; // 0x81b3f84
char * images_ignore_all_string = "\x8c\x88\x15\bR\x8b\x15\b\\\x8b\x15\be\x8b\x15\b"; // 0x8195c2c
char * images_string = "K\x8b\x15\b\x8c\x88\x15\bR\x8b\x15\b\\\x8b\x15\be\x8b\x15\b"; // 0x8195c28
char * images_use_label_string = "R\x8b\x15\b\\\x8b\x15\be\x8b\x15\b"; // 0x8195c30
char * images_use_links_string = "\\\x8b\x15\be\x8b\x15\b"; // 0x8195c34
int32_t indexfile = 0; // 0x81ae930
char initialised = 0; // 0x81b5e20
char input_buffer[4096]; // 0x81b7fc0
char inv_norm_transl[512]; // 0x81b2f60
int32_t inv_translate = 0; // 0x81b1ecc
int32_t inverse_translations = 0; // 0x81b1ed0
char is_mosaic_hotlist = 0; // 0x81af220
char is_www_index = 0; // 0x81ae839
char jump_buffer = 0; // 0x81ae83a
int32_t jumpprompt = 0; // 0x81ae938
int32_t kanji_code = 0; // 0x81b0648
char keep_mime_headers = 0; // 0x81ae8a3
int16_t key_override[661] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 38, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 95, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 99, 0, 0, 91, 0, 0, 0, 0, 0, 0, 94, 0, 0, 0, 0, 93, 0, 95, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 92, 0, 0, 91, 0, 0, 0, 0, 0, 0, 94, 0, 0, 0, 0, 93, 0, 95, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 69, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}; // 0x81983e0
int16_t keymap[661] = {0, 69, 22, 16, 0, 14, 23, 15, 0, 36, 31, 39, 79, 21, 39, 18, 0, 17, 98, 12, 104, 64, 38, 82, 21, 0, 0, 0, 0, 0, 0, 0, 0, 15, 62, 77, 74, 25, 0, 0, 75, 19, 20, 66, 15, 90, 16, 89, 51, 80, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 65, 32, 56, 33, 43, 78, 58, 16, 99, 63, 83, 91, 42, 43, 45, 71, 72, 73, 48, 52, 49, 57, 14, 59, 50, 95, 37, 61, 0, 46, 0, 47, 67, 11, 68, 24, 81, 76, 58, 16, 54, 63, 55, 91, 41, 43, 45, 71, 72, 73, 48, 53, 49, 57, 13, 59, 50, 95, 37, 60, 0, 46, 0, 47, 100, 102, 101, 105, 36, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 27, 39, 37, 15, 16, 22, 23, 44, 39, 22, 23, 17, 18, 69, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 69, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0}; // 0x8197ea0
int32_t keypad_mode = 0; // 0x81ae840
char * keypad_mode_string = "\xc6\x88\x15\b"; // 0x8195a08
int32_t keypad_mode_values = 0; // 0x8195a20
char killbuffer[1024]; // 0x8194620
int32_t * known_grp = NULL; // 0x81b9480
int32_t * known_pwd = NULL; // 0x81b9484
int32_t label_columns = 0; // 0x81ab4b4
int32_t language = 0; // 0x81ae93c
int32_t last_colorattr_ptr = 0; // 0x81b1c04
int32_t last_styles[129]; // 0x81b1a00
int32_t levent = 0; // 0x81ac0cc
int32_t lex_cnt = 0; // 0x81b9508
int32_t lex_pushed_back = 0; // 0x81b94a0
char lex_template = 0; // 0x81b950c
int32_t * lexeme_end[12]; // 0x81fb4a0
int32_t * lexeme_start[12]; // 0x81fb460
int32_t linedrawing_char_set = -1; // 0x819ade8
char * lineedit_mode_string = "'\x89\x15\b5\x89\x15\bK\x89\x15\bd\x89\x15\b"; // 0x8195a5c
int32_t lineno = 0; // 0x81af450
int32_t links = 0; // 0x81b9aa0
int32_t list_format = 0; // 0x81ae7f0
int32_t * loaded_texts = NULL; // 0x81ac178
char local_exec = 0; // 0x81ae806
char local_exec_on_local_files = 0; // 0x81ae807
char local_host_only = 0; // 0x81ae88e
char * locale_charset_string = "\xc5\x8b\x15\b\xd4\x8b\x15\b\xe2\x8b\x15\b"; // 0x8195cc0
int32_t * localhost_aliases = NULL; // 0x81af448
char long_url_ok = 0; // 0x81ae848
int32_t * lss_styles = NULL; // 0x81b1c0c
int32_t * ly_temp = NULL; // 0x81afa6c
int32_t ly_uip = 0; // 0x8195820
char lynx_called_initscr = 0; // 0x81af0c8
int32_t lynx_cfg_file = 0; // 0x81ae940
int32_t lynx_cmd_logfile = 0; // 0x81caab8
int32_t lynx_cmd_script = 0; // 0x81caac8
int32_t lynx_color_cfg = -1; // 0x8195760
int32_t lynx_color_pairs = 0; // 0x81af140
char lynx_edit_mode = 0; // 0x81ae7f8
int32_t lynx_has_color = 0; // 0x81af020
int32_t lynx_lss_file = 0; // 0x81ae9fc
int32_t lynx_lss_file2 = 0; // 0x81ae9f8
char lynx_mode = 1; // 0x8194c5f
int32_t lynx_nsl_status = 0; // 0x81b3f80
int32_t lynx_save_space = 0; // 0x81ae944
int32_t lynx_temp_space = 0; // 0x81ae948
int32_t lynx_temp_subspace = 0; // 0x81ae9a0
int32_t lynx_version_putenv_command = 0; // 0x81aea00
int32_t lynxcfginfo_url = 0; // 0x81afa7c
int32_t lynxjumpfile = 0; // 0x81ae94c
int32_t lynxlinksfile = 0; // 0x81ae950
int32_t lynxlistfile = 0; // 0x81ae954
char * mail_address_string = "5\x89\x15\bK\x89\x15\bd\x89\x15\b"; // 0x8195a60
int32_t max_cookies_domain = 50; // 0x8194c84
int32_t max_cookies_global = 500; // 0x8194c88
char * mbm_string = "\x82\x8b\x15\b"; // 0x8195c64
int32_t mbm_values = 0; // 0x8195c80
int32_t media_values = 1; // 0x8195e40
int32_t * menu_head = NULL; // 0x81b3260
char minimal_comments = 0; // 0x81ae83b
char more_links = 0; // 0x81ae8a5
char more_text = 0; // 0x81ae8a4
int32_t mouse_link = -1; // 0x81944a0
char mustshow = 0; // 0x81af444
int32_t my_errno = 0; // 0x81b4074
int32_t * my_subwindow = NULL; // 0x81af208
int32_t named_keys = 9; // 0x81647e0
char nested_tables = 1; // 0x8194c94
int32_t newdoc = 0; // 0x81aefa0
char news_ok = 1; // 0x8194c64
int32_t nhist = 0; // 0x81ae988
int32_t nhist_extra = 0; // 0x81cb20c
int32_t nlinks = 0; // 0x81ae9a4
char no_bookmark = 0; // 0x81ae84d
char no_bookmark_exec = 0; // 0x81ae84e
char no_change_exec_perms = 0; // 0x81ae805
char no_chdir = 0; // 0x81ae84f
char no_compileopts_info = 0; // 0x81ae88c
char no_dired_support = 0; // 0x81ae7f9
char no_disk_save = 0; // 0x81ae850
char no_dotfiles = 1; // 0x8194c67
char no_download = 0; // 0x81ae851
char no_editor = 0; // 0x81ae852
char no_exec = 0; // 0x81ae853
char no_externals = 0; // 0x81ae88a
char no_file_url = 0; // 0x81ae854
char no_filereferer = 1; // 0x8194c69
char no_goto = 0; // 0x81ae855
char no_goto_bibp = 0; // 0x81ae9aa
char no_goto_cso = 0; // 0x81ae857
char no_goto_file = 0; // 0x81ae858
char no_goto_finger = 0; // 0x81ae859
char no_goto_ftp = 0; // 0x81ae85a
char no_goto_gopher = 0; // 0x81ae85b
char no_goto_http = 0; // 0x81ae85c
char no_goto_https = 0; // 0x81ae85d
char no_goto_lynxcgi = 0; // 0x81ae85e
char no_goto_lynxexec = 0; // 0x81ae85f
char no_goto_lynxprog = 0; // 0x81ae860
char no_goto_mailto = 0; // 0x81ae861
char no_goto_news = 0; // 0x81ae884
char no_goto_nntp = 0; // 0x81ae885
char no_goto_rlogin = 0; // 0x81ae862
char no_goto_snews = 0; // 0x81ae886
char no_goto_telnet = 0; // 0x81ae863
char no_goto_tn3270 = 0; // 0x81ae864
char no_goto_wais = 0; // 0x81ae865
char no_inside_ftp = 0; // 0x81ae866
char no_inside_news = 0; // 0x81ae887
char no_inside_rlogin = 0; // 0x81ae867
char no_inside_telnet = 0; // 0x81ae868
char no_jump = 0; // 0x81ae869
char no_list = 0; // 0x81ae8a6
char no_lynxcfg_info = 0; // 0x81ae86a
char no_lynxcfg_xinfo = 0; // 0x81ae88b
char no_mail = 0; // 0x81ae86c
char no_margins = 0; // 0x81ae8a7
char no_multibook = 0; // 0x81ae86d
char no_newspost = 0; // 0x81ae888
char no_numbers = 0; // 0x81aea0c
char no_option_save = 0; // 0x81ae86e
char no_outside_ftp = 0; // 0x81ae86f
char no_outside_news = 0; // 0x81ae889
char no_outside_rlogin = 0; // 0x81ae870
char no_outside_telnet = 0; // 0x81ae871
char no_print = 0; // 0x81ae872
char no_shell = 0; // 0x81ae873
char no_statusline = 0; // 0x81ae88d
int32_t no_suffix = 0x81803d5; // 0x81a9d4c
char no_suspend = 0; // 0x81ae874
char no_table_center = 0; // 0x81ae892
char no_telnet_port = 0; // 0x81ae875
char no_title = 0; // 0x81ae8a8
char no_useragent = 0; // 0x81ae876
char nomore = 0; // 0x81ae98c
int32_t nonoption = 0; // 0x81aea14
int32_t nostyle_bucket = 0x816eeca; // 0x819be18
char number_fields = 0; // 0x81aea0e
int32_t number_keys_table = 49; // 0x8199060
char number_links = 0; // 0x81aea0d
int32_t number_of_file_cookies = 0; // 0x81b06ac
int32_t original_dir = 0; // 0x81ae958
char our_pairs[2][1][17][17]; // 0x81b1c20
int32_t outgoing_mail_charset = -1; // 0x8194c90
char override_no_download = 0; // 0x81ae88f
int32_t ownerS_address = 0; // 0x81aea4c
int32_t owner_address = 0; // 0x81aea48
char ** p_entity_values = NULL; // 0x81b0654
int32_t partial_threshold = -1; // 0x8194cc0
char * passive_ftp_string = "\xa6\x8c\x15\b\xb2\x8c\x15\b"; // 0x8195d80
int32_t paste_buf = 0; // 0x81afa68
int32_t * paste_handle = NULL; // 0x81afa64
char permanent_redirection = 0; // 0x81b33ac
char persistent_cookies = 0; // 0x81ae9b4
int32_t personal_extension_map = 0; // 0x81ae95c
int32_t personal_mail_address = 0; // 0x81ae960
int32_t personal_type_map = 0; // 0x81ae964
int32_t pgm = 0; // 0x81aea1c
int32_t * positionable_editor = NULL; // 0x81ae9f0
int32_t pref_charset = 0; // 0x81ae968
char * preferred_doc_char_string = "\xcb\x8e\x15\b\xdd\x8e\x15\b\xf0\x8e\x15\b?"; // 0x8195ef4
char * preferred_doc_lang_string = "\xdd\x8e\x15\b\xf0\x8e\x15\b?"; // 0x8195ef8
char * preferred_encoding_string = "8\x8e\x15\b"; // 0x8195e88
char * preferred_media_string = "m\x8d\x15\b"; // 0x8195e28
char prev_lynx_edit_mode = 0; // 0x81ae804
char prev_target[1024]; // 0x81aeba0
int32_t * printers = NULL; // 0x81ae810
int32_t program_paths = 0; // 0x81b33e0
int32_t prompt_values = 0; // 0x8195b20
int32_t * prot_cache = NULL; // 0x81b9474
int32_t * protocols = NULL; // 0x81b339c
int32_t proxy_docname = 0; // 0x81b9470
int32_t proxy_hostname = 0; // 0x81b946c
int32_t proxyauth_info = 0; // 0x81ae96c
char pseudo_inline_alts = 1; // 0x8194c73
char psrc_first_tag = 0; // 0x81fb510
char psrc_view = 0; // 0x81b1e65
int32_t pushed_assume_LYhndl = -1; // 0x81a9d08
int32_t pushed_assume_MIMEname = 0; // 0x81b33a0
int32_t rate_values = 0; // 0x8195de0
char * raw_mode_string = "\xbc\x8b\x15\b\xc5\x8b\x15\b\xd4\x8b\x15\b\xe2\x8b\x15\b"; // 0x8195cbc
char recent_sizechange = 0; // 0x81ae83c
char redirect_post_content = 0; // 0x81b33ad
int32_t redirecting_url = 0; // 0x81b33a8
int32_t redirection_attempts = 0; // 0x81b3398
char reloading = 0; // 0x81b33a4
char ** remember_allocated_LYCharSets[60]; // 0x81b3160
int32_t repair_JIS = 0; // 0x81b41d8
int32_t repl_map = 161; // 0x819c220
int32_t repl_map_cp437 = 941; // 0x819c0e0
int32_t repl_map_cp737 = 0x2209; // 0x819c140
int32_t repl_map_cp850 = 0x2218; // 0x819c1a0
int32_t repl_map_cp852 = 0x2218; // 0x819c1e0
int32_t repl_map_dec_mcs = 166; // 0x81a13c0
int32_t repl_map_iso_8859_1 = 0x219e; // 0x81a1460
int32_t repl_map_iso_8859_10 = 0x2122; // 0x81a1820
int32_t repl_map_iso_8859_2 = 0x2218; // 0x81a1680
int32_t repl_map_iso_8859_5 = 1024; // 0x81a16c0
int32_t repl_map_iso_8859_7 = 0x2218; // 0x81a16e0
int32_t repl_map_iso_8859_8 = 1456; // 0x81a1720
int32_t repl_map_iso_8859_9 = 0x2218; // 0x81a17e0
int32_t repl_map_macintosh = 166; // 0x81a1840
int32_t repl_map_mnemonic = 33; // 0x81a18c0
int32_t repl_map_mnemonic_ascii_0 = 32; // 0x81a52a0
int32_t repl_map_viscii = 12; // 0x81a8f60
int32_t repl_map_windows_1250 = 0x2218; // 0x819c040
int32_t repl_map_windows_1252 = 0x2218; // 0x819c080
char restore_sigpipe_for_children = 0; // 0x81ae9f5
int32_t restrictions = 0x8156de0; // 0x8157060
int32_t reverse_mailcap = 1; // 0x81990ac
int32_t revmap = 0; // 0x8198920
char rlogin_ok = 1; // 0x8194c65
int32_t * rules = NULL; // 0x81b7f38
int32_t s_a = -1; // 0x819be30
int32_t s_aedit = -1; // 0x819be34
int32_t s_aedit_arr = -1; // 0x819be38
int32_t s_aedit_pad = -1; // 0x819be3c
int32_t s_aedit_sel = -1; // 0x819be40
int32_t s_alert = -1; // 0x819be44
int32_t s_alink = -1; // 0x819be48
int32_t s_curedit = -1; // 0x819be4c
int32_t s_forw_backw = -1; // 0x819be50
int32_t s_hot_paste = -1; // 0x819be54
int32_t s_menu_active = -1; // 0x819be58
int32_t s_menu_bg = -1; // 0x819be5c
int32_t s_menu_entry = -1; // 0x819be60
int32_t s_menu_frame = -1; // 0x819be64
int32_t s_menu_number = -1; // 0x819be68
int32_t s_menu_sb = -1; // 0x819be6c
int32_t s_normal = -1; // 0x819be70
int32_t s_prompt_edit = -1; // 0x819be74
int32_t s_prompt_edit_arr = -1; // 0x819be78
int32_t s_prompt_edit_pad = -1; // 0x819be7c
int32_t s_prompt_sel = -1; // 0x819be80
int32_t s_sb_aa = -1; // 0x819be90
int32_t s_sb_bar = -1; // 0x819be94
int32_t s_sb_bg = -1; // 0x819be98
int32_t s_sb_naa = -1; // 0x819be9c
int32_t s_status = -1; // 0x819be84
int32_t s_title = -1; // 0x819be88
int32_t s_whereis = -1; // 0x819be8c
char * save_options_string = "s\x88\x15\b\x80\x88\x15\b\x8c\x88\x15\b\x93\x88\x15\b\x9c\x88\x15\b\xa7\x88\x15\b\xaf\x88\x15\b\xbb\x88\x15\b\xc6\x88\x15\b"; // 0x81959e8
int32_t scm = 0x814dbe5; // 0x8194bf4
int32_t * search_queries = NULL; // 0x81ac158
char * search_type_string = "K\x89\x15\bd\x89\x15\b"; // 0x8195a64
int32_t search_type_values = 0; // 0x8195a80
int32_t secret_key = 0; // 0x81b9454
char * secure_string = "l\x88\x15\bs\x88\x15\b\x80\x88\x15\b\x8c\x88\x15\b\x93\x88\x15\b\x9c\x88\x15\b\xa7\x88\x15\b\xaf\x88\x15\b\xbb\x88\x15\b\xc6\x88\x15\b"; // 0x81959e4
int32_t secure_value = 0; // 0x81afa74
char * select_popups_string = "=\x8b\x15\bK\x8b\x15\b\x8c\x88\x15\bR\x8b\x15\b\\\x8b\x15\be\x8b\x15\b"; // 0x8195c24
int32_t * server_table = NULL; // 0x81b9450
int32_t sgml_offset = 0; // 0x81b41e0
char * show_color_string = "\xb5\x89\x15\b"; // 0x8195aa4
int32_t show_color_values = 0; // 0x8195ac0
char * show_cursor_string = "\xc0\x89\x15\b\xcc\x89\x15\b\xdc\x89\x15\b"; // 0x8195afc
char show_dotfiles = 0; // 0x81ae890
char * show_dotfiles_string = "\xd4\x8b\x15\b\xe2\x8b\x15\b"; // 0x8195cc4
char * show_rate_string = "\xf6\x8c\x15\b"; // 0x8195ddc
char * show_scrollbar_string = "\xdc\x89\x15\b"; // 0x8195b04
char * single_bookmark_string = "\x91\x8b\x15\b\x9f\x8b\x15\b\xae\x8b\x15\b\xbc\x8b\x15\b\xc5\x8b\x15\b\xd4\x8b\x15\b\xe2\x8b\x15\b"; // 0x8195cb0
int32_t size_history = 0; // 0x81caaa4
char soft_dquotes = 0; // 0x81ae83d
char source_cache_file_error = 0; // 0x81afe00
char stack_dump = 0; // 0x81aea06
char star_string[1025]; // 0x81b9660
int32_t startfile = 0; // 0x81ae974
char startfile_ok = 0; // 0x81ae8aa
char startfile_stdin = 0; // 0x81aea04
int32_t startrealm = 0; // 0x81ae978
int32_t stylechanges_buffers = 0; // 0x81ac1a0
int32_t * sug_filenames = NULL; // 0x81af440
char syslog_requested_urls = 1; // 0x8194c40
int32_t syslog_txt = 0; // 0x81ae7f4
char system_editor = 0; // 0x81ae849
int32_t system_mail = 0; // 0x81ae97c
int32_t system_mail_flags = 0; // 0x81ae980
int32_t * tagged = NULL; // 0x81ae7fc
int32_t tags = 0; // 0x81b42e0
int32_t tags_table0 = 0x8184060; // 0x8187d00
int32_t tags_table1 = 0x8184060; // 0x8189720
int32_t tbl_keypad_mode = 0x815fc9d; // 0x81974a0
char telnet_ok = 1; // 0x8194c63
char term_letter = 0; // 0x81b9630
char term_message = 0; // 0x81afdb0
char term_options = 0; // 0x81cb208
int32_t terminal = 0; // 0x81aea08
char textfield_prompt_at_left_edge = 0; // 0x81ae9e6
char textfields_activation_option = 0; // 0x81ae9e5
char textfields_need_activation = 0; // 0x81ae9e4
char textinput_activated = 0; // 0x81aea50
int32_t topOfStack = 0; // 0x81b0384
int32_t total_cookies = 0; // 0x81b06a8
int16_t translations[4][256] = {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255}, {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 160, 0x25c6, 0x2592, 0x2409, 0x240c, 0x240d, 0x240a, 176, 177, 0x2424, 0x240b, 0x2518, 0x2510, 0x250c, 0x2514, 0x253c, -2048, -2047, 0x2500, -2045, -2044, 0x251c, 0x2524, 0x2534, 0x252c, 0x2502, 0x2264, 0x2265, 960, 0x2260, 163, 183, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255}, {0, 0x263a, 0x263b, 0x2665, 0x2666, 0x2663, 0x2660, 0x2022, 0x25d8, 0x25cb, 0x25d9, 0x2642, 0x2640, 0x266a, 0x266b, 0x263c, 0x25ba, 0x25c4, 0x2195, 0x203c, 182, 167, 0x25ac, 0x21a8, 0x2191, 0x2193, 0x2192, 0x2190, 0x221f, 0x2194, 0x25b2, 0x25bc, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 0x2302, 199, 252, 233, 226, 228, 224, 229, 231, 234, 235, 232, 239, 238, 236, 196, 197, 201, 230, 198, 244, 246, 242, 251, 249, 255, 214, 220, 162, 163, 165, 0x20a7, 402, 225, 237, 243, 250, 241, 209, 170, 186, 191, 0x2310, 172, 189, 188, 161, 171, 187, 0x2591, 0x2592, 0x2593, 0x2502, 0x2524, 0x2561, 0x2562, 0x2556, 0x2555, 0x2563, 0x2551, 0x2557, 0x255d, 0x255c, 0x255b, 0x2510, 0x2514, 0x2534, 0x252c, 0x251c, 0x2500, 0x253c, 0x255e, 0x255f, 0x255a, 0x2554, 0x2569, 0x2566, 0x2560, 0x2550, 0x256c, 0x2567, 0x2568, 0x2564, 0x2565, 0x2559, 0x2558, 0x2552, 0x2553, 0x256b, 0x256a, 0x2518, 0x250c, 0x2588, 0x2584, 0x258c, 0x2590, 0x2580, 945, 223, 915, 960, 931, 963, 181, 964, 934, 920, 937, 948, 0x221e, 966, 949, 0x2229, 0x2261, 177, 0x2265, 0x2264, 0x2320, 0x2321, 247, 0x2248, 176, 0x2219, 183, 0x221a, 0x207f, 178, 0x25a0, 160}, {-0x1000, -4095, -4094, -4093, -4092, -4091, -4090, -4089, -4088, -4087, -4086, -4085, -4084, -4083, -4082, -4081, -4080, -4079, -4078, -4077, -4076, -4075, -4074, -4073, -4072, -4071, -4070, -4069, -4068, -4067, -4066, -4065, -4064, -4063, -4062, -4061, -4060, -4059, -4058, -4057, -4056, -4055, -4054, -4053, -4052, -4051, -4050, -4049, -4048, -4047, -4046, -4045, -4044, -4043, -4042, -4041, -4040, -4039, -4038, -4037, -4036, -4035, -4034, -4033, -4032, -4031, -4030, -4029, -4028, -4027, -4026, -4025, -4024, -4023, -4022, -4021, -4020, -4019, -4018, -4017, -4016, -4015, -4014, -4013, -4012, -4011, -4010, -4009, -4008, -4007, -4006, -4005, -4004, -4003, -4002, -4001, -4000, -3999, -3998, -3997, -3996, -3995, -3994, -3993, -3992, -3991, -3990, -3989, -3988, -3987, -3986, -3985, -3984, -3983, -3982, -3981, -3980, -3979, -3978, -3977, -3976, -3975, -3974, -3973, -3972, -3971, -3970, -3969, -3968, -3967, -3966, -3965, -3964, -3963, -3962, -3961, -3960, -3959, -3958, -3957, -3956, -3955, -3954, -3953, -3952, -3951, -3950, -3949, -3948, -3947, -3946, -3945, -3944, -3943, -3942, -3941, -3940, -3939, -3938, -3937, -3936, -3935, -3934, -3933, -3932, -3931, -3930, -3929, -3928, -3927, -3926, -3925, -3924, -3923, -3922, -3921, -3920, -3919, -3918, -3917, -3916, -3915, -3914, -3913, -3912, -3911, -3910, -3909, -3908, -3907, -3906, -3905, -3904, -3903, -3902, -3901, -3900, -3899, -3898, -3897, -3896, -3895, -3894, -3893, -3892, -3891, -3890, -3889, -3888, -3887, -3886, -3885, -3884, -3883, -3882, -3881, -3880, -3879, -3878, -3877, -3876, -3875, -3874, -3873, -3872, -3871, -3870, -3869, -3868, -3867, -3866, -3865, -3864, -3863, -3862, -3861, -3860, -3859, -3858, -3857, -3856, -3855, -3854, -3853, -3852, -3851, -3850, -3849, -3848, -3847, -3846, -3845, -3844, -3843, -3842, -3841}}; // 0x81a8fc0
char traversal = 0; // 0x81ae8ab
int32_t traversal_host = 0; // 0x81aea40
int32_t traversal_link_to_add = 0; // 0x81aea44
int32_t * trusted_cgi = (int32_t *)0x8194c20; // 0x8194c38
int32_t trusted_cgi_default = 0x814ef17; // 0x8194c20
int32_t * trusted_exec = (int32_t *)0x8194c00; // 0x8194c30
int32_t trusted_exec_default = 0x814f4df; // 0x8194c00
char uidgid_cache_inited = 0; // 0x81b9488
char * unchecked_box = "\x95\xcb\x14\b\x99\xcb\x14\b\x9d\xcb\x14\b\x01"; // 0x8194b74
char * unchecked_radio = "\x9d\xcb\x14\b\x01"; // 0x8194b7c
char * underline_links_string = "\xcc\x89\x15\b\xdc\x89\x15\b"; // 0x8195b00
int16_t ** uni_pagedir[32]; // 0x81b1f00
char *** uni_pagedir_str[32]; // 0x81b1f80
int32_t unicode_to_lower_case = 0x610041; // 0x814b1e0
int32_t unidefault_contents_valid = 0; // 0x81b2008
int16_t ** unidefault_pagedir[32]; // 0x81b2020
char *** unidefault_pagedir_str[32]; // 0x81b20a0
int32_t unidefault_str_contents_valid = 0; // 0x81b200c
int32_t unknown_suffix = 0x81803d7; // 0x81a9d60
int32_t * uploaders = NULL; // 0x81ae81c
int32_t use_this_url_instead = 0; // 0x81b3394
char use_underscore = 0; // 0x81ae83e
char * user_agent_string = "\xf0\x8e\x15\b?"; // 0x8195efc
int32_t user_entered_password = 0; // 0x81b3450
int32_t user_mode = 0; // 0x81ae844
char * user_mode_string = "/\x8a\x15\b"; // 0x8195b54
int32_t user_mode_values = 0; // 0x8195b60
char using_proxy = 0; // 0x81b338a
int32_t utfxtra_on_this_line = 0; // 0x81ac174
int32_t g361;
int32_t g362;
int32_t g363;
int32_t g364;
int32_t g365;
int32_t g366;
int32_t g367;
int32_t g368;
int32_t g369;
int32_t g370;
int32_t g371;
int32_t g372;
int32_t g373;
int32_t g374;
int32_t g375;
int32_t g376;
int32_t g377;
int32_t g378;
int32_t g379;
int32_t g380;
int32_t g381;
int32_t g382;
int32_t g383;
int32_t g384;
int32_t g385;
int32_t g386;
int32_t g387;
int32_t g388;
int32_t g389;
int32_t g390;
int32_t g391;
int32_t g392;
int32_t g393;
int32_t g394;
int32_t g395;
int32_t g396;
char * verbose_images_string = "e\x8b\x15\b"; // 0x8195c38
int32_t verbose_images_type_values = 0; // 0x8195c40
char verbose_img = 1; // 0x8194c62
char vi_keys = 0; // 0x81ae83f
char * vi_keys_string = "9\x8a\x15\bA\x8a\x15\b"; // 0x8195b90
int32_t vi_keys_table = 104; // 0x8199020
char * visited_links_string = "A\x8a\x15\b"; // 0x8195b94
int32_t visited_links_values = 0; // 0x8195ba0
char with_backspaces = 0; // 0x81ae9e2
int32_t www_search_result = -1; // 0x8194c50
int32_t x_display = 0; // 0x81ae984
char * x_display_string = "\xa7\x88\x15\b\xaf\x88\x15\b\xbb\x88\x15\b\xc6\x88\x15\b"; // 0x81959fc
char * g27 = &had_restrictions_default; // 0x8157064
char * g38[367] = {
    "acs_map",
    "ANSI_VARARGS",
    (char *)&g33,
    "BZIP2_PATH",
    "\"/bin/bzip2\"",
    "CAN_SET_ERRNO",
    (char *)&g33,
    "CJK_EX",
    (char *)&g33,
    "COLOR_CURSES",
    (char *)&g33,
    "COMPRESS_PATH",
    "\"/usr/bin/compress\"",
    "DIRED_SUPPORT",
    (char *)&g33,
    "DISP_PARTIAL",
    (char *)&g33,
    "DONT_TRACK_INTERNAL_LINKS",
    (char *)&g33,
    "ENABLE_IPV6",
    (char *)&g33,
    "ENABLE_NLS",
    (char *)&g33,
    "EXEC_LINKS",
    (char *)&g33,
    "EXEC_SCRIPTS",
    (char *)&g33,
    "EXP_ALT_BINDINGS",
    (char *)&g33,
    "EXP_JAPANESEUTF8_SUPPORT",
    (char *)&g33,
    "EXP_JUSTIFY_ELTS",
    (char *)&g33,
    "EXP_NESTED_TABLES",
    (char *)&g33,
    "FANCY_CURSES",
    (char *)&g33,
    "GETGROUPS_T",
    "gid_t",
    "GZIP_PATH",
    "\"/bin/gzip\"",
    "HAVE_ALLOCA",
    (char *)&g33,
    "HAVE_ALLOCA_H",
    (char *)&g33,
    "HAVE___ARGZ_COUNT",
    (char *)&g33,
    "HAVE_ARGZ_H",
    (char *)&g33,
    "HAVE___ARGZ_NEXT",
    (char *)&g33,
    "HAVE___ARGZ_STRINGIFY",
    (char *)&g33,
    "HAVE_ARPA_INET_H",
    (char *)&g33,
    "HAVE_ASSUME_DEFAULT_COLORS",
    (char *)&g33,
    "HAVE_CBREAK",
    (char *)&g33,
    "HAVE_CTERMID",
    (char *)&g33,
    "HAVE_CURSES_VERSION",
    (char *)&g33,
    "HAVE_CUSERID",
    (char *)&g33,
    "HAVE_DCGETTEXT",
    (char *)&g33,
    "HAVE_DEFINE_KEY",
    (char *)&g33,
    "HAVE_DELSCREEN",
    (char *)&g33,
    "HAVE_DIRENT_H",
    (char *)&g33,
    "HAVE_FCNTL_H",
    (char *)&g33,
    "HAVE_FTIME",
    (char *)&g33,
    "HAVE_GAI_STRERROR",
    (char *)&g33,
    "HAVE_GETADDRINFO",
    (char *)&g33,
    "HAVE_GETATTRS",
    (char *)&g33,
    "HAVE_GETBEGX",
    (char *)&g33,
    "HAVE_GETBEGY",
    (char *)&g33,
    "HAVE_GETBKGD",
    (char *)&g33,
    "HAVE_GETCWD",
    (char *)&g33,
    "HAVE_GETGROUPS",
    (char *)&g33,
    "HAVE_GETTEXT",
    (char *)&g33,
    "HAVE_GETTIMEOFDAY",
    (char *)&g33,
    "HAVE_GETUID",
    (char *)&g33,
    "HAVE_ICONV",
    (char *)&g33,
    "HAVE_INET_ATON",
    (char *)&g33,
    "HAVE_INTTYPES_H",
    (char *)&g33,
    "HAVE_KEYPAD",
    (char *)&g33,
    "HAVE_LANGINFO_CODESET",
    (char *)&g33,
    "HAVE_LC_MESSAGES",
    (char *)&g33,
    "HAVE_LIBINTL_H",
    (char *)&g33,
    "HAVE_LIMITS_H",
    (char *)&g33,
    "HAVE_LOCALE_H",
    (char *)&g33,
    "HAVE_LSTAT",
    (char *)&g33,
    "HAVE_LYHELP_H",
    (char *)&g33,
    "HAVE_MALLOC_H",
    (char *)&g33,
    "HAVE_MBSTATE_T",
    (char *)&g33,
    "HAVE_MKDTEMP",
    (char *)&g33,
    "HAVE_MKTEMP",
    (char *)&g33,
    "HAVE_MMAP",
    (char *)&g33,
    "HAVE_MUNMAP",
    (char *)&g33,
    "HAVE_NAPMS",
    (char *)&g33,
    "HAVE__NC_FREEALL",
    (char *)&g33,
    "HAVE__NC_FREE_AND_EXIT",
    (char *)&g33,
    "HAVE_NCURSESW_TERM_H",
    (char *)&g33,
    "HAVE_NEWPAD",
    (char *)&g33,
    "HAVE_NEWTERM",
    (char *)&g33,
    "HAVE_NL_TYPES_H",
    (char *)&g33,
    "HAVE_PNOUTREFRESH",
    (char *)&g33,
    "HAVE_POPEN",
    (char *)&g33,
    "HAVE_PUTENV",
    (char *)&g33,
    "HAVE_READDIR",
    (char *)&g33,
    "HAVE_RESIZETERM",
    (char *)&g33,
    "HAVE_SETENV",
    (char *)&g33,
    "HAVE_SETLOCALE",
    (char *)&g33,
    "HAVE_SETUID",
    (char *)&g33,
    "HAVE_SIGACTION",
    (char *)&g33,
    "HAVE_SIZECHANGE",
    (char *)&g33,
    "HAVE_STDARG_H",
    (char *)&g33,
    "HAVE_STDLIB_H",
    (char *)&g33,
    "HAVE_STPCPY",
    (char *)&g33,
    "HAVE_STRCASECMP",
    (char *)&g33,
    "HAVE_STRCHR",
    (char *)&g33,
    "HAVE_STRERROR",
    (char *)&g33,
    "HAVE_STRING_H",
    (char *)&g33,
    "HAVE_SYS_FCNTL_H",
    (char *)&g33,
    "HAVE_SYS_IOCTL_H",
    (char *)&g33,
    "HAVE_SYSLOG_H",
    (char *)&g33,
    "HAVE_SYS_PARAM_H",
    (char *)&g33,
    "HAVE_SYS_TIMEB_H",
    (char *)&g33,
    "HAVE_SYS_WAIT_H",
    (char *)&g33,
    "HAVE_TERM_H",
    (char *)&g33,
    "HAVE_TERMIO_H",
    (char *)&g33,
    "HAVE_TERMIOS_H",
    (char *)&g33,
    "HAVE_TOUCHLINE",
    (char *)&g33,
    "HAVE_TOUCHWIN",
    (char *)&g33,
    "HAVE_TRUNCATE",
    (char *)&g33,
    "HAVE_TTYNAME",
    (char *)&g33,
    "HAVE_TTYTYPE",
    (char *)&g33,
    "HAVE_UNISTD_H",
    (char *)&g33,
    "HAVE_UNSETENV",
    (char *)&g33,
    "HAVE_USE_DEFAULT_COLORS",
    (char *)&g33,
    "HAVE_USE_LEGACY_CODING",
    (char *)&g33,
    "HAVE_USLEEP",
    (char *)&g33,
    "HAVE_UTMP",
    (char *)&g33,
    "HAVE_UTMP_UT_HOST",
    (char *)&g33,
    "HAVE_UTMP_UT_SESSION",
    (char *)&g33,
    "HAVE_UTMP_UT_XSTATUS",
    (char *)&g33,
    "HAVE_UTMP_UT_XTIME",
    (char *)&g33,
    "HAVE_VASPRINTF",
    (char *)&g33,
    "HAVE_WAITPID",
    (char *)&g33,
    "HAVE_WATTR_GET",
    (char *)&g33,
    "HAVE_WBORDER",
    (char *)&g33,
    "HAVE_WREDRAWLN",
    (char *)&g33,
    "HAVE_WRESIZE",
    (char *)&g33,
    "ICONV_CONST",
    (char *)&g32,
    "INSTALL_ARGS",
    "\"-c\"",
    "INSTALL_PATH",
    "\"/usr/bin/install\"",
    "LOCALE",
    (char *)&g33,
    "LONG_LIST",
    (char *)&g33,
    "lstat",
    "stat",
    "LYNX_CFG_FILE",
    "\"/etc/lynx-cur/lynx.cfg\"",
    "LYNX_CFG_H",
    (char *)&g33,
    "LYNXCGI_LINKS",
    (char *)&g33,
    "LYNX_LSS_FILE",
    "\"/etc/lynx-cur/lynx.lss\"",
    "LYNX_RAND_MAX",
    "INT_MAX",
    "lynx_rand",
    "random",
    "lynx_srand",
    "srandom",
    "MIME_LIBDIR",
    "\"/etc/\"",
    "MV_PATH",
    "\"/bin/mv\"",
    "NCURSES",
    (char *)&g33,
    "NSL_FORK",
    (char *)&g33,
    "OK_GZIP",
    (char *)&g33,
    "OK_OVERRIDE",
    (char *)&g33,
    "OK_PERMIT",
    (char *)&g33,
    "OK_TAR",
    (char *)&g33,
    "OK_UUDECODE",
    (char *)&g33,
    "OK_ZIP",
    (char *)&g33,
    "RLOGIN_PATH",
    "\"/usr/bin/rlogin\"",
    "RM_PATH",
    "\"/bin/rm\"",
    "SIZEOF_INT",
    (char *)&g34,
    "SIZEOF_LONG",
    (char *)&g34,
    "SIZEOF_OFF_T",
    (char *)&g35,
    "SIZEOF_TIME_T",
    (char *)&g34,
    "STDC_HEADERS",
    (char *)&g33,
    "SYSLOG_REQUESTED_URLS",
    (char *)&g33,
    "SYSTEM_MAIL_FLAGS",
    "\"-t -oi\"",
    "SYSTEM_MAIL",
    "\"/usr/sbin/sendmail\"",
    "SYSTEM_NAME",
    "\"linux-gnu\"",
    "TAR_DOWN_OPTIONS",
    "\"-xf\"",
    "TAR_FILE_OPTIONS",
    "\"\"",
    "TAR_PATH",
    "\"/bin/tar\"",
    "TAR_PIPE_OPTIONS",
    "\"-\"",
    "TAR_UP_OPTIONS",
    "\"-cf\"",
    "TELNET_PATH",
    "\"/usr/bin/telnet\"",
    "TERMIO_AND_CURSES",
    (char *)&g33,
    "UNCOMPRESS_PATH",
    "\"/bin/gunzip\"",
    "UNDERLINE_LINKS",
    (char *)&g36,
    "UNIX",
    (char *)&g33,
    "UNZIP_PATH",
    "\"/usr/bin/unzip\"",
    "USE_COLOR_STYLE",
    (char *)&g33,
    "USE_DEFAULT_COLORS",
    (char *)&g33,
    "USE_EXTERNALS",
    (char *)&g33,
    "USE_FILE_UPLOAD",
    (char *)&g33,
    "USE_GNUTLS_FUNCS",
    (char *)&g33,
    "USE_LOCALE_CHARSET",
    (char *)&g33,
    "USE_PERSISTENT_COOKIES",
    (char *)&g33,
    "USE_PRETTYSRC",
    (char *)&g33,
    "USE_READPROGRESS",
    (char *)&g33,
    "USE_SCROLLBAR",
    (char *)&g33,
    "USE_SOURCE_CACHE",
    (char *)&g33,
    "USE_SYSV_UTMP",
    (char *)&g33,
    "USE_ZLIB",
    (char *)&g33,
    "ut_xstatus",
    "ut_exit.e_exit",
    "UUDECODE_PATH",
    "\"/usr/bin/uudecode\"",
    "WIDEC_CURSES",
    (char *)&g33,
    "ZCAT_PATH",
    "\"/bin/zcat\"",
    "ZIP_PATH",
    "\"/usr/bin/zip\""
}; // 0x815bc44
int32_t * g39 = (int32_t *)&g32; // 0x815d4a0
int32_t * g61 = &LYCookieSAcceptDomains; // 0x816ee20
int32_t * g88 = &g4; // 0x8194560
int32_t * g91 = (int32_t *)&g92; // 0x8194a24
int32_t * g147 = (int32_t *)&g316; // 0x819bda0

// ------------------------ Functions -------------------------

// Address range: 0x804a784 - 0x804a78a
int32_t function_804a784(int32_t a1, int32_t a2) {
    // 0x804a784
    return scrollok();
}

// Address range: 0x804a7a4 - 0x804a7aa
int32_t function_804a7a4(int32_t * a1, int32_t a2) {
    // 0x804a7a4
    return ungetmouse();
}

// Address range: 0x804a854 - 0x804a85a
int32_t function_804a854(int32_t a1) {
    // 0x804a854
    return mouseinterval();
}

// Address range: 0x804a8b4 - 0x804a8ba
int32_t function_804a8b4(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x804a8b4
    return newwin();
}

// Address range: 0x804a8f4 - 0x804a8fa
int32_t function_804a8f4(int32_t a1, int32_t a2) {
    // 0x804a8f4
    return waddch();
}

// Address range: 0x804a914 - 0x804a91a
int32_t function_804a914(int32_t a1, int32_t a2, int32_t a3) {
    // 0x804a914
    return wmove();
}

// Address range: 0x804a934 - 0x804a93a
int32_t function_804a934(int32_t a1, int32_t a2) {
    // 0x804a934
    return keypad();
}

// Address range: 0x804a964 - 0x804a96a
int32_t function_804a964(void) {
    // 0x804a964
    return echo();
}

// Address range: 0x804a9c4 - 0x804a9ca
int32_t function_804a9c4(void) {
    // 0x804a9c4
    return endwin();
}

// Address range: 0x804aa84 - 0x804aa8a
int32_t function_804aa84(void) {
    // 0x804aa84
    return doupdate();
}

// Address range: 0x804aa94 - 0x804aa9a
int32_t function_804aa94(int32_t a1, int32_t a2) {
    // 0x804aa94
    return resizeterm();
}

// Address range: 0x804aab4 - 0x804aaba
int32_t function_804aab4(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5) {
    // 0x804aab4
    return derwin();
}

// Address range: 0x804ab84 - 0x804ab8a
int32_t function_804ab84(int32_t a1) {
    // 0x804ab84
    return delwin();
}

// Address range: 0x804ab94 - 0x804ab9a
int32_t function_804ab94(int32_t a1, int32_t a2) {
    // 0x804ab94
    return werase();
}

// Address range: 0x804abb4 - 0x804abba
int32_t function_804abb4(void) {
    // 0x804abb4
    return initscr();
}

// Address range: 0x804ac04 - 0x804ac0a
int32_t function_804ac04(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7) {
    // 0x804ac04
    return pnoutrefresh();
}

// Address range: 0x804ac24 - 0x804ac2a
int32_t function_804ac24(int32_t a1, int32_t a2) {
    // 0x804ac24
    return wclrtoeol();
}

// Address range: 0x804ac64 - 0x804ac6a
int32_t function_804ac64(int32_t a1, int32_t a2, int32_t a3) {
    // 0x804ac64
    return clearok();
}

// Address range: 0x804aca4 - 0x804acaa
int32_t function_804aca4(int32_t a1, int32_t * a2, int32_t * a3) {
    // 0x804aca4
    return pair_content();
}

// Address range: 0x804acb4 - 0x804acba
int32_t function_804acb4(int32_t * a1) {
    // 0x804acb4
    return getmouse();
}

// Address range: 0x804acc4 - 0x804acca
int32_t function_804acc4(int32_t a1, int32_t a2) {
    // 0x804acc4
    return mousemask();
}

// Address range: 0x804ace4 - 0x804acea
int32_t function_804ace4(int32_t a1) {
    // 0x804ace4
    return nonl();
}

// Address range: 0x804ad84 - 0x804ad8a
int32_t function_804ad84(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5) {
    // 0x804ad84
    return wtouchln();
}

// Address range: 0x804ade4 - 0x804adea
int32_t function_804ade4(int32_t a1) {
    // 0x804ade4
    return wrefresh();
}

// Address range: 0x804ae04 - 0x804ae0a
int32_t function_804ae04(int32_t a1, int32_t a2, int32_t a3) {
    // 0x804ae04
    return init_pair();
}

// Address range: 0x804af04 - 0x804af0a
int32_t function_804af04(void) {
    // 0x804af04
    return cbreak();
}

// Address range: 0x804af84 - 0x804af8a
int32_t function_804af84(void) {
    // 0x804af84
    return start_color();
}

// Address range: 0x804afb4 - 0x804afba
int32_t function_804afb4(int32_t a1, int32_t a2, int32_t a3) {
    // 0x804afb4
    return wresize();
}

// Address range: 0x804aff4 - 0x804affa
int32_t function_804aff4(int32_t a1) {
    // 0x804aff4
    return wgetch();
}

// Address range: 0x804b034 - 0x804b03a
int32_t function_804b034(int32_t a1, int32_t a2) {
    // 0x804b034
    return wbkgd();
}

// Address range: 0x804b094 - 0x804b09a
int32_t function_804b094(int32_t a1, int32_t a2) {
    // 0x804b094
    return newpad();
}

// Address range: 0x804b0e4 - 0x804b0ea
int32_t function_804b0e4(void) {
    // 0x804b0e4
    return has_colors();
}

// Address range: 0x804b144 - 0x804b14a
int32_t function_804b144(int32_t a1, int32_t * a2, int32_t a3) {
    // 0x804b144
    return waddnstr();
}

// Address range: 0x804b194 - 0x804b19a
int32_t function_804b194(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9) {
    // 0x804b194
    return wborder();
}

// Address range: 0x804b1f4 - 0x804b1fa
int32_t function_804b1f4(int32_t * a1, int32_t a2) {
    // 0x804b1f4
    return define_key();
}

// Address range: 0x804b214 - 0x804b21a
int32_t function_804b214(int32_t a1, int32_t a2) {
    // 0x804b214
    return assume_default_colors();
}

// Address range: 0x804b264 - 0x804b26a
int32_t function_804b264(int32_t a1, int32_t a2, int32_t a3) {
    // 0x804b264
    return wattr_off();
}

// Address range: 0x804b2a4 - 0x804b2aa
int32_t function_804b2a4(int32_t a1) {
    // 0x804b2a4
    return wnoutrefresh();
}

// Address range: 0x804b324 - 0x804b32a
int32_t function_804b324(int32_t a1, int32_t a2) {
    // 0x804b324
    return wclear();
}

// Address range: 0x804b364 - 0x804b36a
int32_t function_804b364(void) {
    // 0x804b364
    return nl();
}

// Address range: 0x804b394 - 0x804b39a
int32_t function_804b394(void) {
    // 0x804b394
    return noecho();
}

// Address range: 0x804b3b4 - 0x804b3ba
int32_t function_804b3b4(int32_t a1, int32_t a2) {
    // 0x804b3b4
    return wbkgdset();
}

// Address range: 0x804b3e4 - 0x804b3ea
int32_t function_804b3e4(int32_t a1, int32_t a2) {
    // 0x804b3e4
    return napms();
}

// Address range: 0x804b404 - 0x804b40a
int32_t function_804b404(int32_t a1, int32_t a2, int32_t a3) {
    // 0x804b404
    return wattr_on();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYClean.c
// Address range: 0x804b4e4 - 0x804b5a4
// Line range:    31 - 145
void cleanup_sig(int32_t sig) {
    // 0x804b4e4
    signal(SIGHUP, SIG_IGN);
    signal(SIGINT, SIG_IGN);
    signal(SIGTERM, SIG_IGN);
    if (traversal != 0) {
        // 0x804b531
        dump_traversal_history();
    }
    if (sig == 1) {
        // 0x804b584
        cleanup_files();
        // 0x804b58f
        exit_immediately(0);
        // UNREACHABLE
    }
    // 0x804b53c
    if (dump_output_immediately == 0) {
        // 0x804b547
        cleanup();
    }
    if (sig == 0) {
        // 0x804b59d
        reset_signals();
        return;
    }
    // 0x804b552
    printf("\n\n%s %d\n\n", gettext("Exiting via interrupt:"), sig);
    fflush((struct _IO_FILE *)g164);
    // 0x804b58f
    exit_immediately(0);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYClean.c
// Address range: 0x804b5a4 - 0x804b5d1
// Line range:    152 - 155
void cleanup_files(void) {
    // 0x804b5a4
    LYCleanupTemp();
    if (lynx_temp_space != 0) {
        // 0x804b5b8
        free((int32_t *)lynx_temp_space);
        lynx_temp_space = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYClean.c
// Address range: 0x804b5d1 - 0x804b66e
// Line range:    158 - 224
void cleanup(void) {
    // 0x804b5d1
    signal(SIGHUP, SIG_IGN);
    signal(SIGTERM, SIG_IGN);
    signal(SIGINT, SIG_IGN);
    if (LYCursesON != 0) {
        // 0x804b61e
        LYmove(LYlines - 1, 0);
        LYclrtoeol();
        lynx_stop_all_colors();
        LYrefresh();
        stop_curses();
    }
    // 0x804b64a
    if (persistent_cookies != 0) {
        // 0x804b655
        LYStoreCookies((char *)LYCookieSaveFile);
    }
    // 0x804b662
    cleanup_files();
    LYCloseTracelog();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYShowInfo.c
// Address range: 0x804b670 - 0x804b67a
// Line range:    47 - 49
char LYVersionIsRelease(void) {
    // 0x804b670
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYShowInfo.c
// Address range: 0x804b67a - 0x804b6ae
// Line range:    52 - 58
char * LYVersionStatus(void) {
    // 0x804b67a
    char * result; // 0x804b67a
    if (LYVersionIsRelease() == 0) {
        // 0x804b69a
        result = gettext("development version");
    } else {
        // 0x804b689
        result = gettext("latest release");
    }
    // 0x804b6a9
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYShowInfo.c
// Address range: 0x804b6ae - 0x804b6d7
// Line range:    61 - 66
char * LYVersionDate(void) {
    // 0x804b6ae
    LYstrncpy((char *)&g174, "14 Dec 2008 16:24:56 -0800", 11);
    return (char *)&g174;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYShowInfo.c
// Address range: 0x804b6d7 - 0x804b811
// Line range:    71 - 93
void dt_String(struct _IO_FILE * fp, char * label, char * value) {
    int32_t have = 0; // bp-16, 0x804b6dd
    int32_t need = 0; // bp-20, 0x804b6e4
    HTSACopy((char **)&have, label);
    HTSACopy((char **)&need, value);
    int32_t v1 = LYstrExtent((char *)have, strlen((char *)have), label_columns); // 0x804b733
    LYEntify((char **)&have, 1);
    LYEntify((char **)&need, 1);
    fwrite((int32_t *)"<dt>", 1, 4, fp);
    int32_t v2 = v1 - label_columns; // 0x804b7ae
    int32_t v3 = v1; // 0x804b7ba
    if (v2 < 0 != ((v2 ^ v1) & (label_columns ^ v1)) < 0) {
        v3++;
        fwrite((int32_t *)"&nbsp;", 1, 6, fp);
        while (v3 - label_columns < 0 != ((v3 - label_columns ^ v3) & (label_columns ^ v3)) < 0) {
            // 0x804b786
            v3++;
            fwrite((int32_t *)"&nbsp;", 1, 6, fp);
        }
    }
    // 0x804b7bc
    fprintf(fp, "<em>%s</em> %s\n", (char *)have, (char *)need);
    if (have != 0) {
        // 0x804b7e4
        free(&((struct _IO_FILE *)have)->e0);
        have = 0;
    }
    // 0x804b7f6
    if (need != 0) {
        // 0x804b7fd
        free(&((struct _IO_FILE *)need)->e0);
        need = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYShowInfo.c
// Address range: 0x804b811 - 0x804b873
// Line range:    99 - 105
void dt_Number(struct _IO_FILE * fp0, char * label, int32_t number, char * units) {
    char * v1 = NULL; // bp-8, 0x804b817
    HTSprintf(&v1, "%ld %s", number, units);
    dt_String(fp0, label, v1);
    if (v1 != NULL) {
        // 0x804b85f
        free((int32_t *)v1);
        v1 = NULL;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYShowInfo.c
// Address range: 0x804b873 - 0x804d08d
// Line range:    114 - 471
int32_t LYShowInfo(int32_t * doc, int32_t * newdoc2, char * owner_address2) {
    int32_t v1 = __readgsdword(20); // 0x804b899
    int32_t url_type = 0; // bp-1136, 0x804b8a4
    char * Title = NULL; // bp-1144, 0x804b8ae
    struct _IO_FILE * stream; // 0x804b873
    if (LYReuseTempfiles == 0) {
        // 0x804b8f8
        LYRemoveTemp((char *)&g85);
        stream = LYOpenTemp((char *)&g85, ".html", "w");
    } else {
        // 0x804b8d4
        stream = LYOpenTempRewrite((char *)&g85, ".html", "w");
    }
    // 0x804b926
    int32_t v2; // 0x804b873
    int32_t v3; // 0x804b873
    int32_t * v4; // 0x804b97e
    if (stream != NULL) {
        // 0x804b952
        v3 = (int32_t)doc;
        LYLocalFileToURL((char **)((int32_t)newdoc2 + 4), (char *)&g85);
        if (nlinks < 1) {
            goto lab_0x804ba8e;
        } else {
            // 0x804b978
            v4 = (int32_t *)(v3 + 24);
            int32_t v5 = *(int32_t *)(68 * *v4 + (int32_t)&links); // 0x804b98b
            if (v5 == 0) {
                goto lab_0x804ba8e;
            } else {
                int32_t v6 = is_url((char *)v5); // 0x804b9b5
                switch (v6) {
                    case 0: {
                        goto lab_0x804ba8e;
                    }
                    case 26: {
                        goto lab_0x804b9e3;
                    }
                    default: {
                        if (v6 != 27) {
                            goto lab_0x804ba8e;
                        } else {
                            goto lab_0x804b9e3;
                        }
                    }
                }
            }
        }
    } else {
        // 0x804b92f
        HTAlert(gettext("Can't open temporary file!"));
        v2 = -1;
        goto lab_0x804d06c;
    }
  lab_0x804ba8e:
    // 0x804ba8e
    label_columns = 9;
    WriteInternalTitle(stream, gettext("Information about the current document"));
    char * v7 = LYVersionStatus(); // 0x804bab6
    char * v8 = LYVersionIsRelease() == 0 ? "http://lynx.isc.org/current/" : "http://lynx.isc.org/";
    fprintf(stream, "<h1>%s %s (%s) (<a href=\"%s\">%s</a>)", "Lynx", "2.8.7dev.11", LYVersionDate(), v8, v7);
    fwrite((int32_t *)"</h1>\n", 1, 6, stream);
    char * v9; // 0x804b873
    if (lynx_edit_mode == 0 || nlinks < 1) {
        // 0x804c4c8
        fprintf(stream, "<h2>%s</h2>\n<dl compact>", gettext("File that you are currently viewing"));
        LYformTitle((char **)&url_type, (char *)*doc);
        if (*(char *)(v3 + 20) == 0) {
            // 0x804c556
            v9 = (char *)&g1;
            goto lab_0x804c560;
        } else {
            // 0x804c516
            if (strstr((char *)url_type, " (HEAD)") != NULL) {
                // 0x804c556
                v9 = (char *)&g1;
                goto lab_0x804c560;
            } else {
                // 0x804c530
                v9 = " (HEAD)";
                if (strstr((char *)url_type, " - HEAD") != NULL) {
                    // 0x804c556
                    v9 = (char *)&g1;
                    goto lab_0x804c560;
                } else {
                    goto lab_0x804c560;
                }
            }
        }
    } else {
        // 0x804bb65
        fprintf(stream, "<h2>%s</h2>\n<dl compact>", gettext("Directory that you are currently viewing"));
        int32_t * v10 = (int32_t *)(v3 + 4); // 0x804bb91
        char * v11 = HTnameOfFile_WWW((char *)*v10, 0, 1); // 0x804bba7
        Title = v11;
        dt_String(stream, gettext("Name:"), v11);
        char * v12 = Title; // 0x804bbda
        if (v12 != NULL) {
            // 0x804bbe4
            free((int32_t *)v12);
            Title = NULL;
        }
        // 0x804bbfc
        dt_String(stream, gettext("URL:"), (char *)*v10);
        fwrite((int32_t *)"\n</dl>\n", 1, 7, stream);
        int32_t v13 = *(int32_t *)(68 * *(int32_t *)(v3 + 24) + (int32_t)&links); // 0x804bc60
        char * v14 = HTnameOfFile_WWW((char *)v13, 0, 1); // 0x804bc79
        Title = v14;
        int32_t v15; // bp-1268, 0x804b873
        if (lstat64((int32_t)v14, &v15) != -1) {
            // 0x804bcf1
            label_columns = 16;
            int32_t v16; // 0x804b873
            int32_t v17 = v16 & 0xf000; // 0x804bd01
            if (v17 != 0x4000) {
                if (v17 != 0x8000) {
                    if (v17 != 0xa000) {
                        // 0x804bdac
                        fprintf(stream, "<h2>%s</h2>\n<dl compact>", gettext("Item that you have currently selected"));
                    } else {
                        // 0x804bd84
                        fprintf(stream, "<h2>%s</h2>\n<dl compact>", gettext("Symbolic link that you have currently selected"));
                    }
                } else {
                    // 0x804bd4a
                    fprintf(stream, "<h2>%s</h2>\n<dl compact>", gettext("File that you have currently selected"));
                }
            } else {
                // 0x804bd0d
                fprintf(stream, "<h2>%s</h2>\n<dl compact>", gettext("Directory that you have currently selected"));
            }
            // 0x804bdd2
            dt_String(stream, gettext("Full name:"), Title);
            if (v17 == 0xa000) {
                // 0x804be10
                int32_t buf; // bp-1120, 0x804b873
                int32_t v18 = readlink(Title, (char *)&buf, 1023); // 0x804be2b
                if (v18 == -1) {
                    // 0x804be4f
                    sprintf((char *)&buf, "%.*s", 1023, gettext("Unable to follow link"));
                } else {
                    // 0x804be3f
                    int32_t v19; // bp-4, 0x804b873
                    *(char *)((int32_t)&v19 - 1116 + v18) = 0;
                }
                char * v20 = gettext("Points to file:"); // 0x804be84
                dt_String(stream, v20, (char *)&buf);
            }
            char * v21 = HTAA_UidToName(v16); // 0x804beae
            if (*v21 != 0) {
                // 0x804bec6
                dt_String(stream, gettext("Name of owner:"), v21);
            }
            char * v22 = HTAA_GidToName(v16); // 0x804bef7
            if (*v22 != 0) {
                // 0x804bf0f
                dt_String(stream, gettext("Group name:"), v22);
            }
            if (v17 == 0x8000) {
                char * v23 = gettext("(bytes)"); // 0x804bf50
                dt_Number(stream, gettext("File size:"), v16, v23);
            }
            // 0x804bf8b
            int32_t timep; // bp-1188, 0x804b873
            char * time_str = ctime(&timep); // 0x804bf97
            dt_String(stream, gettext("Creation date:"), time_str);
            int32_t timep2; // bp-1196, 0x804b873
            char * time_str2 = ctime(&timep2); // 0x804bfcc
            dt_String(stream, gettext("Last modified:"), time_str2);
            int32_t timep3; // bp-1204, 0x804b873
            char * time_str3 = ctime(&timep3); // 0x804c001
            dt_String(stream, gettext("Last accessed:"), time_str3);
            fwrite((int32_t *)"\n</dl>\n", 1, 7, stream);
            label_columns = 9;
            fprintf(stream, "<h2>%s</h2>\n<dl compact>", gettext("Access Permissions"));
            char str = 0; // bp-96, 0x804c080
            char v24 = 0; // bp-94, 0x804c088
            if ((v16 & 256) != 0) {
                int32_t len = strlen(&str); // 0x804c0b4
                memcpy((int32_t *)(len + (int32_t)&str), &g391, (int32_t)&g391);
            }
            if ((char)v16 <= 255) {
                int32_t len2 = strlen(&str); // 0x804c0ec
                memcpy((int32_t *)(len2 + (int32_t)&str), &g391, (int32_t)&g391);
            }
            if ((v16 & 64) != 0) {
                int32_t v25 = &str;
                memcpy((int32_t *)(strlen(&str) + v25), &g391, (int32_t)&g391);
                if (v17 != 0x4000 && (v16 & 2048) != 0) {
                    // 0x804c182
                    memcpy((int32_t *)(strlen(&str) + v25), &g391, (int32_t)&g391);
                }
            }
            char * v26 = gettext("Owner:"); // 0x804c1b2
            dt_String(stream, v26, &v24);
            str = 0;
            v24 = 0;
            if ((v16 & 32) != 0) {
                int32_t len3 = strlen(&str); // 0x804c207
                memcpy((int32_t *)(len3 + (int32_t)&str), &g391, (int32_t)&g391);
            }
            if ((v16 & 16) != 0) {
                int32_t len4 = strlen(&str); // 0x804c23d
                memcpy((int32_t *)(len4 + (int32_t)&str), &g391, (int32_t)&g391);
            }
            if ((v16 & 8) != 0) {
                int32_t v27 = &str;
                memcpy((int32_t *)(strlen(&str) + v27), &g391, (int32_t)&g391);
                if (v17 != 0x4000 && (v16 & 1024) != 0) {
                    // 0x804c2d3
                    memcpy((int32_t *)(strlen(&str) + v27), &g391, (int32_t)&g391);
                }
            }
            char * v28 = gettext("Group:"); // 0x804c303
            dt_String(stream, v28, &v24);
            str = 0;
            v24 = 0;
            if ((v16 & 4) != 0) {
                int32_t len5 = strlen(&str); // 0x804c358
                memcpy((int32_t *)(len5 + (int32_t)&str), &g391, (int32_t)&g391);
            }
            if ((v16 & 2) != 0) {
                int32_t len6 = strlen(&str); // 0x804c38e
                memcpy((int32_t *)(len6 + (int32_t)&str), &g391, (int32_t)&g391);
            }
            if (v16 % 2 != 0) {
                int32_t v29 = &str;
                memcpy((int32_t *)(strlen(&str) + v29), &g391, (int32_t)&g391);
                if (v17 != 0x4000 && (v16 & 512) != 0) {
                    // 0x804c424
                    memcpy((int32_t *)(strlen(&str) + v29), &g391, (int32_t)&g391);
                }
            }
            char * v30 = gettext("World:"); // 0x804c454
            dt_String(stream, v30, &v24);
            fwrite((int32_t *)"\n</dl>\n", 1, 7, stream);
        } else {
            // 0x804bca1
            if (WWW_TraceFlag != 0) {
                int32_t v31 = *__errno_location(); // 0x804bcb1
                fprintf(TraceFP(), "lstat(%s) failed, errno=%d\n", Title, v31);
            }
            // 0x804bcd8
            HTAlert(gettext("Failed to obtain status of current link!"));
        }
        // 0x804c49d
        if (Title != NULL) {
            // 0x804c4ab
            free((int32_t *)Title);
            Title = NULL;
        }
        goto lab_0x804d021;
    }
  lab_0x804d06c:;
    int32_t result = v2; // 0x804d07c
    if (v1 != __readgsdword(20)) {
        // 0x804d07e
        __stack_chk_fail();
        result = &g391;
    }
    // 0x804d083
    return result;
  lab_0x804d021:
    // 0x804d021
    EndInternalPage(stream);
    LYrefresh();
    LYCloseTemp((char *)&g85);
    v2 = 0;
    if (url_type != 0) {
        // 0x804d04a
        free((int32_t *)url_type);
        url_type = 0;
        v2 = 0;
    }
    goto lab_0x804d06c;
  lab_0x804b9e3:;
    int32_t str2 = *(int32_t *)(68 * *v4 + (int32_t)&links); // 0x804b9f6
    char * found_char_pos = strrchr((char *)str2, 47); // 0x804ba07
    int32_t str3 = *(int32_t *)(68 * *v4 + (int32_t)&links); // 0x804ba25
    int32_t v32 = strlen((char *)str3) - 1; // 0x804ba33
    int32_t v33 = *(int32_t *)(68 * *v4 + (int32_t)&links); // 0x804ba55
    if ((int32_t)found_char_pos - v33 == v32) {
        // 0x804ba69
        *(char *)(v33 + v32) = 0;
    }
    goto lab_0x804ba8e;
  lab_0x804c560:
    // 0x804c560
    HTSprintf(&Title, "%s%s", (char *)url_type, v9);
    dt_String(stream, gettext("Linkname:"), Title);
    char * v34 = Title; // 0x804c5b2
    if (v34 != NULL) {
        // 0x804c5bc
        free((int32_t *)v34);
        Title = NULL;
    }
    // 0x804c5d4
    dt_String(stream, "URL:", (char *)*(int32_t *)(v3 + 4));
    int32_t v35; // 0x804b873
    if (HTLoadedDocumentCharset() == NULL) {
        int32_t * v36 = HTAnchor_getUCInfoStage(HTMainAnchor, 1); // 0x804c63e
        if (v36 == NULL) {
            goto lab_0x804c688;
        } else {
            int32_t v37 = (int32_t)v36; // 0x804c63e
            int32_t v38 = *(int32_t *)(v37 + 4); // 0x804c658
            if (v38 == 0) {
                goto lab_0x804c688;
            } else {
                // 0x804c65f
                if (*(char *)v38 == 0) {
                    goto lab_0x804c688;
                } else {
                    // 0x804c66f
                    v35 = v37;
                    if (HTAnchor_getUCLYhndl(HTMainAnchor, 1) >= 0) {
                        goto lab_0x804c6a3;
                    } else {
                        goto lab_0x804c688;
                    }
                }
            }
        }
    } else {
        char * v39 = HTLoadedDocumentCharset(); // 0x804c600
        dt_String(stream, gettext("Charset:"), v39);
        goto lab_0x804c774;
    }
  lab_0x804c688:
    // 0x804c688
    v35 = (int32_t)HTAnchor_getUCInfoStage(HTMainAnchor, 0);
    goto lab_0x804c6a3;
  lab_0x804c774:;
    char * v44 = HText_getServer(); // 0x804c774
    if (v44 != NULL) {
        // 0x804c788
        if (*v44 != 0) {
            // 0x804c795
            dt_String(stream, gettext("Server:"), v44);
        }
    }
    char * v45 = HText_getDate(); // 0x804c7bd
    if (v45 != NULL) {
        // 0x804c7d1
        if (*v45 != 0) {
            // 0x804c7de
            dt_String(stream, gettext("Date:"), v45);
        }
    }
    char * v46 = HText_getLastModified(); // 0x804c806
    if (v46 != NULL) {
        // 0x804c81a
        if (*v46 != 0) {
            // 0x804c827
            dt_String(stream, gettext("Last Mod:"), v46);
        }
    }
    if (user_mode == 2) {
        int32_t * v47 = HTMainAnchor; // 0x804c863
        if (HTMainAnchor != NULL && g199 != NULL) {
            // 0x804c874
            dt_String(stream, gettext("Expires:"), g199);
            v47 = HTMainAnchor;
        }
        int32_t * v48 = v47; // 0x804c8a8
        if (v47 != NULL && g194 != NULL) {
            // 0x804c8b6
            dt_String(stream, gettext("Cache-Control:"), g194);
            v48 = HTMainAnchor;
        }
        char * v49 = gettext("bytes");
        if (v48 == NULL || g198 < 1) {
            int32_t v50 = HText_getNumOfBytes(); // 0x804c947
            dt_Number(stream, gettext("Length:"), v50, v49);
        } else {
            // 0x804c8f8
            dt_Number(stream, gettext("Content-Length:"), g198, v49);
        }
        // 0x804c974
        if (HTMainAnchor != NULL && g196 != NULL) {
            // 0x804c989
            dt_String(stream, gettext("Language:"), g196);
        }
    }
    int32_t v51 = *(int32_t *)(v3 + 8); // 0x804c9b9
    if (v51 != 0) {
        int32_t v52 = *(int32_t *)v51; // 0x804c9da
        int32_t v53 = *(int32_t *)(v51 + 4); // 0x804ca04
        fprintf(stream, "<dt><em>%s</em> <xmp>%.*s</xmp>\n", gettext("Post Data:"), v53, (char *)v52);
        int32_t v54 = *(int32_t *)(v3 + 12); // 0x804ca59
        dt_String(stream, gettext("Post Content Type:"), (char *)v54);
    }
    char * v55 = owner_address2; // 0x804ca85
    if (owner_address2 == NULL) {
        // 0x804ca87
        v55 = gettext("None");
    }
    // 0x804caa7
    dt_String(stream, gettext("Owner(s):"), v55);
    char * v56 = gettext("lines"); // 0x804cad6
    int32_t v57 = HText_getNumOfLines(); // 0x804cadd
    dt_Number(stream, gettext("size:"), v57, v56);
    char * v58; // 0x804b873
    if (lynx_mode != 2) {
        // 0x804cb29
        if (HTisDocumentSource() == 0) {
            // 0x804cb46
            v58 = gettext("normal");
        } else {
            // 0x804cb32
            v58 = gettext("source");
        }
    } else {
        // 0x804cb15
        v58 = gettext("forms mode");
    }
    // 0x804cb64
    HTSACopy(&Title, v58);
    if (*(char *)(v3 + 21) != 0) {
        char * v59 = gettext(", safe"); // 0x804cb91
        HTSACat(&Title, v59);
    }
    // 0x804cba8
    if (*(char *)(v3 + 32) != 0) {
        char * v60 = gettext(", via internal link"); // 0x804cbbd
        HTSACat(&Title, v60);
    }
    if (user_mode == 2) {
        // 0x804cbe1
        if (HText_hasNoCacheSet(HTMainText) != 0) {
            char * v61 = gettext(", no-cache"); // 0x804cbf9
            HTSACat(&Title, v61);
        }
        // 0x804cc10
        if (HTAnchor_isISMAPScript(HTMainAnchor) != 0) {
            char * v62 = gettext(", ISMAP script"); // 0x804cc28
            HTSACat(&Title, v62);
        }
        // 0x804cc3f
        if (*(int32_t *)(v3 + 16) != 0) {
            char * v63 = gettext(", bookmark file"); // 0x804cc53
            HTSACat(&Title, v63);
        }
    }
    // 0x804cc6a
    dt_String(stream, gettext("mode:"), Title);
    if (Title != NULL) {
        // 0x804cc9c
        free((int32_t *)Title);
        Title = NULL;
    }
    // 0x804ccb4
    fwrite((int32_t *)"\n</dl>\n", 1, 7, stream);
    int32_t v64; // 0x804b873
    char * v65; // 0x804b873
    int32_t v66; // 0x804b873
    int32_t * v67; // 0x804cd13
    if (nlinks < 1) {
        // 0x804cffb
        fprintf(stream, "<h2>%s</h2>", gettext("No Links on the current page"));
        goto lab_0x804d021;
    } else {
        // 0x804cce7
        fprintf(stream, "<h2>%s</h2>\n<dl compact>", gettext("Link that you currently have selected"));
        v67 = (int32_t *)(v3 + 24);
        char * v68 = LYGetHiliteStr(*v67, 0); // 0x804cd21
        dt_String(stream, gettext("Linkname:"), v68);
        v64 = 68 * *v67;
        if (lynx_mode != 2) {
            goto lab_0x804cf6b;
        } else {
            // 0x804cd59
            if (*(int32_t *)(v64 + (int32_t)&g347) != 1) {
                goto lab_0x804cf6b;
            } else {
                int32_t v69 = *(int32_t *)(v64 + (int32_t)&g354); // 0x804cd8e
                int32_t v70 = *(int32_t *)(v69 + 52); // 0x804cd94
                v66 = v69;
                if (v70 == 0) {
                    goto lab_0x804cea1;
                } else {
                    int32_t v71 = *(int32_t *)(v69 + 56); // 0x804cdda
                    char * v72 = "POST"; // 0x804cdea
                    if (v70 != 2) {
                        // 0x804cdec
                        v72 = v70 != 3 ? "GET" : "(email)";
                    }
                    // 0x804ce23
                    dt_String(stream, gettext("Method:"), v72);
                    if (v71 == 0) {
                        // 0x804ce6f
                        v65 = "application/x-www-form-urlencoded";
                        goto lab_0x804ce79;
                    } else {
                        char * v73 = (char *)v71;
                        v65 = v73;
                        if (*v73 == 0) {
                            // 0x804ce6f
                            v65 = "application/x-www-form-urlencoded";
                            goto lab_0x804ce79;
                        } else {
                            goto lab_0x804ce79;
                        }
                    }
                }
            }
        }
    }
  lab_0x804c6a3:
    // 0x804c6a3
    if (v35 != 0) {
        int32_t * v40 = (int32_t *)(v35 + 4); // 0x804c6b6
        int32_t v41 = *v40; // 0x804c6b6
        if (v41 != 0) {
            // 0x804c6c1
            if (*(char *)v41 != 0) {
                // 0x804c6d5
                if (HTAnchor_getUCLYhndl(HTMainAnchor, 0) >= 0) {
                    char * v42 = gettext("(assumed)"); // 0x804c6f9
                    HTSprintf(&Title, "%s %s", (char *)*v40, v42);
                    dt_String(stream, gettext("Charset:"), (char *)*v40);
                    char * v43 = Title; // 0x804c752
                    if (v43 != NULL) {
                        // 0x804c75c
                        free((int32_t *)v43);
                        Title = NULL;
                    }
                }
            }
        }
    }
    goto lab_0x804c774;
  lab_0x804cf6b:;
    int32_t v74 = *(int32_t *)(v64 + (int32_t)&links); // 0x804cf7e
    char * v75 = v74 == 0 ? (char *)&g1 : (char *)v74;
    dt_String(stream, "URL:", v75);
    // 0x804cfd3
    fwrite((int32_t *)"\n</dl>\n", 1, 7, stream);
    goto lab_0x804d021;
  lab_0x804cea1:;
    int32_t v76 = *(int32_t *)(v66 + 48); // 0x804ceba
    int32_t v77 = v66; // 0x804cebf
    if (v76 != 0) {
        // 0x804cec1
        dt_String(stream, gettext("Action:"), (char *)v76);
        v77 = *(int32_t *)(68 * *v67 + (int32_t)&g354);
    }
    // 0x804ceff
    if (*(int32_t *)(v77 + 52) == 0) {
        goto lab_0x804cf43;
    } else {
        // 0x804cf1f
        if (*(int32_t *)(v77 + 48) != 0) {
            // 0x804cfd3
            fwrite((int32_t *)"\n</dl>\n", 1, 7, stream);
            goto lab_0x804d021;
        } else {
            goto lab_0x804cf43;
        }
    }
  lab_0x804cf43:
    // 0x804cf43
    fprintf(stream, "<dt>&nbsp;%s\n", gettext("(Form field)"));
    // 0x804cfd3
    fwrite((int32_t *)"\n</dl>\n", 1, 7, stream);
    goto lab_0x804d021;
  lab_0x804ce79:
    // 0x804ce79
    dt_String(stream, gettext("Enctype:"), v65);
    v66 = *(int32_t *)(68 * *v67 + (int32_t)&g354);
    goto lab_0x804cea1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYEdit.c
// Address range: 0x804d090 - 0x804d13d
// Line range:    17 - 54
char editor_can_position(void) {
    int32_t v1 = (int32_t)NULL; // 0x804d0a7
    int32_t str = *(int32_t *)(4 * v1 + (int32_t)&g86); // 0x804d0aa
    char result = 1; // 0x804d0c5
    char * v2; // 0x804d090
    while (strstr((char *)editor, (char *)str) == NULL) {
        char * v3 = (char *)(v1 + 1); // 0x804d0cd
        if (v3 > (char *)10) {
            // 0x804d0d7
            v2 = (char *)positionable_editor;
            result = 0;
            if (positionable_editor == NULL) {
                return result;
            } else {
                goto lab_0x804d101;
            }
        }
        v1 = (int32_t)v3;
        str = *(int32_t *)(4 * v1 + (int32_t)&g86);
        result = 1;
    }
  lab_0x804d137:
    // 0x804d137
    return result;
  lab_0x804d101:
    // 0x804d101
    result = 0;
    if (v2 == NULL) {
        return result;
    } else {
        int32_t v4 = *(int32_t *)((int32_t)v2 + 4); // 0x804d10a
        result = 0;
        if (v4 == 0) {
            return result;
        } else {
            int32_t str2 = *(int32_t *)v4; // 0x804d119
            result = 0;
            if (str2 != 0) {
                // 0x804d0e2
                v2 = (char *)v4;
                result = 1;
                if (strcmp((char *)editor, (char *)str2) != 0) {
                    goto lab_0x804d101;
                } else {
                    return result;
                }
            } else {
                return result;
            }
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYEdit.c
// Address range: 0x804d13d - 0x804d39e
// Line range:    67 - 175
int32_t edit_current_file(char * newfile, int32_t cur, int32_t lineno2) {
    char position[80]; // bp-92, 0x804d13d
    char position2[80]; // bp-96, 0x804d13d
    char v1[80]; // 0x804d27e
    int32_t v2 = __readgsdword(20); // 0x804d14c
    position = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    position2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    if (WWW_TraceFlag != 0) {
        // 0x804d170
        fprintf(TraceFP(), "edit_current_file(newfile=%s, cur=%d, lineno=%d)\n", newfile, cur, lineno2);
    }
    // 0x804d19e
    int32_t v3; // 0x804d13d
    char * v4; // 0x804d1d3
    if (LYisLocalFile(newfile) != 0) {
        // 0x804d1cd
        v4 = trimPoundSelector(newfile);
        int32_t found_char_pos; // 0x804d13d
        if (strncmp(newfile, "file://localhost/", 16) != 0) {
            // 0x804d205
            found_char_pos = (int32_t)strchr(newfile, 58);
        } else {
            // 0x804d1fa
            found_char_pos = (int32_t)newfile + 16;
        }
        // 0x804d21b
        HTSACopy((char **)&position2, (char *)(found_char_pos + 1));
        HTUnEscape((char *)*(int32_t *)&position2);
        if (LYCanReadFile((char *)*(int32_t *)&position2) != 0) {
            goto lab_0x804d2b4;
        } else {
            int32_t v5 = *(int32_t *)&position2; // 0x804d24a
            if (v5 != 0) {
                // 0x804d251
                free((int32_t *)v5);
                position2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
            }
            char * v6 = HTParse(newfile, (char *)&g2, 5); // 0x804d279
            v1[0] = (int32_t)v6;
            position2 = v1;
            HTUnEscape((char *)*(int32_t *)&position2);
            if (LYCanReadFile((char *)*(int32_t *)&position2) != 0) {
                goto lab_0x804d2b4;
            } else {
                // 0x804d29b
                HTAlert(gettext("Could not access file."));
                goto lab_0x804d334;
            }
        }
    } else {
        // 0x804d1ad
        HTUserMsg(gettext("Lynx cannot currently (e)dit remote WWW files."));
        v3 = 0;
        goto lab_0x804d388;
    }
  lab_0x804d2b4:;
    char str = 0; // bp-88, 0x804d2c1
    int32_t v7 = 0; // 0x804d2cc
    if (nlinks != 0) {
        int32_t * v8 = cur >= 0 ? (int32_t *)(68 * cur + (int32_t)&g346) : &g346; // 0x804d2db
        v7 = *v8;
    }
    uint32_t v9 = v7 + lineno2; // 0x804d2f0
    if (v9 >= 1) {
        // 0x804d2f9
        sprintf(&str, "%d", v9);
    }
    // 0x804d313
    edit_temporary_file((char *)*(int32_t *)&position2, &str, NULL);
    position = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    goto lab_0x804d334;
  lab_0x804d388:;
    int32_t result = v3; // 0x804d395
    if (v2 != __readgsdword(20)) {
        // 0x804d397
        __stack_chk_fail();
        result = &g391;
    }
    // 0x804d39c
    return result;
  lab_0x804d334:
    if (v4 != NULL) {
        // 0x804d33a
        *v4 = 35;
    }
    int32_t v10 = *(int32_t *)&position2; // 0x804d340
    if (v10 != 0) {
        // 0x804d347
        free((int32_t *)v10);
        position2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    }
    // 0x804d359
    if (WWW_TraceFlag == 0) {
        // 0x804d359
        v3 = *(int32_t *)&position;
    } else {
        struct _IO_FILE * stream = TraceFP(); // 0x804d364
        int32_t v11 = *(int32_t *)&position; // 0x804d369
        fprintf(stream, "edit_current_file returns %d\n", v11);
        v3 = v11;
    }
    goto lab_0x804d388;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYEdit.c
// Address range: 0x804d39e - 0x804d7bc
// Line range:    180 - 292
void edit_temporary_file(char * filename, char * position, char * message) {
    int32_t v1 = __readgsdword(20); // 0x804d3c3
    char * format2 = NULL; // bp-100, 0x804d3d5
    char * substr_pos = strstr((char *)editor, "pico"); // 0x804d3fa
    if (editor_can_position() == 0) {
        goto lab_0x804d4e2;
    } else {
        // 0x804d417
        if (*position == 0) {
            goto lab_0x804d4e2;
        } else {
            // 0x804d428
            HTAddXpand(&format2, "%s +%s%s %s", 1, (char *)editor);
            HTAddParam(&format2, "%s +%s%s %s", 2, position);
            HTAddParam(&format2, "%s +%s%s %s", 3, substr_pos == NULL ? (char *)&g2 : " -t");
            HTAddParam(&format2, "%s +%s%s %s", 4, filename);
            HTEndParam(&format2, "%s +%s%s %s", 5);
            goto lab_0x804d548;
        }
    }
  lab_0x804d4e2:
    // 0x804d4e2
    HTAddXpand(&format2, "%s %s", 1, (char *)editor);
    HTAddParam(&format2, "%s %s", 2, filename);
    HTEndParam(&format2, "%s %s", 3);
    goto lab_0x804d548;
  lab_0x804d548:
    if (message != NULL) {
        // 0x804d551
        mustshow = 1;
        statusline(message);
    }
    // 0x804d566
    if (WWW_TraceFlag != 0) {
        // 0x804d58f
        fprintf(TraceFP(), "LYEdit: %s\n", format2);
        if (WWW_TraceFlag != 0) {
            // 0x804d59a
            if (LYTraceLogFP == NULL) {
                // 0x804d5a3
                sleep(MessageSecs);
            }
        }
    }
    // 0x804d5b0
    stop_curses();
    *__errno_location() = 0;
    uint32_t v2 = LYSystem(format2); // 0x804d5c6
    start_curses();
    if (v2 != 0) {
        int32_t err_num = *__errno_location(); // 0x804d5e2
        if (WWW_TraceFlag != 0) {
            char * err_str = "reason unknown"; // 0x804d5f6
            if (err_num != 0) {
                // 0x804d5f8
                err_str = strerror(err_num);
            }
            // 0x804d615
            fprintf(TraceFP(), "ExtEditForm: system() returned %d (0x%x), %s\n", v2, v2, err_str);
        }
        // 0x804d646
        LYFixCursesOn("show error warning:");
        if ((char *)v2 != (char *)-1) {
            char v3 = (char)v2 % 128 + 1; // 0x804d691
            if (v3 < 2 || v3 < 0) {
                if ((v2 & 0xff00) == 0x7f00 || v2 % 128 != 0) {
                    // 0x804d725
                    HTAlwaysAlert(NULL, gettext("Error spawning editor, check your editor definition in the options menu"));
                } else {
                    // 0x804d6de
                    int32_t str; // bp-92, 0x804d39e
                    sprintf((char *)&str, "%d", v2 / 256 % 256);
                    char * v4 = gettext("Editor returned with error status %s"); // 0x804d70d
                    HTUserMsg2(v4, (char *)&str);
                }
            } else {
                // 0x804d697
                HTAlwaysAlert(NULL, gettext("Editor killed by signal"));
            }
        } else {
            char * err_str2 = strerror(err_num); // 0x804d65e
            HTUserMsg2(gettext("Error starting editor, %s"), err_str2);
        }
    }
    // 0x804d748
    HTSprintf0(&format2, "%s~", filename);
    int32_t v5; // bp-228, 0x804d39e
    if (stat64((int32_t)format2, &v5) == 0) {
        // 0x804d77e
        remove(format2);
    }
    // 0x804d789
    if (format2 != NULL) {
        // 0x804d790
        free((int32_t *)format2);
        format2 = NULL;
    }
    // 0x804d7a2
    if (v1 != __readgsdword(20)) {
        // 0x804d7ae
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804d7bc - 0x804d7f9
// Line range:    87 - 96
int32_t peek_mouse_levent(void) {
    int32_t result = 0; // 0x804d7c9
    if (have_levent >= 1) {
        // 0x804d7cb
        int32_t v1; // 0x804d7bc
        function_804a7a4(&levent, v1);
        have_levent--;
        result = 1;
    }
    // 0x804d7f4
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804d7f9 - 0x804d823
// Line range:    100 - 108
int32_t get_mouse_link(void) {
    int32_t v1 = mouse_link; // 0x804d7ff
    mouse_link = -1;
    return v1 >= 0 ? v1 : -1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804d823 - 0x804d82d
// Line range:    112 - 114
int32_t peek_mouse_link(void) {
    // 0x804d823
    return mouse_link;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804d82d - 0x804db0a
// Line range:    118 - 264
int32_t fancy_mouse(int32_t * win, int32_t row, int32_t * position) {
    // 0x804d82d
    int32_t v1; // bp-36, 0x804d82d
    function_804acb4(&v1);
    int32_t v2; // 0x804d82d
    if ((v2 & 28) == 0) {
        // 0x804daec
        return (v2 & 0x1c000) == 0 ? 69 : 13;
    }
    int32_t v3 = (int32_t)win;
    int32_t v4; // 0x804d82d
    int32_t v5; // 0x804d82d
    if (win == NULL) {
        // 0x804d873
        v4 = v2 + 1;
        v5 = -1;
    } else {
        // 0x804d893
        v4 = v2 - (int32_t)*(int16_t *)(v3 + 8);
        v5 = (int32_t)*(int16_t *)(v3 + 10);
    }
    // 0x804d8a7
    if (v2 < v5) {
        goto lab_0x804d8f7;
    } else {
        int32_t v6 = -1; // 0x804d8b9
        int32_t v7 = -1; // 0x804d8b9
        if (win != NULL) {
            // 0x804d8d5
            v6 = (int32_t)*(int16_t *)(v3 + 10);
            v7 = (int32_t)*(int16_t *)(v3 + 6) + 1;
        }
        // 0x804d8ec
        if (v2 < v7 + v6) {
            goto lab_0x804d90f;
        } else {
            goto lab_0x804d8f7;
        }
    }
  lab_0x804d8f7:
    // 0x804d8f7
    if ((v2 & 0x7000000) == 0) {
        // 0x804db05
        return 13;
    }
    goto lab_0x804d90f;
  lab_0x804d90f:;
    int32_t v8 = -1; // 0x804d91c
    if (win != NULL) {
        // 0x804d91e
        v8 = (int32_t)*(int16_t *)(v3 + 4) + 1;
    }
    // 0x804d935
    int32_t result; // 0x804d82d
    if (v4 + 1 == v8) {
        // 0x804d93d
        result = 23;
        if ((v2 & 16) == 0) {
            // 0x804d953
            result = (v2 & 8) == 0 ? 27 : 15;
        }
        // 0x804db05
        return result;
    }
    int32_t v9 = -1; // 0x804d979
    if (win != NULL) {
        // 0x804d97b
        v9 = (int32_t)*(int16_t *)(v3 + 4) + 1;
    }
    // 0x804d992
    if (v9 <= v4) {
        // 0x804db05
        return (v2 & 24) == 0 ? 15 : 23;
    }
    if (v4 == 0) {
        // 0x804d9c2
        result = 22;
        if ((v2 & 16) == 0) {
            // 0x804d9d8
            result = (v2 & 8) == 0 ? 26 : 16;
        }
        // 0x804db05
        return result;
    }
    if (v4 < 0) {
        // 0x804db05
        return (v2 & 24) == 0 ? 16 : 22;
    }
    int32_t v10 = 0; // 0x804da2c
    if (win != NULL) {
        // 0x804da2e
        v10 = (int32_t)*(int16_t *)(v3 + 10) + 1;
    }
    int32_t v11 = v4 - row;
    if (v2 <= v10) {
        // 0x804da98
        *position = *position + v11;
        // 0x804db05
        return -1;
    }
    int32_t v12 = -3; // 0x804da57
    int32_t v13 = -1; // 0x804da57
    if (win != NULL) {
        // 0x804da73
        v12 = (int32_t)*(int16_t *)(v3 + 10) - 2;
        v13 = (int32_t)*(int16_t *)(v3 + 6) + 1;
    }
    // 0x804da8a
    if (v2 >= v13 + v12) {
        // 0x804da98
        *position = *position + v11;
        // 0x804db05
        return -1;
    }
    // 0x804dab0
    *position = *position + v11;
    // 0x804db05
    return (v2 & 0x7000000) == 0 ? 39 : -1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804db0a - 0x804db60
// Line range:    270 - 286
int32_t * whichRecall(int32_t recall) {
    if (recall == 2) {
        // 0x804db5b
        return (int32_t *)(int32_t)LYcommandList();
    }
    int32_t v1 = recall == 3 ? (int32_t)&MAIL_edit_history : (int32_t)&URL_edit_history;
    int32_t * v2 = (int32_t *)v1; // 0x804db41
    int32_t v3 = *v2; // 0x804db41
    int32_t v4 = v3; // 0x804db45
    if (v3 == 0) {
        // 0x804db47
        v4 = (int32_t)HTList_new();
        *v2 = v4;
    }
    // 0x804db5b
    return (int32_t *)v4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804db60 - 0x804db94
// Line range:    292 - 297
void LYRemoveFromCloset(int32_t * list) {
    char * v1 = HTList_removeFirstObject(list); // 0x804db6c
    if (v1 != NULL) {
        // 0x804db80
        free((int32_t *)v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804db94 - 0x804dbd2
// Line range:    300 - 307
void LYCloseCloset(int32_t recall) {
    int32_t * v1 = whichRecall(recall); // 0x804dba0
    if (v1 == NULL) {
        // 0x804dbc5
        HTList_delete(v1);
        return;
    }
    int32_t * v2 = (int32_t *)((int32_t)v1 + 4);
    if (*v2 == 0) {
        // 0x804dbc5
        HTList_delete(v1);
        return;
    }
    LYRemoveFromCloset(v1);
    while (*v2 != 0) {
        // 0x804dbaa
        LYRemoveFromCloset(v1);
    }
    // 0x804dbc5
    HTList_delete(v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804dbd2 - 0x804dc63
// Line range:    315 - 327
char * LYFindInCloset(int32_t recall, char * base) {
    int32_t * v1 = whichRecall(recall); // 0x804dbde
    int32_t len = strlen(base); // 0x804dbec
    int32_t v2 = (int32_t)v1; // 0x804dbf4
    char * result = NULL; // 0x804dc4b
    while (v2 != 0) {
        // 0x804dc4d
        v2 += 4;
        result = NULL;
        if (v2 == 0) {
            // break -> 0x804dc5e
            break;
        }
        char * str = (char *)*(int32_t *)v2;
        int32_t strncmp_rc = strncmp(base, str, len); // 0x804dc36
        result = str;
        if (strncmp_rc == 0) {
            // break -> 0x804dc5e
            break;
        }
        result = NULL;
    }
    // 0x804dc5e
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804dc63 - 0x804dcc1
// Line range:    330 - 338
void LYAddToCloset(int32_t recall, char * str) {
    int32_t * v1 = whichRecall(recall); // 0x804dc6f
    int32_t * list = NULL; // bp-12, 0x804dc77
    HTSACopy((char **)&list, str);
    HTList_addObject(v1, (char *)list);
    if (HTList_count(v1) <= 100) {
        // 0x804dcbf
        return;
    }
    LYRemoveFromCloset(v1);
    while (HTList_count(v1) > 100) {
        // 0x804dca4
        LYRemoveFromCloset(v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804dcc1 - 0x804dd78
// Line range:    346 - 373
int32_t XYdist(int32_t x1, int32_t y1, int32_t x2, int32_t y2, int32_t dx2) {
    int32_t v1 = 3 * (x2 - x1); // 0x804dcd7
    int32_t v2 = v1; // 0x804dcf6
    if (v1 < 0) {
        // 0x804dcf8
        v2 = 3 * (x1 - x2 - dx2) + 1;
    }
    int32_t v3 = 9 * (y2 - y1); // 0x804dced
    int32_t v4 = v2;
    int32_t v5 = v4 >= 0 ? v4 : 0;
    int32_t v6 = v3 >= 0 ? v3 : -v3;
    if (v6 != 0) {
        // 0x804dd73
        return 2 * v5 + v6 + (v5 > 8 ? 0 : 9 - v5);
    }
    int32_t result = 0; // 0x804dd31
    if (v5 >= 1) {
        // 0x804dd33
        result = 2 * v5 - 1;
    }
    // 0x804dd73
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804dd78 - 0x804e53c
// Line range:    386 - 565
int32_t set_clicked_link(int32_t x, int32_t y, int32_t code, int32_t clicks) {
    // 0x804dd78
    int32_t result; // 0x804dd78
    if (y != 0 != LYlines != y + 1) {
        int32_t v1; // 0x804dd78
        if (y != 0) {
            // 0x804de21
            mouse_link = -2;
            v1 = 0;
        } else {
            char v2 = HText_hasToolbar(HTMainText); // 0x804ddd7
            mouse_link = -2;
            int32_t v3 = 0; // 0x804ddde
            if (v2 != 0) {
                // 0x804ddf6
                v3 = 1;
                if (x == 0) {
                    // 0x804e52f
                    return 2122;
                }
            }
            // 0x804de27
            v1 = v3;
            if (s_hot_paste != -1 && LYcols - (int32_t)(LYShowScrollbar != 0) == x) {
                // 0x804e52f
                return 2151;
            }
        }
        int32_t v4 = LYcols - (int32_t)(LYShowScrollbar != 0) - 5; // 0x804dda5
        if (clicks >= 2) {
            if ((v1 || 6) > x) {
                // 0x804e52f
                return y == 0 | code != 3 ? 2096 : 262;
            }
            if (v4 < x) {
                // 0x804dead
                result = y == 0 | code != 3 ? 2109 : 263;
            } else {
                // 0x804dedd
                result = y == 0 ? 2070 : 2071;
            }
            // 0x804e52f
            return result;
        }
        if ((v1 || 6) > x) {
            // 0x804df09
            result = 259;
            if (code == 3 != y != 0) {
                // 0x804df15
                return x - v1 < 3 | s_forw_backw == -1 ? 2085 : 2086;
            }
        } else {
            if (v4 < x) {
                // 0x804df6b
                result = y == 0 | code != 3 ? 2084 : 258;
            } else {
                // 0x804df92
                result = y == 0 ? 2064 : 2063;
            }
        }
        // 0x804e52f
        return result;
    }
    // 0x804dfb0
    if (LYcols == x + 1 && LYShowScrollbar != 0 && LYsb_begin >= 0) {
        // 0x804dfdd
        mouse_link = -2;
        int32_t v5 = y - (LYsb_arrow == 0 ? 1 : 2); // 0x804e032
        if (v5 < 0) {
            // 0x804e52f
            return 2065;
        }
        uint32_t v6 = display_lines - (LYsb_arrow == 0 ? 0 : 2); // 0x804e004
        if (v5 >= v6) {
            // 0x804e52f
            return 2066;
        }
        if (clicks >= 2) {
            int32_t v7 = HText_getNumOfLines() + 1 - display_lines; // 0x804e087
            if (v7 >= 1) {
                // 0x804e090
                LYSetNewline((int32_t)(1.5L + (float80_t)v5 / (float80_t)(v6 - 1) * (float80_t)v7));
            }
            // 0x804e52f
            return LYReverseKeymap(69);
        }
        // 0x804e0d7
        if (v5 < LYsb_begin) {
            // 0x804e52f
            return 2064;
        }
        // 0x804e0ed
        result = 2063;
        if (v5 < LYsb_end) {
            // 0x804e103
            mouse_link = -1;
            result = -1;
        }
        // 0x804e52f
        return result;
    }
    int32_t v8 = 0; // 0x804e498
    int32_t v9 = 29; // 0x804e498
    int32_t v10 = 29; // 0x804e498
    int32_t v11; // 0x804dd78
    int32_t v12; // 0x804dd78
    int32_t v13; // 0x804dd78
    int32_t v14; // 0x804e130
    int32_t * v15; // 0x804e132
    int32_t v16; // 0x804e132
    char * str; // 0x804e156
    if (nlinks > 0) {
        while (true) {
          lab_0x804e125:
            // 0x804e125
            v11 = v9;
            v13 = v8;
            v14 = 68 * v13;
            v15 = (int32_t *)(v14 + (int32_t)&g345);
            v16 = *v15;
            str = LYGetHiliteStr(v13, 0);
            v12 = 0;
            if (*(int32_t *)(v14 + (int32_t)&g347) != 1) {
                goto lab_0x804e208;
            } else {
                int32_t v17 = *(int32_t *)(v14 + (int32_t)&g354); // 0x804e187
                int32_t v18 = *(int32_t *)(v17 + 8); // 0x804e18d
                switch (v18) {
                    case 1: {
                        // 0x804e201
                        v12 = 1;
                        goto lab_0x804e208;
                    }
                    case 12: {
                        // 0x804e201
                        v12 = 1;
                        goto lab_0x804e208;
                    }
                    case 2: {
                        // 0x804e201
                        v12 = 1;
                        goto lab_0x804e208;
                    }
                    case 11: {
                        // 0x804e201
                        v12 = 1;
                        goto lab_0x804e208;
                    }
                    default: {
                        // 0x804e1e6
                        v12 = 0;
                        if (v18 != 9) {
                            goto lab_0x804e208;
                        } else {
                            // 0x804e201
                            v12 = 1;
                            goto lab_0x804e208;
                        }
                    }
                }
            }
        }
    }
  lab_0x804e49e_2:;
    int32_t v19 = mouse_link; // 0x804dd78
    int32_t v20 = -1; // 0x804dd78
    int32_t v21 = v10; // 0x804dd78
    goto lab_0x804e49e;
  lab_0x804e208:;
    int32_t v31 = v11; // 0x804e20c
    int32_t v29; // 0x804dd78
    int32_t v30; // 0x804dd78
    int32_t v25; // 0x804dd78
    int32_t v27; // 0x804dd78
    int32_t v28; // 0x804dd78
    if (str != NULL) {
        // 0x804e212
        v25 = v12;
        int32_t len; // 0x804dd78
        if (v25 == 0) {
            // 0x804e233
            len = strlen(str);
        } else {
            int32_t v32 = *(int32_t *)(v14 + (int32_t)&g354); // 0x804e225
            len = *(int32_t *)(v32 + 20);
        }
        // 0x804e241
        v28 = len;
        int32_t * v33 = (int32_t *)(v14 + (int32_t)&g346); // 0x804e24e
        int32_t v34 = XYdist(x, y, *v15, *v33, v28); // 0x804e283
        int32_t v35 = v34; // 0x804e321
        int32_t v36 = v34; // 0x804e321
        bool v37 = true; // 0x804e321
        if (v34 >= 1) {
            int32_t v38 = v35;
            int32_t v39 = 1; // 0x804e323
            char * str2 = LYGetHiliteStr(v13, v39); // 0x804e334
            v36 = v38;
            v37 = false;
            while (str2 != NULL) {
                int32_t len2 = strlen(str2); // 0x804e296
                int32_t v40 = XYdist(x, y, LYGetHilitePos(v13, v39), *v33 + v39, len2); // 0x804e2e0
                int32_t v41 = v38 > v40 ? v40 : v38;
                v35 = v41;
                int32_t v42 = v39; // 0x804e321
                v36 = v41;
                v37 = true;
                if (v41 < 1) {
                    // break -> 0x804e346
                    break;
                }
                v38 = v35;
                v39 = v42 + 1;
                str2 = LYGetHiliteStr(v13, v39);
                v36 = v38;
                v37 = false;
            }
        }
        int32_t v43 = v36 + (int32_t)!((v25 == 0 | v37));
        if (v43 == 0) {
            int32_t * v44 = LYwin;
            v29 = v44 == NULL ? -1 : 0x10000 * (int32_t)v44 >> 16;
            v27 = v44 == NULL ? -1 : (int32_t)*(int16_t *)&g255;
            if (clicks < 2 || v25 == 0) {
                goto lab_0x804e422;
            } else {
                int32_t v45 = *(int32_t *)(v14 + (int32_t)&g354); // 0x804e3c2
                if (*(int32_t *)(v45 + 8) != 12) {
                    goto lab_0x804e422;
                } else {
                    // 0x804e3d0
                    v30 = v13;
                    if (code != 2) {
                        goto lab_0x804e419;
                    } else {
                        // 0x804e3d6
                        v30 = v27 - v16 > v28 | v27 < v16 | v29 != y ? v13 : -1;
                        goto lab_0x804e419;
                    }
                }
            }
        }
        // 0x804e476
        v31 = v11;
        if (v43 < v11) {
            // 0x804e47e
            mouse_link = v13;
            v31 = v43;
        }
    }
    // 0x804e48c
    v9 = v31;
    v8 = v13 + 1;
    v10 = v9;
    if (v8 >= nlinks) {
        // break -> 0x804e49e
        goto lab_0x804e49e_2;
    }
    goto lab_0x804e125;
  lab_0x804e49e:
    // 0x804e49e
    if (v19 < 0) {
        int32_t v22 = 4 * y;
        if (2 * y > LYlines) {
            // 0x804e4da
            result = v22 < 3 * LYlines ? 2066 : 2068;
        } else {
            // 0x804e506
            result = v22 < LYlines ? 2067 : 2065;
        }
        // 0x804e52f
        return result;
    }
    int32_t v23 = v20;
    if (v21 != 0) {
        // 0x804e4bc
        return v21 < 0 ? v23 : 2132;
    }
    // 0x804e52f
    return v23 != -1 ? v23 : 2087;
  lab_0x804e422:;
    int32_t v24; // 0x804dd78
    if (code != 2) {
        // 0x804e449
        v24 = v13;
        if (v25 == 0) {
            goto lab_0x804e46d;
        } else {
            // 0x804e44f
            have_levent = 1;
            v24 = v13;
            goto lab_0x804e46d;
        }
    } else {
        bool v26 = v27 - v16 > v28 | v27 < v16 | v29 != y;
        v24 = v26 ? v13 : -1;
        if (v25 == 0 || !v26) {
            goto lab_0x804e46d;
        } else {
            // 0x804e44f
            have_levent = 1;
            v24 = v13;
            goto lab_0x804e46d;
        }
    }
  lab_0x804e46d:
    // 0x804e46d
    mouse_link = v24;
    v19 = v24;
    v20 = -1;
    v21 = 0;
    goto lab_0x804e49e;
  lab_0x804e419:
    // 0x804e419
    mouse_link = v30;
    v19 = v30;
    v20 = 2088;
    v21 = 0;
    goto lab_0x804e49e;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804e53c - 0x804e5a7
// Line range:    575 - 592
char * LYstrncpy(char * dst, char * src, int32_t n) {
    int32_t v1 = (int32_t)dst;
    char * str = src != NULL ? src : (char *)&g3;
    int32_t len = strlen(str); // 0x804e555
    int32_t n2 = n >= 0 ? n : 0;
    char * dest_str = strncpy(dst, str, n2); // 0x804e57e
    if (n2 > len) {
        // 0x804e58e
        *(char *)(len + v1) = 0;
    } else {
        // 0x804e599
        *(char *)(n2 + v1) = 0;
    }
    // 0x804e5a2
    return dest_str;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804e5a7 - 0x804e657
// Line range:    608 - 629
char * LYmbcsstrncpy(char * dst, char * src, int32_t n_bytes, int32_t n_glyphs, char utf_flag) {
    int32_t v1 = n_bytes >= 0 ? n_bytes : 0;
    char v2 = *src; // 0x804e637
    if (v1 > 0 != v2 != 0) {
        // 0x804e646
        *dst = 0;
        // 0x804e652
        return dst;
    }
    int32_t v3 = n_glyphs >= 0 ? n_glyphs : 0;
    int32_t v4 = 0; // 0x804e630
    char * v5 = src; // 0x804e62c
    char * v6 = NULL;
    char * v7 = v6; // 0x804e5e7
    int32_t v8; // 0x804e5fe
    int32_t v9; // 0x804e601
    if (utf_flag != 0 && (v2 & -64) != -128) {
        // 0x804e5fe
        v8 = (int32_t)v6;
        v9 = v8 - v3;
        v7 = (char *)(v8 + 1);
        if (v9 < 0 == ((v9 ^ v8) & (v3 ^ v8)) < 0) {
            // 0x804e60f
            *dst = 0;
            return dst;
        }
    }
    // 0x804e61d
    *dst = v2;
    char * v10 = (char *)((int32_t)dst + 1);
    v5 = (char *)((int32_t)v5 + 1);
    v4++;
    char v11 = *v5; // 0x804e637
    while (v1 > v4 == (v11 != 0)) {
        char * v12 = v10;
        v6 = v7;
        v7 = v6;
        if (utf_flag != 0 && (v11 & -64) != -128) {
            // 0x804e5fe
            v8 = (int32_t)v6;
            v9 = v8 - v3;
            v7 = (char *)(v8 + 1);
            if (v9 < 0 == ((v9 ^ v8) & (v3 ^ v8)) < 0) {
                // 0x804e60f
                *v12 = 0;
                return dst;
            }
        }
        // 0x804e61d
        *v12 = v11;
        v10 = (char *)((int32_t)v12 + 1);
        v5 = (char *)((int32_t)v5 + 1);
        v4++;
        v11 = *v5;
    }
    // 0x804e646
    *v10 = 0;
  lab_0x804e652:
    // 0x804e652
    return dst;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804e657 - 0x804e6ed
// Line range:    639 - 663
char * LYmbcs_skip_glyphs(char * data, int32_t n_glyphs, char utf_flag) {
    // 0x804e657
    if (data == NULL) {
        // 0x804e6e8
        return NULL;
    }
    char v1 = *data; // 0x804e680
    if (v1 == 0) {
        // 0x804e6e8
        return data;
    }
    int32_t v2 = n_glyphs >= 0 ? n_glyphs : 0;
    char * v3 = data; // 0x804e68b
    char * result; // 0x804e657
    if (utf_flag != 0) {
        int32_t v4 = 0;
        int32_t v5 = v4; // 0x804e6b2
        int32_t v6; // 0x804e6cc
        if ((v1 & -64) != -128) {
            // 0x804e6c9
            v6 = v4 - v2;
            v5 = v4 + 1;
            if (v6 < 0 == ((v6 ^ v4) & (v4 ^ v2)) < 0) {
                // break -> 0x804e6e8
                break;
            }
        }
        char * v7 = (char *)((int32_t)data + 1);
        char v8 = *v7; // 0x804e6e1
        result = v7;
        while (v8 != 0) {
            // 0x804e6ae
            v4 = v5;
            char * v9 = v7;
            v5 = v4;
            if ((v8 & -64) != -128) {
                // 0x804e6c9
                v6 = v4 - v2;
                v5 = v4 + 1;
                result = v9;
                if (v6 < 0 == ((v6 ^ v4) & (v4 ^ v2)) < 0) {
                    // break -> 0x804e6e8
                    break;
                }
            }
            // 0x804e6da
            v7 = (char *)((int32_t)v9 + 1);
            v8 = *v7;
            result = v7;
        }
    } else {
        int32_t v10 = v2;
        result = v3;
        while (v10 >= 0 == (v10 != 0)) {
            // 0x804e68f
            v3 = (char *)((int32_t)v3 + 1);
            result = v3;
            if (*v3 == 0) {
                // break -> 0x804e6e8
                break;
            }
            v10--;
            result = v3;
        }
    }
    // 0x804e6e8
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804e6ed - 0x804e751
// Line range:    673 - 683
char * LYmbcs_skip_cells(char * data, int32_t n_cells, char utf_flag) {
    char * v1 = (char *)n_cells;
    int32_t v2 = (int32_t)v1; // 0x804e703
    char * result = LYmbcs_skip_glyphs(data, v2, utf_flag); // 0x804e718
    int32_t v3 = LYstrExtent2(data, (int32_t)result - (int32_t)data); // 0x804e736
    while (v3 >= 1) {
        // 0x804e744
        if ((char *)v3 <= v1) {
            // break -> 0x804e74c
            break;
        }
        v2--;
        result = LYmbcs_skip_glyphs(data, v2, utf_flag);
        v3 = LYstrExtent2(data, (int32_t)result - (int32_t)data);
    }
    // 0x804e74c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804e751 - 0x804e8c9
// Line range:    696 - 727
int32_t LYmbcsstrlen(char * str, char utf_flag, char count_gcells) {
    // 0x804e751
    if (str == NULL) {
        // 0x804e8c4
        return 0;
    }
    char v1 = *str; // 0x804e777
    if (v1 == 0) {
        // 0x804e8c4
        return 0;
    }
    if (count_gcells != 0) {
        // 0x804e8c4
        return LYstrCells(str);
    }
    int32_t v2 = (int32_t)str;
    int32_t v3 = 0;
    int32_t v4 = 0;
    int32_t v5 = v3; // 0x804e7b2
    int32_t v6 = v4; // 0x804e7b2
    int32_t v7; // 0x804e751
    int32_t v8; // 0x804e751
    int32_t v9; // 0x804e751
    char v10; // 0x804e805
    int32_t v11; // 0x804e87e
    char v12; // 0x804e884
    int32_t v13; // 0x804e7ff
    char v14; // 0x804e805
    int32_t v15; // 0x804e7f8
    int32_t v16; // 0x804e7c5
    int32_t v17; // 0x804e7ff
    if (v1 >= 9) {
        // 0x804e7c5
        v16 = v3 + 1;
        if (utf_flag == 0) {
            // 0x804e859
            v5 = v16;
            v6 = v4;
            if (HTCJK != 0) {
                // 0x804e86e
                v5 = v16;
                v6 = v4;
                if (*(char *)(v4 + v2) < 0) {
                    // 0x804e87b
                    v11 = v4 + 1;
                    v12 = *(char *)(v11 + v2);
                    v5 = v16;
                    v6 = v4;
                    if (v12 != 0) {
                        // 0x804e88b
                        v5 = v16;
                        v6 = v12 < 9 ? v4 : v11;
                    }
                }
            }
        } else {
            // 0x804e7d3
            v5 = v16;
            v6 = v4;
            if ((v1 & -64) != -128) {
                // 0x804e7fc
                v17 = v4 + 1;
                v10 = *(char *)(v17 + v2);
                v5 = v16;
                v6 = v4;
                if (v10 != 0) {
                    // 0x804e810
                    v9 = 0;
                    v7 = v17;
                    v5 = v16;
                    v6 = v4;
                    if ((v10 & -64) == -128 == v10 > 8) {
                        v8 = v7;
                        v13 = v8 + 1;
                        v14 = *(char *)(v13 + v2);
                        v5 = v16;
                        v6 = v8;
                        while (v14 != 0) {
                            // 0x804e810
                            v15 = v9 + 1;
                            v9 = v15;
                            v7 = v13;
                            v5 = v16;
                            v6 = v8;
                            if ((v14 & -64) == -128 != (v14 > 8 == v15 < 5)) {
                                // break -> 0x804e8af
                                break;
                            }
                            v8 = v7;
                            v13 = v8 + 1;
                            v14 = *(char *)(v13 + v2);
                            v5 = v16;
                            v6 = v8;
                        }
                    }
                }
            }
        }
    }
    int32_t result = v5;
    int32_t v18 = v6 + 1; // 0x804e8af
    char v19 = *(char *)(v18 + v2); // 0x804e8b9
    while (v19 != 0) {
        // 0x804e7a7
        v3 = result;
        v4 = v18;
        char v20 = v19;
        v5 = v3;
        v6 = v4;
        if (v20 >= 9) {
            // 0x804e7c5
            v16 = v3 + 1;
            if (utf_flag == 0) {
                // 0x804e859
                v5 = v16;
                v6 = v4;
                if (HTCJK != 0) {
                    // 0x804e86e
                    v5 = v16;
                    v6 = v4;
                    if (*(char *)(v4 + v2) < 0) {
                        // 0x804e87b
                        v11 = v4 + 1;
                        v12 = *(char *)(v11 + v2);
                        v5 = v16;
                        v6 = v4;
                        if (v12 != 0) {
                            // 0x804e88b
                            v5 = v16;
                            v6 = v12 < 9 ? v4 : v11;
                        }
                    }
                }
            } else {
                // 0x804e7d3
                v5 = v16;
                v6 = v4;
                if ((v20 & -64) != -128) {
                    // 0x804e7fc
                    v17 = v4 + 1;
                    v10 = *(char *)(v17 + v2);
                    v5 = v16;
                    v6 = v4;
                    if (v10 != 0) {
                        // 0x804e810
                        v9 = 0;
                        v7 = v17;
                        v5 = v16;
                        v6 = v4;
                        if ((v10 & -64) == -128 == v10 > 8) {
                            v8 = v7;
                            v13 = v8 + 1;
                            v14 = *(char *)(v13 + v2);
                            v5 = v16;
                            v6 = v8;
                            while (v14 != 0) {
                                // 0x804e810
                                v15 = v9 + 1;
                                v9 = v15;
                                v7 = v13;
                                v5 = v16;
                                v6 = v8;
                                if ((v14 & -64) == -128 != (v14 > 8 == v15 < 5)) {
                                    // break -> 0x804e8af
                                    break;
                                }
                                v8 = v7;
                                v13 = v8 + 1;
                                v14 = *(char *)(v13 + v2);
                                v5 = v16;
                                v6 = v8;
                            }
                        }
                    }
                }
            }
        }
        // 0x804e8af
        result = v5;
        v18 = v6 + 1;
        v19 = *(char *)(v18 + v2);
    }
    // 0x804e8c4
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804e8c9 - 0x804e8e0
// Line range:    888 - 890
void ena_csi(char flag) {
    // 0x804e8c9
    csi_is_csi = flag;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804f8f8 - 0x804fb14
// Line range:    1350 - 1392
int32_t read_keymap_file(void) {
    char file2[256]; // bp-272, 0x804f8f8
    char file[256]; // bp-276, 0x804f8f8
    char v1[256]; // 0x804f94b
    int32_t v2 = __readgsdword(20); // 0x804f902
    file2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    int32_t v3; // bp-268, 0x804f8f8
    LYAddPathToHome((char *)&v3, 256, ".lynx-keymaps");
    struct _IO_FILE * v4 = fopen64((char *)&v3, "r"); // 0x804f946
    v1[0] = (int32_t)v4;
    file = v1;
    int32_t v5 = *(int32_t *)&file; // 0x804f951
    int32_t v6; // 0x804f8f8
    int32_t v7; // 0x804f8f8
    struct _IO_FILE * v8; // 0x804f8f8
    if (v5 != 0) {
        // 0x804fa9a
        v8 = (struct _IO_FILE *)v5;
        char * v9 = LYSafeGets((char **)&file2, v8); // 0x804faad
        int32_t v10 = *(int32_t *)&file2;
        v7 = v10;
        v6 = v10;
        if (v9 != NULL) {
            while (true) {
              lab_0x804f978:;
                char * str2 = LYSkipBlanks((char *)v7); // 0x804f981
                int32_t v11 = (int32_t)str2; // 0x804f981
                switch (*str2) {
                    case 0: {
                        goto lab_0x804fa9a;
                    }
                    case 35: {
                        goto lab_0x804fa9a;
                    }
                    default: {
                        int32_t v12 = (int32_t)NULL;
                        int32_t * str = (int32_t *)(8 * v12 + (int32_t)&g87); // 0x804f9ca
                        uint32_t len = strlen((char *)*str); // 0x804f9d4
                        if (strlen(str2) > len) {
                            // 0x804f9f9
                            if (strncmp(str2, (char *)*str, len) == 0) {
                                // 0x804fa26
                                if (LYSkipBlanks((char *)(len + v11)) < NULL) {
                                    // 0x804fa52
                                    fprintf((struct _IO_FILE *)g160, gettext("Error processing line %d of %s\n"));
                                }
                            }
                        }
                        int32_t * v13 = (int32_t *)(v12 + 1); // 0x804fa86
                        while (v13 < (int32_t *)2) {
                            // 0x804f9c4
                            v12 = (int32_t)v13;
                            str = (int32_t *)(8 * v12 + (int32_t)&g87);
                            len = strlen((char *)*str);
                            if (strlen(str2) > len) {
                                // 0x804f9f9
                                if (strncmp(str2, (char *)*str, len) == 0) {
                                    // 0x804fa26
                                    if (LYSkipBlanks((char *)(len + v11)) < NULL) {
                                        // 0x804fa52
                                        fprintf((struct _IO_FILE *)g160, gettext("Error processing line %d of %s\n"));
                                    }
                                }
                            }
                            // 0x804fa86
                            v13 = (int32_t *)(v12 + 1);
                        }
                        goto lab_0x804fa9a;
                    }
                }
            }
        }
      lab_0x804faba:
        // 0x804faba
        if (v6 != 0) {
            // 0x804fac4
            free((int32_t *)v6);
            file2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        }
        // 0x804fadc
        LYCloseInput(v8);
    }
    int32_t result = 0; // 0x804fb04
    if (v2 != __readgsdword(20)) {
        // 0x804fb06
        __stack_chk_fail();
        result = &g391;
    }
    // 0x804fb0b
    return result;
  lab_0x804fa9a:;
    char * v14 = LYSafeGets((char **)&file2, v8); // 0x804faad
    int32_t v15 = *(int32_t *)&file2;
    v7 = v15;
    v6 = v15;
    if (v14 == NULL) {
        // break -> 0x804faba
        goto lab_0x804faba;
    }
    goto lab_0x804f978;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804fb14 - 0x804fb4f
// Line range:    1395 - 1454
void setup_vtXXX_keymap(void) {
    for (int32_t i = 0; i < 21; i++) {
        int32_t v1 = 8 * i; // 0x804fb26
        int32_t v2 = *(int32_t *)(v1 + (int32_t)&g89); // 0x804fb26
        int32_t v3 = *(int32_t *)(v1 + (int32_t)&g88); // 0x804fb30
        function_804b1f4((int32_t *)v3, v2);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804fb4f - 0x804fb61
// Line range:    1457 - 1485
int32_t lynx_initialize_keymaps(void) {
    // 0x804fb4f
    setup_vtXXX_keymap();
    return read_keymap_file();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804fb61 - 0x804fd24
// Line range:    1491 - 1607
int32_t LYmouse_menu(int32_t x, int32_t y, int32_t atlink, int32_t code) {
    // 0x804fb61
    int32_t v1; // bp-4, 0x804fb61
    int32_t v2 = &v1; // 0x804fb62
    int32_t v3 = v2 - 228;
    int32_t v4 = v2 - 120;
    int32_t v5 = 0;
    for (int32_t i = 0; i < 26; i++) {
        int32_t v6 = v5;
        int32_t v7 = 12 * i; // 0x804fba7
        int32_t v8 = *(int32_t *)(v7 + (int32_t)&g7); // 0x804fbaa
        int32_t v9 = v6; // 0x804fbb7
        if ((v8 & (atlink == 0 ? 2 : 1)) == 0) {
            int32_t v10 = *(int32_t *)(v7 + (int32_t)&g5); // 0x804fbc8
            int32_t v11 = 4 * v6; // 0x804fbce
            *(int32_t *)(v11 + v3) = v10;
            int32_t v12 = *(int32_t *)(v7 + (int32_t)&g6); // 0x804fbe4
            *(int32_t *)(v11 + v4) = v12;
            v9 = v6 + 1;
        }
        // 0x804fbf2
        v5 = v9;
    }
    // 0x804fbfc
    *(int32_t *)(4 * v5 + v3) = 0;
    int32_t v13 = x < 6 ? 1 : x - 5;
    int32_t v14 = atlink == 0 ? 9 : 1;
    int32_t v15; // bp-232, 0x804fb61
    int32_t v16 = popup_choice(v14, y, v13, (char **)&v15, v5, 0, 1); // 0x804fc7f
    int32_t v17; // 0x804fb61
    if (term_options == 0) {
        // 0x804fca2
        v17 = *(int32_t *)(4 * v16 + v4);
    } else {
        // 0x804fc92
        term_options = 0;
        v17 = 69;
    }
    int32_t v18 = v17; // 0x804fcb0
    if (code == 2) {
        // 0x804fcb2
        v18 = v17;
        if (mouse_link == -1) {
            // 0x804fcbc
            g393 = v17 - 12;
            int32_t v19 = v17; // 0x804fcde
            v18 = v17;
            switch (v17) {
                case 14: {
                    // 0x804fce0
                    v19 = 13;
                }
                case 12: {
                }
                case 15: {
                }
                case 16: {
                }
                case 17: {
                }
                case 18: {
                }
                case 19: {
                }
                case 20: {
                }
                case 22: {
                }
                case 23: {
                }
                case 36: {
                }
                case 37: {
                }
                case 42: {
                }
                case 43: {
                }
                case 48: {
                }
                case 49: {
                }
                case 50: {
                }
                case 51: {
                }
                case 56: {
                }
                case 57: {
                }
                case 60: {
                }
                case 79: {
                    // 0x804fce7
                    mouse_link = -3;
                    v18 = v19;
                    // break -> 0x804fcf1
                    break;
                }
            }
        }
    }
    int32_t result = v18;
    if (result != 69 == (result != 21)) {
        // 0x804fd1f
        return result;
    }
    // 0x804fd07
    mouse_link = -1;
    if (code == 2 == result == 69) {
        // 0x804fd13
        repaint_main_statusline(2);
    }
    // 0x804fd1f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x804fd24 - 0x80509c7
// Line range:    1715 - 2521
int32_t LYgetch_for(int32_t code) {
    // 0x804fd24
    have_levent = 0;
    char v1 = 0; // 0x804fd3d
    int32_t v2 = 0; // 0x804fd3d
    int32_t v3 = -1; // 0x804fd3d
    int32_t v4; // 0x804fd24
    int32_t v5; // 0x804fd24
    int32_t v6; // 0x804fd24
    int32_t v7; // 0x804fd24
    char v8; // 0x804fd24
    int32_t v9; // 0x804fd73
    while (true) {
      lab_0x804fd47_2:
        // 0x804fd47
        v5 = v3;
        v6 = v2;
        char v10 = v1;
        if (*__errno_location() == 4) {
            // 0x804fd53
            *__errno_location() = 0;
        }
        // 0x804fd5e
        clearerr(g163);
        v9 = function_804aff4((int32_t)LYtopwindow());
        lynx_nl2crlf(0);
        if (WWW_TraceFlag != 0) {
            // 0x804fd92
            fprintf(TraceFP(), "GETCH: Got %#x.\n", v9);
        }
        if (v9 == -1) {
            // 0x804fdba
            if (*__errno_location() == 4) {
                // 0x804fdca
                if (WWW_TraceFlag == 0) {
                    goto lab_0x804fdfa;
                } else {
                    // 0x804fdd5
                    fprintf(TraceFP(), "Got EOF with EINTR, recent_sizechange so far is %d\n", (int32_t)recent_sizechange);
                    goto lab_0x804fdfa;
                }
            }
        }
        // 0x804fe58
        if (feof(g163) != 0) {
            // break -> 0x804fe80
            break;
        }
        // 0x804fe69
        if (v9 != -1 != (ferror(g163) == 0)) {
            // break -> 0x804fe80
            break;
        }
        // 0x804fea8
        v4 = v9;
        v8 = v10;
        v7 = v6;
        v3 = v5;
        if (escape_bound != 0) {
            goto lab_0x805031f;
        } else {
            if (v9 == 27) {
                goto lab_0x804fed7;
            } else {
                // 0x804febb
                v4 = v9;
                v8 = v10;
                v7 = v6;
                v3 = v5;
                if (v9 != 155 || csi_is_csi == 0) {
                    goto lab_0x805031f;
                } else {
                    goto lab_0x804fed7;
                }
            }
        }
    }
    // 0x804fe80
    if (recent_sizechange == 0) {
        // 0x804fe97
        cleanup();
        exit_immediately(0);
        // UNREACHABLE
    }
    // 0x80509be
    return 7;
  lab_0x8050987:;
    // 0x8050987
    int32_t v11; // 0x804fd24
    int32_t result = v11; // 0x8050991
    int32_t v12; // 0x804fd24
    int32_t v13; // 0x804fd24
    if (v12 == 0) {
        // 0x805099b
        v13 = v11;
        return v13 < 660 ? v13 | v2 : 0;
    }
  lab_0x80509be:
    // 0x80509be
    return result;
  lab_0x805092b:;
    // 0x805092b
    int32_t v14; // 0x804fd24
    int32_t v15 = v14;
    int32_t v16; // 0x804fd24
    int32_t v17; // 0x804fd24
    int32_t v18; // bp-64, 0x804fd24
    if (code != 2) {
        goto lab_0x8050966;
    } else {
        // 0x8050931
        if (mouse_link != -1) {
            goto lab_0x8050966;
        } else {
            // switch.early.test
            switch (v17) {
                case 40: {
                    goto lab_0x8050966;
                }
                case 21: {
                    goto lab_0x8050966;
                }
                default: {
                    // 0x8050966
                    function_804a7a4(&v18, (int32_t)&g391);
                    function_804aff4((int32_t)LYwin);
                    v16 = 285;
                    goto lab_0x805099b_3;
                }
            }
        }
    }
  lab_0x805031f:;
    int32_t v19 = v7;
    char v20 = v8;
    int32_t v21 = v4;
    int32_t v22; // 0x804fd24
    int32_t v23; // 0x804fd24
    int32_t v24; // 0x804fd24
    char v25; // 0x804fd24
    char v26; // 0x804fd24
    if (v21 < 0 || (int16_t)v21 > -1) {
        bool v27 = v21 < 0 | (v21 & 1024) == 0;
        int32_t v28 = v27 ? v21 : v21 & -1025;
        char v29 = v27 ? v20 : 1;
        v25 = v29;
        v22 = v28;
        v26 = v29;
        v23 = v28;
        v24 = v19;
        if (v28 < 0) {
            goto lab_0x80503be;
        } else {
            goto lab_0x8050398;
        }
    } else {
        // 0x8050331
        v25 = v20;
        v22 = v21;
        if ((code || 1) != 3) {
            // 0x805033d
            v25 = v20;
            v22 = v21 % 256 | 2048;
        }
        goto lab_0x8050398;
    }
  lab_0x804fed7:;
    int32_t v30 = function_804aff4((int32_t)LYtopwindow()); // 0x804fee3
    int32_t v31 = v30; // 0x804feef
    if (v30 != 91 != v30 != 79) {
        // 0x804fef7
        v31 = function_804aff4((int32_t)LYtopwindow());
    }
    uint32_t v32 = v31;
    g361 = v32 - 49;
    int32_t v33 = 256; // 0x804ff2c
    bool v34 = true; // 0x804ff2c
    int32_t v35 = v6; // 0x804ff2c
    int32_t v36 = v5; // 0x804ff2c
    int32_t v37; // 0x804fd24
    int32_t v38; // 0x804fd24
    int32_t v39; // 0x804fd24
    int32_t v40; // 0x804fd24
    int32_t v41; // 0x804fd24
    switch (v32) {
        case 49: {
            // 0x8050021
            v37 = v5;
            if (v9 != 155 == (v30 != 91)) {
                goto lab_0x8050052;
            } else {
                int32_t v42 = function_804aff4((int32_t)LYtopwindow()); // 0x8050038
                v37 = v42;
                v33 = 266;
                v34 = true;
                v35 = v6;
                v36 = v42;
                if (v42 != 126) {
                    goto lab_0x8050052;
                } else {
                    goto lab_0x8050293;
                }
            }
        }
        case 50: {
            // 0x805005b
            v33 = v9;
            v34 = false;
            v35 = v6;
            v36 = v5;
            if (v9 != 155 != v30 != 91) {
                int32_t v43 = function_804aff4((int32_t)LYtopwindow()); // 0x8050072
                v33 = 268;
                v34 = true;
                v35 = v6;
                v36 = v43;
                if (v43 != 126) {
                    // 0x805008c
                    v33 = v9;
                    v34 = true;
                    v35 = v6;
                    v36 = v43;
                    if (v43 != 56 != v43 != 57) {
                        int32_t * v44 = LYtopwindow(); // 0x805009c
                        v33 = v9;
                        v34 = true;
                        v35 = v6;
                        v36 = v43;
                        if (function_804aff4((int32_t)v44) == 126) {
                            // 0x80500b2
                            v33 = v43 != 56 ? v43 != 57 ? v9 : 265 : 264;
                            v34 = true;
                            v35 = v6;
                            v36 = -1;
                        }
                    }
                }
            }
            goto lab_0x8050293;
        }
        case 51: {
            // 0x80500e3
            v38 = v5;
            if (v9 != 155 == (v30 != 91)) {
                goto lab_0x8050114;
            } else {
                int32_t v45 = function_804aff4((int32_t)LYtopwindow()); // 0x80500fa
                v38 = v45;
                v33 = 269;
                v34 = true;
                v35 = v6;
                v36 = v45;
                if (v45 != 126) {
                    goto lab_0x8050114;
                } else {
                    goto lab_0x8050293;
                }
            }
        }
        case 52: {
            // 0x805011d
            v39 = v5;
            if (v9 != 155 == (v30 != 91)) {
                goto lab_0x805014e;
            } else {
                int32_t v46 = function_804aff4((int32_t)LYtopwindow()); // 0x8050134
                v39 = v46;
                v33 = 267;
                v34 = true;
                v35 = v6;
                v36 = v46;
                if (v46 != 126) {
                    goto lab_0x805014e;
                } else {
                    goto lab_0x8050293;
                }
            }
        }
        case 53: {
            // 0x8050157
            v40 = v5;
            if (v9 != 155 == (v30 != 91)) {
                goto lab_0x8050188;
            } else {
                int32_t v47 = function_804aff4((int32_t)LYtopwindow()); // 0x805016e
                v40 = v47;
                v33 = 261;
                v34 = true;
                v35 = v6;
                v36 = v47;
                if (v47 != 126) {
                    goto lab_0x8050188;
                } else {
                    goto lab_0x8050293;
                }
            }
        }
        case 54: {
            // 0x8050191
            v41 = v5;
            if (v9 != 155 == (v30 != 91)) {
                goto lab_0x80501c2;
            } else {
                int32_t v48 = function_804aff4((int32_t)LYtopwindow()); // 0x80501a8
                v41 = v48;
                v33 = 260;
                v34 = true;
                v35 = v6;
                v36 = v48;
                if (v48 != 126) {
                    goto lab_0x80501c2;
                } else {
                    goto lab_0x8050293;
                }
            }
        }
        case 65: {
            goto lab_0x8050293;
        }
        case 66: {
            // 0x804ff3a
            v33 = 257;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 67: {
            // 0x804ff46
            v33 = 258;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 68: {
            // 0x804ff52
            v33 = 259;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 77: {
            // 0x804ffbe
            v33 = 10;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 80: {
            // 0x804fffd
            v33 = 264;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 91: {
            if (v9 != 155 == (v30 != 91)) {
                goto lab_0x8050200;
            } else {
                int32_t v49 = function_804aff4((int32_t)LYtopwindow()); // 0x80501e2
                v33 = v49 != 65 ? v9 : 264;
                v34 = true;
                v35 = v6;
                v36 = v49;
                goto lab_0x8050293;
            }
        }
        case 107: {
            // 0x804ffd6
            v33 = v30 != 79 ? v9 : 43;
            v34 = v30 == 79;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 108: {
            // 0x804fff1
            v33 = 43;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 109: {
            // 0x804ffca
            v33 = 45;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 112: {
            // 0x8050015
            v33 = 48;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 113: {
            // 0x804ff5e
            v33 = 263;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 114: {
            // 0x804ff6a
            v33 = 257;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 115: {
            // 0x804ff76
            v33 = 260;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 116: {
            // 0x804ff82
            v33 = 259;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 117: {
            // 0x8050009
            v33 = 264;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 118: {
            // 0x804ff8e
            v33 = 258;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 119: {
            // 0x804ff9a
            v33 = 262;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        case 120: {
            goto lab_0x8050293;
        }
        case 121: {
            // 0x804ffb2
            v33 = 261;
            v34 = true;
            v35 = v6;
            v36 = v5;
            goto lab_0x8050293;
        }
        default: {
            goto lab_0x8050200;
        }
    }
  lab_0x80503be:
    // 0x80503be
    v2 = v24;
    int32_t v50 = v23 & 0x8800;
    v1 = v23 < 0 | v50 == 0 ? v26 : 1;
    v12 = v50;
    v11 = v23;
    if (v1 != 0) {
        goto lab_0x8050987;
    }
    // 0x80503de
    g362 = v23 - 258;
    v12 = v50;
    v11 = v23;
    int32_t v51 = 257; // 0x8050400
    v16 = 259;
    int32_t v52; // 0x804fd24
    int32_t v53; // 0x8050793
    switch (v23) {
        case 258: {
            goto lab_0x805099b;
        }
        case 259: {
            // 0x805099b
            v13 = 256;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 260: {
            goto lab_0x805099b_3;
        }
        case 261: {
            // 0x805099b
            v13 = 258;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 262: {
            // 0x805099b
            v13 = 262;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 263: {
            // 0x805099b
            v13 = 127;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 265: {
            // 0x805099b
            v13 = 264;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 280: {
            // 0x805099b
            v13 = 265;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 330: {
            // 0x805099b
            v13 = 269;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 331: {
            // 0x805099b
            v13 = 268;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 333: {
            // 0x805099b
            v13 = 18;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 338: {
            // 0x805099b
            v13 = 260;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 339: {
            // 0x805099b
            v13 = 261;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 343: {
            // 0x805099b
            v13 = 10;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 347: {
            // 0x805099b
            v13 = 263;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 348: {
            // 0x805099b
            v13 = 262;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 349: {
            // 0x805099b
            v13 = 261;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 350: {
            // 0x805099b
            v13 = 270;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 351: {
            // 0x805099b
            v13 = 263;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 352: {
            // 0x805099b
            v13 = 260;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 353: {
            // 0x805099b
            v13 = 271;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 360: {
            // 0x805099b
            v13 = 263;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 362: {
            // 0x805099b
            v13 = 266;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 363: {
            // 0x805099b
            v13 = 264;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 371: {
            // 0x805099b
            v13 = 265;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 385: {
            // 0x805050a
            v16 = 267;
          lab_0x805099b_3:
            // 0x805099b
            v13 = v16;
            return v13 < 660 ? v13 | v2 : 0;
        }
        case 409: {
            // 0x80505c9
            if (WWW_TraceFlag != 0) {
                // 0x80505d4
                fprintf(TraceFP(), "KEY_MOUSE\n");
            }
            // 0x80505eb
            if (code == 1) {
                // 0x805099b
                v13 = 285;
                return v13 < 660 ? v13 | v2 : 0;
            }
            if (code == 4) {
                // 0x8050603
                function_804acb4(&v18);
                v16 = 270;
                goto lab_0x805099b_3;
            }
            // 0x805061a
            mouse_link = -1;
            if (function_804acb4(&v18) != 0) {
                // 0x8050646
                if (WWW_TraceFlag == 0) {
                    // 0x8050668
                    result = code != 0 ? 270 : 0;
                    return result;
                } else {
                    // 0x8050651
                    fprintf(TraceFP(), "Mouse error: no event available!\n");
                    // 0x8050668
                    result = code != 0 ? 270 : 0;
                    return result;
                }
            }
            // 0x8050689
            levent = v18;
            if ((v52 & 4) != 0) {
                // 0x80506bb
                v17 = 0;
                v14 = set_clicked_link(v52, v52, code, 1);
                goto lab_0x805092b;
            }
            if ((v52 & 8) != 0) {
                int32_t v54 = set_clicked_link(v52, v52, code, 2); // 0x805070a
                v17 = code == 2 == v54 == 2088 ? 40 : 0;
                v14 = v54;
                goto lab_0x805092b;
            }
            // 0x8050735
            v17 = 0;
            v14 = 2085;
            if ((v52 & 0x4000) != 0) {
                goto lab_0x805092b;
            }
            if (code != 3 && (v52 & 0x30c3) == 0) {
                // 0x8050767
                v17 = 0;
                v14 = -1;
                if ((v52 & 256) == 0) {
                    goto lab_0x805092b;
                } else {
                    // 0x8050777
                    v53 = set_clicked_link(v52, v52, code, 1);
                    if (v53 == 2087) {
                        goto lab_0x80507bb;
                    } else {
                        // 0x80507b1
                        mouse_link = -1;
                        goto lab_0x80507bb;
                    }
                }
            }
            goto lab_0x804fd47_2;
        }
        case 410: {
            // 0x805053a
            if (WWW_TraceFlag != 0) {
                char v55 = recent_sizechange; // 0x8050545
                fprintf(TraceFP(), "Got KEY_RESIZE, recent_sizechange so far is %d\n", (int32_t)v55);
            }
            // 0x805056a
            size_change(0);
            if (WWW_TraceFlag != 0) {
                // 0x8050581
                fprintf(TraceFP(), "Now recent_sizechange is %d\n", (int32_t)recent_sizechange);
            }
            // 0x80505a6
            v51 = 270;
            if (recent_sizechange != 0) {
              lab_0x805099b:
                // 0x805099b
                v13 = v51;
                return v13 < 660 ? v13 | v2 : 0;
            }
            // 0x80505b1
            recent_sizechange = 1;
            goto lab_0x804fd47_2;
        }
        default: {
            goto lab_0x8050987;
        }
    }
  lab_0x8050398:;
    uint32_t v56 = v22;
    bool v57 = (v56 & 0x2000) == 0 | (int16_t)v56 <= -1;
    v26 = v25;
    v23 = v57 ? v56 : v56 % 2048;
    v24 = v57 ? v19 : 0x2000;
    goto lab_0x80503be;
  lab_0x8050293:;
    int32_t v58 = v36;
    int32_t v59 = v35;
    int32_t v60 = v33;
    int16_t * v61 = *__ctype_b_loc(); // 0x8050298
    int32_t v62 = v58; // 0x80502af
    if ((*(int16_t *)(2 * v32 + (int32_t)v61) & 2048) == 0) {
        goto lab_0x80502dc;
    } else {
        // 0x80502b1
        if (v30 != 91 == (v60 != 155)) {
            goto lab_0x80502dc;
        } else {
            // 0x80502c0
            v62 = v58;
            switch (v58) {
                case -1: {
                    goto lab_0x80502dc;
                }
                case 126: {
                    goto lab_0x80502dc;
                }
                default: {
                    // 0x80502cc
                    v62 = function_804aff4((int32_t)LYtopwindow());
                    goto lab_0x80502dc;
                }
            }
        }
    }
  lab_0x8050200:
    if (v9 != 27) {
        goto lab_0x8050239;
    } else {
        if (v9 == 155 || v30 == 91 || v32 != v30) {
            goto lab_0x8050239;
        } else {
            // 0x805021d
            v33 = v32;
            v34 = v32 < 256;
            v35 = 0x2000;
            v36 = v5;
            goto lab_0x8050293;
        }
    }
  lab_0x8050239:
    // 0x8050239
    v33 = v9;
    v34 = true;
    v35 = v6;
    v36 = v5;
    if (WWW_TraceFlag != 0) {
        // 0x8050272
        fprintf(TraceFP(), "Unknown key sequence: %d:%d:%d\n", v9, v30, v32);
        v33 = v9;
        v34 = true;
        v35 = v6;
        v36 = v5;
        if (WWW_TraceFlag != 0) {
            // 0x805027d
            v33 = v9;
            v34 = true;
            v35 = v6;
            v36 = v5;
            if (LYTraceLogFP == NULL) {
                // 0x8050286
                sleep(MessageSecs);
                v33 = v9;
                v34 = true;
                v35 = v6;
                v36 = v5;
            }
        }
    }
    goto lab_0x8050293;
  lab_0x8050052:
    // 0x8050052
    v33 = v9;
    v34 = false;
    v35 = v6;
    v36 = v37;
    goto lab_0x8050293;
  lab_0x8050114:
    // 0x8050114
    v33 = v9;
    v34 = false;
    v35 = v6;
    v36 = v38;
    goto lab_0x8050293;
  lab_0x805014e:
    // 0x805014e
    v33 = v9;
    v34 = false;
    v35 = v6;
    v36 = v39;
    goto lab_0x8050293;
  lab_0x8050188:
    // 0x8050188
    v33 = v9;
    v34 = false;
    v35 = v6;
    v36 = v40;
    goto lab_0x8050293;
  lab_0x80501c2:
    // 0x80501c2
    v33 = v9;
    v34 = false;
    v35 = v6;
    v36 = v41;
    goto lab_0x8050293;
  lab_0x80502dc:;
    int32_t v63 = v62;
    v4 = v60;
    v8 = v34;
    v7 = v59;
    v3 = v63;
    if (v32 < 256 == !v34) {
        bool v64 = v30 == 91 | v32 != v30 | v60 == 155 | v60 != 27;
        v4 = v64 ? v60 : v32;
        v8 = 1;
        v7 = v64 ? v59 : 0x2000;
        v3 = v63;
    }
    goto lab_0x805031f;
    // 0x804fd47
    goto lab_0x804fd47_2;
  lab_0x804fdfa:
    // 0x804fdfa
    if (recent_sizechange != 0) {
        goto lab_0x804fe41;
    } else {
        // 0x804fe05
        size_change(0);
        if (WWW_TraceFlag == 0) {
            goto lab_0x804fe41;
        } else {
            // 0x804fe1c
            fprintf(TraceFP(), "Now recent_sizechange is %d\n", (int32_t)recent_sizechange);
            goto lab_0x804fe41;
        }
    }
  lab_0x804fe41:
    // 0x804fe41
    *__errno_location() = 0;
    result = 270;
    goto lab_0x80509be;
  lab_0x8050966:
    // 0x8050966
    result = v15;
    if (v15 < 660 || (v15 & 2048) == 0) {
        // 0x8050966
        v12 = v15 & 0x8800;
        v11 = v15;
        goto lab_0x8050987;
    } else {
        goto lab_0x80509be;
    }
  lab_0x80507bb:;
    int32_t v65 = LYmouse_menu(v52, v52, (int32_t)(v53 == 2087), code); // 0x80507d6
    int32_t v66; // 0x804fd24
    int32_t v67; // 0x804fd24
    if (v65 != 40) {
        goto lab_0x80508d0;
    } else {
        // 0x80507e8
        v66 = 39;
        if (mouse_link != -1) {
            // 0x80507fe
            if (mouse_link < 0 || textfields_need_activation == 0) {
                goto lab_0x80508d0;
            } else {
                int32_t v68 = 68 * mouse_link; // 0x8050827
                if (*(int32_t *)(v68 + (int32_t)&g347) != 1) {
                    goto lab_0x80508d0;
                } else {
                    int32_t v69 = *(int32_t *)(v68 + (int32_t)&g354); // 0x8050847
                    int32_t v70 = *(int32_t *)(v69 + 8); // 0x805084d
                    v67 = 39;
                    switch (v70) {
                        case 1: {
                            goto lab_0x80508fb;
                        }
                        case 12: {
                            goto lab_0x80508fb;
                        }
                        case 2: {
                            goto lab_0x80508fb;
                        }
                        case 11: {
                            goto lab_0x80508fb;
                        }
                        default: {
                            // 0x80508ac
                            v67 = 39;
                            if (v70 != 9) {
                                goto lab_0x80508d0;
                            } else {
                                goto lab_0x80508fb;
                            }
                        }
                    }
                }
            }
        } else {
            goto lab_0x80508d6;
        }
    }
  lab_0x80508d0:
    // 0x80508d0
    v67 = v65;
    if (v65 != 39) {
        goto lab_0x80508fb;
    } else {
        // 0x80508d0
        v66 = v65;
        goto lab_0x80508d6;
    }
  lab_0x80508fb:
    // 0x80508fb
    if (LYReverseKeymap(v67) < 0) {
        // 0x805091a
        v17 = v67;
        v14 = v67 | 2048;
        goto lab_0x805092b;
    } else {
        int32_t v71 = LYReverseKeymap(v67); // 0x8050910
        v17 = v67;
        v14 = v71;
        goto lab_0x805092b;
    }
  lab_0x80508d6:
    // 0x80508d6
    v67 = v66;
    if (mouse_link != -1) {
        goto lab_0x80508fb;
    } else {
        // 0x80508e0
        HTAlert(gettext("No link chosen"));
        v67 = 21;
        goto lab_0x80508fb;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80509c7 - 0x80509db
// Line range:    2527 - 2529
int32_t LYgetch(void) {
    // 0x80509c7
    return LYReadCmdKey(0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80509db - 0x8050a02
// Line range:    2535 - 2541
int32_t LYgetch_choice(void) {
    int32_t v1 = LYReadCmdKey(1); // 0x80509e8
    return v1 != 3 ? v1 : 7;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050a02 - 0x8050a29
// Line range:    2547 - 2553
int32_t LYgetch_input(void) {
    int32_t v1 = LYReadCmdKey(2); // 0x8050a0f
    return v1 != 3 ? v1 : 7;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050a29 - 0x8050aa4
// Line range:    2560 - 2568
int32_t LYgetch_single(void) {
    int32_t result = LYReadCmdKey(4); // 0x8050a36
    if (result == 3) {
        // 0x8050a9f
        return 7;
    }
    // 0x8050a4d
    if (result > 255) {
        // 0x8050a9f
        return result;
    }
    int16_t * v1 = *__ctype_b_loc(); // 0x8050a61
    int32_t c = result % 256;
    int32_t result2 = c; // 0x8050a7b
    if ((*(int16_t *)((2 * result & 510) + (int32_t)v1) & 512) != 0) {
        // 0x8050a7d
        result2 = toupper(c);
    }
    // 0x8050a9f
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050aa4 - 0x8050b78
// Line range:    2574 - 2594
void LYLowerCase(char * arg_buffer) {
    int32_t v1 = (int32_t)arg_buffer; // 0x8050b65
    char v2 = *arg_buffer; // 0x8050b6b
    char v3 = v2; // 0x8050b70
    char * v4 = arg_buffer; // 0x8050b70
    if (v2 == 0) {
        // 0x8050b76
        return;
    }
    int32_t v5 = 0; // 0x8050b70
    char * v6; // 0x8050aa4
    int32_t v7; // 0x8050aa4
    int32_t v8; // 0x8050aa4
    while (true) {
      lab_0x8050abc:
        // 0x8050abc
        v8 = v5;
        v6 = v4;
        char v9 = v3;
        if (v9 >= 0) {
            goto lab_0x8050b76;
        } else {
            int32_t v10 = v8 + 1; // 0x8050acc
            if (*(char *)(v10 + v1) == 0) {
                goto lab_0x8050b76;
            } else {
                // 0x8050ad9
                v7 = v9 < 224 == kanji_code == 2 ? v8 : v10;
                goto lab_0x8050b61;
            }
        }
    }
  lab_0x8050b76:;
    int16_t * v11 = *__ctype_b_loc(); // 0x8050b11
    unsigned char v12 = *v6; // 0x8050b19
    int32_t c = v12; // 0x8050b19
    char v13 = v12; // 0x8050b31
    if ((*(int16_t *)(2 * c + (int32_t)v11) & 256) != 0) {
        // 0x8050b33
        v13 = tolower(c);
    }
    // 0x8050b58
    *v6 = v13;
    v7 = v8;
    goto lab_0x8050b61;
  lab_0x8050b61:
    // 0x8050b61
    v5 = v7 + 1;
    v4 = (char *)(v5 + v1);
    v3 = *v4;
    if (v3 == 0) {
        // break -> 0x8050b76
        goto lab_0x8050b76;
    }
    goto lab_0x8050abc;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050b78 - 0x8050c4c
// Line range:    2600 - 2620
void LYUpperCase(char * arg_buffer) {
    int32_t v1 = (int32_t)arg_buffer; // 0x8050c39
    char v2 = *arg_buffer; // 0x8050c3f
    char v3 = v2; // 0x8050c44
    char * v4 = arg_buffer; // 0x8050c44
    if (v2 == 0) {
        // 0x8050c4a
        return;
    }
    int32_t v5 = 0; // 0x8050c44
    char * v6; // 0x8050b78
    int32_t v7; // 0x8050b78
    int32_t v8; // 0x8050b78
    while (true) {
      lab_0x8050b90:
        // 0x8050b90
        v8 = v5;
        v6 = v4;
        char v9 = v3;
        if (v9 >= 0) {
            goto lab_0x8050c4a;
        } else {
            int32_t v10 = v8 + 1; // 0x8050ba0
            if (*(char *)(v10 + v1) == 0) {
                goto lab_0x8050c4a;
            } else {
                // 0x8050bad
                v7 = v9 < 224 == kanji_code == 2 ? v8 : v10;
                goto lab_0x8050c35;
            }
        }
    }
  lab_0x8050c4a:;
    int16_t * v11 = *__ctype_b_loc(); // 0x8050be5
    unsigned char v12 = *v6; // 0x8050bed
    int32_t c = v12; // 0x8050bed
    char v13 = v12; // 0x8050c05
    if ((*(int16_t *)(2 * c + (int32_t)v11) & 512) != 0) {
        // 0x8050c07
        v13 = toupper(c);
    }
    // 0x8050c2c
    *v6 = v13;
    v7 = v8;
    goto lab_0x8050c35;
  lab_0x8050c35:
    // 0x8050c35
    v5 = v7 + 1;
    v4 = (char *)(v5 + v1);
    v3 = *v4;
    if (v3 == 0) {
        // break -> 0x8050c4a
        goto lab_0x8050c4a;
    }
    goto lab_0x8050b90;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050cdb - 0x8050d1f
// Line range:    2651 - 2658
char * LYReduceBlanks(char * buffer) {
    if (buffer == NULL) {
        // 0x8050d1a
        return buffer;
    }
    // 0x8050ce7
    if (*buffer != 0) {
        // 0x8050cf1
        LYTrimLeading(buffer);
        LYTrimTrailing(buffer);
        convert_to_spaces(buffer, 1);
    }
    // 0x8050d1a
    return buffer;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050d1f - 0x8050dd6
// Line range:    2665 - 2683
char * LYRemoveBlanks(char * buffer) {
    // 0x8050d1f
    if (buffer == NULL) {
        // 0x8050dd1
        return NULL;
    }
    int32_t v1 = (int32_t)buffer;
    char * v2; // bp-24, 0x8050d1f
    *(int32_t *)&v2 = v1;
    if (*buffer == 0) {
        // 0x8050dd1
        return (char *)v1;
    }
    int16_t * v3 = *__ctype_b_loc(); // 0x8050d4a
    unsigned char v4 = *buffer; // 0x8050d4f
    int32_t v5 = v1; // 0x8050d67
    char * v6 = buffer; // 0x8050d67
    char v7 = v4; // 0x8050d67
    if ((*(int16_t *)(2 * (int32_t)v4 + (int32_t)v3) & 0x2000) == 0) {
        int32_t v8 = (int32_t)buffer + 1; // 0x8050d37
        char * v9 = (char *)v8; // 0x8050d37
        v2 = v9;
        while (*v9 != 0) {
            int16_t * v10 = *__ctype_b_loc(); // 0x8050d4a
            unsigned char v11 = *v9; // 0x8050d4f
            v5 = v8;
            v6 = v9;
            v7 = v11;
            if ((*(int16_t *)(2 * (int32_t)v11 + (int32_t)v10) & 0x2000) != 0) {
                goto lab_0x8050d69;
            }
            v8 = (int32_t)v9 + 1;
            v9 = (char *)v8;
            v2 = v9;
        }
        // 0x8050dd1
        return (char *)v8;
    }
  lab_0x8050d69:
    // 0x8050d69
    if (v7 == 0) {
        // 0x8050dd1
        return (char *)v5;
    }
    // 0x8050d73
    char * v12; // bp-8, 0x8050d1f
    *(int32_t *)&v12 = v5;
    char * v13 = (char *)v5;
    char * v14 = v6; // 0x8050dba
    if (*v13 != 0) {
        int16_t * v15 = *__ctype_b_loc(); // 0x8050d80
        unsigned char v16 = *v13; // 0x8050d85
        char * v17 = v13; // 0x8050d9d
        char * v18 = v6; // 0x8050d9d
        if ((*(int16_t *)(2 * (int32_t)v16 + (int32_t)v15) & 0x2000) == 0) {
            // 0x8050d9f
            *v6 = v16;
            v18 = (char *)((int32_t)v6 + 1);
            v2 = v18;
            v17 = v12;
        }
        char * v19 = (char *)((int32_t)v17 + 1); // 0x8050dae
        v12 = v19;
        char * v20 = v19; // 0x8050dba
        v14 = v18;
        while (*v19 != 0) {
            char * v21 = v18;
            v15 = *__ctype_b_loc();
            v16 = *v20;
            v17 = v20;
            v18 = v21;
            if ((*(int16_t *)(2 * (int32_t)v16 + (int32_t)v15) & 0x2000) == 0) {
                // 0x8050d9f
                *v21 = v16;
                v18 = (char *)((int32_t)v21 + 1);
                v2 = v18;
                v17 = v12;
            }
            // 0x8050dae
            v19 = (char *)((int32_t)v17 + 1);
            v12 = v19;
            v20 = v19;
            v14 = v18;
        }
    }
    // 0x8050dbc
    *v14 = 0;
    // 0x8050dd1
    return (char *)(int32_t)v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050dd6 - 0x8050e0b
// Line range:    2689 - 2693
char * LYSkipBlanks(char * buffer) {
    int16_t v1 = *(int16_t *)(2 * (int32_t)*buffer + (int32_t)*__ctype_b_loc()); // 0x8050df7
    if ((v1 & 0x2000) == 0) {
        // 0x8050e06
        return buffer;
    }
    char * result = buffer; // 0x8050e04
    result = (char *)((int32_t)result + 1);
    int16_t v2 = *(int16_t *)(2 * (int32_t)*result + (int32_t)*__ctype_b_loc()); // 0x8050df7
    while ((v2 & 0x2000) != 0) {
        // 0x8050dde
        result = (char *)((int32_t)result + 1);
        v2 = *(int16_t *)(2 * (int32_t)*result + (int32_t)*__ctype_b_loc());
    }
    // 0x8050e06
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050e0b - 0x8050e4a
// Line range:    2699 - 2703
char * LYSkipNonBlanks(char * buffer) {
    // 0x8050e0b
    if (*buffer == 0) {
        // 0x8050e45
        return buffer;
    }
    char * result = buffer; // 0x8050e1f
    int16_t v1 = *(int16_t *)(2 * (int32_t)*result + (int32_t)*__ctype_b_loc()); // 0x8050e36
    while ((v1 & 0x2000) == 0) {
        // 0x8050e13
        result = (char *)((int32_t)result + 1);
        if (*result == 0) {
            // break -> 0x8050e45
            break;
        }
        v1 = *(int16_t *)(2 * (int32_t)*result + (int32_t)*__ctype_b_loc());
    }
    // 0x8050e45
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050e4a - 0x8050e7f
// Line range:    2709 - 2713
char * LYSkipCBlanks(char * buffer) {
    int16_t v1 = *(int16_t *)(2 * (int32_t)*buffer + (int32_t)*__ctype_b_loc()); // 0x8050e6b
    if ((v1 & 0x2000) == 0) {
        // 0x8050e7a
        return buffer;
    }
    char * result = buffer; // 0x8050e78
    result = (char *)((int32_t)result + 1);
    int16_t v2 = *(int16_t *)(2 * (int32_t)*result + (int32_t)*__ctype_b_loc()); // 0x8050e6b
    while ((v2 & 0x2000) != 0) {
        // 0x8050e52
        result = (char *)((int32_t)result + 1);
        v2 = *(int16_t *)(2 * (int32_t)*result + (int32_t)*__ctype_b_loc());
    }
    // 0x8050e7a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050ebe - 0x8050ef6
// Line range:    2729 - 2733
void LYTrimLeading(char * buffer) {
    char * v1 = LYSkipBlanks(buffer); // 0x8050eca
    char * v2 = buffer; // 0x8050ecf
    char * v3 = v1; // 0x8050ecf
    char v4 = *v3; // 0x8050ed5
    *v2 = v4;
    v2 = (char *)((int32_t)v2 + 1);
    v3 = (char *)((int32_t)v3 + 1);
    while (v4 != 0) {
        // 0x8050ed2
        v4 = *v3;
        *v2 = v4;
        v2 = (char *)((int32_t)v2 + 1);
        v3 = (char *)((int32_t)v3 + 1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050ef6 - 0x8050f47
// Line range:    2739 - 2745
char * LYTrimNewline(char * buffer) {
    int32_t len = strlen(buffer); // 0x8050f02
    if (len == 0) {
        // 0x8050f42
        return buffer;
    }
    int32_t v1 = len; // 0x8050f25
    char * v2; // 0x8050f2b
    while (true) {
      lab_0x8050f22:
        // 0x8050f22
        v1--;
        v2 = (char *)(v1 + (int32_t)buffer);
        switch (*v2) {
            case 10: {
                goto lab_0x8050f0c;
            }
            case 13: {
                goto lab_0x8050f0c;
            }
            default: {
                return buffer;
            }
        }
    }
    // 0x8050f42
    return buffer;
  lab_0x8050f0c:
    // 0x8050f0c
    *v2 = 0;
    if (v1 == 0) {
        return buffer;
    }
    goto lab_0x8050f22;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8050f47 - 0x8050f9f
// Line range:    2751 - 2756
void LYTrimTrailing(char * buffer) {
    int32_t len = strlen(buffer); // 0x8050f53
    if (len == 0) {
        // 0x8050f9d
        return;
    }
    int32_t v1 = len; // 0x8050f7d
    int16_t * v2 = *__ctype_b_loc(); // 0x8050f78
    v1--;
    char * v3 = (char *)(v1 + (int32_t)buffer); // 0x8050f83
    while ((*(int16_t *)(2 * (int32_t)*v3 + (int32_t)v2) & 0x2000) != 0) {
        // 0x8050f5d
        *v3 = 0;
        if (v1 == 0) {
            // break -> 0x8050f9d
            break;
        }
        v2 = *__ctype_b_loc();
        v1--;
        v3 = (char *)(v1 + (int32_t)buffer);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8051128 - 0x80511d5
// Line range:    2789 - 2804
char LYTrimStartfile(char * buffer) {
    // 0x8051128
    LYTrimHead(buffer);
    char v1 = *buffer; // 0x805113c
    char v2 = v1; // 0x8051141
    if (v1 != 108 != v1 != 76) {
        // 0x805114d
        if (strncasecomp(buffer, "lynxexec:", 9) == 0) {
            // 0x805119f
            HTUnEscapeSome(buffer, " \r\n\t");
            convert_to_spaces(buffer, 1);
            // 0x80511cf
            return 1;
        }
        // 0x805114d
        v2 = *buffer;
    }
    char v3 = v2; // 0x805116f
    if (v3 != 108 == (v3 != 76) || strncasecomp(buffer, "lynxprog:", 9) != 0) {
        // 0x80511cf
        return 0;
    }
    // 0x805119f
    HTUnEscapeSome(buffer, " \r\n\t");
    convert_to_spaces(buffer, 1);
    // 0x80511cf
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80511d5 - 0x8051228
// Line range:    2810 - 2817
void LYEscapeStartfile(char ** buffer) {
    // 0x80511d5
    if (LYTrimStartfile(*buffer) != 0) {
        // 0x8051226
        return;
    }
    char * v1 = HTEscapeUnsafe(*buffer); // 0x80511f4
    HTSACopy(buffer, v1);
    if (v1 != NULL) {
        // 0x8051214
        free((int32_t *)v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8051228 - 0x805124a
// Line range:    2823 - 2827
void LYTrimAllStartfile(char * buffer) {
    // 0x8051228
    if (LYTrimStartfile(buffer) == 0) {
        // 0x805123d
        LYRemoveBlanks(buffer);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x805124a - 0x805137e
// Line range:    2863 - 2898
void LYSetupEdit(int32_t * edit, char * old, int32_t maxstr, int32_t maxdsp) {
    int32_t v1 = (int32_t)edit;
    int32_t * v2 = LYwin; // 0x8051250
    *(int32_t *)(v1 + 4) = v2 == NULL ? -1 : 0x10000 * (int32_t)v2 >> 16;
    *edit = LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
    *(char *)(v1 + 20) = 32;
    *(char *)(v1 + 22) = 1;
    char * v3 = (char *)(v1 + 23); // 0x80512af
    *v3 = 0;
    *(int32_t *)(v1 + 36) = 0;
    *(int32_t *)(v1 + 16) = maxstr;
    int32_t * v4 = (int32_t *)(v1 + 8); // 0x80512cc
    *v4 = maxdsp;
    int32_t * v5 = (int32_t *)(v1 + 32); // 0x80512d2
    *v5 = 0;
    *(int32_t *)(v1 + 28) = strlen(old);
    *(int32_t *)(v1 + 40) = -1;
    *(int32_t *)(v1 + 24) = 0;
    if (maxstr > maxdsp) {
        uint32_t v6 = *v4; // 0x805130b
        int32_t v7 = v6; // 0x8051311
        if (v6 >= 5) {
            // 0x8051313
            *v3 = 1;
            v7 = *v4;
        }
        int32_t v8 = v7; // 0x805131d
        int32_t v9 = (v8 >> 31) / 0x40000000 + v8; // 0x8051328
        *v5 = v9 < 44 ? v9 >> 2 : 10;
    }
    char * str = (char *)(v1 + 44); // 0x805135e
    LYstrncpy(str, old, maxstr);
    *(int32_t *)(v1 + 12) = strlen(str);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x805137e - 0x805142b
// Line range:    2921 - 2937
int32_t mbcs_glyphs(char * s, int32_t len) {
    // 0x805137e
    if (*(int32_t *)(32 * current_char_set + (int32_t)&g144) == 7) {
        char v1 = *s; // 0x80513cd
        int32_t v2 = 0; // 0x80513d2
        if (len > 0 != v1 != 0) {
            // 0x8051426
            return 0;
        }
        int32_t result = 0; // 0x80513d2
        result += (int32_t)((v1 & -64) != -128);
        v2++;
        char v3 = *(char *)(v2 + (int32_t)s); // 0x80513cd
        while (v2 < len == (v3 != 0)) {
            // 0x80513a7
            result += (int32_t)((v3 & -64) != -128);
            v2++;
            v3 = *(char *)(v2 + (int32_t)s);
        }
        // 0x8051426
        return result;
    }
    // 0x80513de
    if (HTCJK == 0) {
        // 0x8051426
        return len;
    }
    char v4 = *s; // 0x805140f
    int32_t result2 = 0; // 0x8051414
    if (len > 0 != v4 != 0) {
        // 0x8051426
        return 0;
    }
    int32_t v5 = 0; // 0x8051414
    v5 = v5 + 1 + (int32_t)(v4 < 0);
    result2++;
    char v6 = *(char *)(v5 + (int32_t)s); // 0x805140f
    while (v6 != 0 == v5 < len) {
        // 0x80513f0
        v5 = v5 + 1 + (int32_t)(v6 < 0);
        result2++;
        v6 = *(char *)(v5 + (int32_t)s);
    }
    // 0x8051426
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x805142b - 0x80514de
// Line range:    2943 - 2962
int32_t mbcs_skip(char * s, int32_t pos) {
    // 0x805142b
    if (*(int32_t *)(32 * current_char_set + (int32_t)&g144) == 7) {
        char v1 = *s; // 0x8051482
        char v2 = v1; // 0x8051487
        int32_t result = 0; // 0x8051487
        if (v1 == 0) {
            // 0x80514d9
            return 0;
        }
        int32_t v3 = 0; // 0x8051487
        while (v3 + (int32_t)((v2 & -64) != -128) <= pos) {
            // 0x8051454
            v3 += (int32_t)((v2 & -64) != -128);
            // 0x8051478
            result++;
            v2 = *(char *)(result + (int32_t)s);
            if (v2 == 0) {
                // break -> 0x80514d9
                break;
            }
        }
        // 0x80514d9
        return result;
    }
    // 0x805148b
    if (HTCJK == 0) {
        // 0x80514d9
        return pos;
    }
    char v4 = *s; // 0x80514c2
    int32_t result2 = 0; // 0x80514c7
    if (pos > 0 != v4 != 0) {
        // 0x80514d9
        return 0;
    }
    int32_t v5 = 0; // 0x80514c7
    v5++;
    result2 = result2 + 1 + (int32_t)(v4 < 0);
    char v6 = *(char *)(result2 + (int32_t)s); // 0x80514c2
    while (v5 < pos == (v6 != 0)) {
        // 0x80514a3
        v5++;
        result2 = result2 + 1 + (int32_t)(v6 < 0);
        v6 = *(char *)(result2 + (int32_t)s);
    }
    // 0x80514d9
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80514de - 0x8051553
// Line range:    2969 - 2989
int32_t cell2char(char * s, uint32_t cells) {
    int32_t len = strlen(s); // 0x80514f1
    if (len < 0) {
        // 0x805152b
        return mbcs_glyphs(s, len);
    }
    int32_t v1 = 0; // 0x8051529
    uint32_t v2 = LYstrExtent2(s, v1); // 0x805150f
    int32_t v3 = v1; // 0x805151d
    while (v2 < cells) {
        // 0x805151f
        v1++;
        v3 = len;
        if (v1 > len) {
            // break -> 0x805152b
            break;
        }
        v2 = LYstrExtent2(s, v1);
        v3 = v1;
    }
    // 0x805152b
    return mbcs_glyphs(s, v3);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8051553 - 0x80516e9
// Line range:    3004 - 3108
int32_t LYEditInsert(int32_t * edit, char * s, int32_t len, int32_t map, char maxMessage) {
    int32_t v1 = (int32_t)edit;
    int32_t str = v1 + 44; // 0x8051563
    int32_t len2 = strlen((char *)str); // 0x8051569
    int32_t v2 = *(int32_t *)(v1 + 16); // 0x8051574
    int32_t n = len; // 0x805159a
    int32_t v3 = 0; // 0x805159a
    int32_t * v4; // 0x8051553
    int32_t result; // 0x8051553
    int32_t v5; // 0x8051553
    int32_t v6; // 0x8051553
    if (v2 - (len2 + len) >= 0) {
        goto lab_0x80515c1;
    } else {
        if (v2 > len2) {
            // 0x80515b5
            n = v2 - len2;
            v3 = 1;
            goto lab_0x80515c1;
        } else {
            // 0x805159c
            v4 = (int32_t *)(v1 + 28);
            v6 = 0;
            result = 0;
            v5 = 1;
            goto lab_0x805162a;
        }
    }
  lab_0x80515c1:;
    int32_t v7 = n + str;
    *(char *)(v7 + len2) = 0;
    int32_t * v8 = (int32_t *)(v1 + 28);
    uint32_t v9 = *v8; // 0x80515f6
    int32_t v10 = v9; // 0x80515fc
    if (v9 <= len2) {
        *(char *)(len2 + v7) = *(char *)(len2 + str);
        int32_t v11 = len2 - 1; // 0x80515ef
        int32_t v12 = *v8; // 0x80515f6
        int32_t v13 = v11; // 0x80515fc
        v10 = v12;
        while (v12 <= v11) {
            char v14 = *(char *)(v13 + str); // 0x80515e3
            *(char *)(v13 + v7) = v14;
            v11 = v13 - 1;
            v12 = *v8;
            v13 = v11;
            v10 = v12;
        }
    }
    // 0x80515fe
    strncpy((char *)(v10 + str), s, n);
    v4 = v8;
    v6 = n;
    result = 1;
    v5 = v3;
    goto lab_0x805162a;
  lab_0x805162a:;
    int32_t * v15 = v4;
    *v15 = *v15 + v6;
    int32_t * v16 = (int32_t *)(v1 + 12); // 0x805163e
    *v16 = *v16 + v6;
    if (result != 0) {
        // 0x8051652
        *(char *)(v1 + 22) = 1;
    }
    if ((char)map != 0 && v5 != 0) {
        // 0x8051665
        mustshow = 1;
        statusline(gettext("Maximum length reached!  Delete text or move off field."));
    }
    int32_t * v17 = (int32_t *)(v1 + 40); // 0x8051683
    int32_t v18 = *v17; // 0x8051683
    int32_t v19 = *v15; // 0x8051689
    int32_t v20; // 0x8051553
    if (v18 > v19) {
        int32_t v21 = v18 + v6; // 0x8051698
        *v17 = v21;
        v20 = v21;
    } else {
        // 0x80516a3
        v20 = v18;
        if (v18 < -1 - v19) {
            int32_t v22 = v18 - v6; // 0x80516bd
            *v17 = v22;
            v20 = v22;
        }
    }
    // 0x80516c6
    if (v20 >= 0) {
        // 0x80516d0
        *v17 = -1 - v20;
    }
    // 0x80516e0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80516e9 - 0x80522a6
// Line range:    3117 - 3508
int32_t LYEdit1(int32_t * edit, int32_t ch, int32_t action, char maxMessage) {
    int32_t v1 = (int32_t)edit;
    int32_t * v2 = (int32_t *)(v1 + 16); // 0x80516f9
    int32_t v3 = *v2; // 0x80516f9
    if (v3 >= 0 != v3 != 0) {
        // 0x805229d
        return 0;
    }
    int32_t v4 = v1 + 44; // 0x805170f
    char * str = (char *)v4;
    int32_t len = strlen(str); // 0x8051715
    int32_t * v5 = (int32_t *)(v1 + 12); // 0x8051723
    *v5 = len;
    g396 = action;
    int32_t result = ch; // 0x805173c
    int32_t * v6; // 0x80516e9
    int32_t v7; // 0x80516e9
    int32_t v8; // 0x80516e9
    int32_t v9; // 0x80516e9
    int32_t v10; // 0x80516e9
    int32_t v11; // 0x80516e9
    int32_t * v12; // 0x8051e78
    int32_t * v13; // 0x8051ea7
    switch (action) {
        case 1: {
            int32_t v14 = 0x1000000 * ch >> 24; // bp-9, 0x8051741
            LYEditInsert(edit, (char *)&v14, 1, 0, maxMessage);
            // 0x805229d
            return 0;
        }
        case 7: {
            int32_t * v15 = (int32_t *)(v1 + 28); // 0x8051c78
            int32_t v16 = *v15; // 0x8051c78
            if (v16 < len) {
                // 0x8051c84
                *v15 = mbcs_skip((char *)(v16 + v4), 1) + v16;
                goto lab_0x8051cb2;
            } else {
                goto lab_0x8052279;
            }
        }
        case 9: {
            goto lab_0x8051cb2;
        }
        case 10: {
            int32_t * v17 = (int32_t *)(v1 + 28);
            int32_t v18 = *v17; // 0x8051a57
            LYEdit1(edit, 0, 19, 0);
            *v17 = v18;
            v7 = v18;
            v6 = v17;
            v10 = *v17 - v18;
            goto lab_0x8051ad4;
        }
        case 11: {
            int32_t * v19 = (int32_t *)(v1 + 28);
            LYEdit1(edit, 0, 20, 0);
            int32_t v20 = *v19; // 0x8051ace
            v7 = v20;
            v6 = v19;
            v10 = *v19 - v20;
            goto lab_0x8051ad4;
        }
        case 12: {
            // 0x8051a26
            *str = 0;
            *(int32_t *)(v1 + 40) = -1;
            // 0x8051a37
            *(int32_t *)(v1 + 28) = 0;
            goto lab_0x8052279;
        }
        case 13: {
            // 0x8051a37
            *(int32_t *)(v1 + 28) = 0;
            goto lab_0x8052279;
        }
        case 14: {
            // 0x8051a46
            *(int32_t *)(v1 + 28) = len;
            goto lab_0x8052279;
        }
        case 15: {
            goto lab_0x8051d97;
        }
        case 16: {
            goto lab_0x8051d97;
        }
        case 17: {
            goto lab_0x8051dee;
        }
        case 18: {
            goto lab_0x8051dee;
        }
        case 19: {
            int16_t * v21 = *__ctype_b_loc(); // 0x8051983
            int32_t * v22 = (int32_t *)(v1 + 28); // 0x8051988
            unsigned char v23 = *(char *)(*v22 + v4); // 0x805198e
            int16_t v24 = *(int16_t *)(2 * (int32_t)v23 + (int32_t)v21); // 0x805199b
            if (v23 < 0 || (v24 & 8) != 0) {
                // branch -> 0x80519cb
            }
            int16_t * v25 = *__ctype_b_loc(); // 0x80519d0
            int32_t v26 = *v22; // 0x80519d5
            unsigned char v27 = *(char *)(v26 + v4); // 0x80519db
            int16_t v28 = *(int16_t *)(2 * (int32_t)v27 + (int32_t)v25); // 0x80519e8
            while (v27 != 0 == v27 > -1 == (v28 & 8) == 0) {
                // 0x80519bc
                *v22 = v26 + 1;
                v25 = *__ctype_b_loc();
                v26 = *v22;
                v27 = *(char *)(v26 + v4);
                v28 = *(int16_t *)(2 * (int32_t)v27 + (int32_t)v25);
            }
            goto lab_0x8052279;
        }
        case 20: {
            int32_t * v29 = (int32_t *)(v1 + 28); // 0x80518c0
            if (*v29 != 0) {
                int32_t v30 = v1 + 43;
                int16_t ** v31 = __ctype_b_loc(); // 0x80518c7
                int32_t v32 = *v29; // 0x80518d1
                unsigned char v33 = *(char *)(v32 + v30); // 0x80518da
                int16_t v34 = *(int16_t *)(2 * (int32_t)v33 + (int32_t)*v31); // 0x80518e7
                while (v33 >= 0 == (v34 & 8) == 0) {
                    int32_t v35 = v32 - 1; // 0x80518b4
                    *v29 = v35;
                    if (v35 == 0) {
                        goto lab_0x8052279;
                    }
                    v31 = __ctype_b_loc();
                    v32 = *v29;
                    v33 = *(char *)(v32 + v30);
                    v34 = *(int16_t *)(2 * (int32_t)v33 + (int32_t)*v31);
                }
                if (v32 != 0) {
                    int16_t * v36 = *__ctype_b_loc(); // 0x805192d
                    int32_t v37 = *v29; // 0x8051932
                    unsigned char v38 = *(char *)(v37 + v30); // 0x805193b
                    int16_t v39 = *(int16_t *)(2 * (int32_t)v38 + (int32_t)v36); // 0x8051948
                    while (v38 < 0 || (v39 & 8) != 0) {
                        int32_t v40 = v37 - 1; // 0x8051911
                        *v29 = v40;
                        if (v40 == 0) {
                            // break -> 0x8052279
                            break;
                        }
                        v36 = *__ctype_b_loc();
                        v37 = *v29;
                        v38 = *(char *)(v37 + v30);
                        v39 = *(int16_t *)(2 * (int32_t)v38 + (int32_t)v36);
                    }
                }
            }
            goto lab_0x8052279;
        }
        case 21: {
            // 0x8052261
            LYLowerCase(str);
            goto lab_0x8052279;
        }
        case 22: {
            // 0x8052251
            LYUpperCase(str);
            goto lab_0x8052279;
        }
        case 25: {
            int32_t * v41 = (int32_t *)(v1 + 28); // 0x8051b97
            int32_t v42 = *v41; // 0x8051b97
            int32_t v43 = len + 1; // 0x8051bc5
            if (v43 > v42) {
                // 0x8051b9f
                *str = *(char *)(v42 + v4);
                int32_t v44 = v42 + 1; // 0x8051bbe
                if (v44 != v43) {
                    int32_t v45 = v44 + v4;
                    *(char *)(v45 - *v41) = *(char *)v45;
                    int32_t v46 = v44 + 1; // 0x8051bbe
                    int32_t v47 = v46; // 0x8051bcb
                    while (v46 != v43) {
                        // 0x8051b9f
                        v45 = v47 + v4;
                        *(char *)(v45 - *v41) = *(char *)v45;
                        v46 = v47 + 1;
                        v47 = v46;
                    }
                }
            }
            int32_t * v48 = (int32_t *)(v1 + 40); // 0x8051bd0
            uint32_t v49 = *v48; // 0x8051bd0
            int32_t v50 = v49; // 0x8051bd5
            if (v49 >= 0) {
                // 0x8051bd7
                v50 = -1 - v49;
                *v48 = v50;
            }
            int32_t v51 = v50; // 0x8051bea
            int32_t v52 = *v41; // 0x8051bf0
            *v48 = v51 > -1 - v52 ? -1 : v52 + v51;
            *v41 = 0;
            goto lab_0x8052279;
        }
        case 26: {
            int32_t * v53 = (int32_t *)(v1 + 28); // 0x8051c2b
            *(char *)(*v53 + v4) = 0;
            int32_t * v54 = (int32_t *)(v1 + 40); // 0x8051c39
            uint32_t v55 = *v54; // 0x8051c39
            int32_t v56 = v55; // 0x8051c3e
            if (v55 >= 0) {
                // 0x8051c40
                v56 = -1 - v55;
                *v54 = v56;
            }
            // 0x8051c50
            if (v56 <= -1 - *v53) {
                // 0x8051c66
                *v54 = -1;
            }
            goto lab_0x8052279;
        }
        case 28: {
            // 0x8051e4b
            if (*(int32_t *)(32 * current_char_set + (int32_t)&g144) == 7) {
                goto lab_0x8052279;
            } else {
                // 0x8051e62
                if (HTCJK != 0) {
                    goto lab_0x8052279;
                } else {
                    // 0x8051e6f
                    if (len < 2) {
                        // 0x805229d
                        return ch;
                    }
                    // 0x8051e75
                    v12 = (int32_t *)(v1 + 28);
                    int32_t v57 = *v12; // 0x8051e78
                    if (v57 == 0) {
                        // 0x805229d
                        return ch;
                    }
                    int32_t v58 = v57; // 0x8051e93
                    if (v57 == len) {
                        // 0x8051e95
                        v58 = v57 - 1;
                        *v12 = v58;
                    }
                    // 0x8051ea4
                    v13 = (int32_t *)(v1 + 40);
                    int32_t v59 = *v13; // 0x8051ea7
                    v8 = v58;
                    int32_t v60 = v59; // 0x8051eac
                    if (v59 < 0) {
                        // 0x8051eae
                        v60 = -1 - v59;
                        *v13 = v60;
                        v8 = *v12;
                    }
                    // 0x8051ebe
                    if (v60 == v8) {
                        goto lab_0x8051ee1;
                    } else {
                        // 0x8051ece
                        v9 = v60;
                        if (v60 != v8 + 1) {
                            goto lab_0x8051ef0;
                        } else {
                            goto lab_0x8051ee1;
                        }
                    }
                }
            }
        }
        case 32: {
            uint32_t v61 = ch % 256; // 0x805177a
            int32_t v62 = v61 + 64; // 0x8051784
            int32_t v63 = *(int32_t *)(4 * current_char_set + (int32_t)&LYlowest_eightbit); // 0x805178c
            v11 = v62 < v63 ? v61 : v62;
            int32_t * v64 = (int32_t *)(v1 + 28); // 0x805179e
            int32_t v65 = *v64; // 0x805179e
            int32_t v66 = *v2; // 0x80517a4
            if (v65 > v66) {
                goto lab_0x8051882;
            } else {
                // 0x80517af
                if (*v5 < v66) {
                    int32_t * v67 = (int32_t *)(v1 + 40); // 0x80517c6
                    int32_t v68 = *v67;
                    int32_t v69; // 0x80516e9
                    if (v68 > v65) {
                        int32_t v70 = v68 + 1; // 0x80517d9
                        *v67 = v70;
                        v69 = v70;
                    } else {
                        // 0x80517e4
                        v69 = v68;
                        if (v68 < -1 - v65) {
                            int32_t v71 = v68 - 1; // 0x80517fc
                            *v67 = v71;
                            v69 = v71;
                        }
                    }
                    // 0x8051805
                    if (v69 >= 0) {
                        // 0x805180f
                        *v67 = -1 - v69;
                    }
                    int32_t v72 = v1 + 45;
                    if (*v64 <= len) {
                        int32_t v73 = len;
                        *(char *)(v73 + v72) = *(char *)(v73 + v4);
                        int32_t v74 = v73 - 1; // 0x805183f
                        while (*v64 <= v74) {
                            // 0x8051827
                            v73 = v74;
                            *(char *)(v73 + v72) = *(char *)(v73 + v4);
                            v74 = v73 - 1;
                        }
                    }
                    // 0x805184e
                    *(char *)(len + v72) = 0;
                    *(char *)(*v64 + v4) = (char)v11;
                    *v64 = *v64 + 1;
                    goto lab_0x8052279;
                } else {
                    goto lab_0x8051882;
                }
            }
        }
        case 33: {
            // 0x8051f96
            *(int32_t *)(v1 + 40) = *(int32_t *)(v1 + 28);
            // 0x805229d
            return 0;
        }
        case 34: {
            int32_t * v75 = (int32_t *)(v1 + 40); // 0x8051fb1
            int32_t v76 = *v75; // 0x8051fb1
            int32_t v77 = v76; // 0x8051fb6
            if (v76 < 0) {
                // 0x8051fb8
                v77 = -1 - v76;
                *v75 = v77;
            }
            int32_t * v78 = (int32_t *)(v1 + 28); // 0x8051fd1
            int32_t v79 = *v78; // 0x8051fd1
            if (v77 == v79) {
                // 0x805229d
                return 0;
            }
            // 0x8051fe4
            *v78 = v77;
            *v75 = v79;
            goto lab_0x8052279;
        }
        case 35: {
            int32_t * v80 = (int32_t *)(v1 + 40); // 0x805200a
            int32_t v81 = *v80; // 0x805200a
            int32_t v82 = v81; // 0x805200f
            if (v81 < 0) {
                // 0x8052011
                v82 = -1 - v81;
                *v80 = v82;
            }
            int32_t * v83 = (int32_t *)(v1 + 28); // 0x805202a
            int32_t v84 = *v83; // 0x805202a
            if (v82 == v84) {
                // 0x8052031
                killbuffer[0] = 0;
                // 0x805229d
                return 0;
            }
            int32_t v85 = v82; // 0x8052052
            int32_t v86 = v84; // 0x8052052
            if (v82 > v84) {
                // 0x8052054
                LYEdit1(edit, 0, 34, 0);
                v85 = *v80;
                v86 = *v83;
            }
            int32_t v87 = v86 - v85; // 0x8052085
            LYstrncpy(killbuffer, (char *)(v85 + v4), v87 < 1023 ? v87 : 1023);
            int32_t v88 = *v80; // 0x80520d1
            int32_t v89 = v88 + v4;
            char v90 = *(char *)(v89 + v87); // 0x80520fe
            *(char *)v89 = v90;
            v88++;
            while (v90 != 0) {
                // 0x80520f2
                v89 = v88 + v4;
                v90 = *(char *)(v89 + v87);
                *(char *)v89 = v90;
                v88++;
            }
            // 0x8052107
            *v83 = *v80;
            uint32_t v91 = *v80; // 0x8052131
            if (v91 >= 0) {
                // 0x805213c
                *v80 = -1 - v91;
            }
            goto lab_0x8052279;
        }
        case 36: {
            // 0x8052151
            if (killbuffer[0] == 0) {
                // 0x805215c
                *(int32_t *)(v1 + 40) = -1 - *(int32_t *)(v1 + 28);
                // 0x805229d
                return 0;
            }
            int32_t len2 = strlen(killbuffer); // 0x805217f
            int32_t * v92 = (int32_t *)(v1 + 28); // 0x805218a
            int32_t v93 = *v92; // 0x805218a
            int32_t v94 = *v2; // 0x8052195
            if (v93 + len2 > v94) {
                goto lab_0x805222e;
            } else {
                // 0x80521a0
                if (*v5 + len2 > v94) {
                    goto lab_0x805222e;
                } else {
                    // 0x80521b5
                    *(int32_t *)(v1 + 40) = -1 - v93;
                    uint32_t v95 = *v92; // 0x80521ef
                    int32_t v96 = v95; // 0x80521f5
                    if (v95 <= len) {
                        int32_t v97 = len + v4;
                        *(char *)(v97 + len2) = *(char *)v97;
                        int32_t v98 = len - 1; // 0x80521e8
                        int32_t v99 = *v92; // 0x80521ef
                        int32_t v100 = v98; // 0x80521f5
                        v96 = v99;
                        while (v99 <= v98) {
                            // 0x80521cd
                            v97 = v100 + v4;
                            *(char *)(v97 + len2) = *(char *)v97;
                            v98 = v100 - 1;
                            v99 = *v92;
                            v100 = v98;
                            v96 = v99;
                        }
                    }
                    int32_t v101 = 0; // 0x805222a
                    if (len2 > 0) {
                        char v102 = *(char *)(v101 + (int32_t)&killbuffer); // 0x8052209
                        *(char *)(v96 + v4) = v102;
                        int32_t v103 = v96 + 1; // 0x8052217
                        *v92 = v103;
                        int32_t v104 = v101 + 1; // 0x8052220
                        int32_t v105 = v103; // 0x805222a
                        v101 = v104;
                        while (v104 != len2) {
                            // 0x8052200
                            v102 = *(char *)(v101 + (int32_t)&killbuffer);
                            *(char *)(v105 + v4) = v102;
                            v103 = v105 + 1;
                            *v92 = v103;
                            v104 = v101 + 1;
                            v105 = v103;
                            v101 = v104;
                        }
                    }
                    goto lab_0x8052279;
                }
            }
        }
        default: {
            return result;
        }
    }
  lab_0x8052279:
    // 0x8052279
    *(char *)(v1 + 22) = 1;
    *v5 = strlen(str);
    // 0x805229d
    return 0;
  lab_0x8051cb2:
    if (len != 0) {
        int32_t * v106 = (int32_t *)(v1 + 28); // 0x8051cbf
        int32_t v107 = *v106; // 0x8051cbf
        if (v107 != 0) {
            int32_t v108 = mbcs_glyphs(str, v107); // 0x8051ce3
            int32_t v109 = v107 - mbcs_skip(str, v108 - 1); // 0x8051cff
            int32_t v110 = *v106 - v109; // 0x8051d0e
            *v106 = v110;
            int32_t v111 = len + 1 - v109; // 0x8051d49
            if (v111 > v110) {
                int32_t v112 = v110 + v4;
                *(char *)v112 = *(char *)(v112 + v109);
                int32_t v113 = v110 + 1; // 0x8051d3d
                int32_t v114 = v113; // 0x8051d4f
                while (v113 != v111) {
                    // 0x8051d22
                    v112 = v114 + v4;
                    *(char *)v112 = *(char *)(v112 + v109);
                    v113 = v114 + 1;
                    v114 = v113;
                }
            }
            int32_t * v115 = (int32_t *)(v1 + 40); // 0x8051d54
            uint32_t v116 = *v115; // 0x8051d54
            int32_t v117 = v116; // 0x8051d59
            if (v116 >= 0) {
                // 0x8051d5b
                v117 = -1 - v116;
                *v115 = v117;
            }
            // 0x8051d6b
            if (v117 <= -1 - *v106) {
                // 0x8051d81
                *v115 = v117 + v109;
            }
        }
    }
    goto lab_0x8052279;
  lab_0x8051d97:;
    int32_t * v118 = (int32_t *)(v1 + 28); // 0x8051d9a
    int32_t v119 = *v118; // 0x8051d9a
    if (v119 < len) {
        // 0x8051da2
        *v118 = mbcs_skip((char *)(v119 + v4), 1) + v119;
    } else {
        if (action == 16) {
            // 0x805229d
            return -ch;
        }
    }
    goto lab_0x8052279;
  lab_0x8051dee:;
    int32_t * v120 = (int32_t *)(v1 + 28); // 0x8051df1
    int32_t v121 = *v120; // 0x8051df1
    if (v121 < 1) {
        if (action == 18) {
            // 0x805229d
            return -ch;
        }
    } else {
        // 0x8051df8
        *v120 = mbcs_skip(str, mbcs_glyphs(str, v121) - 1);
    }
    goto lab_0x8052279;
  lab_0x8051ad4:;
    int32_t v122 = len + 1 - v10; // 0x8051b06
    if (v122 > v7) {
        int32_t v123 = v7 + v4;
        *(char *)v123 = *(char *)(v123 + v10);
        int32_t v124 = v7 + 1; // 0x8051afa
        int32_t v125 = v124; // 0x8051b0c
        while (v124 != v122) {
            // 0x8051adf
            v123 = v125 + v4;
            *(char *)v123 = *(char *)(v123 + v10);
            v124 = v125 + 1;
            v125 = v124;
        }
    }
    int32_t * v126 = (int32_t *)(v1 + 40); // 0x8051b11
    uint32_t v127 = *v126; // 0x8051b11
    int32_t v128 = v127; // 0x8051b16
    if (v127 >= 0) {
        int32_t v129 = -1 - v127;
        *v126 = v129;
        v128 = v129;
    }
    int32_t v130 = -1 - *v6;
    int32_t v131 = v130 - v10;
    int32_t v132 = v131; // 0x8051b3b
    int32_t v133 = v130; // 0x8051b3b
    int32_t v134 = v128; // 0x8051b3b
    if (v128 <= v131) {
        int32_t v135 = v128 + v10; // 0x8051b45
        *v126 = v135;
        int32_t v136 = -1 - *v6;
        v132 = v136 - v10;
        v133 = v136;
        v134 = v135;
    }
    int32_t v137 = v134; // 0x8051b5e
    if (v132 < v137 == v137 < v133) {
        // 0x8051b7f
        *v126 = v133;
    }
    goto lab_0x8052279;
  lab_0x8051882:
    // 0x8051882
    result = v11;
    if (maxMessage != 0) {
        // 0x8051888
        mustshow = 1;
        statusline(gettext("Maximum length reached!  Delete text or move off field."));
        result = v11;
    }
    // 0x805229d
    return result;
  lab_0x805222e:
    if (maxMessage != 0) {
        // 0x8052234
        mustshow = 1;
        statusline(gettext("Maximum length reached!  Delete text or move off field."));
    }
    goto lab_0x8052279;
  lab_0x8051ee1:;
    int32_t v138 = v8 - 1; // 0x8051ee7
    *v13 = v138;
    v9 = v138;
    goto lab_0x8051ef0;
  lab_0x8051ef0:
    // 0x8051ef0
    if (v9 >= 0) {
        // 0x8051efa
        *v13 = -1 - v9;
    }
    int32_t v139 = *v12; // 0x8051f0d
    char * v140 = (char *)(v1 + 43 + v139); // 0x8051f16
    char v141 = *v140; // 0x8051f16
    char v142 = *(char *)(v139 + v4); // 0x8051f24
    if (v141 != v142) {
        // 0x8051f41
        *v140 = v142;
        int32_t v143 = *v12; // 0x8051f79
        *(char *)(v143 + v4) = v141;
        *v12 = v143 + 1;
    } else {
        // 0x8051f2d
        *v12 = v139 + 1;
    }
    goto lab_0x8052279;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80522a6 - 0x80524c5
// Line range:    3518 - 3573
int32_t get_popup_number(char * msg, int32_t * c, int32_t * rel) {
    char temp2[120]; // bp-132, 0x80522a6
    char temp[120]; // bp-136, 0x80522a6
    char v1[120]; // 0x8052380
    char v2[120]; // 0x8052388
    char v3[120]; // 0x80522d8
    char v4[120]; // 0x8052415
    char v5[120]; // 0x80523ed
    int32_t v6 = __readgsdword(20); // 0x80522ca
    int32_t v7; // bp-128, 0x80522a6
    v3[0] = &v7;
    temp2 = v3;
    v7 = 0x1000000 * *c >> 24;
    mustshow = 1;
    statusline(msg);
    int32_t v8; // 0x80522a6
    if (LYgetstr((char *)&v7, 0, 120, 0) < 0) {
        goto lab_0x805232e;
    } else {
        // 0x8052326
        if ((char)v7 != 0) {
            // 0x8052369
            *rel = 0;
            int32_t v9 = *(int32_t *)&temp2;
            char * str = (char *)v9;
            int32_t str_as_i = atoi(str); // 0x805237b
            v1[0] = str_as_i;
            temp = v1;
            int16_t * v10 = *__ctype_b_loc(); // 0x8052391
            unsigned char v11 = *str; // 0x8052396
            int32_t v12 = v9; // 0x80523ae
            char v13 = v11; // 0x80523ae
            if ((*(int16_t *)(2 * (int32_t)v11 + (int32_t)v10) & 2048) != 0) {
                v2[0] = (char)v9 + 1;
                temp2 = v2;
                int16_t * v14 = *__ctype_b_loc(); // 0x8052391
                int32_t v15 = *(int32_t *)&temp2; // 0x8052393
                unsigned char v16 = *(char *)v15; // 0x8052396
                v12 = v15;
                v13 = v16;
                while ((*(int16_t *)(2 * (int32_t)v16 + (int32_t)v14) & 2048) != 0) {
                    // 0x8052388
                    v2[0] = (char)v15 + 1;
                    temp2 = v2;
                    v14 = *__ctype_b_loc();
                    v15 = *(int32_t *)&temp2;
                    v16 = *(char *)v15;
                    v12 = v15;
                    v13 = v16;
                }
            }
            // 0x80523b0
            char * v17; // 0x80522a6
            switch (v13) {
                case 45: {
                }
                case 43: {
                    // 0x80523dc
                    *rel = (int32_t)v13;
                    v5[0] = (char)v12 + 1;
                    temp2 = v5;
                    char * v18 = (char *)*(int32_t *)&temp2;
                    *c = (int32_t)*v18;
                    v17 = v18;
                    // break -> 0x805242a
                    break;
                }
                case 0: {
                    // 0x80523b0
                    v17 = (char *)v12;
                    // break -> 0x805242a
                    break;
                }
                default: {
                    // 0x8052404
                    *c = (int32_t)v13;
                    v4[0] = (char)v12 + 1;
                    temp2 = v4;
                    char * v19 = (char *)*(int32_t *)&temp2;
                    *rel = (int32_t)*v19;
                    v17 = v19;
                    // break -> 0x805242a
                    break;
                }
            }
            char v20 = *v17; // 0x805242d
            if (v20 != 103 == (v20 != 71)) {
                if (v20 != 112 == (v20 != 80)) {
                    // 0x805246e
                    *c = 0;
                } else {
                    // 0x8052460
                    *c = 112;
                }
            } else {
                // 0x805243e
                *c = 103;
            }
            // 0x805247a
            switch (*rel) {
                default: {
                    // 0x8052494
                    *rel = 0;
                }
                case 43: {
                }
                case 45: {
                    // 0x80524a0
                    v8 = *(int32_t *)&temp;
                    // break -> 0x80524ac
                    break;
                }
            }
            goto lab_0x80524ac;
        } else {
            goto lab_0x805232e;
        }
    }
  lab_0x805232e:
    // 0x805232e
    HTInfoMsg(gettext("Cancelled!!!"));
    *c = 0;
    *rel = 0;
    v8 = 0;
    goto lab_0x80524ac;
  lab_0x80524ac:;
    int32_t result = v8; // 0x80524bc
    if (v6 != __readgsdword(20)) {
        // 0x80524be
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80524c3
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80524c5 - 0x8052529
// Line range:    3584 - 3596
void remember_column(int32_t * edit, int32_t offset) {
    int32_t v1 = LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
    *(int32_t *)((int32_t)edit + 1068 + 4 * offset) = v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8052529 - 0x80525b4
// Line range:    3599 - 3609
void fill_edited_line(int32_t prompting, uint32_t length, uint32_t ch) {
    // 0x8052529
    curses_style(prompting == 0 ? s_aedit_pad : s_prompt_edit_pad, 1);
    if (length <= 0) {
        // 0x8052587
        curses_style(prompting == 0 ? s_aedit_pad : s_prompt_edit_pad, 0);
        return;
    }
    int32_t v1 = 0; // 0x805257b
    function_804a8f4((int32_t)LYwin, ch % 256);
    while (v1 + 1 != length) {
        // 0x8052563
        v1++;
        function_804a8f4((int32_t)LYwin, ch % 256);
    }
    // 0x8052587
    curses_style(prompting == 0 ? s_aedit_pad : s_prompt_edit_pad, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80525b4 - 0x8052f5d
// Line range:    3617 - 3890
void LYRefreshEdit(int32_t * edit) {
    int32_t v1 = (int32_t)edit;
    char * v2 = (char *)(v1 + 22); // 0x80525df
    if (*v2 == 0) {
        // 0x8052f54
        return;
    }
    int32_t * v3 = (int32_t *)(v1 + 8); // 0x80525ee
    if (*v3 == 0) {
        // 0x8052f54
        return;
    }
    // 0x80525f9
    *v2 = 0;
    int32_t v4 = v1 + 44; // 0x8052603
    char * str = (char *)v4;
    int32_t len = strlen(str); // 0x8052609
    *(int32_t *)(v1 + 12) = len;
    uint32_t v5 = LYstrCells(str); // 0x8052623
    int32_t * v6 = (int32_t *)(v1 + 28); // 0x805262e
    int32_t v7 = LYstrExtent2(str, *v6); // 0x805263e
    int32_t * v8 = (int32_t *)(v1 + 24); // 0x8052649
    mbcs_glyphs(str, *v8);
    mbcs_glyphs(str, *v6);
    mbcs_glyphs(str, len);
    int32_t v9 = *v8;
    int32_t v10 = LYstrExtent2(str, v9); // 0x80526b0
    int32_t v11 = *v3; // 0x80526bb
    uint32_t v12 = v11 + v10; // 0x80526be
    int32_t * v13 = (int32_t *)(v1 + 32);
    int32_t v14 = v9; // 0x80526c4
    int32_t v15 = v10; // 0x80526c4
    if (v12 <= v5) {
        int32_t v16 = *v13; // 0x80526d4
        v14 = v9;
        v15 = v10;
        if (v12 - v16 <= v7) {
            int32_t v17 = v16 + v7 - v11; // 0x80526f7
            v14 = mbcs_skip(str, cell2char(str, v17));
            v15 = v17;
        }
    }
    int32_t v18 = *v13; // 0x8052730
    int32_t v19 = v14; // 0x8052739
    int32_t v20 = v15; // 0x8052739
    if (v18 + v15 > v7) {
        int32_t v21 = v7 - v18; // 0x8052744
        v20 = v21 >= 0 ? v21 : 0;
        v19 = mbcs_skip(str, cell2char(str, v20));
    }
    int32_t * v22 = (int32_t *)(v1 + 4); // 0x805278e
    LYmove(*v22, *edit);
    char * v23 = (char *)(v1 + 23); // 0x80527a0
    int32_t v24 = 0; // 0x80527a6
    if (!((v20 == 0 | *v23 == 0))) {
        // 0x80527b6
        curses_style(s_aedit_arr, 1);
        LYmove(*v22, *edit);
        function_804a8f4((int32_t)LYwin, g167);
        curses_style(s_aedit_arr, 0);
        v24 = 1;
    }
    int32_t v25 = v24;
    int32_t v26 = v19 + v4; // 0x805285e
    *v8 = v19;
    int32_t v27 = v5 - v20; // 0x8052873
    int32_t v28 = *v3; // 0x805287b
    char * v29 = (char *)v26;
    int32_t v30 = v28 - v25 < v27 ? v28 + -1 - v25 : v27;
    int32_t v31 = v30;
    int32_t v32 = mbcs_skip(v29, cell2char(v29, v31)); // 0x80528be
    int32_t v33 = v27; // 0x80528ca
    while (v28 - v25 < v27) {
        int32_t v34 = LYstrExtent2(v29, v32); // 0x80528df
        v30 = v34 > v31 ? v31 - 1 : v34;
        v33 = v30;
        if (v30 >= v31) {
            // break -> 0x8052900
            break;
        }
        v31 = v30;
        v32 = mbcs_skip(v29, cell2char(v29, v31));
        v33 = v27;
    }
    int32_t v35 = *v22; // 0x8052903
    if (WWW_TraceFlag != 0) {
        // 0x805293c
        if ((WWW_TraceMask & 2) != 0) {
            // 0x8052948
            fprintf(TraceFP(), "STYLE.getstr: switching to <edit.%s>.\n", v35 != LYlines - 1 ? "active" : "prompt");
        }
    }
    int32_t v36 = v35 != LYlines - 1 ? s_aedit : s_prompt_edit;
    if (v36 == -1) {
        // 0x80529a0
        *(int32_t *)&LYCursesON = 0;
    } else {
        // 0x805298b
        curses_style(v36, 1);
    }
    // 0x80529ac
    bool v37; // 0x80525b4
    bool v38; // 0x80525b4
    int32_t v39; // 0x80525b4
    int32_t v40; // 0x80525b4
    int32_t v41; // 0x80525b4
    int32_t v42; // 0x80525b4
    int32_t v43; // 0x80525b4
    int32_t * v44; // 0x8052aa5
    if (*(char *)(v1 + 21) == 0) {
        // 0x8052aa2
        v44 = (int32_t *)(v1 + 40);
        uint32_t v45 = *v44; // 0x8052aa5
        if (v45 >= 0) {
            // 0x8052aac
            if (*v8 > v45) {
                // 0x8052abc
                curses_style(v35 != LYlines - 1 ? s_aedit_sel : s_prompt_sel, 1);
            }
        }
        // 0x8052af1
        remember_column(edit, 0);
        int32_t v46 = *v44;
        v41 = v46;
        v37 = v46 < 0;
        if (v32 > 0) {
            // 0x8052b10
            v38 = v46 < 0;
            v39 = v46;
            v42 = 0;
            while (true) {
              lab_0x8052b10:
                // 0x8052b10
                v43 = v42;
                if (v38) {
                    goto lab_0x8052c22;
                } else {
                    int32_t v47 = v39;
                    int32_t v48 = *v8 + v43;
                    int32_t v49 = *v6;
                    if (v48 == v47 == v49 > v47) {
                        goto lab_0x8052b64;
                    } else {
                        // 0x8052b3f
                        v40 = v47;
                        if (v48 == v49 == v49 < v47) {
                            goto lab_0x8052b64;
                        } else {
                            goto lab_0x8052b99;
                        }
                    }
                }
            }
        }
      lab_0x8052d4f:
        // 0x8052d4f
        if (v37) {
            goto lab_0x8052ddd;
        } else {
            int32_t v50 = *v8 + v32;
            int32_t v51 = *v6;
            if (v50 > v41) {
                if (v50 > v51) {
                    goto lab_0x8052ddd;
                } else {
                    goto lab_0x8052db1;
                }
            } else {
                if (v50 > v51) {
                    goto lab_0x8052db1;
                } else {
                    goto lab_0x8052ddd;
                }
            }
        }
    } else {
        int32_t v52 = *(int32_t *)(32 * current_char_set + (int32_t)&g144); // 0x80529c3
        fill_edited_line(0, v33, 42);
        int32_t v53 = v1 + 1068;
        int32_t v54 = 0;
        int32_t v55 = 0;
        int32_t v56 = v54 + v26; // 0x80529fe
        char * v57 = (char *)v56;
        int32_t v58 = (int32_t)LYmbcs_skip_glyphs(v57, 1, (char)(v52 == 7)); // 0x8052a1a
        int32_t v59 = v54; // 0x8052a57
        int32_t v60; // 0x80525b4
        int32_t v61; // 0x8052a4d
        if (v54 < v58 - v26) {
            // 0x8052a33
            v60 = -44 - v1 - v19 + v58;
            v61 = v54;
            *(int32_t *)(4 * v61 + v53) = *edit + v55;
            v61++;
            v59 = v60;
            while (v61 != v60) {
                // 0x8052a33
                *(int32_t *)(4 * v61 + v53) = *edit + v55;
                v61++;
                v59 = v60;
            }
        }
        int32_t v62 = v59;
        int32_t v63 = LYstrExtent2(v57, v58 - v56) + v55; // 0x8052a74
        while (v62 < v32) {
            // 0x80529fb
            v54 = v62;
            v55 = v63;
            v56 = v54 + v26;
            v57 = (char *)v56;
            v58 = (int32_t)LYmbcs_skip_glyphs(v57, 1, (char)(v52 == 7));
            v59 = v54;
            if (v54 < v58 - v26) {
                // 0x8052a33
                v60 = -44 - v1 - v19 + v58;
                v61 = v54;
                *(int32_t *)(4 * v61 + v53) = *edit + v55;
                v61++;
                v59 = v60;
                while (v61 != v60) {
                    // 0x8052a33
                    *(int32_t *)(4 * v61 + v53) = *edit + v55;
                    v61++;
                    v59 = v60;
                }
            }
            // 0x8052a59
            v62 = v59;
            v63 = LYstrExtent2(v57, v58 - v56) + v55;
        }
        // 0x8052a83
        *(int32_t *)(4 * v62 + v53) = *edit + v63;
        goto lab_0x8052ddd;
    }
  lab_0x8052c22:;
    unsigned char v64 = *(char *)(v43 + v26); // 0x8052c28
    if (v64 < 3) {
        // 0x8052c8c
        function_804a8f4((int32_t)LYwin, 32);
        goto lab_0x8052d2a;
    } else {
        if (v64 != -96) {
            goto lab_0x8052ca6;
        } else {
            // 0x8052c49
            if (HTPassHighCtrlRaw != 0) {
                goto lab_0x8052ca6;
            } else {
                // 0x8052c54
                if (HTCJK != 0) {
                    goto lab_0x8052ca6;
                } else {
                    int32_t v65 = 32 * current_char_set; // 0x8052c62
                    if (*(int32_t *)(v65 + (int32_t)&g144) == 2) {
                        // 0x8052c8c
                        function_804a8f4((int32_t)LYwin, 32);
                        goto lab_0x8052d2a;
                    } else {
                        int32_t v66 = *(int32_t *)((v65 | 16) + (int32_t)&g145); // 0x8052c7d
                        if ((char)v66 > -1) {
                            goto lab_0x8052ca6;
                        } else {
                            // 0x8052c8c
                            function_804a8f4((int32_t)LYwin, 32);
                            goto lab_0x8052d2a;
                        }
                    }
                }
            }
        }
    }
  lab_0x8052b64:
    // 0x8052b64
    curses_style(v35 != LYlines - 1 ? s_aedit_sel : s_prompt_sel, 1);
    v40 = *v44;
    goto lab_0x8052b99;
  lab_0x8052d2a:;
    int32_t v73 = v43 + 1; // 0x8052d2d
    remember_column(edit, v73);
    int32_t v74 = *v44;
    v38 = v74 < 0;
    v39 = v74;
    v42 = v73;
    v41 = v74;
    v37 = v74 < 0;
    if (v73 == v32) {
        // break -> 0x8052d4f
        goto lab_0x8052d4f;
    }
    goto lab_0x8052b10;
  lab_0x8052ca6:
    if (v64 != 9) {
        // 0x8052d0c
        function_804a8f4((int32_t)LYwin, (int32_t)v64);
    } else {
        int32_t v75 = *(int32_t *)(v1 + 1068 + 4 * v43) - *edit; // 0x8052cd0
        v75++;
        function_804a8f4((int32_t)LYwin, 32);
        while (v75 % 8 != 0) {
            // 0x8052ce7
            v75++;
            function_804a8f4((int32_t)LYwin, 32);
        }
    }
    goto lab_0x8052d2a;
  lab_0x8052b99:;
    int32_t v67 = v40; // 0x8052be6
    if (v67 < 0) {
        goto lab_0x8052c22;
    } else {
        int32_t v68 = *v8 + v43;
        int32_t v69 = *v6;
        if (v68 == v67 == v69 < v67) {
            goto lab_0x8052bed;
        } else {
            if (v68 == v69 == v69 > v67) {
                goto lab_0x8052bed;
            } else {
                goto lab_0x8052c22;
            }
        }
    }
  lab_0x8052bed:
    // 0x8052bed
    curses_style(v35 != LYlines - 1 ? s_aedit_sel : s_prompt_sel, 0);
    goto lab_0x8052c22;
  lab_0x8052ddd:;
    int32_t v70 = v1 + 1068;
    int32_t v71 = *(int32_t *)(4 * v32 + v70); // 0x8052df3
    char v72 = *(char *)(v1 + 20); // 0x8052e06
    fill_edited_line((int32_t)(v35 == LYlines - 1), *edit + *v3 - v71, (int32_t)v72);
    if (!((v32 == 0 | *v23 == 0)) && v28 - v25 < v27) {
        // 0x8052e46
        if (WWW_TraceFlag != 0) {
            // 0x8052e51
            fprintf(TraceFP(), "Draw right-scroller offset (%d + %d)\n", v33, v25);
        }
        // 0x8052e78
        curses_style(v35 != LYlines - 1 ? s_aedit_arr : s_prompt_edit_arr, 1);
        LYmove(*v22, v33 + v25 + *edit);
        function_804a8f4((int32_t)LYwin, g166);
        curses_style(v35 != LYlines - 1 ? s_aedit_arr : s_prompt_edit_arr, 0);
    }
    // 0x8052f06
    LYmove(*v22, *(int32_t *)(4 * (*v6 - *v8) + v70));
    if (v36 != -1) {
        // 0x8052f3c
        curses_style(v36, 0);
    }
    // 0x8052f4f
    LYrefresh();
  lab_0x8052db1:
    // 0x8052db1
    curses_style(v35 != LYlines - 1 ? s_aedit_sel : s_prompt_sel, 0);
    goto lab_0x8052ddd;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8052f5d - 0x8052fd8
// Line range:    3893 - 3901
void reinsertEdit(int32_t * edit, char * result) {
    if (result == NULL) {
        // 0x8052fd6
        return;
    }
    // 0x8052f69
    LYEdit1(edit, 0, 12, 0);
    char v1 = *result; // 0x8052fcf
    if (v1 == 0) {
        // 0x8052fd6
        return;
    }
    char * v2 = result; // 0x8052fd4
    int32_t v3 = EditBinding((int32_t)v1); // 0x8052f9a
    LYEdit1(edit, (int32_t)*v2, v3 & -129, 0);
    v2 = (char *)((int32_t)v2 + 1);
    char v4 = *v2; // 0x8052fcf
    while (v4 != 0) {
        // 0x8052f8e
        v3 = EditBinding((int32_t)v4);
        LYEdit1(edit, (int32_t)*v2, v3 & -129, 0);
        v2 = (char *)((int32_t)v2 + 1);
        v4 = *v2;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8053014 - 0x80531ab
// Line range:    3916 - 3951
char ** sortedList(int32_t * list, char ignorecase) {
    uint32_t nmemb = HTList_count(list); // 0x8053026
    int32_t * mem = calloc(nmemb + 1, 4); // 0x8053046
    if (mem == NULL) {
        // 0x8053054
        outofmem("./LYStrings.c", "sortedList");
        // UNREACHABLE
    }
    int32_t v1 = (int32_t)mem; // 0x8053046
    if (list != NULL) {
        int32_t v2 = *(int32_t *)((int32_t)list + 4); // 0x80530b3
        int32_t v3 = 0; // 0x80530b8
        if (v2 != 0) {
            *(int32_t *)(4 * v3 + v1) = *(int32_t *)v2;
            int32_t v4 = *(int32_t *)(v2 + 4); // 0x80530b3
            int32_t v5 = v4; // 0x80530b8
            v3++;
            while (v4 != 0) {
                // 0x805309e
                *(int32_t *)(4 * v3 + v1) = *(int32_t *)v5;
                v4 = *(int32_t *)(v5 + 4);
                v5 = v4;
                v3++;
            }
        }
    }
    if (nmemb < 2) {
        // 0x80531a6
        return (char **)mem;
    }
    // 0x80530c4
    qsort(mem, nmemb, 4, ignorecase == 0 ? (int32_t (*)(int32_t *, int32_t *))0x8052ff6 : (int32_t (*)(int32_t *, int32_t *))0x8052fd8);
    int32_t str = *mem; // 0x805319c
    if (str == 0) {
        // 0x80531a6
        return (char **)mem;
    }
    int32_t v6 = 0;
    int32_t str2 = *(int32_t *)(4 * v6 + v1); // 0x805311c
    int32_t v7 = v6; // 0x8053120
    int32_t v8; // 0x8053014
    int32_t v9; // 0x805310f
    int32_t str3; // 0x805311c
    if (str2 != 0) {
        // 0x8053122
        v8 = v6;
        v7 = v6;
        if (strcmp((char *)str, (char *)str2) == 0) {
            v9 = v8 + 1;
            str3 = *(int32_t *)(4 * v9 + v1);
            v7 = v9;
            while (str3 != 0) {
                // 0x805310f
                v8 = v9;
                v7 = v9;
                if (strcmp((char *)*mem, (char *)str3) != 0) {
                    // break -> 0x8053148
                    break;
                }
                v9 = v8 + 1;
                str3 = *(int32_t *)(4 * v9 + v1);
                v7 = v9;
            }
        }
    }
    int32_t v10 = v7 - 1; // 0x8053148
    int32_t v11; // 0x8053014
    int32_t v12; // 0x8053176
    if (v10 != v6) {
        // 0x805315a
        v11 = v6;
        v12 = *(int32_t *)(4 * (v10 - v6 + v11) + v1);
        *(int32_t *)(4 * v11 + v1) = v12;
        v11++;
        while (v12 != 0) {
            // 0x805315a
            v12 = *(int32_t *)(4 * (v10 - v6 + v11) + v1);
            *(int32_t *)(4 * v11 + v1) = v12;
            v11++;
        }
    }
    int32_t v13 = v6 + 1; // 0x805318f
    int32_t * v14 = (int32_t *)(4 * v13 + v1); // 0x805319c
    int32_t v15 = *v14; // 0x805319c
    int32_t str4 = v15; // 0x80531a0
    while (v15 != 0) {
        // 0x8053113
        v6 = v13;
        str2 = *(int32_t *)(4 * v6 + v1);
        v7 = v6;
        if (str2 != 0) {
            int32_t * str5 = v14;
            v8 = v6;
            v7 = v6;
            if (strcmp((char *)str4, (char *)str2) == 0) {
                v9 = v8 + 1;
                str3 = *(int32_t *)(4 * v9 + v1);
                v7 = v9;
                while (str3 != 0) {
                    // 0x805310f
                    v8 = v9;
                    v7 = v9;
                    if (strcmp((char *)*str5, (char *)str3) != 0) {
                        // break -> 0x8053148
                        break;
                    }
                    v9 = v8 + 1;
                    str3 = *(int32_t *)(4 * v9 + v1);
                    v7 = v9;
                }
            }
        }
        // 0x8053148
        v10 = v7 - 1;
        if (v10 != v6) {
            // 0x805315a
            v11 = v6;
            v12 = *(int32_t *)(4 * (v10 - v6 + v11) + v1);
            *(int32_t *)(4 * v11 + v1) = v12;
            v11++;
            while (v12 != 0) {
                // 0x805315a
                v12 = *(int32_t *)(4 * (v10 - v6 + v11) + v1);
                *(int32_t *)(4 * v11 + v1) = v12;
                v11++;
            }
        }
        // 0x805318f
        v13 = v6 + 1;
        v14 = (int32_t *)(4 * v13 + v1);
        v15 = *v14;
        str4 = v15;
    }
    // 0x80531a6
    return (char **)mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80531ab - 0x80531d5
// Line range:    3954 - 3960
int32_t LYarrayLength(char ** list) {
    int32_t result = 0; // 0x80531ce
    if (*list == NULL) {
        // 0x80531d0
        return 0;
    }
    char ** v1 = list; // 0x80531ce
    v1 = (char **)((int32_t)v1 + 4);
    result++;
    while (*v1 != NULL) {
        // 0x80531ba
        v1 = (char **)((int32_t)v1 + 4);
        result++;
    }
    // 0x80531d0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8053214 - 0x8053293
// Line range:    3979 - 3989
void FormatChoiceNum(char * dst, int32_t num_choices, int32_t choice, char * value) {
    if (num_choices < 0) {
        // 0x8053277
        LYstrncpy(dst, value, 1023);
    } else {
        int32_t v1 = num_choices < 10 ? 1 : 2;
        sprintf(dst, "%*d: %.*s", v1, choice + 1, 1015 - v1, value);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8053293 - 0x80532ef
// Line range:    3992 - 4003
int32_t options_width(char ** list) {
    char * str = *list;
    int32_t v1 = 0; // 0x80532e8
    if (str == NULL) {
        // 0x80532ea
        return 0;
    }
    int32_t result = 0; // 0x80532e8
    int32_t len = result; // 0x80532bf
    if (strlen((char *)(int32_t)str) > result) {
        // 0x80532c1
        len = strlen((char *)*(int32_t *)list);
    }
    // 0x80532d7
    result = len;
    v1++;
    int32_t * v2 = (int32_t *)(4 * v1 + (int32_t)list); // 0x80532e4
    int32_t str2 = *v2; // 0x80532e4
    int32_t * str3 = v2; // 0x80532e8
    while (str2 != 0) {
        // 0x80532a9
        len = result;
        if (strlen((char *)str2) > result) {
            // 0x80532c1
            len = strlen((char *)*str3);
        }
        // 0x80532d7
        result = len;
        v1++;
        v2 = (int32_t *)(4 * v1 + (int32_t)list);
        str2 = *v2;
        str3 = v2;
    }
    // 0x80532ea
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80532ef - 0x8053519
// Line range:    4011 - 4050
void draw_option(int32_t * win, int32_t entry, int32_t width, char reversed, int32_t num_choices, int32_t number, char * value) {
    int32_t v1 = (int32_t)win;
    int32_t v2 = __readgsdword(20); // 0x8053313
    int32_t v3; // bp-1032, 0x80532ef
    FormatChoiceNum((char *)&v3, num_choices, number, (char *)&g3);
    function_804a914(v1, entry, 1);
    curses_w_style(win, s_menu_entry, 1);
    function_804a8f4(v1, 32);
    curses_w_style(win, s_menu_entry, 0);
    curses_w_style(win, s_menu_number, 1);
    function_804b144(v1, &v3, -1);
    curses_w_style(win, s_menu_number, 0);
    curses_w_style(win, reversed == 0 ? s_menu_entry : s_menu_active, 1);
    LYpaddstr(win, width, value);
    curses_w_style(win, reversed == 0 ? s_menu_entry : s_menu_active, 0);
    curses_w_style(win, s_menu_entry, 1);
    function_804a8f4(v1, 32);
    curses_w_style(win, s_menu_entry, 0);
    if (v2 != __readgsdword(20)) {
        // 0x8053512
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8053519 - 0x80551a5
// Line range:    4066 - 4986
int32_t LYhandlePopupList(int32_t cur_choice, int32_t ly, int32_t lx, char ** choices, int32_t width, int32_t i_length, int32_t disabled, char for_mouse) {
    char buffer[1024]; // bp-1116, 0x8053519
    char v1[1024]; // 0x8053e03
    int32_t v2 = lx;
    int32_t v3 = width;
    int32_t v4 = cur_choice;
    int32_t v5 = __readgsdword(20); // 0x8053537
    buffer = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    int32_t i = 0; // bp-1132, 0x805357a
    int32_t v6 = v4;
    if (v6 < 0) {
        // 0x80535fc
        v4 = 0;
    }
    // 0x8053603
    if (g90 != 0) {
        // 0x805360e
        *(char *)&g175 = 0;
        g90 = 0;
    }
    // 0x805361c
    *(char *)&g176 = 0;
    int32_t v7 = 0; // 0x805362a
    if (search_queries != NULL) {
        // 0x805362c
        v7 = HTList_count(search_queries);
    }
    int32_t v8 = v7;
    int32_t v9 = LYarrayLength(choices); // 0x805367f
    int32_t v10 = v3; // 0x805368d
    if (v10 >= 0 != v10 != 0) {
        // 0x8053694
        v3 = options_width(choices);
    }
    int32_t v11 = v9 - 1; // 0x8053684
    int32_t len = 0; // 0x80536ac
    int32_t * v12 = (int32_t *)-1; // 0x80536ac
    if (keypad_mode != 0) {
        // 0x80536ae
        int32_t str; // bp-84, 0x8053519
        sprintf((char *)&str, "%d: ", v11);
        len = strlen((char *)&str);
        v12 = (int32_t *)v11;
    }
    int32_t v13 = -1 - v4 + ly; // 0x8053703
    int32_t v14 = v13 >= 0 ? v13 : 0;
    int32_t num_choices = v14;
    int32_t v15 = i_length >= 0 == (i_length != 0) ? i_length - 1 : v11;
    int32_t v16 = v15 + 3;
    int32_t v17 = v14 + v16; // 0x805373e
    int32_t max_choices = v17; // bp-1156, 0x8053741
    int32_t v18 = (user_mode != 0 ? -2 : -4) + LYlines;
    int32_t v19 = v18; // 0x8053775
    if (for_mouse != 0) {
        // 0x8053777
        v19 = v18 + (int32_t)!((user_mode != 0 | v18 < 3));
    }
    int32_t v20 = v14; // 0x805379c
    int32_t v21 = v17; // 0x805379c
    if (v17 > v19) {
        if (v16 > v19) {
            // 0x80537d9
            num_choices = 0;
            int32_t v22 = v19 + 1; // 0x80537df
            max_choices = v22;
            v20 = 0;
            v21 = v22;
        } else {
            int32_t v23 = v19 + 1; // 0x80537f0
            int32_t v24 = v23 + -3 - v15; // 0x80537fb
            num_choices = v24;
            max_choices = v23;
            v20 = v24;
            v21 = v23;
        }
    }
    int32_t v25 = v21 - v20; // 0x8053821
    int32_t v26 = 2 - v25;
    int32_t v27 = ly + 2; // 0x8053849
    int32_t v28 = v20; // 0x8053854
    int32_t v29 = v21; // 0x8053854
    if (v27 > v21) {
        int32_t v30 = v19 + 1; // 0x8053868
        v29 = v30 < v27 ? v30 : v27;
        max_choices = v29;
        v28 = v29 - 2 + v26;
        num_choices = v28;
    }
    int32_t v31 = v3 + len;
    if (for_mouse != 0) {
        // 0x80538a2
        if (v31 + 4 < LYcols) {
            int32_t v32 = v2; // 0x80538cd
            if (v31 + 3 + v32 > LYcols) {
                // 0x80538e1
                v2 = -3 - v31 + LYcols;
            } else {
                if (v32 >= 0 != v32 != 0) {
                    // 0x80538fc
                    v2 = 1;
                }
            }
        }
    }
    // 0x8053903
    v3 = v31;
    max_choices = v29 - v28;
    int32_t v33 = v6; // 0x805392e
    int64_t v34; // 0x8053519
    int32_t v35; // 0x8053519
    int32_t v36; // 0x8053519
    int32_t v37; // 0x8053519
    int32_t v38; // 0x8053519
    int32_t v39; // 0x8053519
    int32_t v40; // 0x8053519
    int32_t v41; // 0x8053519
    int32_t v42; // 0x8053519
    int32_t v43; // 0x8053519
    int32_t v44; // 0x8053519
    int32_t v45; // 0x8053519
    int32_t v46; // 0x8053519
    int32_t v47; // 0x8053519
    int32_t v48; // 0x8053519
    int32_t v49; // 0x8053519
    char * v50; // 0x8053519
    char * v51; // 0x8053519
    char * v52; // 0x8053519
    char * v53; // 0x8053519
    char * v54; // 0x8053519
    int32_t v55; // 0x8053519
    int32_t v56; // 0x8053519
    int32_t v57; // 0x8053519
    int32_t v58; // 0x8053519
    int32_t v59; // 0x8053519
    int32_t v60; // 0x8053519
    char * v61; // 0x8053519
    char * v62; // 0x8053519
    char * v63; // 0x8053519
    char * v64; // 0x8053519
    int32_t v65; // 0x8053519
    int32_t v66; // 0x8053519
    int32_t v67; // 0x8053519
    int32_t v68; // 0x8053519
    int32_t v69; // 0x8053519
    int32_t v70; // 0x8053519
    char v71; // 0x8053519
    char v72; // 0x8053519
    char v73; // 0x8053519
    char v74; // 0x8053519
    char v75; // 0x8053519
    char v76; // 0x8053519
    char v77; // 0x8053519
    char v78; // 0x8053519
    char v79; // 0x8053519
    char v80; // 0x8053519
    char v81; // 0x8053519
    int32_t v82; // 0x8053519
    int32_t v83; // 0x8053825
    int32_t v84; // 0x8053519
    int32_t v85; // 0x8053519
    int32_t v86; // 0x8053519
    int32_t v87; // 0x8053519
    if (v11 < 1 || v4 > v11) {
        goto lab_0x8055183;
    } else {
        int32_t * v88 = LYstartPopup(&num_choices, &v2, &max_choices, &v3); // 0x805395c
        v33 = v6;
        if (v88 != NULL) {
            // 0x8053981
            v3 -= len;
            max_choices += num_choices;
            if (disabled == 0) {
                if (for_mouse != 0) {
                    // 0x80539d9
                    v64 = gettext("Left mouse button or return to select, arrow keys to scroll.");
                } else {
                    // 0x80539c5
                    v64 = gettext("(Choice list) Hit return and use arrow keys and return to select option.");
                }
            } else {
                // 0x80539a8
                v64 = gettext("UNMODIFIABLE choice list.  Use return or arrow keys to review or leave.");
            }
            // 0x80539eb
            v83 = v25 - 2;
            mustshow = 1;
            statusline(v64);
            int32_t v89 = v4; // 0x8053a00
            if (v9 > v83) {
                int32_t v90 = v83 + v11; // 0x8053a40
                int64_t v91 = v83;
                v34 = v91;
                v82 = (0x100000000 * (int64_t)(v90 >> 31) | (int64_t)v90) / v91;
            } else {
                // 0x80539eb
                v34 = v83;
                v82 = 1;
            }
            // 0x8053a6b
            v84 = (int32_t)choices;
            int32_t v92 = (int32_t)v88; // 0x805395c
            v85 = (int32_t)v12;
            int32_t v93 = len + 3;
            int32_t v94 = v11 - v83;
            v86 = v94 + 1;
            int32_t v95 = v83 + (int32_t)(v83 < 0) >> 1;
            int32_t v96 = (v82 - 1) * v83;
            v39 = v94 < v96 ? v86 : v96;
            v42 = 0;
            v38 = v89 < v83 ? 0 : v26 + 1 + v89;
            v56 = 0;
            v72 = 1;
            v78 = 0;
            v61 = v11 < v83 ? NULL : (char *)4;
            v46 = v8;
            v51 = (char *)(int32_t)(v8 >= 0 == (v8 != 0));
            v66 = v8;
            while (true) {
              lab_0x8053a77_2:;
                int32_t v97 = v38;
                int32_t v98 = 0;
                int32_t v99; // 0x8053abd
                int32_t v100; // 0x8053519
                if (v98 >= v97 == v98 - v97 < v83) {
                    // 0x8053aae
                    v99 = *(int32_t *)(4 * v98 + v84);
                    v100 = v98 + 1;
                    draw_option(v88, v100 - v97, v3, 0, v85, v98, (char *)v99);
                }
                int32_t v101 = v98 + 1;
                while (v101 <= v11) {
                    // 0x8053a86
                    v98 = v101;
                    if (v98 >= v97 == v98 - v97 < v83) {
                        // 0x8053aae
                        v99 = *(int32_t *)(4 * v98 + v84);
                        int32_t v102 = v3; // 0x8053abf
                        v100 = v98 + 1;
                        draw_option(v88, v100 - v97, v102, 0, v85, v98, (char *)v99);
                    }
                    // 0x8053b09
                    v101 = v98 + 1;
                }
                // 0x8053b22
                LYbox(v88, (char)(keypad_mode == 0));
                v36 = v97;
                v68 = v66;
                v52 = v51;
                v47 = v46;
                v63 = v61;
                v60 = 0;
                v79 = v78;
                v74 = v72;
                v57 = v56;
                v44 = v101;
                if (v42 == 39) {
                    // break -> 0x805514e
                    break;
                }
                while (true) {
                  lab_0x8053b50:;
                    int32_t v103 = v44;
                    v58 = v57;
                    v75 = v74;
                    v80 = v79;
                    int32_t v104 = v60;
                    v48 = v47;
                    v53 = v52;
                    v69 = v68;
                    v37 = v36;
                    char * v105 = NULL; // 0x8053b6c
                    if (v63 != NULL) {
                        if (v37 != 0) {
                            // 0x8053c07
                            function_804a914(v92, 1, v3 + v93);
                            curses_w_style(v88, s_menu_sb, 1);
                            function_804a8f4(v92, g168);
                            curses_w_style(v88, s_menu_sb, 0);
                        }
                        int32_t v106 = v37 == 0 ? 0 : 2;
                        int32_t v107 = v11 - v37; // 0x8053b9d
                        int32_t v108 = v107 - v83; // 0x8053b9f
                        char * v109 = (char *)(v106 | (int32_t)(v108 < 0 == ((v108 ^ v107) & (v107 ^ v83)) < 0)); // 0x8053bb1
                        v105 = v109;
                        if (v108 < 0 == ((v108 ^ v107) & (v107 ^ v83)) < 0) {
                            // 0x8053c97
                            function_804a914(v92, v83, v3 + v93);
                            curses_w_style(v88, s_menu_sb, 1);
                            function_804a8f4(v92, g169);
                            curses_w_style(v88, s_menu_sb, 0);
                            v105 = v109;
                        }
                    }
                    int32_t v110 = 1 - v37;
                    v62 = v105;
                    if (v104 != 0) {
                        int32_t v111 = *(int32_t *)(4 * v103 + v104); // 0x8053d2c
                        draw_option(v88, v110 + v103, v3, 0, v85, v103, (char *)v111);
                    }
                    // 0x8053d6d
                    v87 = v4;
                    int32_t v112 = v87 + v110; // 0x8053d88
                    int32_t v113 = *(int32_t *)(4 * v87 + v84); // 0x8053da0
                    draw_option(v88, v112, v3, 1, v85, v87, (char *)v113);
                    LYstowCursor(v88, v112, 1);
                    int32_t v114 = LYgetch_choice(); // 0x8053dfe
                    v1[0] = v114;
                    buffer = v1;
                    if (term_options != 0) {
                        // 0x8053f61
                        g394 = 13;
                        // 0x805512e
                        v4 = v6;
                        goto lab_0x805514e_2;
                    }
                    uint32_t v115 = *(int32_t *)&buffer; // 0x8053e14
                    switch (v115) {
                        case 3: {
                            // 0x8053f61
                            g394 = 13;
                            // 0x805512e
                            v4 = v6;
                            goto lab_0x805514e_2;
                        }
                        case 7: {
                            // 0x8053f61
                            g394 = 13;
                            // 0x805512e
                            v4 = v6;
                            goto lab_0x805514e_2;
                        }
                        default: {
                            if (v115 != -1) {
                                if ((v115 & 0x8800) == 0) {
                                    // 0x8053e65
                                    if (*(int16_t *)((2 * v115 & 4094) + 0x8197ea2) == 47) {
                                        // 0x8053f61
                                        g394 = 13;
                                        // 0x805512e
                                        v4 = v6;
                                        goto lab_0x805514e_2;
                                    }
                                } else {
                                    if (v115 % 256 == 47) {
                                        // 0x8053f61
                                        g394 = 13;
                                        // 0x805512e
                                        v4 = v6;
                                        goto lab_0x805514e_2;
                                    }
                                }
                            } else {
                                // 0x8053e35
                                if (keymap[0] == 47) {
                                    // 0x8053f61
                                    g394 = 13;
                                    // 0x805512e
                                    v4 = v6;
                                    goto lab_0x805514e_2;
                                }
                            }
                            int32_t v116; // 0x8053519
                            if (v115 != 285) {
                                if (v115 != -1) {
                                    if ((v115 & 0x8800) == 0) {
                                        uint16_t v117 = *(int16_t *)((2 * v115 & 4094) + (int32_t)&keymap + 2); // 0x8053f2b
                                        v116 = v117;
                                    } else {
                                        // 0x8053f0a
                                        v116 = v115 % 256;
                                    }
                                } else {
                                    // 0x8053ee9
                                    v116 = keymap[0];
                                }
                            } else {
                                int32_t v118 = fancy_mouse(v88, v112, &v4); // 0x8053eb7
                                if (v118 < 0) {
                                    // break -> 0x8053a77
                                    break;
                                }
                                // 0x8053ecf
                                v116 = v118;
                                if (v118 == 39) {
                                    // break (via goto) -> 0x805514e
                                    goto lab_0x805514e_2;
                                }
                            }
                            // 0x8053f61
                            v43 = v116;
                            g394 = v43;
                            v40 = v37;
                            v59 = v58;
                            v76 = v75;
                            v81 = v80;
                            v49 = v48;
                            v54 = v53;
                            v70 = v69;
                            v73 = v75;
                            v67 = v69;
                            switch (v43) {
                                case 2: {
                                    goto lab_0x8053f7c;
                                }
                                case 3: {
                                    goto lab_0x8053f7c;
                                }
                                case 4: {
                                    goto lab_0x8053f7c;
                                }
                                case 5: {
                                    goto lab_0x8053f7c;
                                }
                                case 6: {
                                    goto lab_0x8053f7c;
                                }
                                case 7: {
                                    goto lab_0x8053f7c;
                                }
                                case 8: {
                                    goto lab_0x8053f7c;
                                }
                                case 9: {
                                    goto lab_0x8053f7c;
                                }
                                case 10: {
                                    goto lab_0x8053f7c;
                                }
                                case 13: {
                                    // 0x805512e
                                    v4 = v6;
                                    goto lab_0x805514e_2;
                                }
                                case 14: {
                                    // 0x805512e
                                    v4 = v6;
                                    goto lab_0x805514e_2;
                                }
                                case 15: {
                                    int32_t v119 = v4;
                                    if (v86 != v37) {
                                        int32_t v120 = v37 + v83; // 0x80545d8
                                        int32_t v121 = v94 < v120 ? v86 : v120;
                                        v4 = v121 - v37 + v119;
                                        v41 = 15;
                                        v35 = v121;
                                        v55 = v58;
                                        v71 = v75;
                                        v77 = v80;
                                        v45 = v48;
                                        v50 = v53;
                                        v65 = v69;
                                        goto lab_0x8053a77_3;
                                    }
                                    // 0x805461c
                                    v40 = v86;
                                    v59 = v58;
                                    v76 = v75;
                                    v81 = v80;
                                    v49 = v48;
                                    v54 = v53;
                                    v70 = v69;
                                    if (v119 < v11) {
                                        // 0x805462b
                                        v4 = v11;
                                        v40 = v86;
                                        v59 = v58;
                                        v76 = v75;
                                        v81 = v80;
                                        v49 = v48;
                                        v54 = v53;
                                        v70 = v69;
                                    }
                                    goto lab_0x8055141;
                                }
                                case 16: {
                                    uint32_t v122 = v4;
                                    if (v37 != 0) {
                                        int32_t v123 = v37 - v83; // 0x8054654
                                        int32_t v124 = v123 >= 0 ? v123 : 0;
                                        v4 = v124 - v37 + v122;
                                        v41 = 16;
                                        v35 = v124;
                                        v55 = v58;
                                        v71 = v75;
                                        v77 = v80;
                                        v45 = v48;
                                        v50 = v53;
                                        v65 = v69;
                                        goto lab_0x8053a77_3;
                                    }
                                    // 0x805467e
                                    v40 = 0;
                                    v59 = v58;
                                    v76 = v75;
                                    v81 = v80;
                                    v49 = v48;
                                    v54 = v53;
                                    v70 = v69;
                                    if (v122 >= 1) {
                                        // 0x8054689
                                        v4 = 0;
                                        v40 = 0;
                                        v59 = v58;
                                        v76 = v75;
                                        v81 = v80;
                                        v49 = v48;
                                        v54 = v53;
                                        v70 = v69;
                                    }
                                    goto lab_0x8055141;
                                }
                                case 17: {
                                    int32_t v125 = v4 - 2; // 0x805476f
                                    int32_t v126 = v125 >= 0 ? v125 : 0;
                                    v4 = v126;
                                    v40 = v37;
                                    v59 = v58;
                                    v76 = v75;
                                    v81 = v80;
                                    v49 = v48;
                                    v54 = v53;
                                    v70 = v69;
                                    if (v126 - v37 < 0) {
                                        int32_t v127 = v37 - 2; // 0x8054794
                                        v41 = 17;
                                        v35 = v127 >= 0 ? v127 : 0;
                                        v55 = v58;
                                        v71 = v75;
                                        v77 = v80;
                                        v45 = v48;
                                        v50 = v53;
                                        v65 = v69;
                                        goto lab_0x8053a77_3;
                                    }
                                    goto lab_0x8055141;
                                }
                                case 18: {
                                    int32_t v128 = v4 + 2; // 0x80546fd
                                    int32_t v129 = v128 > v11 ? v11 : v128;
                                    v4 = v129;
                                    v40 = v37;
                                    v59 = v58;
                                    v76 = v75;
                                    v81 = v80;
                                    v49 = v48;
                                    v54 = v53;
                                    v70 = v69;
                                    if (v129 - v37 >= v83) {
                                        int32_t v130 = v37 + 2; // 0x805472c
                                        v41 = 18;
                                        v35 = v86 < v130 ? v86 : v130;
                                        v55 = v58;
                                        v71 = v75;
                                        v77 = v80;
                                        v45 = v48;
                                        v50 = v53;
                                        v65 = v69;
                                        goto lab_0x8053a77_3;
                                    }
                                    goto lab_0x8055141;
                                }
                                case 19: {
                                    int32_t v131 = v4 - v95; // 0x805485c
                                    int32_t v132 = v131 >= 0 ? v131 : 0;
                                    v4 = v132;
                                    v40 = v37;
                                    v59 = v58;
                                    v76 = v75;
                                    v81 = v80;
                                    v49 = v48;
                                    v54 = v53;
                                    v70 = v69;
                                    if (v132 - v37 < 0) {
                                        int32_t v133 = v37 - v95; // 0x8054891
                                        v41 = 19;
                                        v35 = v133 >= 0 ? v133 : 0;
                                        v55 = v58;
                                        v71 = v75;
                                        v77 = v80;
                                        v45 = v48;
                                        v50 = v53;
                                        v65 = v69;
                                        goto lab_0x8053a77_3;
                                    }
                                    goto lab_0x8055141;
                                }
                                case 20: {
                                    int32_t v134 = v4 + v95; // 0x80547cb
                                    int32_t v135 = v134 > v11 ? v11 : v134;
                                    v4 = v135;
                                    v40 = v37;
                                    v59 = v58;
                                    v76 = v75;
                                    v81 = v80;
                                    v49 = v48;
                                    v54 = v53;
                                    v70 = v69;
                                    if (v135 - v37 >= v83) {
                                        int32_t v136 = v37 + v95; // 0x8054809
                                        v41 = 20;
                                        v35 = v86 < v136 ? v86 : v136;
                                        v55 = v58;
                                        v71 = v75;
                                        v77 = v80;
                                        v45 = v48;
                                        v50 = v53;
                                        v65 = v69;
                                        goto lab_0x8053a77_3;
                                    }
                                    goto lab_0x8055141;
                                }
                                case 21: {
                                    // 0x80548b3
                                    lynx_force_repaint();
                                    LYrefresh();
                                    v40 = v37;
                                    v59 = v58;
                                    v76 = v75;
                                    v81 = v80;
                                    v49 = v48;
                                    v54 = v53;
                                    v70 = v69;
                                    goto lab_0x8055141;
                                }
                                case 22: {
                                    // 0x8054695
                                    v4 = 0;
                                    v40 = v37;
                                    v59 = v58;
                                    v76 = v75;
                                    v81 = v80;
                                    v49 = v48;
                                    v54 = v53;
                                    v70 = v69;
                                    if (v37 >= 1) {
                                        // break -> 0x8053a77
                                        break;
                                    }
                                    goto lab_0x8055141;
                                }
                                case 23: {
                                    // 0x80546b8
                                    v4 = v11;
                                    v40 = v86;
                                    v59 = v58;
                                    v76 = v75;
                                    v81 = v80;
                                    v49 = v48;
                                    v54 = v53;
                                    v70 = v69;
                                    if (v86 != v37) {
                                        // break -> 0x8053a77
                                        break;
                                    }
                                    goto lab_0x8055141;
                                }
                                case 26: {
                                    goto lab_0x805454b;
                                }
                                case 27: {
                                    goto lab_0x8054578;
                                }
                                case 28: {
                                    goto lab_0x805454b;
                                }
                                case 29: {
                                    goto lab_0x8054578;
                                }
                                case 30: {
                                    goto lab_0x805454b;
                                }
                                case 31: {
                                    goto lab_0x8054578;
                                }
                                case 32: {
                                    goto lab_0x805454b;
                                }
                                case 33: {
                                    goto lab_0x8054578;
                                }
                                case 37: {
                                    // 0x805512e
                                    v4 = v6;
                                    goto lab_0x805514e_2;
                                }
                                case 47: {
                                    // 0x805512e
                                    v4 = v6;
                                    goto lab_0x805514e_2;
                                }
                                case 51: {
                                    goto lab_0x805493d;
                                }
                                case 53: {
                                    char v137 = v75; // 0x80548c9
                                    int32_t v138 = v69; // 0x80548c9
                                    if (v53 != NULL) {
                                        // 0x80548cb
                                        v137 = v75;
                                        v138 = v69;
                                        if (*(char *)&g175 == 0) {
                                            char * v139 = HTList_objectAt(search_queries, 0); // 0x80548e6
                                            v137 = v75;
                                            v138 = v69;
                                            if (v139 != NULL) {
                                                // 0x80548fa
                                                LYstrncpy((char *)&g175, v139, 1023);
                                                v137 = 0;
                                                v138 = 0;
                                            }
                                        }
                                    }
                                    // 0x8054929
                                    strcpy((char *)&g176, (char *)&g175);
                                    v73 = v137;
                                    v67 = v138;
                                    goto lab_0x805493d;
                                }
                                case 80: {
                                    // 0x8053f72
                                    buffer = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                                    goto lab_0x8053f7c;
                                }
                                default: {
                                    goto lab_0x8055141;
                                }
                            }
                        }
                    }
                }
                goto lab_0x8053a77_3;
            }
            goto lab_0x805514e_2;
        } else {
            goto lab_0x8055183;
        }
    }
  lab_0x805514e_2:
    // 0x805514e
    LYsubwindow(NULL);
    v33 = disabled == 0 ? v4 : v6;
    goto lab_0x8055183;
  lab_0x8054e06_3:;
    // 0x8054e06
    char v178; // 0x8053519
    char v156 = v178;
    strcpy((char *)&g175, (char *)&g176);
    HTAddSearchQuery((char *)&g175);
    int32_t v179 = v87 + 1; // 0x8054ed0
    int32_t * v180 = (int32_t *)(4 * v179 + v84); // 0x8054edb
    int32_t v181 = *v180;
    int32_t v145 = v181; // 0x8054edf
    int32_t * v143 = v180; // 0x8054edf
    int32_t v144 = v179; // 0x8054edf
    int32_t v141 = 1; // 0x8054edf
    int32_t v159 = 1; // 0x8054edf
    int32_t v150 = v181; // 0x8054edf
    if (v181 != 0) {
        goto lab_0x8054e35;
    } else {
        goto lab_0x8054ee5;
    }
  lab_0x8054d68:;
    // 0x8054d68
    char v182; // 0x8053519
    if (v48 == 1 == v182 == 0) {
        goto lab_0x8054d7c;
    } else {
        // 0x8054d99
        mustshow = 1;
        statusline(gettext("Edit a previous query: "));
        goto lab_0x8054db4;
    }
  lab_0x8054b5c:;
    // 0x8054b5c
    char v183; // 0x8053519
    if (v48 == 1 == v183 == 0) {
        goto lab_0x8054b70;
    } else {
        // 0x8054b8d
        mustshow = 1;
        statusline(gettext("Edit a previous query: "));
        goto lab_0x8054ba8;
    }
  lab_0x8054d7c:
    // 0x8054d7c
    mustshow = 1;
    statusline(gettext("Edit the previous query: "));
    goto lab_0x8054db4;
  lab_0x8054b70:
    // 0x8054b70
    mustshow = 1;
    statusline(gettext("Edit the previous query: "));
    goto lab_0x8054ba8;
  lab_0x8054db4:;
    // 0x8054db4
    int32_t v184; // 0x8053519
    int32_t v185 = LYgetstr((char *)&g176, 0, 1024, v184); // 0x8054dd5
    int32_t v186 = v185; // 0x8054de7
    int32_t v187; // 0x8053519
    int32_t v188 = v187; // 0x8054de7
    int32_t v152; // 0x8053519
    int32_t v153; // 0x8053519
    char v155; // 0x8053519
    char v157; // 0x8053519
    if (v185 < 0) {
        // 0x8054ded
        HTInfoMsg(gettext("Cancelled!!!"));
        v152 = v37;
        v153 = v185;
        v155 = 0;
        v157 = v80;
        goto lab_0x80550aa;
    }
    goto lab_0x80549b1;
  lab_0x8054ba8:;
    int32_t v252 = LYgetstr((char *)&g176, 0, 1024, v184); // 0x8054bc9
    v186 = v252;
    int32_t v209; // 0x8053519
    v188 = v209;
    if (v252 < 0) {
        // 0x8054be1
        HTInfoMsg(gettext("Cancelled!!!"));
        v152 = v37;
        v153 = v252;
        v155 = 0;
        v157 = v80;
        goto lab_0x80550aa;
    }
    goto lab_0x80549b1;
  lab_0x80549b1:;
    int32_t v189 = v186; // 0x8053519
    char v190 = 0; // 0x8053519
    int32_t v191 = v188; // 0x8053519
    goto lab_0x80549b1_2;
  lab_0x8053f7c:;
    char * v212 = gettext("Select option (or page) number: "); // 0x8053f83
    int32_t v213 = get_popup_number(v212, (int32_t *)&buffer, &i); // 0x8053fa1
    if (WWW_TraceFlag != 0) {
        // 0x8053fd8
        fprintf(TraceFP(), "got popup option number %d, ", v213);
        if (WWW_TraceFlag != 0) {
            int32_t v214 = *(int32_t *)&buffer; // 0x8053fe6
            fprintf(TraceFP(), "rel='%c', c='%c', cur_choice=%d\n", (char)i, (char)v214, v4);
        }
    }
    // 0x8054015
    int32_t v215; // 0x8053519
    if (*(int32_t *)&buffer != 112) {
        // 0x80540e2
        if (i != 43) {
            // 0x8054101
            v215 = v213;
            if (i == 45) {
                // 0x805410c
                v215 = 1 - v213 + v4;
            }
        } else {
            // 0x80540ed
            v215 = v213 + 1 + v4;
        }
    } else {
        int32_t v216 = v4; // 0x8054024
        int32_t v217 = 1; // 0x8054030
        if (v216 + 1 > v83) {
            int32_t v218 = v216 + v83; // 0x8054041
            v217 = (0x100000000 * (int64_t)(v218 >> 31) | (int64_t)v218) / v34;
        }
        int32_t v219 = v217;
        if (WWW_TraceFlag != 0) {
            // 0x8054083
            fprintf(TraceFP(), "  curpage=%d\n", v219);
        }
        // 0x80540a4
        if (i != 43) {
            // 0x80540bd
            v215 = i != 45 ? v213 : v219 - v213;
        } else {
            // 0x80540af
            v215 = v219 + v213;
        }
    }
    int32_t v220 = v215;
    if (i != 0 && WWW_TraceFlag != 0) {
        // 0x8054133
        fprintf(TraceFP(), "new number=%d\n", v220);
    }
    int32_t v221 = *(int32_t *)&buffer; // 0x8054154
    int32_t v176; // 0x8053519
    int32_t v222; // bp-1236, 0x8053519
    if (v221 != 112) {
        if (v220 < 1) {
            goto lab_0x8054531;
        } else {
            int32_t v223 = v220 - 1; // 0x8054374
            if (v223 <= v11 && v221 == 0) {
                // 0x8054393
                v4 = v223;
                goto lab_0x805514e_2;
            }
            if (v221 != 103) {
                goto lab_0x8054531;
            } else {
                // 0x80543ba
                if (v223 != v4) {
                    if (v223 <= v11) {
                        // 0x8054456
                        int32_t v224; // 0x80543ba
                        int32_t v225 = v223 - v224; // 0x805445f
                        v4 = v223;
                        int32_t v226 = v223 - v37; // 0x805447c
                        if (v226 < v83 || v225 < 1) {
                            // 0x80544c8
                            v176 = v37;
                            if (v226 >= 0) {
                                goto lab_0x8054503;
                            } else {
                                int32_t v227 = v225 < 0 ? -v225 : v225; // 0x80544e8
                                int32_t v228 = v37 - v227; // 0x80544ea
                                int32_t v229 = v228 >= 0 ? v228 : 0;
                                v176 = v229;
                                goto lab_0x8054503;
                            }
                        } else {
                            int32_t v230 = v225 + v37; // 0x8054490
                            int32_t v231 = v86 < v230 ? v86 : v230;
                            v176 = v231;
                            goto lab_0x8054503;
                        }
                    }
                    // 0x805451d
                    HTUserMsg(gettext("You have entered an invalid option number."));
                    goto lab_0x8054531;
                } else {
                    // 0x80543c5
                    v222 = 0;
                    char * v232 = gettext("Option number %d already is current."); // 0x80543df
                    HTSprintf0((char **)&v222, v232);
                    HTUserMsg((char *)v222);
                    int32_t v233 = v222; // 0x8054408
                    if (v233 != 0) {
                        // 0x8054412
                        free((int32_t *)v233);
                        v222 = 0;
                    }
                    // 0x805442a
                    mustshow = 1;
                    statusline(v64);
                    v40 = v37;
                    v59 = v58;
                    v76 = v75;
                    v81 = v80;
                    v49 = v48;
                    v54 = v53;
                    v70 = v69;
                    goto lab_0x8055141;
                }
            }
        }
    } else {
        if (v220 > 1) {
            if (v220 < v82) {
                int32_t v234 = (v220 - 1) * v83; // 0x80542a1
                if (v234 != v37) {
                    // 0x805432e
                    v4 = v234;
                    mustshow = 1;
                    statusline(v64);
                    v41 = v43;
                    v35 = v234;
                    v55 = v58;
                    v71 = v75;
                    v77 = v80;
                    v45 = v48;
                    v50 = v53;
                    v65 = v69;
                    goto lab_0x8053a77_3;
                }
                // 0x80542b0
                v222 = 0;
                char * v235 = gettext("You are already at page %d of this option list."); // 0x80542c1
                HTSprintf0((char **)&v222, v235);
                HTUserMsg((char *)v222);
                int32_t v236 = v222; // 0x80542f2
                if (v236 != 0) {
                    // 0x80542fc
                    free((int32_t *)v236);
                    v222 = 0;
                }
                // 0x8054314
                mustshow = 1;
                statusline(v64);
                v40 = v37;
                v59 = v58;
                v76 = v75;
                v81 = v80;
                v49 = v48;
                v54 = v53;
                v70 = v69;
            } else {
                if (v86 > v37) {
                    // 0x8054227
                    if (v4 < v39) {
                        // 0x8054275
                        v4 = v39;
                        goto lab_0x805427e;
                    } else {
                        goto lab_0x805427e;
                    }
                }
                // 0x80541f9
                HTUserMsg(gettext("You are already at the end of this option list."));
                mustshow = 1;
                statusline(v64);
                v40 = v37;
                v59 = v58;
                v76 = v75;
                v81 = v80;
                v49 = v48;
                v54 = v53;
                v70 = v69;
            }
        } else {
            if (v37 != 0) {
                // 0x80541a3
                v4 = 0;
                mustshow = 1;
                statusline(v64);
                v41 = v43;
                v35 = 0;
                v55 = v58;
                v71 = v75;
                v77 = v80;
                v45 = v48;
                v50 = v53;
                v65 = v69;
                goto lab_0x8053a77_3;
            }
            // 0x8054175
            HTUserMsg(gettext("You are already at the beginning of this option list."));
            mustshow = 1;
            statusline(v64);
            v40 = v37;
            v59 = v58;
            v76 = v75;
            v81 = v80;
            v49 = v48;
            v54 = v53;
            v70 = v69;
        }
        goto lab_0x8055141;
    }
  lab_0x805454b:;
    int32_t v237 = v4; // 0x805454b
    int32_t v238 = v237; // 0x8054550
    if (v237 >= 1) {
        int32_t v239 = v237 - 1; // 0x8054555
        v4 = v239;
        v238 = v239;
    }
    // 0x805455b
    v40 = v37;
    v59 = v58;
    v76 = v75;
    v81 = v80;
    v49 = v48;
    v54 = v53;
    v70 = v69;
    if (v238 - v37 < 0) {
        // 0x805456c
        v41 = v43;
        v35 = v37 - 1;
        v55 = v58;
        v71 = v75;
        v77 = v80;
        v45 = v48;
        v50 = v53;
        v65 = v69;
        goto lab_0x8053a77_3;
    }
    goto lab_0x8055141;
  lab_0x8054578:;
    int32_t v247 = v4; // 0x8054578
    int32_t v248 = v247; // 0x8054581
    if (v247 < v11) {
        int32_t v249 = v247 + 1; // 0x8054586
        v4 = v249;
        v248 = v249;
    }
    // 0x805458c
    v40 = v37;
    v59 = v58;
    v76 = v75;
    v81 = v80;
    v49 = v48;
    v54 = v53;
    v70 = v69;
    if (v248 - v37 >= v83) {
        // 0x80545a1
        v41 = v43;
        v35 = v37 + 1;
        v55 = v58;
        v71 = v75;
        v77 = v80;
        v45 = v48;
        v50 = v53;
        v65 = v69;
        goto lab_0x8053a77_3;
    }
    goto lab_0x8055141;
  lab_0x805493d:;
    int32_t v243 = v67;
    char v242 = v73;
    int32_t v240; // 0x8053519
    int32_t v241; // 0x8053519
    if (*(char *)&g176 != 0) {
        // 0x805493d
        v240 = (int32_t)v53;
        v241 = v58;
        goto lab_0x80549b1_3;
    } else {
        // 0x8054948
        mustshow = 1;
        statusline(gettext("Enter a whereis query: "));
        int32_t v250 = (int32_t)v53;
        int32_t v251 = LYgetstr((char *)&g176, 0, 1024, v250); // 0x8054984
        v240 = v250;
        v241 = v251;
        if (v251 >= 0) {
            goto lab_0x80549b1_3;
        } else {
            // 0x8054998
            HTInfoMsg(gettext("Cancelled!!!"));
            v152 = v37;
            v153 = v251;
            v155 = v242;
            v157 = v80;
            goto lab_0x80550aa;
        }
    }
  lab_0x8055141:
    // 0x8055141
    v36 = v40;
    v68 = v70;
    v52 = v54;
    v47 = v49;
    v63 = v62;
    v60 = v84;
    v79 = v81;
    v74 = v76;
    v57 = v59;
    v44 = v87;
    if (v43 == 39) {
        // break (via goto) -> 0x805514e
        goto lab_0x805514e_2;
    }
    goto lab_0x8053b50;
  lab_0x8054531:
    // 0x8054531
    mustshow = 1;
    statusline(v64);
    v40 = v37;
    v59 = v58;
    v76 = v75;
    v81 = v80;
    v49 = v48;
    v54 = v53;
    v70 = v69;
    goto lab_0x8055141;
  lab_0x80549b1_3:
    // 0x80549b1
    v184 = v240;
    int32_t v197 = v48 - 1;
    v189 = v241;
    v190 = v242;
    v191 = v243;
    int32_t v154; // 0x8053519
    char v193; // 0x8053519
    while (true) {
      lab_0x80549b1_2:;
        int32_t v192 = v191;
        v193 = v190;
        v154 = v189;
        if (*(char *)&g176 == 0) {
            if (v53 != NULL != ((v154 || 1) == 257)) {
                // break -> 0x80549dd
                break;
            }
        }
        if (v53 == NULL || v154 != 256) {
            // 0x8054bfa
            v178 = v193;
            if (v53 == NULL || v154 != 257) {
                goto lab_0x8054e06_3;
            }
            int32_t v194; // 0x8053519
            if (v193 == 0) {
                // 0x8054cad
                v194 = v192 - 1;
            } else {
                char v195 = *(char *)&g175; // 0x8054c2b
                int32_t v196 = 0; // 0x8054c34
                v194 = v195 == 0 ? v197 : 0;
                if (v197 >= 1 && v195 != 0) {
                    char * str3; // 0x8054c54
                    if (HTList_objectAt(search_queries, v196) != NULL) {
                        // 0x8054c68
                        if (strcmp((char *)&g175, str3) == 0) {
                            // break -> 0x8054cb4
                            break;
                        }
                    }
                    int32_t v198 = v196 + 1; // 0x8054c82
                    v196 = v198;
                    v194 = v198;
                    while (v197 > v198) {
                        // 0x8054c42
                        if (HTList_objectAt(search_queries, v196) != NULL) {
                            int32_t strcmp_rc = strcmp((char *)&g175, str3); // 0x8054c79
                            int32_t v199; // 0x8053519
                            v194 = v199;
                            if (strcmp_rc == 0) {
                                // break -> 0x8054cb4
                                break;
                            }
                        }
                        // 0x8054c82
                        v198 = v196 + 1;
                        v196 = v198;
                        v194 = v198;
                    }
                }
            }
            int32_t v200 = v194;
            v187 = v200 >= 0 ? v200 : v197;
            char * v201 = HTList_objectAt(search_queries, v187); // 0x8054cde
            v178 = 0;
            if (v201 == NULL) {
                goto lab_0x8054e06_3;
            }
            // 0x8054cf6
            LYstrncpy((char *)&g176, v201, 1023);
            v182 = 0;
            if (*(char *)&g175 == 0) {
                goto lab_0x8054d68;
            } else {
                // 0x8054d1f
                if (strcmp((char *)&g175, (char *)&g176) != 0) {
                    char v202 = *(char *)&g175;
                    v182 = v202;
                    if (v48 == 2 == (v202 != 0)) {
                        goto lab_0x8054d7c;
                    } else {
                        goto lab_0x8054d68;
                    }
                } else {
                    // 0x8054d37
                    mustshow = 1;
                    statusline(gettext("Edit the current query: "));
                    goto lab_0x8054db4;
                }
            }
        } else {
            int32_t v203; // 0x8053519
            if (v193 == 0) {
                // 0x8054aa1
                v203 = v192 + 1;
            } else {
                char v204 = *(char *)&g175; // 0x8054a27
                int32_t v205 = v197; // 0x8054a30
                v203 = v204 == 0 ? 0 : v197;
                if (v197 >= 0 == (v197 != 0) && v204 != 0) {
                    int32_t v206 = v205;
                    char * str4 = HTList_objectAt(search_queries, v206); // 0x8054a55
                    if (str4 != NULL) {
                        // 0x8054a69
                        if (strcmp((char *)&g175, str4) == 0) {
                            // break -> 0x8054aa8
                            break;
                        }
                    }
                    int32_t v207 = v206 - 1;
                    v203 = v207;
                    while (v207 >= 0 == (v207 != 0)) {
                        // 0x8054a43
                        v206 = v207;
                        str4 = HTList_objectAt(search_queries, v206);
                        if (str4 != NULL) {
                            int32_t strcmp_rc2 = strcmp((char *)&g175, str4); // 0x8054a7a
                            v203 = v206;
                            if (strcmp_rc2 == 0) {
                                // break -> 0x8054aa8
                                break;
                            }
                        }
                        // 0x8054a83
                        v207 = v206 - 1;
                        v203 = v207;
                    }
                }
            }
            int32_t v208 = v203;
            v209 = v208 < v48 ? v208 : 0;
            char * v210 = HTList_objectAt(search_queries, v209); // 0x8054ad2
            v178 = 0;
            if (v210 == NULL) {
                goto lab_0x8054e06_3;
            }
            // 0x8054aea
            LYstrncpy((char *)&g176, v210, 1023);
            v183 = 0;
            if (*(char *)&g175 == 0) {
                goto lab_0x8054b5c;
            } else {
                // 0x8054b13
                if (strcmp((char *)&g175, (char *)&g176) != 0) {
                    char v211 = *(char *)&g175;
                    v183 = v211;
                    if (v48 == 2 == (v211 != 0)) {
                        goto lab_0x8054b70;
                    } else {
                        goto lab_0x8054b5c;
                    }
                } else {
                    // 0x8054b2b
                    mustshow = 1;
                    statusline(gettext("Edit the current query: "));
                    goto lab_0x8054ba8;
                }
            }
        }
    }
    // 0x80549dd
    HTInfoMsg(gettext("Cancelled!!!"));
    v152 = v37;
    v153 = v154;
    v155 = v193;
    v157 = v80;
    goto lab_0x80550aa;
  lab_0x80550aa:
    // 0x80550aa
    mustshow = 1;
    statusline(v64);
    *(char *)&g176 = 0;
    int32_t v244 = 0; // 0x80550cd
    if (search_queries != NULL) {
        // 0x80550cf
        v244 = HTList_count(search_queries);
    }
    int32_t v245 = v244;
    char * v246 = (char *)(int32_t)(v245 >= 0 == (v245 != 0));
    v40 = v152;
    v59 = v153;
    v76 = v155;
    v81 = v157;
    v49 = v245;
    v54 = v246;
    v70 = v245;
    v41 = v43;
    v35 = v152;
    v55 = v153;
    v71 = v155;
    v77 = 0;
    v45 = v245;
    v50 = v246;
    v65 = v245;
    if (v157 == 1) {
        // break -> 0x8053a77
        goto lab_0x8053a77_3;
    }
    goto lab_0x8055141;
  lab_0x8053a77_3:
    // 0x8053a77
    v42 = v41;
    v38 = v35;
    v56 = v55;
    v72 = v71;
    v78 = v77;
    v61 = v62;
    v46 = v45;
    v51 = v50;
    v66 = v65;
    goto lab_0x8053a77_2;
  lab_0x8055183:;
    int32_t result = v33; // 0x8055193
    if (v5 != __readgsdword(20)) {
        // 0x8055195
        __stack_chk_fail();
        result = &g391;
    }
    // 0x805519a
    return result;
  lab_0x8054e35:;
    int32_t v140 = v141;
    int32_t * v142 = v143;
    int32_t str2; // bp-1108, 0x8053519
    FormatChoiceNum((char *)&str2, v85, v144, (char *)v145);
    if (case_sensitive == 0) {
        // 0x8054ea3
        if (LYstrstr((char *)&str2, (char *)&g175) != NULL) {
            goto lab_0x8054ee5_2;
        } else {
            goto lab_0x8054ebd;
        }
    } else {
        // 0x8054e87
        if (strstr((char *)&str2, (char *)&g175) != NULL) {
            goto lab_0x8054ee5_2;
        } else {
            goto lab_0x8054ebd;
        }
    }
  lab_0x8054ee5:;
    int32_t v146 = v4;
    int32_t v147; // 0x8053519
    int32_t v148; // 0x8053519
    int32_t v149; // 0x8053519
    if (v150 == 0) {
        if (v146 != 0) {
            // 0x8055024
            v148 = 0;
            v147 = v146;
            v149 = 0;
            if (v146 > 0) {
                goto lab_0x8054fa2;
            } else {
                goto lab_0x8055033;
            }
        } else {
            char * v151 = gettext("'%s' not found!"); // 0x8054f79
            HTUserMsg2(v151, (char *)&g175);
            v152 = v37;
            v153 = v154;
            v155 = v156;
            v157 = v80;
            goto lab_0x80550aa;
        }
    } else {
        int32_t v158 = v159;
        int32_t v160 = v146 + v158; // 0x8054f05
        v4 = v160;
        v152 = v37;
        v153 = v154;
        v155 = v156;
        v157 = v80;
        if (v160 - v37 < v83) {
            goto lab_0x80550aa;
        } else {
            int32_t v161 = v158 + v37; // 0x8054f29
            v152 = v86 < v161 ? v86 : v161;
            v153 = v154;
            v155 = v156;
            v157 = 1;
            goto lab_0x80550aa;
        }
    }
  lab_0x8054ee5_2:
    // 0x8054ee5
    v159 = v140;
    v150 = *v142;
    goto lab_0x8054ee5;
  lab_0x8054ebd:;
    int32_t v162 = v140 + 1; // 0x8054ebd
    int32_t v163 = v162 + v87; // 0x8054ed0
    int32_t * v164 = (int32_t *)(4 * v163 + v84); // 0x8054edb
    int32_t v165 = *v164;
    v145 = v165;
    v143 = v164;
    v144 = v163;
    v141 = v162;
    v159 = v162;
    v150 = v165;
    if (v165 != 0) {
        goto lab_0x8054e35;
    } else {
        goto lab_0x8054ee5;
    }
  lab_0x8054fa2:;
    int32_t v166 = v148;
    int32_t v167 = *(int32_t *)(4 * v166 + v84); // 0x8054fb1
    int32_t v168 = v166 + 1; // 0x8054fb9
    FormatChoiceNum((char *)&str2, v85, v168, (char *)v167);
    int32_t v169; // 0x8053519
    if (case_sensitive == 0) {
        char * v170 = LYstrstr((char *)&str2, (char *)&g175); // 0x8055014
        v169 = v166;
        if (v170 != NULL) {
            goto lab_0x8055033_2;
        } else {
            goto lab_0x805501d;
        }
    } else {
        char * substr_pos = strstr((char *)&str2, (char *)&g175); // 0x8054ff8
        v169 = v166;
        if (substr_pos != NULL) {
            goto lab_0x8055033_2;
        } else {
            goto lab_0x805501d;
        }
    }
  lab_0x8055033:;
    int32_t v171 = v149;
    int32_t v172 = v147; // 0x8055033
    if (v171 < v172) {
        // 0x805503e
        v4 = v171;
        v152 = v37;
        v153 = v154;
        v155 = v156;
        v157 = v80;
        if (v171 - v37 >= 0) {
            goto lab_0x80550aa;
        } else {
            int32_t v173 = v171 - v172 + v37; // 0x805506c
            v152 = v173 >= 0 ? v173 : 0;
            v153 = v154;
            v155 = v156;
            v157 = 1;
            goto lab_0x80550aa;
        }
    } else {
        char * v174 = gettext("'%s' not found!"); // 0x8055095
        HTUserMsg2(v174, (char *)&g175);
        v152 = v37;
        v153 = v154;
        v155 = v156;
        v157 = v80;
        goto lab_0x80550aa;
    }
  lab_0x8055033_2:
    // 0x8055033
    v147 = v4;
    v149 = v169;
    goto lab_0x8055033;
  lab_0x805501d:
    // 0x805501d
    v148 = v168;
    v169 = v168;
    if (v168 < v4) {
        goto lab_0x8054fa2;
    } else {
        goto lab_0x8055033_2;
    }
  lab_0x805427e:
    // 0x805427e
    mustshow = 1;
    statusline(v64);
    v41 = v43;
    v35 = v39;
    v55 = v58;
    v71 = v75;
    v77 = v80;
    v45 = v48;
    v50 = v53;
    v65 = v69;
    goto lab_0x8053a77_3;
  lab_0x8054503:;
    int32_t v175 = v176;
    mustshow = 1;
    char * v177; // 0x8053519
    statusline(v177);
    v41 = v43;
    v35 = v175;
    v55 = v58;
    v71 = v75;
    v77 = v80;
    v45 = v48;
    v50 = v53;
    v65 = v69;
    goto lab_0x8053a77_3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80551a5 - 0x8055ada
// Line range:    4994 - 5253
int32_t LYgetstr(char * inputline, int32_t hidden, uint32_t bufsize, int32_t recall) {
    int32_t v1 = __readgsdword(20); // 0x80551b7
    int32_t v2 = bufsize < 1024 ? bufsize - 1 : 1023;
    int32_t v3 = LYwin == NULL ? 1 : -(int32_t)*(int16_t *)&g255;
    int32_t v4; // bp-17460, 0x80551a5
    LYSetupEdit(&v4, inputline, v2, v3 + LYcols + (int32_t)(LYShowScrollbar != 0));
    if (WWW_TraceFlag != 0) {
        // 0x80552d0
        fprintf(TraceFP(), "called LYgetstr\n");
    }
    int32_t v5 = -1; // 0x80551a5
    char v6 = 1; // 0x80551a5
    int32_t v7 = -2; // 0x80551a5
    bool v8; // 0x80551a5
    int32_t v9; // 0x80551a5
    int32_t v10; // 0x80551a5
    int32_t v11; // 0x80551a5
    int32_t v12; // 0x80551a5
    int32_t v13; // 0x80551a5
    char v14; // 0x80551a5
    char v15; // 0x80551a5
    int32_t v16; // 0x80551a5
    int32_t v17; // 0x80551a5
    while (true) {
      lab_0x80552e7_2:
        // 0x80552e7
        v13 = v12;
        v10 = v7;
        v15 = v6;
        v17 = v5;
        if (v15 == 0) {
            int32_t v18 = LYReadCmdKey(3); // 0x8055305
            v16 = v17;
            v14 = 0;
            v9 = v10;
            v11 = v13;
            v8 = false;
            if (EditBinding(v18) != 1) {
                goto lab_0x80552e7;
            } else {
                goto lab_0x805532c;
            }
        } else {
            // 0x80552fe
            LYRefreshEdit(&v4);
            v8 = true;
            LYReadCmdKey(3);
            goto lab_0x805532c;
        }
    }
  lab_0x8055379:;
    // 0x8055379
    int32_t v19; // bp-17416, 0x80551a5
    LYstrncpy(inputline, (char *)&v19, bufsize);
    LYAddToCloset(recall, (char *)&v19);
    int32_t v20; // 0x80551a5
    int32_t v21 = v20; // 0x80553bc
    if (WWW_TraceFlag != 0) {
        // 0x80553be
        fprintf(TraceFP(), "LYgetstr(%s) recall\n", inputline);
        v21 = v20;
    }
    goto lab_0x8055ac1;
  lab_0x80552e7:
    // 0x80552e7
    v5 = v16;
    v6 = v14;
    v7 = v9;
    v12 = v11;
    goto lab_0x80552e7_2;
  lab_0x805532c:;
    bool v22 = v8;
    if (term_letter != 0) {
        // 0x805534d
        goto lab_0x8055357;
    } else {
        // 0x8055337
        if ((term_message || term_options) == 0) {
            goto lab_0x8055357;
        } else {
            // 0x805534d
            goto lab_0x8055357;
        }
    }
  lab_0x8055357:
    // 0x8055357
    v20 = 7;
    if (recall != 0) {
        if (v20 != 256 != v20 != 257) {
            // break -> 0x8055379
            goto lab_0x8055379;
        }
    }
    int32_t v23 = v20 | v13; // 0x80553f6
    int32_t v24 = v23; // 0x805540d
    if (v17 != -1) {
        // 0x805540f
        v24 = v23 != v17 ? v23 : v23 | 0x1000;
    }
    int32_t v25 = v24;
    bool v26; // 0x80551a5
    if (v25 != -1) {
        if ((v25 & 0x8800) == 0) {
            // 0x8055474
            v26 = *(int16_t *)((2 * v25 & 4094) + 0x8197ea2) == 21;
        } else {
            // 0x805545d
            v26 = v25 % 256 == 21;
        }
    } else {
        // 0x805543a
        v26 = keymap[0] == 21;
    }
    // 0x80554a2
    v16 = -1;
    v14 = v15;
    v9 = v10;
    v11 = 0;
    int32_t v27; // 0x80551a5
    if (v26) {
        goto lab_0x80552e7;
    } else {
        int32_t v28 = EditBinding(v25); // 0x80554c4
        int32_t v29 = -1; // 0x80554dc
        int32_t v30 = v28; // 0x80554dc
        if ((char)v28 <= 255) {
            // 0x80554de
            v30 = (v28 & 0x1000) != 0 ? v28 : v28 & -129;
            v29 = (v28 & 0x1000) != 0 ? -1 : v25;
        }
        int32_t v31 = v30;
        v27 = v29;
        g395 = v31;
        v16 = v27;
        v14 = v15;
        v9 = v31;
        v11 = 0;
        switch (v31) {
            case 2: {
                // 0x8055788
                LYstrncpy(inputline, (char *)&v19, bufsize);
                if (hidden == 0) {
                    // 0x80557b0
                    LYAddToCloset(recall, (char *)&v19);
                }
                // 0x80557c8
                v21 = v25;
                if (WWW_TraceFlag != 0) {
                    // 0x80557d3
                    fprintf(TraceFP(), "LYgetstr(%s) LYE_ENTER\n", inputline);
                    v21 = v25;
                }
                goto lab_0x8055ac1;
            }
            case 3: {
                if (recall == 0 || v10 != 3) {
                    char * v32 = LYFindInCloset(recall, (char *)&v19); // 0x805576c
                    reinsertEdit(&v4, v32);
                    v16 = v27;
                    v14 = v15;
                    v9 = 3;
                    v11 = 0;
                } else {
                    int32_t * v33 = whichRecall(recall); // 0x8055577
                    v16 = v27;
                    v14 = v15;
                    v9 = 3;
                    v11 = 0;
                    if (v33 != NULL) {
                        // 0x805558f
                        v16 = v27;
                        v14 = v15;
                        v9 = 3;
                        v11 = 0;
                        if (*(int32_t *)((int32_t)v33 + 4) != 0) {
                            char ** v34 = sortedList(v33, (char)(recall == 2)); // 0x80555b7
                            int32_t v35 = (int32_t)v34; // 0x80555b7
                            int32_t v36 = LYarrayLength(v34); // 0x80555d5
                            int32_t v37 = 0; // 0x80555f5
                            if (v36 > 0) {
                                int32_t v38 = 0;
                                int32_t v39 = *(int32_t *)(4 * v38 + v35); // 0x8055606
                                uint32_t v40 = strcasecomp((char *)v39, (char *)&v19); // 0x8055618
                                v37 = v38;
                                while (v40 < 0) {
                                    int32_t v41 = v38 + 1; // 0x80555e2
                                    int32_t v42 = v41; // 0x80555f5
                                    v37 = v41;
                                    if (v41 >= v36) {
                                        // break -> 0x8055621
                                        break;
                                    }
                                    v38 = v42;
                                    v39 = *(int32_t *)(4 * v38 + v35);
                                    v40 = strcasecomp((char *)v39, (char *)&v19);
                                    v37 = v38;
                                }
                            }
                            int32_t * v43 = LYwin;
                            int32_t v44 = v43 == NULL ? -1 : (int32_t)*(int16_t *)&g255;
                            uint32_t v45 = LYhandlePopupList(v37, 0, v44, v34, -1, -1, 0, 0); // 0x80556c7
                            if (v45 >= 0) {
                                if (recall == 2) {
                                    // 0x80556e1
                                    mustshow = 1;
                                    statusline(": ");
                                }
                                // 0x80556f4
                                reinsertEdit(&v4, (char *)*(int32_t *)(4 * v45 + v35));
                            }
                            // 0x8055717
                            LYmove(v43 == NULL ? -1 : 0x10000 * (int32_t)v43 >> 16, v44);
                            v16 = v27;
                            v14 = v15;
                            v9 = 3;
                            v11 = 0;
                            if (v34 != NULL) {
                                // 0x805573c
                                free((int32_t *)v34);
                                v16 = v27;
                                v14 = v15;
                                v9 = 3;
                                v11 = 0;
                            }
                        }
                    }
                }
                goto lab_0x80552e7;
            }
            case 4: {
                // 0x80559c4
                if (WWW_TraceFlag != 0) {
                    // 0x80559cf
                    fprintf(TraceFP(), "LYgetstr LYE_STOP\n");
                }
                // 0x80559e6
                textfields_need_activation = 1;
                v21 = -1;
                goto lab_0x8055ac1;
            }
            case 5: {
                // 0x805598a
                *inputline = 0;
                v21 = -1;
                if (WWW_TraceFlag != 0) {
                    // 0x805599e
                    fprintf(TraceFP(), "LYgetstr LYE_ABORT\n");
                    v21 = -1;
                }
                goto lab_0x8055ac1;
            }
            case 6: {
                goto lab_0x80552e7;
            }
            case 23: {
                goto lab_0x80552e7;
            }
            case 29: {
                // 0x805552d
                v16 = v27;
                v14 = v15;
                v9 = 29;
                v11 = 0x4000;
                goto lab_0x80552e7;
            }
            case 30: {
                // 0x8055541
                v16 = v27;
                v14 = v15;
                v9 = 30;
                v11 = 0x2000;
                goto lab_0x80552e7;
            }
            case 37: {
                char * str = get_clip_grab(); // 0x8055805
                v16 = v27;
                v14 = v15;
                v9 = 37;
                v11 = 0;
                if (str == NULL) {
                    goto lab_0x80552e7;
                } else {
                    int32_t v46 = (int32_t)str;
                    int32_t len = strlen(str); // 0x8055826
                    uint32_t v47 = len + v46; // 0x8055837
                    char * v48 = str; // 0x805584a
                    char * v49 = str; // 0x805584a
                    int32_t v50 = v46; // 0x805584a
                    if (len > 0 == v47 > v46) {
                        while (true) {
                            int32_t v51 = v50;
                            char * v52 = v49; // 0x8055878
                            char * v53 = v48;
                            unsigned char v54 = *v53; // 0x8055867
                            char * v55; // 0x80551a5
                            char * v56; // 0x80551a5
                            if (v54 < 32) {
                                char v57 = v54; // 0x805587e
                                if (v53 > v52) {
                                    // 0x8055880
                                    LYEditInsert(&v4, v52, v51 - (int32_t)v52, 0, 1);
                                    v57 = *v53;
                                }
                                // 0x80558be
                                if (v57 != 9) {
                                    // break -> 0x8055980
                                    break;
                                }
                                // 0x80558d7
                                LYEditInsert(&v4, " ", 1, 0, 1);
                                char * v58 = (char *)((int32_t)v53 + 1); // 0x8055906
                                v55 = v58;
                                v56 = v58;
                            } else {
                                // 0x805591b
                                v55 = (char *)(v51 + 1);
                                v56 = v52;
                            }
                            char * v59 = v56;
                            char * v60 = v55; // 0x8055922
                            int32_t v61 = (int32_t)v60;
                            v48 = v60;
                            v49 = v59;
                            v50 = v61;
                            if (v47 <= v61) {
                                if (v60 > v59) {
                                    // 0x8055942
                                    LYEditInsert(&v4, v59, v61 - (int32_t)v59, 0, 1);
                                    goto lab_0x8055980;
                                } else {
                                    goto lab_0x8055980;
                                }
                            }
                        }
                    }
                    goto lab_0x8055980;
                }
            }
            default: {
                // 0x80559fc
                v16 = v27;
                v14 = v15;
                v9 = v31;
                v11 = 0;
                if ((v31 & 0x1000) == 0) {
                    int32_t v62 = EditBinding(v25); // 0x8055a18
                    if (LYEdit1(&v4, v25, v62 & -129, 0) != 0) {
                        // 0x8055a89
                        v16 = v27;
                        v14 = v15;
                        v9 = v31;
                        v11 = 0;
                        if (!v22) {
                            // 0x8055a96
                            LYEdit1(&v4, 0, 9, 0);
                            v16 = v27;
                            v14 = v15;
                            v9 = v31;
                            v11 = 0;
                        }
                    } else {
                        // 0x8055a47
                        v16 = v27;
                        v14 = v25 > 254 | v15 == 0 | HTCJK == 0;
                        v9 = v31;
                        v11 = 0;
                    }
                }
                goto lab_0x80552e7;
            }
        }
    }
  lab_0x8055980:
    // 0x8055980
    get_clip_release();
    v16 = v27;
    v14 = v15;
    v9 = 37;
    v11 = 0;
    goto lab_0x80552e7;
  lab_0x8055ac1:;
    int32_t result = v21; // 0x8055ad1
    if (v1 != __readgsdword(20)) {
        // 0x8055ad3
        __stack_chk_fail();
        result = &g391;
    }
    // 0x8055ad8
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8055ada - 0x8055beb
// Line range:    5256 - 5277
char * LYLineeditHelpURL(void) {
    // 0x8055ada
    if (g93 == current_lineedit) {
        // 0x8055be2
        return (char *)&g92;
    }
    // 0x8055afc
    if (g93 == -1) {
        // 0x8055b06
        LYstrncpy((char *)&g92, (char *)helpfilepath, 255);
        int32_t len = strlen((char *)&g92); // 0x8055b30
        *(int32_t *)&g91 = len + (int32_t)g91;
    }
    int32_t v1 = *(int32_t *)(4 * current_lineedit + (int32_t)&LYLineeditHelpURLs); // 0x8055b42
    if (v1 == 0) {
        // 0x8055be2
        return NULL;
    }
    char * str = (char *)v1; // 0x8055b5d
    if (*str == 0) {
        // 0x8055be2
        return NULL;
    }
    uint32_t len2 = strlen(str); // 0x8055b73
    int32_t v2 = (int32_t)g91; // 0x8055b7a
    char * result = NULL; // 0x8055b8f
    if (len2 <= (int32_t)&g92 + 256 - v2) {
        int32_t v3 = *(int32_t *)(4 * current_lineedit + (int32_t)&LYLineeditHelpURLs); // 0x8055bab
        LYstrncpy((char *)g91, (char *)v3, (int32_t)&g92 + 255 - v2);
        g93 = current_lineedit;
        result = (char *)&g92;
    }
    // 0x8055be2
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8055beb - 0x8055c56
// Line range:    5284 - 5299
char * LYstrsep(char ** stringp, char * delim) {
    // 0x8055beb
    if (stringp == NULL) {
        // 0x8055c51
        return NULL;
    }
    char * str = *stringp;
    if (str == NULL) {
        // 0x8055c51
        return NULL;
    }
    char * found_byte_pos = strpbrk(str, delim); // 0x8055c20
    int32_t v1 = 0; // 0x8055c2c
    if (found_byte_pos != NULL) {
        // 0x8055c2e
        *found_byte_pos = 0;
        v1 = (int32_t)found_byte_pos + 1;
    }
    // 0x8055c4b
    *(int32_t *)stringp = v1;
    // 0x8055c51
    return str;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8055c56 - 0x8055cd6
// Line range:    5308 - 5319
char * LYstrstr(char * chptr, char * tarptr) {
    int32_t len = strlen(tarptr); // 0x8055c62
    char v1 = *chptr; // 0x8055cc3
    if (v1 == 0) {
        // 0x8055cd1
        return NULL;
    }
    char * v2 = (char *)((int32_t)chptr + 1);
    if (UPPER8((int32_t)v1, (int32_t)*tarptr) == 0) {
        // 0x8055c8e
        if (strncasecomp8(v2, (char *)((int32_t)tarptr + 1), len - 1) == 0) {
            // break -> 0x8055cd1
            break;
        }
    }
    char v3 = *v2; // 0x8055cc3
    char * result = NULL; // 0x8055cc8
    while (v3 != 0) {
        char * v4 = v2;
        v2 = (char *)((int32_t)v4 + 1);
        if (UPPER8((int32_t)v3, (int32_t)*tarptr) == 0) {
            // 0x8055c8e
            result = v4;
            if (strncasecomp8(v2, (char *)((int32_t)tarptr + 1), len - 1) == 0) {
                // break -> 0x8055cd1
                break;
            }
        }
        // 0x8055cbc
        v3 = *v2;
        result = NULL;
    }
    // 0x8055cd1
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8055cd6 - 0x8055de5
// Line range:    5334 - 5372
char * LYno_attr_char_case_strstr(char * chptr, char * tarptr) {
    // 0x8055cd6
    if (chptr == NULL) {
        // 0x8055de0
        return NULL;
    }
    char v1 = *chptr; // 0x8055cf5
    int32_t v2 = (int32_t)chptr; // 0x8055cfa
    char v3 = v1; // 0x8055cfa
    char * v4 = chptr; // 0x8055cfa
    if (v1 < 9 == (v1 != 0)) {
        int32_t v5 = (int32_t)chptr + 1; // 0x8055cee
        char * v6 = (char *)v5;
        char v7 = *v6; // 0x8055cf5
        v2 = v5;
        v3 = v7;
        v4 = v6;
        while (v7 < 9 == (v7 != 0)) {
            // 0x8055cee
            v5 = (int32_t)v6 + 1;
            v6 = (char *)v5;
            v7 = *v6;
            v2 = v5;
            v3 = v7;
            v4 = v6;
        }
    }
    // 0x8055dcb
    if (v3 == 0) {
        // 0x8055de0
        return NULL;
    }
    char * v8 = (char *)((int32_t)tarptr + 1);
    int32_t v9 = v2; // 0x8055cd6
    char * v10 = v4;
    char v11 = v3; // 0x8055dce
    int32_t v12; // 0x8055cd6
    while (true) {
        char * v13 = v10; // 0x8055dc7
        int32_t v14; // 0x8055cd6
        char * v15; // 0x8055cd6
        char * result; // 0x8055cd6
        if (UPPER8((int32_t)v11, (int32_t)*tarptr) != 0) {
            int32_t v16 = (int32_t)v13 + 1; // 0x8055dc7
            v15 = (char *)v16;
            v14 = v16;
        } else {
            // 0x8055d43
            v12 = v9;
            char v17 = *v8; // 0x8055d58
            if (v17 == 0) {
                // break -> 0x8055d5f
                break;
            }
            int32_t v18 = (int32_t)v13 + 1;
            char * v19 = (char *)v18;
            char * v20 = v19;
            char v21 = *v19; // 0x8055d6a
            char v22 = v17;
            char v23 = v22; // 0x8055d6f
            char * v24 = v8; // 0x8055d6f
            if (v21 >= 9) {
                // 0x8055d7b
                if (UPPER8((int32_t)v21, (int32_t)v22) != 0) {
                    // break -> 0x8055dc7
                    break;
                }
                // 0x8055d9d
                v24 = (char *)((int32_t)v8 + 1);
                v23 = *v24;
            }
            char v25 = v23; // 0x8055dae
            if (v25 == 0) {
                // 0x8055db5
                result = (char *)v12;
                return result;
            }
            // 0x8055dbd
            v20 = (char *)((int32_t)v20 + 1);
            char v26 = *v20; // 0x8055dc0
            v15 = v19;
            v14 = v18;
            while (v26 != 0) {
                char * v27 = v24;
                char * v28 = v20;
                v21 = v26;
                v22 = v25;
                v23 = v22;
                v24 = v27;
                if (v21 >= 9) {
                    // 0x8055d7b
                    v15 = v19;
                    v14 = v18;
                    if (UPPER8((int32_t)v21, (int32_t)v22) != 0) {
                        // break -> 0x8055dc7
                        break;
                    }
                    // 0x8055d9d
                    v24 = (char *)((int32_t)v27 + 1);
                    v23 = *v24;
                }
                // 0x8055dab
                v25 = v23;
                if (v25 == 0) {
                    // 0x8055db5
                    result = (char *)v12;
                    return result;
                }
                // 0x8055dbd
                v20 = (char *)((int32_t)v28 + 1);
                v26 = *v20;
                v15 = v19;
                v14 = v18;
            }
        }
        // 0x8055dc7
        v10 = v15;
        v11 = *v10;
        v9 = v14;
        result = NULL;
        if (v11 == 0) {
          lab_0x8055de0:
            // 0x8055de0
            return result;
        }
    }
    // 0x8055de0
    return (char *)v12;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8055de5 - 0x8055ecc
// Line range:    5387 - 5425
char * LYno_attr_char_strstr(char * chptr, char * tarptr) {
    // 0x8055de5
    if (chptr == NULL) {
        // 0x8055ec7
        return NULL;
    }
    char v1 = *chptr; // 0x8055e04
    int32_t v2 = (int32_t)chptr; // 0x8055e09
    char v3 = v1; // 0x8055e09
    char * v4 = chptr; // 0x8055e09
    if (v1 < 9 == (v1 != 0)) {
        int32_t v5 = (int32_t)chptr + 1; // 0x8055dfd
        char * v6 = (char *)v5;
        char v7 = *v6; // 0x8055e04
        v2 = v5;
        v3 = v7;
        v4 = v6;
        while (v7 < 9 == (v7 != 0)) {
            // 0x8055dfd
            v5 = (int32_t)v6 + 1;
            v6 = (char *)v5;
            v7 = *v6;
            v2 = v5;
            v3 = v7;
            v4 = v6;
        }
    }
    // 0x8055eb2
    if (v3 == 0) {
        // 0x8055ec7
        return NULL;
    }
    char * v8 = (char *)((int32_t)tarptr + 1);
    int32_t v9 = v2; // 0x8055de5
    char v10 = v3; // 0x8055eb5
    char * v11 = v4; // 0x8055de5
    int32_t v12; // 0x8055de5
    while (true) {
        char * v13 = v11; // 0x8055eae
        int32_t v14; // 0x8055de5
        char v15; // 0x8055de5
        char * result; // 0x8055de5
        if (v10 != *tarptr) {
            int32_t v16 = (int32_t)v13 + 1; // 0x8055eae
            char * v17 = (char *)v16; // 0x8055eae
            v15 = *v17;
            v11 = v17;
            v14 = v16;
        } else {
            // 0x8055e3c
            v12 = v9;
            char v18 = *v8; // 0x8055e51
            if (v18 == 0) {
                // break -> 0x8055e58
                break;
            }
            int32_t v19 = (int32_t)v13 + 1;
            char * v20 = (char *)v19;
            char v21 = *v20;
            char * v22 = v20;
            char v23 = v21; // 0x8055e63
            char v24 = v18;
            char v25 = v24; // 0x8055e68
            char * v26 = v8; // 0x8055e68
            if (v23 >= 9) {
                // 0x8055e74
                if (v23 != v24) {
                    // break -> 0x8055eae
                    break;
                }
                // 0x8055e84
                v26 = (char *)((int32_t)v8 + 1);
                v25 = *v26;
            }
            char v27 = v25; // 0x8055e95
            if (v27 == 0) {
                // 0x8055e9c
                result = (char *)v12;
                return result;
            }
            // 0x8055ea4
            v22 = (char *)((int32_t)v22 + 1);
            char v28 = *v22; // 0x8055ea7
            v15 = v21;
            v11 = v20;
            v14 = v19;
            while (v28 != 0) {
                char * v29 = v26;
                char * v30 = v22;
                v23 = v28;
                v24 = v27;
                v25 = v24;
                v26 = v29;
                if (v23 >= 9) {
                    // 0x8055e74
                    v15 = v21;
                    v11 = v20;
                    v14 = v19;
                    if (v23 != v24) {
                        // break -> 0x8055eae
                        break;
                    }
                    // 0x8055e84
                    v26 = (char *)((int32_t)v29 + 1);
                    v25 = *v26;
                }
                // 0x8055e92
                v27 = v25;
                if (v27 == 0) {
                    // 0x8055e9c
                    result = (char *)v12;
                    return result;
                }
                // 0x8055ea4
                v22 = (char *)((int32_t)v30 + 1);
                v28 = *v22;
                v15 = v21;
                v11 = v20;
                v14 = v19;
            }
        }
        // 0x8055eae
        v10 = v15;
        v9 = v14;
        result = NULL;
        if (v10 == 0) {
          lab_0x8055ec7:
            // 0x8055ec7
            return result;
        }
    }
    // 0x8055ec7
    return (char *)v12;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8055ecc - 0x805628e
// Line range:    5454 - 5586
char * LYno_attr_mbcs_case_strstr(char * chptr, char * tarptr, char utf_flag, char count_gcells, int32_t * nstartp, int32_t * nendp) {
    // 0x8055ecc
    if (chptr != NULL != tarptr != NULL) {
        // 0x8056289
        return NULL;
    }
    char v1 = *chptr; // 0x8055f04
    int32_t v2 = (int32_t)chptr; // 0x8055f09
    char v3 = v1; // 0x8055f09
    char * v4 = chptr; // 0x8055f09
    if (v1 < 9 == (v1 != 0)) {
        int32_t v5 = (int32_t)chptr + 1; // 0x8055efd
        char * v6 = (char *)v5;
        char v7 = *v6; // 0x8055f04
        v2 = v5;
        v3 = v7;
        v4 = v6;
        while (v7 < 9 == (v7 != 0)) {
            // 0x8055efd
            v5 = (int32_t)v6 + 1;
            v6 = (char *)v5;
            v7 = *v6;
            v2 = v5;
            v3 = v7;
            v4 = v6;
        }
    }
    // 0x8056274
    if (v3 == 0) {
        // 0x8056289
        return NULL;
    }
    int32_t v8 = (int32_t)tarptr;
    char * v9 = (char *)(v8 + 1);
    char * v10 = (char *)(v8 + 2);
    int32_t v11 = count_gcells != 0;
    char * v12 = NULL; // 0x8055ecc
    int32_t v13 = v2; // 0x8056270
    int32_t v14 = 0; // 0x8055ecc
    char v15 = v3; // 0x8056277
    char * v16 = v4; // 0x8056270
    char v17; // 0x8055ecc
    char * v18; // 0x8055ecc
    int32_t v19; // 0x8055ecc
    int32_t v20; // 0x8055ecc
    int32_t v21; // 0x8055ecc
    char v22; // 0x8055f88
    char * v23; // 0x805620a
    char * v24; // 0x8056268
    while (true) {
      lab_0x8055f2c:
        // 0x8055f2c
        v23 = v16;
        v22 = v15;
        v21 = v14;
        v20 = v13;
        v24 = v12;
        v17 = *tarptr;
        if (utf_flag == 0 == v22 < 0 != (v22 == v17) || HTCJK == 0) {
            goto lab_0x8055f7c;
        } else {
            int32_t v25 = (int32_t)v23;
            char * v26 = (char *)(v25 + 1);
            v18 = v26;
            v19 = v25;
            switch (*v26) {
                case 8: {
                    goto lab_0x8055f7c;
                }
                case 7: {
                    goto lab_0x8055f7c;
                }
                case 6: {
                    goto lab_0x8055f7c;
                }
                case 5: {
                    goto lab_0x8055f7c;
                }
                case 4: {
                    goto lab_0x8055f7c;
                }
                case 3: {
                    goto lab_0x8055f7c;
                }
                case 0: {
                    goto lab_0x8055f7c;
                }
                default: {
                    goto lab_0x8055fa2;
                }
            }
        }
    }
  lab_0x8055fcf:
    if (nstartp != NULL) {
        // 0x8055fd5
        *nstartp = v21;
    }
    int32_t v27; // 0x8055faf
    if (nendp != NULL) {
        // 0x8055fe3
        *nendp = v27;
    }
  lab_0x8056289:
    // 0x8056289
    return (char *)v20;
  lab_0x80561a5:;
    // 0x80561a5
    int32_t v28; // 0x8055ecc
    int32_t v29 = v28;
    char v30; // 0x8055ecc
    if (v30 == 0) {
        if (nstartp == NULL) {
            goto lab_0x80561bd;
        } else {
            // 0x80561b5
            *nstartp = v21;
            goto lab_0x80561bd;
        }
    }
    // 0x80561dc
    char * v31; // 0x8055ecc
    char * v32 = (char *)((int32_t)v31 + 1);
    char v33 = *v32; // 0x80561df
    char v34 = v30; // 0x80561e4
    char v35 = v33; // 0x80561e4
    int32_t v36 = v29; // 0x80561e4
    char * v37 = v32; // 0x80561e4
    char * v38; // 0x8055ecc
    char * v39 = v38; // 0x80561e4
    char * v40 = v23; // 0x80561e4
    char * v41; // 0x8055faf
    v12 = v41;
    v14 = v27;
    if (v33 == 0) {
        // break -> 0x8056270
        goto lab_0x8056270_2;
    }
    goto lab_0x80560c1;
  lab_0x8056193:;
    // 0x8056193
    char * v47; // 0x8055ecc
    char * v50 = v47; // 0x8056193
    char * v48; // 0x8055ecc
    char * v51 = v48; // 0x8056193
    int32_t v49; // 0x8055ecc
    int32_t v52 = v49 + 1; // 0x8056193
    goto lab_0x8056197;
  lab_0x8056197:;
    char * v56 = (char *)((int32_t)v50 + 1); // 0x805619b
    v30 = *v56;
    v28 = v52;
    v31 = v51;
    v38 = v56;
    goto lab_0x80561a5;
  lab_0x8055f7c:;
    // 0x8055f7c
    char * v57; // 0x8055ecc
    char * v58; // 0x8055ecc
    if (UPPER8((int32_t)v22, (int32_t)v17) != 0) {
        char v59 = *v23;
        v40 = v23;
        v12 = v24;
        v14 = v21;
        if (v59 < 9 || (v59 & -64) == -128 == (utf_flag != 0)) {
            goto lab_0x8056270_2;
        } else {
            // 0x805621e
            v57 = v23;
            v58 = v24;
            if (utf_flag == 0 != v59 < 0 || HTCJK == 0) {
                goto lab_0x805626c;
            } else {
                char * v60 = (char *)((int32_t)v23 + 1); // 0x805623d
                v57 = v23;
                v58 = v24;
                switch (*v60) {
                    case 8: {
                        goto lab_0x805626c;
                    }
                    case 7: {
                        goto lab_0x805626c;
                    }
                    case 6: {
                        goto lab_0x805626c;
                    }
                    case 5: {
                        goto lab_0x805626c;
                    }
                    case 4: {
                        goto lab_0x805626c;
                    }
                    case 3: {
                        goto lab_0x805626c;
                    }
                    case 0: {
                        goto lab_0x805626c;
                    }
                    default: {
                        // 0x805625e
                        v57 = v60;
                        v58 = v24;
                        if (count_gcells != 0) {
                            // 0x8056268
                            v57 = v60;
                            v58 = (char *)((int32_t)v24 + 1);
                        }
                        goto lab_0x805626c;
                    }
                }
            }
        }
    } else {
        int32_t v61 = (int32_t)v23; // 0x8055fb3
        v18 = (char *)(v61 + 1);
        v19 = v61;
        goto lab_0x8055fa2;
    }
  lab_0x8055fa2:
    // 0x8055fa2
    v27 = v21 + 1;
    char v62 = *v9; // 0x8055fc8
    if (v62 == 0) {
        // break -> 0x8055fcf
        goto lab_0x8055fcf;
    }
    char * v63 = v18;
    v41 = (char *)v27;
    char v64 = v62; // 0x8055ffa
    int32_t v65 = 0; // 0x8055ffa
    char * v66 = v63; // 0x8055ffa
    char * v67 = v9; // 0x8055ffa
    if (utf_flag != 0 || HTCJK == 0) {
        goto lab_0x80560c1_2;
    } else {
        char v68 = *v23; // 0x8056010
        v64 = v62;
        v65 = 0;
        v66 = v63;
        v67 = v9;
        if (v68 >= 0) {
            goto lab_0x80560c1_2;
        } else {
            // 0x805601b
            v64 = v62;
            v65 = 0;
            v66 = v63;
            v67 = v9;
            if (v68 != *tarptr) {
                goto lab_0x80560c1_2;
            } else {
                char v69 = *v63; // 0x8056032
                v64 = v62;
                v65 = 0;
                v66 = v63;
                v67 = v9;
                switch (v69) {
                    case 8: {
                        goto lab_0x80560c1_2;
                    }
                    case 7: {
                        goto lab_0x80560c1_2;
                    }
                    case 6: {
                        goto lab_0x80560c1_2;
                    }
                    case 5: {
                        goto lab_0x80560c1_2;
                    }
                    case 4: {
                        goto lab_0x80560c1_2;
                    }
                    case 3: {
                        goto lab_0x80560c1_2;
                    }
                    case 0: {
                        goto lab_0x80560c1_2;
                    }
                    default: {
                        if (v69 != v62) {
                            // 0x80560aa
                            v40 = v63;
                            v12 = v41;
                            v14 = v27;
                            if (count_gcells != 0) {
                                int32_t v70 = v21 + 2; // 0x80560b8
                                v40 = v63;
                                v12 = (char *)v70;
                                v14 = v70;
                            }
                            goto lab_0x8056270_2;
                        } else {
                            char v71 = *v10; // 0x8056076
                            v64 = v71;
                            v65 = v11;
                            v66 = (char *)(v19 + 2);
                            v67 = v10;
                            if (v71 == 0) {
                                if (nstartp == NULL) {
                                    goto lab_0x805608b;
                                } else {
                                    // 0x8056083
                                    *nstartp = v21;
                                    goto lab_0x805608b;
                                }
                            }
                            goto lab_0x80560c1_2;
                        }
                    }
                }
            }
        }
    }
  lab_0x8056270_2:
    // 0x8056270
    v13 = (int32_t)v40 + 1;
    v16 = (char *)v13;
    v15 = *v16;
    if (v15 == 0) {
        // 0x8056289
        return NULL;
    }
    goto lab_0x8055f2c;
  lab_0x80560c1_2:
    // 0x80560c1
    v34 = v64;
    v35 = *v66;
    v36 = v65;
    v37 = v66;
    v39 = v67;
    while (true) {
      lab_0x80560c1:;
        char * v42 = v39;
        char * v43 = v37;
        int32_t v44 = v36;
        char v45 = v35; // 0x805615e
        char v46 = v34;
        v30 = v46;
        v28 = v44;
        v31 = v43;
        v38 = v42;
        if (v45 < 9) {
            goto lab_0x80561a5;
        } else {
            // 0x80560d9
            if (utf_flag == 0 != v45 < 0 || HTCJK == 0) {
                // 0x8056152
                v40 = v23;
                v12 = v41;
                v14 = v27;
                if (UPPER8((int32_t)v45, (int32_t)v46) != 0) {
                    // break -> 0x8056270
                    break;
                }
                // 0x8056178
                v47 = v42;
                v48 = v43;
                v49 = v44;
                if (utf_flag == 0) {
                    goto lab_0x8056193;
                } else {
                    // 0x805617e
                    v47 = v42;
                    v48 = v43;
                    v49 = v44;
                    v50 = v42;
                    v51 = v43;
                    v52 = v44;
                    if ((*v42 & -64) == -128) {
                        goto lab_0x8056197;
                    } else {
                        goto lab_0x8056193;
                    }
                }
            } else {
                // 0x80560f2
                v40 = v23;
                v12 = v41;
                v14 = v27;
                if (v45 != v46) {
                    // break -> 0x8056270
                    break;
                }
                char * v53 = (char *)((int32_t)v43 + 1); // 0x805610c
                char v54 = *v53; // 0x805610c
                char * v55 = (char *)((int32_t)v42 + 1); // 0x8056115
                v40 = v23;
                v12 = v41;
                v14 = v27;
                if (v54 < 9 | v54 != *v55) {
                    // break -> 0x8056270
                    break;
                }
                // 0x8056178
                v47 = v55;
                v48 = v53;
                v49 = v44 + v11;
                goto lab_0x8056193;
            }
        }
    }
    goto lab_0x8056270_2;
  lab_0x805626c:;
    int32_t v72 = (int32_t)v58 + 1; // 0x805626c
    v40 = v57;
    v12 = (char *)v72;
    v14 = v72;
    goto lab_0x8056270_2;
  lab_0x80561bd:
    if (nendp == NULL) {
        // 0x80561d1
        goto lab_0x8056289;
    } else {
        // 0x80561c3
        *nendp = v29 + v27;
        // 0x80561d1
        goto lab_0x8056289;
    }
  lab_0x805608b:
    if (nendp == NULL) {
        // 0x805609f
        goto lab_0x8056289;
    } else {
        // 0x8056091
        *nendp = v27 + v11;
        // 0x805609f
        goto lab_0x8056289;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x805628e - 0x80565c8
// Line range:    5617 - 5744
char * LYno_attr_mbcs_strstr(char * chptr, char * tarptr, char utf_flag, char count_gcells, int32_t * nstartp, int32_t * nendp) {
    // 0x805628e
    if (chptr != NULL != tarptr != NULL) {
        // 0x80565c3
        return NULL;
    }
    char v1 = *chptr; // 0x80562c6
    int32_t v2 = (int32_t)chptr; // 0x80562cb
    char v3 = v1; // 0x80562cb
    char * v4 = chptr; // 0x80562cb
    if (v1 < 9 == (v1 != 0)) {
        int32_t v5 = (int32_t)chptr + 1; // 0x80562bf
        char * v6 = (char *)v5;
        char v7 = *v6; // 0x80562c6
        v2 = v5;
        v3 = v7;
        v4 = v6;
        while (v7 < 9 == (v7 != 0)) {
            // 0x80562bf
            v5 = (int32_t)v6 + 1;
            v6 = (char *)v5;
            v7 = *v6;
            v2 = v5;
            v3 = v7;
            v4 = v6;
        }
    }
    // 0x80565ae
    if (v3 == 0) {
        // 0x80565c3
        return NULL;
    }
    int32_t v8 = (int32_t)tarptr;
    char * v9 = (char *)(v8 + 1);
    char * v10 = (char *)(v8 + 2);
    int32_t v11 = count_gcells != 0;
    char * v12 = NULL; // 0x805628e
    int32_t v13 = v2; // 0x805628e
    int32_t v14 = 0; // 0x805628e
    char v15 = v3; // 0x80565b1
    char * v16 = v4; // 0x80565aa
    char * v17; // 0x805628e
    char * v18; // 0x805628e
    char * v19; // 0x805628e
    char * v20; // 0x805628e
    char v21; // 0x805628e
    int32_t v22; // 0x805628e
    int32_t v23; // 0x805628e
    char * v24; // 0x8056313
    int32_t v25; // 0x805628e
    char * v26; // 0x805628e
    char * v27; // 0x805628e
    char * v28; // 0x805630f
    int32_t v29; // 0x805630f
    while (true) {
      lab_0x80562ee:
        // 0x80562ee
        v24 = v16;
        char v30 = v15; // 0x8056370
        v23 = v14;
        if (v30 != *tarptr) {
            char * v31 = v12; // 0x80565a2
            v19 = v24;
            v20 = v31;
            v14 = v23;
            if (v30 < 9 || utf_flag != 0 == (v30 & -64) == -128) {
                goto lab_0x80565aa_2;
            } else {
                // 0x8056558
                v17 = v24;
                v18 = v31;
                if (utf_flag == 0 != v30 < 0 || HTCJK == 0) {
                    goto lab_0x80565a6;
                } else {
                    char * v32 = (char *)((int32_t)v24 + 1); // 0x8056577
                    v17 = v24;
                    v18 = v31;
                    switch (*v32) {
                        case 8: {
                            goto lab_0x80565a6;
                        }
                        case 7: {
                            goto lab_0x80565a6;
                        }
                        case 6: {
                            goto lab_0x80565a6;
                        }
                        case 5: {
                            goto lab_0x80565a6;
                        }
                        case 4: {
                            goto lab_0x80565a6;
                        }
                        case 3: {
                            goto lab_0x80565a6;
                        }
                        case 0: {
                            goto lab_0x80565a6;
                        }
                        default: {
                            // 0x8056598
                            v17 = v32;
                            v18 = v31;
                            if (count_gcells != 0) {
                                // 0x80565a2
                                v17 = v32;
                                v18 = (char *)((int32_t)v31 + 1);
                            }
                            goto lab_0x80565a6;
                        }
                    }
                }
            }
        } else {
            // 0x8056302
            v22 = v13;
            v29 = v23 + 1;
            char v33 = *v9; // 0x8056328
            if (v33 == 0) {
                // break -> 0x805632f
                break;
            }
            // 0x8056356
            v28 = (char *)v29;
            int32_t v34 = (int32_t)v24; // 0x8056313
            char * v35 = (char *)(v34 + 1); // 0x8056319
            v21 = v33;
            v25 = 0;
            v26 = v35;
            v27 = v9;
            if (utf_flag == 0 != v30 < 0 || HTCJK == 0) {
                goto lab_0x805640d_2;
            } else {
                char v36 = *v35; // 0x805637e
                v21 = v33;
                v25 = 0;
                v26 = v35;
                v27 = v9;
                switch (v36) {
                    case 8: {
                        goto lab_0x805640d_2;
                    }
                    case 7: {
                        goto lab_0x805640d_2;
                    }
                    case 6: {
                        goto lab_0x805640d_2;
                    }
                    case 5: {
                        goto lab_0x805640d_2;
                    }
                    case 4: {
                        goto lab_0x805640d_2;
                    }
                    case 3: {
                        goto lab_0x805640d_2;
                    }
                    case 0: {
                        goto lab_0x805640d_2;
                    }
                    default: {
                        if (v36 != v33) {
                            // 0x80563f6
                            v19 = v35;
                            v20 = v28;
                            v14 = v29;
                            if (count_gcells != 0) {
                                int32_t v37 = v23 + 2; // 0x8056404
                                v19 = v35;
                                v20 = (char *)v37;
                                v14 = v37;
                            }
                            goto lab_0x80565aa_2;
                        } else {
                            char v38 = *v10; // 0x80563c2
                            v21 = v38;
                            v25 = v11;
                            v26 = (char *)(v34 + 2);
                            v27 = v10;
                            if (v38 == 0) {
                                if (nstartp == NULL) {
                                    goto lab_0x80563d7;
                                } else {
                                    // 0x80563cf
                                    *nstartp = v23;
                                    goto lab_0x80563d7;
                                }
                            }
                            goto lab_0x805640d_2;
                        }
                    }
                }
            }
        }
    }
    if (nstartp != NULL) {
        // 0x8056335
        *nstartp = v23;
    }
    if (nendp != NULL) {
        // 0x8056343
        *nendp = v29;
    }
  lab_0x80565c3:
    // 0x80565c3
    return (char *)v22;
  lab_0x80564df:;
    // 0x80564df
    int32_t v39; // 0x805628e
    int32_t v40 = v39;
    char v41; // 0x805628e
    if (v41 == 0) {
        if (nstartp == NULL) {
            goto lab_0x80564f7;
        } else {
            // 0x80564ef
            *nstartp = v23;
            goto lab_0x80564f7;
        }
    }
    // 0x8056516
    char * v42; // 0x805628e
    char * v43 = (char *)((int32_t)v42 + 1);
    char v44 = *v43; // 0x8056519
    char v45 = v41; // 0x805651e
    char v46 = v44; // 0x805651e
    int32_t v47 = v40; // 0x805651e
    char * v48 = v43; // 0x805651e
    char * v49; // 0x805628e
    char * v50 = v49; // 0x805651e
    v19 = v24;
    v20 = v28;
    v14 = v29;
    if (v44 == 0) {
        // break -> 0x80565aa
        goto lab_0x80565aa_2;
    }
    goto lab_0x805640d;
  lab_0x80564d1:;
    // 0x80564d1
    char * v59; // 0x805628e
    char * v65 = (char *)((int32_t)v59 + 1); // 0x80564d5
    v41 = *v65;
    int32_t v61; // 0x805628e
    v39 = v61;
    char * v60; // 0x805628e
    v42 = v60;
    v49 = v65;
    goto lab_0x80564df;
  lab_0x80564cd:;
    // 0x80564cd
    char * v56; // 0x805628e
    v59 = v56;
    char * v57; // 0x805628e
    v60 = v57;
    int32_t v58; // 0x805628e
    v61 = v58 + 1;
    goto lab_0x80564d1;
  lab_0x80565aa_2:;
    int32_t v66 = (int32_t)v19 + 1; // 0x80565aa
    v16 = (char *)v66;
    v15 = *v16;
    v12 = v20;
    v13 = v66;
    if (v15 == 0) {
        // 0x80565c3
        return NULL;
    }
    goto lab_0x80562ee;
  lab_0x805640d_2:
    // 0x805640d
    v45 = v21;
    v46 = *v26;
    v47 = v25;
    v48 = v26;
    v50 = v27;
    while (true) {
      lab_0x805640d:;
        char * v51 = v50;
        char * v52 = v48;
        int32_t v53 = v47;
        char v54 = v46; // 0x80564a1
        char v55 = v45;
        v41 = v55;
        v39 = v53;
        v42 = v52;
        v49 = v51;
        if (v54 < 9) {
            goto lab_0x80564df;
        } else {
            if (HTCJK == 0 || utf_flag == 0 != v54 < 0) {
                // 0x805649e
                v19 = v24;
                v20 = v28;
                v14 = v29;
                if (v54 != v55) {
                    // break -> 0x80565aa
                    break;
                }
                // 0x80564b2
                v56 = v51;
                v57 = v52;
                v58 = v53;
                v59 = v51;
                v60 = v52;
                v61 = v53;
                if ((v55 & -64) == -128 == (utf_flag != 0)) {
                    goto lab_0x80564d1;
                } else {
                    goto lab_0x80564cd;
                }
            } else {
                // 0x805643e
                v19 = v24;
                v20 = v28;
                v14 = v29;
                if (v54 != v55) {
                    // break -> 0x80565aa
                    break;
                }
                char * v62 = (char *)((int32_t)v52 + 1); // 0x8056458
                char v63 = *v62; // 0x8056458
                char * v64 = (char *)((int32_t)v51 + 1); // 0x8056461
                v19 = v24;
                v20 = v28;
                v14 = v29;
                if (v63 < 9 | v63 != *v64) {
                    // break -> 0x80565aa
                    break;
                }
                // 0x80564b2
                v56 = v64;
                v57 = v62;
                v58 = v53 + v11;
                goto lab_0x80564cd;
            }
        }
    }
    goto lab_0x80565aa_2;
  lab_0x80565a6:;
    int32_t v67 = (int32_t)v18 + 1; // 0x80565a6
    v19 = v17;
    v20 = (char *)v67;
    v14 = v67;
    goto lab_0x80565aa_2;
  lab_0x80564f7:
    if (nendp == NULL) {
        // 0x805650b
        goto lab_0x80565c3;
    } else {
        // 0x80564fd
        *nendp = v40 + v29;
        // 0x805650b
        goto lab_0x80565c3;
    }
  lab_0x80563d7:
    if (nendp == NULL) {
        // 0x80563eb
        goto lab_0x80565c3;
    } else {
        // 0x80563dd
        *nendp = v29 + v11;
        // 0x80563eb
        goto lab_0x80565c3;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x80565c8 - 0x8056682
// Line range:    5752 - 5765
char * SNACopy(char ** dest, char * src, int32_t n) {
    char * v1 = *dest; // 0x80565d1
    if (v1 != NULL) {
        // 0x80565d7
        free((int32_t *)v1);
        *(int32_t *)dest = 0;
    }
    // 0x80565ed
    if (src == NULL) {
        // 0x805667b
        return NULL;
    }
    int32_t * mem = malloc(n + 1); // 0x8056600
    *(int32_t *)dest = (int32_t)mem;
    if (mem != NULL) {
        // 0x8056652
        strncpy((char *)mem, src, n);
        *(char *)((int32_t)*dest + n) = 0;
        // 0x805667b
        return *dest;
    }
    // 0x8056615
    if (WWW_TraceFlag != 0) {
        // 0x8056620
        fprintf(TraceFP(), "Tried to malloc %d bytes\n", n);
    }
    // 0x805663e
    outofmem("./LYStrings.c", "SNACopy");
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8056797 - 0x805682d
// Line range:    5802 - 5832
int32_t UniToLowerCase(int32_t upper) {
    // 0x8056797
    if (upper >= 0 != upper != 0) {
        // 0x8056828
        return upper;
    }
    int32_t v1 = 705; // 0x80567a8
    uint32_t v2 = 0;
    int32_t result = upper; // 0x8056820
    while (v1 > v2) {
        int32_t v3 = (v1 - v2) / 2 + v2; // 0x80567cc
        int32_t v4 = 4 * v3; // 0x80567d5
        uint16_t v5 = *(int16_t *)(v4 + (int32_t)&unicode_to_lower_case); // 0x80567d5
        int32_t v6 = (int32_t)v5 - upper; // 0x80567e0
        v1 = v6 < 1 ? v1 : v3;
        if (v6 == 0) {
            uint16_t v7 = *(int16_t *)(v4 + (int32_t)&g8); // 0x805680a
            result = v7;
            return result;
        }
        v2 = v6 >= 0 ? v2 : v3 + 1;
        result = upper;
    }
  lab_0x8056828:
    // 0x8056828
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x805682d - 0x8056a34
// Line range:    5848 - 5878
int32_t UPPER8(uint32_t ch1, uint32_t ch2) {
    // 0x805682d
    if (ch1 == ch2) {
        // 0x8056a2b
        return 0;
    }
    if (ch2 == 0) {
        // 0x8056a2b
        return ch1 % 256;
    }
    if (ch1 == 0) {
        // 0x8056a2b
        return -((ch2 % 256));
    }
    char v1 = ch1; // 0x8056877
    char v2 = ch2; // 0x8056882
    if (v1 < 0 || v2 < 0) {
        // 0x8056912
        if (v1 < 0 != v2 < 0) {
            // 0x8056a2b
            return -10;
        }
        // 0x8056928
        if (DisplayCharsetMatchLocale == 0) {
            int32_t v3 = UCTransToUni(v2, current_char_set); // 0x80569cf
            int32_t result; // 0x805682d
            if (v3 >= 0) {
                int32_t v4 = UniToLowerCase(UCTransToUni(v1, current_char_set)); // 0x8056a09
                result = v4 - UniToLowerCase(v3);
            } else {
                // 0x80569dd
                result = ch1 % 256;
            }
            // 0x8056a2b
            return result;
        }
        int16_t * v5 = *__ctype_b_loc(); // 0x805693c
        int32_t c = ch1 % 256;
        int32_t v6 = c; // 0x8056956
        if ((*(int16_t *)((2 * ch1 & 510) + (int32_t)v5) & 512) != 0) {
            // 0x8056958
            v6 = toupper(c);
        }
        int16_t * v7 = *__ctype_b_loc(); // 0x8056979
        int32_t c2 = ch2 % 256;
        int32_t v8 = c2; // 0x8056993
        if ((*(int16_t *)((2 * ch2 & 510) + (int32_t)v7) & 512) != 0) {
            // 0x8056995
            v8 = toupper(c2);
        }
        // 0x8056a2b
        return v6 - v8;
    }
    int16_t * v9 = *__ctype_b_loc(); // 0x805688f
    int32_t c3 = ch1 % 256;
    int32_t v10 = c3; // 0x80568a9
    if ((*(int16_t *)((2 * ch1 & 510) + (int32_t)v9) & 512) != 0) {
        // 0x80568ab
        v10 = toupper(c3);
    }
    int16_t * v11 = *__ctype_b_loc(); // 0x80568cc
    int32_t c4 = ch2 % 256;
    int32_t v12 = c4; // 0x80568e6
    if ((*(int16_t *)((2 * ch2 & 510) + (int32_t)v11) & 512) != 0) {
        // 0x80568e8
        v12 = toupper(c4);
    }
    // 0x8056a2b
    return v10 - v12;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8056a34 - 0x8056ba8
// Line range:    5887 - 5914
char * LYSafeGets(char ** src, struct _IO_FILE * fp) {
    char buffer[8192]; // bp-8204, 0x8056a34
    char v1[8192]; // 0x8056ab3
    char v2[8192]; // 0x8056a75
    int32_t v3 = __readgsdword(20); // 0x8056a4f
    buffer = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    if (src != NULL) {
        // 0x8056a6d
        v2[0] = (int32_t)*src;
        buffer = v2;
    }
    int32_t v4 = *(int32_t *)&buffer; // 0x8056a7b
    if (v4 != 0) {
        // 0x8056a85
        *(char *)v4 = 0;
    }
    char str; // bp-8200, 0x8056a34
    while (fgets(&str, 0x2000, fp) != NULL) {
        // 0x8056a90
        if (str != 0) {
            char * v5 = HTSACat((char **)&buffer, &str); // 0x8056aae
            v1[0] = (int32_t)v5;
            buffer = v1;
        }
        // 0x8056ab9
        if (strchr(&str, 10) != NULL) {
            // break -> 0x8056af7
            break;
        }
    }
    // 0x8056af7
    if (ferror(fp) == 0) {
        // 0x8056b2d
        if (feof(fp) != 0) {
            int32_t v6 = *(int32_t *)&buffer; // 0x8056b3f
            if (v6 != 0) {
                // 0x8056b49
                if (*(char *)v6 == 0) {
                    // 0x8056b60
                    free(&((struct _IO_FILE *)v6)->e0);
                    buffer = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                }
            }
        }
    } else {
        int32_t v7 = *(int32_t *)&buffer; // 0x8056b09
        if (v7 != 0) {
            // 0x8056b13
            free(&((struct _IO_FILE *)v7)->e0);
            buffer = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        }
    }
    int32_t v8 = *(int32_t *)&buffer;
    if (src != NULL) {
        // 0x8056b81
        *(int32_t *)src = v8;
    }
    int32_t v9 = v8; // 0x8056b9f
    if (v3 != __readgsdword(20)) {
        // 0x8056ba1
        __stack_chk_fail();
        v9 = &g391;
    }
    // 0x8056ba6
    return (char *)v9;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8056ba8 - 0x8056c48
// Line range:    5922 - 5935
void LYOpenCmdLogfile(uint32_t argc, char ** argv) {
    // 0x8056ba8
    if (lynx_cmd_logfile == 0) {
        // 0x8056c46
        return;
    }
    struct _IO_FILE * v1 = LYNewTxtFile((char *)lynx_cmd_logfile); // 0x8056bc3
    *(int32_t *)&cmd_logfile = (int32_t)v1;
    if (v1 == NULL) {
        // 0x8056c46
        return;
    }
    char * v2 = LYVersionDate(); // 0x8056bd6
    fprintf((struct _IO_FILE *)cmd_logfile, "# Command logfile created by %s %s (%s)\n", "Lynx", "2.8.7dev.11", v2);
    if (argc <= 0) {
        // 0x8056c46
        return;
    }
    int32_t v3 = 0; // 0x8056c3a
    int32_t v4 = *(int32_t *)(4 * v3 + (int32_t)argv); // 0x8056c17
    fprintf((struct _IO_FILE *)cmd_logfile, "# Arg%d = %s\n", v3, (char *)v4);
    v3++;
    while (v3 != argc) {
        // 0x8056c0e
        v4 = *(int32_t *)(4 * v3 + (int32_t)argv);
        fprintf((struct _IO_FILE *)cmd_logfile, "# Arg%d = %s\n", v3, (char *)v4);
        v3++;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8056c48 - 0x8056c57
// Line range:    5938 - 5940
char LYHaveCmdScript(void) {
    // 0x8056c48
    return cmd_script != NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8056c57 - 0x8056cd3
// Line range:    5943 - 5950
void LYOpenCmdScript(void) {
    // 0x8056c57
    if (lynx_cmd_script == 0) {
        // 0x8056ccd
        return;
    }
    struct _IO_FILE * v1 = fopen64((char *)lynx_cmd_script, "r"); // 0x8056c77
    *(int32_t *)&cmd_script = (int32_t)v1;
    if (WWW_TraceFlag != 0) {
        // 0x8056c8c
        fprintf(TraceFP(), "LYOpenCmdScript(%s) %s\n", (char *)lynx_cmd_script, v1 == NULL ? "FAIL" : "SUCCESS");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8056cd3 - 0x8056f71
// Line range:    5953 - 6008
int32_t LYReadCmdKey(int32_t mode) {
    // 0x8056cd3
    int32_t result; // 0x8056cd3
    if (cmd_script == NULL) {
        // 0x8056f04
        result = LYgetch_for(mode);
    } else {
        int32_t ch = 0; // bp-16, 0x8056cee
        int32_t v1 = -1;
        char * v2 = LYSafeGets((char **)&ch, (struct _IO_FILE *)cmd_script); // 0x8056ea4
        int32_t v3 = v1; // 0x8056eab
        bool v4 = true; // 0x8056eab
        while (v2 != NULL) {
            // 0x8056e95
            char * v5; // 0x8056d19
            while (true) {
                // 0x8056cfa
                LYTrimTrailing((char *)ch);
                char * v6 = LYSkipBlanks((char *)ch); // 0x8056d0b
                v5 = LYSkipNonBlanks(v6);
                int32_t v7 = (int32_t)v5 - (int32_t)v6; // 0x8056d29
                if (v7 == 3) {
                    // 0x8056d7a
                    if (strncasecomp(v6, "key", 3) == 0) {
                        // break -> 0x8056d99
                        break;
                    }
                    // 0x8056db4
                    if (strncasecomp(v6, "set", 3) == 0) {
                        char * v8 = LYSkipBlanks(v5); // 0x8056ddd
                        char v9 = *v8;
                        char * v10 = v8; // 0x8056e27
                        char * v11 = v8; // 0x8056e27
                        char v12 = v9; // 0x8056e27
                        if (v9 != 0) {
                            char * v13 = v10;
                            int16_t * v14 = *__ctype_b_loc(); // 0x8056df2
                            unsigned char v15 = *v13; // 0x8056df7
                            int16_t v16 = *(int16_t *)(2 * (int32_t)v15 + (int32_t)v14); // 0x8056e02
                            v11 = v13;
                            v12 = v15;
                            while (v15 != 61 && (v16 & 0x2000) == 0) {
                                char * v17 = (char *)((int32_t)v13 + 1);
                                char v18 = *v17;
                                v10 = v17;
                                v11 = v17;
                                v12 = v18;
                                if (v18 == 0) {
                                    // break -> 0x8056e29
                                    break;
                                }
                                v13 = v10;
                                v14 = *__ctype_b_loc();
                                v15 = *v13;
                                v16 = *(int16_t *)(2 * (int32_t)v15 + (int32_t)v14);
                                v11 = v13;
                                v12 = v15;
                            }
                        }
                        char * v19 = v11;
                        char * v20 = v19; // 0x8056e31
                        if (v12 != 0) {
                            // 0x8056e33
                            *v19 = 0;
                            v20 = LYSkipBlanks((char *)((int32_t)v19 + 1));
                        }
                        char * v21 = v20;
                        if (WWW_TraceFlag != 0) {
                            // 0x8056e56
                            fprintf(TraceFP(), "LYSetConfigValue(%s, %s)\n", v8, v21);
                        }
                        // 0x8056e7d
                        LYSetConfigValue(v8, v21);
                    }
                } else {
                    if (v7 == 4) {
                        // 0x8056d46
                        if (strncasecomp(v6, "exit", 4) == 0) {
                            // 0x8056d69
                            exit_immediately(0);
                            // UNREACHABLE
                        }
                    }
                }
                char * v22 = LYSafeGets((char **)&ch, (struct _IO_FILE *)cmd_script); // 0x8056ea4
                v3 = v1;
                v4 = true;
                if (v22 == NULL) {
                    // break (via goto) -> 0x8056eb1
                    goto lab_0x8056eb1;
                }
            }
            int32_t v23 = LYStringToKeycode(LYSkipBlanks(v5)); // 0x8056da7
            v3 = v23;
            v4 = false;
            if (v23 >= 0) {
                // break -> 0x8056eb1
                break;
            }
            // 0x8056d99
            v1 = v23;
            v2 = LYSafeGets((char **)&ch, (struct _IO_FILE *)cmd_script);
            v3 = v1;
            v4 = true;
        }
      lab_0x8056eb1:
        // 0x8056eb1
        if (feof((struct _IO_FILE *)cmd_script) != 0) {
            // 0x8056ec2
            fclose((struct _IO_FILE *)cmd_script);
            *(int32_t *)&cmd_script = 0;
        }
        if (!v4) {
            // 0x8056edf
            LYSleepReplay();
            LYrefresh();
        }
        // 0x8056ee9
        result = v3;
        if (ch != 0) {
            // 0x8056ef0
            free((int32_t *)ch);
            ch = 0;
            result = v3;
        }
    }
    // 0x8056f12
    if (WWW_TraceFlag != 0) {
        char * v24 = LYKeycodeToString(result, 1); // 0x8056f2b
        fprintf(TraceFP(), "LYReadCmdKey(%d) ->%s (%#x)\n", mode, v24, result);
    }
    // 0x8056f5d
    LYWriteCmdKey(result);
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8056f71 - 0x8056faf
// Line range:    6014 - 6018
void LYWriteCmdKey(int32_t ch) {
    // 0x8056f71
    if (cmd_logfile != NULL) {
        char * v1 = LYKeycodeToString(ch, 0); // 0x8056f8e
        fprintf((struct _IO_FILE *)cmd_logfile, "key %s\n", v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStrings.c
// Address range: 0x8056faf - 0x8057037
// Line range:    6021 - 6032
void LYCloseCmdLogfile(void) {
    // 0x8056faf
    if (cmd_logfile != NULL) {
        // 0x8056fbe
        LYCloseOutput((struct _IO_FILE *)cmd_logfile);
        *(int32_t *)&cmd_logfile = 0;
    }
    // 0x8056fd5
    if (cmd_script != NULL) {
        // 0x8056fde
        LYCloseInput((struct _IO_FILE *)cmd_script);
        *(int32_t *)&cmd_script = 0;
    }
    // 0x8056ff5
    if (lynx_cmd_logfile != 0) {
        // 0x8056ffe
        free((int32_t *)lynx_cmd_logfile);
        lynx_cmd_logfile = 0;
    }
    // 0x8057015
    if (lynx_cmd_script != 0) {
        // 0x805701e
        free((int32_t *)lynx_cmd_script);
        lynx_cmd_script = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x805705b - 0x80570ed
// Line range:    39 - 54
void SafeHTUnEscape(char * string) {
    // 0x805705b
    HTUnEscape(string);
    char v1 = *string; // 0x80570ca
    char v2 = v1; // 0x80570cf
    char * v3 = string; // 0x80570cf
    int32_t v4 = 0; // 0x80570cf
    if (v1 == 0) {
        // 0x80570eb
        return;
    }
    int32_t v5 = 0; // 0x80570cf
    int32_t v6; // 0x805705b
    while (true) {
      lab_0x805707c:;
        char * v7 = v3;
        if (v2 < 0) {
            // 0x80570b0
            *v7 = 63;
            v6 = 1;
            goto lab_0x80570c0;
        } else {
            int16_t v8 = *(int16_t *)(2 * (int32_t)*v7 + (int32_t)*__ctype_b_loc()); // 0x80570a1
            v6 = v5;
            if ((v8 & 0x4000) != 0) {
                goto lab_0x80570c0;
            } else {
                // 0x80570b0
                *v7 = 63;
                v6 = 1;
                goto lab_0x80570c0;
            }
        }
    }
  lab_0x80570d1:;
    int32_t v9; // 0x805705b
    if (v9 != 0) {
        // 0x80570d7
        HTAlert(gettext("Warning!  Control codes in mail address replaced by ?"));
    }
  lab_0x80570c0:
    // 0x80570c0
    v9 = v6;
    v4++;
    v3 = (char *)(v4 + (int32_t)string);
    v2 = *v3;
    v5 = v9;
    if (v2 == 0) {
        // break -> 0x80570d1
        goto lab_0x80570d1;
    }
    goto lab_0x805707c;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x80570ed - 0x8057102
// Line range:    57 - 63
void remove_tildes(char * string) {
    // 0x80570ed
    if (*string == 126) {
        // 0x80570fa
        *string = 32;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x8057102 - 0x80571a4
// Line range:    67 - 80
void comma_append(char ** dst, char * src) {
    char v1 = *src;
    char v2 = v1; // 0x8057110
    if (v1 == 0) {
        // 0x80571a2
        return;
    }
    char * v3 = src; // 0x8057110
    char * v4; // 0x8057102
    unsigned char v5; // 0x8057130
    while (true) {
        // 0x805711c
        v4 = v3;
        if (v2 != 44) {
            int16_t * v6 = *__ctype_b_loc(); // 0x805712b
            v5 = *v4;
            if ((*(int16_t *)(2 * (int32_t)v5 + (int32_t)v6) & 0x2000) == 0) {
                // break -> 0x805714a
                break;
            }
        }
        // 0x8057118
        v3 = (char *)((int32_t)v4 + 1);
        v2 = *v3;
    }
    if (v5 == 0) {
        // 0x80571a2
        return;
    }
    char * v7 = *dst;
    if (v7 == NULL || *v7 == 0) {
        // 0x8057169
        HTSACopy(dst, v4);
        // 0x80571a2
        return;
    }
    // 0x805717d
    HTSACat(dst, ",");
    HTSACat(dst, v4);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x80571a4 - 0x80572b0
// Line range:    85 - 109
void extract_field(char ** dst, char * src, char * keyword) {
    int32_t len = strlen(keyword); // 0x80571b0
    int32_t v1 = (int32_t)src + 1;
    char * v2 = (char *)v1; // 0x8057257
    if (*v2 != 0) {
        char v3 = *src; // 0x80571cc
        int32_t v4 = v1; // 0x80571d1
        char * str; // 0x80571a4
        char * found_char_pos; // 0x8057211
        if (v3 != 63 != v3 != 38) {
            // 0x80571e0
            v4 = v1;
            if (strncasecomp(v2, keyword, len) == 0) {
                // 0x80571fd
                str = (char *)(v1 + len);
                found_char_pos = strchr(str, 38);
                if (found_char_pos == NULL) {
                    // 0x8057225
                    comma_append(dst, str);
                    goto lab_0x8057262;
                }
                // 0x805723d
                *found_char_pos = 0;
                comma_append(dst, str);
                *found_char_pos = 38;
                v4 = (int32_t)found_char_pos;
            }
        }
        int32_t v5 = v4 + 1;
        char * v6 = (char *)v5; // 0x8057257
        char * v7 = v6; // 0x805725c
        while (*v6 != 0) {
            int32_t v8 = v5;
            v3 = *(char *)v4;
            v4 = v8;
            if (v3 != 63 != v3 != 38) {
                // 0x80571e0
                v4 = v8;
                if (strncasecomp(v7, keyword, len) == 0) {
                    // 0x80571fd
                    str = (char *)(v8 + len);
                    found_char_pos = strchr(str, 38);
                    if (found_char_pos == NULL) {
                        // 0x8057225
                        comma_append(dst, str);
                        goto lab_0x8057262;
                    }
                    // 0x805723d
                    *found_char_pos = 0;
                    comma_append(dst, str);
                    *found_char_pos = 38;
                    v4 = (int32_t)found_char_pos;
                }
            }
            // 0x8057250
            v5 = v4 + 1;
            v6 = (char *)v5;
            v7 = v6;
        }
    }
    goto lab_0x8057262;
  lab_0x8057262:
    // 0x8057262
    if (WWW_TraceFlag != 0) {
        char * v9 = *dst;
        fprintf(TraceFP(), "extract_field(%s) = '%s'\n", keyword, v9 == NULL ? "(null)" : v9);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x80572b0 - 0x80573df
// Line range:    116 - 144
void extract_subject(char * dst, char * src) {
    int32_t len = strlen("subject="); // 0x80572c3
    int32_t v1 = (int32_t)src + 1;
    char * v2 = (char *)v1;
    char v3 = *v2;
    int32_t v4 = v1; // 0x8057319
    char v5 = v3; // 0x8057319
    if (v3 != 0) {
        char * v6 = v2;
        char v7 = *src; // 0x80572dc
        if (v7 != 63 != v7 != 38) {
            // 0x80572f0
            if (strncasecomp(v6, "subject=", len) == 0) {
                // 0x805731b
                v4 = v1;
                v5 = *v6;
                goto lab_0x805731b_2;
            }
        }
        int32_t v8 = (int32_t)v6 + 1;
        char * v9 = (char *)v8;
        char v10 = *v9;
        int32_t v11 = v8; // 0x8057319
        v4 = v8;
        v5 = v10;
        while (v10 != 0) {
            char * v12 = v6;
            v6 = v9;
            v7 = *v12;
            if (v7 != 63 != v7 != 38) {
                // 0x80572f0
                if (strncasecomp(v6, "subject=", len) == 0) {
                    // 0x805731b
                    v4 = v11;
                    v5 = *v6;
                    goto lab_0x805731b_2;
                }
            }
            // 0x805730d
            v8 = (int32_t)v6 + 1;
            v9 = (char *)v8;
            v10 = *v9;
            v11 = v8;
            v4 = v8;
            v5 = v10;
        }
    }
    goto lab_0x805731b_2;
  lab_0x805731b_2:
    // 0x805731b
    if (v5 != 0) {
        char * str = (char *)(v4 + len); // 0x8057328
        char * found_char_pos = strchr(str, 38); // 0x8057339
        if (found_char_pos != NULL) {
            // 0x8057347
            *found_char_pos = 0;
        }
        // 0x805734d
        if (*str != 0) {
            // 0x8057357
            strncpy(dst, str, 70);
            *(char *)((int32_t)dst + 70) = 0;
            SafeHTUnEscape(dst);
        }
        if (found_char_pos != NULL) {
            // 0x805738b
            *found_char_pos = 38;
        }
    }
    // 0x8057398
    if (WWW_TraceFlag != 0) {
        // 0x80573a3
        fprintf(TraceFP(), "extract_subject(%s) = '%s'\n", (struct _IO_FILE *)"subject=", dst == NULL ? "(null)" : dst);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x80573df - 0x8057667
// Line range:    151 - 213
void extract_body(char ** dst, char * src) {
    int32_t len = strlen("body="); // 0x80573f2
    char * cp0 = NULL; // bp-32, 0x80573fa
    int32_t v1 = (int32_t)src + 1;
    char * v2 = (char *)v1; // 0x8057610
    if (*v2 != 0) {
        char * v3 = (char *)len;
        char v4 = *src; // 0x8057415
        char * v5 = v3; // 0x805741a
        int32_t v6 = v1; // 0x805741a
        char * v7; // 0x80573df
        char * str5; // 0x80573df
        char * v8; // 0x80573df
        char * str2; // 0x80573df
        char * v9; // 0x80573df
        int32_t v10; // 0x80573df
        char * v11; // 0x80573df
        char * v12; // 0x80573df
        char * v13; // 0x80573df
        char * v14; // 0x80573df
        int32_t v15; // 0x80573df
        char * v16; // 0x80573df
        char * v17; // 0x80573df
        int32_t v18; // 0x80573df
        uint32_t v19; // 0x80573df
        int32_t v20; // 0x80573df
        int32_t v21; // 0x80573df
        int32_t v22; // 0x805742d
        char * str; // 0x80573df
        char * found_char_pos; // 0x8057462
        int32_t v23; // 0x80574a1
        char * found_char_pos2; // 0x8057553
        uint32_t v24; // 0x80573df
        int32_t len3; // 0x8057572
        char * v25; // 0x80574c0
        char * v26; // 0x80573df
        int32_t v27; // 0x805757c
        int32_t v28; // 0x8057599
        char * v29; // 0x80573df
        int32_t len4; // 0x80575a6
        int32_t v30; // 0x8057504
        char * str3; // 0x80573df
        int32_t len2; // 0x8057511
        int32_t v31; // 0x805753f
        char * str4; // 0x80573df
        char * found_char_pos3; // 0x8057553
        if (v4 != 63 != v4 != 38) {
            // 0x805742d
            v22 = (int32_t)v3;
            v5 = v3;
            v6 = v1;
            if (strncasecomp(v2, "body=", v22) == 0) {
                // 0x805744e
                str = (char *)(v1 + v22);
                found_char_pos = strchr(str, 38);
                if (found_char_pos != NULL) {
                    // 0x8057470
                    *found_char_pos = 0;
                }
                // 0x8057476
                v11 = v3;
                if (*str != 0) {
                    // 0x8057484
                    HTSACopy(&cp0, str);
                    HTUnEscape(cp0);
                    v23 = (int32_t)cp0;
                    found_char_pos2 = strchr(cp0, 10);
                    v7 = found_char_pos2;
                    str2 = cp0;
                    v18 = v23;
                    v20 = v23;
                    str5 = cp0;
                    if (found_char_pos2 != NULL) {
                        v19 = v18;
                        v24 = (int32_t)v7;
                        *v7 = 0;
                        if (v19 < v24) {
                            // 0x80574ba
                            v25 = (char *)(v24 - 1);
                            if (*v25 == 13) {
                                // 0x80574c7
                                *v25 = 0;
                            }
                        }
                        // 0x80574d0
                        v26 = (char *)v19;
                        v9 = v26;
                        v8 = v26;
                        if ((char *)strlen(str2) > (char *)78) {
                            HTSprintf(dst, "%.78s\n", v9);
                            v30 = 78;
                            str3 = (char *)(v30 + v19);
                            len2 = strlen(str3);
                            v9 = str3;
                            v10 = v30;
                            v8 = str3;
                            while ((char *)len2 > (char *)78) {
                                // 0x80574e7
                                HTSprintf(dst, "%.78s\n", v9);
                                v30 = v10 + 78;
                                str3 = (char *)(v30 + v19);
                                len2 = strlen(str3);
                                v9 = str3;
                                v10 = v30;
                                v8 = str3;
                            }
                        }
                        // 0x805751f
                        HTSprintf(dst, "%s\n", v8);
                        v31 = v24 + 1;
                        str4 = (char *)v31;
                        found_char_pos3 = strchr(str4, 10);
                        v7 = found_char_pos3;
                        str2 = str4;
                        v20 = v31;
                        str5 = str4;
                        while (found_char_pos3 != NULL) {
                            // 0x80574ac
                            v19 = v31;
                            v24 = (int32_t)v7;
                            *v7 = 0;
                            if (v19 < v24) {
                                // 0x80574ba
                                v25 = (char *)(v24 - 1);
                                if (*v25 == 13) {
                                    // 0x80574c7
                                    *v25 = 0;
                                }
                            }
                            // 0x80574d0
                            v26 = (char *)v19;
                            v9 = v26;
                            v8 = v26;
                            if ((char *)strlen(str2) > (char *)78) {
                                HTSprintf(dst, "%.78s\n", v9);
                                v30 = 78;
                                str3 = (char *)(v30 + v19);
                                len2 = strlen(str3);
                                v9 = str3;
                                v10 = v30;
                                v8 = str3;
                                while ((char *)len2 > (char *)78) {
                                    // 0x80574e7
                                    HTSprintf(dst, "%.78s\n", v9);
                                    v30 = v10 + 78;
                                    str3 = (char *)(v30 + v19);
                                    len2 = strlen(str3);
                                    v9 = str3;
                                    v10 = v30;
                                    v8 = str3;
                                }
                            }
                            // 0x805751f
                            HTSprintf(dst, "%s\n", v8);
                            v31 = v24 + 1;
                            str4 = (char *)v31;
                            found_char_pos3 = strchr(str4, 10);
                            v7 = found_char_pos3;
                            str2 = str4;
                            v20 = v31;
                            str5 = str4;
                        }
                    }
                    // 0x8057565
                    v21 = v20;
                    len3 = strlen(str5);
                    v14 = (char *)len3;
                    v12 = NULL;
                    v15 = len3;
                    v16 = v14;
                    if (v14 > (char *)78) {
                        v27 = (int32_t)NULL;
                        HTSprintf(dst, "%.78s\n", (char *)(v21 + v27));
                        v28 = v27 + 78;
                        v29 = (char *)v28;
                        len4 = strlen((char *)(v28 + v21));
                        v13 = (char *)len4;
                        v12 = v29;
                        v15 = len4;
                        v16 = v13;
                        while (v13 > (char *)78) {
                            // 0x805757c
                            v27 = (int32_t)v29;
                            HTSprintf(dst, "%.78s\n", (char *)(v21 + v27));
                            v28 = v27 + 78;
                            v29 = (char *)v28;
                            len4 = strlen((char *)(v28 + v21));
                            v13 = (char *)len4;
                            v12 = v29;
                            v15 = len4;
                            v16 = v13;
                        }
                    }
                    // 0x80575b4
                    v17 = v16;
                    if (v15 != 0) {
                        // 0x80575ba
                        HTSprintf(dst, "%s\n", (char *)(v21 + (int32_t)v12));
                    }
                    // 0x80575d7
                    v11 = v17;
                    if (cp0 != NULL) {
                        // 0x80575de
                        free((int32_t *)cp0);
                        cp0 = NULL;
                        v11 = v17;
                    }
                }
                if (found_char_pos == NULL) {
                    // break -> 0x805761b
                    break;
                }
                // 0x80575f6
                *found_char_pos = 38;
                v5 = v11;
                v6 = (int32_t)found_char_pos;
            }
        }
        int32_t v32 = v6 + 1;
        char * v33 = (char *)v32; // 0x8057610
        char * v34 = v33; // 0x8057615
        while (*v33 != 0) {
            // 0x805740f
            v3 = v5;
            int32_t v35 = v32;
            v4 = *(char *)v6;
            v5 = v3;
            v6 = v35;
            if (v4 != 63 != v4 != 38) {
                // 0x805742d
                v22 = (int32_t)v3;
                v5 = v3;
                v6 = v35;
                if (strncasecomp(v34, "body=", v22) == 0) {
                    // 0x805744e
                    str = (char *)(v35 + v22);
                    found_char_pos = strchr(str, 38);
                    if (found_char_pos != NULL) {
                        // 0x8057470
                        *found_char_pos = 0;
                    }
                    // 0x8057476
                    v11 = v3;
                    if (*str != 0) {
                        // 0x8057484
                        HTSACopy(&cp0, str);
                        HTUnEscape(cp0);
                        v23 = (int32_t)cp0;
                        found_char_pos2 = strchr(cp0, 10);
                        v7 = found_char_pos2;
                        str2 = cp0;
                        v18 = v23;
                        v20 = v23;
                        str5 = cp0;
                        if (found_char_pos2 != NULL) {
                            v19 = v18;
                            v24 = (int32_t)v7;
                            *v7 = 0;
                            if (v19 < v24) {
                                // 0x80574ba
                                v25 = (char *)(v24 - 1);
                                if (*v25 == 13) {
                                    // 0x80574c7
                                    *v25 = 0;
                                }
                            }
                            // 0x80574d0
                            v26 = (char *)v19;
                            v9 = v26;
                            v8 = v26;
                            if ((char *)strlen(str2) > (char *)78) {
                                HTSprintf(dst, "%.78s\n", v9);
                                v30 = 78;
                                str3 = (char *)(v30 + v19);
                                len2 = strlen(str3);
                                v9 = str3;
                                v10 = v30;
                                v8 = str3;
                                while ((char *)len2 > (char *)78) {
                                    // 0x80574e7
                                    HTSprintf(dst, "%.78s\n", v9);
                                    v30 = v10 + 78;
                                    str3 = (char *)(v30 + v19);
                                    len2 = strlen(str3);
                                    v9 = str3;
                                    v10 = v30;
                                    v8 = str3;
                                }
                            }
                            // 0x805751f
                            HTSprintf(dst, "%s\n", v8);
                            v31 = v24 + 1;
                            str4 = (char *)v31;
                            found_char_pos3 = strchr(str4, 10);
                            v7 = found_char_pos3;
                            str2 = str4;
                            v20 = v31;
                            str5 = str4;
                            while (found_char_pos3 != NULL) {
                                // 0x80574ac
                                v19 = v31;
                                v24 = (int32_t)v7;
                                *v7 = 0;
                                if (v19 < v24) {
                                    // 0x80574ba
                                    v25 = (char *)(v24 - 1);
                                    if (*v25 == 13) {
                                        // 0x80574c7
                                        *v25 = 0;
                                    }
                                }
                                // 0x80574d0
                                v26 = (char *)v19;
                                v9 = v26;
                                v8 = v26;
                                if ((char *)strlen(str2) > (char *)78) {
                                    HTSprintf(dst, "%.78s\n", v9);
                                    v30 = 78;
                                    str3 = (char *)(v30 + v19);
                                    len2 = strlen(str3);
                                    v9 = str3;
                                    v10 = v30;
                                    v8 = str3;
                                    while ((char *)len2 > (char *)78) {
                                        // 0x80574e7
                                        HTSprintf(dst, "%.78s\n", v9);
                                        v30 = v10 + 78;
                                        str3 = (char *)(v30 + v19);
                                        len2 = strlen(str3);
                                        v9 = str3;
                                        v10 = v30;
                                        v8 = str3;
                                    }
                                }
                                // 0x805751f
                                HTSprintf(dst, "%s\n", v8);
                                v31 = v24 + 1;
                                str4 = (char *)v31;
                                found_char_pos3 = strchr(str4, 10);
                                v7 = found_char_pos3;
                                str2 = str4;
                                v20 = v31;
                                str5 = str4;
                            }
                        }
                        // 0x8057565
                        v21 = v20;
                        len3 = strlen(str5);
                        v14 = (char *)len3;
                        v12 = NULL;
                        v15 = len3;
                        v16 = v14;
                        if (v14 > (char *)78) {
                            v27 = (int32_t)NULL;
                            HTSprintf(dst, "%.78s\n", (char *)(v21 + v27));
                            v28 = v27 + 78;
                            v29 = (char *)v28;
                            len4 = strlen((char *)(v28 + v21));
                            v13 = (char *)len4;
                            v12 = v29;
                            v15 = len4;
                            v16 = v13;
                            while (v13 > (char *)78) {
                                // 0x805757c
                                v27 = (int32_t)v29;
                                HTSprintf(dst, "%.78s\n", (char *)(v21 + v27));
                                v28 = v27 + 78;
                                v29 = (char *)v28;
                                len4 = strlen((char *)(v28 + v21));
                                v13 = (char *)len4;
                                v12 = v29;
                                v15 = len4;
                                v16 = v13;
                            }
                        }
                        // 0x80575b4
                        v17 = v16;
                        if (v15 != 0) {
                            // 0x80575ba
                            HTSprintf(dst, "%s\n", (char *)(v21 + (int32_t)v12));
                        }
                        // 0x80575d7
                        v11 = v17;
                        if (cp0 != NULL) {
                            // 0x80575de
                            free((int32_t *)cp0);
                            cp0 = NULL;
                            v11 = v17;
                        }
                    }
                    if (found_char_pos == NULL) {
                        // break -> 0x805761b
                        break;
                    }
                    // 0x80575f6
                    *found_char_pos = 38;
                    v5 = v11;
                    v6 = (int32_t)found_char_pos;
                }
            }
            // 0x8057609
            v32 = v6 + 1;
            v33 = (char *)v32;
            v34 = v33;
        }
    }
    // 0x805761b
    if (WWW_TraceFlag != 0) {
        char * v36 = *dst;
        fprintf(TraceFP(), "extract_body(%s) = '%s'\n", (struct _IO_FILE *)"body=", v36 == NULL ? "(null)" : v36);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x8057667 - 0x80576a6
// Line range:    219 - 223
char trim_comma(char * address) {
    int32_t len = strlen(address); // 0x8057673
    int32_t v1 = (int32_t)address - 1;
    if (*(char *)(len + v1) == 44) {
        // 0x8057685
        *(char *)(strlen(address) + v1) = 0;
    }
    // 0x8057699
    return *address == 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x80576a6 - 0x8057712
// Line range:    229 - 243
char convert_explorer(char * address) {
    char * found_char_pos = strchr(address, 64); // 0x80576f7
    if (found_char_pos == NULL) {
        // 0x8057705
        return trim_comma(address);
    }
    char * str = (char *)((int32_t)found_char_pos + 1);
    char * found_char_pos2 = strchr(str, 59); // 0x80576c6
    char * str2 = str; // 0x80576d2
    if (found_char_pos2 != NULL) {
        // 0x80576d4
        *found_char_pos2 = 44;
        str2 = (char *)((int32_t)found_char_pos2 + 1);
    }
    char * found_char_pos3 = strchr(str2, 64); // 0x80576f7
    while (found_char_pos3 != NULL) {
        // 0x80576b4
        str = (char *)((int32_t)found_char_pos3 + 1);
        found_char_pos2 = strchr(str, 59);
        str2 = str;
        if (found_char_pos2 != NULL) {
            // 0x80576d4
            *found_char_pos2 = 44;
            str2 = (char *)((int32_t)found_char_pos2 + 1);
        }
        // 0x80576e3
        found_char_pos3 = strchr(str2, 64);
    }
    // 0x8057705
    return trim_comma(address);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x8057712 - 0x80578da
// Line range:    252 - 277
int32_t header_prompt(char * label, char ** result, uint32_t limit) {
    char buffer[1024]; // bp-1040, 0x8057712
    char v1[1024]; // 0x8057861
    int32_t v2 = __readgsdword(20); // 0x805772e
    int32_t v3; // bp-1036, 0x8057712
    if (*result == NULL) {
        // 0x80577a1
        v3 = 0;
    } else {
        int32_t len = strlen(gettext(" Use Control-U to erase the default.\n")); // 0x8057754
        LYwaddnstr(LYwin, gettext(" Use Control-U to erase the default.\n"), len);
        LYstrncpy((char *)&v3, *result, 1023);
    }
    char * v4 = (char *)&v3;
    int32_t len2 = strlen(gettext(label)); // 0x80577c9
    LYwaddnstr(LYwin, gettext(label), len2);
    LYwaddnstr(LYwin, ": ", 2);
    char v5; // 0x8057712
    if (LYgetstr(v4, 0, limit < 1024 ? limit : 1024, 0) < 0) {
        // 0x8057851
        v5 = 0;
        goto lab_0x805785b;
    } else {
        // 0x805783a
        v5 = 1;
        if (term_letter != 0) {
            // 0x8057851
            v5 = 0;
            goto lab_0x805785b;
        } else {
            goto lab_0x805785b;
        }
    }
  lab_0x805785b:
    // 0x805785b
    v1[0] = v5;
    buffer = v1;
    LYwaddnstr(LYwin, "\n", 1);
    int32_t v6 = *(int32_t *)&buffer; // 0x8057884
    if (v6 != 0) {
        // 0x805788d
        remove_tildes(v4);
        HTSACopy(result, v4);
    }
    // 0x80578b3
    term_letter = 0;
    int32_t result2 = v6; // 0x80578ca
    if (v2 != __readgsdword(20)) {
        // 0x80578cc
        __stack_chk_fail();
        result2 = &g391;
    }
    // 0x80578d1
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x80578da - 0x80579a8
// Line range:    280 - 298
void show_addresses(char * addresses) {
    char * found_char_pos = strchr(addresses, 44); // 0x8057966
    char * found_char_pos2 = found_char_pos; // 0x8057972
    char * str2 = addresses; // 0x8057972
    char * v1 = addresses; // 0x8057972
    if (found_char_pos != NULL) {
        while (true) {
            // 0x80578e8
            *found_char_pos2 = 0;
            char * v2 = str2; // 0x80578ee
            char * str; // 0x80578da
            while (true) {
              lab_0x80578f4:
                // 0x80578f4
                str = v2;
                switch (*str) {
                    case 32: {
                        // 0x80578f0
                        v2 = (char *)((int32_t)str + 1);
                        goto lab_0x80578f4;
                    }
                    case 0: {
                        goto lab_0x8057949;
                    }
                    default: {
                        goto lab_0x8057908;
                    }
                }
            }
          lab_0x8057908:
            // 0x8057908
            LYwaddnstr(LYwin, str, strlen(str));
            LYwaddnstr(LYwin, ",\n  ", 4);
          lab_0x8057949:
            // 0x8057949
            *found_char_pos2 = 44;
            str2 = (char *)((int32_t)found_char_pos2 + 1);
            found_char_pos2 = strchr(str2, 44);
            v1 = str2;
            if (found_char_pos2 == NULL) {
                // break -> 0x8057978
                break;
            }
        }
    }
    char * str3 = v1;
    if (*str3 != 0) {
        // 0x8057982
        LYwaddnstr(LYwin, str3, strlen(str3));
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x80579a8 - 0x8057a6e
// Line range:    446 - 457
struct _IO_FILE * LYPipeToMailer(void) {
    char ** command = NULL; // bp-12, 0x80579af
    if (LYSystemMail() == 0) {
        // 0x8057a65
        return (struct _IO_FILE *)NULL;
    }
    // 0x80579ca
    HTSprintf0((char **)&command, "%s %s", (char *)system_mail, (char *)system_mail_flags);
    struct _IO_FILE * v1 = popen((char *)command, "w"); // 0x80579fe
    if (WWW_TraceFlag != 0) {
        // 0x8057a11
        fprintf(TraceFP(), "popen(%s) %s\n", command, v1 == NULL ? "FAIL" : "OK");
    }
    // 0x8057a4c
    if (command != NULL) {
        // 0x8057a53
        free((int32_t *)command);
        command = NULL;
    }
    // 0x8057a65
    return (struct _IO_FILE *)(char *)v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x8057a6e - 0x805842d
// Line range:    541 - 857
void mailform(char * mailto_address, char * mailto_subject, char * mailto_content, char * mailto_type) {
    char buf2[512]; // bp-684, 0x8057a6e
    char buf[512]; // bp-688, 0x8057a6e
    char v1[512]; // 0x8058057
    int32_t v2 = __readgsdword(20); // 0x8057a9b
    buf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    int32_t * fd = NULL; // bp-692, 0x8057ab0
    char * address = NULL; // bp-696, 0x8057aba
    char * keywords = NULL; // bp-704, 0x8057ace
    if (WWW_TraceFlag != 0) {
        // 0x8057ae3
        fprintf(TraceFP(), "mailto_address: \"%s\"\n", mailto_address == NULL ? "(null)" : mailto_address);
        if (WWW_TraceFlag != 0) {
            // 0x8057b30
            fprintf(TraceFP(), "mailto_subject: \"%s\"\n", mailto_subject == NULL ? "(null)" : mailto_subject);
            if (WWW_TraceFlag != 0) {
                // 0x8057b7d
                fprintf(TraceFP(), "mailto_content: \"%s\"\n", mailto_content == NULL ? "(null)" : mailto_content);
                if (WWW_TraceFlag != 0) {
                    // 0x8057bca
                    fprintf(TraceFP(), "mailto_type:    \"%s\"\n", mailto_type == NULL ? "(null)" : mailto_type);
                }
            }
        }
    }
    // 0x8057c0c
    char str; // bp-168, 0x8057a6e
    char str2; // bp-88, 0x8057a6e
    if (LYSystemMail() == 0) {
        goto lab_0x805841a;
    } else {
        if (mailto_address != NULL == (mailto_content != NULL)) {
            // 0x8057c44
            str = 0;
            str2 = 0;
            char * found_char_pos = strchr(mailto_address, 10); // 0x8057c60
            if (found_char_pos != NULL) {
                // 0x8057c74
                *found_char_pos = 0;
            }
            // 0x8057c7d
            HTSACopy((char **)&buf, mailto_address);
            char * found_char_pos2 = strchr((char *)*(int32_t *)&buf, 63); // 0x8057ca6
            if (found_char_pos2 != NULL) {
                // 0x8057cbe
                HTSACopy(&keywords, found_char_pos2);
                *found_char_pos2 = 0;
                if (*(char *)((int32_t)keywords + 1) != 0) {
                    // 0x8057cff
                    extract_subject(&str, keywords);
                    extract_field((char **)&buf, keywords, "to=");
                    extract_field((char **)&fd, keywords, "cc=");
                    extract_field(&address, keywords, "keywords=");
                    char * v3 = address; // 0x8057d77
                    if (v3 != NULL) {
                        // 0x8057d81
                        if (*v3 == 0) {
                            // 0x8057da8
                            free((int32_t *)v3);
                            address = NULL;
                        } else {
                            // 0x8057d8e
                            SafeHTUnEscape(v3);
                        }
                    }
                    // 0x8057dc0
                    if (keywords != NULL) {
                        // 0x8057dca
                        free((int32_t *)keywords);
                        keywords = NULL;
                    }
                }
            }
            // 0x8057de2
            if (convert_explorer((char *)*(int32_t *)&buf) == 0) {
                int32_t * v4 = fd; // 0x8057e0d
                if (v4 != NULL) {
                    int32_t * v5 = fd; // 0x8057e29
                    if (convert_explorer((char *)v4) != 0 && v5 != NULL) {
                        // 0x8057e33
                        free(v5);
                        fd = NULL;
                    }
                }
                // 0x8057e4b
                SafeHTUnEscape((char *)*(int32_t *)&buf);
                int32_t * v6 = fd; // 0x8057e59
                if (v6 != NULL) {
                    // 0x8057e63
                    SafeHTUnEscape((char *)v6);
                }
                // 0x8057e71
                if (str != 0) {
                    goto lab_0x8057ed4;
                } else {
                    if (mailto_subject == NULL) {
                        // 0x8057eb4
                        sprintf(&str, "mailto:%.63s", (char *)*(int32_t *)&buf);
                        goto lab_0x8057ed4;
                    } else {
                        // 0x8057e85
                        if (*mailto_subject == 0) {
                            // 0x8057eb4
                            sprintf(&str, "mailto:%.63s", (char *)*(int32_t *)&buf);
                            goto lab_0x8057ed4;
                        } else {
                            // 0x8057e92
                            LYstrncpy(&str, mailto_subject, 70);
                            goto lab_0x8057ed4;
                        }
                    }
                }
            } else {
                // 0x8057df4
                HTAlert(gettext("Malformed mailto form submission!  Cancelled!"));
                goto lab_0x80583b4;
            }
        } else {
            // 0x8057c2b
            HTAlert(gettext("Malformed mailto form submission!  Cancelled!"));
            goto lab_0x805841a;
        }
    }
  lab_0x805841a:
    // 0x805841a
    if (v2 != __readgsdword(20)) {
        // 0x8058426
        __stack_chk_fail();
    }
  lab_0x8057ed4:
    // 0x8057ed4
    mustshow = 1;
    statusline(gettext("Subject: "));
    if (LYgetstr(&str, 0, 70, 0) >= 0) {
        // 0x8057f3d
        if (LYNoCc != 0) {
            goto lab_0x8058052;
        } else {
            int32_t v7 = (int32_t)&g9; // 0x8057f53
            if (personal_mail_address != 0) {
                char v8 = *(char *)personal_mail_address; // 0x8057f5a
                v7 = v8 == 0 ? (int32_t)&g9 : personal_mail_address;
            }
            // 0x8057f78
            sprintf(&str2, "%.*s", 70, (char *)v7);
            mustshow = 1;
            statusline("Cc: ");
            if (LYgetstr(&str2, 0, 70, 0) >= 0) {
                // 0x8057ffb
                remove_tildes(&str2);
                if (fd != NULL) {
                    // 0x8058027
                    HTSACat((char **)&fd, ",");
                    HTSACat((char **)&fd, &str2);
                } else {
                    // 0x8058010
                    HTSACopy((char **)&fd, &str2);
                }
                goto lab_0x8058052;
            } else {
                // 0x8057fe2
                HTInfoMsg(gettext("Mailto form submission Cancelled!!!"));
                goto lab_0x80583b4;
            }
        }
    } else {
        // 0x8057f24
        HTInfoMsg(gettext("Mailto form submission Cancelled!!!"));
        goto lab_0x80583b4;
    }
  lab_0x80583b4:;
    int32_t v9 = *(int32_t *)&buf; // 0x80583b4
    if (v9 != 0) {
        // 0x80583be
        free((int32_t *)v9);
        buf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    }
    // 0x80583d6
    if (fd != NULL) {
        // 0x80583e0
        free(fd);
        fd = NULL;
    }
    // 0x80583f8
    if (address != NULL) {
        // 0x8058402
        free((int32_t *)address);
        address = NULL;
    }
    goto lab_0x805841a;
  lab_0x8058052:;
    struct _IO_FILE * v10 = LYPipeToMailer(); // 0x8058052
    v1[0] = (int32_t)v10;
    buf2 = v1;
    int32_t v11 = *(int32_t *)&buf2; // 0x805805d
    if (v11 != 0) {
        if (mailto_type != NULL) {
            // 0x8058088
            if (*mailto_type != 0) {
                struct _IO_FILE * stream = (struct _IO_FILE *)v11; // 0x80580b6
                fwrite((int32_t *)"Mime-Version: 1.0\n", 1, 18, stream);
                fprintf(stream, "Content-Type: %s\n", mailto_type);
            }
        }
        struct _IO_FILE * stream2 = (struct _IO_FILE *)v11;
        fprintf(stream2, "To: %s\n", (char *)*(int32_t *)&buf);
        if (personal_mail_address != 0) {
            char * v12 = (char *)personal_mail_address; // 0x8058109
            if (*v12 != 0) {
                // 0x8058110
                fprintf(stream2, "From: %s\n", v12);
            }
        }
        int32_t * v13 = fd; // 0x805812f
        if (v13 != NULL) {
            // 0x8058139
            if (*(char *)v13 != 0) {
                // 0x8058146
                fprintf(stream2, "Cc: %s\n", v13);
            }
        }
        // 0x8058166
        fprintf(stream2, "Subject: %s\n\n", &str);
        char * v14 = address; // 0x8058186
        if (v14 != NULL) {
            // 0x8058190
            if (*v14 != 0) {
                // 0x805819d
                fprintf(stream2, "Keywords: %s\n", v14);
            }
        }
        // 0x80581bd
        mustshow = 1;
        statusline(gettext("Sending form content..."));
        char * found_char_pos3 = strchr(mailto_content, 10); // 0x80582c3
        char * str7 = mailto_content; // 0x80582d5
        int32_t str3; // bp-680, 0x8057a6e
        if (found_char_pos3 != NULL) {
            // 0x80581dd
            *found_char_pos3 = 0;
            int32_t len = strlen(mailto_content); // 0x80581f9
            int32_t v15 = (int32_t)mailto_content;
            int32_t str4 = v15; // 0x805827b
            char * v16 = mailto_content; // 0x805827b
            int32_t v17; // 0x8057a6e
            int32_t v18; // 0x8058253
            int32_t v19; // 0x8057a6e
            char * str5; // 0x8057a6e
            int32_t len2; // 0x8058269
            if ((char *)len > (char *)78) {
                strncpy((char *)&str3, (char *)str4, 78);
                fprintf(stream2, "%s\n", &str3);
                v18 = 78;
                v19 = v18 + v15;
                str5 = (char *)v19;
                len2 = strlen(str5);
                str4 = v19;
                v17 = v18;
                v16 = str5;
                while ((char *)len2 > (char *)78) {
                    // 0x8058206
                    strncpy((char *)&str3, (char *)str4, 78);
                    fprintf(stream2, "%s\n", &str3);
                    v18 = v17 + 78;
                    v19 = v18 + v15;
                    str5 = (char *)v19;
                    len2 = strlen(str5);
                    str4 = v19;
                    v17 = v18;
                    v16 = str5;
                }
            }
            // 0x805827d
            fprintf(stream2, "%s\n", v16);
            char * str6 = (char *)((int32_t)found_char_pos3 + 1);
            char * found_char_pos4 = strchr(str6, 10); // 0x80582c3
            str7 = str6;
            while (found_char_pos4 != NULL) {
                // 0x80581dd
                *found_char_pos4 = 0;
                len = strlen(str6);
                v15 = (int32_t)str6;
                str4 = v15;
                v16 = str6;
                if ((char *)len > (char *)78) {
                    strncpy((char *)&str3, (char *)str4, 78);
                    fprintf(stream2, "%s\n", &str3);
                    v18 = 78;
                    v19 = v18 + v15;
                    str5 = (char *)v19;
                    len2 = strlen(str5);
                    str4 = v19;
                    v17 = v18;
                    v16 = str5;
                    while ((char *)len2 > (char *)78) {
                        // 0x8058206
                        strncpy((char *)&str3, (char *)str4, 78);
                        fprintf(stream2, "%s\n", &str3);
                        v18 = v17 + 78;
                        v19 = v18 + v15;
                        str5 = (char *)v19;
                        len2 = strlen(str5);
                        str4 = v19;
                        v17 = v18;
                        v16 = str5;
                    }
                }
                // 0x805827d
                fprintf(stream2, "%s\n", v16);
                str6 = (char *)((int32_t)found_char_pos4 + 1);
                found_char_pos4 = strchr(str6, 10);
                str7 = str6;
            }
        }
        int32_t len3 = strlen(str7); // 0x80582ee
        int32_t v20 = 0; // 0x8058370
        int32_t v21 = len3; // 0x8058370
        if ((char *)len3 > (char *)78) {
            int32_t v22 = (int32_t)str7;
            int32_t v23 = 0; // 0x8058348
            strncpy((char *)&str3, (char *)(v23 + v22), 78);
            fprintf(stream2, "%s\n", &str3);
            v23 += 78;
            int32_t len4 = strlen((char *)(v23 + v22)); // 0x805835e
            v20 = v23;
            v21 = len4;
            while ((char *)len4 > (char *)78) {
                // 0x80582fb
                strncpy((char *)&str3, (char *)(v23 + v22), 78);
                fprintf(stream2, "%s\n", &str3);
                v23 += 78;
                len4 = strlen((char *)(v23 + v22));
                v20 = v23;
                v21 = len4;
            }
        }
        // 0x8058372
        if (v21 != 0) {
            // 0x805837b
            fprintf(stream2, "%s\n", (char *)(v20 + (int32_t)str7));
        }
        // 0x80583a1
        pclose(stream2);
        LYSleepMsg();
    } else {
        // 0x8058066
        HTAlert(gettext("Mailto form submission failed!"));
    }
    goto lab_0x80583b4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x805842d - 0x805891c
// Line range:    867 - 1084
void mailmsg(int32_t cur, char * owner_address2, char * filename, char * linkname) {
    int32_t * fd = NULL; // bp-24, 0x8058435
    int32_t * fp = NULL; // bp-28, 0x805843c
    char * address = NULL; // bp-32, 0x8058443
    if (owner_address2 == NULL | LYSystemMail() == 0 || *owner_address2 == 0) {
        // 0x8058915
        return;
    }
    char * found_char_pos = strchr(owner_address2, 10); // 0x805847d
    if (found_char_pos != NULL) {
        // 0x805848b
        *found_char_pos = 0;
    }
    // 0x8058491
    if (strncasecomp(owner_address2, "lynx-dev@", 9) == 0) {
        // 0x8058915
        return;
    }
    // 0x80584b4
    HTSACopy((char **)&fd, owner_address2);
    char * found_char_pos2 = strchr((char *)fd, 63); // 0x80584d4
    if (found_char_pos2 != NULL) {
        // 0x80584e2
        HTSACopy((char **)&fp, found_char_pos2);
        *found_char_pos2 = 0;
        if (*(char *)((int32_t)fp + 1) != 0) {
            // 0x805850d
            extract_field((char **)&fd, (char *)fp, "to=");
        }
    }
    // 0x8058527
    convert_explorer((char *)fd);
    SafeHTUnEscape((char *)fd);
    if (trim_comma((char *)fd) != 0) {
        // 0x805854c
        if (fd != NULL) {
            // 0x8058553
            free(fd);
            fd = NULL;
        }
        // 0x8058565
        if (WWW_TraceFlag != 0) {
            // 0x8058574
            fprintf(TraceFP(), "mailmsg: No address in '%s'.\n", owner_address2);
        }
        // 0x8058915
        return;
    }
    struct _IO_FILE * stream = LYPipeToMailer(); // 0x8058597
    int32_t * v1 = fd;
    if (stream == NULL) {
        if (v1 != NULL) {
            // 0x80585ac
            free(v1);
            fd = NULL;
        }
        // 0x80585be
        if (WWW_TraceFlag != 0) {
            // 0x80585cd
            fprintf(TraceFP(), "mailmsg: '%s' failed.\n", address);
        }
        // 0x8058915
        return;
    }
    // 0x80585f0
    fprintf(stream, "To: %s\n", v1);
    fprintf(stream, "Subject: Lynx Error in %s\n", filename);
    if (personal_mail_address != 0) {
        char * v2 = (char *)personal_mail_address; // 0x8058632
        if (*v2 != 0) {
            // 0x8058639
            fprintf(stream, "Cc: %s\n", v2);
        }
    }
    // 0x8058655
    fprintf(stream, "X-URL: %s\n", filename);
    fprintf(stream, "X-Mailer: %s, Version %s\n\n", "Lynx", "2.8.7dev.11");
    fprintf(stream, gettext("The link   %s :?: %s \n"));
    LYGetHiliteStr(cur, 0);
    fprintf(stream, gettext("called \"%s\"\n"));
    fprintf(stream, gettext("in the file \"%s\" called \"%s\"\n"));
    fprintf(stream, "%s\n\n", gettext("was requested but was not available."));
    fprintf(stream, "%s\n\n", gettext("Thought you might want to know."));
    fprintf(stream, "%s\n", gettext("This message was automatically generated by"));
    fprintf(stream, "%s %s", "Lynx", "2.8.7dev.11");
    if (LynxSigFile != 0) {
        struct _IO_FILE * v3 = fopen64((char *)LynxSigFile, "r"); // 0x80587df
        if (v3 != NULL) {
            // 0x80587ed
            fwrite((int32_t *)"-- \n", 1, 4, stream);
            if (LYSafeGets(&address, v3) != NULL) {
                fputs(address, stream);
                while (LYSafeGets(&address, v3) != NULL) {
                    // 0x8058812
                    fputs(address, stream);
                }
            }
            // 0x805883a
            LYCloseInput(v3);
        }
    }
    // 0x8058845
    pclose(stream);
    if (traversal != 0) {
        struct _IO_FILE * v4 = LYAppendToTxtFile("traverse.errors"); // 0x8058866
        struct _IO_FILE * stream2 = v4; // 0x8058872
        if (v4 == NULL) {
            // 0x8058874
            stream2 = LYNewTxtFile("traverse.errors");
            if (stream2 == NULL) {
                // 0x8058889
                perror(gettext("Unable to open traversal errors output file"));
                exit_immediately(1);
                // UNREACHABLE
            }
        }
        int32_t v5 = 68 * cur; // 0x80588b4
        int32_t v6 = *(int32_t *)(v5 + (int32_t)&g343); // 0x80588b6
        int32_t v7 = *(int32_t *)(v5 + (int32_t)&links); // 0x80588c9
        fprintf(stream2, "%s\t%s \tin %s\n", (char *)v7, (char *)v6, filename);
        LYCloseOutput(stream2);
    }
    // 0x80588fc
    if (fd != NULL) {
        // 0x8058903
        free(fd);
        fd = NULL;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x805891c - 0x805a0f9
// Line range:    1094 - 1720
void reply_by_mail(char * mail_address, char * filename, char * title, char * refid) {
    char buf[4096]; // bp-5476, 0x805891c
    char v1[4096]; // 0x8058b22
    char v2[4096]; // 0x8059ea0
    char v3[4096]; // 0x8059d6a
    int32_t v4 = __readgsdword(20); // 0x805894a
    int32_t * fp = NULL; // bp-5488, 0x805895f
    char * label = NULL; // bp-5492, 0x8058969
    char * from_address = NULL; // bp-5496, 0x8058973
    char * cc_address = NULL; // bp-5500, 0x805897d
    char * to_address = NULL; // bp-5504, 0x8058987
    char * the_subject = NULL; // bp-5508, 0x8058991
    char * ccaddr = NULL; // bp-5512, 0x805899b
    char * keywords = NULL; // bp-5516, 0x80589a5
    int32_t i = 0; // bp-5536, 0x80589cd
    if (WWW_TraceFlag != 0) {
        char * v5 = refid == NULL ? "(null)" : refid;
        char * v6 = title == NULL ? "(null)" : title; // 0x8058a79
        char * v7 = filename == NULL ? "(null)" : filename;
        char * v8 = mail_address == NULL ? "(null)" : mail_address;
        fprintf(TraceFP(), "reply_by_mail(\"%s\", \"%s\", \"%s\", \"%s\")\n", v8, v7, v6, v5);
    }
    // 0x8058aa9
    term_letter = 0;
    int32_t v9; // bp-348, 0x805891c
    char str; // bp-92, 0x805891c
    int32_t stream; // 0x8058b28
    if (LYSystemMail() == 0) {
        goto lab_0x805a0df;
    } else {
        char * v10; // 0x8058ada
        if (mail_address == NULL) {
            // 0x8058ad3
            v10 = gettext("No email address is present in mailto URL!");
            HTAlert(v10);
            goto lab_0x805a0df;
        } else {
            // 0x8058ac6
            if (*mail_address != 0) {
                // 0x8058aec
                HTSACopy(&from_address, mail_address);
                struct _IO_FILE * v11 = LYOpenTemp((char *)&v9, ".txt", "w"); // 0x8058b1d
                v1[0] = (int32_t)v11;
                buf = v1;
                stream = *(int32_t *)&buf;
                if (stream != 0) {
                    // 0x8058b4a
                    str = 0;
                    char * found_char_pos = strchr(from_address, 63); // 0x8058b5f
                    if (found_char_pos != NULL) {
                        // 0x8058b77
                        HTSACopy(&ccaddr, found_char_pos);
                        *found_char_pos = 0;
                        if (*(char *)((int32_t)ccaddr + 1) != 0) {
                            // 0x8058bb8
                            extract_subject(&str, ccaddr);
                            extract_field(&from_address, ccaddr, "to=");
                            extract_field(&to_address, ccaddr, "cc=");
                            extract_field(&the_subject, ccaddr, "keywords=");
                            char * v12 = the_subject; // 0x8058c2d
                            if (v12 != NULL) {
                                // 0x8058c37
                                if (*v12 == 0) {
                                    // 0x8058c5e
                                    free((int32_t *)v12);
                                    the_subject = NULL;
                                } else {
                                    // 0x8058c44
                                    SafeHTUnEscape(v12);
                                }
                            }
                            // 0x8058c76
                            extract_body(&keywords, ccaddr);
                            if (ccaddr != NULL) {
                                // 0x8058c98
                                free((int32_t *)ccaddr);
                                ccaddr = NULL;
                            }
                        }
                    }
                    // 0x8058cb0
                    if (convert_explorer(from_address) == 0) {
                        char * v13 = to_address; // 0x8058cdb
                        if (v13 != NULL) {
                            char * v14 = to_address; // 0x8058cf7
                            if (convert_explorer(v13) != 0 && v14 != NULL) {
                                // 0x8058d01
                                free((int32_t *)v14);
                                to_address = NULL;
                            }
                        }
                        // 0x8058d19
                        SafeHTUnEscape(from_address);
                        char * v15 = to_address; // 0x8058d27
                        if (v15 != NULL) {
                            // 0x8058d31
                            SafeHTUnEscape(v15);
                        }
                        // 0x8058d3f
                        if (title != NULL && str == 0) {
                            // 0x8058d50
                            if (*title != 0) {
                                // 0x8058d5d
                                strncpy(&str, title, 70);
                            }
                        }
                        // 0x8058d7e
                        signal(SIGINT, 0x8057038);
                        HTSprintf((char **)&i, "To: %s\n", from_address);
                        int32_t v16 = *(int32_t *)(32 * current_char_set + (int32_t)&g143); // 0x8058dba
                        if (strncasecomp((char *)v16, "us-ascii", 8) != 0) {
                            // 0x8058de0
                            HTSACat((char **)&i, "Mime-Version: 1.0\n");
                            if (LYHaveCJKCharacterSet == 0) {
                                int32_t v17 = *(int32_t *)(32 * current_char_set + (int32_t)&g143); // 0x8058e09
                                if (strncasecomp((char *)v17, "x-", 2) != 0) {
                                    int32_t v18 = *(int32_t *)(32 * current_char_set + (int32_t)&g143); // 0x8058e33
                                    HTSprintf((char **)&i, "Content-Type: text/plain; charset=%s\n", (char *)v18);
                                }
                            }
                            // 0x8058e53
                            HTSACat((char **)&i, "Content-Transfer-Encoding: 8bit\n");
                        }
                        if (filename == NULL) {
                            // 0x8058ea1
                            HTSprintf((char **)&i, "X-URL: mailto:%s\n", from_address);
                            goto lab_0x8058ec1;
                        } else {
                            // 0x8058e72
                            if (*filename == 0) {
                                // 0x8058ea1
                                HTSprintf((char **)&i, "X-URL: mailto:%s\n", from_address);
                                goto lab_0x8058ec1;
                            } else {
                                // 0x8058e7f
                                HTSprintf((char **)&i, "X-URL: %s\n", filename);
                                goto lab_0x8058ec1;
                            }
                        }
                    } else {
                        // 0x8058cc2
                        HTAlert(gettext("No email address is present in mailto URL!"));
                        goto lab_0x8059f6f_5;
                    }
                } else {
                    // 0x8058b31
                    HTAlert(gettext("Unable to open temporary file for mailto URL!"));
                    goto lab_0x805a0df;
                }
            } else {
                // 0x8058ad3
                v10 = gettext("No email address is present in mailto URL!");
                HTAlert(v10);
                goto lab_0x805a0df;
            }
        }
    }
  lab_0x8059f6f_5:
    // 0x8059f6f
    HTInfoMsg(gettext("Cancelled!!!"));
    LYCloseTempFP((struct _IO_FILE *)stream);
    function_804a784((int32_t)LYwin, 0);
    goto lab_0x8059fa6;
  lab_0x805989f:;
    // 0x805989f
    char * v28; // 0x805891c
    *v28 = 0;
    char * str8 = (char *)((int32_t)v28 + 1); // 0x80598a8
    char * str7; // 0x805891c
    fprintf((struct _IO_FILE *)stream, "%s\n", str7);
    LYwaddnstr(LYwin, str7, strlen(str7));
    LYwaddnstr(LYwin, "\n", 1);
    char * v32; // 0x805891c
    int32_t v47 = (int32_t)v32 - 1; // 0x8059922
    char * v48 = (char *)v47;
    char * found_char_pos5 = strchr(str8, 10); // 0x805993a
    char * v27 = str8; // 0x805994c
    v28 = found_char_pos5;
    char * v29 = v48; // 0x805994c
    int32_t v30 = v47; // 0x805994c
    char * v26 = v48; // 0x805994c
    if (found_char_pos5 == NULL) {
        // break -> 0x8059978
        goto lab_0x8059978;
    }
    goto lab_0x8059795;
  lab_0x805a0df:
    // 0x805a0df
    if (v4 != __readgsdword(20)) {
        // 0x805a0eb
        __stack_chk_fail();
    }
  lab_0x8058ec1:
    // 0x8058ec1
    HTSprintf((char **)&i, "X-Mailer: %s, Version %s\n", "Lynx", "2.8.7dev.11");
    if (refid != NULL) {
        // 0x8058ef0
        if (*refid != 0) {
            // 0x8058efd
            HTSprintf((char **)&i, "In-Reply-To: <%s>\n", refid);
        }
    }
    // 0x8058f1d
    LYclear();
    LYmove(2, 0);
    function_804a784((int32_t)LYwin, 1);
    if (keywords == NULL) {
        int32_t len = strlen(gettext("You are sending a comment to:\n  ")); // 0x8058f9e
        LYwaddnstr(LYwin, gettext("You are sending a comment to:\n  "), len);
    } else {
        int32_t len2 = strlen(gettext("You are sending a message with body to:\n  ")); // 0x8058f64
        LYwaddnstr(LYwin, gettext("You are sending a message with body to:\n  "), len2);
    }
    // 0x8058fc7
    show_addresses(from_address);
    char * str2 = to_address; // 0x8058fd5
    if (str2 != NULL) {
        // 0x8058fee
        if (strchr(str2, 44) == NULL) {
            int32_t len3 = strlen(gettext("\n With copy to:\n  ")); // 0x8059051
            LYwaddnstr(LYwin, gettext("\n With copy to:\n  "), len3);
        } else {
            int32_t len4 = strlen(gettext("\n With copies to:\n  ")); // 0x8059017
            LYwaddnstr(LYwin, gettext("\n With copies to:\n  "), len4);
        }
        // 0x805907a
        show_addresses(to_address);
    }
    int32_t len5 = strlen(gettext("\n\nUse Ctrl-G to cancel if you do not want to send a message\n")); // 0x8059097
    LYwaddnstr(LYwin, gettext("\n\nUse Ctrl-G to cancel if you do not want to send a message\n"), len5);
    int32_t len6 = strlen(gettext("\n Please enter your name, or leave it blank to remain anonymous\n")); // 0x80590cf
    LYwaddnstr(LYwin, gettext("\n Please enter your name, or leave it blank to remain anonymous\n"), len6);
    if (header_prompt("X-Personal_Name: ", &g177, 1024) == 0) {
        goto lab_0x8059f6f_5;
    } else {
        // 0x8059128
        if (*g177 != 0) {
            // 0x8059134
            HTSprintf((char **)&i, "%s: %s\n", (int32_t *)"X-Personal_Name: ", g177);
        }
        int32_t len7 = strlen(gettext("\n Please enter a mail address or some other\n")); // 0x805916c
        LYwaddnstr(LYwin, gettext("\n Please enter a mail address or some other\n"), len7);
        int32_t len8 = strlen(gettext(" means to contact you, if you desire a response.\n")); // 0x80591a4
        LYwaddnstr(LYwin, gettext(" means to contact you, if you desire a response.\n"), len8);
        if (personal_mail_address != 0) {
            // 0x80591e0
            HTSACopy((char **)&fp, (char *)personal_mail_address);
        }
        // 0x80591f7
        if (header_prompt("From", (char **)&fp, 1024) == 0) {
            goto lab_0x8059f6f_5;
        } else {
            // 0x805921f
            HTSprintf((char **)&i, "%s: %s\n", (int32_t *)"From", fp);
            int32_t len9 = strlen(gettext("\n Please enter a subject line.\n")); // 0x8059258
            LYwaddnstr(LYwin, gettext("\n Please enter a subject line.\n"), len9);
            if (str == 0) {
                if (filename == NULL) {
                    // 0x80592e2
                    HTSprintf(&cc_address, "mailto:%s", from_address);
                    goto lab_0x8059302;
                } else {
                    // 0x80592b3
                    if (*filename == 0) {
                        // 0x80592e2
                        HTSprintf(&cc_address, "mailto:%s", from_address);
                        goto lab_0x8059302;
                    } else {
                        // 0x80592c0
                        HTSprintf(&cc_address, "%s", filename);
                        goto lab_0x8059302;
                    }
                }
            } else {
                // 0x8059293
                HTSACopy(&cc_address, &str);
                goto lab_0x8059302;
            }
        }
    }
  lab_0x8059fa6:
    // 0x8059fa6
    signal(SIGINT, 0x804b4e4);
    term_letter = 0;
    if (i != 0) {
        // 0x8059fcb
        free((int32_t *)i);
        i = 0;
    }
    // 0x8059fe3
    LYRemoveTemp((char *)&v9);
    if (fp != NULL) {
        // 0x8059ffb
        free(fp);
        fp = NULL;
    }
    // 0x805a013
    if (cc_address != NULL) {
        // 0x805a01d
        free((int32_t *)cc_address);
        cc_address = NULL;
    }
    // 0x805a035
    if (label != NULL) {
        // 0x805a03f
        free((int32_t *)label);
        label = NULL;
    }
    // 0x805a057
    if (from_address != NULL) {
        // 0x805a061
        free((int32_t *)from_address);
        from_address = NULL;
    }
    // 0x805a079
    if (to_address != NULL) {
        // 0x805a083
        free((int32_t *)to_address);
        to_address = NULL;
    }
    // 0x805a09b
    if (the_subject != NULL) {
        // 0x805a0a5
        free((int32_t *)the_subject);
        the_subject = NULL;
    }
    // 0x805a0bd
    if (keywords != NULL) {
        // 0x805a0c7
        free((int32_t *)keywords);
        keywords = NULL;
    }
    goto lab_0x805a0df;
  lab_0x8059302:
    // 0x8059302
    if (header_prompt("Subject", &cc_address, 70) == 0) {
        goto lab_0x8059f6f_5;
    } else {
        // 0x805932a
        if (LYNoCc != 0) {
            goto lab_0x8059407;
        } else {
            int32_t len10 = strlen(gettext("\n Enter a mail address for a CC of your message.\n")); // 0x8059348
            LYwaddnstr(LYwin, gettext("\n Enter a mail address for a CC of your message.\n"), len10);
            int32_t len11 = strlen(gettext(" (Leave blank if you don't want a copy.)\n")); // 0x8059380
            LYwaddnstr(LYwin, gettext(" (Leave blank if you don't want a copy.)\n"), len11);
            if (personal_mail_address != 0) {
                // 0x80593b2
                HTSACopy(&label, (char *)personal_mail_address);
            }
            // 0x80593c9
            if (header_prompt("Cc", &label, 1024) == 0) {
                goto lab_0x8059f6f_5;
            } else {
                // 0x80593ef
                comma_append(&to_address, label);
                goto lab_0x8059407;
            }
        }
    }
  lab_0x8059407:
    // 0x8059407
    HTSprintf((char **)&i, "%s: %s\n", (int32_t *)"Subject", cc_address);
    char * v19 = to_address; // 0x8059431
    if (v19 != NULL) {
        // 0x805943b
        if (*v19 != 0) {
            // 0x8059448
            HTSprintf((char **)&i, "Cc: %s\n", v19);
        }
    }
    char * v20 = the_subject; // 0x8059468
    if (v20 != NULL) {
        // 0x8059472
        if (*v20 != 0) {
            // 0x805947f
            HTSprintf((char **)&i, "Keywords: %s\n", v20);
        }
    }
    // 0x805949f
    HTSACat((char **)&i, "\n");
    if (WWW_TraceFlag != 0) {
        // 0x80594c0
        fprintf(TraceFP(), "**header==\n%s", (char *)i);
    }
    // 0x80594e1
    char v21; // 0x805891c
    char * v22; // 0x805891c
    if (no_editor != 0 || editor == 0) {
        goto lab_0x8059712;
    } else {
        // 0x80594fd
        if (*(char *)editor == 0) {
            goto lab_0x8059712;
        } else {
            char * str3 = keywords; // 0x805950d
            if (str3 == NULL) {
                // 0x805958b
                if (*HTLoadedDocumentURL() == 0) {
                    goto lab_0x805963a;
                } else {
                    // 0x805959b
                    if (LYPreparsedSource == 0) {
                        goto lab_0x80595ef;
                    } else {
                        // 0x80595a6
                        if (HTisDocumentSource() == 0) {
                            goto lab_0x80595ef;
                        } else {
                            // 0x80595db
                            v21 = 0;
                            v22 = gettext("Do you wish to include the preparsed source?");
                            goto lab_0x8059601;
                        }
                    }
                }
            } else {
                char * found_char_pos2 = strchr(str3, 10); // 0x8059572
                if (found_char_pos2 != NULL) {
                    // 0x8059525
                    *found_char_pos2 = 0;
                    char * str4 = (char *)((int32_t)found_char_pos2 + 1); // 0x805952e
                    fprintf((struct _IO_FILE *)stream, "%s\n", str3);
                    char * found_char_pos3 = strchr(str4, 10); // 0x8059572
                    while (found_char_pos3 != NULL) {
                        char * v23 = str4;
                        *found_char_pos3 = 0;
                        str4 = (char *)((int32_t)found_char_pos3 + 1);
                        fprintf((struct _IO_FILE *)stream, "%s\n", v23);
                        found_char_pos3 = strchr(str4, 10);
                    }
                }
                goto lab_0x805963a;
            }
        }
    }
  lab_0x8059712:
    // 0x8059712
    if (keywords == NULL) {
        int32_t len12 = strlen(gettext("\n Please enter your message below.")); // 0x80599bd
        LYwaddnstr(LYwin, gettext("\n Please enter your message below."), len12);
        int32_t len13 = strlen(gettext("\n When you are done, press enter and put a single period (.)")); // 0x80599f5
        LYwaddnstr(LYwin, gettext("\n When you are done, press enter and put a single period (.)"), len13);
        int32_t len14 = strlen(gettext("\n on a line and press enter again.")); // 0x8059a2d
        LYwaddnstr(LYwin, gettext("\n on a line and press enter again."), len14);
        LYwaddnstr(LYwin, "\n\n", 2);
        LYrefresh();
        char str5 = 0; // bp-1372, 0x8059a78
        if (LYgetstr(&str5, 0, 1024, 0) < 0) {
            goto lab_0x8059f6f_5;
        } else {
            // 0x8059aad
            if (term_letter != 0) {
                goto lab_0x8059f6f_5;
            } else {
                // 0x8059abc
                if (strcmp(&str5, ".") == 0) {
                    goto lab_0x8059f6f_5;
                } else {
                    struct _IO_FILE * stream2 = (struct _IO_FILE *)stream;
                    while (strcmp(&str5, ".") != 0 == term_letter == 0) {
                        // 0x8059adf
                        LYwaddnstr(LYwin, "\n", 1);
                        remove_tildes(&str5);
                        fprintf(stream2, "%s\n", &str5);
                        str5 = 0;
                        if (LYgetstr(&str5, 0, 1024, 0) < 0) {
                            goto lab_0x8059f6f_5;
                        }
                    }
                    // 0x8059b88
                    fputc(10, stream2);
                    LYCloseTempFP(stream2);
                    function_804a784((int32_t)LYwin, 0);
                    goto lab_0x8059bc1;
                }
            }
        }
    } else {
        // 0x8059720
        LYclear();
        LYmove(0, 0);
        int32_t len15 = strlen(gettext("\n Please review the message body:\n\n")); // 0x8059748
        LYwaddnstr(LYwin, gettext("\n Please review the message body:\n\n"), len15);
        LYrefresh();
        char * str6 = keywords;
        int32_t v24 = LYlines - 5; // 0x8059787
        char * v25 = (char *)v24;
        char * found_char_pos4 = strchr(str6, 10); // 0x805993a
        v26 = v25;
        if (found_char_pos4 != NULL) {
            // 0x8059795
            v27 = str6;
            v28 = found_char_pos4;
            v29 = v25;
            v30 = v24;
            while (true) {
              lab_0x8059795:;
                int32_t v31 = v30;
                str7 = v27;
                v32 = v29;
                if (v31 >= 0 == (v31 != 0)) {
                    goto lab_0x805989f;
                } else {
                    int32_t len16 = strlen(gettext("\nPress RETURN to continue: ")); // 0x80597b1
                    LYwaddnstr(LYwin, gettext("\nPress RETURN to continue: "), len16);
                    LYrefresh();
                    uint32_t v33 = LYgetch(); // 0x80597df
                    LYwaddnstr(LYwin, "\n", 1);
                    if (term_letter != 0) {
                        goto lab_0x8059f6f_5;
                    }
                    switch (v33) {
                        case 7: {
                            goto lab_0x8059f6f_5;
                        }
                        case 3: {
                            goto lab_0x8059f6f_5;
                        }
                        default: {
                            if ((char *)v33 != (char *)-1) {
                                if ((v33 & 0x8800) == 0) {
                                    // 0x8059871
                                    if (*(int16_t *)((2 * v33 & 4094) + 0x8197ea2) == 47) {
                                        goto lab_0x8059f6f_5;
                                    }
                                } else {
                                    if (v33 % 256 == 47) {
                                        goto lab_0x8059f6f_5;
                                    }
                                }
                            } else {
                                // 0x8059839
                                if (keymap[0] == 47) {
                                    goto lab_0x8059f6f_5;
                                }
                            }
                            // 0x8059891
                            v32 = (char *)(LYlines - 2);
                            goto lab_0x805989f;
                        }
                    }
                }
            }
        }
      lab_0x8059978:;
        char * v34 = v26; // 0x805997f
        if (v26 >= NULL) {
            LYwaddnstr(LYwin, "\n", 1);
            int32_t v35 = (int32_t)v34 - 1; // 0x8059971
            v34 = (char *)v35;
            while (v35 >= 0) {
                // 0x8059954
                LYwaddnstr(LYwin, "\n", 1);
                v35 = (int32_t)v34 - 1;
                v34 = (char *)v35;
            }
        }
        // 0x8059981
        LYrefresh();
        LYCloseTempFP((struct _IO_FILE *)stream);
        function_804a784((int32_t)LYwin, 0);
        goto lab_0x8059bc1;
    }
  lab_0x8059bc1:
    // 0x8059bc1
    signal(SIGINT, SIG_IGN);
    LYStatusLine = LYlines - 1;
    char * v36; // 0x805891c
    if (keywords == NULL) {
        // 0x8059c00
        v36 = gettext("Send this comment?");
    } else {
        // 0x8059bec
        v36 = gettext("Send this message?");
    }
    char v37 = HTConfirm(v36); // 0x8059c1b
    LYStatusLine = -1;
    if (v37 == 1) {
        // 0x8059c46
        if (keywords == NULL && LynxSigFile != 0) {
            struct _IO_FILE * v38 = fopen64((char *)LynxSigFile, "r"); // 0x8059c71
            if (v38 != NULL) {
                // 0x8059c89
                LYStatusLine = LYlines - 1;
                if (term_letter == 0) {
                    char * header = NULL; // bp-5544, 0x8059cd2
                    char * v39 = gettext("Append '%s'?"); // 0x8059ce9
                    HTSprintf0(&header, v39);
                    char v40 = HTConfirm(header); // 0x8059d0d
                    char * v41 = header; // 0x8059d1b
                    if (v41 != NULL) {
                        // 0x8059d25
                        free((int32_t *)v41);
                        header = NULL;
                    }
                    // 0x8059d3d
                    LYStatusLine = -1;
                    if ((char *)(int32_t)v40 == (char *)1) {
                        struct _IO_FILE * v42 = fopen64((char *)&v9, "a+"); // 0x8059d65
                        v3[0] = (int32_t)v42;
                        buf = v3;
                        int32_t v43 = *(int32_t *)&buf; // 0x8059d70
                        if (v43 != 0) {
                            // 0x8059d7d
                            header = NULL;
                            struct _IO_FILE * stream3 = (struct _IO_FILE *)v43;
                            fwrite((int32_t *)"-- \n", 1, 4, stream3);
                            if (LYSafeGets(&header, v38) != NULL) {
                                fputs(header, stream3);
                                while (LYSafeGets(&header, v38) != NULL) {
                                    // 0x8059daf
                                    fputs(header, stream3);
                                }
                            }
                            // 0x8059de3
                            LYCloseOutput(stream3);
                            if (header != NULL) {
                                // 0x8059dfb
                                free((int32_t *)header);
                                header = NULL;
                            }
                        }
                    }
                } else {
                    // 0x8059d3d
                    mustshow = 1;
                    user_message(gettext("Append '%s'?"), (char *)LynxSigFile);
                    LYStatusLine = -1;
                }
                // 0x8059e13
                LYCloseInput(v38);
            }
        }
        // 0x8059e21
        LYclear();
        mustshow = 1;
        statusline(gettext("Sending your message..."));
        signal(SIGINT, SIG_IGN);
        struct _IO_FILE * stream4 = LYPipeToMailer(); // 0x8059e55
        if (stream4 != NULL) {
            struct _IO_FILE * v44 = fopen64((char *)&v9, "r"); // 0x8059e9b
            v2[0] = (int32_t)v44;
            buf = v2;
            int32_t v45 = *(int32_t *)&buf; // 0x8059ea6
            if (v45 != 0) {
                // 0x8059ed6
                fputs((char *)i, stream4);
                struct _IO_FILE * stream5 = (struct _IO_FILE *)v45;
                int32_t data; // bp-5468, 0x805891c
                int32_t items_read = fread(&data, 1, 0x1000, stream5); // 0x8059f3d
                int32_t nmemb = items_read; // 0x8059f4f
                if (items_read != 0) {
                    fwrite(&data, 1, nmemb, stream4);
                    int32_t items_read2 = fread(&data, 1, 0x1000, stream5); // 0x8059f3d
                    nmemb = items_read2;
                    while (items_read2 != 0) {
                        // 0x8059ef0
                        fwrite(&data, 1, nmemb, stream4);
                        items_read2 = fread(&data, 1, 0x1000, stream5);
                        nmemb = items_read2;
                    }
                }
                // 0x8059f51
                pclose(stream4);
                LYCloseInput(stream5);
            } else {
                // 0x8059eaf
                HTInfoMsg(gettext("Cancelled!!!"));
                pclose(stream4);
            }
        } else {
            // 0x8059e7d
            HTInfoMsg(gettext("Cancelled!!!"));
        }
    } else {
        // 0x8059c3c
        LYclear();
    }
    goto lab_0x8059fa6;
  lab_0x805963a:
    // 0x805963a
    LYCloseTempFP((struct _IO_FILE *)stream);
    function_804a784((int32_t)LYwin, 0);
    if (term_letter != 0) {
        goto lab_0x8059fa6;
    } else {
        // 0x80596c7
        if (*(int16_t *)0x8197ea2 == 47) {
            goto lab_0x8059fa6;
        } else {
            char * v46 = gettext("Spawning your selected editor to edit mail message"); // 0x80596ee
            edit_temporary_file((char *)&v9, (char *)&g9, v46);
            goto lab_0x8059bc1;
        }
    }
  lab_0x80595ef:
    // 0x80595ef
    v21 = 1;
    v22 = gettext("Do you wish to include the original message?");
    goto lab_0x8059601;
  lab_0x8059601:
    // 0x8059601
    if (HTConfirm(v22) == 1) {
        // 0x8059613
        print_wwwfile_to_fd((struct _IO_FILE *)stream, 1, v21);
    }
    goto lab_0x805963a;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMail.c
// Address range: 0x805a0f9 - 0x805a145
// Line range:    1726 - 1732
char LYSystemMail(void) {
    // 0x805a0f9
    if (system_mail != 0) {
        // 0x805a108
        if (strcmp((char *)system_mail, "unknown") != 0) {
            // 0x805a13f
            return 1;
        }
    }
    // 0x805a121
    HTAlert(gettext("No system mailer configured"));
    // 0x805a13f
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805a148 - 0x805a245
// Line range:    50 - 64
void HTAlert(char * Msg) {
    // 0x805a148
    if (WWW_TraceFlag != 0) {
        // 0x805a179
        fprintf(TraceFP(), "\nAlert!: %s\n\n", Msg);
        if (WWW_TraceFlag != 0) {
            // 0x805a184
            fflush(TraceFP());
        }
    }
    // 0x805a191
    mustshow = 1;
    user_message(gettext("Alert!: %s"), Msg);
    LYstore_message2(gettext("Alert!: %s"), Msg);
    if (dump_output_immediately != 0 && dump_to_stderr != 0) {
        // 0x805a1e8
        fflush((struct _IO_FILE *)g164);
        fprintf((struct _IO_FILE *)g160, gettext("Alert!: %s"));
        fputc(10, (struct _IO_FILE *)g160);
        fflush((struct _IO_FILE *)g160);
    }
    // 0x805a23e
    LYSleepAlert();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805a245 - 0x805a3e5
// Line range:    68 - 89
void HTAlwaysAlert(char * extra_prefix, char * Msg) {
    // 0x805a245
    if (dump_output_immediately == 0 && LYCursesON != 0) {
        // 0x805a261
        HTAlert(Msg);
        // 0x805a3e3
        return;
    }
    if (extra_prefix == NULL) {
        // 0x805a2fe
        fprintf((struct _IO_FILE *)(WWW_TraceFlag == 0 ? g160 : g164), gettext("Alert!: %s"));
        fflush((struct _IO_FILE *)g164);
        LYstore_message2(gettext("Alert!: %s"), Msg);
        LYSleepAlert();
        fputc(10, (struct _IO_FILE *)(WWW_TraceFlag == 0 ? g160 : g164));
    } else {
        // 0x805a277
        fprintf((struct _IO_FILE *)(WWW_TraceFlag == 0 ? g160 : g164), "%s %s!\n", extra_prefix, Msg);
        fflush((struct _IO_FILE *)g164);
        LYstore_message2(gettext("Alert!: %s"), Msg);
        LYSleepAlert();
    }
    // 0x805a3a2
    if (WWW_TraceFlag == 0) {
        // 0x805a3e3
        return;
    }
    // 0x805a3cb
    fprintf(TraceFP(), "\nAlert!: %s\n\n", Msg);
    if (WWW_TraceFlag != 0) {
        // 0x805a3d6
        fflush(TraceFP());
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805a3e5 - 0x805a448
// Line range:    95 - 102
void HTInfoMsg(char * Msg) {
    // 0x805a3e5
    mustshow = 1;
    statusline(Msg);
    if (Msg == NULL || *Msg == 0) {
        // 0x805a446
        return;
    }
    // 0x805a40d
    if (WWW_TraceFlag != 0) {
        // 0x805a418
        fprintf(TraceFP(), "Info message: %s\n", Msg);
    }
    // 0x805a436
    LYstore_message(Msg);
    LYSleepInfo();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805a506 - 0x805a569
// Line range:    120 - 133
void HTUserMsg(char * Msg) {
    // 0x805a506
    mustshow = 1;
    statusline(Msg);
    if (Msg == NULL || *Msg == 0) {
        // 0x805a567
        return;
    }
    // 0x805a52e
    if (WWW_TraceFlag != 0) {
        // 0x805a539
        fprintf(TraceFP(), "User message: %s\n", Msg);
    }
    // 0x805a557
    LYstore_message(Msg);
    LYSleepMsg();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805a569 - 0x805a627
// Line range:    136 - 145
void HTUserMsg2(char * Msg2, char * Arg) {
    // 0x805a569
    mustshow = 1;
    user_message(Msg2, Arg);
    if (Msg2 == NULL || *Msg2 == 0) {
        // 0x805a625
        return;
    }
    // 0x805a5a0
    if (WWW_TraceFlag == 0) {
        // 0x805a60e
        LYstore_message2(Msg2, Arg);
        LYSleepMsg();
        // 0x805a625
        return;
    }
    // 0x805a5c2
    fprintf(TraceFP(), "User message: ");
    if (WWW_TraceFlag == 0) {
        // 0x805a60e
        LYstore_message2(Msg2, Arg);
        LYSleepMsg();
        // 0x805a625
        return;
    }
    // 0x805a5ec
    fprintf(TraceFP(), Msg2);
    if (WWW_TraceFlag != 0) {
        // 0x805a5f7
        fprintf(TraceFP(), "\n");
    }
    // 0x805a60e
    LYstore_message2(Msg2, Arg);
    LYSleepMsg();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805a627 - 0x805a673
// Line range:    151 - 156
void HTProgress(char * Msg) {
    // 0x805a627
    statusline(Msg);
    LYstore_message(Msg);
    if (WWW_TraceFlag != 0) {
        // 0x805a64e
        fprintf(TraceFP(), "%s\n", Msg);
    }
    // 0x805a66c
    LYSleepDebug();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805a673 - 0x805a6c8
// Line range:    159 - 172
char * HTProgressUnits(int32_t rate) {
    char * v1 = g179; // 0x805a679
    char * v2; // 0x805a673
    int32_t v3; // 0x805a673
    if (v1 != NULL) {
        // 0x805a673
        v3 = g178;
        v2 = v1;
    } else {
        // 0x805a682
        g179 = gettext("bytes");
        int32_t v4 = (int32_t)gettext((char *)LYTransferName); // 0x805a69b
        g178 = v4;
        v3 = v4;
        v2 = g179;
    }
    int32_t v5 = rate != 2 == (rate != 4) ? (int32_t)v2 : v3;
    return (char *)v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805a6c8 - 0x805a869
// Line range:    175 - 195
char * sprint_bytes(char * s, int64_t n, char * was_units) {
    // 0x805a6c8
    int32_t v1; // 0x805a6c8
    int32_t v2 = v1;
    int64_t v3 = 0x100000000 * n >> 32; // 0x805a6d2
    char * v4 = HTProgressUnits(LYTransferRate); // 0x805a6e3
    int32_t v5 = LYTransferRate; // 0x805a6eb
    char * result; // 0x805a6c8
    if (v5 != 2 == (v5 != 4)) {
        // 0x805a80a
        sprintf(s, "%lld", v3);
        result = v4;
        goto lab_0x805a82b;
    } else {
        uint32_t v6 = (int32_t)g94;
        int32_t v7 = (int32_t)g95;
        int32_t v8 = 10 * v7 + v6 / 0x1999999a; // 0x805a72e
        int32_t v9 = (int32_t)was_units; // 0x805a737
        if (v8 > v9) {
            goto lab_0x805a791;
        } else {
            if (v8 < v9) {
                goto lab_0x805a791;
            } else {
                // 0x805a74c
                sprintf(s, "%lld", (int64_t)__divdi3((int32_t)v3, v9, v6, v7));
                result = v4;
                goto lab_0x805a82b;
            }
        }
    }
  lab_0x805a82b:
    // 0x805a82b
    if (v2 != 0 != (v2 == (int32_t)result)) {
        // 0x805a839
        sprintf((char *)(strlen(s) + (int32_t)s), " %s", result);
    }
    // 0x805a860
    return result;
  lab_0x805a791:
    if (was_units < NULL) {
        goto lab_0x805a7d8;
    } else {
        if (was_units == NULL == (int32_t)v3 < 1000) {
            goto lab_0x805a7d8;
        } else {
            // 0x805a7a6
            sprintf(g94, g95, (float64_t)(int64_t)(int32_t)s);
            result = v4;
            goto lab_0x805a82b;
        }
    }
  lab_0x805a7d8:
    // 0x805a7d8
    sprintf(s, "%lld", v3);
    result = HTProgressUnits(1);
    goto lab_0x805a82b;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805a869 - 0x805aa02
// Line range:    200 - 208
char * sprint_tbuf(char * s, int32_t t) {
    if ((uint32_t)t >= 3601) {
        int64_t v1 = t; // 0x805a88a
        int32_t v2 = (int32_t)(-0x77777777 * v1 / 0x100000000) + t; // 0x805a88c
        int32_t v3 = v2 >> 5; // 0x805a891
        sprintf(s, "%ldh%ldm%lds", (int32_t)(-0x6e5d4c3b * v1 / 0x100000000) + t >> 11, -60 * ((v3 + (int32_t)(-0x77777777 * (int64_t)v3 / 0x100000000) >> 5) - (v2 >> 31)) + v3, -60 * v3 + t);
        // 0x805a9f9
        return s;
    }
    if (t < 61) {
        // 0x805a9df
        sprintf(s, "%ld sec", t);
    } else {
        int32_t v4 = (int32_t)((uint64_t)(-0x77777777 * (int64_t)t) / 0x100000000) + t >> 5; // 0x805a976
        sprintf(s, "%ldm%lds", v4, -60 * v4 + t);
    }
    // 0x805a9f9
    return s;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805aa02 - 0x805b052
// Line range:    215 - 378
void HTReadProgress(int64_t bytes, int64_t total) {
    char transferp[80]; // bp-284, 0x805aa02
    int32_t v1 = __readgsdword(20); // 0x805aa32
    transferp = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char * was_units; // bp-296, 0x805aa02
    gettimeofday((struct timeval *)&was_units, NULL);
    int3_t v2; // 0x805aa02
    int3_t v3 = v2 - 1; // 0x805aa64
    __frontend_reg_store_fpr(v3, (float80_t)(int32_t)was_units);
    int3_t v4 = v2 - 2; // 0x805aa72
    int32_t v5; // 0x805aa02
    __frontend_reg_store_fpr(v4, (float80_t)v5);
    int3_t v6 = v2 - 3; // 0x805aa79
    __frontend_reg_store_fpr(v6, 1.0e+6L);
    __frontend_reg_store_fpr(v4, __frontend_reg_load_fpr(v4) / __frontend_reg_load_fpr(v6));
    __frontend_reg_store_fpr(v3, __frontend_reg_load_fpr(v4) + __frontend_reg_load_fpr(v3));
    float80_t v7 = __frontend_reg_load_fpr(v3); // 0x805aa83
    if (LYShowTransferRate == 0) {
        // 0x805aa94
        LYTransferRate = 0;
    }
    int64_t v8 = v5; // 0x805aa23
    char * v9 = (char *)v5; // 0x805aa2c
    char * v10; // 0x805aa02
    int32_t v11; // 0x805aa02
    int32_t v12; // 0x805aa02
    float64_t v13; // 0x805aa02
    float64_t v14; // 0x805aa02
    int64_t v15; // 0x805aa02
    if (((int32_t)(float32_t)(float64_t)(0x100000000 * total >> 32) || (int32_t)(float32_t)(float64_t)(0x100000000 * bytes >> 32)) != 0) {
        // 0x805aaed
        v11 = (float32_t)(float64_t)(0x100000000 * total >> 32);
        v10 = v9;
        v15 = v8;
        v13 = 0x100000000 * total >> 32;
        v14 = 0x100000000 * bytes >> 32;
        if ((int32_t)(float32_t)(float64_t)(0x100000000 * total >> 32) < 0) {
            // 0x805aaf6
            v11 = (float32_t)g189;
            v10 = g187;
            v12 = (int32_t)g187;
            v15 = 0x100000000 * g186 >> 32;
            v13 = g189;
            v14 = g188;
        }
    } else {
        // 0x805aab0
        __frontend_reg_store_fpr(v3, v7);
        float80_t v16 = __frontend_reg_load_fpr(v3); // 0x805aab6
        g180 = v16;
        __frontend_reg_store_fpr(v3, v16);
        float80_t v17 = __frontend_reg_load_fpr(v3); // 0x805aac2
        g181 = v17;
        __frontend_reg_store_fpr(v3, v17);
        g182 = __frontend_reg_load_fpr(v3);
        g188 = 0x100000000 * bytes >> 32;
        g189 = 0x100000000 * total >> 32;
        v11 = (float32_t)(float64_t)(0x100000000 * total >> 32);
        v10 = v9;
        v15 = v8;
        v13 = 0x100000000 * total >> 32;
        v14 = 0x100000000 * bytes >> 32;
    }
    // 0x805ab24
    float64_t v18; // 0x805aa02
    if (v11 < 0) {
        goto lab_0x805b036;
    } else {
        // 0x805ab31
        v18 = v14;
        if (v11 != 0) {
            goto lab_0x805ab47;
        } else {
            if ((int32_t)(float32_t)v18 == 0) {
                goto lab_0x805b036;
            } else {
                goto lab_0x805ab47;
            }
        }
    }
  lab_0x805b036:
    // 0x805b036
    if (v1 != __readgsdword(20)) {
        // 0x805b042
        __stack_chk_fail();
    }
  lab_0x805ab47:
    // 0x805ab47
    __frontend_reg_store_fpr(v3, (float80_t)g182);
    __frontend_reg_store_fpr(v4, v7);
    __frontend_reg_load_fpr(v4);
    __frontend_reg_load_fpr(v3);
    if ((v5 & 0x4100) == 0) {
        char * v19 = g185; // 0x805ab64
        if (v19 >= NULL != v19 != NULL) {
            // 0x805ab7f
            if (v19 < NULL || (int32_t)g184 == 0) {
                // 0x805ab91
                __frontend_reg_store_fpr(v3, (float80_t)v18);
                __frontend_reg_store_fpr(v4, (float80_t)g182);
                __frontend_reg_store_fpr(v6, v7);
                __frontend_reg_store_fpr(v4, __frontend_reg_load_fpr(v6) - __frontend_reg_load_fpr(v4));
                __frontend_reg_store_fpr(v3, __frontend_reg_load_fpr(v3) / __frontend_reg_load_fpr(v4));
                g184 = 0x100000000 * (int64_t)__frontend_reg_load_fpr(v3) >> 32;
                g185 = (char *)v5;
            }
        }
        // 0x805abe6
        g186 = v15;
        *(int32_t *)&g187 = v12;
        __frontend_reg_store_fpr(v3, (float80_t)g181);
        __frontend_reg_store_fpr(v4, 0.2L);
        __frontend_reg_store_fpr(v3, __frontend_reg_load_fpr(v4) + __frontend_reg_load_fpr(v3));
        __frontend_reg_store_fpr(v4, v7);
        __frontend_reg_load_fpr(v4);
        __frontend_reg_load_fpr(v3);
        if ((v5 & 256) == 0) {
            // 0x805ac18
            transferp = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        }
        // 0x805ac22
        if (*(int32_t *)&transferp == 0) {
            goto lab_0x805b036;
        } else {
            // 0x805ac46
            __frontend_reg_store_fpr(v3, (float80_t)g181);
            __frontend_reg_store_fpr(v4, v7);
            __frontend_reg_load_fpr(v4);
            __frontend_reg_load_fpr(v3);
            __frontend_reg_store_fpr(v3, v7);
            g181 = __frontend_reg_load_fpr(v3);
            if ((int32_t)(float32_t)g188 == (int32_t)(float32_t)v18 != (v11 == (int32_t)(float32_t)g189)) {
                // 0x805ac71
                __frontend_reg_store_fpr(v3, v7);
                g180 = __frontend_reg_load_fpr(v3);
            }
            // 0x805ace9
            g188 = v18;
            g189 = v13;
            __frontend_reg_store_fpr(v3, (float80_t)v18);
            __frontend_reg_store_fpr(v4, (float80_t)g182);
            __frontend_reg_store_fpr(v6, v7);
            __frontend_reg_store_fpr(v4, __frontend_reg_load_fpr(v6) - __frontend_reg_load_fpr(v4));
            __frontend_reg_store_fpr(v3, __frontend_reg_load_fpr(v3) / __frontend_reg_load_fpr(v4));
            g184 = 0x100000000 * (int64_t)__frontend_reg_load_fpr(v3) >> 32;
            g185 = (char *)v5;
            int32_t v20; // bp-120, 0x805aa02
            char * v21; // 0x805adba
            if (v10 < NULL) {
                // 0x805adb3
                sprint_bytes((char *)&v20, (int64_t)(int32_t)(float32_t)v18, (char *)v11);
                // 0x805adb3
                v21 = gettext("Read %s of data");
                HTSprintf0(&g183, v21);
                goto lab_0x805add8;
            } else {
                if (v10 == NULL == (int32_t)v15 == 0) {
                    // 0x805ad72
                    sprint_bytes((char *)&v20, (int64_t)(int32_t)(float32_t)v18, (char *)v11);
                    // 0x805adb3
                    v21 = gettext("Read %s of data");
                    HTSprintf0(&g183, v21);
                    goto lab_0x805add8;
                } else {
                    // 0x805ad84
                    int32_t v22; // bp-200, 0x805aa02
                    sprint_bytes((char *)&v22, v15, v10);
                    sprint_bytes((char *)&v20, (int64_t)(int32_t)(float32_t)v18, (char *)v11);
                    char * v23 = gettext("Read %s of %s of data"); // 0x805ad8b
                    HTSprintf0(&g183, v23);
                    goto lab_0x805add8;
                }
            }
        }
    } else {
        goto lab_0x805b036;
    }
  lab_0x805add8:
    // 0x805add8
    if (LYTransferRate == 0) {
        goto lab_0x805afb2;
    } else {
        // 0x805ade5
        if (g185 >= NULL) {
            // 0x805ae05
            if (g185 == NULL != ((int32_t)g184 == 0)) {
                // 0x805ae17
                int32_t v24; // bp-280, 0x805aa02
                sprint_bytes((char *)&v24, 0x100000000 * g184 >> 32, g185);
                char * v25 = gettext(", %s/sec"); // 0x805ae47
                HTSprintf(&g183, v25);
            }
        }
        int32_t v26 = LYTransferRate;
        if (v26 != 3 == (v26 != 4)) {
            goto lab_0x805afb2;
        } else {
            // 0x805ae80
            __frontend_reg_store_fpr(v3, (float80_t)g180);
            __frontend_reg_store_fpr(v4, v7);
            __frontend_reg_store_fpr(v3, __frontend_reg_load_fpr(v4) - __frontend_reg_load_fpr(v3));
            __frontend_reg_store_fpr(v4, 5.0L);
            float80_t v27 = __frontend_reg_load_fpr(v4); // 0x805ae94
            __frontend_reg_store_fpr(v4, __frontend_reg_load_fpr(v3));
            __frontend_reg_store_fpr(v3, v27);
            __frontend_reg_load_fpr(v4);
            __frontend_reg_load_fpr(v3);
            int32_t v28; // bp-40, 0x805aa02
            if ((v5 & 256) == 0) {
                // 0x805ae9d
                __frontend_reg_store_fpr(v3, (float80_t)g180);
                __frontend_reg_store_fpr(v4, v7);
                __frontend_reg_store_fpr(v3, __frontend_reg_load_fpr(v4) - __frontend_reg_load_fpr(v3));
                float80_t v29 = __frontend_reg_load_fpr(v3); // 0x805aec7
                sprint_tbuf((char *)&v28, (int32_t)v29);
                char * v30 = gettext(" (stalled for %s)"); // 0x805aef1
                HTSprintf(&g183, v30);
            }
            if (v10 < NULL) {
                goto lab_0x805afb2;
            } else {
                uint32_t v31 = (int32_t)v15; // 0x805af20
                if (v10 == NULL == v31 == 0) {
                    // 0x805afb2
                    HTSACat(&g183, ".");
                    goto lab_0x805affd;
                } else {
                    int32_t v32 = g184; // 0x805af2d
                    int32_t v33 = (int32_t)g185; // 0x805af32
                    if ((v33 || v32) != 0) {
                        int32_t v34 = __divdi3(v31 - (int32_t)(float32_t)v18, (int32_t)v10 - v11 + (int32_t)(v31 < (int32_t)(float32_t)v18), v32, v33); // 0x805af7c
                        sprint_tbuf((char *)&v28, v34);
                        char * v35 = gettext(", ETA %s"); // 0x805af99
                        HTSprintf(&g183, v35);
                    }
                    goto lab_0x805afb2;
                }
            }
        }
    }
  lab_0x805afb2:
    // 0x805afb2
    HTSACat(&g183, ".");
    if (v10 > (char *)-1) {
        goto lab_0x805affd;
    } else {
        char * v36; // 0x805afe8
        if (v10 < (char *)-1) {
            // 0x805afe1
            v36 = gettext(" (Press 'z' to abort)");
            HTSACat(&g183, v36);
            goto lab_0x805affd;
        } else {
            if ((int32_t)v15 == -1) {
                goto lab_0x805affd;
            } else {
                // 0x805afe1
                v36 = gettext(" (Press 'z' to abort)");
                HTSACat(&g183, v36);
                goto lab_0x805affd;
            }
        }
    }
  lab_0x805affd:
    // 0x805affd
    statusline(g183);
    if (WWW_TraceFlag != 0) {
        // 0x805b015
        fprintf(TraceFP(), "%s\n", g183);
    }
    goto lab_0x805b036;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805b052 - 0x805b07a
// Line range:    383 - 390
char HTLastConfirmCancelled(void) {
    char result = 0; // 0x805b061
    if (conf_cancelled != 0) {
        // 0x805b063
        conf_cancelled = 0;
        result = 1;
    }
    // 0x805b074
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805b07a - 0x805b14a
// Line range:    397 - 419
int32_t HTForcedPrompt(int32_t option, char * msg, int32_t dft) {
    int32_t result = 0; // bp-16, 0x805b08e
    if (option == 0) {
        // 0x805b145
        return HTConfirmDefault(msg, dft);
    }
    char * v1; // 0x805b07a
    int32_t result2; // 0x805b07a
    if (option != 1) {
        if (option != 2) {
            // 0x805b145
            return HTConfirmDefault(msg, dft);
        }
        // 0x805b0d9
        v1 = gettext("no");
        result2 = 0;
    } else {
        // 0x805b0bb
        v1 = gettext("yes");
        result2 = 1;
    }
    // 0x805b108
    HTSprintf((char **)&result, "%s %s", msg, v1);
    HTUserMsg((char *)result);
    free((int32_t *)result);
    // 0x805b145
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805b14a - 0x805b5fb
// Line range:    427 - 523
int32_t HTConfirmDefault(char * Msg, int32_t Dft) {
    char * v1 = gettext("yes"); // 0x805b159
    char * v2 = gettext("no"); // 0x805b168
    int16_t * v3 = *__ctype_b_loc(); // 0x805b17c
    int32_t c = (int32_t)*v1; // 0x805b181
    int32_t v4 = c; // 0x805b199
    if ((*(int16_t *)(2 * c + (int32_t)v3) & 512) != 0) {
        // 0x805b19b
        v4 = toupper(c);
    }
    int16_t * v5 = *__ctype_b_loc(); // 0x805b1c2
    int32_t c2 = (int32_t)*v2; // 0x805b1c7
    int32_t v6 = c2; // 0x805b1df
    if ((*(int16_t *)(2 * c2 + (int32_t)v5) & 512) != 0) {
        // 0x805b1e1
        v6 = toupper(c2);
    }
    char * v7 = (char *)Dft;
    char ** v8 = v4 != v6 ? (char **)v1 : (char **)"yes";
    char * v9 = v4 != v6 ? v2 : "no";
    conf_cancelled = 0;
    if (dump_output_immediately != 0) {
        // 0x805b22f
        if (v7 != (char *)-2) {
            // 0x805b280
            if (WWW_TraceFlag == 0) {
                // 0x805b5f1
                return (int32_t)NULL;
            }
            char * v10 = v7 != (char *)1 ? v9 : (char *)v8;
            fprintf(TraceFP(), "Confirm: %s (%c) ", Msg, *v10);
        } else {
            // 0x805b235
            if (WWW_TraceFlag == 0) {
                // 0x805b5f1
                return (int32_t)NULL;
            }
            // 0x805b244
            fprintf(TraceFP(), "Confirm: %s (%c/%c) ", Msg, *(char *)v8, *v9);
        }
        // 0x805b2d0
        if (WWW_TraceFlag != 0) {
            // 0x805b2db
            fprintf(TraceFP(), "- NO, not interactive.\n");
        }
        // 0x805b5f1
        return (int32_t)NULL;
    }
    char * msg_no = NULL; // bp-32, 0x805b2fe
    char v11 = *(char *)v8; // 0x805b310
    char v12; // 0x805b14a
    if (v11 == 121) {
        // 0x805b323
        v12 = 0;
        goto lab_0x805b327;
    } else {
        // 0x805b318
        v12 = 121;
        if (*v9 != 121) {
            goto lab_0x805b327;
        } else {
            // 0x805b323
            v12 = 0;
            goto lab_0x805b327;
        }
    }
  lab_0x805b327:;
    unsigned char v13 = v12;
    char v14; // 0x805b14a
    if (v11 == 110) {
        // 0x805b33d
        v14 = 0;
        goto lab_0x805b341;
    } else {
        // 0x805b332
        v14 = 110;
        if (*v9 != 110) {
            goto lab_0x805b341;
        } else {
            // 0x805b33d
            v14 = 0;
            goto lab_0x805b341;
        }
    }
  lab_0x805b341:;
    unsigned char v15 = v14;
    if (v7 != (char *)-2) {
        char * v16 = v7 != (char *)1 ? v9 : (char *)v8;
        HTSprintf0(&msg_no, "%s (%c) ", Msg, *v16);
    } else {
        // 0x805b347
        HTSprintf0(&msg_no, "%s (%c/%c) ", Msg, v11, *v9);
    }
    // 0x805b3be
    if (LYTraceLogFP != NULL && WWW_TraceFlag != 0) {
        // 0x805b3d2
        fprintf(TraceFP(), "Confirm: %s", msg_no);
    }
    // 0x805b3f0
    mustshow = 1;
    statusline(msg_no);
    if (msg_no != NULL) {
        // 0x805b40d
        free((int32_t *)msg_no);
        msg_no = NULL;
    }
    uint32_t v17 = LYgetch_single(); // 0x805b424
    int16_t * v18 = *__ctype_b_loc(); // 0x805b431
    int32_t c3 = (int32_t)*(char *)v8; // 0x805b436
    int32_t v19 = c3; // 0x805b44e
    if ((*(int16_t *)(2 * c3 + (int32_t)v18) & 512) != 0) {
        // 0x805b450
        v19 = toupper(c3);
    }
    char * v20 = (char *)1; // 0x805b478
    // 0x805b586
    while (v19 != v17) {
        int16_t * v21 = *__ctype_b_loc(); // 0x805b48b
        int32_t c4 = (int32_t)*v9; // 0x805b490
        int32_t v22 = c4; // 0x805b4a8
        if ((*(int16_t *)(2 * c4 + (int32_t)v21) & 512) != 0) {
            // 0x805b4aa
            v22 = toupper(c4);
        }
        // 0x805b4cc
        v20 = NULL;
        if (v22 == v17) {
            // break -> 0x805b590
            break;
        }
        // 0x805b4e0
        v20 = (char *)1;
        if (v13 != 0 && v17 == (int32_t)v13) {
            // break -> 0x805b590
            break;
        }
        // 0x805b4fb
        v20 = NULL;
        if (v15 != 0 && v17 == (int32_t)v15) {
            // break -> 0x805b590
            break;
        }
        if ((v17 || 4) == 7) {
            // 0x805b568
            conf_cancelled = 1;
            v20 = NULL;
            goto lab_0x805b590;
        }
        if (v17 != -1) {
            if ((v17 & 0x8800) == 0) {
                // 0x805b54f
                if (*(int16_t *)((2 * v17 & 4094) + 0x8197ea2) == 47) {
                    // 0x805b568
                    conf_cancelled = 1;
                    v20 = NULL;
                    goto lab_0x805b590;
                }
            } else {
                if (v17 % 256 == 47) {
                    // 0x805b568
                    conf_cancelled = 1;
                    v20 = NULL;
                    goto lab_0x805b590;
                }
            }
        } else {
            // 0x805b525
            if (keymap[0] == 47) {
                // 0x805b568
                conf_cancelled = 1;
                v20 = NULL;
                goto lab_0x805b590;
            }
        }
        // 0x805b578
        v20 = v7;
        if (v7 != (char *)-2) {
            // break -> 0x805b590
            break;
        }
        v17 = LYgetch_single();
        v18 = *__ctype_b_loc();
        c3 = (int32_t)*(char *)v8;
        v19 = c3;
        if ((*(int16_t *)(2 * c3 + (int32_t)v18) & 512) != 0) {
            // 0x805b450
            v19 = toupper(c3);
        }
        // 0x805b472
        v20 = (char *)1;
    }
    goto lab_0x805b590;
  lab_0x805b590:
    // 0x805b590
    if (WWW_TraceFlag != 0) {
        char * v23 = conf_cancelled == 0 ? (char *)&g10 : ", cancelled";
        fprintf(TraceFP(), "- %s%s.\n", v20 == NULL ? "NO" : "YES", v23);
    }
    // 0x805b5f1
    return (int32_t)v20;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805b5fb - 0x805b616
// Line range:    529 - 531
char HTConfirm(char * Msg) {
    // 0x805b5fb
    return HTConfirmDefault(Msg, -2);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805b616 - 0x805bb07
// Line range:    548 - 613
char confirm_post_resub(char * address, char * title, int32_t if_imgmap, int32_t if_file) {
    char buf[240]; // bp-256, 0x805b616
    char v1[240]; // 0x805b79d
    int32_t v2 = __readgsdword(20); // 0x805b631
    char * v3 = gettext("Resubmit POST content to %s ?"); // 0x805b643
    char v4 = 0; // 0x805b683
    char * str; // 0x805b616
    if (address != NULL) {
        // 0x805b691
        if (strncasecomp(address, "LYNXIMGMAP:", 11) != 0) {
            char v5 = *address; // 0x805b6f4
            if (v5 != 102 == (v5 != 70)) {
                goto lab_0x805b762;
            } else {
                // 0x805b708
                if (strncasecomp(address, "file:", 5) != 0) {
                    goto lab_0x805b762;
                } else {
                    // 0x805b72a
                    v4 = 0;
                    if (if_file >= 0 == (if_file != 0)) {
                        // 0x805b73c
                        v4 = 1;
                        if (if_file != 1) {
                            // 0x805b74e
                            str = gettext("List from document with POST data.  Reload %s ?");
                            goto lab_0x805b779;
                        } else {
                            goto lab_0x805baed;
                        }
                    } else {
                        goto lab_0x805baed;
                    }
                }
            }
        } else {
            // 0x805b6b3
            v4 = 0;
            if (if_imgmap >= 0 == (if_imgmap != 0)) {
                // 0x805b6c5
                v4 = 1;
                if (if_imgmap != 1) {
                    // 0x805b6d7
                    str = gettext("List from document with POST data.  Reload %s ?");
                    goto lab_0x805b779;
                } else {
                    goto lab_0x805baed;
                }
            } else {
                goto lab_0x805baed;
            }
        }
    } else {
        goto lab_0x805baed;
    }
  lab_0x805baed:;
    char result = v4; // 0x805bafe
    if (v2 != __readgsdword(20)) {
        // 0x805bb00
        __stack_chk_fail();
        result = &g391;
    }
    // 0x805bb05
    return result;
  lab_0x805b762:
    // 0x805b762
    str = v3;
    v4 = 0;
    if (dump_output_immediately == 0) {
        goto lab_0x805b779;
    } else {
        goto lab_0x805baed;
    }
  lab_0x805b779:;
    char * v6 = (char *)(LYcols - 5 + (int32_t)(LYShowScrollbar != 0)); // 0x805b676
    int32_t len = strlen(str); // 0x805b798
    v1[0] = len;
    buf = v1;
    int32_t len2 = strlen(address); // 0x805b7ac
    int32_t v7 = *(int32_t *)&buf; // 0x805b7b1
    uint32_t v8 = (int32_t)(v6 < (char *)239 ? v6 : (char *)239); // 0x805b7b7
    int32_t str3; // bp-248, 0x805b616
    if (v7 + len2 > v8) {
        char * str2 = HTParse(address, (char *)&g10, 29); // 0x805b813
        if (strlen(str2) + v7 > v8) {
            if (str2 != NULL) {
                // 0x805b8ac
                free((int32_t *)str2);
            }
            if (title == NULL) {
                goto lab_0x805b924;
            } else {
                // 0x805b8cd
                if (strlen(title) + v7 > v8) {
                    goto lab_0x805b924;
                } else {
                    // 0x805b8e9
                    sprintf((char *)&str3, str);
                    v4 = HTConfirm((char *)&str3);
                    goto lab_0x805baed;
                }
            }
        } else {
            // 0x805b83a
            sprintf((char *)&str3, str);
            char v9 = HTConfirm((char *)&str3); // 0x805b865
            v4 = v9;
            if (str2 != NULL) {
                // 0x805b879
                free((int32_t *)str2);
                v4 = v9;
            }
            goto lab_0x805baed;
        }
    } else {
        // 0x805b7bf
        sprintf((char *)&str3, str);
        v4 = HTConfirm((char *)&str3);
        goto lab_0x805baed;
    }
  lab_0x805b924:;
    char * str4 = HTParse(address, (char *)&g10, 25); // 0x805b93d
    if (strlen(str4) + v7 > v8) {
        if (str4 != NULL) {
            // 0x805b9d6
            free((int32_t *)str4);
        }
        char * str5 = HTParse(address, (char *)&g10, 8); // 0x805ba07
        if (str5 == NULL) {
            goto lab_0x805bad3;
        } else {
            // 0x805ba1f
            if (*str5 == 0) {
                // 0x805babb
                free((int32_t *)str5);
                goto lab_0x805bad3;
            } else {
                // 0x805ba30
                if (strlen(str5) + v7 > v8) {
                    // 0x805babb
                    free((int32_t *)str5);
                    goto lab_0x805bad3;
                } else {
                    // 0x805ba4c
                    sprintf((char *)&str3, str);
                    char v10 = HTConfirm((char *)&str3); // 0x805ba77
                    free((int32_t *)str5);
                    v4 = v10;
                    goto lab_0x805baed;
                }
            }
        }
    } else {
        // 0x805b964
        sprintf((char *)&str3, str);
        char v11 = HTConfirm((char *)&str3); // 0x805b98f
        v4 = v11;
        if (str4 != NULL) {
            // 0x805b9a3
            free((int32_t *)str4);
            v4 = v11;
        }
        goto lab_0x805baed;
    }
  lab_0x805bad3:
    // 0x805bad3
    v4 = HTConfirm(gettext("Document from Form with POST content.  Resubmit?"));
    goto lab_0x805baed;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805c142 - 0x805c62d
// Line range:    827 - 978
char HTConfirmCookie(int32_t * de, char * server, char * name, char * value) {
    char * str = gettext("%s cookie: %.*s=%.*s  Allow? (Y/N/Always/neVer)"); // 0x805c151
    if (de == NULL) {
        // 0x805c622
        return 0;
    }
    int32_t * v1 = (int32_t *)((int32_t)de + 4); // 0x805c16b
    int32_t v2 = *v1; // 0x805c16b
    if (v2 == 0) {
        // 0x805c622
        return 1;
    }
    // 0x805c17b
    if (v2 == 1) {
        // 0x805c622
        return 0;
    }
    // 0x805c18f
    if (dump_output_immediately != 0) {
        // 0x805c622
        return LYSetCookies;
    }
    // 0x805c1a9
    if (LYAcceptAllCookies != 0) {
        goto lab_0x805c303;
    } else {
        int32_t v3 = 0; // bp-40, 0x805c1b8
        LYstrCells(str);
        strlen(server);
        strlen(name);
        strlen(value);
        HTSprintf((char **)&v3, str);
        mustshow = 1;
        statusline((char *)v3);
        if (v3 != 0) {
            // 0x805c2f1
            free((int32_t *)v3);
            v3 = 0;
        }
        // 0x805c303
        goto lab_0x805c303;
    }
  lab_0x805c4ed:;
    // 0x805c4ed
    char v4; // 0x805c142
    char v5 = v4;
    char * v6; // 0x805c556
    if (v5 == 78) {
        // 0x805c54f
        v6 = gettext("Rejecting this cookie.");
        HTUserMsg(v6);
        // 0x805c622
        return 0;
    }
    if (v5 > 78) {
        switch (v5) {
            case 86: {
                // 0x805c56c
                *v1 = 1;
                HTUserMsg2(gettext("ne'V'er allowing from domain '%s'."), (char *)*de);
                // 0x805c622
                return 0;
            }
            case 89: {
                // 0x805c59c
                HTInfoMsg(gettext("Allowing this cookie."));
                // 0x805c622
                return 1;
            }
        }
        goto lab_0x805c5b6;
    } else {
        if (v5 == 65) {
            goto lab_0x805c51f;
        } else {
            goto lab_0x805c5b6;
        }
    }
  lab_0x805c303:
    // 0x805c303
    if (LYAcceptAllCookies == 0) {
        int32_t c = LYgetch_single(); // 0x805c31a
        char v7 = c; // 0x805c31f
        gettext("Y/N/A/V");
        char * found_char_pos = strchr((char *)&g11, c); // 0x805c345
        v4 = v7;
        if (found_char_pos == NULL) {
            int16_t * v8 = *__ctype_b_loc(); // 0x805c357
            v4 = v7;
            if ((*(int16_t *)((0x1000000 * c >> 23) + (int32_t)v8) & 1024) != 0) {
                char * found_char_pos2 = strrchr(str, 40); // 0x805c382
                v4 = v7;
                if (found_char_pos2 != NULL) {
                    // 0x805c394
                    if (WWW_TraceFlag != 0) {
                        // 0x805c3a3
                        fprintf(TraceFP(), "Looking for %c in %s\n", v7, found_char_pos2);
                    }
                    char * v9 = found_char_pos2; // 0x805c142
                    char * v10 = (char *)&g11; // 0x805c142
                    while (true) {
                      lab_0x805c4b1:;
                        char * v11 = v9;
                        v4 = v7;
                        switch (*v11) {
                            case 41: {
                                goto lab_0x805c4ed;
                            }
                            case 0: {
                                goto lab_0x805c4ed;
                            }
                            default: {
                                char * v12 = v10;
                                int16_t * v13 = *__ctype_b_loc(); // 0x805c4ca
                                unsigned char v14 = *v12; // 0x805c4cf
                                if ((*(int16_t *)(2 * (int32_t)v14 + (int32_t)v13) & 1024) == 0) {
                                    // break -> 0x805c4ed
                                    break;
                                }
                                int16_t * v15 = *__ctype_b_loc(); // 0x805c3d4
                                unsigned char v16 = *v11; // 0x805c3d9
                                char * v17 = v12; // 0x805c3f1
                                if ((*(int16_t *)(2 * (int32_t)v16 + (int32_t)v15) & 1024) != 0) {
                                    int16_t * v18 = *__ctype_b_loc(); // 0x805c408
                                    int32_t c2 = (int32_t)*v11; // 0x805c40d
                                    int32_t v19 = c2; // 0x805c425
                                    if ((*(int16_t *)(2 * c2 + (int32_t)v18) & 512) != 0) {
                                        // 0x805c427
                                        v19 = toupper(c2);
                                    }
                                    // 0x805c449
                                    v17 = v12;
                                    if (v19 == (int32_t)v16) {
                                        // 0x805c451
                                        if (WWW_TraceFlag != 0) {
                                            // 0x805c45c
                                            fprintf(TraceFP(), "...testing %c/%c\n", *v11, *v12);
                                        }
                                        // 0x805c48d
                                        if (*v11 == v7) {
                                            // 0x805c49b
                                            v4 = *v12;
                                            goto lab_0x805c4ed;
                                        }
                                        // 0x805c4a9
                                        v17 = (char *)((int32_t)v12 + 1);
                                    }
                                }
                                // 0x805c4ad
                                v9 = (char *)((int32_t)v11 + 1);
                                v10 = v17;
                                goto lab_0x805c4b1;
                            }
                        }
                    }
                }
            }
        }
        goto lab_0x805c4ed;
    } else {
        goto lab_0x805c51f;
    }
  lab_0x805c51f:
    // 0x805c51f
    *v1 = 0;
    HTUserMsg2(gettext("'A'lways allowing from domain '%s'."), (char *)*de);
    // 0x805c622
    return 1;
  lab_0x805c5b6:
    if ((v5 || 4) == 7) {
        // 0x805c54f
        v6 = gettext("Rejecting this cookie.");
        HTUserMsg(v6);
        // 0x805c622
        return 0;
    }
    if (v5 != -1) {
        int32_t v20 = v5; // 0x805c5de
        if ((v20 & 0x8800) == 0) {
            // 0x805c600
            if (*(int16_t *)((2 * v20 & 4094) + 0x8197ea2) == 47) {
                // 0x805c54f
                v6 = gettext("Rejecting this cookie.");
                HTUserMsg(v6);
                // 0x805c622
                return 0;
            }
        } else {
            if (v5 == 47) {
                // 0x805c54f
                v6 = gettext("Rejecting this cookie.");
                HTUserMsg(v6);
                // 0x805c622
                return 0;
            }
        }
    } else {
        // 0x805c5c8
        if (keymap[0] == 47) {
            // 0x805c54f
            v6 = gettext("Rejecting this cookie.");
            HTUserMsg(v6);
            // 0x805c622
            return 0;
        }
    }
    // 0x805c303
    goto lab_0x805c303;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805c9e8 - 0x805ca1e
// Line range:    1132 - 1135
void LYSleepAlert(void) {
    // 0x805c9e8
    if (crawl != 0) {
        // 0x805ca1c
        return;
    }
    // 0x805c9f9
    if (traversal == 0 && LYCursesON != 0) {
        // 0x805ca0f
        int32_t v1; // 0x805c9e8
        function_804b3e4(AlertSecs, v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805ca1e - 0x805ca54
// Line range:    1138 - 1141
void LYSleepDebug(void) {
    // 0x805ca1e
    if (crawl != 0) {
        // 0x805ca52
        return;
    }
    // 0x805ca2f
    if (traversal == 0 && LYCursesON != 0) {
        // 0x805ca45
        int32_t v1; // 0x805ca1e
        function_804b3e4(DebugSecs, v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805ca54 - 0x805ca8a
// Line range:    1144 - 1147
void LYSleepInfo(void) {
    // 0x805ca54
    if (crawl != 0) {
        // 0x805ca88
        return;
    }
    // 0x805ca65
    if (traversal == 0 && LYCursesON != 0) {
        // 0x805ca7b
        int32_t v1; // 0x805ca54
        function_804b3e4(InfoSecs, v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805ca8a - 0x805cac0
// Line range:    1150 - 1153
void LYSleepMsg(void) {
    // 0x805ca8a
    if (crawl != 0) {
        // 0x805cabe
        return;
    }
    // 0x805ca9b
    if (traversal == 0 && LYCursesON != 0) {
        // 0x805cab1
        int32_t v1; // 0x805ca8a
        function_804b3e4(MessageSecs, v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTAlert.c
// Address range: 0x805cac0 - 0x805caf6
// Line range:    1157 - 1160
void LYSleepReplay(void) {
    // 0x805cac0
    if (crawl != 0) {
        // 0x805caf4
        return;
    }
    // 0x805cad1
    if (traversal == 0 && LYCursesON != 0) {
        // 0x805cae7
        int32_t v1; // 0x805cac0
        function_804b3e4(ReplaySecs, v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805caf8 - 0x805cbe3
// Line range:    252 - 286
int32_t * ALLOC_IN_POOL(int32_t ** ppoolptr, int32_t request) {
    int32_t * v1 = *ppoolptr; // 0x805cb01
    if (v1 == NULL) {
        // 0x805cbde
        return NULL;
    }
    int32_t v2 = (int32_t)v1; // 0x805cb01
    int32_t * v3 = request != 0 ? (int32_t *)request : (int32_t *)1;
    uint32_t v4 = (int32_t)v3; // 0x805cb2b
    uint32_t v5 = v4 % 8; // 0x805cb2e
    uint32_t v6 = (int32_t)(v5 == 0 ? v3 : (int32_t *)(v4 + 8 - v5)) / 4; // 0x805cb4b
    int32_t * v7 = (int32_t *)(v2 + 0x1fec); // 0x805cb54
    int32_t v8 = *v7; // 0x805cb54
    uint32_t v9 = v8 + v6; // 0x805cb5a
    if (v9 < 2043) {
        // 0x805cb64
        *v7 = v9;
        // 0x805cbde
        return (int32_t *)(4 * v8 + v2);
    }
    char * v10 = LY_check_calloc(1, 0x1ff0); // 0x805cba1
    int32_t * result = NULL; // 0x805cbad
    if (v10 != NULL) {
        int32_t v11 = (int32_t)v10; // 0x805cba1
        *(int32_t *)(v11 + 0x1fe8) = v2;
        *(int32_t *)(v11 + 0x1fec) = v6;
        *(int32_t *)ppoolptr = v11;
        result = (int32_t *)v10;
    }
    // 0x805cbde
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805cc25 - 0x805cc58
// Line range:    306 - 315
void POOL_FREE(int32_t * poolptr) {
    if (poolptr == NULL) {
        // 0x805cc56
        return;
    }
    int32_t v1 = (int32_t)poolptr;
    int32_t v2 = *(int32_t *)(v1 + 0x1fe8); // 0x805cc36
    free((int32_t *)v1);
    while (v2 != 0) {
        // 0x805cc33
        v1 = v2;
        v2 = *(int32_t *)(v1 + 0x1fe8);
        free((int32_t *)v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805cd09 - 0x805cd47
// Line range:    629 - 636
void HText_halt(void) {
    // 0x805cd09
    if ((uint32_t)HTFormNumber >= 1) {
        // 0x805cd18
        HText_DisableCurrentForm();
    }
    // 0x805cd1d
    if (HTMainText != NULL && g213 <= 1) {
        // 0x805cd36
        g213 = 2;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805cd47 - 0x805cdb0
// Line range:    653 - 667
char mem_is_avail(int32_t factor, uint32_t bytes) {
    int32_t * mem = malloc((factor == 0 | bytes > 0x1387 ? bytes : 0x1388) * (factor != 0 ? factor : 1)); // 0x805cd7a
    char result = 0; // 0x805cd86
    if (mem != NULL) {
        // 0x805cd8e
        free(mem);
        result = 1;
    }
    // 0x805cdaa
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805cdb0 - 0x805d017
// Line range:    675 - 717
char * LY_check_calloc(int32_t nmemb, int32_t size) {
    int32_t v1 = size * nmemb; // 0x805cdba
    if (mem_is_avail(4, v1) != 0) {
        // 0x805d00e
        return (char *)calloc(nmemb, size);
    }
    int32_t v2 = HTList_count(loaded_texts); // 0x805cdf4
    int32_t v3 = v2;
    int32_t v4 = v3 - 1;
    int32_t * mem; // 0x805cdb0
    while (v4 >= 0 == (v4 != 0)) {
        char * v5 = HTList_objectAt(loaded_texts, v4); // 0x805ce1a
        if (WWW_TraceFlag != 0) {
            char * v6 = (char *)&g12; // 0x805ce35
            char * v7 = "unknown anchor"; // 0x805ce35
            if (v5 != NULL) {
                int32_t v8 = *(int32_t *)v5; // 0x805ce3a
                v6 = (char *)&g12;
                v7 = "unknown anchor";
                if (v8 != 0) {
                    int32_t v9 = *(int32_t *)(v8 + 20); // 0x805ce45
                    char * v10 = v9 == 0 ? (char *)&g12 : " with POST data";
                    int32_t v11 = *(int32_t *)(v8 + 16); // 0x805ce70
                    v6 = v10;
                    v7 = "unknown anchor";
                    if (v11 != 0) {
                        // 0x805ce77
                        v6 = v10;
                        v7 = (char *)v11;
                    }
                }
            }
            // 0x805ce8b
            fprintf(TraceFP(), "\nBUG *** Emergency freeing document %d/%d for '%s'%s!\n", v3, v2, v7, v6);
        }
        // 0x805cec3
        HTList_removeObjectAt(loaded_texts, v4);
        HText_free((int32_t *)v5);
        if (mem_is_avail(4, v1) != 0) {
            // 0x805cefe
            mem = calloc(nmemb, size);
            return (char *)mem;
        }
        v3 = v4;
        v4 = v3 - 1;
    }
    // 0x805cf26
    LYFakeZap(1);
    if (HTMainText != NULL == g213 > 1) {
        // 0x805d00e
        return (char *)calloc(nmemb, size);
    }
    // 0x805cf4f
    if (mem_is_avail(2, v1) == 0) {
        // 0x805cf6a
        HText_halt();
        if (mem_is_avail(0, 700) != 0) {
            // 0x805cf87
            HTAlert(gettext("Memory exhausted, display interrupted!"));
        }
        // 0x805d00e
        return (char *)calloc(nmemb, size);
    }
    // 0x805cf9d
    if (HTMainText != NULL) {
        // 0x805cfa6
        if (g213 != 0) {
            // 0x805d00e
            return (char *)calloc(nmemb, size);
        }
    }
    // 0x805cfb5
    if (mem_is_avail(0, 700) == 0) {
        // 0x805d00e
        return (char *)calloc(nmemb, size);
    }
    // 0x805cfcd
    HTAlert(gettext("Memory exhausted, will interrupt transfer!"));
    if (HTMainText != NULL) {
        // 0x805cfea
        g213 = 1;
    }
    // 0x805cff9
    mem = calloc(nmemb, size);
  lab_0x805d00e:
    // 0x805d00e
    return (char *)mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d017 - 0x805d11b
// Line range:    733 - 760
int32_t StyleToCols(int32_t * text, int32_t * line, int32_t nstyle) {
    int32_t v1 = (int32_t)line;
    int32_t v2 = (int32_t)*(int16_t *)(v1 + 8); // 0x805d020
    uint16_t v3 = *(int16_t *)(*(int32_t *)(v1 + 12) + 4 * nstyle); // 0x805d039
    int32_t v4 = v1 + 18; // 0x805d049
    uint32_t v5 = v4 + (int32_t)*(int16_t *)(v1 + 10); // 0x805d059
    int32_t result = v2; // 0x805d108
    if (v3 > 3 != v4 < v5) {
      lab_0x805d116_2:
        // 0x805d116
        return result;
    }
    int32_t v6 = v2;
    int32_t v7 = v4;
    int32_t v8 = v3 / 4; // 0x805d100
    int32_t v9; // 0x805d017
    int32_t v10; // 0x805d017
    while (true) {
      lab_0x805d064:;
        int32_t v11 = v6;
        int32_t v12 = v7;
        char * v13 = (char *)v12;
        char v14 = *v13; // 0x805d067
        while (v14 != 8 && v14 <= 8) {
            int32_t v15 = v12 + 1; // 0x805d082
            result = v11;
            if (v15 >= v5) {
                return result;
            }
            v12 = v15;
            v13 = (char *)v12;
            v14 = *v13;
        }
        int32_t v16 = utf8_length(*(char *)((int32_t)text + 2251), v13); // 0x805d09f
        if (v16 == 0) {
            // 0x805d0db
            if (HTCJK == 0) {
                // 0x805d0f8
                v9 = v12 + 1;
                v10 = v11 + 1;
                goto lab_0x805d100;
            } else {
                // 0x805d0e4
                if (*v13 >= 0) {
                    // 0x805d0f8
                    v9 = v12 + 1;
                    v10 = v11 + 1;
                    goto lab_0x805d100;
                } else {
                    // 0x805d0ee
                    v9 = v12 + 2;
                    v10 = v11 + 2;
                    goto lab_0x805d100;
                }
            }
        } else {
            int32_t v17 = v16 + 1; // 0x805d0ae
            int32_t v18 = LYstrExtent(v13, v17, 2); // 0x805d0cb
            v9 = v17 + v12;
            v10 = v18 + v11;
            goto lab_0x805d100;
        }
    }
    // 0x805d116
    return result;
  lab_0x805d100:
    // 0x805d100
    v6 = v10;
    v7 = v9;
    v8--;
    result = v6;
    if (v8 > 0 != v7 < v5) {
        return result;
    }
    goto lab_0x805d064;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d11b - 0x805d158
// Line range:    768 - 773
void LYClearHiText(int32_t * a) {
    int32_t v1 = (int32_t)a;
    int32_t * v2 = (int32_t *)(v1 + 32); // 0x805d124
    int32_t v3 = *v2; // 0x805d124
    if (v3 != 0) {
        // 0x805d12b
        free((int32_t *)v3);
        *v2 = 0;
    }
    // 0x805d143
    *(int32_t *)(v1 + 36) = 0;
    *(int16_t *)(v1 + 44) = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d158 - 0x805d1c0
// Line range:    783 - 791
void LYSetHiText(int32_t * a, char * text, int32_t len) {
    if (text != NULL) {
        int32_t v1 = (int32_t)a;
        int32_t * v2 = ALLOC_IN_POOL((int32_t **)&g216, len + 2); // 0x805d17d
        int32_t * v3 = (int32_t *)(v1 + 36); // 0x805d187
        *v3 = (int32_t)v2;
        memcpy(v2, (int32_t *)text, len);
        *(char *)(*v3 + len) = 0;
        *(int16_t *)(v1 + 44) = 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d1c0 - 0x805d296
// Line range:    799 - 814
void LYAddHiText(int32_t * a, char * text, int32_t x) {
    int32_t v1 = (int32_t)a;
    int32_t * v2 = (int32_t *)(v1 + 32); // 0x805d1ca
    int32_t v3 = *v2; // 0x805d1ca
    int16_t * v4 = (int16_t *)(v1 + 44); // 0x805d1d3
    int16_t v5 = *v4;
    int16_t v6 = v5 + 1; // 0x805d1e5
    *v4 = v6;
    int32_t size = 8 * (int32_t)v6; // 0x805d1f9
    int32_t * mem; // 0x805d1c0
    if (v3 == 0) {
        // 0x805d21c
        mem = malloc(size);
    } else {
        // 0x805d205
        mem = realloc((int32_t *)v3, size);
    }
    int32_t v7 = (int32_t)mem;
    *v2 = v7;
    int32_t v8 = 8 * (int32_t)v5 - 8 + v7; // 0x805d23b
    int32_t len = strlen(text); // 0x805d244
    int32_t * str = ALLOC_IN_POOL((int32_t **)&g216, len + 2); // 0x805d25d
    *(int32_t *)v8 = (int32_t)str;
    strcpy((char *)str, text);
    *(int16_t *)(v8 + 4) = (int16_t)x;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d296 - 0x805d30b
// Line range:    822 - 833
int32_t LYAdjHiTextPos(int32_t * a, uint32_t count) {
    int32_t v1 = (int32_t)a;
    if ((int32_t)*(int16_t *)(v1 + 44) <= count) {
        // 0x805d306
        return 0;
    }
    int32_t v2; // 0x805d296
    if (count < 1) {
        // 0x805d2d7
        v2 = v1 + 36;
    } else {
        // 0x805d2b8
        v2 = 8 * count - 8 + *(int32_t *)(v1 + 32);
    }
    int32_t v3 = *(int32_t *)v2;
    int32_t result = 0; // 0x805d2e4
    if (v3 != 0) {
        // 0x805d2e6
        result = (int32_t)LYSkipBlanks((char *)v3) - v3;
    }
    // 0x805d306
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d30b - 0x805d36f
// Line range:    842 - 853
char * LYGetHiTextStr(int32_t * a, uint32_t count) {
    int32_t v1 = (int32_t)a;
    if ((int32_t)*(int16_t *)(v1 + 44) <= count) {
        // 0x805d355
        return (char *)LYAdjHiTextPos(a, count);
    }
    int32_t v2; // 0x805d30b
    if (count < 1) {
        // 0x805d34c
        v2 = *(int32_t *)(v1 + 36);
    } else {
        // 0x805d32d
        v2 = *(int32_t *)(8 * count - 8 + *(int32_t *)(v1 + 32));
    }
    // 0x805d355
    return (char *)(LYAdjHiTextPos(a, count) + v2);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d36f - 0x805d3d8
// Line range:    859 - 870
int32_t LYGetHiTextPos(int32_t * a, uint32_t count) {
    int32_t v1 = (int32_t)a;
    if ((int32_t)*(int16_t *)(v1 + 44) <= count) {
        // 0x805d3be
        return LYAdjHiTextPos(a, count) - 1;
    }
    int32_t v2; // 0x805d36f
    if (count < 1) {
        // 0x805d3b3
        v2 = (int32_t)*(int16_t *)(v1 + 20);
    } else {
        int16_t v3 = *(int16_t *)(8 * count - 4 + *(int32_t *)(v1 + 32)); // 0x805d3a9
        v2 = v3;
    }
    // 0x805d3be
    return LYAdjHiTextPos(a, count) + v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d3d8 - 0x805d464
// Line range:    876 - 890
void LYCopyHiText(int32_t * a, int32_t * b) {
    // 0x805d3d8
    LYClearHiText(a);
    char * v1 = LYGetHiTextStr(b, 0); // 0x805d3fd
    if (v1 == NULL) {
        // 0x805d462
        return;
    }
    int32_t v2 = 0;
    char * str = v1;
    if (v2 != 0) {
        // 0x805d434
        LYAddHiText(a, str, LYGetHiTextPos(b, v2));
    } else {
        // 0x805d411
        LYSetHiText(a, str, strlen(str));
    }
    int32_t v3 = v2 + 1; // 0x805d45c
    char * v4 = LYGetHiTextStr(b, v3); // 0x805d3fd
    while (v4 != NULL) {
        // 0x805d40b
        v2 = v3;
        str = v4;
        if (v2 != 0) {
            // 0x805d434
            LYAddHiText(a, str, LYGetHiTextPos(b, v2));
        } else {
            // 0x805d411
            LYSetHiText(a, str, strlen(str));
        }
        // 0x805d45c
        v3 = v2 + 1;
        v4 = LYGetHiTextStr(b, v3);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d505 - 0x805d56f
// Line range:    907 - 913
void PerFormInfo_free(int32_t * form) {
    if (form == NULL) {
        // 0x805d56d
        return;
    }
    int32_t v1 = (int32_t)form;
    int32_t * v2 = (int32_t *)(v1 + 24); // 0x805d514
    int32_t v3 = *v2; // 0x805d514
    if (v3 != 0) {
        // 0x805d51b
        free((int32_t *)v3);
        *v2 = 0;
    }
    int32_t * v4 = (int32_t *)(v1 + 28); // 0x805d536
    int32_t v5 = *v4; // 0x805d536
    if (v5 != 0) {
        // 0x805d53d
        free((int32_t *)v5);
        *v4 = 0;
    }
    // 0x805d55b
    free(form);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d56f - 0x805d773
// Line range:    916 - 961
void free_form_fields(int32_t * input_field) {
    int32_t v1 = (int32_t)input_field;
    if (*(int32_t *)(v1 + 8) != 7) {
        goto lab_0x805d642;
    } else {
        int32_t * v2 = (int32_t *)(v1 + 44); // 0x805d587
        int32_t v3 = *v2; // 0x805d587
        if (v3 == 0) {
            goto lab_0x805d642;
        } else {
            int32_t v4 = *(int32_t *)(v3 + 12); // 0x805d5a6
            int32_t * v5 = (int32_t *)v3; // 0x805d5af
            int32_t v6 = *v5; // 0x805d5af
            if (v6 != 0) {
                // 0x805d5b5
                free((int32_t *)v6);
                *v5 = 0;
            }
            int32_t * v7 = (int32_t *)(v3 + 4); // 0x805d5ce
            int32_t v8 = *v7; // 0x805d5ce
            if (v8 != 0) {
                // 0x805d5d5
                free((int32_t *)v8);
                *v7 = 0;
            }
            // 0x805d5f3
            free(v5);
            int32_t v9 = v4; // 0x805d609
            while (v4 != 0) {
                // 0x805d59d
                v4 = *(int32_t *)(v9 + 12);
                v5 = (int32_t *)v9;
                v6 = *v5;
                if (v6 != 0) {
                    // 0x805d5b5
                    free((int32_t *)v6);
                    *v5 = 0;
                }
                // 0x805d5cb
                v7 = (int32_t *)(v9 + 4);
                v8 = *v7;
                if (v8 != 0) {
                    // 0x805d5d5
                    free((int32_t *)v8);
                    *v7 = 0;
                }
                // 0x805d5f3
                free(v5);
                v9 = v4;
            }
            // 0x805d60b
            *v2 = 0;
            *(int32_t *)(v1 + 12) = 0;
            *(int32_t *)(v1 + 16) = 0;
            *(int32_t *)(v1 + 68) = 0;
            *(int32_t *)(v1 + 72) = 0;
            goto lab_0x805d6ca;
        }
    }
  lab_0x805d642:;
    int32_t * v10 = (int32_t *)(v1 + 12); // 0x805d645
    int32_t v11 = *v10; // 0x805d645
    if (v11 != 0) {
        // 0x805d64c
        free((int32_t *)v11);
        *v10 = 0;
    }
    int32_t * v12 = (int32_t *)(v1 + 16); // 0x805d667
    int32_t v13 = *v12; // 0x805d667
    if (v13 != 0) {
        // 0x805d66e
        free((int32_t *)v13);
        *v12 = 0;
    }
    int32_t * v14 = (int32_t *)(v1 + 68); // 0x805d689
    int32_t v15 = *v14; // 0x805d689
    if (v15 != 0) {
        // 0x805d690
        free((int32_t *)v15);
        *v14 = 0;
    }
    int32_t * v16 = (int32_t *)(v1 + 72); // 0x805d6ab
    int32_t v17 = *v16; // 0x805d6ab
    if (v17 != 0) {
        // 0x805d6b2
        free((int32_t *)v17);
        *v16 = 0;
    }
    goto lab_0x805d6ca;
  lab_0x805d6ca:;
    int32_t v18 = *input_field; // 0x805d6cd
    if (v18 != 0) {
        // 0x805d6d3
        free((int32_t *)v18);
        *input_field = 0;
    }
    int32_t * v19 = (int32_t *)(v1 + 48); // 0x805d6ec
    int32_t v20 = *v19; // 0x805d6ec
    if (v20 != 0) {
        // 0x805d6f3
        free((int32_t *)v20);
        *v19 = 0;
    }
    int32_t * v21 = (int32_t *)(v1 + 56); // 0x805d70e
    int32_t v22 = *v21; // 0x805d70e
    if (v22 != 0) {
        // 0x805d715
        free((int32_t *)v22);
        *v21 = 0;
    }
    int32_t * v23 = (int32_t *)(v1 + 60); // 0x805d730
    int32_t v24 = *v23; // 0x805d730
    if (v24 != 0) {
        // 0x805d737
        free((int32_t *)v24);
        *v23 = 0;
    }
    int32_t * v25 = (int32_t *)(v1 + 92); // 0x805d752
    int32_t v26 = *v25; // 0x805d752
    if (v26 != 0) {
        // 0x805d759
        free((int32_t *)v26);
        *v25 = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d773 - 0x805d7cb
// Line range:    964 - 971
void FormList_delete(int32_t * forms) {
    if (forms == NULL) {
        // 0x805d7be
        HTList_delete(forms);
        return;
    }
    int32_t v1 = *(int32_t *)((int32_t)forms + 4); // 0x805d795
    int32_t v2 = v1; // 0x805d79f
    if (v1 == 0) {
        // 0x805d7be
        HTList_delete(forms);
        return;
    }
    int32_t v3 = *(int32_t *)v2; // 0x805d7a4
    while (v3 != 0) {
        // 0x805d781
        PerFormInfo_free((int32_t *)v3);
        v2 += 4;
        if (v2 == 0) {
            // break -> 0x805d7be
            break;
        }
        v3 = *(int32_t *)v2;
    }
    // 0x805d7be
    HTList_delete(forms);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805d7cb - 0x805d7f0
// Line range:    975 - 980
void ResetPartialLinenos(int32_t * text) {
    if (text != NULL) {
        int32_t v1 = (int32_t)text;
        *(int32_t *)(v1 + 2184) = -1;
        *(int32_t *)(v1 + 2188) = -1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805dee7 - 0x805e11c
// Line range:    1236 - 1323
void HText_free(int32_t * self) {
    if (self == NULL) {
        // 0x805e11a
        return;
    }
    int32_t v1 = (int32_t)self;
    int32_t * v2 = (int32_t *)(v1 + 2108); // 0x805df5b
    int32_t v3 = *v2; // 0x805df5b
    if (v3 != 0) {
        *v2 = *(int32_t *)v3;
        int32_t v4; // 0x805df21
        if (*(char *)(v3 + 27) == 2) {
            // 0x805df1e
            v4 = *(int32_t *)(v3 + 28);
            if (v4 != 0) {
                // 0x805df28
                free_form_fields((int32_t *)v4);
            }
        }
        int32_t * v5 = (int32_t *)(v3 + 32); // 0x805df39
        int32_t v6 = *v5; // 0x805df39
        if (v6 != 0) {
            // 0x805df40
            free((int32_t *)v6);
            *v5 = 0;
        }
        int32_t v7 = *v2; // 0x805df5b
        while (v7 != 0) {
            int32_t v8 = v7;
            *v2 = *(int32_t *)v8;
            if (*(char *)(v8 + 27) == 2) {
                // 0x805df1e
                v4 = *(int32_t *)(v8 + 28);
                if (v4 != 0) {
                    // 0x805df28
                    free_form_fields((int32_t *)v4);
                }
            }
            // 0x805df36
            v5 = (int32_t *)(v8 + 32);
            v6 = *v5;
            if (v6 != 0) {
                // 0x805df40
                free((int32_t *)v6);
                *v5 = 0;
            }
            // 0x805df58
            v7 = *v2;
        }
    }
    // 0x805df65
    FormList_delete((int32_t *)*(int32_t *)(v1 + 2124));
    int32_t * v9 = (int32_t *)(v1 + 2136); // 0x805df79
    int32_t v10 = *v9; // 0x805df79
    if (v10 != 0) {
        int32_t v11 = *(int32_t *)(v10 + 4); // 0x805dfdc
        int32_t v12 = v11; // 0x805dfe6
        int32_t v13 = v10; // 0x805dfe6
        if (v11 != 0) {
            int32_t v14 = *(int32_t *)v12; // 0x805dfeb
            while (v14 != 0) {
                int32_t * v15 = (int32_t *)v14; // 0x805df9f
                int32_t v16 = *v15; // 0x805df9f
                if (v16 != 0) {
                    // 0x805dfa5
                    free((int32_t *)v16);
                    *v15 = 0;
                }
                // 0x805dfc1
                free(v15);
                int32_t v17 = *(int32_t *)(v12 + 4); // 0x805dfdc
                v12 = v17;
                if (v17 == 0) {
                    // break -> 0x805e005
                    break;
                }
                v14 = *(int32_t *)v12;
            }
            // 0x805e005
            v13 = *v9;
        }
        // 0x805e005
        HTList_delete((int32_t *)v13);
        *v9 = 0;
    }
    int32_t * v18 = (int32_t *)(v1 + 2140); // 0x805e026
    int32_t v19 = *v18; // 0x805e026
    if (v19 != 0) {
        // 0x805e030
        LYFreeStringList((int32_t *)v19);
        *v18 = 0;
    }
    int32_t v20 = *self; // 0x805e051
    if (v20 != 0) {
        // 0x805e05b
        HTAnchor_resetUCInfoStage((int32_t *)v20, -1, 2, 0);
        HTAnchor_resetUCInfoStage((int32_t *)*self, -1, 3, 0);
        HTAnchor_clearSourceCache((int32_t *)*self);
        HTAnchor_delete_links((int32_t *)*self);
        HTAnchor_setDocument((int32_t *)*self, NULL);
        if (HTAnchor_delete((int32_t *)*(int32_t *)*self) != 0) {
            // 0x805e0e7
            *(int32_t *)&HTMainAnchor = 0;
        }
    }
    // 0x805e0f1
    POOL_FREE((int32_t *)*(int32_t *)(v1 + 2288));
    free(self);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805e11c - 0x805e577
// Line range:    1336 - 1654
int32_t display_line(int32_t * line, int32_t * text, int32_t scrline, char * target) {
    int32_t v1 = (int32_t)line;
    LYmove(scrline, 0);
    char str = 0; // bp-34, 0x805e14f
    char str3 = 0; // bp-35, 0x805e156
    LYclrtoeol();
    int16_t * v2 = (int16_t *)(v1 + 8); // 0x805e161
    int32_t v3 = (int32_t)*v2; // 0x805e161
    int32_t v4 = LYwideLines != 0 ? 1014 : LYcols;
    int32_t v5 = v4 > v3 ? v3 : LYwideLines != 0 ? 1013 : LYcols - 1;
    int32_t v6 = v5; // 0x805e1ba
    if (*(int16_t *)(v1 + 10) != 0) {
        // 0x805e1e6
        v6 = 0;
        if (v5 > 0) {
            function_804a8f4((int32_t)LYwin, 32);
            int32_t v7 = 1; // 0x805e1e2
            int32_t v8 = v7; // 0x805e1ec
            while (v7 != v5) {
                // 0x805e1cd
                function_804a8f4((int32_t)LYwin, 32);
                v7 = v8 + 1;
                v8 = v7;
            }
            // 0x805e1e6
            v6 = v5;
        }
    }
    int32_t v9 = v6 + 1; // 0x805e1f7
    int16_t * v10; // 0x805e11c
    char v11; // 0x805e11c
    char v12; // 0x805e281
    char * v13; // 0x805e11c
    char * v14; // 0x805e11c
    char * v15; // 0x805e11c
    char * v16; // 0x805e11c
    char * v17; // 0x805e11c
    char * v18; // 0x805e11c
    int32_t v19; // 0x805e11c
    int32_t v20; // 0x805e11c
    int32_t v21; // 0x805e11c
    char * v22; // 0x805e11c
    char * v23; // 0x805e11c
    char * v24; // 0x805e11c
    char * v25; // 0x805e11c
    char v26; // 0x805e11c
    char v27; // 0x805e11c
    char v28; // 0x805e11c
    int16_t * v29; // 0x805e11c
    int32_t v30; // 0x805e11c
    int32_t v31; // 0x805e200
    char * str2; // 0x805e11c
    if ((LYwideLines != 0 ? 1014 : LYcols) < v9) {
        // 0x805e1ee
        v10 = (int16_t *)(v1 + 16);
        v17 = NULL;
    } else {
        int32_t v32 = (int32_t)text;
        int32_t * v33 = (int32_t *)(v1 + 12);
        v29 = (int16_t *)(v1 + 16);
        char * v34 = (char *)(v32 + 2251);
        v25 = (char *)(v1 + 18);
        v21 = v9;
        v27 = 32;
        v18 = NULL;
        while (true) {
          lab_0x805e4f7_2:
            // 0x805e4f7
            v28 = v27;
            v30 = 2 * (int32_t)v28;
            char * v35 = v25; // 0x805e11c
            int32_t v36 = v21; // 0x805e2bb
            char * v37 = v18; // 0x805e11c
            while (true) {
                // 0x805e4f7
                v20 = v36;
                v23 = v35;
                v16 = v37;
                while (true) {
                  lab_0x805e4f7:;
                    char * v38 = v16;
                    v24 = v23;
                    char v39 = *v24; // 0x805e4fa
                    str3 = v39;
                    v10 = v29;
                    v17 = v38;
                    if (v39 == 0) {
                        // break (via goto) -> 0x805e50c
                        goto lab_0x805e50c_4;
                    }
                    int32_t v40 = (int32_t)v38; // 0x805e24e
                    v11 = v39;
                    v14 = v38;
                    if ((int32_t)*v29 > v40) {
                        int32_t v41 = *v33 + 4 * v40; // 0x805e25f
                        uint16_t v42 = *v2; // 0x805e26f
                        int32_t v43 = v41; // 0x805e27f
                        int32_t v44 = v40; // 0x805e27f
                        v13 = v38;
                        if ((int32_t)(*(int16_t *)v41 / 4) + (int32_t)v42 < v20) {
                            uint16_t v45 = *(int16_t *)(v43 + 2); // 0x805e22d
                            curses_style((int32_t)v45, (int32_t)(*(char *)v43 % 4));
                            int32_t v46 = v44 + 1; // 0x805e240
                            while (v46 < (int32_t)*v29) {
                                int32_t v47 = *v33 + 4 * v46; // 0x805e25f
                                uint16_t v48 = *(int16_t *)v47; // 0x805e262
                                v43 = v47;
                                v44 = v46;
                                if ((int32_t)(v48 / 4) + (int32_t)*v2 >= v20) {
                                    // 0x805e253
                                    v13 = (char *)v46;
                                    goto lab_0x805e281_2;
                                }
                                v45 = *(int16_t *)(v43 + 2);
                                curses_style((int32_t)v45, (int32_t)(*(char *)v43 % 4));
                                v46 = v44 + 1;
                            }
                            // 0x805e206
                            v13 = (char *)v46;
                        }
                        goto lab_0x805e281_2;
                    } else {
                        goto lab_0x805e281;
                    }
                }
              lab_0x805e2a6:
                // 0x805e2a6
                function_804a8f4((int32_t)LYwin, 43);
                v36 = v20 + 1;
                v35 = str2;
                v37 = v15;
                v10 = v29;
                v17 = v15;
                if ((LYwideLines != 0 ? 1014 : LYcols) < v36) {
                    // break (via goto) -> 0x805e50c
                    goto lab_0x805e50c_4;
                }
            }
          lab_0x805e306:
            // 0x805e306
            if (v12 >= 0 | *v34 == 0) {
                goto lab_0x805e3b3;
            } else {
                // 0x805e34c
                *(char *)(v32 + 2179) = 1;
                int32_t n = utf8_length(*v34, v24); // 0x805e340
                if (n == 0) {
                    goto lab_0x805e3b3;
                } else {
                    // 0x805e352
                    strncpy(&str, str2, n);
                    int32_t v49; // bp-4, 0x805e11c
                    *(char *)((int32_t)&v49 - 30 + n) = 0;
                    int32_t len = strlen(&str3); // 0x805e37f
                    LYwaddnstr(LYwin, &str3, len);
                    str = 0;
                    v26 = 77;
                    v19 = v20;
                    v22 = (char *)(n + v31);
                    goto lab_0x805e4d1;
                }
            }
        }
    }
  lab_0x805e50c_4:
    // 0x805e50c
    function_804a8f4((int32_t)LYwin, 10);
    int32_t v50 = (int32_t)v17; // 0x805e56b
    if ((int32_t)*v10 <= v50) {
        // 0x805e570
        return 0;
    }
    int32_t v51 = *(int32_t *)(v1 + 12) + 4 * v50; // 0x805e52f
    uint16_t v52 = *(int16_t *)(v51 + 2); // 0x805e54a
    curses_style((int32_t)v52, (int32_t)(*(char *)v51 % 4));
    int32_t v53 = v50 + 1; // 0x805e55d
    int32_t v54 = v53; // 0x805e56e
    while (v53 < (int32_t)*v10) {
        // 0x805e523
        v51 = *(int32_t *)(v1 + 12) + 4 * v54;
        v52 = *(int16_t *)(v51 + 2);
        curses_style((int32_t)v52, (int32_t)(*(char *)v51 % 4));
        v53 = v54 + 1;
        v54 = v53;
    }
    // 0x805e570
    return 0;
  lab_0x805e281:;
    int32_t v55 = (int32_t)v24;
    v31 = v55 + 1;
    str2 = (char *)v31;
    v15 = v14;
    v12 = v11;
    if (v12 == 7) {
        // 0x805e2c4
        if (*str2 == 0) {
            int16_t v56 = *(int16_t *)(v30 + (int32_t)*__ctype_b_loc()); // 0x805e2e5
            if (v28 != 45 && (v56 & 0x2000) == 0) {
                // 0x805e306
                str3 = 45;
                goto lab_0x805e3b3;
            }
        }
    } else {
        if (v12 != 8) {
            // break (via goto) -> 0x805e306
            goto lab_0x805e306;
        }
        // 0x805e297
        if (dump_output_immediately == 0) {
            // break -> 0x805e2a6
            goto lab_0x805e2a6;
        }
    }
    // 0x805e4d5
    v23 = str2;
    v16 = v15;
    v10 = v29;
    v17 = v15;
    if ((LYwideLines != 0 ? 1014 : LYcols) < v20) {
        // break (via goto) -> 0x805e50c
        goto lab_0x805e50c_4;
    }
    goto lab_0x805e4f7;
  lab_0x805e281_2:
    // 0x805e281
    v11 = str3;
    v14 = v13;
    goto lab_0x805e281;
  lab_0x805e3b3:;
    // 0x805e3b3
    int32_t v57; // 0x805e11c
    char * v58; // 0x805e11c
    char v59; // 0x805e11c
    if (HTCJK == 0) {
        goto lab_0x805e4a6;
    } else {
        // 0x805e3c0
        if (str3 >= 0) {
            goto lab_0x805e4a6;
        } else {
            // 0x805e3cc
            if ((LYwideLines != 0 ? 1014 : LYcols) < v20) {
                goto lab_0x805e4d1;
            } else {
                // 0x805e3f2
                str = *str2;
                char * v60 = (char *)(v55 + 2); // 0x805e3ff
                int32_t v61 = v20 + 1; // 0x805e403
                int32_t len2 = strlen(&str3); // 0x805e40d
                LYwaddnstr(LYwin, &str3, len2);
                str = 0;
                int32_t v62 = LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
                v26 = 77;
                v19 = v61;
                v22 = v60;
                v59 = 77;
                v57 = v61;
                v58 = v60;
                if (v62 == 0 || (LYwideLines != 0 ? 1014 : LYcols) <= v62) {
                    goto lab_0x805e4d5;
                } else {
                    goto lab_0x805e4d1;
                }
            }
        }
    }
  lab_0x805e4a6:;
    int32_t len3 = strlen(&str3); // 0x805e4ac
    LYwaddnstr(LYwin, &str3, len3);
    v26 = str3;
    v19 = v20;
    v22 = str2;
    goto lab_0x805e4d1;
  lab_0x805e4d1:
    // 0x805e4d1
    v59 = v26;
    v57 = v19 + 1;
    v58 = v22;
    goto lab_0x805e4d5;
  lab_0x805e4d5:
    // 0x805e4d5
    v25 = v58;
    v21 = v57;
    v27 = v59;
    v18 = v15;
    v10 = v29;
    v17 = v15;
    if ((LYwideLines != 0 ? 1014 : LYcols) < v57) {
        // break -> 0x805e50c
        goto lab_0x805e50c_4;
    }
    goto lab_0x805e4f7_2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805e577 - 0x805ec06
// Line range:    1660 - 1827
void display_title(int32_t * text) {
    char percent[20]; // bp-36, 0x805e577
    char percent2[20]; // bp-40, 0x805e577
    char v1[20]; // 0x805e7d7
    int32_t v2 = __readgsdword(20); // 0x805e584
    percent = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    percent2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char str; // bp-32, 0x805e577
    int32_t v3; // 0x805e577
    int32_t v4; // 0x805e654
    int32_t v5; // 0x805e63d
    if (text == NULL) {
        goto lab_0x805ebef;
    } else {
        // 0x805e5bc
        lynx_start_title_color();
        if (last_colorattr_ptr < 1) {
            // 0x805e5e1
            curses_style(s_title, 2);
        } else {
            // 0x805e5ca
            curses_style(s_title, 1);
        }
        char * v6 = HTAnchor_title((int32_t *)*text); // 0x805e5fe
        char * v7 = (char *)&g13; // 0x805e605
        if (v6 != NULL) {
            // 0x805e607
            v7 = HTAnchor_title((int32_t *)*text);
        }
        // 0x805e620
        HTSACopy((char **)&percent, v7);
        LYReduceBlanks((char *)*(int32_t *)&percent);
        v5 = LYscreenWidth();
        if (v5 > 9) {
            // 0x805e654
            v3 = (int32_t)text;
            v4 = display_lines;
            if (LYlines < 1 || v4 >= 0 == (v4 != 0)) {
                goto lab_0x805e6b8;
            } else {
                int32_t v8 = *(int32_t *)(v3 + 2160); // 0x805e669
                if (v8 > 0x1869f) {
                    goto lab_0x805e6b8;
                } else {
                    int32_t v9 = *(int32_t *)(v3 + 2104); // 0x805e679
                    if (v9 > 0xf423f) {
                        goto lab_0x805e6b8;
                    } else {
                        // 0x805e686
                        sprintf(&str, " (l%d of %d)", v8, v9);
                        goto lab_0x805e79c;
                    }
                }
            }
        } else {
            // 0x805e64b
            str = 0;
            goto lab_0x805e79c;
        }
    }
  lab_0x805ebef:
    // 0x805ebef
    if (v2 != __readgsdword(20)) {
        // 0x805ebfb
        __stack_chk_fail();
    }
  lab_0x805e6b8:;
    int32_t v10 = *(int32_t *)(v3 + 2104); // 0x805e6bb
    if (v4 < 1 || v10 < v4) {
        // 0x805e798
        str = 0;
    } else {
        int32_t v11 = v10 + v4; // 0x805e6e9
        int64_t v12 = v4; // 0x805e6fd
        int32_t v13 = (0x100000000 * (int64_t)(v11 >> 31) | (int64_t)v11) / v12; // 0x805e6fd
        uint32_t v14 = *(int32_t *)(v3 + 2160); // 0x805e73b
        int32_t v15 = v13; // 0x805e744
        if (v14 <= (v10 > v4 ? v10 - v4 : 0)) {
            int32_t v16 = v14 + v4; // 0x805e754
            v15 = (0x100000000 * (int64_t)(v16 >> 31) | (int64_t)v16) / v12;
        }
        // 0x805e775
        sprintf(&str, " (p%d of %d)", v15, v13);
    }
    goto lab_0x805e79c;
  lab_0x805e79c:;
    // 0x805e79c
    int32_t v17; // 0x805e577
    int32_t v18; // 0x805e7da
    char * v19; // 0x805e577
    if (HTCJK == 0) {
        goto lab_0x805e8a5;
    } else {
        char * str2 = (char *)*(int32_t *)&percent; // 0x805e7ac
        if (*str2 == 0) {
            goto lab_0x805e8a5;
        } else {
            int32_t * mem = calloc(2 * strlen(str2) + 256, 1); // 0x805e7d2
            v1[0] = (int32_t)mem;
            percent2 = v1;
            v18 = *(int32_t *)&percent2;
            if (v18 == 0) {
                goto lab_0x805e8a5;
            } else {
                // 0x805e7e4
                if (kanji_code != 1) {
                    int32_t v20 = *(int32_t *)&percent;
                    char * v21 = (char *)v20;
                    if (kanji_code != 2) {
                        char v22 = *v21; // 0x805e86b
                        int32_t v23 = v20; // 0x805e870
                        char v24 = v22; // 0x805e870
                        int32_t v25 = v18; // 0x805e870
                        char * v26 = NULL; // 0x805e870
                        if (v22 != 0) {
                            char * v27 = NULL;
                            char v28 = v24;
                            int32_t v29 = v23; // 0x805e842
                            char * v30 = v27; // 0x805e842
                            int32_t v31; // 0x805e844
                            if (v28 != 27) {
                                // 0x805e844
                                v31 = (int32_t)v27;
                                *(char *)(*(int32_t *)&percent2 + v31) = v28;
                                v29 = *(int32_t *)&percent;
                                v30 = (char *)(v31 + 1);
                            }
                            char * v32 = v30;
                            int32_t v33 = 1; // 0x805e85e
                            char v34 = *(char *)(v29 + v33); // 0x805e86b
                            v23 = v29;
                            int32_t v35 = v33; // 0x805e870
                            while (v34 != 0) {
                                // 0x805e834
                                v27 = v32;
                                v28 = v34;
                                v29 = v23;
                                v30 = v27;
                                if (v28 != 27) {
                                    // 0x805e844
                                    v31 = (int32_t)v27;
                                    *(char *)(*(int32_t *)&percent2 + v31) = v28;
                                    v29 = *(int32_t *)&percent;
                                    v30 = (char *)(v31 + 1);
                                }
                                // 0x805e85e
                                v32 = v30;
                                v33 = v35 + 1;
                                v34 = *(char *)(v29 + v33);
                                v23 = v29;
                                v35 = v33;
                            }
                            // 0x805e862
                            v25 = *(int32_t *)&percent2;
                            v26 = v32;
                        }
                        // 0x805e87b
                        *(char *)(v25 + (int32_t)v26) = 0;
                        int32_t v36 = *(int32_t *)&percent2;
                        HTSACopy((char **)&percent, (char *)v36);
                        v17 = v36;
                        if (v36 == 0) {
                            goto lab_0x805e8a5;
                        } else {
                            goto lab_0x805e893;
                        }
                    } else {
                        // 0x805e80e
                        v19 = (char *)v18;
                        TO_SJIS(v21, v19);
                        goto lab_0x805e87b;
                    }
                } else {
                    char * v37 = (char *)v18;
                    TO_EUC((char *)*(int32_t *)&percent, v37);
                    v19 = v37;
                    goto lab_0x805e87b;
                }
            }
        }
    }
  lab_0x805e8a5:
    // 0x805e8a5
    LYmove(0, 0);
    LYclrtoeol();
    int32_t v38 = 3; // 0x805e8cb
    if (HText_hasToolbar(text) != 0) {
        // 0x805e8cd
        function_804a8f4((int32_t)LYwin, 35);
        v38 = 4;
    }
    // 0x805e8e9
    if (s_forw_backw != -1) {
        // 0x805e8f7
        if (nhist == 0 != nhist_extra < 2) {
            // 0x805e90e
            curses_style(s_forw_backw, 1);
            if (nhist == 0) {
                // 0x805e98d
                LYmove(0, v38);
            } else {
                int32_t v39 = nhist == 0 ? 32 : g167;
                function_804a8f4((int32_t)LYwin, v39);
                function_804a8f4((int32_t)LYwin, v39);
                function_804a8f4((int32_t)LYwin, v39);
            }
            // 0x805e9a3
            if (nhist_extra >= 2) {
                // 0x805e9ad
                function_804a8f4((int32_t)LYwin, g166);
                function_804a8f4((int32_t)LYwin, g166);
                function_804a8f4((int32_t)LYwin, g166);
            }
            // 0x805e9f2
            curses_style(s_forw_backw, 0);
        }
    }
    int32_t len = strlen(&str); // 0x805ea23
    int32_t v40 = *(int32_t *)&percent; // 0x805ea2a
    int32_t v41 = v5 - len + (int32_t)(LYShowScrollbar != 0) - LYstrCells((char *)v40); // 0x805ea37
    char * v42 = (char *)v41; // 0x805ea42
    if (v41 >= 0 != v41 != 0) {
        int32_t v43 = v5 - 3 - strlen(&str) + (int32_t)(LYShowScrollbar != 0); // 0x805ea6b
        int32_t v44 = *(int32_t *)&percent;
        char * v45 = (char *)v44;
        if (v43 >= 0 == (v43 != 0)) {
            // 0x805ea7f
            memcpy((int32_t *)(LYstrExtent2(v45, v43) + v44), (int32_t *)"...", 4);
            v42 = NULL;
        } else {
            // 0x805ea77
            *v45 = 0;
            v42 = NULL;
        }
    }
    // 0x805eab6
    LYmove(0, (int32_t)v42);
    int32_t len2 = strlen((char *)*(int32_t *)&percent); // 0x805eacf
    LYwaddnstr(LYwin, (char *)*(int32_t *)&percent, len2);
    if (str != 0) {
        int32_t len3 = strlen(&str); // 0x805eafb
        LYwaddnstr(LYwin, &str, len3);
    }
    // 0x805eb19
    function_804a8f4((int32_t)LYwin, 10);
    int32_t v46 = *(int32_t *)&percent; // 0x805eb2e
    if (v46 != 0) {
        // 0x805eb35
        free((int32_t *)v46);
        percent = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    }
    // 0x805eb47
    if (s_hot_paste != -1) {
        // 0x805eb55
        LYmove(0, LYcols - (int32_t)(LYShowScrollbar != 0));
        curses_style(s_hot_paste, 1);
        function_804a8f4((int32_t)LYwin, g166);
        curses_style(s_hot_paste, 0);
        LYmove(1, 0);
    }
    // 0x805ebd5
    curses_style(s_title, 0);
    lynx_stop_title_color();
    goto lab_0x805ebef;
  lab_0x805e87b:
    // 0x805e87b
    HTSACopy((char **)&percent, v19);
    v17 = v18;
    goto lab_0x805e893;
  lab_0x805e893:
    // 0x805e893
    free((int32_t *)v17);
    percent2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    goto lab_0x805e8a5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805ec06 - 0x805f0d2
// Line range:    1834 - 1939
void display_scrollbar(int32_t * text) {
    int32_t v1 = display_lines - (LYsb_arrow == 0 ? 0 : 2); // 0x805ec33
    LYsb_end = -1;
    LYsb_begin = -1;
    if (v1 < 3 || text == NULL || LYShowScrollbar == 0) {
        // 0x805f0cc
        return;
    }
    int32_t v2 = (int32_t)text;
    uint32_t v3 = *(int32_t *)(v2 + 2104); // 0x805ec85
    if (v3 <= display_lines) {
        // 0x805f0cc
        return;
    }
    uint32_t v4 = *(int32_t *)(v2 + 2160); // 0x805ec9b
    int32_t v5 = display_lines; // 0x805ecb7
    if (v4 >= v3 - display_lines) {
        int32_t v6 = v3 - v4; // 0x805eccd
        v5 = v6 >= 0 == (v6 != 0) ? v6 : 1;
    }
    int32_t v7 = v5 * v1 + (v3 + (int32_t)(v3 < 0)) / 2; // 0x805ed06
    int32_t v8 = (0x100000000 * (int64_t)(v7 >> 31) | (int64_t)v7) / (int64_t)v3; // 0x805ed1e
    int32_t v9 = v8 >= 0 == (v8 != 0) ? v8 : 1;
    int32_t v10 = v1 - 1 > v9 ? v9 : v1 - 2;
    int32_t v11 = 0; // 0x805ed4f
    if (v4 != 0) {
        int32_t v12 = v3 + 1;
        int32_t v13 = v12 - v4 - display_lines; // 0x805ed7d
        if (v13 >= 0 == (v13 != 0)) {
            // 0x805ed95
            v11 = (float80_t)v4 * (float80_t)(v1 + -1 - v10) / (float80_t)(v12 - display_lines) + 1.0L;
        } else {
            // 0x805ed84
            v11 = v1 - v10;
        }
    }
    int32_t v14 = v11;
    int32_t v15 = v1 - v10 - v14; // 0x805edfe
    LYsb_begin = v14;
    int32_t v16 = v1 - v15; // 0x805ee12
    LYsb_end = v16;
    if (LYsb_arrow != 0) {
        int32_t v17 = v14 == 0 ? s_sb_naa : s_sb_aa;
        if (last_colorattr_ptr < 1) {
            // 0x805ee65
            curses_style(v17, 2);
        } else {
            // 0x805ee50
            curses_style(v17, 1);
        }
        // 0x805ee78
        LYmove(1, LYshiftWin + LYcols + (int32_t)(LYShowScrollbar != 0));
        function_804a8f4((int32_t)LYwin, g168);
        curses_style(v17, 0);
    }
    // 0x805eed1
    if (last_colorattr_ptr < 1) {
        // 0x805eef1
        curses_style(s_sb_bg, 2);
    } else {
        // 0x805eeda
        curses_style(s_sb_bg, 1);
    }
    int32_t v18 = LYsb_arrow != 0; // 0x805ec42
    int32_t v19 = 1;
    int32_t v20 = v19 - 1; // 0x805ef15
    if (v19 > v14 == v20 <= v14) {
        // 0x805ef25
        curses_style(s_sb_bar, 1);
    }
    if (v16 < v19 == v20 <= v16) {
        // 0x805ef5d
        curses_style(s_sb_bar, 0);
    }
    // 0x805ef72
    LYmove(v19 + v18, LYshiftWin + LYcols + (int32_t)(LYShowScrollbar != 0));
    if (v19 <= v14 || v16 < v19) {
        // 0x805efd7
        function_804a8f4((int32_t)LYwin, g171);
    } else {
        // 0x805efbe
        function_804a8f4((int32_t)LYwin, g170);
    }
    int32_t v21 = v19 + 1; // 0x805efee
    while (v21 <= v1) {
        // 0x805ef12
        v19 = v21;
        v20 = v19 - 1;
        if (v19 > v14 == v20 <= v14) {
            // 0x805ef25
            curses_style(s_sb_bar, 1);
        }
        if (v16 < v19 == v20 <= v16) {
            // 0x805ef5d
            curses_style(s_sb_bar, 0);
        }
        // 0x805ef72
        LYmove(v19 + v18, LYshiftWin + LYcols + (int32_t)(LYShowScrollbar != 0));
        if (v19 <= v14 || v16 < v19) {
            // 0x805efd7
            function_804a8f4((int32_t)LYwin, g171);
        } else {
            // 0x805efbe
            function_804a8f4((int32_t)LYwin, g170);
        }
        // 0x805efee
        v21 = v19 + 1;
    }
    // 0x805effe
    curses_style(s_sb_bg, 0);
    if (LYsb_arrow == 0) {
        // 0x805f0cc
        return;
    }
    int32_t v22 = v15 == 0 ? s_sb_naa : s_sb_aa;
    if (last_colorattr_ptr < 1) {
        // 0x805f05f
        curses_style(v22, 2);
    } else {
        // 0x805f04a
        curses_style(v22, 1);
    }
    // 0x805f072
    LYmove(v1 + 2, LYshiftWin + LYcols + (int32_t)(LYShowScrollbar != 0));
    function_804a8f4((int32_t)LYwin, g169);
    curses_style(v22, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x805f0d2 - 0x8060085
// Line range:    1950 - 2491
void display_page(int32_t * text, int32_t line_number, char * target) {
    // 0x805f0d2
    lynx_mode = 1;
    if (text == NULL) {
        // 0x805f10f
        if (enable_scrollback != 0) {
            // 0x805f11a
            function_804a8f4((int32_t)LYwin, 42);
            LYrefresh();
            LYclear();
        }
        // 0x805f139
        LYwaddnstr(LYwin, "\n\nError accessing document!\nNo data available!\n", 47);
        LYrefresh();
        nlinks = 0;
        // 0x8060083
        return;
    }
    int32_t v1 = (int32_t)text;
    if (display_partial != 0) {
        // 0x805f18e
        ResetPartialLinenos(text);
        goto lab_0x805f199;
    } else {
        // 0x805f175
        if (recent_sizechange != 0) {
            // 0x805f18e
            ResetPartialLinenos(text);
            goto lab_0x805f199;
        } else {
            // 0x805f180
            if (*(char *)(v1 + 2177) == 0) {
                goto lab_0x805f199;
            } else {
                // 0x805f18e
                ResetPartialLinenos(text);
                goto lab_0x805f199;
            }
        }
    }
  lab_0x805f24d:;
    // 0x805f24d
    int32_t * v2; // 0x805f0d2
    int32_t v3 = *v2; // 0x805f250
    int32_t v4 = v3; // 0x805f254
    if (v3 == 0) {
        // break -> 0x805f256
        goto lab_0x805f256;
    }
    goto lab_0x805f2b1;
  lab_0x805f2b1:;
    int32_t v5 = v4;
    int32_t v6; // 0x805f0d2
    int32_t v7 = v6 + 1; // 0x805f2b1
    int32_t v8 = v5; // 0x805f2c3
    int32_t v9; // 0x805f1f2
    if (v9 <= v7) {
        goto lab_0x805f2d4_2;
    }
    int32_t v10 = v5; // 0x805f2ce
    v6 = v7;
    v8 = v5;
    int32_t * v11; // 0x805f204
    if (*v11 == v5) {
        goto lab_0x805f2d4_2;
    }
    goto lab_0x805f211;
  lab_0x805ff3b:;
    // 0x805ff3b
    int32_t v13; // 0x805f0d2
    int32_t v14 = v13; // 0x805ff45
    if (nlinks == 1024) {
        // 0x805ff47
        if (LYCursesON == 0) {
            goto lab_0x805ff66;
        } else {
            // 0x805ff52
            HTAlert(gettext("Maximum links per page exceeded!  Use half-page or two-line scrolling."));
            goto lab_0x805ff66;
        }
    }
    goto lab_0x805ff92;
  lab_0x805fc7b:;
    // 0x805fc7b
    char * str3; // 0x805f0d2
    int32_t v35; // 0x805f0d2
    int32_t * v16; // 0x805ff9b
    if (*(char *)(v13 + 27) != 2) {
        goto lab_0x805ff02;
    } else {
        int32_t v36 = *(int32_t *)(v13 + 28); // 0x805fc8d
        int32_t * v37 = (int32_t *)(v36 + 8);
        if (*v37 == 8) {
            goto lab_0x805ff02;
        } else {
            // 0x805fc9c
            lynx_mode = 2;
            int32_t v38 = *(int32_t *)(v13 + 8); // 0x805fcb5
            *(int32_t *)(68 * nlinks + (int32_t)&g348) = v38;
            int32_t v39 = *(int32_t *)(v13 + 12); // 0x805fcd3
            *(int32_t *)(68 * nlinks + (int32_t)&g349) = v39;
            *(int32_t *)(68 * nlinks + (int32_t)&g350) = *v16;
            *(int32_t *)(68 * nlinks + (int32_t)&g354) = v36;
            int16_t v40 = *(int16_t *)(v13 + 20); // 0x805fd27
            *(int32_t *)(68 * nlinks + (int32_t)&g345) = (int32_t)v40;
            *(int32_t *)(68 * nlinks + (int32_t)&g346) = *v16 + v35;
            *(int32_t *)(68 * nlinks + (int32_t)&g347) = 1;
            char v41 = *(char *)(v13 + 25); // 0x805fd88
            *(char *)(68 * nlinks + (int32_t)&g344) = v41;
            *(int32_t *)(68 * nlinks + (int32_t)&g343) = (int32_t)&empty_string;
            HTSACopy((char **)(68 * nlinks + (int32_t)&links), empty_string);
            int32_t v42 = *v37; // 0x805fdde
            if (v42 != 4) {
                if (v42 != 3) {
                    int32_t * v43 = (int32_t *)(v36 + 12);
                    int32_t v44 = *v43;
                    if (v42 != 2) {
                        // 0x805feb8
                        LYSetHilite(nlinks, (char *)v44);
                    } else {
                        uint32_t v45 = LYstrCells((char *)v44); // 0x805fe6e
                        char * v46 = &star_string[0]; // 0x805fe78
                        if (v45 <= 1023) {
                            int32_t v47 = LYstrCells((char *)*v43); // 0x805fe83
                            v46 = (char *)((int32_t)&star_string + 1023 - v47);
                        }
                        // 0x805fea2
                        LYSetHilite(nlinks, v46);
                    }
                } else {
                    // 0x805fe27
                    LYSetHilite(nlinks, *(int32_t *)(v36 + 32) == 0 ? unchecked_box : checked_box);
                }
            } else {
                // 0x805fde6
                LYSetHilite(nlinks, *(int32_t *)(v36 + 32) == 0 ? unchecked_radio : checked_radio);
            }
            int32_t v48 = nlinks; // 0x805fed0
            nlinks = v48 + 1;
            LYhighlight(0, v48, str3);
            goto lab_0x805ff3b;
        }
    }
  lab_0x805ff02:;
    char * v20; // 0x805f9a9
    if (v20 != NULL) {
        // 0x805ff08
        if (*v20 != 0 && WWW_TraceFlag != 0) {
            // 0x805ff1d
            fprintf(TraceFP(), "\nGridText: Not showing link, hightext=%s\n", v20);
        }
    }
    goto lab_0x805ff3b;
  lab_0x805f94c:;
    // 0x805f94c
    int32_t v49; // 0x805f0d2
    *(int32_t *)(v1 + 2168) = v49;
    char * v50; // 0x805f338
    *v50 = 0;
    nlinks = 0;
    v35 = 1 - v9;
    v14 = v1 + 2108;
    bool v15; // 0x805f0d2
    int32_t v18; // 0x805f0d2
    while (true) {
      lab_0x805ff92:
        // 0x805ff92
        v13 = *(int32_t *)v14;
        v15 = true;
        if (v13 == 0) {
            // break -> 0x805ffa7
            break;
        }
        // 0x805ff98
        v16 = (int32_t *)(v13 + 16);
        int32_t v17 = *v16; // 0x805ff9b
        v15 = false;
        if (v17 > v18) {
            // break -> 0x805ffa7
            break;
        }
        if (v17 >= v9 == v17 < v18) {
            int32_t * v19 = (int32_t *)v13; // 0x805f9a9
            v20 = LYGetHiTextStr(v19, 0);
            if (v20 == NULL | *(char *)(v13 + 24) == 0) {
                goto lab_0x805fc7b;
            } else {
                // 0x805f9ca
                if (*v20 == 0) {
                    goto lab_0x805fc7b;
                } else {
                    // 0x805f9d8
                    if (*(char *)(v13 + 27) % 2 == 0) {
                        goto lab_0x805fc7b;
                    } else {
                        int32_t v21 = 0;
                        char * v22 = LYGetHiTextStr(v19, v21); // 0x805fa04
                        if (v21 == 0) {
                            // 0x805fa12
                            LYSetHilite(nlinks, v22);
                        }
                        while (v22 != NULL) {
                            if (v21 != 0) {
                                int32_t v23 = LYGetHiTextPos(v19, v21); // 0x805fa40
                                LYAddHilite(nlinks, v22, v23);
                            }
                            // 0x805fa5e
                            v21++;
                            v22 = LYGetHiTextStr(v19, v21);
                            if (v21 == 0) {
                                // 0x805fa12
                                LYSetHilite(nlinks, v22);
                            }
                        }
                        char v24 = *(char *)(v13 + 25); // 0x805fa6d
                        *(char *)(68 * nlinks + (int32_t)&g344) = v24;
                        int32_t v25 = *(int32_t *)(v13 + 8); // 0x805fa8c
                        *(int32_t *)(68 * nlinks + (int32_t)&g348) = v25;
                        int32_t v26 = *(int32_t *)(v13 + 12); // 0x805faaa
                        *(int32_t *)(68 * nlinks + (int32_t)&g349) = v26;
                        *(int32_t *)(68 * nlinks + (int32_t)&g350) = *v16;
                        int32_t * v27 = HTAnchor_followLink((int32_t *)*(int32_t *)(v13 + 48)); // 0x805fae6
                        char * v28; // 0x805f0d2
                        if (traversal == 0) {
                            // 0x805fb10
                            v28 = HTAnchor_address(v27);
                        } else {
                            // 0x805fb00
                            v28 = stub_HTAnchor_address(v27);
                        }
                        char * v29 = v28;
                        int32_t v30 = 68 * nlinks + (int32_t)&links;
                        int32_t v31 = *(int32_t *)v30; // 0x805fb2d
                        int32_t v32 = v30; // 0x805fb35
                        if (v31 != 0) {
                            // 0x805fb37
                            free((int32_t *)v31);
                            *(int32_t *)(68 * nlinks + (int32_t)&links) = 0;
                            v32 = 68 * nlinks + (int32_t)&links;
                        }
                        int32_t v33 = v32;
                        if (v29 == NULL) {
                            // 0x805fb8d
                            HTSACopy((char **)v33, empty_string);
                        } else {
                            // 0x805fb73
                            *(int32_t *)v33 = (int32_t)v29;
                        }
                        int16_t v34 = *(int16_t *)(v13 + 20); // 0x805fbba
                        *(int32_t *)(68 * nlinks + (int32_t)&g345) = (int32_t)v34;
                        *(int32_t *)(68 * nlinks + (int32_t)&g346) = *v16 + v35;
                        *(int32_t *)(68 * nlinks + (int32_t)&g347) = 2;
                        *(int32_t *)(68 * nlinks + (int32_t)&g343) = (int32_t)&empty_string;
                        *(int32_t *)(68 * nlinks + (int32_t)&g354) = 0;
                        nlinks++;
                        goto lab_0x805ff3b;
                    }
                }
            }
        } else {
            goto lab_0x805ff3b;
        }
    }
    goto lab_0x805ffa7;
  lab_0x805f741:;
    // 0x805f741
    int32_t v67; // 0x805f0d2
    int32_t v68 = v67 + 1; // 0x805f741
    int32_t v69; // 0x805f0d2
    int32_t v70 = v69; // 0x805f74b
    int32_t v71; // 0x805f0d2
    int32_t v72 = v71; // 0x805f74b
    int32_t v73 = v68; // 0x805f74b
    int32_t v74 = v68; // 0x805f74b
    int32_t len4; // 0x805f5b2
    if (v71 >= len4) {
        // break -> 0x805f765
        goto lab_0x805f765;
    }
    goto lab_0x805f74d;
  lab_0x805f719:;
    // 0x805f719
    char str; // bp-107, 0x805f0d2
    int32_t len3 = strlen(&str); // 0x805f71f
    LYwaddnstr(LYwin, &str, len3);
    int32_t v75; // 0x805f0d2
    v67 = v75;
    int32_t v80; // 0x805f0d2
    v71 = v80 + 1;
    int32_t v81; // 0x805f0d2
    v69 = v81;
    goto lab_0x805f741;
  lab_0x805f4a1:;
    int32_t v61; // 0x805f0d2
    if (v61 == 0) {
        // break -> 0x805f4a7
        goto lab_0x805f4a7;
    }
    goto lab_0x805f502;
  lab_0x805f502:;
    // 0x805f502
    int32_t v63; // 0x805f0d2
    int32_t v65; // 0x805f0d2
    if (display_partial != 0) {
        // 0x805f54e
        display_line((int32_t *)v61, text, v63 + 1, str3);
        goto lab_0x805f571;
    } else {
        // 0x805f50d
        if (*(int32_t *)(v1 + 2184) != v9) {
            // 0x805f54e
            display_line((int32_t *)v61, text, v63 + 1, str3);
            goto lab_0x805f571;
        } else {
            // 0x805f51b
            if (v63 + v9 > *(int32_t *)(v1 + 2188)) {
                // 0x805f54e
                display_line((int32_t *)v61, text, v63 + 1, str3);
                goto lab_0x805f571;
            } else {
                // 0x805f531
                LYmove(v63 + 1 + v65, 0);
                goto lab_0x805f571;
            }
        }
    }
  lab_0x805f571:;
    char str2; // bp-106, 0x805f0d2
    char * v55; // 0x805f0d2
    char * v87; // 0x805f1c5
    if (str3 != NULL) {
        // 0x805f7f0
        if (*str3 != 0) {
            int16_t * v88 = (int16_t *)(v61 + 8); // 0x805f57d
            int32_t v83 = v63 + v65;
            int32_t v85 = v61 + 19;
            int32_t v89 = v63 + 1 + v65;
            int32_t v90 = v61 + 18; // 0x805f0d2
            int32_t v91 = (int32_t)*v88;
            while (true) {
                int32_t v92 = v91;
                int32_t v77 = v90;
                char v93 = *v55;
                char * v94 = (char *)v77;
                int32_t v95; // bp-60, 0x805f0d2
                char * v96; // 0x805f0d2
                if (case_sensitive == 0) {
                    char * v97 = LYno_attr_mbcs_case_strstr(v94, str3, v93, 1, NULL, &v95); // 0x805f880
                    v96 = v97;
                } else {
                    // 0x805f809
                    v96 = LYno_attr_mbcs_strstr(v94, str3, v93, 1, NULL, &v95);
                }
                char * v98 = v96;
                if (v98 == NULL) {
                    // break -> 0x805f8d8
                    break;
                }
                // 0x805f89a
                if (v95 + (int32_t)*v88 > (LYwideLines != 0 ? 1014 : LYcols)) {
                    // break -> 0x805f8d8
                    break;
                }
                // 0x805f58c
                len4 = strlen(str3);
                *v87 = 1;
                LYstartTargetEmphasis();
                v74 = 0;
                if (len4 > 0) {
                    uint32_t v82 = (int32_t)v98;
                    v70 = v92 - v77 + v82;
                    v72 = 0;
                    v73 = 0;
                    while (true) {
                      lab_0x805f74d:
                        // 0x805f74d
                        v75 = v73;
                        uint32_t v76 = v75 + v77; // 0x805f750
                        char * v78 = (char *)v76; // 0x805f753
                        char v79 = *v78; // 0x805f753
                        str = v79;
                        v74 = v75;
                        if (v79 == 0) {
                            // break -> 0x805f765
                            break;
                        }
                        // 0x805f5d5
                        v80 = v72;
                        v81 = v70;
                        if (v79 == 8 || v79 > 8) {
                            // 0x805f5f6
                            v67 = v75;
                            v71 = v80;
                            v69 = v81;
                            if (v76 < v82) {
                                goto lab_0x805f741;
                            } else {
                                if (v76 == v82) {
                                    // 0x805f610
                                    LYmove(v83, v81);
                                }
                                int32_t n = utf8_length(*v55, v78); // 0x805f644
                                if (n == 0) {
                                    // 0x805f6ca
                                    if (HTCJK == 0) {
                                        goto lab_0x805f719;
                                    } else {
                                        // 0x805f6d3
                                        if (str >= 0) {
                                            goto lab_0x805f719;
                                        } else {
                                            int32_t v84 = v75 + 1; // 0x805f6db
                                            str2 = *(char *)(v84 + v77);
                                            int32_t len = strlen(&str); // 0x805f6f1
                                            LYwaddnstr(LYwin, &str, len);
                                            str2 = 0;
                                            v67 = v84;
                                            v71 = v80 + 2;
                                            v69 = v81;
                                            goto lab_0x805f741;
                                        }
                                    }
                                } else {
                                    // 0x805f652
                                    strncpy(&str2, (char *)(v85 + v75), n);
                                    int32_t v86; // bp-4, 0x805f0d2
                                    *(char *)((int32_t)&v86 - 102 + n) = 0;
                                    int32_t len2 = strlen(&str); // 0x805f693
                                    LYwaddnstr(LYwin, &str, len2);
                                    str2 = 0;
                                    v67 = n + v75;
                                    v71 = v80 + 1 + n;
                                    v69 = v81;
                                    goto lab_0x805f741;
                                }
                            }
                        } else {
                            // 0x805f5ed
                            v67 = v75;
                            v71 = v80;
                            v69 = v81 - 1;
                            goto lab_0x805f741;
                        }
                    }
                }
              lab_0x805f765:
                // 0x805f765
                LYstopTargetEmphasis();
                v91 = LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
                LYmove(v89, 0);
                v90 = v74 + v77;
                if (*str3 == 0) {
                    // break -> 0x805f8d8
                    break;
                }
            }
        }
    }
    // 0x805f8d8
    int32_t * v60; // 0x805f0d2
    int32_t * v54; // 0x805f0d2
    int32_t v64; // 0x805f0d2
    int32_t * v62; // 0x805f0d2
    if (*v11 == v61) {
        int32_t v99 = (int32_t)v62 + 1;
        v64 = v99;
        v54 = v60;
        v49 = v61;
        if (display_lines > v99) {
            goto lab_0x805f8e9;
        } else {
            goto lab_0x805f94c;
        }
    }
    int32_t * v100 = display_partial == 0 ? v60 : (int32_t *)(v63 + v9);
    int32_t v101 = *(int32_t *)v61; // 0x805f935
    int32_t v102 = v63 + 1; // 0x805f93a
    int32_t v56 = v102; // 0x805f946
    int32_t * v57 = (int32_t *)v102; // 0x805f946
    int32_t v58 = v101; // 0x805f946
    int32_t * v59 = v100; // 0x805f946
    v54 = v100;
    v49 = v101;
    if (display_lines <= v102) {
        goto lab_0x805f94c;
    }
    goto lab_0x805f468;
  lab_0x805f199:
    // 0x805f199
    str2 = 0;
    str = 0;
    char * v103 = NULL; // 0x805f1af
    if (target != NULL) {
        // 0x805f1b1
        v103 = *target != 0 ? target : NULL;
    }
    // 0x805f1c2
    str3 = v103;
    v87 = (char *)(v1 + 2178);
    *v87 = 0;
    if (display_lines < 1) {
        // 0x8060083
        return;
    }
    // 0x805f1d9
    v9 = HText_getPreferredTopLine(text, line_number);
    v11 = (int32_t *)(v1 + 4);
    int32_t v104 = *v11; // 0x805f204
    int32_t v105 = *(int32_t *)v104;
    v10 = v105;
    v6 = 0;
    v8 = v105;
    if (v9 > 0 == (v104 != v105)) {
        while (true) {
          lab_0x805f211:
            // 0x805f211
            v2 = (int32_t *)v10;
            if (LYNoCore != 0) {
                goto lab_0x805f24d;
            } else {
                int32_t v12 = *v2; // 0x805f21f
                v4 = v12;
                if (v12 != 0) {
                    goto lab_0x805f2b1;
                } else {
                    // 0x805f229
                    __assert_fail("line->next != ((void *)0)", "./GridText.c", 2016, "display_page");
                    goto lab_0x805f24d;
                }
            }
        }
      lab_0x805f256:
        // 0x805f256
        if (enable_scrollback != 0) {
            // 0x805f261
            function_804a8f4((int32_t)LYwin, 42);
            LYrefresh();
            LYclear();
        }
        // 0x805f280
        LYwaddnstr(LYwin, "\n\nError drawing page!\nBad HText structure!\n", 43);
        LYrefresh();
        nlinks = 0;
        // 0x8060083
        return;
    }
  lab_0x805f2d4_2:
    // 0x805f2d4
    if (*(int32_t *)(4 * current_char_set + (int32_t)&LYlowest_eightbit) <= 255) {
        // 0x805f2e7
        if (current_char_set != (int32_t)g96 && LYCursesON != 0) {
            // 0x805f301
            g96 = (char *)current_char_set;
        }
    }
    // 0x805f30b
    if (enable_scrollback != 0) {
        // 0x805f316
        function_804a8f4((int32_t)LYwin, 42);
        LYrefresh();
        LYclear();
    }
    // 0x805f335
    v50 = (char *)(v1 + 2177);
    int32_t * v52 = (int32_t *)(v1 + 2160);
    if (*v50 != 0) {
        // 0x805f359
        last_colorattr_ptr = 0;
        goto lab_0x805f363;
    } else {
        // 0x805f343
        if (display_lines + *v52 == v9) {
            goto lab_0x805f363;
        } else {
            // 0x805f359
            last_colorattr_ptr = 0;
            goto lab_0x805f363;
        }
    }
  lab_0x805f363:
    // 0x805f363
    *v52 = v9;
    *(int32_t *)(v1 + 2164) = v8;
    int32_t v106; // 0x805f0d2
    if (no_title == 0) {
        // 0x805f3a3
        display_title(text);
        v106 = 1;
    } else {
        // 0x805f386
        LYmove(0, 0);
        v106 = 0;
    }
    // 0x805f3ae
    v65 = v106;
    if (display_partial != 0) {
        goto lab_0x805f3d9;
    } else {
        // 0x805f3bd
        if (*(int32_t *)(v1 + 2184) != v9) {
            goto lab_0x805f3d9;
        } else {
            // 0x805f3cb
            if (*(int32_t *)(v1 + 2188) < v9) {
                goto lab_0x805f3d9;
            } else {
                goto lab_0x805f3de;
            }
        }
    }
  lab_0x805f3d9:
    // 0x805f3d9
    ResetCachedStyles();
    goto lab_0x805f3de;
  lab_0x805f3de:;
    // 0x805f3de
    int32_t v107; // 0x805f0d2
    if (display_partial == 0) {
        goto lab_0x805f424;
    } else {
        int32_t v108 = *(int32_t *)(v1 + 2192); // 0x805f3ec
        if (v108 == 0) {
            goto lab_0x805f424;
        } else {
            int32_t v109 = Stbl_getStartLineDeep((int32_t *)v108); // 0x805f402
            int32_t v110 = display_lines + v9; // 0x805f40f
            v107 = v110 < v109 ? v110 : v109;
            goto lab_0x805f42f;
        }
    }
  lab_0x805f424:
    // 0x805f424
    v107 = display_lines + v9;
    goto lab_0x805f42f;
  lab_0x805f42f:
    // 0x805f42f
    v18 = v107;
    v54 = (int32_t *)-1;
    v49 = 0;
    if (v8 == 0) {
        goto lab_0x805f94c;
    } else {
        // 0x805f439
        if (display_partial != 0) {
            goto lab_0x805f452;
        } else {
            // 0x805f444
            if (*(int32_t *)(v1 + 2184) == v9) {
                goto lab_0x805f45c;
            } else {
                goto lab_0x805f452;
            }
        }
    }
  lab_0x805ffa7:
    // 0x805ffa7
    LYFreeHilites(nlinks, g190);
    g190 = nlinks;
    more_links = 0;
    if (!v15 && traversal != 0) {
        // 0x805ffe0
        if (*(int32_t *)v13 != 0) {
            // 0x805ffe9
            more_links = 1;
        }
    }
    // 0x8060013
    display_scrollbar(text);
    if (display_partial == 0) {
        // 0x8060073
        ResetPartialLinenos(text);
        // 0x806007e
        LYrefresh();
        // 0x8060083
        return;
    }
    int32_t v51 = *v52; // 0x8060032
    int32_t v53 = (int32_t)v54; // 0x8060038
    if (v51 > v53 || enable_scrollback != 0) {
        // 0x8060073
        ResetPartialLinenos(text);
        // 0x806007e
        LYrefresh();
        // 0x8060083
        return;
    }
    // 0x8060048
    if (recent_sizechange == 0) {
        // 0x8060053
        *(int32_t *)(v1 + 2184) = v51;
        *(int32_t *)(v1 + 2188) = v53;
        // 0x806007e
        LYrefresh();
        // 0x8060083
        return;
    }
    // 0x8060073
    ResetPartialLinenos(text);
    // 0x806007e
    LYrefresh();
  lab_0x805f452:
    // 0x805f452
    *(char *)(v1 + 2179) = 0;
    goto lab_0x805f45c;
  lab_0x805f45c:
    // 0x805f45c
    v54 = (int32_t *)-1;
    v49 = v8;
    if (display_lines > 0) {
        // 0x805f468
        v55 = (char *)(v1 + 2251);
        v56 = 0;
        v57 = NULL;
        v58 = v8;
        v59 = (int32_t *)-1;
        while (true) {
          lab_0x805f468:
            // 0x805f468
            v60 = v59;
            v61 = v58;
            v62 = v57;
            v63 = v56;
            if (LYNoCore != 0) {
                goto lab_0x805f4a1;
            } else {
                if (v61 != 0) {
                    goto lab_0x805f502;
                } else {
                    // 0x805f47d
                    __assert_fail("line != ((void *)0)", "./GridText.c", 2120, "display_page");
                    goto lab_0x805f4a1;
                }
            }
        }
      lab_0x805f4a7:
        // 0x805f4a7
        if (enable_scrollback != 0) {
            // 0x805f4b2
            function_804a8f4((int32_t)LYwin, 42);
            LYrefresh();
            LYclear();
        }
        // 0x805f4d1
        LYwaddnstr(LYwin, "\n\nError drawing page!\nBad HText structure!\n", 43);
        LYrefresh();
        nlinks = 0;
        // 0x8060083
        return;
    }
    goto lab_0x805f94c;
  lab_0x805ff66:
    // 0x805ff66
    v15 = false;
    if (WWW_TraceFlag == 0) {
        goto lab_0x805ffa7;
    } else {
        // 0x805ff71
        fprintf(TraceFP(), "\ndisplay_page: MAXLINKS reached.\n");
        v15 = false;
        goto lab_0x805ffa7;
    }
  lab_0x805f8e9:
    // 0x805f8e9
    LYmove(v64 + v65, 0);
    LYclrtoeol();
    int32_t v66 = v64 + 1;
    v64 = v66;
    v54 = v60;
    v49 = v61;
    if (display_lines > v66) {
        goto lab_0x805f8e9;
    } else {
        goto lab_0x805f94c;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8066ef9 - 0x8066f5b
// Line range:    5658 - 5673
int32_t remove_special_attr_chars(char * buf) {
    char v1 = *buf; // 0x8066f49
    char * v2 = buf; // 0x8066f4e
    int32_t result = 0; // 0x8066f4e
    if (v1 == 0) {
        // 0x8066f50
        *buf = 0;
        return 0;
    }
    char * v3 = buf; // 0x8066f27
    if (v1 >= 9) {
        // 0x8066f33
        *buf = v1;
        v3 = (char *)((int32_t)buf + 1);
    }
    // 0x8066f42
    result += (int32_t)(v1 == 8);
    char * v4 = v3;
    v2 = (char *)((int32_t)v2 + 1);
    char v5 = *v2; // 0x8066f49
    while (v5 != 0) {
        char * v6 = v4;
        char v7 = v5;
        v3 = v6;
        if (v7 >= 9) {
            // 0x8066f33
            *v6 = v7;
            v3 = (char *)((int32_t)v6 + 1);
        }
        // 0x8066f42
        result += (int32_t)(v7 == 8);
        v4 = v3;
        v2 = (char *)((int32_t)v2 + 1);
        v5 = *v2;
    }
    // 0x8066f50
    *v4 = 0;
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80670e3 - 0x8067805
// Line range:    5773 - 6037
void HText_trimHightext(int32_t * text, char final, int32_t stop_before) {
    if (text == NULL) {
        // 0x80677fd
        return;
    }
    int32_t v1 = (int32_t)text;
    int32_t v2; // 0x80670e3
    if (final == 0) {
        int32_t v3 = *(int32_t *)(v1 + 2104);
        int32_t v4 = stop_before < 0 | v3 < stop_before ? v3 : stop_before;
        v2 = v4;
        if (WWW_TraceFlag != 0) {
            // 0x8067158
            fprintf(TraceFP(), "GridText: Entering HText_trimHightext (partial: 0..%d/%d)\n", v4, v3);
            v2 = v4;
        }
    } else {
        // 0x8067109
        v2 = stop_before;
        if (WWW_TraceFlag != 0) {
            // 0x8067114
            fprintf(TraceFP(), "GridText: Entering HText_trimHightext (final)\n");
            v2 = stop_before;
        }
    }
    int32_t v5 = *(int32_t *)(v1 + 2108);
    if (v5 == 0) {
        // 0x80677fd
        return;
    }
    int32_t * v6 = (int32_t *)(v1 + 4); // 0x8067188
    int32_t * v7 = (int32_t *)(v1 + 2104);
    int32_t * v8 = (int32_t *)*(int32_t *)*v6;
    int32_t v9 = v5;
    int32_t v10 = 0;
    int32_t v11 = 0;
    int32_t * v12; // 0x80670e3
    int16_t * v13; // 0x80670e3
    int16_t * v14; // 0x80670e3
    int32_t * v15; // 0x80670e3
    char * v16; // 0x80670e3
    int32_t * v17; // 0x80670e3
    int32_t v18; // 0x80670e3
    int16_t * v19; // 0x80670e3
    int32_t v20; // 0x80670e3
    char * str; // 0x80670e3
    while (true) {
      lab_0x80671b4:;
        int32_t v21 = v11;
        v11 = v9;
        v12 = (int32_t *)(v11 + 16);
        v13 = (int16_t *)(v11 + 20);
        v14 = (int16_t *)(v11 + 22);
        v15 = (int32_t *)(v11 + 12);
        v16 = (char *)(v11 + 27);
        char * v22 = (char *)(v11 + 24);
        v17 = (int32_t *)v11;
        int32_t * v23 = (int32_t *)(v11 + 8);
        int32_t * v24 = (int32_t *)(v21 + 16);
        int32_t v25 = *v12;
        int32_t * v26 = v8; // 0x80670e3
        int32_t v27 = v10; // 0x80670e3
        while (true) {
            // 0x80671b4
            v10 = v27;
            v8 = v26;
            int32_t v28 = v25; // 0x80671b7
            int32_t v29 = v28; // 0x80671bd
            if (v28 <= v10) {
                // 0x80671bf
                v18 = (int32_t)v8;
                v19 = (int16_t *)(v18 + 10);
                v20 = v18 + 18;
                str = (char *)v20;
                int32_t v30 = v28; // 0x80670e3
                uint16_t v31; // 0x80671fe
                int32_t v32; // 0x806721c
                if (final == 0) {
                    if (v10 >= v2) {
                        return;
                    }
                    // 0x80671d5
                    if (v30 >= *v7 - 1) {
                        // 0x80671eb
                        v31 = *(int16_t *)(*(int32_t *)(*v6 + 4) + 10);
                        if ((int32_t)*v13 >= (int32_t)v31) {
                            return;
                        }
                    }
                    // 0x806720d
                    if (*v14 == 0) {
                        // 0x8067219
                        v32 = *v15;
                        if (v32 != 0) {
                            // 0x8067223
                            if (*v16 % 2 != 0) {
                                // 0x8067234
                                if (*v22 == 0) {
                                    // 0x806723f
                                    if (v32 == *(int32_t *)(v1 + 2128)) {
                                        // break (via goto) -> 0x80677e5
                                        goto lab_0x80677fd_3;
                                    }
                                }
                            }
                        }
                    }
                }
                // 0x8067256
                if (LYGetHiTextStr(v17, 0) != NULL) {
                    // break (via goto) -> 0x80677e5
                    goto lab_0x80677fd_3;
                }
                int16_t v33 = *v13; // 0x8067274
                uint16_t v34 = *v19; // 0x806727e
                int16_t v35 = v33; // 0x8067287
                if ((int32_t)v33 > (int32_t)v34) {
                    // 0x8067289
                    *v13 = v34;
                    v35 = v34;
                }
                // 0x8067299
                if (v35 < 0) {
                    // 0x80672a5
                    *v13 = 0;
                    *v12 = v10;
                }
                // 0x80672b7
                int16_t v36; // 0x80672c5
                int32_t v37; // 0x80672cf
                int32_t v38; // 0x80672d5
                int16_t v39; // 0x80672db
                if (WWW_TraceFlag != 0) {
                    // 0x80672c2
                    v36 = *v14;
                    v37 = *v15;
                    v38 = *v23;
                    v39 = *v13;
                    fprintf(TraceFP(), "GridText: Anchor found on line:%d col:%d [%05d:%d] ext:%d\n", v10, (int32_t)v39, v38, v37, (int32_t)v36);
                }
                // 0x8067316
                unsigned char v40; // 0x80670e3
                unsigned char v41; // 0x80670e3
                int16_t * v42; // 0x8067385
                int16_t v43; // 0x8067390
                int16_t v44; // 0x8067390
                if (*v16 % 2 != 0) {
                    // 0x806732e
                    v41 = *(char *)(v20 + (int32_t)*v13);
                    v42 = *__ctype_b_loc();
                    v43 = *(int16_t *)(2 * (int32_t)v41 + (int32_t)v42);
                    if (v41 < 9 || (v43 & 0x2000) != 0) {
                        *v13 = *v13 + 1;
                        *v14 = *v14 - 1;
                        v40 = *(char *)(v20 + (int32_t)*v13);
                        v44 = *(int16_t *)(2 * (int32_t)v40 + (int32_t)*__ctype_b_loc());
                        while (v40 < 9 || (v44 & 0x2000) != 0) {
                            // 0x8067345
                            *v13 = *v13 + 1;
                            *v14 = *v14 - 1;
                            v40 = *(char *)(v20 + (int32_t)*v13);
                            v44 = *(int16_t *)(2 * (int32_t)v40 + (int32_t)*__ctype_b_loc());
                        }
                    }
                }
                // 0x80673ab
                if (*v14 < 0) {
                    // 0x80673b7
                    *v14 = 0;
                }
                // 0x80673c0
                if (WWW_TraceFlag != 0) {
                    // 0x80673cb
                    fprintf(TraceFP(), "anchor text: '%s'\n", str);
                }
                // 0x80673ec
                if (strlen(str) > (int32_t)*v13) {
                    goto lab_0x80674b9;
                }
                // 0x806740c
                if (*v7 <= v10) {
                    goto lab_0x8067497_3;
                }
                // 0x806741a
                if (*v14 == 0) {
                    // 0x8067426
                    if ((int32_t)*v13 == (int32_t)*v19) {
                        if (v21 == 0) {
                            goto lab_0x8067497_3;
                        }
                        // 0x8067444
                        if (*v24 <= *v12) {
                            goto lab_0x8067497_3;
                        }
                    }
                }
                // 0x8067454
                *v12 = *v12 + 1;
                *v13 = 0;
                if (WWW_TraceFlag != 0) {
                    // 0x806747b
                    fprintf(TraceFP(), "found anchor at end of line\n");
                }
                int32_t v45 = *v12; // 0x80671b7
                v29 = v45;
                while (v45 <= v10) {
                    if (final == 0) {
                        if (v10 >= v2) {
                            return;
                        }
                        // 0x80671d5
                        if (v45 >= *v7 - 1) {
                            // 0x80671eb
                            v31 = *(int16_t *)(*(int32_t *)(*v6 + 4) + 10);
                            if ((int32_t)*v13 >= (int32_t)v31) {
                                return;
                            }
                        }
                        // 0x806720d
                        if (*v14 == 0) {
                            // 0x8067219
                            v32 = *v15;
                            if (v32 != 0) {
                                // 0x8067223
                                if (*v16 % 2 != 0) {
                                    // 0x8067234
                                    if (*v22 == 0) {
                                        // 0x806723f
                                        if (v32 == *(int32_t *)(v1 + 2128)) {
                                            // break (via goto) -> 0x80677e5
                                            goto lab_0x80677fd_3;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    // 0x8067256
                    if (LYGetHiTextStr(v17, 0) != NULL) {
                        // break (via goto) -> 0x80677e5
                        goto lab_0x80677fd_3;
                    }
                    // 0x8067271
                    v33 = *v13;
                    v34 = *v19;
                    v35 = v33;
                    if ((int32_t)v33 > (int32_t)v34) {
                        // 0x8067289
                        *v13 = v34;
                        v35 = v34;
                    }
                    // 0x8067299
                    if (v35 < 0) {
                        // 0x80672a5
                        *v13 = 0;
                        *v12 = v10;
                    }
                    // 0x80672b7
                    if (WWW_TraceFlag != 0) {
                        // 0x80672c2
                        v36 = *v14;
                        v37 = *v15;
                        v38 = *v23;
                        v39 = *v13;
                        fprintf(TraceFP(), "GridText: Anchor found on line:%d col:%d [%05d:%d] ext:%d\n", v10, (int32_t)v39, v38, v37, (int32_t)v36);
                    }
                    // 0x8067316
                    if (*v16 % 2 != 0) {
                        // 0x806732e
                        v41 = *(char *)(v20 + (int32_t)*v13);
                        v42 = *__ctype_b_loc();
                        v43 = *(int16_t *)(2 * (int32_t)v41 + (int32_t)v42);
                        if (v41 < 9 || (v43 & 0x2000) != 0) {
                            *v13 = *v13 + 1;
                            *v14 = *v14 - 1;
                            v40 = *(char *)(v20 + (int32_t)*v13);
                            v44 = *(int16_t *)(2 * (int32_t)v40 + (int32_t)*__ctype_b_loc());
                            while (v40 < 9 || (v44 & 0x2000) != 0) {
                                // 0x8067345
                                *v13 = *v13 + 1;
                                *v14 = *v14 - 1;
                                v40 = *(char *)(v20 + (int32_t)*v13);
                                v44 = *(int16_t *)(2 * (int32_t)v40 + (int32_t)*__ctype_b_loc());
                            }
                        }
                    }
                    // 0x80673ab
                    if (*v14 < 0) {
                        // 0x80673b7
                        *v14 = 0;
                    }
                    // 0x80673c0
                    if (WWW_TraceFlag != 0) {
                        // 0x80673cb
                        fprintf(TraceFP(), "anchor text: '%s'\n", str);
                    }
                    // 0x80673ec
                    if (strlen(str) > (int32_t)*v13) {
                        goto lab_0x80674b9;
                    }
                    // 0x806740c
                    if (*v7 <= v10) {
                        goto lab_0x8067497_3;
                    }
                    // 0x806741a
                    if (*v14 == 0) {
                        // 0x8067426
                        if ((int32_t)*v13 == (int32_t)*v19) {
                            if (v21 == 0) {
                                goto lab_0x8067497_3;
                            }
                            // 0x8067444
                            if (*v24 <= *v12) {
                                goto lab_0x8067497_3;
                            }
                        }
                    }
                    // 0x8067454
                    *v12 = *v12 + 1;
                    *v13 = 0;
                    if (WWW_TraceFlag != 0) {
                        // 0x806747b
                        fprintf(TraceFP(), "found anchor at end of line\n");
                    }
                    // 0x80671b4
                    v45 = *v12;
                    v29 = v45;
                }
            }
            // 0x80671a8
            v25 = v29;
            v26 = (int32_t *)*v8;
            v27 = v10 + 1;
        }
        goto lab_0x80677fd_3;
    }
  lab_0x80677fd_3:
    // 0x80677e5
    v9 = *v17;
    if (v9 == 0) {
        return;
    }
    goto lab_0x80671b4;
  lab_0x80674b9:;
    int16_t v46 = *v14; // 0x80674bc
    if (v46 < 1) {
        // 0x8067537
        LYClearHiText(v17);
        LYSetHiText(v17, (char *)&g12, 0);
        goto lab_0x806755d;
    } else {
        int16_t v47 = *v13; // 0x80674c8
        if (v47 < 0) {
            // 0x8067537
            LYClearHiText(v17);
            LYSetHiText(v17, (char *)&g12, 0);
            goto lab_0x806755d;
        } else {
            int32_t v48 = (int32_t)*v19 - (int32_t)v47; // 0x80674e5
            int32_t v49 = v46; // 0x80674f3
            LYClearHiText(v17);
            LYSetHiText(v17, (char *)(v20 + (int32_t)*v13), v48 > v49 ? v49 : v48);
            goto lab_0x806755d;
        }
    }
  lab_0x8067497_3:
    // 0x8067497
    if (WWW_TraceFlag == 0) {
        goto lab_0x80674b9;
    } else {
        // 0x80674a2
        fprintf(TraceFP(), "found anchor at end of line, leaving it there\n");
        goto lab_0x80674b9;
    }
  lab_0x806755d:;
    int32_t len = strlen(LYGetHiTextStr(v17, 0)); // 0x8067579
    char * v50 = (char *)len;
    int32_t * v51 = v8; // 0x8067598
    char * v52 = (char *)(int32_t)*v14; // 0x8067598
    int32_t v53 = v10; // 0x8067598
    goto lab_0x80676c7;
  lab_0x80676c7:;
    char * v54 = v52;
    int32_t * v55 = v51; // 0x80670e3
    int32_t v56 = v53; // 0x80670e3
    goto lab_0x80676c7_2;
  lab_0x80676c7_2:;
    int32_t v57 = v53; // 0x80676cd
    char ** str2; // bp-76, 0x80670e3
    int32_t v58; // 0x80675a3
    int32_t v59; // 0x80675aa
    int32_t * v60; // 0x80670e3
    int32_t v61; // 0x80675fd
    int32_t len2; // 0x8067628
    int32_t v62; // 0x806763c
    if (v54 > v50) {
        // 0x806759d
        v58 = v56 + 1;
        if (final != 0 || v58 < v2) {
            int32_t * v63 = v55;
            v57 = v58;
            if (*v6 == (int32_t)v63) {
                goto lab_0x80676d3;
            } else {
                // 0x80675dc
                v59 = *v63;
                v60 = (int32_t *)v59;
                v55 = v60;
                v56 = v58;
                if (v59 == 0) {
                    goto lab_0x80676c7_2;
                } else {
                    // 0x80675e6
                    str2 = NULL;
                    v61 = (int32_t)v54;
                    SNACopy((char **)&str2, (char *)(v59 + 18), v61 - len);
                    len2 = strlen((char *)str2);
                    v62 = remove_special_attr_chars((char *)str2);
                    if (*v16 % 2 == 0) {
                        goto lab_0x8067660;
                    } else {
                        // 0x8067655
                        LYTrimTrailing((char *)str2);
                        goto lab_0x8067660;
                    }
                }
            }
        } else {
            // 0x80675bd
            LYClearHiText(v17);
            v57 = v58;
            goto lab_0x80676d3;
        }
    } else {
        goto lab_0x80676d3;
    }
  lab_0x80676d3:
    // 0x80676d3
    if (final != 0 || v57 < v2) {
        char * v64 = LYGetHiTextStr(v17, 0); // 0x80676f3
        remove_special_attr_chars(v64);
        if (*v16 % 2 == 0) {
            goto lab_0x8067722;
        } else {
            // 0x8067717
            LYTrimTrailing(v64);
            goto lab_0x8067722;
        }
    } else {
        goto lab_0x80677fd_3;
    }
  lab_0x8067722:;
    int16_t v65 = *v13; // 0x8067730
    int16_t v66 = v65; // 0x8067737
    if (v65 < 1) {
        goto lab_0x8067775;
    } else {
        int16_t v67 = LYstrExtent2(str, (int32_t)v65); // 0x8067753
        *v13 = v67;
        v66 = v67;
        if (*str != 8) {
            goto lab_0x8067775;
        } else {
            int16_t v68 = v67 + 1; // 0x8067769
            *v13 = v68;
            v66 = v68;
            goto lab_0x8067775;
        }
    }
  lab_0x8067775:
    // 0x8067775
    *v13 = *(int16_t *)(v18 + 8) + v66;
    *v12 = v10;
    if (WWW_TraceFlag == 0) {
        goto lab_0x80677fd_3;
    } else {
        int32_t v69 = *v15; // 0x80677a8
        int16_t v70 = *v13; // 0x80677ae
        fprintf(TraceFP(), "GridText:     add link on line %d col %d [%d] %s\n", v10, (int32_t)v70, v69, "in HText_trimHightext");
        goto lab_0x80677fd_3;
    }
  lab_0x8067660:;
    char * v71 = (char *)(v61 - len2); // 0x8067633
    int32_t v72 = v62 + (int32_t)*(int16_t *)(v59 + 8); // 0x8067641
    char ** v73 = str2; // 0x8067660
    if (v73 == NULL) {
        goto lab_0x806768c;
    } else {
        // 0x8067667
        if (*(char *)v73 == 0) {
            goto lab_0x806768c;
        } else {
            // 0x8067671
            LYAddHiText(v17, (char *)v73, v72);
            goto lab_0x80676ae;
        }
    }
  lab_0x806768c:
    if (v71 > v50) {
        // 0x8067694
        LYAddHiText(v17, (char *)&g12, v72);
        goto lab_0x80676ae;
    } else {
        goto lab_0x80676ae;
    }
  lab_0x80676ae:;
    char ** v74 = str2; // 0x80676ae
    if (v74 == NULL) {
        goto lab_0x80676c7_3;
    } else {
        // 0x80676b5
        free((int32_t *)v74);
        str2 = NULL;
        goto lab_0x80676c7_3;
    }
  lab_0x80676c7_3:
    // 0x80676c7
    v51 = v60;
    v52 = v71;
    v53 = v58;
    goto lab_0x80676c7;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806780f - 0x806788f
// Line range:    6055 - 6073
int32_t * HText_childNextNumber(int32_t number, char ** prev) {
    // 0x806780f
    if (HTMainText == NULL || number >= 0 != number != 0) {
        // 0x806788a
        return NULL;
    }
    char * v1 = *prev;
    char * v2 = number != 1 == (v1 != NULL) ? v1 : g203;
    char * v3 = v2; // 0x806785d
    char * v4 = v2; // 0x806785d
    if (v2 != NULL) {
        v4 = v3;
        while (*(int32_t *)((int32_t)v3 + 12) != number) {
            int32_t v5 = *(int32_t *)v3; // 0x8067854
            v3 = (char *)v5;
            if (v5 == 0) {
                // 0x806788a
                return NULL;
            }
            v4 = v3;
        }
    }
    int32_t * result = NULL; // 0x806786e
    if (v4 != NULL) {
        int32_t v6 = (int32_t)v4; // 0x806787c
        *(int32_t *)prev = v6;
        result = (int32_t *)*(int32_t *)(v6 + 48);
    }
    // 0x806788a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806788f - 0x8067aa2
// Line range:    6082 - 6150
void HText_FormDescNumber(int32_t number, char ** desc) {
    if (desc == NULL) {
        // 0x8067aa0
        return;
    }
    // 0x806789f
    if (HTMainText == NULL || g203 == NULL) {
        // 0x80678bd
        *(int32_t *)desc = (int32_t)gettext("unknown field or link");
        // 0x8067aa0
        return;
    }
    char * v1 = g203; // 0x80678bb
    if (number >= 0 != number != 0) {
        // 0x80678bd
        *(int32_t *)desc = (int32_t)gettext("unknown field or link");
        // 0x8067aa0
        return;
    }
    int32_t v2 = (int32_t)v1;
    int32_t * v3; // 0x806788f
    while (*(int32_t *)(v2 + 12) != number) {
        int32_t v4 = *(int32_t *)v1; // 0x8067922
        v1 = (char *)v4;
        if (v4 == 0) {
            // 0x806792d
            v3 = (int32_t *)(v4 + 28);
            goto lab_0x806792d_2;
        }
        v2 = (int32_t)v1;
    }
    int32_t * v5 = (int32_t *)(v2 + 28);
    int32_t v6 = *v5; // 0x80678f3
    if (v6 == 0) {
        // 0x8067907
        *(int32_t *)desc = (int32_t)gettext("unknown field or link");
        // 0x8067aa0
        return;
    }
    // 0x80678fa
    v3 = v5;
    if (*(int32_t *)(v6 + 8) == 0) {
        // 0x8067907
        *(int32_t *)desc = (int32_t)gettext("unknown field or link");
        // 0x8067aa0
        return;
    }
    goto lab_0x806792d_2;
  lab_0x806792d_2:;
    int32_t v7 = *(int32_t *)(*v3 + 8); // 0x8067933
    g365 = v7;
    switch (v7) {
        case 1: {
            // 0x806794f
            *(int32_t *)desc = (int32_t)gettext("text entry field");
            // break -> 0x8067aa0
            break;
        }
        case 2: {
            // 0x8067967
            *(int32_t *)desc = (int32_t)gettext("password entry field");
            // break -> 0x8067aa0
            break;
        }
        case 3: {
            // 0x806797f
            *(int32_t *)desc = (int32_t)gettext("checkbox");
            // break -> 0x8067aa0
            break;
        }
        case 4: {
            // 0x8067997
            *(int32_t *)desc = (int32_t)gettext("radio button");
            // break -> 0x8067aa0
            break;
        }
        case 5: {
            // 0x80679af
            *(int32_t *)desc = (int32_t)gettext("submit button");
            // break -> 0x8067aa0
            break;
        }
        case 6: {
            // 0x80679c7
            *(int32_t *)desc = (int32_t)gettext("reset button");
            // break -> 0x8067aa0
            break;
        }
        case 7: {
            // 0x80679df
            *(int32_t *)desc = (int32_t)gettext("popup menu");
            // break -> 0x8067aa0
            break;
        }
        case 8: {
            // 0x80679f7
            *(int32_t *)desc = (int32_t)gettext("hidden form field");
            // break -> 0x8067aa0
            break;
        }
        case 9: {
            // 0x8067a0f
            *(int32_t *)desc = (int32_t)gettext("text entry area");
            // break -> 0x8067aa0
            break;
        }
        case 10: {
            // 0x8067a24
            *(int32_t *)desc = (int32_t)gettext("range entry field");
            // break -> 0x8067aa0
            break;
        }
        case 11: {
            // 0x8067a39
            *(int32_t *)desc = (int32_t)gettext("file entry field");
            // break -> 0x8067aa0
            break;
        }
        case 12: {
            // 0x8067a4e
            *(int32_t *)desc = (int32_t)gettext("text-submit field");
            // break -> 0x8067aa0
            break;
        }
        case 13: {
            // 0x8067a63
            *(int32_t *)desc = (int32_t)gettext("image-submit button");
            // break -> 0x8067aa0
            break;
        }
        case 14: {
            // 0x8067a78
            *(int32_t *)desc = (int32_t)gettext("keygen field");
            // break -> 0x8067aa0
            break;
        }
        default: {
            // 0x8067a8d
            *(int32_t *)desc = (int32_t)gettext("unknown form field");
            // break -> 0x8067aa0
            break;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8067aa2 - 0x8067dda
// Line range:    6161 - 6229
int32_t HTGetRelLinkNum(int32_t num, int32_t rel, int32_t cur) {
    int32_t v1 = HText_getTopOfScreen(); // 0x8067ab1
    int32_t v2 = 68 * cur; // 0x8067ac4
    int32_t v3 = *(int32_t *)(v2 + (int32_t)&g350); // 0x8067ac6
    int32_t v4 = *(int32_t *)(v2 + (int32_t)&g345); // 0x8067adc
    int32_t v5; // 0x8067aa2
    if (v3 < v1) {
        // 0x8067b03
        v5 = 0;
        goto lab_0x8067b0a;
    } else {
        // 0x8067aed
        v5 = 1;
        if (display_lines + v1 > v3) {
            goto lab_0x8067b0a;
        } else {
            // 0x8067b03
            v5 = 0;
            goto lab_0x8067b0a;
        }
    }
  lab_0x8067b0a:;
    int32_t v6 = *(int32_t *)(v2 + (int32_t)&g349); // 0x8067b1d
    if (WWW_TraceFlag != 0) {
        // 0x8067b69
        fprintf(TraceFP(), "HTGetRelLinkNum(%d,%d,%d) -- HTMainText=%p\n", num, rel, cur, HTMainText);
        if (WWW_TraceFlag != 0) {
            char * v7 = v5 == 0 ? (char *)&g14 : "on_screen";
            fprintf(TraceFP(), "  scrtop=%d, curline=%d, curanchor=%d, display_lines=%d, %s\n", v1, v3, v6, display_lines, v7);
        }
    }
    // 0x8067bc9
    if (HTMainText == NULL) {
        // 0x8067dd0
        return 0;
    }
    // 0x8067bde
    if (rel == 0) {
        // 0x8067dd0
        return num;
    }
    if (v5 == 0 || v6 == 0) {
        char * v8 = g203; // 0x8067cdc
        int32_t * v9 = NULL; // 0x8067cdc
        int32_t v10 = v6; // 0x8067cdc
        char * v11 = g203; // 0x8067cdc
        int32_t v12 = v6; // 0x8067cdc
        int32_t * v13 = NULL; // 0x8067cdc
        if (g203 != NULL) {
            int32_t v14 = (int32_t)v8;
            int32_t * v15; // 0x8067aa2
            int32_t * v16; // 0x8067aa2
            if (WWW_TraceFlag == 0) {
                // 0x8067c76
                v15 = (int32_t *)(v14 + 16);
            } else {
                // 0x8067c81
                v16 = (int32_t *)(v14 + 16);
                fprintf(TraceFP(), "  a->line_num=%d, a->number=%d\n", *v16, *(int32_t *)(v14 + 12));
                v15 = v16;
            }
            // 0x8067cac
            v11 = v8;
            v12 = v10;
            v13 = v9;
            while (*v15 < v1) {
                int32_t v17 = *(int32_t *)(v14 + 12); // 0x8067cba
                int32_t v18 = v17 == 0 ? v10 : v17;
                int32_t * v19 = v17 == 0 ? v9 : (int32_t *)v8;
                int32_t v20 = *(int32_t *)v8; // 0x8067cd3
                char * v21 = (char *)v20;
                v8 = v21;
                v9 = v19;
                v10 = v18;
                v11 = v21;
                v12 = v18;
                v13 = v19;
                if (v20 == 0) {
                    // break -> 0x8067cde
                    break;
                }
                v14 = (int32_t)v8;
                if (WWW_TraceFlag == 0) {
                    // 0x8067c76
                    v15 = (int32_t *)(v14 + 16);
                } else {
                    // 0x8067c81
                    v16 = (int32_t *)(v14 + 16);
                    fprintf(TraceFP(), "  a->line_num=%d, a->number=%d\n", *v16, *(int32_t *)(v14 + 12));
                    v15 = v16;
                }
                // 0x8067cac
                v11 = v8;
                v12 = v10;
                v13 = v9;
            }
        }
        // 0x8067cde
        if (WWW_TraceFlag != 0) {
            // 0x8067ce9
            fprintf(TraceFP(), "  a=%p, l=%p, curanchor=%d\n", v11, v13, v12);
        }
        char * v22 = v11; // 0x8067d1b
        int32_t v23 = v12; // 0x8067d1b
        int32_t * v24 = v13; // 0x8067d1b
        if (v11 != NULL == (v5 != 0)) {
            int32_t v25 = (int32_t)v11; // 0x8067d1f
            int32_t v26 = *(int32_t *)(v25 + 12); // 0x8067d22
            int32_t v27 = v26 == 0 ? v12 : v26;
            int32_t * v28 = v26 == 0 ? v13 : (int32_t *)v11;
            if (*(int32_t *)(v25 + 16) == v3) {
                // 0x8067d43
                if (v4 == (int32_t)*(int16_t *)(v25 + 20)) {
                    // break -> 0x8067d5e
                    break;
                }
            }
            int32_t v29 = *(int32_t *)v11; // 0x8067d53
            char * v30 = (char *)v29;
            int32_t * v31 = v28; // 0x8067d5c
            int32_t v32 = v27; // 0x8067d5c
            v22 = v30;
            v23 = v27;
            v24 = v28;
            while (v29 != 0) {
                char * v33 = v30;
                v25 = (int32_t)v33;
                v26 = *(int32_t *)(v25 + 12);
                v27 = v26 == 0 ? v32 : v26;
                v28 = v26 == 0 ? v31 : (int32_t *)v33;
                if (*(int32_t *)(v25 + 16) == v3) {
                    // 0x8067d43
                    v22 = v33;
                    v23 = v27;
                    v24 = v28;
                    if (v4 == (int32_t)*(int16_t *)(v25 + 20)) {
                        // break -> 0x8067d5e
                        break;
                    }
                }
                // 0x8067d50
                v29 = *(int32_t *)v33;
                v30 = (char *)v29;
                v31 = v28;
                v32 = v27;
                v22 = v30;
                v23 = v27;
                v24 = v28;
            }
        }
        // 0x8067d5e
        if (rel == 43) {
            // 0x8067dd0
            return v23 + num;
        }
        // 0x8067d71
        if (rel != 45) {
            // 0x8067dd0
            return num;
        }
        // 0x8067d77
        if (v24 != NULL) {
            // 0x8067dd0
            return 1 - num + v23;
        }
        // 0x8067d95
        if (v22 == NULL) {
            // 0x8067dd0
            return 0;
        }
        char * v34 = v22;
        while (*(int32_t *)((int32_t)v34 + 12) == 0) {
            int32_t v35 = *(int32_t *)v34; // 0x8067d90
            if (v35 == 0) {
                // 0x8067dd0
                return 0;
            }
            v34 = (char *)v35;
        }
        int32_t result = 0; // 0x8067da9
        if (v34 != NULL) {
            // 0x8067dab
            result = *(int32_t *)((int32_t)v34 + 12) - num;
        }
        // 0x8067dd0
        return result;
    }
    // 0x8067bfb
    if (WWW_TraceFlag != 0) {
        // 0x8067c06
        fprintf(TraceFP(), "curanchor=%d at line %d on screen\n", v6, v3);
    }
    if (rel != 43) {
        // 0x8067c43
        return rel != 45 ? num : v6 - num;
    }
    // 0x8067dd0
    return v6 + num;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8067dda - 0x8068058
// Line range:    6249 - 6401
int32_t HTGetLinkInfo(int32_t number, int32_t want_go, int32_t * go_line, int32_t * linknum, char ** hightext, char ** lname) {
    // 0x8067dda
    if (HTMainText == NULL || g203 == NULL) {
        // 0x8068053
        return 0;
    }
    int32_t v1 = (int32_t)g203; // 0x806803d
    int32_t * v2 = NULL;
    int32_t * v3 = NULL;
    int32_t v4 = -1;
    int32_t v5 = -1;
    int32_t v6; // 0x8067dda
    int32_t * v7; // 0x8067dda
    int32_t * v8; // 0x8067dda
    int32_t v9; // 0x8067dda
    int32_t v10; // 0x8067dda
    int32_t v11; // 0x8067dda
    int32_t v12; // 0x8067dda
    int32_t * v13; // 0x8067dda
    int32_t * v14; // 0x8067dda
    char v15; // 0x8067e27
    while (true) {
      lab_0x8067e24:
        // 0x8067e24
        v12 = v5;
        v10 = v4;
        v14 = v3;
        v8 = v2;
        v6 = v1;
        v15 = *(char *)(v6 + 24);
        v11 = v12;
        v9 = v10;
        v13 = v14;
        v7 = v8;
        if (v15 == 0) {
            goto lab_0x8067e88;
        } else {
            // 0x8067e2f
            if (*(char *)(v6 + 27) != 2) {
                goto lab_0x8067e48;
            } else {
                // 0x8067e3a
                v11 = v12;
                v9 = v10;
                v13 = v14;
                v7 = v8;
                if (*(int32_t *)(*(int32_t *)(v6 + 28) + 8) == 8) {
                    goto lab_0x8067e88;
                } else {
                    goto lab_0x8067e48;
                }
            }
        }
    }
  lab_0x8067e97:
    if (want_go == 0) {
        // 0x8067e9d
        if (*(char *)(v6 + 27) != 2) {
            // 0x8067fac
            *(int32_t *)hightext = (int32_t)LYGetHiTextStr((int32_t *)v6, 0);
            int32_t * v16 = HTAnchor_followLink((int32_t *)*(int32_t *)(v6 + 48)); // 0x8067fcf
            char * v17; // 0x8067dda
            if (traversal == 0) {
                // 0x8067ff9
                v17 = HTAnchor_address(v16);
            } else {
                // 0x8067fe9
                v17 = stub_HTAnchor_address(v16);
            }
            // 0x8068007
            HTSACopy(lname, v17);
            if (v17 != NULL) {
                // 0x806801f
                free((int32_t *)v17);
            }
            // 0x8068053
            return 2;
        }
    }
    // 0x8067eac
    if (v15 == 0) {
        // 0x8068053
        return 0;
    }
    if (v3 >= (int32_t *)1) {
        uint32_t v18 = (int32_t)v3; // 0x8067ece
        if (nlinks >= v18) {
            uint32_t v19 = *(int32_t *)(v6 + 16); // 0x8067ed6
            if (v19 >= g208) {
                // 0x8067ee8
                if (v19 < display_lines + g208) {
                    // 0x8067f05
                    *go_line = g208;
                    if (linknum != NULL) {
                        // 0x8067f1f
                        *linknum = v18 - 1;
                    }
                    // 0x8068053
                    return 8;
                }
            }
        }
    }
    int32_t v20 = display_lines; // 0x8067f42
    int32_t v21 = v4 - (v20 > 3 ? 3 : v20 - 1); // 0x8067f5f
    int32_t v22 = v21 > v5 ? v21 : v5 + 1;
    *go_line = v22 >= 0 ? v22 : 0;
    if (linknum != NULL) {
        // 0x8067f95
        *linknum = (int32_t)v2 - 1;
    }
    // 0x8068053
    return 8;
  lab_0x8067e88:
    // 0x8067e88
    v2 = v7;
    v3 = v13;
    v4 = v9;
    v5 = v11;
    if (*(int32_t *)(v6 + 12) == number) {
        // break -> 0x8067e97
        goto lab_0x8067e97;
    }
    // 0x806803a
    v1 = *(int32_t *)v6;
    if (v1 == 0) {
        // 0x8068053
        return 0;
    }
    goto lab_0x8067e24;
  lab_0x8067e48:;
    uint32_t v23 = *(int32_t *)(v6 + 16); // 0x8067e4b
    int32_t v24 = v23 != v10 ? v10 : v12;
    int32_t v25 = v23 != v10 ? v23 : v10;
    int32_t * v26 = v23 != v10 ? (int32_t *)1 : (int32_t *)((int32_t)v8 + 1);
    v11 = v24;
    v9 = v25;
    v13 = v14;
    v7 = v26;
    if (v23 >= g208) {
        // 0x8067e84
        v11 = v24;
        v9 = v25;
        v13 = (int32_t *)((int32_t)v14 + 1);
        v7 = v26;
    }
    goto lab_0x8067e88;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068058 - 0x8068152
// Line range:    6408 - 6436
char same_anchor_or_field(int32_t numberA, int32_t * formA, int32_t numberB, int32_t * formB, char ta_same) {
    if (numberA >= 0 != numberA != 0 != numberB < 1) {
        // 0x8068070
        if (numberA == numberB) {
            // 0x806814c
            return 1;
        }
        // 0x8068081
        if (ta_same == 0) {
            // 0x806814c
            return 0;
        }
    }
    // 0x8068090
    if (formA == NULL == formB == NULL) {
        // 0x806814c
        return 0;
    }
    // 0x806809c
    if (formA == formB) {
        // 0x806814c
        return 1;
    }
    // 0x80680ad
    if (ta_same == 0 || formB != NULL != formA != NULL) {
        // 0x806814c
        return 0;
    }
    int32_t v1 = (int32_t)formB;
    int32_t v2 = (int32_t)formA;
    int32_t v3 = *(int32_t *)(v2 + 8); // 0x80680d1
    int32_t v4 = *(int32_t *)(v1 + 8); // 0x80680d7
    if (v4 == 9 != (v3 == 9 == v3 == v4) || *(int32_t *)(v2 + 4) != *(int32_t *)(v1 + 4)) {
        // 0x806814c
        return 0;
    }
    int32_t str = *formA; // 0x806811b
    if (str == 0) {
        // 0x806814c
        return 1;
    }
    int32_t str2 = *formB; // 0x8068124
    char result = 1; // 0x8068128
    if (str2 != 0) {
        // 0x8068130
        result = strcmp((char *)str, (char *)str2) == 0;
    }
    // 0x806814c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068152 - 0x80683ec
// Line range:    6458 - 6487
char HText_TAHasMoreLines(int32_t curlink, int32_t direction) {
    // 0x8068152
    if (HTMainText == NULL) {
        // 0x80683e6
        return 0;
    }
    // 0x8068171
    if (direction >= 0) {
        // 0x80683d8
        if (g203 == NULL) {
            // 0x80683e6
            return 0;
        }
        int32_t v1 = 68 * curlink;
        int32_t v2 = (int32_t)g203;
        int32_t v3; // 0x80682e9
        if (*(char *)(v2 + 27) == 2) {
            // 0x80682d3
            v3 = *(int32_t *)(v2 + 28);
            if (*(int32_t *)(v1 + (int32_t)&g354) == v3) {
                // break -> 0x80682fe
                break;
            }
        }
        uint32_t v4 = *(int32_t *)(v1 + (int32_t)&g349); // 0x80683a9
        if (v4 != 0) {
            // 0x80683b3
            if (*(int32_t *)(v2 + 12) >= v4) {
                // 0x80683e6
                return 0;
            }
        }
        int32_t v5 = *(int32_t *)g203; // 0x80683d3
        while (v5 != 0) {
            char * v6 = (char *)v5; // 0x80683d0
            v2 = (int32_t)v6;
            if (*(char *)(v2 + 27) == 2) {
                // 0x80682d3
                v3 = *(int32_t *)(v2 + 28);
                if (*(int32_t *)(v1 + (int32_t)&g354) == v3) {
                    // break -> 0x80682fe
                    break;
                }
            }
            // 0x806839c
            v4 = *(int32_t *)(v1 + (int32_t)&g349);
            if (v4 != 0) {
                // 0x80683b3
                if (*(int32_t *)(v2 + 12) >= v4) {
                    // 0x80683e6
                    return 0;
                }
            }
            // 0x80683d0
            v5 = *(int32_t *)v6;
        }
        // 0x80683e6
        return 0;
    }
    // 0x806829e
    if (g203 == NULL) {
        // 0x80683e6
        return 0;
    }
    int32_t v7 = 68 * curlink;
    int32_t v8 = (int32_t)g203;
    int32_t v9; // 0x80681b3
    if (*(char *)(v8 + 27) == 2) {
        // 0x806819d
        v9 = *(int32_t *)(v8 + 28);
        if (*(int32_t *)(v7 + (int32_t)&g354) == v9) {
            // break -> 0x80681be
            break;
        }
    }
    uint32_t v10 = *(int32_t *)(v7 + (int32_t)&g349); // 0x8068269
    if (v10 != 0) {
        // 0x8068273
        if (*(int32_t *)(v8 + 12) >= v10) {
            // 0x80683e6
            return 0;
        }
    }
    int32_t v11 = *(int32_t *)g203; // 0x8068299
    while (v11 != 0) {
        char * v12 = (char *)v11;
        v8 = (int32_t)v12;
        if (*(char *)(v8 + 27) == 2) {
            // 0x806819d
            v9 = *(int32_t *)(v8 + 28);
            if (*(int32_t *)(v7 + (int32_t)&g354) == v9) {
                // break -> 0x80681be
                break;
            }
        }
        // 0x806825c
        v10 = *(int32_t *)(v7 + (int32_t)&g349);
        if (v10 != 0) {
            // 0x8068273
            if (*(int32_t *)(v8 + 12) >= v10) {
                // 0x80683e6
                return 0;
            }
        }
        // 0x8068290
        v11 = *(int32_t *)v12;
    }
    // 0x80683e6
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80683ec - 0x8068a53
// Line range:    6517 - 6692
int32_t HTGetLinkOrFieldStart(int32_t curlink, int32_t * go_line, int32_t * linknum, int32_t direction, char ta_skip) {
    // 0x80683ec
    if (HTMainText == NULL) {
        // 0x8068a47
        return 0;
    }
    char * v1 = NULL; // bp-72, 0x806842d
    char * v2; // bp-56, 0x80683ec
    *(int32_t *)&v2 = 0;
    int32_t v3; // 0x80683ec
    int32_t v4; // 0x80683ec
    char v5; // 0x8068486
    int32_t * v6; // 0x80683ec
    int32_t * v7; // 0x80683ec
    int32_t * v8; // 0x80683ec
    char * v9; // 0x8068486
    if (g203 != NULL) {
        int32_t v10 = 68 * curlink;
        v6 = (int32_t *)(v10 + (int32_t)&g347);
        v7 = (int32_t *)(v10 + (int32_t)&g354);
        v8 = (int32_t *)(v10 + (int32_t)&g349);
        v3 = (int32_t)g203;
        while (true) {
          lab_0x8068474:
            // 0x8068474
            v4 = v3;
            if (*(char *)(v4 + 24) == 0) {
                goto lab_0x8068779;
            } else {
                // 0x8068483
                v9 = (char *)(v4 + 27);
                v5 = *v9;
                if (v5 != 2) {
                    goto lab_0x80684a0;
                } else {
                    // 0x806848e
                    if (*(int32_t *)(*(int32_t *)(v4 + 28) + 8) == 8) {
                        goto lab_0x8068779;
                    } else {
                        goto lab_0x80684a0;
                    }
                }
            }
        }
    }
  lab_0x806878b_3:
    // 0x806878b
    if (curlink >= 0) {
        // 0x8068a47
        return 0;
    }
    bool v11 = false; // 0x80683ec
    char ** v12 = &v1; // 0x80683ec
    if (direction >= 0 == (direction != 0)) {
        // 0x8068a47
        return 0;
    }
    goto lab_0x80687ad;
  lab_0x806878b:
    // 0x806878b
    v11 = curlink >= 0;
    char ** v30; // 0x80683ec
    v12 = v30;
    goto lab_0x80687ad;
  lab_0x8068779:;
    int32_t v31 = *(int32_t *)v4; // 0x806877c
    v3 = v31;
    if (v31 == 0) {
        // break -> 0x806878b
        goto lab_0x806878b_3;
    }
    goto lab_0x8068474;
  lab_0x80684a0:;
    int32_t v32 = (int32_t)v1;
    int32_t v33 = v32; // 0x80684cc
    if (v4 == 0 || v1 == NULL) {
        goto lab_0x806854c;
    } else {
        int32_t v34 = 0; // 0x80684e4
        if (v5 == 2) {
            // 0x80684e6
            v34 = *(int32_t *)(v4 + 28);
        }
        int32_t v35 = *(int32_t *)(v4 + 12); // 0x80684fb
        int32_t v36 = 0; // 0x806850a
        if (*(char *)(v32 + 27) == 2) {
            // 0x806850c
            v36 = *(int32_t *)(v32 + 28);
        }
        int32_t v37 = *(int32_t *)(v32 + 12); // 0x8068521
        if (same_anchor_or_field(v37, (int32_t *)v36, v35, (int32_t *)v34, ta_skip) != 0) {
            goto lab_0x8068588;
        } else {
            // 0x806851e
            v33 = (int32_t)v1;
            goto lab_0x806854c;
        }
    }
  lab_0x806854c:
    // 0x806854c
    *(int32_t *)&v2 = v33;
    *(int32_t *)&v1 = v4;
    goto lab_0x8068588;
  lab_0x8068588:
    if (curlink < 0) {
        // 0x8068731
        if (*(int32_t *)(v4 + 16) >= g208) {
            // 0x8068746
            v30 = direction < 0 ? &v2 : &v1;
            if (direction < 0 || direction != 0) {
                goto lab_0x806878b;
            } else {
                // 0x806875a
                v30 = v2 == NULL ? &v1 : &v2;
                goto lab_0x806878b;
            }
        }
        goto lab_0x8068779;
    } else {
        if (v4 == 0) {
            goto lab_0x806866b;
        } else {
            int32_t v38 = 0; // 0x80685b6
            if (*v9 == 2) {
                // 0x80685b8
                v38 = *(int32_t *)(v4 + 28);
            }
            int32_t v39 = *(int32_t *)(v4 + 12); // 0x80685cd
            int32_t v40 = 0; // 0x80685e9
            if (*v6 == 1) {
                // 0x80685eb
                v40 = *v7;
            }
            int32_t v41 = *v8; // 0x8068617
            if (same_anchor_or_field(v41, (int32_t *)v40, v39, (int32_t *)v38, ta_skip) == 0) {
                goto lab_0x806866b;
            } else {
                if (direction == -1 || direction == 0) {
                    char ** v42 = direction == -1 ? &v2 : &v1;
                    v30 = v42;
                    goto lab_0x806878b;
                }
                goto lab_0x8068779;
            }
        }
    }
  lab_0x806866b:
    // 0x806866b
    if (direction >= 1 && v2 != NULL) {
        int32_t v43 = (int32_t)v2;
        int32_t v44 = 0; // 0x806869a
        if (*(char *)(v43 + 27) == 2) {
            // 0x806869c
            v44 = *(int32_t *)(v43 + 28);
        }
        int32_t v45 = *(int32_t *)(v43 + 12); // 0x80686b1
        int32_t v46 = 0; // 0x80686cd
        if (*v6 == 1) {
            // 0x80686cf
            v46 = *v7;
        }
        char v47 = same_anchor_or_field(*v8, (int32_t *)v46, v45, (int32_t *)v44, ta_skip); // 0x8068720
        v30 = &v1;
        if (v47 != 0) {
            goto lab_0x806878b;
        }
    }
    goto lab_0x8068779;
  lab_0x80687ad:;
    char * v13 = *v12;
    if (v13 == NULL) {
        // 0x8068a47
        return 0;
    }
    int32_t v14 = (int32_t)v12;
    int32_t v15 = *(int32_t *)((int32_t)v13 + 16); // 0x80687c2
    int32_t v16 = g208; // 0x80687ca
    int32_t v17 = display_lines;
    if (v15 >= v16 - v17 && v15 < v16) {
        // 0x80687f8
        if (!v11) {
            // 0x80687fe
            if (*(int32_t *)(v14 + 12) == 1) {
                // 0x8068a47
                return 16;
            }
        }
        if (direction < 0) {
            // 0x806880f
            if (v12 != &v1 && v1 != NULL) {
                // 0x806881e
                if (*(int32_t *)((int32_t)v1 + 16) >= v16) {
                    // 0x8068833
                    if (*(int32_t *)(v14 + 12) == 1) {
                        // 0x8068a47
                        int32_t v18; // 0x80683ec
                        int32_t result = v18;
                        return result;
                    }
                }
            }
        }
        int32_t v19 = *(int32_t *)v13; // 0x8068841
        if (v19 != 0) {
            // 0x8068847
            if (*(int32_t *)(v19 + 16) >= v16) {
                // 0x8068a47
                return 16;
            }
        }
    }
    int32_t v20 = 0; // 0x8068877
    int32_t v21; // 0x80683ec
    if (v15 > v17) {
        if (v15 < v16) {
            int32_t v22 = v17 + v16 + -1 - v15; // 0x80688b5
            v21 = v15 - v16 + v17 * (int32_t)((0x100000000 * (int64_t)(v22 >> 31) | (int64_t)v22) / (int64_t)v17);
            goto lab_0x80689c0;
        } else {
            // 0x8068902
            if (g202 - v15 > v17) {
                // 0x8068943
                v20 = 3;
                if (v15 < v17 + v16) {
                    goto lab_0x80689cf;
                } else {
                    int32_t v23 = v15 - v16; // 0x8068973
                    v21 = v23 - v17 * (int32_t)((0x100000000 * (int64_t)(v23 >> 31) | (int64_t)v23) / (int64_t)v17);
                    goto lab_0x80689c0;
                }
            } else {
                // 0x806891e
                v21 = v17 + v15 + -1 - g202;
                goto lab_0x80689c0;
            }
        }
    } else {
        goto lab_0x80689cf;
    }
  lab_0x80689cf:;
    int32_t v24 = v20;
    int32_t v25 = v24 < v17 ? v24 : v17 - 1;
    int32_t v26 = v25; // 0x80683ec
    goto lab_0x80689e4;
  lab_0x80689e4:;
    int32_t v27 = v15 - v26; // 0x80689ec
    *go_line = v27;
    int32_t v28 = *(int32_t *)(v14 + 4); // 0x80689fc
    int32_t v29 = v27 > v28 ? v27 : v28 + 1; // 0x8068a14
    if (v27 > v28 != v29 >= 0) {
        *go_line = v29 >= 0 ? v29 : 0;
    }
    if (linknum != NULL) {
        // 0x8068a29
        *linknum = *(int32_t *)(v14 + 8) - 1;
    }
    // 0x8068a47
    return 8;
  lab_0x80689c0:
    // 0x80689c0
    v20 = v21;
    v26 = 0;
    if (v21 >= 0) {
        goto lab_0x80689cf;
    } else {
        goto lab_0x80689e4;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068a53 - 0x8068bfc
// Line range:    6711 - 6772
char HText_getFirstTargetInLine(int32_t * text, int32_t line_num, char utf_flag, int32_t * offset, int32_t * tLen, char ** data, char * target) {
    // 0x8068a53
    if (text == NULL || line_num < 0) {
        // 0x8068bf6
        return 0;
    }
    int32_t v1 = (int32_t)text;
    if (target == NULL | *(int32_t *)(v1 + 2104) < line_num || *target == 0) {
        // 0x8068bf6
        return 0;
    }
    int32_t v2 = *(int32_t *)(v1 + 4); // 0x8068a9c
    int32_t v3 = *(int32_t *)v2;
    int32_t v4 = v3; // 0x8068aca
    int32_t v5 = 0; // 0x8068aca
    int32_t v6 = v3; // 0x8068aca
    if (line_num > 0) {
        v6 = v4;
        while (v2 != v4) {
            // 0x8068aa6
            v4 = *(int32_t *)v4;
            if (v4 == 0) {
                // 0x8068bf6
                return 0;
            }
            // 0x8068ac4
            v5++;
            v6 = v4;
            if (v5 >= line_num) {
                // break -> 0x8068ad7
                break;
            }
            v6 = v4;
        }
    }
    char * v7 = (char *)(v6 + 18);
    if (v6 == 0) {
        // 0x8068add
        if (*v7 != 0) {
            // 0x8068bf6
            return 0;
        }
    }
    // 0x8068af1
    char * LineData; // bp-20, 0x8068a53
    int32_t LineOffset; // bp-24, 0x8068a53
    char * v8; // 0x8068a53
    if (case_sensitive == 0) {
        char * v9 = LYno_attr_mbcs_case_strstr(v7, target, utf_flag, 1, (int32_t *)&LineData, &LineOffset); // 0x8068b72
        v8 = v9;
    } else {
        char * v10 = LYno_attr_mbcs_strstr(v7, target, utf_flag, 1, (int32_t *)&LineData, &LineOffset); // 0x8068b3d
        v8 = v10;
    }
    // 0x8068b7a
    if (v8 == NULL) {
        // 0x8068bf6
        return 0;
    }
    int32_t v11 = (int32_t)*(int16_t *)(v6 + 8); // 0x8068afd
    char result = 0; // 0x8068bb1
    if (LineOffset + v11 <= (LYwideLines != 0 ? 1014 : LYcols)) {
        int32_t v12 = (int32_t)LineData; // 0x8068bb3
        *offset = v12 + v11;
        *tLen = LineOffset - v12;
        HTSACopy(data, v8);
        remove_special_attr_chars(*data);
        result = 1;
    }
    // 0x8068bf6
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068bfc - 0x8068c27
// Line range:    6779 - 6781
int32_t HText_getNumOfLines(void) {
    // 0x8068bfc
    return HTMainText == NULL ? 0 : g202;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068c27 - 0x8068c89
// Line range:    6788 - 6800
int32_t HText_getNumOfBytes(void) {
    // 0x8068c27
    return -1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068c89 - 0x8068cb8
// Line range:    6807 - 6810
char * HText_getTitle(void) {
    char * result = NULL; // 0x8068c96
    if (HTMainText != NULL) {
        // 0x8068c98
        result = HTAnchor_title(HTMainText);
    }
    // 0x8068cb3
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068cb8 - 0x8068ce7
// Line range:    6814 - 6817
char * HText_getStyle(void) {
    char * result = NULL; // 0x8068cc5
    if (HTMainText != NULL) {
        // 0x8068cc7
        result = HTAnchor_style(HTMainText);
    }
    // 0x8068ce2
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068ce7 - 0x8068d16
// Line range:    6826 - 6829
char * HText_getSugFname(void) {
    char * result = NULL; // 0x8068cf4
    if (HTMainText != NULL) {
        // 0x8068cf6
        result = HTAnchor_SugFname(HTMainText);
    }
    // 0x8068d11
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068d16 - 0x8068f21
// Line range:    6846 - 6953
void HTCheckFnameForCompression(char ** fname, int32_t * anchor, char strip_ok) {
    char * v1 = *fname; // 0x8068d25
    if (anchor == NULL || v1 == NULL) {
        // 0x8068f1f
        return;
    }
    char * str = LYPathLeaf(v1); // 0x8068d59
    if (*str == 0) {
        // 0x8068f1f
        return;
    }
    int32_t v2 = HTContentToCompressType(anchor); // 0x8068d75
    if (strip_ok == 0 == v2 == 0) {
        // 0x8068f1f
        return;
    }
    char * found_char_pos = strrchr(str, 46); // 0x8068d9b
    if (found_char_pos != NULL) {
        // 0x8068da9
        if (strcasecomp(found_char_pos, ".tgz") == 0) {
            if (v2 == 0) {
                // 0x8068dca
                memcpy((int32_t *)found_char_pos, (int32_t *)".tar", 5);
            }
            // 0x8068f1f
            return;
        }
    }
    char * found_char_pos2 = strrchr(str, 46); // 0x8068df8
    if (found_char_pos2 != NULL) {
        int32_t method = 0; // bp-32, 0x8068e0a
        if (HTCompressFileType(str, ".", &method) != 0) {
            if (v2 == 0) {
                // 0x8068e39
                *found_char_pos2 = 0;
            }
            // 0x8068f1f
            return;
        }
        int32_t v3 = HTCompressFileType(str, "-_", &method); // 0x8068e59
        if (v3 != 0) {
            int32_t v4 = method + (int32_t)str; // 0x8068e6a
            char * v5 = (char *)v4; // 0x8068e6d
            if (v2 == 0) {
                // 0x8068e76
                *(((int32_t)found_char_pos2 + 1 != v4 ? v5 : (char *)(v4 - 1))) = 0;
                // 0x8068f1f
                return;
            }
            // 0x8068e90
            *v5 = 46;
            if ((char *)v3 != (char *)1) {
                // 0x8068ea9
                LYLowerCase(v5);
            } else {
                // 0x8068e9c
                LYUpperCase(v5);
            }
            // 0x8068f1f
            return;
        }
    }
    char * v6 = HTCompressTypeToSuffix(v2); // 0x8068ebc
    if (*v6 == 0) {
        // 0x8068f1f
        return;
    }
    if (found_char_pos2 == NULL) {
        // 0x8068ed4
        HTSACat(fname, v6);
        // 0x8068f1f
        return;
    }
    // 0x8068ee8
    if (*(char *)((int32_t)found_char_pos2 + 1) != 0) {
        // 0x8068f0d
        HTSACat(fname, v6);
    } else {
        // 0x8068ef6
        HTSACat(fname, (char *)((int32_t)v6 + 1));
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068f21 - 0x8068f50
// Line range:    6960 - 6963
char * HText_getLastModified(void) {
    char * result = NULL; // 0x8068f2e
    if (HTMainText != NULL) {
        // 0x8068f30
        result = HTAnchor_last_modified(HTMainText);
    }
    // 0x8068f4b
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068f50 - 0x8068f7f
// Line range:    6970 - 6973
char * HText_getDate(void) {
    char * result = NULL; // 0x8068f5d
    if (HTMainText != NULL) {
        // 0x8068f5f
        result = HTAnchor_date(HTMainText);
    }
    // 0x8068f7a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068f7f - 0x8068fae
// Line range:    6980 - 6983
char * HText_getServer(void) {
    char * result = NULL; // 0x8068f8c
    if (HTMainText != NULL) {
        // 0x8068f8e
        result = HTAnchor_server(HTMainText);
    }
    // 0x8068fa9
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8068fae - 0x80690d2
// Line range:    7004 - 7042
void HText_pageDisplay(int32_t line_num, char * target) {
    // 0x8068fae
    if (debug_display_partial == 0 != (LYTraceLogFP == NULL) && WWW_TraceFlag != 0) {
        // 0x8068fd3
        fprintf(TraceFP(), "GridText: HText_pageDisplay at line %d started\n", line_num);
    }
    // 0x8068ff1
    if (display_partial != 0) {
        int32_t * v1 = HTMainText; // 0x806900a
        int32_t v2 = -1; // 0x806900a
        if (HTMainText != NULL && g212 != 0) {
            // 0x806901b
            v2 = Stbl_getStartLineDeep((int32_t *)g212);
            v1 = HTMainText;
        }
        // 0x8069031
        HText_trimHightext(v1, 0, v2);
    }
    // 0x806904e
    display_page(HTMainText, line_num - 1, target);
    if (display_partial != 0 && debug_display_partial != 0) {
        // 0x8069083
        LYSleepMsg();
    }
    // 0x8069088
    is_www_index = HTAnchor_isIndex(HTMainAnchor);
    if (debug_display_partial == 0 != (LYTraceLogFP == NULL) && WWW_TraceFlag != 0) {
        // 0x80690b9
        fprintf(TraceFP(), "GridText: HText_pageDisplay finished\n");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80690d2 - 0x80690fc
// Line range:    7049 - 7054
char HText_pageHasPrevTarget(void) {
    // 0x80690d2
    return HTMainText != NULL ? g210 : 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80690fc - 0x806919a
// Line range:    7063 - 7089
int32_t HText_closestAnchor(int32_t * text, int32_t offset) {
    int32_t v1 = *(int32_t *)((int32_t)text + 2108);
    if (v1 == 0) {
        // 0x8069195
        return -1;
    }
    int32_t v2 = 0; // 0x806917e
    int32_t v3 = 0;
    int32_t v4 = v1;
    int32_t v5 = *(int32_t *)(v4 + 8); // 0x806912f
    int32_t v6; // 0x80690fc
    int32_t result; // 0x80690fc
    while (v5 != offset) {
        int32_t v7 = v2;
        int32_t v8 = v5 - offset; // 0x8069148
        int32_t v9 = v8 < 0 ? -v8 : v8; // 0x8069155
        bool v10 = v7 == 0 | v7 > v9;
        int32_t v11 = v10 ? v4 : v3;
        int32_t v12 = *(int32_t *)v4;
        v2 = v10 ? v9 : v7;
        v6 = v11;
        result = -1;
        if (v12 == 0) {
            goto lab_0x8069180;
        }
        v3 = v11;
        v4 = v12;
        v5 = *(int32_t *)(v4 + 8);
    }
    // 0x8069137
    v6 = v3;
    result = *(int32_t *)(v4 + 12);
  lab_0x8069180:
    // 0x8069180
    if (v6 == 0 || result >= 0) {
        // 0x8069195
        return result;
    }
    // 0x8069195
    return *(int32_t *)(v6 + 12);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806919a - 0x80691e5
// Line range:    7096 - 7110
int32_t HText_locateAnchor(int32_t * text, int32_t anchor_number) {
    int32_t v1 = (int32_t)text + 2108; // 0x80691ba
    v1 = *(int32_t *)v1;
    int32_t result = -1; // 0x80691de
    while (v1 != 0) {
        // 0x80691bc
        if (*(int32_t *)(v1 + 12) == anchor_number) {
            // 0x80691c7
            result = *(int32_t *)(v1 + 8);
            return result;
        }
        v1 = *(int32_t *)v1;
        result = -1;
    }
  lab_0x80691e0:
    // 0x80691e0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80691e5 - 0x8069237
// Line range:    7117 - 7129
char anchor_is_numbered(int32_t * Anchor_ptr) {
    int32_t v1 = (int32_t)Anchor_ptr;
    unsigned char v2 = *(char *)(v1 + 27);
    if (*(char *)(v1 + 24) != 0) {
        // 0x80691fa
        if (v2 % 2 != 0) {
            // 0x8069231
            return 1;
        }
    }
    // 0x8069214
    if (v2 == 2) {
        // 0x806921f
        return *(int32_t *)(*(int32_t *)(v1 + 28) + 8) != 8;
    }
    // 0x8069231
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8069237 - 0x806929d
// Line range:    7142 - 7159
int32_t HText_getAbsLineNumber(int32_t * text, int32_t anchor_number) {
    // 0x8069237
    if (text == NULL || anchor_number < 0) {
        // 0x8069298
        return -1;
    }
    int32_t v1 = *(int32_t *)((int32_t)text + 2108);
    if (v1 == 0) {
        // 0x8069298
        return -1;
    }
    int32_t * v2 = (int32_t *)v1;
    int32_t result; // 0x8069237
    if (anchor_is_numbered(v2) != 0) {
        // 0x8069274
        if (*(int32_t *)(v1 + 12) == anchor_number) {
            // 0x806927f
            result = *(int32_t *)(v1 + 16);
            return result;
        }
    }
    int32_t v3 = *v2;
    result = -1;
    while (v3 != 0) {
        int32_t v4 = v3;
        v2 = (int32_t *)v4;
        if (anchor_is_numbered(v2) != 0) {
            // 0x8069274
            if (*(int32_t *)(v4 + 12) == anchor_number) {
                // 0x806927f
                result = *(int32_t *)(v4 + 16);
                return result;
            }
        }
        // 0x806928a
        v3 = *v2;
        result = -1;
    }
  lab_0x8069298:
    // 0x8069298
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806929d - 0x806930a
// Line range:    7166 - 7185
int32_t HText_anchorRelativeTo(int32_t * text, int32_t top_lineno, int32_t anchor_number) {
    int32_t v1 = *(int32_t *)((int32_t)text + 2108);
    if (v1 == 0) {
        // 0x8069305
        return 0;
    }
    int32_t v2 = 0;
    int32_t v3 = v1;
    int32_t result = v2; // 0x80692cf
    while (*(int32_t *)(v3 + 12) != anchor_number) {
        int32_t * v4 = (int32_t *)v3;
        int32_t v5 = v2; // 0x80692e6
        if (anchor_is_numbered(v4) != 0) {
            int32_t v6 = *(int32_t *)(v3 + 16); // 0x80692eb
            v5 = v2 + (int32_t)(v6 >= top_lineno);
        }
        int32_t v7 = *v4;
        result = 0;
        if (v7 == 0) {
            // break -> 0x8069305
            break;
        }
        v2 = v5;
        v3 = v7;
        result = v2;
    }
    // 0x8069305
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806930a - 0x80693b0
// Line range:    7194 - 7215
int32_t HText_LinksInLines(int32_t * text, int32_t line_num, int32_t Lines) {
    // 0x806930a
    if (text == NULL) {
        // 0x80693ab
        return 0;
    }
    int32_t v1 = line_num - 1; // 0x806931a
    int32_t v2 = v1 + Lines; // 0x8069326
    int32_t v3 = *(int32_t *)((int32_t)text + 2108);
    int32_t v4 = v3; // 0x8069398
    if (v3 == 0) {
        // 0x80693ab
        return 0;
    }
    int32_t v5 = 0; // 0x8069398
    int32_t v6; // 0x806930a
    int32_t v7; // 0x806930a
    int32_t result; // 0x806930a
    while (true) {
      lab_0x806939a:;
        int32_t v8 = v5;
        v7 = v4;
        int32_t v9 = *(int32_t *)(v7 + 16); // 0x806939d
        result = v8;
        if (v9 > v2) {
            // break -> 0x80693ab
            break;
        }
        // 0x806934e
        v6 = v8;
        if (v9 >= v1 == v9 < v2) {
            // 0x8069364
            v6 = v8;
            if (*(char *)(v7 + 24) == 0) {
                goto lab_0x806938c;
            } else {
                // 0x806936f
                if (*(char *)(v7 + 27) != 2) {
                    // 0x8069388
                    v6 = v8 + 1;
                    goto lab_0x806938c;
                } else {
                    // 0x806937a
                    v6 = v8;
                    if (*(int32_t *)(*(int32_t *)(v7 + 28) + 8) == 8) {
                        goto lab_0x806938c;
                    } else {
                        // 0x8069388
                        v6 = v8 + 1;
                        goto lab_0x806938c;
                    }
                }
            }
        } else {
            goto lab_0x806938c;
        }
    }
    // 0x80693ab
    return result;
  lab_0x806938c:
    // 0x806938c
    v5 = v6;
    v4 = *(int32_t *)v7;
    result = v5;
    if (v4 == 0) {
        return result;
    }
    goto lab_0x806939a;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80693b0 - 0x80693bf
// Line range:    7218 - 7220
void HText_setStale(int32_t * text) {
    // 0x80693b0
    *(char *)((int32_t)text + 2177) = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80693f5 - 0x806941b
// Line range:    7229 - 7231
int32_t HText_sourceAnchors(int32_t * text) {
    int32_t result = -1; // 0x80693ff
    if (text != NULL) {
        // 0x8069401
        result = *(int32_t *)((int32_t)text + 2128);
    }
    // 0x8069416
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806942e - 0x8069475
// Line range:    7242 - 7247
char HText_canScrollDown(void) {
    // 0x806942e
    if (HTMainText != NULL) {
        // 0x8069442
        if (display_lines + g208 <= g202) {
            // 0x806946f
            return 1;
        }
    }
    // 0x806946f
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806952e - 0x8069626
// Line range:    7278 - 7321
char HText_select(int32_t * text) {
    // 0x806952e
    if (HTMainText == text) {
        // 0x806961f
        return 1;
    }
    int32_t v1 = (int32_t)text;
    if (text != NULL) {
        // 0x8069548
        *(char *)(v1 + 2178) = 0;
    }
    // 0x8069552
    ResetPartialLinenos(text);
    ResetPartialLinenos(HTMainText);
    if (HTMainText == NULL) {
        goto lab_0x80695d7;
    } else {
        // 0x8069573
        if (HText_hasUTF8OutputSet(HTMainText) == 0) {
            // 0x80695b7
            *(char *)(v1 + 2180) = 0;
            // 0x80695c1
            g211 = 0;
            *(char *)(v1 + 2179) = 0;
            goto lab_0x80695d7;
        } else {
            // 0x8069584
            if (HTLoadedDocumentEightbit() == 0) {
                // 0x80695b7
                *(char *)(v1 + 2180) = 0;
                // 0x80695c1
                g211 = 0;
                *(char *)(v1 + 2179) = 0;
                goto lab_0x80695d7;
            } else {
                // 0x806958d
                if (*(int32_t *)(32 * current_char_set + (int32_t)&g144) != 7) {
                    // 0x80695b7
                    *(char *)(v1 + 2180) = 0;
                    // 0x80695c1
                    g211 = 0;
                    *(char *)(v1 + 2179) = 0;
                    goto lab_0x80695d7;
                } else {
                    // 0x80695a0
                    *(char *)(v1 + 2180) = g211;
                    // 0x80695c1
                    g211 = 0;
                    *(char *)(v1 + 2179) = 0;
                    goto lab_0x80695d7;
                }
            }
        }
    }
  lab_0x80695d7:
    // 0x80695d7
    *(int32_t *)&HTMainText = v1;
    *(int32_t *)&HTMainAnchor = *text;
    if (loaded_texts == NULL) {
        // 0x806961f
        return 1;
    }
    // 0x80695f2
    if (HTList_removeObject(loaded_texts, (char *)text) != 0) {
        // 0x806960a
        HTList_addObject(loaded_texts, (char *)text);
    }
    // 0x806961f
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8069626 - 0x806972e
// Line range:    7329 - 7366
char HText_POSTReplyLoaded(int32_t * doc) {
    // 0x8069626
    if (doc != NULL != loaded_texts != NULL) {
        // 0x8069728
        return 0;
    }
    int32_t v1 = (int32_t)doc;
    int32_t v2 = *(int32_t *)(v1 + 8); // 0x8069653
    if (v2 == 0) {
        // 0x8069728
        return 0;
    }
    int32_t str = *(int32_t *)(v1 + 4); // 0x8069662
    if (str == 0) {
        // 0x8069728
        return 0;
    }
    int32_t v3 = *(int32_t *)((int32_t)loaded_texts + 4); // 0x80696f7
    if (v3 == 0) {
        // 0x8069728
        return 0;
    }
    int32_t v4 = v3; // 0x80696f7
    int32_t v5 = *(int32_t *)v4; // 0x8069706
    char result = 0; // 0x806971e
    while (v5 != 0) {
        int32_t * v6 = (int32_t *)v5; // 0x8069686
        int32_t v7 = *v6; // 0x8069686
        if (v7 != 0) {
            int32_t v8 = *(int32_t *)(v7 + 20); // 0x8069691
            if (v8 != 0) {
                // 0x8069698
                if (HTSABEql((int32_t *)v2, (int32_t *)v8) != 0) {
                    int32_t str2 = *(int32_t *)(*v6 + 16); // 0x80696b8
                    if (str2 != 0) {
                        // 0x80696bf
                        if (strcmp((char *)str, (char *)str2) == 0) {
                            // 0x80696da
                            result = 1;
                            if (*(char *)(*v6 + 85) == *(char *)(v1 + 20)) {
                                // break -> 0x8069728
                                break;
                            }
                        }
                    }
                }
            }
        }
        // 0x80696f4
        v4 += 4;
        result = 0;
        if (v4 == 0) {
            // break -> 0x8069728
            break;
        }
        v5 = *(int32_t *)v4;
        result = 0;
    }
    // 0x8069728
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806972e - 0x806983d
// Line range:    7369 - 7390
char HTFindPoundSelector(char * selector) {
    // 0x806972e
    if (WWW_TraceFlag != 0) {
        // 0x8069741
        fprintf(TraceFP(), "FindPound: searching for \"%s\"\n", selector);
    }
    // 0x806975f
    if (g203 == NULL) {
        // 0x8069832
        return 0;
    }
    int32_t v1 = (int32_t)g203;
    int32_t v2 = *(int32_t *)(v1 + 48); // 0x8069775
    int32_t str; // 0x8069786
    int32_t v3; // 0x80697b3
    if (v2 != 0) {
        // 0x8069780
        str = *(int32_t *)(v2 + 4);
        if (str != 0) {
            // 0x8069791
            if (strcmp((char *)str, selector) == 0) {
                // 0x80697ad
                v3 = *(int32_t *)(v1 + 16) + 1;
                www_search_result = v3;
                if (WWW_TraceFlag == 0) {
                    goto lab_0x80697f1;
                } else {
                    // 0x80697c6
                    fprintf(TraceFP(), "FindPound: Selecting anchor [%d] at line %d\n", *(int32_t *)(v1 + 12), v3);
                    goto lab_0x80697f1;
                }
            }
        }
    }
    int32_t v4 = *(int32_t *)v1; // 0x806981f
    char result = 0; // 0x8069828
    while (v4 != 0) {
        // 0x8069772
        v1 = v4;
        v2 = *(int32_t *)(v1 + 48);
        if (v2 != 0) {
            // 0x8069780
            str = *(int32_t *)(v2 + 4);
            if (str != 0) {
                // 0x8069791
                if (strcmp((char *)str, selector) == 0) {
                    // 0x80697ad
                    v3 = *(int32_t *)(v1 + 16) + 1;
                    www_search_result = v3;
                    if (WWW_TraceFlag == 0) {
                        goto lab_0x80697f1;
                    } else {
                        // 0x80697c6
                        fprintf(TraceFP(), "FindPound: Selecting anchor [%d] at line %d\n", *(int32_t *)(v1 + 12), v3);
                        goto lab_0x80697f1;
                    }
                }
            }
        }
        // 0x806981c
        v4 = *(int32_t *)v1;
        result = 0;
    }
    // 0x8069832
    return result;
  lab_0x80697f1:;
    int32_t strcmp_rc = strcmp(selector, LYToolbarName); // 0x8069800
    result = 1;
    if (strcmp_rc != 0) {
        return result;
    } else {
        // 0x8069809
        www_search_result--;
        result = 1;
        return result;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806999c - 0x80699ca
// Line range:    7498 - 7502
int32_t HText_getTopOfScreen(void) {
    // 0x806999c
    return HTMainText == NULL ? 0 : g208;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80699d8 - 0x8069a3d
// Line range:    7514 - 7525
int32_t HText_getPreferredTopLine(int32_t * text, int32_t line_number) {
    int32_t v1 = *(int32_t *)((int32_t)text + 2104);
    if (v1 < display_lines) {
        // 0x8069a38
        return 0;
    }
    // 0x8069a15
    if (v1 < line_number) {
        // 0x8069a38
        return v1 + 2 - display_lines;
    }
    // 0x8069a2b
    return line_number >= 0 ? line_number : 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8069a66 - 0x8069b62
// Line range:    7547 - 7577
void HTAddSearchQuery(char * query) {
    char * str2 = NULL; // bp-8, 0x8069a6c
    if (query == NULL || *query == 0) {
        // 0x8069b60
        return;
    }
    // 0x8069a8b
    HTSACopy(&str2, query);
    if (search_queries == NULL) {
        int32_t * v1 = HTList_new(); // 0x8069aa6
        *(int32_t *)&search_queries = (int32_t)v1;
        HTList_addObject(v1, str2);
        // 0x8069b60
        return;
    }
    char * v2 = (char *)search_queries; // 0x8069ad2
    while (v2 != NULL) {
        int32_t v3 = *(int32_t *)((int32_t)v2 + 4); // 0x8069b22
        if (v3 == 0) {
            // break -> 0x8069b4b
            break;
        }
        int32_t v4 = *(int32_t *)v3; // 0x8069b31
        if (v4 == 0) {
            // break -> 0x8069b4b
            break;
        }
        char * str = (char *)v4;
        v2 = (char *)v3;
        if (strcmp(str, str2) == 0) {
            // 0x8069b05
            HTList_removeObject(search_queries, str);
            free((int32_t *)v4);
            goto lab_0x8069b4b;
        }
    }
  lab_0x8069b4b:
    // 0x8069b4b
    HTList_addObject(search_queries, str2);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8069b62 - 0x806a2f6
// Line range:    7580 - 7777
int32_t do_www_search(int32_t * doc) {
    char temp[256]; // bp-532, 0x8069b62
    char v1[256]; // 0x8069bf1
    char v2[256]; // 0x8069c0f
    char v3[256]; // 0x8069e22
    char v4[256]; // 0x8069f78
    char v5[256]; // 0x806a138
    char v6[256]; // 0x8069baa
    char v7[256]; // 0x8069bc4
    int32_t v8 = __readgsdword(20); // 0x8069b75
    char * cp = NULL; // bp-536, 0x8069b80
    int32_t v9 = (int32_t)doc + 4; // 0x8069b97
    int32_t * str = (int32_t *)v9; // 0x8069b97
    char * found_char_pos = strchr((char *)*str, 63); // 0x8069ba5
    v6[0] = (int32_t)found_char_pos;
    temp = v6;
    int32_t v10 = *(int32_t *)&temp; // 0x8069bb0
    int32_t str3; // bp-268, 0x8069b62
    int32_t str2; // bp-524, 0x8069b62
    char v11; // 0x8069b62
    char v12; // 0x8069b62
    if (v10 == 0) {
        // 0x8069c67
        str3 = 0;
        str2 = 0;
        v12 = 0;
        goto lab_0x8069c72;
    } else {
        // 0x8069bbd
        v7[0] = (char)v10 + 1;
        temp = v7;
        LYstrncpy((char *)&str3, (char *)*(int32_t *)&temp, 255);
        v1[0] = &str3;
        temp = v1;
        int32_t v13 = *(int32_t *)&temp; // 0x8069c16
        char v14 = *(char *)v13; // 0x8069c1c
        if (v14 != 0) {
            if (v14 == 43) {
                // branch -> 0x8069c0f
            }
            // 0x8069c0f
            v2[0] = (char)v13 + 1;
            temp = v2;
            int32_t v15 = *(int32_t *)&temp; // 0x8069c16
            char v16 = *(char *)v15; // 0x8069c1c
            while (v16 != 0) {
                // 0x8069bf9
                if (v16 == 43) {
                    // branch -> 0x8069c0f
                }
                // 0x8069c0f
                v2[0] = (char)v15 + 1;
                temp = v2;
                v15 = *(int32_t *)&temp;
                v16 = *(char *)v15;
            }
        }
        // 0x8069c67
        HTUnEscape((char *)&str3);
        strcpy((char *)&str2, (char *)&str3);
        HTAddSearchQuery((char *)&str3);
        v12 = 1;
        if ((char)str3 != 0) {
            // 0x8069cb4
            mustshow = 1;
            statusline(gettext("Edit the current query: "));
            v11 = 1;
            goto lab_0x8069ccf;
        } else {
            goto lab_0x8069c72;
        }
    }
  lab_0x806a05a_3:
    // 0x806a05a
    HTInfoMsg(gettext("Cancelled!!!"));
    int32_t v17 = 3; // 0x806a078
    goto lab_0x806a2d6;
  lab_0x806a006:;
    // 0x806a006
    char v18; // 0x8069b62
    int32_t v19; // 0x8069b62
    int32_t v20; // 0x8069b62
    int32_t v21; // 0x8069b62
    if (v21 == 1 == v18 == 0) {
        goto lab_0x806a01a;
    } else {
        // 0x806a03a
        mustshow = 1;
        statusline(gettext("Edit a previous query: "));
        v19 = v20;
        goto lab_0x8069d55;
    }
  lab_0x8069eb0:;
    // 0x8069eb0
    char v22; // 0x8069b62
    int32_t v23; // 0x8069b62
    if (v21 == 1 == v22 == 0) {
        goto lab_0x8069ec4;
    } else {
        // 0x8069ee4
        mustshow = 1;
        statusline(gettext("Edit a previous query: "));
        v19 = v23;
        goto lab_0x8069d55;
    }
  lab_0x806a01a:
    // 0x806a01a
    mustshow = 1;
    statusline(gettext("Edit the previous query: "));
    v19 = v20;
    goto lab_0x8069d55;
  lab_0x8069ec4:
    // 0x8069ec4
    mustshow = 1;
    statusline(gettext("Edit the previous query: "));
    v19 = v23;
    goto lab_0x8069d55;
  lab_0x8069d55:;
    char v24 = 0; // 0x8069b62
    int32_t v25 = v19; // 0x8069b62
    goto lab_0x8069d55_2;
  lab_0x8069c72:
    // 0x8069c72
    mustshow = 1;
    if (utfxtra_on_this_line == 0) {
        // 0x8069c97
        statusline(gettext("Enter a database query: "));
        v11 = v12;
    } else {
        // 0x8069c7e
        statusline((char *)utfxtra_on_this_line);
        v11 = v12;
    }
    goto lab_0x8069ccf;
  lab_0x8069ccf:;
    char v40 = v11;
    int32_t v41 = 0; // 0x8069cd6
    int32_t v42; // 0x8069b62
    int32_t v43; // 0x8069b62
    if (search_queries == NULL) {
        goto lab_0x8069d15;
    } else {
        int32_t v44 = HTList_count(search_queries); // 0x8069ce0
        v41 = v44;
        v43 = v44;
        v42 = 1;
        if (v40 != 0 == v44 > 1) {
            goto lab_0x8069d3d;
        } else {
            goto lab_0x8069d15;
        }
    }
  lab_0x8069d15:
    // 0x8069d15
    v43 = v41;
    v42 = v40 == 0 == v41 > 0;
    goto lab_0x8069d3d;
  lab_0x8069d3d:;
    int32_t v29 = v42;
    v21 = v43;
    int32_t v32 = v21 - 1;
    v24 = v40;
    v25 = v21;
    while (true) {
      lab_0x8069d55_2:;
        int32_t v26 = v25;
        char v27 = v24;
        uint32_t v28 = LYgetstr((char *)&str3, 0, 256, v29); // 0x8069d78
        char * v30 = (char *)v28; // 0x8069d7d
        if (v28 >= 0) {
            // 0x8069d8c
            if (v30 != (char *)257 == v30 != (char *)256 == ((char)str3 != 0)) {
                // break -> 0x806a07d
                break;
            }
        }
        if (v29 == 0 || v30 != (char *)256) {
            if (v29 == 0 || v30 != (char *)257) {
                goto lab_0x806a05a_3;
            }
            int32_t v31 = (v27 == 0 ? v26 : v21) - 1;
            v20 = v31 >= 0 ? v31 : v32;
            char * v33 = HTList_objectAt(search_queries, v20); // 0x8069f73
            v4[0] = (int32_t)v33;
            temp = v4;
            int32_t v34 = *(int32_t *)&temp; // 0x8069f7e
            if (v34 == 0) {
                goto lab_0x806a05a_3;
            }
            // 0x8069f8b
            LYstrncpy((char *)&str3, (char *)v34, 255);
            v18 = 0;
            if ((char)str2 == 0) {
                goto lab_0x806a006;
            } else {
                // 0x8069fb6
                if (strcmp((char *)&str2, (char *)&str3) != 0) {
                    char v35 = str2; // 0x8069ff9
                    v18 = v35;
                    if (v21 == 2 == (v35 != 0)) {
                        goto lab_0x806a01a;
                    } else {
                        goto lab_0x806a006;
                    }
                } else {
                    // 0x8069fd2
                    mustshow = 1;
                    statusline(gettext("Edit the current query: "));
                    v19 = v20;
                    goto lab_0x8069d55;
                }
            }
        } else {
            int32_t v36 = v27 == 0 ? v26 + 1 : 1;
            v23 = v36 < v21 ? v36 : 0;
            char * v37 = HTList_objectAt(search_queries, v23); // 0x8069e1d
            v3[0] = (int32_t)v37;
            temp = v3;
            int32_t v38 = *(int32_t *)&temp; // 0x8069e28
            if (v38 == 0) {
                goto lab_0x806a05a_3;
            }
            // 0x8069e35
            LYstrncpy((char *)&str3, (char *)v38, 255);
            v22 = 0;
            if ((char)str2 == 0) {
                goto lab_0x8069eb0;
            } else {
                // 0x8069e60
                if (strcmp((char *)&str2, (char *)&str3) != 0) {
                    char v39 = str2; // 0x8069ea3
                    v22 = v39;
                    if (v21 == 2 == (v39 != 0)) {
                        goto lab_0x8069ec4;
                    } else {
                        goto lab_0x8069eb0;
                    }
                } else {
                    // 0x8069e7c
                    mustshow = 1;
                    statusline(gettext("Edit the current query: "));
                    v19 = v23;
                    goto lab_0x8069d55;
                }
            }
        }
    }
    // 0x806a07d
    LYTrimLeading((char *)&str3);
    if ((char)str3 != 0) {
        // 0x806a0b9
        LYTrimTrailing((char *)&str3);
        if (LYforce_no_cache != 0) {
            goto lab_0x806a111;
        } else {
            // 0x806a0d2
            if (strcmp((char *)&str2, (char *)&str3) != 0) {
                goto lab_0x806a111;
            } else {
                // 0x806a0ee
                HTUserMsg(gettext("Use Control-R to resubmit the current query."));
                v17 = 3;
                goto lab_0x806a2d6;
            }
        }
    } else {
        // 0x806a096
        HTInfoMsg(gettext("Cancelled!!!"));
        v17 = 3;
        goto lab_0x806a2d6;
    }
  lab_0x806a111:
    // 0x806a111
    HTAddSearchQuery((char *)&str3);
    char * found_char_pos2 = strchr((char *)*str, 63); // 0x806a133
    v5[0] = (int32_t)found_char_pos2;
    temp = v5;
    int32_t v45 = *(int32_t *)&temp; // 0x806a13e
    if (v45 != 0) {
        // 0x806a147
        *(char *)v45 = 0;
    }
    // 0x806a150
    HTSACopy(&cp, (char *)*str);
    HTSACat(&cp, "?");
    HTSACat(&cp, (char *)&str3);
    user_message(gettext("Getting %s"), cp);
    LYSyslog(cp);
    if (cp != NULL) {
        // 0x806a1cf
        free((int32_t *)cp);
        cp = NULL;
    }
    int32_t v46 = *(int32_t *)&temp; // 0x806a1e7
    if (v46 != 0) {
        // 0x806a1f0
        *(char *)v46 = 63;
    }
    char v47 = HTSearch((char *)&str3, HTMainAnchor); // 0x806a20b
    v17 = 0;
    if (v47 != 0) {
        // 0x806a218
        char * v48; // 0x8069b62
        if (traversal == 0) {
            // 0x806a242
            v48 = HTAnchor_address(HTMainAnchor);
        } else {
            // 0x806a22d
            v48 = stub_HTAnchor_address(HTMainAnchor);
        }
        // 0x806a255
        HTSACopy((char **)v9, v48);
        if (v48 != NULL) {
            // 0x806a279
            free((int32_t *)v48);
        }
        // 0x806a291
        v17 = 1;
        if (WWW_TraceFlag != 0) {
            // 0x806a29c
            fprintf(TraceFP(), "\ndo_www_search: newfile: %s\n", (char *)*str);
            v17 = 1;
        }
    }
    goto lab_0x806a2d6;
  lab_0x806a2d6:;
    int32_t result = v17; // 0x806a2e6
    if (v8 != __readgsdword(20)) {
        // 0x806a2e8
        __stack_chk_fail();
        result = &g391;
    }
    // 0x806a2ed
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806a2f6 - 0x806a338
// Line range:    7780 - 7788
void write_offset(struct _IO_FILE * fp, int32_t * line) {
    int32_t v1 = (int32_t)line;
    if (*(char *)(v1 + 18) == 0) {
        // 0x806a336
        return;
    }
    // 0x806a327
    for (int32_t i = 0; i < (int32_t)*(int16_t *)(v1 + 8); i++) {
        // 0x806a310
        fputc(32, fp);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806a338 - 0x806a3d6
// Line range:    7791 - 7801
void write_hyphen(struct _IO_FILE * fp) {
    // 0x806a338
    if (dump_output_immediately == 0 || LYRawMode == 0 || *(int32_t *)(4 * current_char_set + (int32_t)&LYlowest_eightbit) > 173) {
        // 0x806a3c1
        fputc(45, fp);
        // 0x806a3d4
        return;
    }
    int32_t v1 = 32 * current_char_set; // 0x806a36c
    if (*(int32_t *)(v1 + (int32_t)&g144) == 2) {
        // 0x806a3ac
        fputc(173, fp);
        // 0x806a3d4
        return;
    }
    // 0x806a37a
    if ((char)*(int32_t *)((v1 || 16) + (int32_t)&g145) > -1) {
        // 0x806a3c1
        fputc(45, fp);
        // 0x806a3d4
        return;
    }
    // 0x806a3ac
    fputc(173, fp);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806a3d6 - 0x806a4a3
// Line range:    7810 - 7838
int32_t TrimmedLength(char * string) {
    int32_t len = strlen(string); // 0x806a3e2
    if (HTisDocumentSource() != 0) {
        // 0x806a49e
        return len;
    }
    int32_t v1 = (int32_t)string;
    int32_t v2 = len;
    while (v2 >= 0 == (v2 != 0)) {
        int32_t v3 = v2 - 1; // 0x806a402
        unsigned char v4 = *(char *)(v3 + v1); // 0x806a408
        int16_t v5 = *(int16_t *)(2 * (int32_t)v4 + (int32_t)*__ctype_b_loc()); // 0x806a420
        if (v4 >= 9 && (v5 & 0x2000) == 0) {
            // break -> 0x806a445
            break;
        }
        v2 = v3;
    }
    // 0x806a445
    if (len == v2) {
        // 0x806a49e
        return len;
    }
    int32_t v6 = v2 + v1; // 0x806a450
    int32_t v7 = v6;
    char * v8 = LYSkipBlanks((char *)v6); // 0x806a462
    char v9 = *v8; // 0x806a46d
    *(char *)v7 = v9;
    int32_t v10 = v7 + 1; // 0x806a48a
    int32_t v11 = (int32_t)v8 + 1; // 0x806a48a
    while (v9 != 0) {
        // 0x806a45c
        v7 = v10;
        v8 = LYSkipBlanks((char *)v11);
        v9 = *v8;
        *(char *)v7 = v9;
        v10 = v7 + 1;
        v11 = (int32_t)v8 + 1;
    }
    // 0x806a49e
    return v7 - v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806a4a3 - 0x806a7eb
// Line range:    7850 - 7960
void print_wwwfile_to_fd(struct _IO_FILE * fp, char is_email, char is_reply) {
    // 0x806a4a3
    bool v1; // 0x806a4a3
    if (is_email != 0) {
        goto lab_0x806a510;
    } else {
        // 0x806a4d2
        if (is_reply != 0 || HTMainText == NULL || with_backspaces == 0) {
            goto lab_0x806a510;
        } else {
            // 0x806a4e9
            if (HTCJK != 0) {
                // 0x806a510
                v1 = true;
                goto lab_0x806a524;
            } else {
                // 0x806a4f2
                v1 = false;
                if (g215 != 0) {
                    // 0x806a510
                    v1 = true;
                    goto lab_0x806a524;
                } else {
                    goto lab_0x806a524;
                }
            }
        }
    }
  lab_0x806a510:
    // 0x806a510
    v1 = true;
    if (HTMainText == NULL) {
        // 0x806a7e9
        return;
    }
    goto lab_0x806a524;
  lab_0x806a524:;
    char v2 = 0; // 0x806a52e
    char v3 = 0; // 0x806a52e
    int32_t v4 = (int32_t)HTMainAnchor;
    char * str; // 0x806a5a4
    if (is_reply == 0) {
        if (is_email != 0) {
            // 0x806a566
            if (strncmp((char *)(v4 + 18), "From ", 5) == 0) {
                // 0x806a58c
                fputc(62, fp);
            }
        }
    } else {
        // 0x806a544
        fputc(62, fp);
    }
    int32_t * v5 = (int32_t *)v4; // 0x806a622
    write_offset(fp, v5);
    int32_t v6 = v4 + 18; // 0x806a62a
    int32_t v7 = TrimmedLength((char *)v6); // 0x806a630
    char v8 = v2; // 0x806a7b6
    char v9 = v3; // 0x806a7b6
    char v10; // 0x806a4a3
    char v11; // 0x806a4a3
    char v12; // 0x806a4a3
    char v13; // 0x806a4a3
    int32_t v14; // 0x806a4a3
    unsigned char v15; // 0x806a64a
    int32_t c; // 0x806a64a
    int32_t * v16; // 0x806a652
    int32_t v17; // 0x806a7ac
    if (v7 > 0) {
        v14 = 0;
        v15 = *(char *)(v14 + v6);
        c = v15;
        v16 = (int32_t *)c;
        if (v15 > 2 == v16 < (int32_t *)9) {
            if (v14 + 1 < v7 || v16 != (int32_t *)7) {
                // 0x806a722
                if (dump_output_immediately == 0 || use_underscore == 0) {
                    // 0x806a758
                    v10 = v2;
                    v12 = v3;
                    if (!v1) {
                        // 0x806a75e
                        v10 = v2;
                        v12 = 0;
                        if (v16 != (int32_t *)4) {
                            if (v15 > 4) {
                                // 0x806a778
                                v10 = v2;
                                v12 = v3;
                                switch (v15) {
                                    case 5: {
                                        // 0x806a798
                                        v10 = 1;
                                        v12 = 0;
                                        // break -> 0x806a7ac
                                        break;
                                    }
                                    case 6: {
                                        // 0x806a7a8
                                        v10 = 0;
                                        v12 = v3;
                                        // break -> 0x806a7ac
                                        break;
                                    }
                                }
                            } else {
                                // 0x806a770
                                v10 = v2;
                                v12 = v2 != 0 | v15 != 3 ? v3 : 1;
                            }
                        }
                    }
                } else {
                    // 0x806a738
                    v10 = v2;
                    v12 = v3;
                    if (c < 5) {
                        // 0x806a743
                        fputc(95, fp);
                        v10 = v2;
                        v12 = v3;
                    }
                }
            } else {
                // 0x806a712
                write_hyphen(fp);
                v10 = v2;
                v12 = v3;
            }
        } else {
            if (v2 == 0) {
                if (v3 == 0) {
                    // 0x806a6ea
                    fputc(c, fp);
                    v10 = 0;
                    v12 = 0;
                } else {
                    // 0x806a6ad
                    fputc(95, fp);
                    fputc(8, fp);
                    fputc(c, fp);
                    v10 = 0;
                    v12 = v3;
                }
            } else {
                // 0x806a66b
                fputc(c, fp);
                fputc(8, fp);
                fputc(c, fp);
                v10 = v2;
                v12 = v3;
            }
        }
        // 0x806a7ac
        v17 = v14 + 1;
        v8 = v10;
        v9 = v12;
        while (v17 != v7) {
            // 0x806a644
            v11 = v10;
            v13 = v12;
            v14 = v17;
            v15 = *(char *)(v14 + v6);
            c = v15;
            v16 = (int32_t *)c;
            if (v15 > 2 == v16 < (int32_t *)9) {
                if (v14 + 1 < v7 || v16 != (int32_t *)7) {
                    // 0x806a722
                    if (dump_output_immediately == 0 || use_underscore == 0) {
                        // 0x806a758
                        v10 = v11;
                        v12 = v13;
                        if (!v1) {
                            // 0x806a75e
                            v10 = v11;
                            v12 = 0;
                            if (v16 != (int32_t *)4) {
                                if (v15 > 4) {
                                    // 0x806a778
                                    v10 = v11;
                                    v12 = v13;
                                    switch (v15) {
                                        case 5: {
                                            // 0x806a798
                                            v10 = 1;
                                            v12 = 0;
                                            // break -> 0x806a7ac
                                            break;
                                        }
                                        case 6: {
                                            // 0x806a7a8
                                            v10 = 0;
                                            v12 = v13;
                                            // break -> 0x806a7ac
                                            break;
                                        }
                                    }
                                } else {
                                    // 0x806a770
                                    v10 = v11;
                                    v12 = v11 != 0 | v15 != 3 ? v13 : 1;
                                }
                            }
                        }
                    } else {
                        // 0x806a738
                        v10 = v11;
                        v12 = v13;
                        if (c < 5) {
                            // 0x806a743
                            fputc(95, fp);
                            v10 = v11;
                            v12 = v13;
                        }
                    }
                } else {
                    // 0x806a712
                    write_hyphen(fp);
                    v10 = v11;
                    v12 = v13;
                }
            } else {
                if (v11 == 0) {
                    if (v13 == 0) {
                        // 0x806a6ea
                        fputc(c, fp);
                        v10 = 0;
                        v12 = 0;
                    } else {
                        // 0x806a6ad
                        fputc(95, fp);
                        fputc(8, fp);
                        fputc(c, fp);
                        v10 = 0;
                        v12 = v13;
                    }
                } else {
                    // 0x806a66b
                    fputc(c, fp);
                    fputc(8, fp);
                    fputc(c, fp);
                    v10 = v11;
                    v12 = v13;
                }
            }
            // 0x806a7ac
            v17 = v14 + 1;
            v8 = v10;
            v9 = v12;
        }
    }
    while (v4 != (int32_t)HTMainAnchor) {
        // 0x806a7c9
        v4 = *v5;
        // 0x806a5a1
        str = (char *)(v4 + 18);
        if (*str != 8) {
            // 0x806a5ac
            fputc(10, fp);
            if (is_reply == 0) {
                if (is_email != 0) {
                    // 0x806a5e0
                    if (strncmp(str, "From ", 5) == 0) {
                        // 0x806a602
                        fputc(62, fp);
                    }
                }
            } else {
                // 0x806a5c5
                fputc(62, fp);
            }
        }
        // 0x806a615
        v5 = (int32_t *)v4;
        write_offset(fp, v5);
        v6 = v4 + 18;
        v7 = TrimmedLength((char *)v6);
        char v18 = v9; // 0x806a7b6
        char v19 = v8; // 0x806a7b6
        if (v7 > 0) {
            v11 = v19;
            v13 = v18;
            v14 = 0;
            v15 = *(char *)(v14 + v6);
            c = v15;
            v16 = (int32_t *)c;
            if (v15 > 2 == v16 < (int32_t *)9) {
                if (v14 + 1 < v7 || v16 != (int32_t *)7) {
                    // 0x806a722
                    if (dump_output_immediately == 0 || use_underscore == 0) {
                        // 0x806a758
                        v10 = v11;
                        v12 = v13;
                        if (!v1) {
                            // 0x806a75e
                            v10 = v11;
                            v12 = 0;
                            if (v16 != (int32_t *)4) {
                                if (v15 > 4) {
                                    // 0x806a778
                                    v10 = v11;
                                    v12 = v13;
                                    switch (v15) {
                                        case 5: {
                                            // 0x806a798
                                            v10 = 1;
                                            v12 = 0;
                                            // break -> 0x806a7ac
                                            break;
                                        }
                                        case 6: {
                                            // 0x806a7a8
                                            v10 = 0;
                                            v12 = v13;
                                            // break -> 0x806a7ac
                                            break;
                                        }
                                    }
                                } else {
                                    // 0x806a770
                                    v10 = v11;
                                    v12 = v11 != 0 | v15 != 3 ? v13 : 1;
                                }
                            }
                        }
                    } else {
                        // 0x806a738
                        v10 = v11;
                        v12 = v13;
                        if (c < 5) {
                            // 0x806a743
                            fputc(95, fp);
                            v10 = v11;
                            v12 = v13;
                        }
                    }
                } else {
                    // 0x806a712
                    write_hyphen(fp);
                    v10 = v11;
                    v12 = v13;
                }
            } else {
                if (v11 == 0) {
                    if (v13 == 0) {
                        // 0x806a6ea
                        fputc(c, fp);
                        v10 = 0;
                        v12 = 0;
                    } else {
                        // 0x806a6ad
                        fputc(95, fp);
                        fputc(8, fp);
                        fputc(c, fp);
                        v10 = 0;
                        v12 = v13;
                    }
                } else {
                    // 0x806a66b
                    fputc(c, fp);
                    fputc(8, fp);
                    fputc(c, fp);
                    v10 = v11;
                    v12 = v13;
                }
            }
            // 0x806a7ac
            v17 = v14 + 1;
            v8 = v10;
            v9 = v12;
            while (v17 != v7) {
                // 0x806a644
                v11 = v10;
                v13 = v12;
                v14 = v17;
                v15 = *(char *)(v14 + v6);
                c = v15;
                v16 = (int32_t *)c;
                if (v15 > 2 == v16 < (int32_t *)9) {
                    if (v14 + 1 < v7 || v16 != (int32_t *)7) {
                        // 0x806a722
                        if (dump_output_immediately == 0 || use_underscore == 0) {
                            // 0x806a758
                            v10 = v11;
                            v12 = v13;
                            if (!v1) {
                                // 0x806a75e
                                v10 = v11;
                                v12 = 0;
                                if (v16 != (int32_t *)4) {
                                    if (v15 > 4) {
                                        // 0x806a778
                                        v10 = v11;
                                        v12 = v13;
                                        switch (v15) {
                                            case 5: {
                                                // 0x806a798
                                                v10 = 1;
                                                v12 = 0;
                                                // break -> 0x806a7ac
                                                break;
                                            }
                                            case 6: {
                                                // 0x806a7a8
                                                v10 = 0;
                                                v12 = v13;
                                                // break -> 0x806a7ac
                                                break;
                                            }
                                        }
                                    } else {
                                        // 0x806a770
                                        v10 = v11;
                                        v12 = v11 != 0 | v15 != 3 ? v13 : 1;
                                    }
                                }
                            }
                        } else {
                            // 0x806a738
                            v10 = v11;
                            v12 = v13;
                            if (c < 5) {
                                // 0x806a743
                                fputc(95, fp);
                                v10 = v11;
                                v12 = v13;
                            }
                        }
                    } else {
                        // 0x806a712
                        write_hyphen(fp);
                        v10 = v11;
                        v12 = v13;
                    }
                } else {
                    if (v11 == 0) {
                        if (v13 == 0) {
                            // 0x806a6ea
                            fputc(c, fp);
                            v10 = 0;
                            v12 = 0;
                        } else {
                            // 0x806a6ad
                            fputc(95, fp);
                            fputc(8, fp);
                            fputc(c, fp);
                            v10 = 0;
                            v12 = v13;
                        }
                    } else {
                        // 0x806a66b
                        fputc(c, fp);
                        fputc(8, fp);
                        fputc(c, fp);
                        v10 = v11;
                        v12 = v13;
                    }
                }
                // 0x806a7ac
                v17 = v14 + 1;
                v8 = v10;
                v9 = v12;
            }
        }
    }
    // 0x806a7d6
    fputc(10, fp);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806a7eb - 0x806a95d
// Line range:    7969 - 8021
void print_crawl_to_fd(struct _IO_FILE * fp, char * thelink, char * thetitle) {
    // 0x806a7eb
    if (HTMainText == NULL) {
        // 0x806a95b
        return;
    }
    // 0x806a805
    fprintf(fp, "THE_URL:%s\n", thelink);
    if (thetitle != NULL) {
        // 0x806a832
        fprintf(fp, "THE_TITLE:%s\n", thetitle);
    }
    int32_t v1 = (int32_t)HTMainAnchor; // 0x806a90c
    int32_t v2 = v1 + 18;
    char * v3 = (char *)v2;
    int32_t * v4 = (int32_t *)v1; // 0x806a884
    write_offset(fp, v4);
    int32_t v5 = TrimmedLength(v3); // 0x806a892
    int32_t v6; // 0x806a7eb
    int32_t v7; // 0x806a7eb
    unsigned char c; // 0x806a8a9
    int32_t v8; // 0x806a7eb
    if (v5 > 0) {
        v7 = 0;
        c = *(char *)(v7 + v2);
        if (c < 9) {
            // 0x806a8d4
            v8 = v7 + 1;
            v6 = v8;
            if (v8 >= v5 && c == 7) {
                // 0x806a8e5
                write_hyphen(fp);
                v6 = v8;
            }
        } else {
            // 0x806a8c0
            fputc((int32_t)c, fp);
            v6 = v7 + 1;
        }
        // 0x806a8f0
        while (v6 != v5) {
            // 0x806a8a3
            v7 = v6;
            c = *(char *)(v7 + v2);
            if (c < 9) {
                // 0x806a8d4
                v8 = v7 + 1;
                v6 = v8;
                if (v8 >= v5 && c == 7) {
                    // 0x806a8e5
                    write_hyphen(fp);
                    v6 = v8;
                }
            } else {
                // 0x806a8c0
                fputc((int32_t)c, fp);
                v6 = v7 + 1;
            }
        }
    }
    while (v1 != (int32_t)HTMainAnchor) {
        // 0x806a909
        v1 = *v4;
        v2 = v1 + 18;
        v3 = (char *)v2;
        // 0x806a852
        if (*v3 != 8) {
            // 0x806a85d
            fputc(10, fp);
        }
        // 0x806a870
        v4 = (int32_t *)v1;
        write_offset(fp, v4);
        v5 = TrimmedLength(v3);
        if (v5 > 0) {
            v7 = 0;
            c = *(char *)(v7 + v2);
            if (c < 9) {
                // 0x806a8d4
                v8 = v7 + 1;
                v6 = v8;
                if (v8 >= v5 && c == 7) {
                    // 0x806a8e5
                    write_hyphen(fp);
                    v6 = v8;
                }
            } else {
                // 0x806a8c0
                fputc((int32_t)c, fp);
                v6 = v7 + 1;
            }
            // 0x806a8f0
            while (v6 != v5) {
                // 0x806a8a3
                v7 = v6;
                c = *(char *)(v7 + v2);
                if (c < 9) {
                    // 0x806a8d4
                    v8 = v7 + 1;
                    v6 = v8;
                    if (v8 >= v5 && c == 7) {
                        // 0x806a8e5
                        write_hyphen(fp);
                        v6 = v8;
                    }
                } else {
                    // 0x806a8c0
                    fputc((int32_t)c, fp);
                    v6 = v7 + 1;
                }
            }
        }
    }
    // 0x806a916
    fputc(10, fp);
    if (no_list != 0) {
        // 0x806a95b
        return;
    }
    int32_t v9 = keypad_mode; // 0x806a934
    if (v9 != 1 != v9 != 2) {
        // 0x806a948
        printlist(fp, 0);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806a95d - 0x806abcf
// Line range:    8025 - 8090
void adjust_search_result(int32_t * doc, int32_t tentative_result, int32_t start_line) {
    if (tentative_result < 1) {
        // 0x806abcd
        return;
    }
    int32_t v1 = (int32_t)doc;
    int32_t v2 = g208; // 0x806a987
    int32_t v3 = display_lines;
    int32_t v4 = -1; // 0x806a990
    if (v3 + v2 >= tentative_result && v2 < tentative_result) {
        // 0x806a9d0
        v4 = -1;
        if (nlinks >= 1) {
            int32_t v5 = *(int32_t *)(v1 + 28); // 0x806aa0e
            int32_t v6 = 0; // 0x806aa59
            int32_t v7 = v5 - 1 + *(int32_t *)(68 * v6 + (int32_t)&g346); // 0x806aa27
            int32_t v8 = v7 > tentative_result ? -1 : v6;
            v6++;
            int32_t v9 = v8; // 0x806aa57
            while (v6 < nlinks == v7 < tentative_result) {
                // 0x806aa0b
                v7 = v5 - 1 + *(int32_t *)(68 * v6 + (int32_t)&g346);
                v8 = v7 > tentative_result ? v9 : v6;
                v6++;
                v9 = v8;
            }
            // 0x806aa67
            v4 = v8;
            if (v8 >= 0) {
                int32_t v10 = *(int32_t *)(68 * v8 + (int32_t)&g346); // 0x806aa80
                v4 = v8;
                if (v10 + v5 == tentative_result + 1) {
                    // 0x806aa91
                    www_search_result = v5;
                    *(int32_t *)(v1 + 24) = v8;
                    // 0x806abcd
                    return;
                }
            }
        }
    }
    int32_t v11 = v3 < 4 ? v3 : 4;
    int32_t v12 = v11 - 1;
    int32_t v13; // 0x806a95d
    int32_t v14; // 0x806a95d
    if (g203 == NULL) {
        // 0x806aae4
        v13 = tentative_result - v12;
        goto lab_0x806ab20;
    } else {
        int32_t v15 = (int32_t)g203;
        int32_t v16 = tentative_result - 1; // 0x806aadd
        uint32_t v17 = *(int32_t *)(v15 + 16); // 0x806aad7
        int32_t v18 = -1; // 0x806aae2
        if (v17 <= v16) {
            int32_t v19 = v17 + 1; // 0x806aac0
            int32_t v20 = *(int32_t *)v15;
            v18 = v19;
            while (v20 != 0) {
                int32_t v21 = *(int32_t *)(v20 + 16); // 0x806aad7
                v18 = v19;
                if (v21 > v16) {
                    // break -> 0x806aae4
                    break;
                }
                v19 = v21 + 1;
                v20 = *(int32_t *)v20;
                v18 = v19;
            }
        }
        int32_t v22 = v18;
        int32_t v23 = tentative_result - v12; // 0x806aaf2
        v13 = v23;
        if (v22 < 0 || v23 > v22 || v2 < tentative_result == v22 <= start_line) {
            goto lab_0x806ab20;
        } else {
            // 0x806ab13
            www_search_result = v22;
            v14 = v22;
            goto lab_0x806abaf;
        }
    }
  lab_0x806ab20:
    // 0x806ab20
    if (tentative_result - start_line < 1) {
        goto lab_0x806ab4a;
    } else {
        if (-1 - start_line + tentative_result > v12) {
            goto lab_0x806ab4a;
        } else {
            int32_t v24 = start_line + 1; // 0x806ab40
            www_search_result = v24;
            v14 = v24;
            goto lab_0x806abaf;
        }
    }
  lab_0x806ab4a:
    if (tentative_result > start_line || v2 >= tentative_result || v11 + v2 < tentative_result) {
        if (v11 < tentative_result) {
            // 0x806ab9e
            www_search_result = v13;
            v14 = v13;
        } else {
            // 0x806ab92
            www_search_result = 1;
            v14 = 1;
        }
    } else {
        int32_t v25 = v2 + 1; // 0x806ab80
        www_search_result = v25;
        v14 = v25;
    }
    goto lab_0x806abaf;
  lab_0x806abaf:
    // 0x806abaf
    if (!((v4 < 0 | *(int32_t *)(v1 + 28) != v14))) {
        // 0x806abc4
        *(int32_t *)(v1 + 24) = v4;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806abcf - 0x806af78
// Line range:    8093 - 8180
char anchor_has_target(int32_t * a, char * target) {
    int32_t * option = NULL; // bp-12, 0x806abd5
    char * v1 = LYGetHiTextStr(a, 0); // 0x806abf0
    int32_t v2 = 0; // 0x806abfc
    if (v1 != NULL) {
        char * v3; // 0x806abcf
        if (case_sensitive == 0) {
            // 0x806ac23
            v3 = LYno_attr_char_case_strstr(v1, target);
        } else {
            // 0x806ac09
            v3 = LYno_attr_char_strstr(v1, target);
        }
        while (v3 == NULL) {
            // 0x806ac4a
            v2++;
            char * v4 = LYGetHiTextStr(a, v2); // 0x806abf0
            if (v4 == NULL) {
                goto lab_0x806ac50;
            }
            char * v5 = v4;
            if (case_sensitive == 0) {
                // 0x806ac23
                v3 = LYno_attr_char_case_strstr(v5, target);
            } else {
                // 0x806ac09
                v3 = LYno_attr_char_strstr(v5, target);
            }
        }
        // 0x806af72
        return 1;
    }
  lab_0x806ac50:;
    int32_t * v6 = (int32_t *)((int32_t)a + 28); // 0x806ac53
    int32_t v7 = *v6; // 0x806ac53
    if (v7 == 0) {
        // 0x806af72
        return 0;
    }
    int32_t v8 = *(int32_t *)(v7 + 12); // 0x806ac64
    if (v8 == 0) {
        // 0x806af72
        return 0;
    }
    int32_t v9 = *(int32_t *)(v7 + 8); // 0x806ac75
    if (v9 == 8) {
        // 0x806af72
        return 0;
    }
    if (v9 == 2) {
        char * v10 = (char *)v8;
        char * v11; // 0x806abcf
        if (case_sensitive == 0) {
            // 0x806acbe
            v11 = LYno_attr_char_case_strstr(v10, target);
        } else {
            // 0x806ac9e
            v11 = LYno_attr_char_strstr(v10, target);
        }
        // 0x806acdc
        if (v11 != NULL) {
            // 0x806af72
            return 1;
        }
        // 0x806aceb
        HTSACopy((char **)&option, (char *)*(int32_t *)(*v6 + 12));
        char * v12 = (char *)option; // 0x806ad1d
        int32_t v13 = (int32_t)option; // 0x806ad1d
        int32_t * v14 = option; // 0x806ad1d
        if (*(char *)option != 0) {
            *v12 = 42;
            int32_t v15 = v13 + 1; // 0x806ad11
            char * v16 = (char *)v15; // 0x806ad18
            v13 = v15;
            while (*v16 != 0) {
                // 0x806ad0b
                *v16 = 42;
                v15 = v13 + 1;
                v16 = (char *)v15;
                v13 = v15;
            }
            // 0x806ad15
            v14 = option;
        }
        // 0x806ad1f
        char * v17; // 0x806abcf
        if (case_sensitive == 0) {
            // 0x806ad44
            v17 = LYno_attr_char_case_strstr((char *)v14, target);
        } else {
            // 0x806ad2a
            v17 = LYno_attr_char_strstr((char *)v14, target);
        }
        int32_t * v18 = option;
        if (v17 == NULL) {
            if (v18 != NULL) {
                // 0x806ad8f
                free(v18);
                option = NULL;
            }
            // 0x806af72
            return 0;
        }
        // 0x806ad62
        if (v18 != NULL) {
            // 0x806ad69
            free(v18);
            option = NULL;
        }
        // 0x806af72
        return 1;
    }
    if (v9 == 7) {
        int32_t v19 = *(int32_t *)(v7 + 44);
        if (v19 == 0) {
            // 0x806af72
            return 0;
        }
        int32_t v20 = v19; // 0x806ae1f
        char * v21 = (char *)*(int32_t *)v20;
        char * v22; // 0x806abcf
        if (case_sensitive == 0) {
            // 0x806ade9
            v22 = LYno_attr_char_case_strstr(v21, target);
        } else {
            // 0x806adcd
            v22 = LYno_attr_char_strstr(v21, target);
        }
        while (v22 == NULL) {
            // 0x806ae1b
            v20 += 12;
            if (v20 == 0) {
                // 0x806af72
                return 0;
            }
            v21 = (char *)*(int32_t *)v20;
            if (case_sensitive == 0) {
                // 0x806ade9
                v22 = LYno_attr_char_case_strstr(v21, target);
            } else {
                // 0x806adcd
                v22 = LYno_attr_char_strstr(v21, target);
            }
        }
        // 0x806af72
        return 1;
    }
    if (v9 == 4) {
        char * v23 = *(int32_t *)(v7 + 32) == 0 ? unchecked_radio : checked_radio;
        char * v24; // 0x806abcf
        if (case_sensitive == 0) {
            // 0x806ae78
            v24 = LYno_attr_char_case_strstr(v23, target);
        } else {
            // 0x806ae5e
            v24 = LYno_attr_char_strstr(v23, target);
        }
        // 0x806ae90
        if (v24 == NULL) {
            // 0x806af72
            return 0;
        }
        // 0x806af72
        return 1;
    }
    if (v9 != 3) {
        char * v25 = (char *)v8;
        char * v26; // 0x806abcf
        if (case_sensitive == 0) {
            // 0x806af44
            v26 = LYno_attr_char_case_strstr(v25, target);
        } else {
            // 0x806af24
            v26 = LYno_attr_char_strstr(v25, target);
        }
        // 0x806af62
        if (v26 == NULL) {
            // 0x806af72
            return 0;
        }
    } else {
        char * v27 = *(int32_t *)(v7 + 32) == 0 ? unchecked_box : checked_box;
        char * v28; // 0x806abcf
        if (case_sensitive == 0) {
            // 0x806aef5
            v28 = LYno_attr_char_case_strstr(v27, target);
        } else {
            // 0x806aedb
            v28 = LYno_attr_char_strstr(v27, target);
        }
        // 0x806af0d
        if (v28 == NULL) {
            // 0x806af72
            return 0;
        }
    }
    // 0x806af72
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806af78 - 0x806afbe
// Line range:    8183 - 8195
int32_t * line_num_to_anchor(uint32_t line_num) {
    // 0x806af78
    if (HTMainText == NULL) {
        // 0x806afb9
        return (int32_t *)NULL;
    }
    // 0x806af87
    if (g203 == NULL) {
        // 0x806afb9
        return (int32_t *)g203;
    }
    char * v1 = g203; // 0x806afa3
    char * v2 = v1; // 0x806afae
    while (*(int32_t *)((int32_t)v1 + 16) < line_num) {
        int32_t v3 = *(int32_t *)v1; // 0x806af9a
        v1 = (char *)v3;
        v2 = NULL;
        if (v3 == 0) {
            // break -> 0x806afb9
            break;
        }
        v2 = v1;
    }
    // 0x806afb9
    return (int32_t *)v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806afbe - 0x806aff1
// Line range:    8198 - 8207
int32_t line_num_in_text(int32_t * text, int32_t * line) {
    int32_t v1 = *(int32_t *)((int32_t)text + 4); // 0x806afd6
    int32_t result = 1;
    v1 = *(int32_t *)v1;
    int32_t v2 = result + 1; // 0x806afea
    while (v1 != (int32_t)line) {
        // 0x806afe4
        result = v2;
        v1 = *(int32_t *)v1;
        v2 = result + 1;
    }
    // 0x806afec
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806aff1 - 0x806b03c
// Line range:    8213 - 8225
int32_t * get_prev_anchor(int32_t * a) {
    int32_t * v1 = (int32_t *)((int32_t)a + 4); // 0x806affa
    int32_t v2 = *v1; // 0x806affa
    if (v2 != 0 || g203 == NULL) {
        // 0x806b034
        return (int32_t *)v2;
    }
    int32_t v3 = *(int32_t *)g203; // 0x806b029
    if (v3 == 0) {
        // 0x806b034
        return (int32_t *)v2;
    }
    *(int32_t *)(v3 + 4) = (int32_t)g203;
    int32_t v4 = *(int32_t *)v3; // 0x806b029
    char * v5 = (char *)v3; // 0x806b032
    while (v4 != 0) {
        int32_t v6 = v4;
        *(int32_t *)(v6 + 4) = (int32_t)v5;
        v4 = *(int32_t *)v6;
        v5 = (char *)v6;
    }
    // 0x806b034
    return (int32_t *)*v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b03c - 0x806b1bf
// Line range:    8232 - 8267
int32_t www_search_forward(int32_t start_line, int32_t * doc, char * target, int32_t * line, int32_t count) {
    int32_t v1 = (int32_t)line_num_to_anchor(count - 1); // 0x806b061
    int32_t v2 = count; // 0x806b061
    int32_t v3 = 0; // 0x806b061
    int32_t v4 = (int32_t)line; // 0x806b061
    int32_t result; // 0x806b03c
    int32_t v5; // 0x806b03c
    while (true) {
      lab_0x806b0ca:
        // 0x806b0ca
        v5 = v1;
        int32_t v6 = v2; // 0x806b191
        int32_t v7 = v3; // 0x806b03c
        int32_t v8 = v4; // 0x806b18c
        while (true) {
            // 0x806b0ca
            v4 = v8;
            v3 = v7;
            v2 = v6;
            if (v5 != 0) {
                // 0x806b0d0
                if (*(int32_t *)(v5 + 16) == v2 - 1) {
                    // break -> 0x806b063
                    break;
                }
            }
            char * v9 = (char *)(v4 + 18);
            char * v10; // 0x806b03c
            if (case_sensitive == 0) {
                // 0x806b108
                v10 = LYno_attr_char_case_strstr(v9, target);
            } else {
                // 0x806b0eb
                v10 = LYno_attr_char_strstr(v9, target);
            }
            // 0x806b123
            if (v10 != NULL) {
                // break (via goto) -> 0x806b129
                goto lab_0x806b129;
            }
            if (v3 < 2 != (v2 != start_line || v3 == 0)) {
                // 0x806b14b
                HTUserMsg2(gettext("'%s' not found!"), target);
                result = -1;
                return result;
            }
            // 0x806b171
            v8 = *(int32_t *)v4;
            v6 = v4 != (int32_t)HTMainAnchor ? v2 + 1 : 1;
            v7 = v3 + (int32_t)(v4 == (int32_t)HTMainAnchor);
        }
        // 0x806b063
        if (*(char *)(v5 + 24) == 0) {
            goto lab_0x806b0c2;
        } else {
            // 0x806b06e
            if (*(char *)(v5 + 27) != 2) {
                goto lab_0x806b087;
            } else {
                // 0x806b079
                if (*(int32_t *)(*(int32_t *)(v5 + 28) + 8) == 8) {
                    goto lab_0x806b0c2;
                } else {
                    goto lab_0x806b087;
                }
            }
        }
    }
  lab_0x806b129:
    // 0x806b129
    result = 0;
    if (v2 >= 0 == (v2 != 0)) {
        // 0x806b19a
        adjust_search_result(doc, v2, start_line);
        result = 0;
    }
  lab_0x806b1ba:
    // 0x806b1ba
    return result;
  lab_0x806b0c2:
    // 0x806b0c2
    v1 = *(int32_t *)v5;
    goto lab_0x806b0ca;
  lab_0x806b087:
    // 0x806b087
    if (anchor_has_target((int32_t *)v5, target) != 0) {
        // 0x806b09d
        adjust_search_result(doc, v2, start_line);
        result = 1;
        goto lab_0x806b1ba;
    }
    goto lab_0x806b0c2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b1bf - 0x806b36f
// Line range:    8274 - 8309
int32_t www_search_backward(int32_t start_line, int32_t * doc, char * target, int32_t * line, int32_t count) {
    int32_t * v1 = line_num_to_anchor(count - 1); // 0x806b1e4
    int32_t v2 = count; // 0x806b1e4
    int32_t v3 = 0; // 0x806b1e4
    int32_t v4 = (int32_t)line; // 0x806b1e4
    int32_t result; // 0x806b1bf
    int32_t * v5; // 0x806b1bf
    while (true) {
      lab_0x806b253:
        // 0x806b253
        v5 = v1;
        int32_t v6 = (int32_t)v5;
        int32_t v7 = v2; // 0x806b1bf
        int32_t v8 = v3;
        int32_t v9 = v4; // 0x806b33b
        while (true) {
            // 0x806b253
            v4 = v9;
            v3 = v8;
            v2 = v7;
            if (v5 != NULL) {
                // 0x806b259
                if (*(int32_t *)(v6 + 16) == v2 - 1) {
                    // break -> 0x806b1e6
                    break;
                }
            }
            char * v10 = (char *)(v4 + 18);
            char * v11; // 0x806b1bf
            if (case_sensitive == 0) {
                // 0x806b295
                v11 = LYno_attr_char_case_strstr(v10, target);
            } else {
                // 0x806b278
                v11 = LYno_attr_char_strstr(v10, target);
            }
            // 0x806b2b0
            if (v11 != NULL) {
                // break (via goto) -> 0x806b2b6
                goto lab_0x806b2b6;
            }
            if (v3 < 2 != (v2 != start_line || v3 == 0)) {
                // 0x806b2df
                HTUserMsg2(gettext("'%s' not found!"), target);
                result = -1;
                return result;
            }
            int32_t v12 = v2; // 0x806b312
            int32_t v13 = v3; // 0x806b312
            if (v4 == (int32_t)HTMainAnchor) {
                // 0x806b314
                v12 = line_num_in_text(HTMainText, HTMainAnchor) + 1;
                v13 = v3 + 1;
            }
            // 0x806b338
            v8 = v13;
            v9 = *(int32_t *)(v4 + 4);
            v7 = v12 - 1;
        }
        // 0x806b1e6
        if (*(char *)(v6 + 24) == 0) {
            goto lab_0x806b245;
        } else {
            // 0x806b1f1
            if (*(char *)(v6 + 27) != 2) {
                goto lab_0x806b20a;
            } else {
                // 0x806b1fc
                if (*(int32_t *)(*(int32_t *)(v6 + 28) + 8) == 8) {
                    goto lab_0x806b245;
                } else {
                    goto lab_0x806b20a;
                }
            }
        }
    }
  lab_0x806b2b6:
    // 0x806b2b6
    result = 0;
    if (v2 >= 0 == (v2 != 0)) {
        // 0x806b34a
        adjust_search_result(doc, v2, start_line);
        result = 0;
    }
  lab_0x806b36a:
    // 0x806b36a
    return result;
  lab_0x806b245:
    // 0x806b245
    v1 = get_prev_anchor(v5);
    goto lab_0x806b253;
  lab_0x806b20a:
    // 0x806b20a
    if (anchor_has_target(v5, target) != 0) {
        // 0x806b220
        adjust_search_result(doc, v2, start_line);
        result = 1;
        goto lab_0x806b36a;
    }
    goto lab_0x806b245;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b36f - 0x806b45e
// Line range:    8315 - 8346
void www_user_search(int32_t start_line, int32_t * doc, char * target, int32_t direction) {
    // 0x806b36f
    if (HTMainText == NULL) {
        // 0x806b45c
        return;
    }
    int32_t v1 = (int32_t)HTMainAnchor;
    int32_t v2 = direction + start_line; // 0x806b395
    int32_t * v3; // 0x806b36f
    int32_t v4; // 0x806b36f
    if (v2 < 1) {
        // 0x806b3e3
        v3 = (int32_t *)line_num_in_text(HTMainText, HTMainAnchor);
        v4 = v1;
    } else {
        int32_t v5 = 1; // 0x806b3df
        int32_t v6 = v1; // 0x806b3df
        v3 = (int32_t *)1;
        v4 = v1;
        if (v2 != 1) {
            v3 = (int32_t *)1;
            v4 = v1;
            while (v6 != v1) {
                int32_t v7 = *(int32_t *)v6; // 0x806b3ca
                int32_t v8 = v5 + 1; // 0x806b3cf
                v5 = v8;
                v6 = v7;
                if (v2 <= v8) {
                    // 0x806b3d3
                    v3 = (int32_t *)v8;
                    v4 = v7;
                    goto lab_0x806b406;
                }
                v3 = (int32_t *)1;
                v4 = v1;
            }
        }
    }
    goto lab_0x806b406;
  lab_0x806b406:;
    int32_t v9 = (int32_t)v3;
    int32_t * v10 = (int32_t *)v4;
    if (direction < 0) {
        // 0x806b435
        www_search_backward(start_line, doc, target, v10, v9);
    } else {
        // 0x806b40c
        www_search_forward(start_line, doc, target, v10, v9);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b45e - 0x806b4ce
// Line range:    8350 - 8360
void user_message(char * message, char * argument) {
    if (message == NULL) {
        // 0x806b46a
        mustshow = 0;
        // 0x806b4cc
        return;
    }
    char * v1 = NULL; // bp-8, 0x806b473
    HTSprintf0(&v1, message);
    statusline(v1);
    if (v1 != NULL) {
        // 0x806b4ba
        free((int32_t *)v1);
        v1 = NULL;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b4ce - 0x806b4fd
// Line range:    8367 - 8370
char * HText_getOwner(void) {
    char * result = NULL; // 0x806b4db
    if (HTMainText != NULL) {
        // 0x806b4dd
        result = HTAnchor_owner(HTMainText);
    }
    // 0x806b4f8
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b4fd - 0x806b524
// Line range:    8377 - 8382
void HText_setMainTextOwner(char * owner) {
    // 0x806b4fd
    if (HTMainText != NULL) {
        // 0x806b50c
        HTAnchor_setOwner(HTMainText, owner);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b524 - 0x806b553
// Line range:    8390 - 8393
char * HText_getRevTitle(void) {
    char * result = NULL; // 0x806b531
    if (HTMainText != NULL) {
        // 0x806b533
        result = HTAnchor_RevTitle(HTMainText);
    }
    // 0x806b54e
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b553 - 0x806b582
// Line range:    8400 - 8403
char * HText_getContentBase(void) {
    char * result = NULL; // 0x806b560
    if (HTMainText != NULL) {
        // 0x806b562
        result = HTAnchor_content_base(HTMainText);
    }
    // 0x806b57d
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b582 - 0x806b5b1
// Line range:    8410 - 8413
char * HText_getContentLocation(void) {
    char * result = NULL; // 0x806b58f
    if (HTMainText != NULL) {
        // 0x806b591
        result = HTAnchor_content_location(HTMainText);
    }
    // 0x806b5ac
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b5b1 - 0x806b5e0
// Line range:    8420 - 8423
char * HText_getMessageID(void) {
    char * result = NULL; // 0x806b5be
    if (HTMainText != NULL) {
        // 0x806b5c0
        result = HTAnchor_messageID(HTMainText);
    }
    // 0x806b5db
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b5e0 - 0x806b70c
// Line range:    8426 - 8452
void HTuncache_current_document(void) {
    // 0x806b5e0
    if (HTMainText == NULL) {
        // 0x806b6e8
        if (WWW_TraceFlag != 0) {
            // 0x806b6f3
            fprintf(TraceFP(), "HTuncache.. HTMainText already is NULL!\n");
        }
        // 0x806b70a
        return;
    }
    int32_t * v1 = HTOutputFormat; // 0x806b603
    if (v1 != NULL != (v1 == WWW_SOURCE)) {
        // 0x806b61b
        if (g200 != 0) {
            // 0x806b628
            free((int32_t *)g200);
            g200 = 0;
        }
    }
    // 0x806b646
    if (WWW_TraceFlag != 0) {
        int32_t v2 = *(int32_t *)&LYShowScrollbar; // 0x806b65a
        char * v3 = v2 == 0 ? (char *)&g12 : " with POST data";
        int32_t v4 = LYCacheSourceForAborted; // 0x806b67a
        char * v5 = v4 == 0 ? "unknown anchor" : (char *)v4;
        fprintf(TraceFP(), "\nHTuncache.. freeing document for '%s'%s\n", v5, v3);
    }
    // 0x806b6b8
    HTList_removeObject(loaded_texts, (char *)HTMainText);
    HText_free(HTMainText);
    *(int32_t *)&HTMainText = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b70c - 0x806b775
// Line range:    8460 - 8469
char useSourceCache(void) {
    // 0x806b70c
    if (LYCacheSource != 1) {
        // 0x806b76f
        return 0;
    }
    // 0x806b720
    if (WWW_TraceFlag != 0) {
        char * v1 = g193 == NULL ? " not" : (char *)&g12;
        fprintf(TraceFP(), "SourceCache: file-cache%s found\n", v1);
    }
    // 0x806b76f
    return g193 != NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b775 - 0x806b7de
// Line range:    8472 - 8481
char useMemoryCache(void) {
    // 0x806b775
    if (LYCacheSource != 2) {
        // 0x806b7d8
        return 0;
    }
    // 0x806b789
    if (WWW_TraceFlag != 0) {
        char * v1 = stylechanges_buffers == 0 ? " not" : (char *)&g12;
        fprintf(TraceFP(), "SourceCache: memory-cache%s found\n", v1);
    }
    // 0x806b7d8
    return stylechanges_buffers != 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806b7de - 0x806bc9e
// Line range:    8484 - 8606
char HTreparse_document(void) {
    // 0x806b7de
    if (HTMainAnchor != NULL) {
        // 0x806b7f2
        if (LYCacheSource != 0) {
            // 0x806b826
            if (useSourceCache() == 0) {
                // 0x806bafc
                if (useMemoryCache() == 0) {
                    // 0x806bc94
                    return 0;
                }
                int32_t * v1 = HTAtom_for("text/html"); // 0x806bb10
                if (WWW_TraceFlag != 0) {
                    // 0x806bb23
                    fprintf(TraceFP(), "SourceCache: Reparsing from memory chunk %p\n", (int32_t *)stylechanges_buffers);
                }
                int32_t * v2 = HTOutputFormat; // 0x806bb46
                if (v2 != NULL != (v2 == WWW_SOURCE)) {
                    // 0x806bb5e
                    if (g201 != 0) {
                        // 0x806bb6d
                        free((int32_t *)g201);
                        g201 = 0;
                    }
                }
                // 0x806bb8f
                int32_t * v3; // 0x806b7de
                if (g195 == 0) {
                    // 0x806bbb0
                    v3 = HTCharsetFormat(v1, HTMainAnchor, UCLYhndl_for_unspec);
                } else {
                    // 0x806bb9b
                    v3 = HTAtom_for((char *)g195);
                }
                // 0x806bbd1
                if (HText_HaveUserChangedForms(HTMainText) != 0) {
                    // 0x806bbe2
                    HTAlert(gettext("Reloading document.  Any form entries will be lost!"));
                }
                // 0x806bbf6
                HTAnchor_setProtocol(HTMainAnchor, (char *)&scm);
                int32_t v4 = HTParseMem(v3, HTOutputFormat, HTMainAnchor, (int32_t *)stylechanges_buffers, NULL); // 0x806bc39
                if (WWW_TraceFlag != 0) {
                    // 0x806bc59
                    fprintf(TraceFP(), "Reparse memory %s\n", v4 != 200 ? "failed" : "succeeded");
                }
                // 0x806bc94
                return v4 == 200;
            }
            // 0x806b833
            if (WWW_TraceFlag != 0) {
                // 0x806b83e
                fprintf(TraceFP(), "SourceCache: Reparsing file %s\n", g193);
            }
            int32_t * v5 = HTOutputFormat; // 0x806b861
            if (v5 != NULL != (v5 == WWW_SOURCE)) {
                // 0x806b879
                if (g201 != 0) {
                    // 0x806b888
                    free((int32_t *)g201);
                    g201 = 0;
                }
            }
            // 0x806b8aa
            int32_t * v6; // 0x806b7de
            if (g195 == 0) {
                int32_t * v7 = HTFileFormat((char *)g193, NULL, NULL); // 0x806b8e6
                v6 = HTCharsetFormat(v7, HTMainAnchor, UCLYhndl_for_unspec);
            } else {
                // 0x806b8b6
                v6 = HTAtom_for((char *)g195);
            }
            // 0x806b90f
            if (WWW_TraceFlag != 0) {
                int32_t v8 = *(int32_t *)((int32_t)v6 + 4); // 0x806b91d
                fprintf(TraceFP(), "  Content type is \"%s\"\n", (char *)v8);
            }
            struct _IO_FILE * v9 = fopen64((char *)g193, "r"); // 0x806b94e
            if (v9 == NULL) {
                // 0x806b95c
                if (WWW_TraceFlag != 0) {
                    // 0x806b967
                    fprintf(TraceFP(), "  Cannot read file %s\n", g193);
                }
                // 0x806b98a
                LYRemoveTemp((char *)g193);
                if (g193 != NULL) {
                    // 0x806b9a6
                    free(&g193->e0);
                    g193 = NULL;
                }
                // 0x806bc94
                return 0;
            }
            // 0x806b9cb
            if (HText_HaveUserChangedForms(HTMainText) != 0) {
                // 0x806b9dc
                HTAlert(gettext("Reloading document.  Any form entries will be lost!"));
            }
            // 0x806b9f0
            HTAnchor_setProtocol(HTMainAnchor, (char *)&HTFile);
            int32_t v10 = HTParseFile(v6, HTOutputFormat, HTMainAnchor, v9, NULL); // 0x806ba2e
            LYCloseInput(v9);
            if (v10 == 206) {
                // 0x806ba4a
                HTInfoMsg(gettext("Loading incomplete."));
                if (WWW_TraceFlag == 0) {
                    // 0x806bc94
                    return 1;
                }
                char * v11 = HTLoadedDocumentURL(); // 0x806ba69
                fprintf(TraceFP(), "SourceCache: `%s' has been accessed, partial content.\n", v11);
            }
            bool result = v10 == 200 | v10 == 206;
            if (WWW_TraceFlag != 0) {
                // 0x806bac3
                fprintf(TraceFP(), "Reparse file %s\n", !result ? "failed" : "succeeded");
            }
            // 0x806bc94
            return result;
        }
    }
    // 0x806b7fb
    if (WWW_TraceFlag != 0) {
        // 0x806b806
        fprintf(TraceFP(), "HTreparse_document returns FALSE\n");
    }
    // 0x806bc94
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806bc9e - 0x806bd20
// Line range:    8609 - 8622
char HTcan_reparse_document(void) {
    char result = 0; // 0x806bcb0
    if (HTMainAnchor != NULL) {
        // 0x806bcb2
        result = 0;
        if (LYCacheSource != 0) {
            // 0x806bcc1
            if (useSourceCache() == 0) {
                // 0x806bcdf
                result = useMemoryCache() != 0;
            } else {
                // 0x806bcca
                result = LYCanReadFile((char *)g193);
            }
        }
    }
    // 0x806bcec
    if (WWW_TraceFlag != 0) {
        // 0x806bcf7
        fprintf(TraceFP(), "HTcan_reparse_document -> %d\n", (int32_t)result);
    }
    // 0x806bd16
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806bd20 - 0x806bd69
// Line range:    8627 - 8632
void trace_setting_change(char * name, int32_t prev_setting, int32_t new_setting) {
    // 0x806bd20
    if (prev_setting != new_setting && WWW_TraceFlag != 0) {
        // 0x806bd39
        fprintf(TraceFP(), "HTdocument_settings_changed: %s setting has changed (was %d, now %d)\n", name, prev_setting, new_setting);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806bd69 - 0x806c12b
// Line range:    8635 - 8687
char HTdocument_settings_changed(void) {
    // 0x806bd69
    if (HTMainText == NULL || HTcan_reparse_document() == 0) {
        // 0x806c120
        return 0;
    }
    // 0x806bd8c
    int32_t v1; // 0x806bd69
    if (WWW_TraceFlag == 0) {
        goto lab_0x806bfe7;
    } else {
        // 0x806bd9b
        trace_setting_change("CLICKABLE_IMAGES", (int32_t)g217, (int32_t)clickable_images);
        trace_setting_change("PSEUDO_INLINE_ALTS", (int32_t)g218, (int32_t)pseudo_inline_alts);
        trace_setting_change("VERBOSE_IMG", (int32_t)g219, (int32_t)verbose_img);
        trace_setting_change("RAW_MODE", (int32_t)g220, (int32_t)LYUseDefaultRawMode);
        trace_setting_change("HISTORICAL_COMMENTS", (int32_t)g221, (int32_t)historical_comments);
        trace_setting_change("MINIMAL_COMMENTS", (int32_t)g222, (int32_t)minimal_comments);
        trace_setting_change("SOFT_DQUOTES", (int32_t)g223, (int32_t)soft_dquotes);
        trace_setting_change("OLD_DTD", (int32_t)g224, Old_DTD);
        trace_setting_change("KEYPAD_MODE", (int32_t)g225, keypad_mode);
        v1 = g226;
        if (LYlines != v1) {
            goto lab_0x806bf6e;
        } else {
            // 0x806bf3c
            if ((LYwideLines != 0 ? 1014 : LYcols) == (int32_t)g227) {
                goto lab_0x806bfe7;
            } else {
                goto lab_0x806bf6e;
            }
        }
    }
  lab_0x806bfe7:
    // 0x806bfe7
    if (g217 != clickable_images || g218 != pseudo_inline_alts || g219 != verbose_img || g220 != LYUseDefaultRawMode || g221 != historical_comments || historical_comments == 0 == (g222 != minimal_comments) || g223 != soft_dquotes || Old_DTD != (int32_t)g224 || keypad_mode != (int32_t)g225) {
        // 0x806c120
        return 1;
    }
    // 0x806c0d7
    return (LYwideLines != 0 ? 1014 : LYcols) != (int32_t)g227;
  lab_0x806bf6e:
    // 0x806bf6e
    if (WWW_TraceFlag != 0) {
        int32_t v2 = LYwideLines != 0 ? 1014 : LYcols;
        fprintf(TraceFP(), "HTdocument_settings_changed: Screen size has changed (was %dx%d, now %dx%d)\n", (int32_t)g227, v1, v2, LYlines);
    }
    goto lab_0x806bfe7;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806c12b - 0x806c15a
// Line range:    8691 - 8693
int32_t HTisDocumentSource(void) {
    // 0x806c12b
    return HTMainText == NULL ? 0 : (int32_t)*(char *)&g207;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806c15a - 0x806c1a6
// Line range:    8696 - 8704
char * HTLoadedDocumentURL(void) {
    // 0x806c15a
    if (HTMainText == NULL) {
        // 0x806c1a1
        return (char *)&g12;
    }
    char * result = (char *)&g12; // 0x806c17b
    if (LYCacheSourceForAborted != 0) {
        // 0x806c18b
        result = (char *)LYCacheSourceForAborted;
    }
    // 0x806c1a1
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806c1a6 - 0x806c1e9
// Line range:    8707 - 8714
int32_t * HTLoadedDocumentPost_data(void) {
    // 0x806c1a6
    if (HTMainText == NULL) {
        // 0x806c1e4
        return NULL;
    }
    int32_t v1 = *(int32_t *)&LYShowScrollbar; // 0x806c1c7
    int32_t * result = NULL; // 0x806c1cc
    if (v1 != 0) {
        // 0x806c1ce
        result = (int32_t *)(0x1000000 * v1 >> 24);
    }
    // 0x806c1e4
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806c1e9 - 0x806c235
// Line range:    8717 - 8725
char * HTLoadedDocumentTitle(void) {
    // 0x806c1e9
    if (HTMainText == NULL) {
        // 0x806c230
        return (char *)&g12;
    }
    char * result = (char *)&g12; // 0x806c20a
    if (utfxtra_on_this_line != 0) {
        // 0x806c21a
        result = (char *)utfxtra_on_this_line;
    }
    // 0x806c230
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806c235 - 0x806c27e
// Line range:    8728 - 8736
char HTLoadedDocumentIsHEAD(void) {
    // 0x806c235
    return HTMainText != NULL ? g191 : 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806c27e - 0x806c2c7
// Line range:    8739 - 8747
char HTLoadedDocumentIsSafe(void) {
    // 0x806c27e
    return HTMainText != NULL ? g192 : 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806c2c7 - 0x806c313
// Line range:    8750 - 8758
char * HTLoadedDocumentCharset(void) {
    // 0x806c2c7
    if (HTMainText != NULL) {
        // 0x806c2df
        return (char *)HTCurSelectGroup;
    }
    // 0x806c30e
    return NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806c313 - 0x806c33d
// Line range:    8761 - 8766
char HTLoadedDocumentEightbit(void) {
    // 0x806c313
    return HTMainText != NULL ? g214 : 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806c36f - 0x806c3bb
// Line range:    8778 - 8786
char * HTLoadedDocumentBookmark(void) {
    // 0x806c36f
    if (HTMainText != NULL) {
        // 0x806c387
        return (char *)HTFormNumber;
    }
    // 0x806c3b6
    return NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806cc4e - 0x806cc87
// Line range:    9068 - 9075
int32_t HText_HiddenLinkCount(int32_t * text) {
    // 0x806cc4e
    if (text == NULL) {
        // 0x806cc82
        return 0;
    }
    int32_t v1 = *(int32_t *)((int32_t)text + 2140); // 0x806cc64
    int32_t result = 0; // 0x806cc6c
    if (v1 != 0) {
        // 0x806cc6e
        result = HTList_count((int32_t *)v1);
    }
    // 0x806cc82
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806cc87 - 0x806cccd
// Line range:    9083 - 9090
char * HText_HiddenLinkAt(int32_t * text, int32_t number) {
    // 0x806cc87
    if (text == NULL) {
        // 0x806ccc8
        return NULL;
    }
    int32_t v1 = *(int32_t *)((int32_t)text + 2140); // 0x806cc9d
    char * result = NULL; // 0x806cca5
    if (number >= 0 && v1 != 0) {
        // 0x806ccad
        result = HTList_objectAt((int32_t *)v1, number);
    }
    // 0x806ccc8
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806f351 - 0x806f4ea
// Line range:    10179 - 10214
float64_t get_trans_q(int32_t cs_from, char * givenmime) {
    // 0x806f351
    if (givenmime == NULL || *givenmime == 0) {
        // 0x806f4e5
        return 0.0;
    }
    char * found_char_pos = strchr(givenmime, 59); // 0x806f384
    int32_t v1 = (int32_t)found_char_pos;
    int32_t v2 = v1; // 0x806f390
    char * v3 = NULL; // 0x806f390
    if (found_char_pos != NULL) {
        // 0x806f392
        *found_char_pos = 0;
        v2 = v1 + 1;
        v3 = (char *)v2;
    }
    // 0x806f39c
    char result; // 0x806f351
    if (strcmp(givenmime, "*") != 0) {
        // 0x806f3d3
        result = UCCanTranslateFromTo(cs_from, UCGetLYhndl_byMIME(givenmime));
    } else {
        // 0x806f3b3
        result = UCCanTranslateFromTo(cs_from, UCGetLYhndl_byMIME("utf-8"));
    }
    // 0x806f3f0
    if (result == 0) {
        // 0x806f4e5
        return 0.0;
    }
    if (v3 == NULL || *v3 == 0) {
        // 0x806f4e5
        return result;
    }
    // 0x806f418
    char * p; // bp-20, 0x806f351
    *(int32_t *)&p = v2;
    char * v4 = HTNextTok(&p, ";", "\"", NULL); // 0x806f4ad
    char * p2 = v4; // bp-16, 0x806f4b2
    float80_t str_as_d = 1.0L; // 0x806f4ba
    if (v4 == NULL) {
      lab_0x806f4c0:
        // 0x806f4e5
        return str_as_d * (float80_t)result;
    }
    char * v5 = HTNextTok(&p2, "= ", NULL, NULL); // 0x806f43e
    char * str; // 0x806f452
    if (v5 != NULL) {
        // 0x806f44c
        str = HTNextField(&p2);
        if (str != NULL) {
            // 0x806f460
            if (strcasecomp(v5, "q") == 0) {
                // 0x806f477
                str_as_d = strtod(str, NULL);
                return str_as_d * (float80_t)result;
            }
        }
    }
    char * v6 = HTNextTok(&p, ";", "\"", NULL); // 0x806f4ad
    p2 = v6;
    while (v6 != NULL) {
        // 0x806f420
        v5 = HTNextTok(&p2, "= ", NULL, NULL);
        if (v5 != NULL) {
            // 0x806f44c
            str = HTNextField(&p2);
            if (str != NULL) {
                // 0x806f460
                if (strcasecomp(v5, "q") == 0) {
                    // 0x806f477
                    str_as_d = strtod(str, NULL);
                    return str_as_d * (float80_t)result;
                }
            }
        }
        // 0x806f48f
        v6 = HTNextTok(&p, ";", "\"", NULL);
        p2 = v6;
    }
    // 0x806f4e5
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806f4ea - 0x806f634
// Line range:    10232 - 10265
int32_t find_best_target_cs(char ** best_csname, int32_t cs_from, char * acceptstring) {
    char * v1 = NULL; // bp-8, 0x806f4f0
    int3_t v2; // 0x806f4ea
    int3_t v3 = v2 - 1; // 0x806f4f7
    __frontend_reg_store_fpr(v3, 1.0L);
    __frontend_reg_store_fpr(v3, -__frontend_reg_load_fpr(v3));
    float80_t v4 = __frontend_reg_load_fpr(v3); // 0x806f4fb
    HTSACopy(&v1, acceptstring);
    char * bestmime; // bp-20, 0x806f4ea
    *(int32_t *)&bestmime = (int32_t)v1;
    int32_t v5 = 0; // 0x806f51d
    int32_t v6 = (float64_t)v4; // 0x806f51d
    int32_t v7; // 0x806f4ea
    int3_t v8; // 0x806f4ea
    int32_t v9; // 0x806f4ea
    float80_t v10; // 0x806f4ea
    while (true) {
        // 0x806f559
        v7 = v5;
        v10 = (int64_t)v6;
        int3_t v11; // 0x806f4ea
        v8 = v11;
        char * v12 = HTNextTok(&bestmime, ",", "\"", NULL); // 0x806f577
        if (v12 == NULL) {
            // break (via goto) -> 0x806f585
            goto lab_0x806f585;
        }
        while (*v12 == 0) {
            // 0x806f559
            v12 = HTNextTok(&bestmime, ",", "\"", NULL);
            if (v12 == NULL) {
                // break (via goto) -> 0x806f585
                goto lab_0x806f585;
            }
        }
        // 0x806f529
        get_trans_q(cs_from, v12);
        float80_t v13 = __frontend_reg_load_fpr(v8); // 0x806f53b
        __frontend_reg_store_fpr(v8, v13);
        int3_t v14 = v8 - 1; // 0x806f541
        __frontend_reg_store_fpr(v14, v10);
        float80_t v15 = __frontend_reg_load_fpr(v14); // 0x806f544
        __frontend_reg_store_fpr(v14, __frontend_reg_load_fpr(v8));
        __frontend_reg_store_fpr(v8, v15);
        __frontend_reg_load_fpr(v14);
        __frontend_reg_load_fpr(v8);
        int3_t v16 = v8 + 1; // 0x806f546
        while ((v9 & 0x4100) != 0) {
            // 0x806f559
            v8 = v16;
            v12 = HTNextTok(&bestmime, ",", "\"", NULL);
            if (v12 == NULL) {
                // break (via goto) -> 0x806f585
                goto lab_0x806f585;
            }
            while (*v12 == 0) {
                // 0x806f559
                v12 = HTNextTok(&bestmime, ",", "\"", NULL);
                if (v12 == NULL) {
                    // break (via goto) -> 0x806f585
                    goto lab_0x806f585;
                }
            }
            // 0x806f529
            get_trans_q(cs_from, v12);
            v13 = __frontend_reg_load_fpr(v8);
            __frontend_reg_store_fpr(v8, v13);
            v14 = v8 - 1;
            __frontend_reg_store_fpr(v14, v10);
            v15 = __frontend_reg_load_fpr(v14);
            __frontend_reg_store_fpr(v14, __frontend_reg_load_fpr(v8));
            __frontend_reg_store_fpr(v8, v15);
            __frontend_reg_load_fpr(v14);
            __frontend_reg_load_fpr(v8);
            v16 = v8 + 1;
        }
        // 0x806f54d
        __frontend_reg_store_fpr(v8, v13);
        v5 = (int32_t)v12;
        v11 = v16;
        v6 = (float64_t)__frontend_reg_load_fpr(v8);
    }
  lab_0x806f585:
    if (v7 == 0) {
        // 0x806f60f
        if (v1 != NULL) {
            // 0x806f616
            free((int32_t *)v1);
            v1 = NULL;
        }
        // 0x806f62f
        return -1;
    }
    char * str = (char *)v7;
    if (strcmp(str, "*") != 0) {
        // 0x806f5bb
        HTSACopy(best_csname, str);
    } else {
        // 0x806f5a6
        HTSACopy(best_csname, "utf-8");
    }
    // 0x806f5cd
    if (v1 != NULL) {
        // 0x806f5d4
        free((int32_t *)v1);
        v1 = NULL;
    }
    int3_t v17 = v8 - 1; // 0x806f5e6
    __frontend_reg_store_fpr(v17, v10);
    int3_t v18 = v8 - 2; // 0x806f5e9
    __frontend_reg_store_fpr(v18, 0.0L);
    float80_t v19 = __frontend_reg_load_fpr(v18); // 0x806f5eb
    __frontend_reg_store_fpr(v18, __frontend_reg_load_fpr(v17));
    __frontend_reg_store_fpr(v17, v19);
    __frontend_reg_load_fpr(v18);
    __frontend_reg_load_fpr(v17);
    int32_t result = -1; // 0x806f5f2
    if ((v9 & 0x4100) == 0) {
        // 0x806f5f4
        result = UCGetLYhndl_byMIME(*best_csname);
    }
    // 0x806f62f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806f634 - 0x806f74c
// Line range:    10270 - 10287
void load_a_file(char * val_used, int32_t ** result) {
    int32_t v1 = __readgsdword(20); // 0x806f64f
    if (WWW_TraceFlag != 0) {
        // 0x806f665
        fprintf(TraceFP(), "Ok, about to convert %s to mime/thingy\n", val_used);
    }
    // 0x806f686
    if (*val_used != 0) {
        struct _IO_FILE * stream = fopen64(val_used, "rb"); // 0x806f6a8
        if (stream != NULL) {
            // 0x806f6f4
            int32_t data; // bp-265, 0x806f634
            int32_t items_read = fread(&data, 1, 256, stream); // 0x806f717
            if (items_read != 0) {
                // 0x806f6d2
                HTSABCat(result, (char *)&data, items_read);
                int32_t items_read2 = fread(&data, 1, 256, stream); // 0x806f717
                while (items_read2 != 0) {
                    // 0x806f6d2
                    HTSABCat(result, (char *)&data, items_read2);
                    items_read2 = fread(&data, 1, 256, stream);
                }
            }
            // 0x806f72b
            LYCloseInput(stream);
        } else {
            // 0x806f6bc
            HTAlert(gettext("Can't open file for uploading"));
        }
    }
    // 0x806f739
    if (v1 != __readgsdword(20)) {
        // 0x806f745
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806f74c - 0x806f7a2
// Line range:    10290 - 10298
char * guess_content_type(char * filename) {
    // 0x806f74c
    int32_t * encoding; // bp-12, 0x806f74c
    int32_t v1; // bp-8, 0x806f74c
    int32_t * v2 = HTFileFormat(filename, (int32_t **)&v1, (char **)&encoding); // 0x806f766
    if (v2 == NULL) {
        // 0x806f79d
        return (char *)(int32_t *)"text/plain";
    }
    int32_t v3 = *(int32_t *)((int32_t)v2 + 4); // 0x806f777
    if (v3 == 0) {
        // 0x806f79d
        return (char *)(int32_t *)"text/plain";
    }
    int32_t * v4 = (int32_t *)"text/plain"; // 0x806f789
    if (*(char *)v3 != 0) {
        // 0x806f78b
        v4 = (int32_t *)v3;
    }
    // 0x806f79d
    return (char *)v4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806f7a2 - 0x806f7f6
// Line range:    10303 - 10310
void cannot_transcode(char * had_warning, char * target_csname) {
    // 0x806f7a2
    if (*had_warning == 0) {
        // 0x806f7b2
        *had_warning = 1;
        mustshow = 1;
        char * v1 = target_csname == NULL ? "UNKNOWN" : target_csname;
        user_message(gettext("Warning: Cannot transcode form data to charset %s!"), v1);
        LYSleepAlert();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806f7f6 - 0x806f85c
// Line range:    10316 - 10332
int32_t check_form_specialchars(char * value) {
    // 0x806f7f6
    if (value == NULL) {
        // 0x806f857
        return 0;
    }
    int32_t v1 = (int32_t)value; // 0x806f83d
    int32_t result = 0;
    char v2 = *(char *)v1; // 0x806f84a
    while (result != 3 == (v2 != 0)) {
        // 0x806f80b
        result |= (v2 > 2 == (v2 != 7) ? (int32_t)(v2 < 0) : 2);
        v1++;
        if (v1 == 0) {
            // break -> 0x806f857
            break;
        }
        v2 = *(char *)v1;
    }
    // 0x806f857
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806f85c - 0x806f96e
// Line range:    10340 - 10359
void UpdateBoundary(char ** Boundary, int32_t * data) {
    int32_t len = strlen(*Boundary); // 0x806f86a
    int32_t v1 = 0; // 0x806f876
    int32_t v2 = 0; // 0x806f876
    if (data != NULL) {
        // 0x806f896
        v1 = *(int32_t *)((int32_t)data + 4);
        v2 = *data;
    }
    int32_t str = (int32_t)*Boundary;
    int32_t last = str; // bp-28, 0x806f8b2
    if (v1 - len < 0) {
        // 0x806f964
        *(int32_t *)Boundary = str;
        return;
    }
    int32_t v3 = 0; // 0x806f94b
    int32_t str2 = v3 + v2;
    int32_t v4 = len; // 0x806f8d2
    char v5; // bp-6, 0x806f85c
    int32_t memcmp_rc; // 0x806f8eb
    int16_t * v6; // 0x806f8f9
    unsigned char v7; // 0x806f906
    int16_t v8; // 0x806f911
    if (*(char *)str == *(char *)str2) {
        // 0x806f8d4
        memcmp_rc = memcmp((int32_t *)str, (int32_t *)str2, len);
        v4 = len;
        if (memcmp_rc == 0) {
            // 0x806f8f4
            v6 = *__ctype_b_loc();
            v7 = *(char *)(str2 + len);
            v8 = *(int16_t *)(2 * (int32_t)v7 + (int32_t)v6);
            v5 = (v8 & 2048) == 0 ? 48 : 97;
            HTSACat((char **)&last, &v5);
            v4 = len + 1;
        }
    }
    // 0x806f94b
    v3++;
    while (v1 - v4 >= v3) {
        int32_t n = v4;
        str2 = v3 + v2;
        v4 = n;
        if (*(char *)last == *(char *)str2) {
            // 0x806f8d4
            memcmp_rc = memcmp((int32_t *)last, (int32_t *)str2, n);
            v4 = n;
            if (memcmp_rc == 0) {
                // 0x806f8f4
                v6 = *__ctype_b_loc();
                v7 = *(char *)(str2 + n);
                v8 = *(int16_t *)(2 * (int32_t)v7 + (int32_t)v6);
                v5 = (v8 & 2048) == 0 ? 48 : 97;
                HTSACat((char **)&last, &v5);
                v4 = n + 1;
            }
        }
        // 0x806f94b
        v3++;
    }
    // 0x806f964
    *(int32_t *)Boundary = last;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806f96e - 0x806fb99
// Line range:    10366 - 10435
// Used cryptographic patterns:
//  - B64EncodeTable (8-bit)
char * convert_to_base64(char * src, int32_t len) {
    char * dest = "\n"; // bp-20, 0x806f97a
    int32_t v1 = 4 * (len + 2) / 3; // 0x806f9ac
    int32_t v2 = 0; // 0x806f9b6
    if (v1 != 0) {
        int32_t v3 = v1 - 1; // 0x806f9bb
        v2 = (v1 | 1) + (int32_t)(v3 < 0) + ((int32_t)(0x6bca1af3 * (int64_t)v3 / 0x100000000) >> 5);
    }
    int32_t * mem = malloc(v2 + 1); // 0x806f9eb
    if (mem == NULL) {
        // 0x806f9f9
        outofmem("./GridText.c", "convert_to_base64");
        // UNREACHABLE
    }
    int32_t v4 = (int32_t)mem; // 0x806fa0d
    char * v5 = NULL; // 0x806fb56
    int32_t v6 = v4; // 0x806fb56
    if (len >= 0 == (len != 0)) {
        int32_t v7 = v4; // 0x806fa23
        char * v8 = v5; // 0x806fa23
        if (v5 == (char *)19) {
            // 0x806fa25
            v7 = v4;
            v8 = NULL;
            if (dest != (char *)-1) {
                // 0x806fa49
                *(char *)v4 = *dest;
                v7 = v4 + 1;
                v8 = NULL;
            }
        }
        int32_t v9 = v7;
        unsigned char v10 = *src; // 0x806fa5b
        int32_t v11 = (int32_t)src; // 0x806fa61
        unsigned char v12 = *(char *)(v11 + 1); // 0x806fa68
        char * v13 = (char *)(v11 + 2); // 0x806fa6e
        char v14 = *(char *)((int32_t)(v10 / 4) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"); // 0x806fa7c
        *(char *)v9 = v14;
        char v15 = *(char *)((int32_t)(v12 / 16 | 16 * v10 & 48) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"); // 0x806faa4
        *(char *)(v9 + 1) = v15;
        int32_t v16 = v9 + 2; // 0x806fab0
        char * v17; // 0x806f96e
        unsigned char v18; // 0x806fabd
        char v19; // 0x806fae1
        char v20; // 0x806faf8
        char v21; // 0x806fb1a
        if (len < 3) {
            if (len != 2) {
                // 0x806fb36
                *(char *)v16 = 61;
                *(char *)(v9 + 3) = 61;
                v17 = v13;
            } else {
                // 0x806fb10
                v21 = *(char *)((int32_t)(4 * v12 & 60) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
                *(char *)v16 = v21;
                *(char *)(v9 + 3) = 61;
                v17 = v13;
            }
        } else {
            // 0x806faba
            v18 = *v13;
            v19 = *(char *)((int32_t)(v18 / 64 | 4 * v12 & 60) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
            *(char *)v16 = v19;
            v20 = *(char *)((int32_t)(v18 % 64) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
            *(char *)(v9 + 3) = v20;
            v17 = (char *)(v11 + 3);
        }
        int32_t v22 = v9 + 4;
        int32_t v23 = len - 3; // 0x806fb4a
        v5 = (char *)((int32_t)v8 + 1);
        v6 = v22;
        while (v23 >= 0 == (v23 != 0)) {
            int32_t v24 = v23;
            int32_t v25 = v22;
            v7 = v25;
            v8 = v5;
            if (v5 == (char *)19) {
                // 0x806fa25
                v7 = v25;
                v8 = NULL;
                if (dest != (char *)-1) {
                    // 0x806fa49
                    *(char *)v25 = *dest;
                    v7 = v25 + 1;
                    v8 = NULL;
                }
            }
            // 0x806fa58
            v9 = v7;
            v10 = *v17;
            v11 = (int32_t)v17;
            v12 = *(char *)(v11 + 1);
            v13 = (char *)(v11 + 2);
            v14 = *(char *)((int32_t)(v10 / 4) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
            *(char *)v9 = v14;
            v15 = *(char *)((int32_t)(v12 / 16 | 16 * v10 & 48) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
            *(char *)(v9 + 1) = v15;
            v16 = v9 + 2;
            if (v24 < 3) {
                if (v24 != 2) {
                    // 0x806fb36
                    *(char *)v16 = 61;
                    *(char *)(v9 + 3) = 61;
                    v17 = v13;
                } else {
                    // 0x806fb10
                    v21 = *(char *)((int32_t)(4 * v12 & 60) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
                    *(char *)v16 = v21;
                    *(char *)(v9 + 3) = 61;
                    v17 = v13;
                }
            } else {
                // 0x806faba
                v18 = *v13;
                v19 = *(char *)((int32_t)(v18 / 64 | 4 * v12 & 60) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
                *(char *)v16 = v19;
                v20 = *(char *)((int32_t)(v18 % 64) + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
                *(char *)(v9 + 3) = v20;
                v17 = (char *)(v11 + 3);
            }
            // 0x806fb4a
            v22 = v9 + 4;
            v23 = v24 - 3;
            v5 = (char *)((int32_t)v8 + 1);
            v6 = v22;
        }
    }
    // 0x806fb5c
    if (v2 == 0) {
        // 0x806fb8e
        *(char *)v6 = 0;
        return (char *)mem;
    }
    int32_t v26 = (int32_t)dest;
    char * v27; // bp-48, 0x806f96e
    *(int32_t *)&v27 = v26;
    if (dest == (char *)-1) {
        // 0x806fb8e
        *(char *)v6 = 0;
        return (char *)mem;
    }
    int32_t v28 = v6; // 0x806fb7e
    *(char *)v28 = *dest;
    v28++;
    uint32_t v29 = (int32_t)v27 + 1; // 0x806fb82
    char * v30 = (char *)v29; // 0x806fb82
    v27 = v30;
    while (v26 + 1 > v29) {
        // 0x806fb73
        *(char *)v28 = *v30;
        v28++;
        v29 = (int32_t)v27 + 1;
        v30 = (char *)v29;
        v27 = v30;
    }
    // 0x806fb8e
    *(char *)v28 = 0;
    return (char *)mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806fb99 - 0x806fc76
// Line range:    10456 - 10478
char * escape_or_quote_name(char * name, uint32_t quoting, char * MultipartContentType) {
    char * result = NULL; // bp-8, 0x806fb9f
    if (quoting >= 3) {
        if (quoting == 3) {
            // 0x806fc5b
            result = HTEscapeSP(name, 1);
        }
        // 0x806fc71
        return result;
    }
    if (quoting == 0) {
        // 0x806fbc9
        HTSACopy(&result, name);
        // 0x806fc71
        return result;
    }
    // 0x806fbe0
    HTSACopy(&result, "Content-Disposition: form-data");
    HTSprintf(&result, "; name=\"%s\"", name);
    if (MultipartContentType != NULL) {
        // 0x806fc13
        HTSprintf(&result, MultipartContentType);
    }
    if (quoting == 2) {
        // 0x806fc33
        HTSACat(&result, "\r\nContent-Transfer-Encoding: base64");
    }
    // 0x806fc46
    HTSACat(&result, "\r\n\r\n");
    // 0x806fc71
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806fc76 - 0x806fd00
// Line range:    10482 - 10499
char * escape_or_quote_value(char * value, uint32_t quoting) {
    char * result2 = NULL; // bp-8, 0x806fc7c
    if (quoting == 2) {
        char * result = convert_to_base64(value, strlen(value)); // 0x806fcdb
        result2 = result;
        // 0x806fcfb
        return result;
    }
    if (quoting < 2) {
        // 0x806fc9d
        HTSACopy(&result2, value == NULL ? (char *)&g12 : value);
        // 0x806fcfb
        return result2;
    }
    char * result3 = NULL; // 0x806fc99
    if (quoting == 3) {
        // 0x806fce5
        result3 = HTEscapeSP(value, 1);
        result2 = result3;
    }
    // 0x806fcfb
    return result3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806fd00 - 0x806fe2d
// Line range:    10508 - 10537
int32_t check_if_base64_needed(int32_t submit_method, int32_t * data) {
    if (data == NULL) {
        // 0x806fe28
        return 0;
    }
    int32_t v1 = *data; // 0x806fd1a
    if (v1 == 0) {
        // 0x806fe28
        return 0;
    }
    uint32_t v2 = *(int32_t *)((int32_t)data + 4); // 0x806fd48
    int32_t v3 = 0; // 0x806fdf2
    int32_t v4 = 0; // 0x806fdf2
    int32_t v5 = 0; // 0x806fdf2
    if (v2 <= 0) {
        // 0x806fe28
        return 0;
    }
    char v6 = 1; // 0x806fdf2
    int32_t v7; // 0x806fd00
    int32_t v8; // 0x806fd00
    char v9; // 0x806fd00
    unsigned char v10; // 0x806fd6f
    int32_t v11; // 0x806fd00
    while (true) {
      lab_0x806fd69:
        // 0x806fd69
        v11 = v5;
        v8 = v4;
        v7 = v3;
        v10 = *(char *)(v7 + v1);
        if (v10 < 0) {
            goto lab_0x806fd8b;
        } else {
            // 0x806fd7f
            v9 = v6;
            if (v10 > 31 || v10 == 10) {
                goto lab_0x806fdc1;
            } else {
                goto lab_0x806fd8b;
            }
        }
    }
  lab_0x806fe06:;
    char v12; // 0x806fd00
    if (v12 != 0) {
        // 0x806fe28
        return 0;
    }
    // 0x806fe0c
    if (submit_method == 3 && (v4 < v5 ? v5 : v4) >= 73) {
        // 0x806fe28
        return 1;
    }
    // 0x806fe28
    return 0;
  lab_0x806fd8b:
    // 0x806fd8b
    v9 = 0;
    if (WWW_TraceFlag != 0) {
        // 0x806fd96
        fprintf(TraceFP(), "nonprintable %d:%#x\n", v7, (int32_t)v10);
        v9 = 0;
    }
    goto lab_0x806fdc1;
  lab_0x806fdc1:
    // 0x806fdc1
    v12 = v9;
    int32_t v13 = v8 < v11 ? v11 : v8;
    v4 = v10 != 10 == (v10 != 13) ? v8 : v13;
    v5 = v10 != 10 == (v10 != 13) ? v11 + 1 : 0;
    v3 = v7 + 1;
    v6 = v12;
    if (v3 == v2) {
        // break -> 0x806fe06
        goto lab_0x806fe06;
    }
    goto lab_0x806fd69;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x806fe2d - 0x80724e9
// Line range:    10549 - 11480
int32_t HText_SubmitForm(int32_t * submit_item, int32_t * doc, char * link_name, char * link_value) {
    int32_t v1 = (int32_t)submit_item;
    char v2 = 0; // bp-13, 0x806fe38
    char * out_csname = NULL; // bp-28, 0x806fe4c
    int32_t * my_data = NULL; // bp-44, 0x806fe5a
    int32_t * anchor_ptr = NULL; // bp-48, 0x806fe61
    int32_t * my_query = NULL; // bp-52, 0x806fe68
    char * Boundary = NULL; // bp-56, 0x806fe6f
    char * MultipartContentType = NULL; // bp-60, 0x806fe76
    char * content_type_out = NULL; // bp-64, 0x806fe7d
    char * copied_name_used = NULL; // bp-68, 0x806fe84
    char * last_textarea_name = NULL; // bp-84, 0x806fea0
    char * name_used = (char *)&g12; // bp-88, 0x806fea7
    int32_t v3 = *(int32_t *)(v1 + 4); // 0x806febf
    if (WWW_TraceFlag != 0) {
        // 0x806feec
        fprintf(TraceFP(), "SubmitForm\n  link_name=%s\n  link_value=%s\n", link_name, link_value);
    }
    // 0x806ff13
    if (HTMainText == NULL) {
        // 0x80724d9
        return 0;
    }
    char * v4 = HTList_objectAt((int32_t *)g205, v3 - 1); // 0x806ff43
    char * v5; // 0x806fe2d
    if (v4 != NULL) {
        int32_t v6 = *(int32_t *)v4; // 0x806ff7f
        v5 = v4;
        if (v6 != v3) {
            // 0x806ff86
            v5 = NULL;
            if (WWW_TraceFlag != 0) {
                // 0x806ff91
                fprintf(TraceFP(), "SubmitForm: failed sanity check, %d!=%d !\n", v6, v3);
                v5 = NULL;
            }
        }
    } else {
        // 0x806ff51
        v5 = v4;
        if (WWW_TraceFlag != 0) {
            // 0x806ff5c
            fprintf(TraceFP(), "SubmitForm: form %d not in HTMainText's list!\n", v3);
            v5 = v4;
        }
    }
    int32_t * v7 = (int32_t *)(v1 + 48); // 0x806ffc4
    int32_t v8 = *v7; // 0x806ffc4
    bool v9; // 0x806fe2d
    int32_t v10; // 0x806fe2d
    int32_t v11; // 0x806fe2d
    char v12; // 0x806fe2d
    char v13; // 0x806fe2d
    int32_t * v14; // 0x807000c
    if (v8 == 0) {
        goto lab_0x806ffd8;
    } else {
        char * v15 = (char *)v8; // 0x806ffd1
        if (*v15 != 0) {
            // 0x8070009
            v14 = (int32_t *)(v1 + 52);
            if (*v14 == 3) {
                // 0x8070014
                if (strncasecomp(v15, "mailto:", 7) != 0) {
                    // 0x8070036
                    HTAlert(gettext("Malformed mailto form submission!  Cancelled!"));
                    // 0x80724d9
                    return 0;
                }
            }
            int32_t * v16 = (int32_t *)(v1 + 56); // 0x807005c
            int32_t v17 = *v16;
            v12 = 0;
            v13 = 0;
            if (v17 != 0) {
                // 0x8070063
                v12 = 0;
                v13 = 1;
                if (strncasecomp((char *)v17, "text/plain", 10) != 0) {
                    int32_t v18 = *v16;
                    v12 = 0;
                    v13 = 0;
                    if (v18 != 0) {
                        // 0x8070095
                        v12 = 1;
                        v13 = 0;
                        if (strncasecomp((char *)v18, "application/sgml-form-urlencoded", 32) != 0) {
                            int32_t v19 = *v16;
                            v12 = 0;
                            v13 = 0;
                            if (v19 != 0) {
                                // 0x80700c7
                                v12 = 0;
                                v13 = 0;
                                if (strncasecomp((char *)v19, "multipart/form-data", 19) == 0) {
                                    // 0x80700e9
                                    anchor_ptr = (int32_t *)"xnyLAaB03X";
                                    v12 = 0;
                                    v13 = 0;
                                }
                            }
                        }
                    }
                }
            }
            // 0x80700f0
            v9 = true;
            v10 = -1;
            if (v5 == NULL) {
                goto lab_0x80701bb;
            } else {
                int32_t * v20 = (int32_t *)(v1 + 92); // 0x80700f9
                int32_t v21 = *v20; // 0x80700f9
                if (v21 == 0) {
                    goto lab_0x807014f;
                } else {
                    // 0x8070100
                    if (strcasecomp((char *)v21, "UNKNOWN") == 0) {
                        goto lab_0x807014f;
                    } else {
                        int32_t v22 = *v20; // 0x8070121
                        v11 = find_best_target_cs((char **)((int32_t)v5 + 28), current_char_set, (char *)v22);
                        goto lab_0x807019c;
                    }
                }
            }
        } else {
            goto lab_0x806ffd8;
        }
    }
  lab_0x80720c1:;
    // 0x80720c1
    int32_t v23; // 0x80714b8
    char * v24 = (char *)(v23 + 1); // 0x80720c1
    char * v25 = v24; // 0x80720cb
    char v26; // 0x806fe2d
    char v27 = v26; // 0x80720cb
    char * v28; // 0x806fe2d
    if (v28 <= v24) {
        // break -> 0x80720d1
        goto lab_0x80720d1;
    }
    goto lab_0x80714b8;
  lab_0x8071730:;
    // 0x8071730
    int32_t v31; // 0x806fe2d
    int32_t * v65 = (int32_t *)(v31 + 20);
    int32_t v66 = *v65; // 0x8071742
    int32_t * v33; // 0x806fe2d
    int32_t v67 = *v33; // 0x8071754
    copied_name_used = escape_or_quote_name((char *)v67, v66, (char *)my_query);
    char * v46; // 0x80716fa
    char * v68 = escape_or_quote_value(v46, *v65); // 0x8071786
    char * v69; // 0x806fe2d
    if (v13 == 0) {
        // 0x80717aa
        v69 = (char *)&g12;
        goto lab_0x80717b4;
    } else {
        // 0x8071794
        v69 = "\n";
        if (*v68 == 0) {
            // 0x80717aa
            v69 = (char *)&g12;
            goto lab_0x80717b4;
        } else {
            goto lab_0x80717b4;
        }
    }
  lab_0x8071831:;
    int32_t * v70 = (int32_t *)(v31 + 20);
    int32_t v71 = *v70; // 0x8071843
    int32_t v72 = *v33; // 0x8071855
    copied_name_used = escape_or_quote_name((char *)v72, v71, (char *)my_query);
    char * v73 = escape_or_quote_value(v46, *v70); // 0x8071887
    char * v74; // 0x806fe2d
    if (v13 == 0) {
        // 0x80718ab
        v74 = (char *)&g12;
        goto lab_0x80718b5;
    } else {
        // 0x8071895
        v74 = "\n";
        if (*v73 == 0) {
            // 0x80718ab
            v74 = (char *)&g12;
            goto lab_0x80718b5;
        } else {
            goto lab_0x80718b5;
        }
    }
  lab_0x8071932:;
    int32_t * v75 = (int32_t *)(v31 + 20);
    int32_t v76 = *v75; // 0x8071944
    int32_t v77 = *v33; // 0x8071956
    copied_name_used = escape_or_quote_name((char *)v77, v76, (char *)my_query);
    char * v78 = escape_or_quote_value(v46, *v75); // 0x8071988
    char * v49; // 0x806fe2d
    char * v79; // 0x806fe2d
    int32_t * v47; // 0x807170c
    if (*v47 != 13) {
        if (v13 == 0) {
            // 0x8071ae5
            v79 = (char *)&g12;
            goto lab_0x8071aef;
        } else {
            // 0x8071acf
            v79 = "\n";
            if (*v78 == 0) {
                // 0x8071ae5
                v79 = (char *)&g12;
                goto lab_0x8071aef;
            } else {
                goto lab_0x8071aef;
            }
        }
    } else {
        // 0x80719aa
        if (anchor_ptr == NULL) {
            char * v80; // 0x806fe2d
            char * v81; // 0x806fe2d
            if (v13 == 0) {
                // 0x8071a58
                v80 = v12 == 0 ? "&" : ";";
                v81 = (char *)&g12;
            } else {
                // 0x8071a29
                v80 = "\n";
                v81 = *copied_name_used == 0 ? (char *)&g12 : "\n";
            }
            char * v82 = copied_name_used; // 0x8071a99
            HTBprintf(&my_data, "%s.x=0%s%s.y=0%s", v82, v80, v82, v81);
            v49 = v78;
        } else {
            // 0x80719b1
            *(char *)((int32_t)strchr(copied_name_used, 61) + 1) = 0;
            char * v83 = copied_name_used; // 0x80719dc
            char * v84 = (char *)*v33; // 0x8071a19
            HTBprintf(&my_data, "%s\"%s.x\"\r\n\r\n0\r\n--%s\r\n%s\"%s.y\"\r\n\r\n0", v83, v84, anchor_ptr, v83, v84);
            v49 = v78;
        }
        goto lab_0x8072090;
    }
  lab_0x8072090:;
    char * v85 = v49;
    char * v86 = copied_name_used; // 0x8072090
    if (v86 != NULL) {
        // 0x8072097
        free((int32_t *)v86);
        copied_name_used = NULL;
    }
    // 0x80720a9
    char v43; // 0x806fe2d
    v26 = v43;
    if (v85 != NULL) {
        // 0x80720af
        free((int32_t *)v85);
        v26 = v43;
    }
    goto lab_0x80720c1;
  lab_0x80717b4:;
    char * v87 = anchor_ptr == NULL ? (char *)&g15 : (char *)&g12;
    char * v62; // 0x806fe2d
    HTBprintf(&my_data, "%s%s%s%s%s", copied_name_used, v87, v62, v68, v69);
    v49 = v68;
    goto lab_0x8072090;
  lab_0x80718b5:;
    char * v88 = anchor_ptr == NULL ? (char *)&g15 : (char *)&g12;
    HTBprintf(&my_data, "%s%s%s%s%s", copied_name_used, v88, v62, v73, v74);
    v49 = v73;
    goto lab_0x8072090;
  lab_0x8071aef:;
    char * v89 = anchor_ptr == NULL ? (char *)&g15 : (char *)&g12;
    HTBprintf(&my_data, "%s%s%s%s%s", copied_name_used, v89, v62, v78, v79);
    v49 = v78;
    goto lab_0x8072090;
  lab_0x8071c53:;
    char * v90 = anchor_ptr == NULL ? (char *)&g15 : (char *)&g12;
    char * v58; // 0x806fe2d
    char * v51; // 0x8071b88
    char * v57; // 0x8071c25
    HTBprintf(&my_data, "%s%s%s%s%s", v57, v90, v62, v51, v58);
    v49 = v51;
    goto lab_0x8072090;
  lab_0x80713dd:;
    // 0x80713dd
    int32_t * v91; // 0x806fe2d
    int32_t v92 = *v91; // 0x80713e0
    char * v93; // 0x806fe2d
    char * v94 = v93; // 0x80713e9
    int32_t * v95 = (int32_t *)v92; // 0x80713e9
    char v96; // 0x806fe2d
    char v97 = v96; // 0x80713e9
    int32_t v98; // 0x806fe2d
    int32_t v99 = v98; // 0x80713e9
    char * v100; // 0x806fe2d
    char * v101 = v100; // 0x80713e9
    if (v92 == 0) {
        // break -> 0x80713ef
        goto lab_0x80713ef_2;
    }
    goto lab_0x80706aa;
  lab_0x80713cf:;
    // 0x80713cf
    char * str3; // 0x806fe2d
    v93 = str3;
    char * v102; // 0x806fe2d
    v100 = v102;
    int32_t v103; // 0x806fe2d
    v98 = v103;
    char v104; // 0x806fe2d
    v96 = v104;
    int32_t v107; // 0x80706bf
    if (v107 > v3) {
        // break -> 0x80713ef
        goto lab_0x80713ef_2;
    }
    goto lab_0x80713dd;
  lab_0x8070a7a:;
    // 0x8070a7a
    int32_t v106; // 0x80706bc
    int32_t v121 = v106 + 68; // 0x8070a80
    int32_t v122 = *(int32_t *)v121 == 0 ? v106 + 12 : v121;
    char * v123 = (char *)*(int32_t *)v122;
    name_used = v123;
    bool v124; // 0x806fe2d
    int32_t v125; // 0x806fe2d
    char v126; // 0x806fe2d
    int32_t v127; // 0x806fe2d
    int32_t * str4; // 0x807077f
    if (check_form_specialchars(v123) == 0) {
        // 0x8070c01
        v126 = 1;
        if (WWW_TraceFlag != 0) {
            char * v128 = out_csname; // 0x8070c0c
            char * v129 = v128 == NULL ? "???" : v128;
            int32_t v130 = *str4; // 0x8070c2d
            char * v131 = v130 == 0 ? (char *)&g12 : (char *)v130;
            fprintf(TraceFP(), "field \"%s\" %d %s OK\n", v131, v125, v129);
            v126 = 1;
        }
        goto lab_0x8070c83;
    } else {
        // 0x8070ab4
        HTSACopy(&content_type_out, v123);
        int32_t * v132 = (int32_t *)(v106 + 88);
        int32_t v133 = *v132; // 0x8070ad0
        char v134 = LYUCTranslateBackFormData(&content_type_out, v133, v125, v13); // 0x8070ae8
        if (WWW_TraceFlag != 0) {
            char * v135 = out_csname; // 0x8070b1b
            uint32_t v136 = *v132; // 0x8070b3c
            char * v137 = "???"; // 0x8070b41
            if (v136 >= 0) {
                int32_t v138 = *(int32_t *)(32 * v136 + (int32_t)&g143); // 0x8070b4f
                v137 = (char *)v138;
            }
            char * v139 = v134 == 0 ? "FAILED" : "OK";
            char * v140 = v135 == NULL ? "???" : v135;
            int32_t v141 = *str4; // 0x8070b7c
            char * v142 = v141 == 0 ? (char *)&g12 : (char *)v141;
            fprintf(TraceFP(), "field \"%s\" %d %s -> %d %s %s\n", v142, v136, v137, v125, v140, v139);
        }
        if (v134 == 0) {
            // 0x8070c89
            cannot_transcode(&v2, out_csname);
            v124 = false;
            v127 = *v132;
            goto lab_0x8070cb5;
        } else {
            // 0x8070bf6
            *(int32_t *)&name_used = (int32_t)content_type_out;
            v126 = v134;
            goto lab_0x8070c83;
        }
    }
  lab_0x807086a:;
    int32_t v143 = *str4; // 0x8070870
    int32_t * v110; // 0x8070735
    if (v143 == 0) {
        goto lab_0x80708a4;
    } else {
        char * str = (char *)v143; // 0x807087e
        if (*str == 0) {
            goto lab_0x80708a4;
        } else {
            // 0x8070885
            if (strcmp(str, link_name) == 0) {
                // 0x8070981
                if (*v110 == 12) {
                    goto lab_0x8070a7a;
                } else {
                    int32_t v144 = *(int32_t *)(v106 + 12); // 0x8070999
                    if (v144 == 0) {
                        goto lab_0x80709d0;
                    } else {
                        char * str2 = (char *)v144; // 0x80709a9
                        if (*str2 == 0) {
                            goto lab_0x80709d0;
                        } else {
                            // 0x80709b0
                            if (strcmp(str2, link_value) == 0) {
                                goto lab_0x8070a7a;
                            } else {
                                goto lab_0x80709d0;
                            }
                        }
                    }
                }
            } else {
                goto lab_0x80708a4;
            }
        }
    }
  lab_0x8071051:;
    // 0x8071051
    char v118; // 0x806fe2d
    char v145 = v118;
    int32_t v117; // 0x806fe2d
    int32_t v146 = v117;
    int32_t v147 = (int32_t)v102; // 0x8071055
    int32_t v148 = 24 * v147; // 0x807105e
    int32_t v149; // 0x806fe2d
    *(char *)((v148 | 4) + v149) = 1;
    int32_t v150 = v148 + v149;
    *(int32_t *)v150 = *v110;
    int32_t v151 = *v110; // 0x807108a
    g374 = v151;
    char * v152 = str3; // 0x80710a9
    int32_t v153 = v146; // 0x80710a9
    char * v154 = str3; // 0x80710a9
    int32_t v155 = v146; // 0x80710a9
    switch (v151) {
        case 1: {
            goto lab_0x80711c6;
        }
        case 2: {
            goto lab_0x80711c6;
        }
        case 3: {
            goto lab_0x80711bc;
        }
        case 4: {
            goto lab_0x80711bc;
        }
        case 5: {
            goto lab_0x80710da;
        }
        case 7: {
            goto lab_0x80711c6;
        }
        case 8: {
            goto lab_0x80711c6;
        }
        case 9: {
            if (str3 == NULL) {
                goto lab_0x8071195;
            } else {
                // 0x807117a
                if (strcmp(str3, (char *)*str4) == 0) {
                    // 0x80711a9
                    char * v156; // 0x8071064
                    *v156 = 0;
                    v152 = str3;
                    v153 = v146;
                    goto lab_0x80711c6;
                } else {
                    goto lab_0x8071195;
                }
            }
        }
        case 11: {
            // 0x80710b4
            load_a_file(name_used, (int32_t **)(v150 + 16));
            v152 = str3;
            v153 = v146;
            goto lab_0x80711c6;
        }
        case 12: {
            goto lab_0x80710da;
        }
        case 13: {
            goto lab_0x80710da;
        }
        default: {
            goto lab_0x8071397;
        }
    }
  lab_0x80708a4:;
    // 0x80708a4
    int32_t v112; // 0x806fe2d
    v117 = v112;
    v118 = v104;
    char * v157; // 0x806fe2d
    char * v158; // 0x806fe2d
    int32_t v159; // 0x80708db
    if (WWW_TraceFlag == 0) {
        goto lab_0x8071051;
    } else {
        // 0x80708c6
        fprintf(TraceFP(), "skipping submit field with ");
        v117 = v112;
        v118 = v104;
        if (WWW_TraceFlag == 0) {
            goto lab_0x8071051;
        } else {
            // 0x80708d5
            v159 = *str4;
            v157 = (char *)v159;
            if (v159 == 0) {
                // 0x80708fc
                v158 = "no field name";
                goto lab_0x8070906;
            } else {
                // 0x80708e1
                v158 = "not current link";
                if (*v157 == 0) {
                    // 0x80708fc
                    v158 = "no field name";
                    goto lab_0x8070906;
                } else {
                    goto lab_0x8070906;
                }
            }
        }
    }
  lab_0x80711c6:;
    int32_t v160 = v153;
    char * v161 = v152;
    char * escaped2; // bp-80, 0x806fe2d
    HTSACopy((char **)(v150 + 8), escaped2);
    char * v162 = name_used; // 0x80711f9
    HTSACopy((char **)(v150 + 12), v162);
    int32_t v163 = v150 + 16; // 0x8071217
    int32_t * v164 = (int32_t *)v163; // 0x8071217
    if (*v164 == 0) {
        // 0x807121e
        HTSABCat0((int32_t **)v163, v162);
    }
    int32_t * v165 = (int32_t *)(v148 + 20 + v149);
    int32_t v109; // 0x806fe2d
    *v165 = v109;
    v154 = v161;
    v155 = v160;
    if (v109 == 1) {
        // 0x8071266
        v154 = v161;
        v155 = v160;
        if (check_if_base64_needed(*v14, (int32_t *)*v164) != 0) {
            // 0x8071292
            if (WWW_TraceFlag != 0) {
                // 0x807129d
                fprintf(TraceFP(), "will encode as base64\n");
            }
            // 0x80712b4
            *v165 = 2;
            int32_t v166 = *v164; // 0x80712d9
            int32_t v167 = 0; // 0x80712de
            int32_t v168 = 0; // 0x80712de
            if (v166 != 0) {
                // 0x807131d
                v167 = *(int32_t *)(v166 + 4);
                v168 = *(int32_t *)v166;
            }
            char * v169 = convert_to_base64((char *)v168, v167); // 0x8071356
            HTSABCopy0((int32_t **)v163, v169);
            v154 = v161;
            v155 = v160;
            if (v169 != NULL) {
                // 0x8071385
                free((int32_t *)v169);
                v154 = v161;
                v155 = v160;
            }
        }
    }
    goto lab_0x8071397;
  lab_0x80711bc:
    // 0x80711bc
    v152 = str3;
    v153 = v146;
    v154 = str3;
    v155 = v146;
    if (*(int32_t *)(v106 + 32) == 0) {
        goto lab_0x8071397;
    } else {
        goto lab_0x80711c6;
    }
  lab_0x80710da:;
    int32_t v296 = *str4; // 0x80710e0
    v154 = str3;
    v155 = v146;
    if (v296 == 0) {
        goto lab_0x8071397;
    } else {
        char * str8 = (char *)v296; // 0x80710ee
        v154 = str3;
        v155 = v146;
        if (*str8 == 0) {
            goto lab_0x8071397;
        } else {
            // 0x80710f5
            v154 = str3;
            v155 = v146;
            if (strcmp(str8, link_name) != 0) {
                goto lab_0x8071397;
            } else {
                // 0x8071110
                v152 = str3;
                v153 = v146;
                if (*v110 == 12) {
                    goto lab_0x80711c6;
                } else {
                    int32_t v297 = *(int32_t *)(v106 + 12); // 0x8071128
                    v154 = str3;
                    v155 = v146;
                    if (v297 == 0) {
                        goto lab_0x8071397;
                    } else {
                        char * str9 = (char *)v297; // 0x8071138
                        v154 = str3;
                        v155 = v146;
                        if (*str9 == 0) {
                            goto lab_0x8071397;
                        } else {
                            // 0x807113f
                            v152 = str3;
                            v153 = v146;
                            v154 = str3;
                            v155 = v146;
                            if (strcmp(str9, link_value) == 0) {
                                goto lab_0x80711c6;
                            } else {
                                goto lab_0x8071397;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x8071397:;
    int32_t v170 = v155;
    char * v171 = v154;
    char * v172 = MultipartContentType; // 0x807139b
    if (v172 != NULL) {
        // 0x80713a2
        free((int32_t *)v172);
        MultipartContentType = NULL;
    }
    char * v173 = (char *)(v147 + 1); // 0x8071397
    v93 = v171;
    v100 = v173;
    v98 = v170;
    v96 = v145;
    if (content_type_out != NULL) {
        // 0x80713bb
        free((int32_t *)content_type_out);
        content_type_out = NULL;
        v93 = v171;
        v100 = v173;
        v98 = v170;
        v96 = v145;
    }
    goto lab_0x80713dd;
  lab_0x8070c83:
    // 0x8070c83
    v124 = v126 != 0;
    v127 = v125;
    goto lab_0x8070cb5;
  lab_0x8071195:
    // 0x8071195
    v152 = (char *)*str4;
    v153 = 1;
    goto lab_0x80711c6;
  lab_0x8070cb5:;
    uint32_t v174 = v127;
    bool v175 = v124;
    char v176 = v104; // 0x8070cbc
    if (v174 >= 0) {
        int32_t v177 = *(int32_t *)(32 * v174 + (int32_t)&g143); // 0x8070cc7
        v176 = v177;
    }
    char v178 = v176;
    char v179 = v178; // 0x8070cd5
    int32_t * v180; // 0x806fe2d
    if (anchor_ptr != NULL) {
        // 0x8070cdb
        HTSACopy((char **)&my_query, "\r\nContent-Type: %s");
        char v181; // 0x806fe2d
        if (v175) {
            // 0x8070d19
            v181 = v178;
            if (out_csname == NULL) {
                // 0x8070d1f
                out_csname = (char *)*v180;
                v181 = v178;
            }
        } else {
            // 0x8070cf4
            v181 = (char)"UNKNOWN-8BIT";
            if (*(int32_t *)(v106 + 88) >= 0) {
                // 0x8070d10
                out_csname = NULL;
                v181 = v178;
            }
        }
        char v182 = v181;
        char * str5 = (char *)(int32_t)v182; // 0x8070d39
        v179 = v182;
        if (strcmp(str5, "iso-8859-1") != 0) {
            // 0x8070d45
            HTSprintf((char **)&my_query, "; charset=%s", str5);
            v179 = v182;
        }
    }
    char v183 = v179;
    int32_t v184 = v112; // 0x8070d6b
    if (*v110 != 9) {
        goto lab_0x8070da8;
    } else {
        int32_t v185 = v112 + 1; // 0x8070d6d
        v184 = v185;
        if (str3 == NULL || v185 < 2) {
            goto lab_0x8070da8;
        } else {
            int32_t str6 = *str4; // 0x8070d83
            v184 = v185;
            if (str6 == 0) {
                goto lab_0x8070da8;
            } else {
                // 0x8070d89
                v184 = v185;
                v117 = v185;
                v118 = v183;
                if (strcmp(str3, (char *)str6) == 0) {
                    goto lab_0x8071051;
                } else {
                    goto lab_0x8070da8;
                }
            }
        }
    }
  lab_0x8070da8:;
    int32_t v186 = v184;
    char * v116; // 0x806fe2d
    if (check_form_specialchars(v116) == 0) {
        // 0x8070f4d
        if (WWW_TraceFlag != 0) {
            char * v187 = out_csname; // 0x8070f58
            char * v188 = v187 == NULL ? "???" : v187;
            int32_t v189 = *str4; // 0x8070f79
            char * v190 = v189 == 0 ? (char *)&g12 : (char *)v189;
            fprintf(TraceFP(), "name \"%s\" %d %s OK\n", v190, v125, v188);
        }
        // 0x8070fcb
        v117 = v186;
        v118 = v183;
        if (anchor_ptr == NULL) {
            goto lab_0x8071051;
        } else {
            // 0x8070fd6
            HTSACopy(&MultipartContentType, v116);
            goto lab_0x8071000;
        }
    } else {
        // 0x8070dbb
        HTSACopy(&MultipartContentType, v116);
        int32_t * v191 = (int32_t *)(v106 + 84); // 0x8070dd7
        int32_t v192 = *v191; // 0x8070dd7
        char v193 = LYUCTranslateBackFormData(&MultipartContentType, v192, v125, v13); // 0x8070def
        if (WWW_TraceFlag != 0) {
            char * v194 = out_csname; // 0x8070e22
            uint32_t v195 = *v191; // 0x8070e43
            char * v196 = "???"; // 0x8070e48
            if (v195 >= 0) {
                int32_t v197 = *(int32_t *)(32 * v195 + (int32_t)&g143); // 0x8070e56
                v196 = (char *)v197;
            }
            char * v198 = v193 == 0 ? "FAILED" : "OK";
            char * v199 = v194 == NULL ? "???" : v194;
            int32_t v200 = *str4; // 0x8070e83
            char * v201 = v200 == 0 ? (char *)&g12 : (char *)v200;
            fprintf(TraceFP(), "name \"%s\" %d %s -> %d %s %s\n", v201, v195, v196, v125, v199, v198);
        }
        if (v193 != 0) {
            // 0x8070ef9
            *(int32_t *)&escaped2 = (int32_t)MultipartContentType;
        }
        // 0x8070eff
        if (anchor_ptr == NULL) {
            // 0x8070fe8
            v117 = v186;
            v118 = v183;
            if (v193 != 0) {
                goto lab_0x8071051;
            } else {
                // 0x8070fee
                cannot_transcode(&v2, out_csname);
                goto lab_0x8071000;
            }
        } else {
            if (v193 != 0) {
                // 0x8070f2f
                if (out_csname == NULL) {
                    // 0x8070f39
                    out_csname = (char *)*v180;
                }
                goto lab_0x8071000;
            } else {
                // 0x8070fe8
                HTSACopy((char **)&my_query, (char *)&g12);
                out_csname = NULL;
                // 0x8070fee
                cannot_transcode(&v2, NULL);
                goto lab_0x8071000;
            }
        }
    }
  lab_0x8070906:;
    char * v202 = v159 == 0 ? "???" : v157;
    char * v203; // 0x806fe2d
    fprintf(TraceFP(), "name \"%s\" for link_name \"%s\", %s.\n", v202, v203, v158);
    v117 = v112;
    v118 = v104;
    goto lab_0x8071051;
  lab_0x80709d0:
    // 0x80709d0
    v117 = v112;
    v118 = v104;
    if (WWW_TraceFlag != 0) {
        // 0x80709f2
        fprintf(TraceFP(), "skipping submit field with ");
        v117 = v112;
        v118 = v104;
        if (WWW_TraceFlag != 0) {
            int32_t v204 = *str4; // 0x8070a22
            char * v205 = v204 == 0 ? "???" : (char *)v204;
            fprintf(TraceFP(), "name \"%s\" for link_name \"%s\", %s!\n", v205, v203, "values are different");
            v117 = v112;
            v118 = v104;
        }
    }
    goto lab_0x8071051;
  lab_0x8071000:
    // 0x8071000
    v117 = v186;
    v118 = v183;
    if (anchor_ptr != NULL) {
        // 0x8071007
        HTMake822Word(&MultipartContentType, 0);
        *(int32_t *)&escaped2 = (int32_t)MultipartContentType;
        v117 = v186;
        v118 = v183;
    }
    goto lab_0x8071051;
  lab_0x8070441:;
    // 0x8070441
    int32_t * v206; // 0x806fe2d
    int32_t v207 = *v206; // 0x8070444
    char * v208; // 0x806fe2d
    char * v209 = v208; // 0x807044d
    int32_t v210; // 0x806fe2d
    int32_t v211 = v210; // 0x807044d
    char * v212; // 0x806fe2d
    char * v213 = v212; // 0x807044d
    int32_t * v214 = (int32_t *)v207; // 0x807044d
    int32_t v215; // 0x806fe2d
    int32_t v216 = v215; // 0x807044d
    int32_t v217; // 0x806fe2d
    int32_t v218 = v217; // 0x807044d
    char * v219 = v208; // 0x807044d
    int32_t nmemb = v210; // 0x807044d
    char * v220 = v212; // 0x807044d
    int32_t v221 = v217; // 0x807044d
    int32_t v222 = v215; // 0x807044d
    if (v207 == 0) {
        // break -> 0x8070453
        goto lab_0x8070453_2;
    }
    goto lab_0x8070242;
  lab_0x8070433:;
    // 0x8070433
    char * v227; // 0x806fe2d
    v208 = v227;
    int32_t v226; // 0x806fe2d
    v210 = v226;
    char * v225; // 0x807042d
    v212 = v225;
    int32_t v223; // 0x806fe2d
    v217 = v223;
    int32_t v224; // 0x806fe2d
    v215 = v224;
    v219 = v227;
    nmemb = v226;
    v220 = v225;
    v221 = v223;
    v222 = v224;
    int32_t v230; // 0x8070257
    if (v230 > v3) {
        // break -> 0x8070453
        goto lab_0x8070453_2;
    }
    goto lab_0x8070441;
  lab_0x8070380:;
    // 0x8070380
    int32_t v235; // 0x806fe2d
    int32_t v238 = v235;
    int32_t v239 = v238; // 0x8070384
    uint32_t v234; // 0x80702c0
    if (v234 == 0 || v238 < 0) {
        goto lab_0x807042d;
    } else {
        if (v234 % 2 != 0) {
            goto lab_0x80703c9;
        } else {
            int32_t v240 = 32 * v238; // 0x80703a1
            v239 = v238;
            if (*(int32_t *)(v240 + (int32_t)&g144) == 2) {
                goto lab_0x807042d;
            } else {
                int32_t v241 = *(int32_t *)((v240 | 16) + (int32_t)&g145); // 0x80703ba
                v239 = v238;
                if ((char)v241 <= -1) {
                    goto lab_0x807042d;
                } else {
                    goto lab_0x80703c9;
                }
            }
        }
    }
  lab_0x807042d:;
    int32_t v242 = (int32_t)v225 + 1; // 0x807042d
    char * v243 = (char *)v242; // 0x807042d
    v208 = v243;
    v210 = v242;
    v212 = v243;
    v217 = v239;
    uint32_t v233; // 0x80702b0
    v215 = v234 | v233;
    goto lab_0x8070441;
  lab_0x807031c:;
    // 0x807031c
    int32_t v229; // 0x8070254
    int32_t * v244 = (int32_t *)(v229 + 88); // 0x807031f
    char v245 = UCNeedNotTranslate(*v244, v223); // 0x807032c
    v235 = v223;
    if (v245 != 0) {
        goto lab_0x8070380;
    } else {
        char v246 = UCCanTranslateFromTo(*v244, v223); // 0x8070345
        v235 = v223;
        if (v246 != 0) {
            goto lab_0x8070380;
        } else {
            // 0x807034e
            v239 = -1;
            if (UCCanTranslateFromTo(v223, *v244) == 0) {
                goto lab_0x807042d;
            } else {
                // 0x8070367
                out_csname = NULL;
                v235 = *v244;
                goto lab_0x8070380;
            }
        }
    }
  lab_0x80703c9:;
    int32_t * v247 = (int32_t *)(v229 + 84); // 0x80703cc
    char v248 = UCNeedNotTranslate(*v247, v238); // 0x80703d9
    v239 = v238;
    if (v248 == 0) {
        char v249 = UCCanTranslateFromTo(*v247, v238); // 0x80703f2
        v239 = v238;
        if (v249 == 0) {
            // 0x80703fb
            v239 = -1;
            if (UCCanTranslateFromTo(v238, *v247) != 0) {
                // 0x8070414
                out_csname = NULL;
                v239 = *(int32_t *)(v229 + 88);
            }
        }
    }
    goto lab_0x807042d;
  lab_0x806ffd8:
    // 0x806ffd8
    if (WWW_TraceFlag != 0) {
        // 0x806ffe3
        fprintf(TraceFP(), "SubmitForm: no action given\n");
    }
    // 0x80724d9
    return 0;
  lab_0x80701bb:;
    bool v250 = v9; // 0x80701bf
    int32_t v251 = v10; // 0x80701bf
    if (HTCurSelectGroup != 0) {
        char * v252 = (char *)HTCurSelectGroup; // 0x80701d9
        v250 = v9;
        v251 = v10;
        if (*v252 != 0) {
            int32_t v253 = UCGetLYhndl_byMIME(v252); // 0x80701ed
            if (v253 < 0) {
                int32_t v254 = *(int32_t *)(32 * UCLYhndl_for_unspec + (int32_t)&g143); // 0x8070218
                out_csname = (char *)v254;
                v250 = v9;
                v251 = UCLYhndl_for_unspec;
            } else {
                // 0x80701fb
                out_csname = (char *)HTCurSelectGroup;
                v250 = v9;
                v251 = v253;
            }
        }
    }
    goto lab_0x8070221;
  lab_0x8070221:;
    int32_t v255 = v251;
    int32_t v256 = v255 >= 0 ? v255 : UCLYhndl_for_unspec;
    char * v257 = NULL; // 0x807044d
    char * v258 = NULL; // 0x807044d
    int32_t v259 = 0; // 0x807044d
    int32_t v260 = v256; // 0x807044d
    if (g203 != NULL) {
        // 0x8070242
        v209 = NULL;
        v211 = 0;
        v213 = NULL;
        v214 = (int32_t *)g203;
        v216 = 0;
        v218 = v256;
        while (true) {
          lab_0x8070242:
            // 0x8070242
            v223 = v218;
            v224 = v216;
            v206 = v214;
            v225 = v213;
            v226 = v211;
            v227 = v209;
            int32_t v228 = (int32_t)v206; // 0x8070242
            v208 = v227;
            v210 = v226;
            v212 = v225;
            v217 = v223;
            v215 = v224;
            if (*(char *)(v228 + 27) != 2) {
                goto lab_0x8070441;
            } else {
                // 0x8070251
                v229 = *(int32_t *)(v228 + 28);
                v230 = *(int32_t *)(v229 + 4);
                if (v230 != v3) {
                    goto lab_0x8070433;
                } else {
                    // 0x8070263
                    if (*(int32_t *)(v229 + 80) != 0) {
                        goto lab_0x8070433;
                    } else {
                        int32_t v231 = v229 + 68; // 0x8070280
                        int32_t v232 = *(int32_t *)v231 == 0 ? v229 + 12 : v231;
                        v233 = check_form_specialchars((char *)*(int32_t *)v232);
                        v234 = check_form_specialchars((char *)*(int32_t *)v229);
                        v235 = v223;
                        if (v223 < 0 || v233 == 0) {
                            goto lab_0x8070380;
                        } else {
                            if (v233 % 2 != 0) {
                                goto lab_0x807031c;
                            } else {
                                int32_t v236 = 32 * v223; // 0x80702f4
                                if (*(int32_t *)(v236 + (int32_t)&g144) == 2) {
                                    goto lab_0x8070380;
                                } else {
                                    int32_t v237 = *(int32_t *)((v236 | 16) + (int32_t)&g145); // 0x807030d
                                    v235 = v223;
                                    if ((char)v237 <= -1) {
                                        goto lab_0x8070380;
                                    } else {
                                        goto lab_0x807031c;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
      lab_0x8070453_2:;
        int32_t v261 = v222;
        int32_t v262 = v221;
        char * v263 = v219;
        v257 = v263;
        v258 = NULL;
        v259 = v261;
        v260 = v262;
        if (v220 != NULL) {
            int32_t * mem = calloc(nmemb, 24); // 0x8070467
            v257 = v263;
            v258 = (char *)mem;
            v259 = v261;
            v260 = v262;
            if (mem == NULL) {
                // 0x8070475
                outofmem("./GridText.c", "HText_SubmitForm");
                // UNREACHABLE
            }
        }
    }
    // 0x8070489
    v125 = v260;
    uint32_t v264 = v259;
    char * v265 = v258;
    v28 = v257;
    if (v125 >= 0 && out_csname == NULL) {
        if (v264 % 2 == 0) {
            if ((v264 & 2) == 0) {
                // 0x80704cb
                out_csname = "us-ascii";
            } else {
                int32_t v266 = *(int32_t *)(32 * v125 + (int32_t)&g143); // 0x80704c0
                out_csname = (char *)v266;
            }
        } else {
            int32_t v267 = *(int32_t *)(32 * v125 + (int32_t)&g143); // 0x80704a5
            out_csname = (char *)v267;
        }
    }
    // 0x80704d2
    char * str7; // bp-156, 0x806fe2d
    if (*v14 != 1) {
        goto lab_0x8070566;
    } else {
        // 0x80704e1
        if (anchor_ptr != NULL) {
            goto lab_0x8070566;
        } else {
            // 0x80704e8
            str7 = NULL;
            HTSACopy(&str7, (char *)*v7);
            strtok(str7, "#");
            strtok(str7, "?");
            HTSACat(&str7, "?");
            HTSABCat0(&my_data, str7);
            goto lab_0x8070691;
        }
    }
  lab_0x807014f:;
    int32_t v268 = (int32_t)v5; // 0x807014f
    int32_t * v269 = (int32_t *)(v268 + 24); // 0x8070152
    int32_t v270 = *v269; // 0x8070152
    v9 = true;
    v10 = -1;
    if (v270 == 0) {
        goto lab_0x80701bb;
    } else {
        // 0x8070159
        v9 = true;
        v10 = -1;
        if (strcasecomp((char *)v270, "UNKNOWN") == 0) {
            goto lab_0x80701bb;
        } else {
            int32_t v271 = *v269; // 0x807017a
            v11 = find_best_target_cs((char **)(v268 + 28), current_char_set, (char *)v271);
            goto lab_0x807019c;
        }
    }
  lab_0x8070566:
    if (v12 != 1) {
        if (v13 != 1) {
            // 0x807059c
            if (anchor_ptr == NULL) {
                // 0x80705b8
                HTSACopy(&Boundary, "application/x-www-form-urlencoded");
            } else {
                // 0x80705a3
                HTSACopy(&Boundary, "multipart/form-data");
            }
        } else {
            // 0x8070587
            HTSACopy(&Boundary, "text/plain");
        }
    } else {
        // 0x807056c
        HTSACopy(&Boundary, "application/sgml-form-urlencoded");
    }
    int32_t v272; // 0x806fe2d
    if (v250 == v264 % 4 == 0) {
        goto lab_0x8070691;
    } else {
        char * v273 = out_csname; // 0x80705f3
        if (v125 < 0 || v273 == NULL) {
            // 0x807067f
            cannot_transcode(&v2, v273);
            goto lab_0x8070691;
        } else {
            // 0x80705fd
            if (anchor_ptr != NULL) {
                goto lab_0x8070691;
            } else {
                // 0x8070608
                v272 = 0;
                if (HTCurSelectGroup == 0) {
                    goto lab_0x807064b;
                } else {
                    // 0x8070616
                    if (strcmp((char *)HTCurSelectGroup, "iso-8859-1") != 0) {
                        // 0x8070663
                        HTSprintf(&Boundary, "; charset=%s", out_csname);
                        goto lab_0x8070691;
                    } else {
                        // 0x8070634
                        if (strcmp(out_csname, "iso-8859-1") != 0) {
                            // 0x8070663
                            HTSprintf(&Boundary, "; charset=%s", out_csname);
                            goto lab_0x8070691;
                        } else {
                            // 0x8070634
                            v272 = HTCurSelectGroup;
                            goto lab_0x807064b;
                        }
                    }
                }
            }
        }
    }
  lab_0x8070691:
    // 0x8070691
    if (g203 != NULL) {
        // 0x80706aa
        v180 = (int32_t *)(32 * v125 + (int32_t)&g143);
        int32_t v111 = (int32_t)v28;
        v203 = link_name == NULL ? "???" : link_name;
        v149 = (int32_t)v265;
        v94 = NULL;
        v95 = (int32_t *)g203;
        v97 = (int32_t)out_csname;
        v99 = 0;
        v101 = NULL;
        while (true) {
          lab_0x80706aa:
            // 0x80706aa
            v102 = v101;
            v103 = v99;
            v104 = v97;
            v91 = v95;
            str3 = v94;
            int32_t v105 = (int32_t)v91; // 0x80706aa
            v93 = str3;
            v100 = v102;
            v98 = v103;
            v96 = v104;
            if (*(char *)(v105 + 27) != 2) {
                goto lab_0x80713dd;
            } else {
                // 0x80706b9
                v106 = *(int32_t *)(v105 + 28);
                v107 = *(int32_t *)(v106 + 4);
                if (v107 != v3) {
                    goto lab_0x80713cf;
                } else {
                    // 0x80706cb
                    if (*(int32_t *)(v106 + 80) != 0) {
                        goto lab_0x80713cf;
                    } else {
                        int32_t v108 = 0; // 0x80706ec
                        if (v13 == 0) {
                            // 0x80706ee
                            v108 = anchor_ptr == NULL ? 3 : 1;
                        }
                        // 0x8070723
                        v109 = v108;
                        v110 = (int32_t *)(v106 + 8);
                        if (WWW_TraceFlag != 0) {
                            // 0x807074f
                            fprintf(TraceFP(), "SubmitForm[%d/%d]: ", (int32_t)v102 + 1, v111);
                        }
                        // 0x8070779
                        v112 = *v110 == 9 ? v103 : 0;
                        str4 = (int32_t *)v106;
                        int32_t v113 = *str4; // 0x807077f
                        int32_t v114 = v113 == 0 ? (int32_t)&g12 : v113;
                        *(int32_t *)&escaped2 = v114;
                        int32_t v115 = *v110; // 0x80707ae
                        g373 = v115;
                        v116 = (char *)v114;
                        switch (v115) {
                            case 1: {
                                goto lab_0x8070a7a;
                            }
                            case 2: {
                                goto lab_0x8070a7a;
                            }
                            case 3: {
                                goto lab_0x8070a7a;
                            }
                            case 4: {
                                goto lab_0x8070a7a;
                            }
                            case 5: {
                                goto lab_0x807086a;
                            }
                            case 6: {
                                // 0x80707d3
                                v117 = v112;
                                v118 = v104;
                                if (WWW_TraceFlag != 0) {
                                    // 0x80707e2
                                    fprintf(TraceFP(), "reset\n");
                                    v117 = v112;
                                    v118 = v104;
                                }
                                goto lab_0x8071051;
                            }
                            case 7: {
                                goto lab_0x8070a7a;
                            }
                            case 8: {
                                goto lab_0x8070a7a;
                            }
                            case 9: {
                                goto lab_0x8070a7a;
                            }
                            case 11: {
                                int32_t v119 = *(int32_t *)(v106 + 12); // 0x8070804
                                int32_t v120 = v119 == 0 ? (int32_t)&g12 : v119;
                                *(int32_t *)&name_used = v120;
                                v117 = v112;
                                v118 = v104;
                                if (WWW_TraceFlag != 0) {
                                    // 0x807083e
                                    fprintf(TraceFP(), "I will submit %s (from %s)\n", (char *)v120, v116);
                                    v117 = v112;
                                    v118 = v104;
                                }
                                goto lab_0x8071051;
                            }
                            case 12: {
                                goto lab_0x807086a;
                            }
                            case 13: {
                                goto lab_0x807086a;
                            }
                            default: {
                                // 0x8071022
                                v117 = v112;
                                v118 = v104;
                                if (WWW_TraceFlag != 0) {
                                    // 0x807102d
                                    fprintf(TraceFP(), "What type is %d?\n", *v110);
                                    v117 = v112;
                                    v118 = v104;
                                }
                                goto lab_0x8071051;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x80713ef_2:
    // 0x80713ef
    if (MultipartContentType != NULL) {
        // 0x80713f6
        free((int32_t *)MultipartContentType);
        MultipartContentType = NULL;
    }
    if (v265 != NULL) {
        // 0x8071412
        if (Boundary != NULL && anchor_ptr != NULL) {
            // 0x807142c
            anchor_ptr = NULL;
            HTSACopy((char **)&anchor_ptr, "LYNX");
            if (v28 > NULL) {
                int32_t v274 = (int32_t)NULL; // 0x807144f
                int32_t v275 = *(int32_t *)((int32_t)v265 + 16 + 24 * v274); // 0x807145e
                if (v275 != 0) {
                    // 0x8071465
                    UpdateBoundary((char **)&anchor_ptr, (int32_t *)v275);
                }
                char * v276 = (char *)(v274 + 1); // 0x8071486
                while (v28 > v276) {
                    // 0x807144f
                    v274 = (int32_t)v276;
                    v275 = *(int32_t *)((int32_t)v265 + 16 + 24 * v274);
                    if (v275 != 0) {
                        // 0x8071465
                        UpdateBoundary((char **)&anchor_ptr, (int32_t *)v275);
                    }
                    // 0x8071486
                    v276 = (char *)(v274 + 1);
                }
            }
            // 0x8071492
            HTSprintf(&Boundary, "; boundary=%s", anchor_ptr);
        }
        if (v28 > NULL) {
            // 0x80714b8
            v62 = v13 == 0 ? (char *)&g12 : "\n";
            int32_t v32 = (int32_t)v265;
            v25 = NULL;
            v27 = 1;
            while (true) {
              lab_0x80714b8:;
                char v29 = v27;
                v23 = (int32_t)v25;
                int32_t v30 = 24 * v23; // 0x80714c1
                v31 = v30 + v32;
                v33 = (int32_t *)(v31 + 8);
                int32_t v34 = *v33; // 0x80714c7
                v26 = v29;
                if (v34 == 0) {
                    goto lab_0x80720c1;
                } else {
                    int32_t * v35 = (int32_t *)(v31 + 12);
                    int32_t v36 = *v35; // 0x80714e1
                    v26 = v29;
                    if (v36 == 0) {
                        goto lab_0x80720c1;
                    } else {
                        // 0x80714ec
                        if (WWW_TraceFlag != 0) {
                            int32_t v37 = *(int32_t *)(v31 + 16); // 0x807150a
                            char v38 = *(char *)(v31 + 4); // 0x807155c
                            fprintf(TraceFP(), "processing [%d:%d] name=%s(first:%d, value=%s, data=%p)\n", v23 + 1, (int32_t)v28, (char *)v34, (int32_t)v38, (char *)v36, (int32_t *)v37);
                        }
                        char * v39 = (char *)((v30 | 4) + v32);
                        char v40 = v29; // 0x807160a
                        if (*v39 != 0) {
                            if (v29 == 0) {
                                if (v13 == 0) {
                                    if (v12 == 0) {
                                        int32_t * v41 = anchor_ptr; // 0x8071673
                                        if (v41 == NULL) {
                                            // 0x8071696
                                            HTSABCat0(&my_data, "&");
                                            v40 = 0;
                                        } else {
                                            // 0x807167a
                                            HTBprintf(&my_data, "\r\n--%s\r\n", v41);
                                            v40 = 0;
                                        }
                                    } else {
                                        // 0x807165e
                                        HTSABCat0(&my_data, ";");
                                        v40 = 0;
                                    }
                                } else {
                                    // 0x8071643
                                    HTSABCat0(&my_data, "\n");
                                    v40 = 0;
                                }
                            } else {
                                int32_t * v42 = anchor_ptr; // 0x8071616
                                v40 = 0;
                                if (v42 != NULL) {
                                    // 0x807161d
                                    HTBprintf(&my_data, "--%s\r\n", v42);
                                    v40 = 0;
                                }
                            }
                        }
                        // 0x80716a9
                        v43 = v40;
                        int32_t v44 = v31 + 16; // 0x80716b8
                        HTSABCat((int32_t **)v44, (char *)&g12, 1);
                        char * v45 = (char *)*v33; // 0x80716e5
                        escaped2 = v45;
                        v46 = (char *)*v35;
                        name_used = v46;
                        v47 = (int32_t *)v31;
                        int32_t v48 = *v47; // 0x807170c
                        g375 = v48;
                        v49 = NULL;
                        switch (v48) {
                            case 1: {
                                goto lab_0x8071730;
                            }
                            case 2: {
                                goto lab_0x8071730;
                            }
                            case 3: {
                                goto lab_0x8071831;
                            }
                            case 4: {
                                goto lab_0x8071831;
                            }
                            case 5: {
                                goto lab_0x8071932;
                            }
                            case 7: {
                                goto lab_0x8071730;
                            }
                            case 8: {
                                goto lab_0x8071730;
                            }
                            case 9: {
                                int32_t * v50 = (int32_t *)(v31 + 20); // 0x8071b7b
                                v51 = escape_or_quote_value(v46, *v50);
                                if (*v39 == 0) {
                                    int32_t v52 = (int32_t)"\n"; // 0x8071cd4
                                    if (v13 == 0) {
                                        // 0x8071cd6
                                        v52 = anchor_ptr == NULL ? (int32_t)"%0d%0a" : (int32_t)"\r\n";
                                    }
                                    char * v53 = (char *)v52;
                                    if (*v51 == 0) {
                                        // 0x8071daa
                                        HTSACat(&last_textarea_name, v53);
                                        v49 = v51;
                                    } else {
                                        char * v54 = last_textarea_name; // 0x8071d25
                                        if (v54 != NULL) {
                                            // 0x8071d2c
                                            HTSABCat0(&my_data, v54);
                                            char * v55 = last_textarea_name; // 0x8071d3e
                                            if (v55 != NULL) {
                                                // 0x8071d45
                                                free((int32_t *)v55);
                                                last_textarea_name = NULL;
                                            }
                                        }
                                        // 0x8071d57
                                        HTSABCat0(&my_data, v51);
                                        if (v13 == 0 == anchor_ptr == NULL) {
                                            // 0x8071d90
                                            HTSACopy(&last_textarea_name, v53);
                                            v49 = v51;
                                        } else {
                                            // 0x8071d76
                                            HTSABCat0(&my_data, v53);
                                            v49 = v51;
                                        }
                                    }
                                    goto lab_0x8072090;
                                } else {
                                    if (v13 == 0) {
                                        // 0x8071bd3
                                        if (anchor_ptr == NULL) {
                                            // 0x8071bef
                                            HTSACopy(&last_textarea_name, "%0d%0a");
                                        } else {
                                            // 0x8071bda
                                            HTSACopy(&last_textarea_name, "\r\n");
                                        }
                                    } else {
                                        char * v56 = last_textarea_name; // 0x8071bb8
                                        if (v56 != NULL) {
                                            // 0x8071bbf
                                            free((int32_t *)v56);
                                            last_textarea_name = NULL;
                                        }
                                    }
                                    // 0x8071c02
                                    v57 = escape_or_quote_name(v45, *v50, (char *)my_query);
                                    copied_name_used = v57;
                                    if (v13 == 0) {
                                        // 0x8071c49
                                        v58 = (char *)&g12;
                                        goto lab_0x8071c53;
                                    } else {
                                        // 0x8071c33
                                        v58 = "\n";
                                        if (*v51 == 0) {
                                            // 0x8071c49
                                            v58 = (char *)&g12;
                                            goto lab_0x8071c53;
                                        } else {
                                            goto lab_0x8071c53;
                                        }
                                    }
                                }
                            }
                            case 11: {
                                if (v13 == 0) {
                                    // 0x8071df0
                                    if (anchor_ptr == NULL) {
                                        // 0x8071f18
                                        copied_name_used = HTEscapeSP((char *)*v33, 1);
                                    } else {
                                        char * v59 = guess_content_type(v46); // 0x8071e01
                                        str7 = NULL;
                                        HTSACopy(&copied_name_used, "Content-Disposition: form-data");
                                        HTSprintf(&copied_name_used, "; name=\"%s\"", (char *)*v33);
                                        HTSACopy(&str7, v46);
                                        HTMake822Word(&str7, 0);
                                        HTSprintf(&copied_name_used, "; filename=\"%s\"", str7);
                                        char * v60 = str7; // 0x8071e9a
                                        if (v60 != NULL) {
                                            // 0x8071ea4
                                            free((int32_t *)v60);
                                            str7 = NULL;
                                        }
                                        // 0x8071ebc
                                        HTSprintf(&copied_name_used, "\r\nContent-Type: %s", v59);
                                        if (*(int32_t *)(v31 + 20) == 2) {
                                            // 0x8071ef0
                                            HTSACat(&copied_name_used, "\r\nContent-Transfer-Encoding: base64");
                                        }
                                        // 0x8071f03
                                        HTSACat(&copied_name_used, "\r\n\r\n");
                                    }
                                } else {
                                    // 0x8071dca
                                    HTSACopy(&copied_name_used, (char *)*v33);
                                }
                                char * v61 = anchor_ptr == NULL ? (char *)&g15 : (char *)&g12;
                                HTBprintf(&my_data, "%s%s%s", copied_name_used, v61, v62);
                                int32_t v63 = *(int32_t *)v44; // 0x8071fb3
                                v49 = NULL;
                                if (v63 != 0) {
                                    uint32_t v64 = *(int32_t *)(v63 + 4); // 0x8071fd0
                                    v49 = NULL;
                                    if (v64 >= 2) {
                                        // 0x8072058
                                        HTSABCat(&my_data, (char *)*(int32_t *)v63, v64 - 1);
                                        v49 = NULL;
                                        if (v13 != 0) {
                                            // 0x807207d
                                            HTBprintf(&my_data, "\n");
                                            v49 = NULL;
                                        }
                                    }
                                }
                                goto lab_0x8072090;
                            }
                            case 12: {
                                goto lab_0x8071932;
                            }
                            case 13: {
                                goto lab_0x8071932;
                            }
                            default: {
                                goto lab_0x8072090;
                            }
                        }
                    }
                }
            }
        }
      lab_0x80720d1:;
        int32_t * v277 = anchor_ptr; // 0x80720d1
        if (v277 != NULL) {
            // 0x80720d8
            HTBprintf(&my_data, "\r\n--%s--\r\n", v277);
        }
        // 0x80720f2
        if (WWW_TraceFlag != 0) {
            int32_t v278 = 0; // 0x807210d
            if (my_data != NULL) {
                // 0x807210f
                v278 = *(int32_t *)((int32_t)my_data + 4);
            }
            // 0x8072127
            fprintf(TraceFP(), "Query %d{", v278);
            trace_bstring(my_data);
            if (WWW_TraceFlag != 0) {
                // 0x807215e
                fprintf(TraceFP(), "}\n");
            }
        }
    }
    // 0x8072175
    char * v279; // 0x806fe2d
    int32_t result; // 0x806fe2d
    char * v280; // 0x806fe2d
    if (*v14 != 3) {
        int32_t v281 = (int32_t)doc;
        mustshow = 1;
        statusline(gettext("Submitting form..."));
        if (*v14 != 2 == anchor_ptr == NULL) {
            // 0x8072325
            HTSABCat(&my_data, (char *)&g12, 1);
            char * v282 = NULL; // 0x8072345
            if (my_data != NULL) {
                // 0x8072347
                v282 = (char *)*my_data;
            }
            // 0x807235e
            HTSACopy((char **)(v281 + 4), v282);
            LYFreePostData(doc);
            result = 1;
            if (Boundary != NULL) {
                // 0x8072388
                free((int32_t *)Boundary);
                Boundary = NULL;
                result = 1;
            }
        } else {
            // 0x80722c5
            LYFreePostData(doc);
            *(int32_t *)(v281 + 8) = (int32_t)my_data;
            *(int32_t *)(v281 + 12) = (int32_t)Boundary;
            if (WWW_TraceFlag != 0) {
                // 0x80722ed
                fprintf(TraceFP(), "GridText - post_data set:\n%s\n", Boundary);
            }
            // 0x807230b
            HTSACopy((char **)(v281 + 4), (char *)*v7);
            result = 1;
        }
        goto lab_0x80723a1;
    } else {
        // 0x8072184
        HTUserMsg2(gettext("Submitting %s"), (char *)*v7);
        HTSABCat(&my_data, (char *)&g12, 1);
        v280 = NULL;
        if (my_data != NULL) {
            // 0x80721cd
            v280 = (char *)*my_data;
        }
        int32_t v283 = *(int32_t *)(v1 + 60); // 0x80721e7
        if (v283 == 0) {
            goto lab_0x80721fb;
        } else {
            char * v284 = (char *)v283; // 0x80721f4
            v279 = v284;
            if (*v284 != 0) {
                goto lab_0x8072235;
            } else {
                goto lab_0x80721fb;
            }
        }
    }
  lab_0x807019c:
    // 0x807019c
    v9 = false;
    v10 = v11;
    if (v11 < 0) {
        goto lab_0x80701bb;
    } else {
        int32_t v285 = *(int32_t *)((int32_t)v5 + 28); // 0x80701ab
        v250 = false;
        v251 = v11;
        if (v285 != 0) {
            // 0x80701b2
            out_csname = (char *)v285;
            v250 = false;
            v251 = v11;
        }
        goto lab_0x8070221;
    }
  lab_0x80723a1:
    // 0x80723a1
    if (my_query != NULL) {
        // 0x80723a8
        free(my_query);
        my_query = NULL;
    }
    // 0x80723ba
    if (last_textarea_name != NULL) {
        // 0x80723c1
        free((int32_t *)last_textarea_name);
        last_textarea_name = NULL;
    }
    // 0x80723d3
    if (anchor_ptr != NULL) {
        // 0x80723da
        free(anchor_ptr);
        anchor_ptr = NULL;
    }
    // 0x80723ec
    if (v265 == NULL) {
        // 0x80724d9
        return result;
    }
    if (v28 <= NULL) {
        // 0x80724be
        free((int32_t *)v265);
        // 0x80724d9
        return result;
    }
    int32_t v286 = (int32_t)v265;
    int32_t v287 = (int32_t)NULL; // 0x8072402
    int32_t v288 = 24 * v287; // 0x807240b
    int32_t v289 = v288 + v286;
    int32_t * v290 = (int32_t *)(v289 + 8); // 0x8072411
    int32_t v291 = *v290; // 0x8072411
    if (v291 != 0) {
        // 0x8072418
        free((int32_t *)v291);
        *v290 = 0;
    }
    int32_t * v292 = (int32_t *)(v288 + 12 + v286);
    int32_t v293 = *v292; // 0x8072457
    if (v293 != 0) {
        // 0x807245e
        free((int32_t *)v293);
        *v292 = 0;
    }
    // 0x807248e
    HTSABFree((int32_t **)(v289 + 16));
    char * v294 = (char *)(v287 + 1); // 0x80724a8
    while (v28 > v294) {
        // 0x8072402
        v287 = (int32_t)v294;
        v288 = 24 * v287;
        v289 = v288 + v286;
        v290 = (int32_t *)(v289 + 8);
        v291 = *v290;
        if (v291 != 0) {
            // 0x8072418
            free((int32_t *)v291);
            *v290 = 0;
        }
        // 0x8072448
        v292 = (int32_t *)(v288 + 12 + v286);
        v293 = *v292;
        if (v293 != 0) {
            // 0x807245e
            free((int32_t *)v293);
            *v292 = 0;
        }
        // 0x807248e
        HTSABFree((int32_t **)(v289 + 16));
        v294 = (char *)(v287 + 1);
    }
    // 0x80724be
    free((int32_t *)v265);
    // 0x80724d9
    return result;
  lab_0x80721fb:;
    char * v295 = HText_getTitle(); // 0x80721fb
    v279 = (char *)&g12;
    if (v295 != NULL) {
        // 0x8072204
        v279 = HText_getTitle();
    }
    goto lab_0x8072235;
  lab_0x8072235:
    // 0x8072235
    mailform((char *)(*v7 + 7), v279, v280, Boundary);
    HTSABFree(&my_data);
    result = 0;
    if (Boundary != NULL) {
        // 0x8072281
        free((int32_t *)Boundary);
        Boundary = NULL;
        result = 0;
    }
    goto lab_0x80723a1;
  lab_0x807064b:
    // 0x807064b
    if (v272 != 0 || v125 == UCLYhndl_for_unspec) {
        goto lab_0x8070691;
    } else {
        // 0x8070663
        HTSprintf(&Boundary, "; charset=%s", out_csname);
        goto lab_0x8070691;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80724e9 - 0x8072549
// Line range:    11483 - 11504
void HText_DisableCurrentForm(void) {
    // 0x80724e9
    HTFormDisabled = 1;
    if (HTMainText == NULL) {
        // 0x8072547
        return;
    }
    // 0x80724ff
    char * v1; // bp-8, 0x80724e9
    *(int32_t *)&v1 = (int32_t)g203;
    if (g203 == NULL) {
        // 0x8072547
        return;
    }
    int32_t v2 = (int32_t)g203; // 0x807250f
    char * v3 = g203; // 0x8072518
    int32_t v4; // 0x807251d
    if (*(char *)(v2 + 27) == 2) {
        // 0x807251a
        v4 = *(int32_t *)(v2 + 28);
        v3 = g203;
        if (*(int32_t *)(v4 + 4) == HTFormNumber) {
            // 0x807252c
            *(int32_t *)(v4 + 80) = 1;
            v3 = v1;
        }
    }
    int32_t v5 = *(int32_t *)v3; // 0x807253c
    char * v6 = (char *)v5; // 0x807253e
    v1 = v6;
    while (v5 != 0) {
        char * v7 = v6;
        v2 = (int32_t)v7;
        v3 = v7;
        if (*(char *)(v2 + 27) == 2) {
            // 0x807251a
            v4 = *(int32_t *)(v2 + 28);
            v3 = v7;
            if (*(int32_t *)(v4 + 4) == HTFormNumber) {
                // 0x807252c
                *(int32_t *)(v4 + 80) = 1;
                v3 = v1;
            }
        }
        // 0x8072539
        v5 = *(int32_t *)v3;
        v6 = (char *)v5;
        v1 = v6;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8072549 - 0x8072675
// Line range:    11507 - 11548
void HText_ResetForm(int32_t * form) {
    // 0x8072549
    mustshow = 1;
    statusline(gettext("Resetting form..."));
    if (HTMainText == NULL) {
        // 0x8072673
        return;
    }
    // 0x8072577
    char * v1; // bp-8, 0x8072549
    *(int32_t *)&v1 = (int32_t)g203;
    if (g203 == NULL) {
        // 0x8072673
        return;
    }
    int32_t v2 = (int32_t)g203; // 0x807258a
    int32_t v3; // 0x807259c
    int32_t v4; // 0x807259f
    int32_t v5; // 0x80725a5
    int32_t v6; // 0x80725b6
    int32_t v7; // 0x8072549
    int32_t v8; // 0x8072549
    int32_t * v9; // 0x8072549
    int32_t v10; // 0x807261d
    if (*(char *)(v2 + 27) == 2) {
        // 0x8072599
        v3 = *(int32_t *)(v2 + 28);
        v4 = *(int32_t *)(v3 + 4);
        v5 = *(int32_t *)((int32_t)form + 4);
        if (v4 != v5) {
            if (v4 > v5) {
                // break -> 0x8072673
                break;
            }
        } else {
            // 0x80725b0
            v6 = *(int32_t *)(v3 + 8);
            if (v6 != 4 == (v6 != 3)) {
                // 0x80725fa
                v7 = *(int32_t *)(v3 + 16);
                v8 = v3 + 12;
                if (v6 != 7) {
                    // 0x807262e
                    HTSACopy((char **)v8, (char *)v7);
                } else {
                    // 0x8072608
                    *(int32_t *)v8 = v7;
                    v10 = *(int32_t *)((int32_t)v1 + 28);
                    *(int32_t *)(v10 + 68) = *(int32_t *)(v10 + 72);
                }
            } else {
                // 0x80725cc
                v9 = (int32_t *)(v3 + 32);
                if (*(char *)*(int32_t *)(v3 + 16) != 48) {
                    // 0x80725eb
                    *v9 = 1;
                } else {
                    // 0x80725dc
                    *v9 = 0;
                }
            }
        }
    }
    int32_t v11 = *(int32_t *)v1; // 0x8072664
    char * v12 = (char *)v11; // 0x8072666
    v1 = v12;
    while (v11 != 0) {
        // 0x807258a
        v2 = (int32_t)v12;
        if (*(char *)(v2 + 27) == 2) {
            // 0x8072599
            v3 = *(int32_t *)(v2 + 28);
            v4 = *(int32_t *)(v3 + 4);
            v5 = *(int32_t *)((int32_t)form + 4);
            if (v4 != v5) {
                if (v4 > v5) {
                    // break -> 0x8072673
                    break;
                }
            } else {
                // 0x80725b0
                v6 = *(int32_t *)(v3 + 8);
                if (v6 != 4 == (v6 != 3)) {
                    // 0x80725fa
                    v7 = *(int32_t *)(v3 + 16);
                    v8 = v3 + 12;
                    if (v6 != 7) {
                        // 0x807262e
                        HTSACopy((char **)v8, (char *)v7);
                    } else {
                        // 0x8072608
                        *(int32_t *)v8 = v7;
                        v10 = *(int32_t *)((int32_t)v1 + 28);
                        *(int32_t *)(v10 + 68) = *(int32_t *)(v10 + 72);
                    }
                } else {
                    // 0x80725cc
                    v9 = (int32_t *)(v3 + 32);
                    if (*(char *)*(int32_t *)(v3 + 16) != 48) {
                        // 0x80725eb
                        *v9 = 1;
                    } else {
                        // 0x80725dc
                        *v9 = 0;
                    }
                }
            }
        }
        // 0x8072661
        v11 = *(int32_t *)v1;
        v12 = (char *)v11;
        v1 = v12;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8072675 - 0x80727b4
// Line range:    11556 - 11597
char HText_HaveUserChangedForms(int32_t * text) {
    // 0x8072675
    if (text == NULL) {
        // 0x80727ae
        return 0;
    }
    int32_t v1 = *(int32_t *)((int32_t)text + 2108);
    if (v1 == 0) {
        // 0x80727ae
        return 0;
    }
    int32_t v2; // 0x8072675
    int32_t v3; // 0x807274b
    int32_t str2; // 0x8072757
    int32_t * v4; // 0x80726ad
    int32_t v5; // 0x80726ad
    int32_t v6; // 0x80726b0
    int32_t str; // 0x8072675
    int32_t strcmp_rc; // 0x8072675
    if (*(char *)(v1 + 27) == 2) {
        // 0x80726aa
        v4 = (int32_t *)(v1 + 28);
        v5 = *v4;
        v6 = *(int32_t *)(v5 + 8);
        if (v6 != 4 == (v6 != 3)) {
            // 0x8072712
            str = *(int32_t *)(v5 + 12);
            strcmp_rc = strcmp((char *)str, (char *)*(int32_t *)(v5 + 16));
            if (v6 != 7) {
                // 0x8072770
                if (strcmp_rc != 0) {
                    // break -> 0x80727ae
                    break;
                }
            } else {
                // 0x8072720
                if (strcmp_rc != 0) {
                    // break -> 0x80727ae
                    break;
                }
                // 0x8072748
                v3 = *v4;
                str2 = *(int32_t *)(v3 + 68);
                if (strcmp((char *)str2, (char *)*(int32_t *)(v3 + 72)) != 0) {
                    // break -> 0x80727ae
                    break;
                }
            }
        } else {
            // 0x80726c6
            v2 = *(int32_t *)(v5 + 32);
            if (*(char *)*(int32_t *)(v5 + 16) != 48) {
                // 0x80726f8
                if (v2 == 0) {
                    // break -> 0x80727ae
                    break;
                }
            } else {
                // 0x80726d6
                if (v2 == 1) {
                    // break -> 0x80727ae
                    break;
                }
            }
        }
    }
    int32_t v7 = *(int32_t *)v1;
    char result = 0; // 0x80727a4
    while (v7 != 0) {
        int32_t v8 = v7;
        if (*(char *)(v8 + 27) == 2) {
            // 0x80726aa
            v4 = (int32_t *)(v8 + 28);
            v5 = *v4;
            v6 = *(int32_t *)(v5 + 8);
            if (v6 != 4 == (v6 != 3)) {
                // 0x8072712
                str = *(int32_t *)(v5 + 12);
                strcmp_rc = strcmp((char *)str, (char *)*(int32_t *)(v5 + 16));
                if (v6 != 7) {
                    // 0x8072770
                    result = 1;
                    if (strcmp_rc != 0) {
                        // break -> 0x80727ae
                        break;
                    }
                } else {
                    // 0x8072720
                    result = 1;
                    if (strcmp_rc != 0) {
                        // break -> 0x80727ae
                        break;
                    }
                    // 0x8072748
                    v3 = *v4;
                    str2 = *(int32_t *)(v3 + 68);
                    result = 1;
                    if (strcmp((char *)str2, (char *)*(int32_t *)(v3 + 72)) != 0) {
                        // break -> 0x80727ae
                        break;
                    }
                }
            } else {
                // 0x80726c6
                v2 = *(int32_t *)(v5 + 32);
                if (*(char *)*(int32_t *)(v5 + 16) != 48) {
                    // 0x80726f8
                    result = 1;
                    if (v2 == 0) {
                        // break -> 0x80727ae
                        break;
                    }
                } else {
                    // 0x80726d6
                    result = 1;
                    if (v2 == 1) {
                        // break -> 0x80727ae
                        break;
                    }
                }
            }
        }
        // 0x8072798
        v7 = *(int32_t *)v8;
        result = 0;
    }
    // 0x80727ae
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80727b4 - 0x8072868
// Line range:    11600 - 11628
void HText_activateRadioButton(int32_t * form) {
    // 0x80727b4
    if (HTMainText == NULL) {
        // 0x8072866
        return;
    }
    int32_t v1 = (int32_t)form;
    int32_t v2 = *(int32_t *)(v1 + 4); // 0x80727bd
    if (g203 == NULL) {
      lab_0x807285c:
        // 0x807285c
        *(int32_t *)(v1 + 32) = 1;
        // 0x8072866
        return;
    }
    int32_t v3 = (int32_t)g203;
    int32_t v4; // 0x80727ff
    int32_t * v5; // 0x80727b4
    int32_t * v6; // 0x80727ee
    int32_t str; // 0x80727ee
    if (*(char *)(v3 + 27) == 2) {
        // 0x80727eb
        v6 = (int32_t *)(v3 + 28);
        str = *v6;
        if (*(int32_t *)(str + 8) == 4) {
            // 0x80727f9
            v4 = *(int32_t *)(str + 4);
            if (v4 != v2) {
                if (v4 > v2) {
                    // break -> 0x807285c
                    break;
                }
            } else {
                // 0x8072807
                if (strcmp((char *)*(int32_t *)str, (char *)*form) == 0) {
                    // 0x8072824
                    v5 = (int32_t *)(*v6 + 32);
                    if (*v5 != 0) {
                        // 0x8072831
                        *v5 = 0;
                        goto lab_0x807285c;
                    }
                }
            }
        }
    }
    int32_t v7 = *(int32_t *)v3; // 0x8072851
    while (v7 != 0) {
        // 0x80727e0
        v3 = v7;
        if (*(char *)(v3 + 27) == 2) {
            // 0x80727eb
            v6 = (int32_t *)(v3 + 28);
            str = *v6;
            if (*(int32_t *)(str + 8) == 4) {
                // 0x80727f9
                v4 = *(int32_t *)(str + 4);
                if (v4 != v2) {
                    if (v4 > v2) {
                        // break -> 0x807285c
                        break;
                    }
                } else {
                    // 0x8072807
                    if (strcmp((char *)*(int32_t *)str, (char *)*form) == 0) {
                        // 0x8072824
                        v5 = (int32_t *)(*v6 + 32);
                        if (*v5 != 0) {
                            // 0x8072831
                            *v5 = 0;
                            goto lab_0x807285c;
                        }
                    }
                }
            }
        }
        // 0x807284e
        v7 = *(int32_t *)v3;
    }
    // 0x807285c
    *(int32_t *)(v1 + 32) = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8072868 - 0x8072897
// Line range:    11688 - 11694
char * stub_HTAnchor_address(int32_t * me) {
    char * result = NULL; // bp-8, 0x807286e
    result = NULL;
    if (me != NULL) {
        // 0x807287b
        HTSACopy(&result, (char *)*(int32_t *)(*me + 4));
    }
    // 0x8072892
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80728ac - 0x80728dc
// Line range:    11704 - 11706
char HText_hasToolbar(int32_t * text) {
    if (text != NULL) {
        // 0x80728b8
        if (*(char *)((int32_t)text + 2133) != 0) {
            // 0x80728d6
            return 1;
        }
    }
    // 0x80728d6
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80728dc - 0x80728f1
// Line range:    11709 - 11713
void HText_setNoCache(int32_t * text) {
    if (text != NULL) {
        // 0x80728e5
        *(char *)((int32_t)text + 2148) = 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80728f1 - 0x8072921
// Line range:    11716 - 11718
char HText_hasNoCacheSet(int32_t * text) {
    if (text != NULL) {
        // 0x80728fd
        if (*(char *)((int32_t)text + 2148) != 0) {
            // 0x807291b
            return 1;
        }
    }
    // 0x807291b
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8072921 - 0x8072951
// Line range:    11721 - 11723
char HText_hasUTF8OutputSet(int32_t * text) {
    if (text != NULL) {
        // 0x807292d
        if (*(char *)((int32_t)text + 2251) != 0) {
            // 0x807294b
            return 1;
        }
    }
    // 0x807294b
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8072c7e - 0x8072e14
// Line range:    11862 - 11951
char HText_AreDifferent(int32_t * anchor, char * full_address) {
    // 0x8072c7e
    if (LYCacheSourceForAborted == 0 || full_address != NULL != (anchor != NULL == (HTMainText != NULL))) {
        // 0x8072e0e
        return 1;
    }
    int32_t v1 = (int32_t)anchor;
    int32_t * str2 = (int32_t *)(v1 + 16); // 0x8072cb9
    if (*str2 == 0 || strchr((char *)(0x1000000 * (int32_t)full_address >> 24), 35) == NULL || strncasecomp((char *)(0x1000000 * *str2 >> 24), "LYNXIMGMAP:", 11) == 0 || g191 != *(char *)(v1 + 85)) {
        // 0x8072e0e
        return 1;
    }
    int32_t v2 = strncasecomp((char *)(0x1000000 * LYCacheSourceForAborted >> 24), "LYNXIMGMAP:", 11); // 0x8072d48
    int32_t v3 = LYCacheSourceForAborted;
    int32_t v4 = v2 != 0 ? v3 : v3 + 11;
    char * str = (char *)(0x1000000 * v4 >> 24); // 0x8072d74
    char * v5 = trimPoundSelector(str); // 0x8072d74
    if (strcmp(str, (char *)*str2) != 0) {
        // 0x8072d95
        if (v5 != NULL) {
            // 0x8072d9b
            *v5 = 35;
        }
        // 0x8072e0e
        return 1;
    }
    if (v5 != NULL) {
        // 0x8072dad
        *v5 = 35;
    }
    // 0x8072db3
    if (LYCacheSourceForAborted != v4) {
        // 0x8072e0e
        return 0;
    }
    int32_t v6 = *(int32_t *)&LYShowScrollbar; // 0x8072dc1
    int32_t v7 = *(int32_t *)(v1 + 20);
    if (v6 == 0) {
        // 0x8072dfa
        if (v7 == 0) {
            // 0x8072e0e
            return 0;
        }
        // 0x8072e0e
        return 1;
    }
    // 0x8072dc8
    if (v7 == 0) {
        // 0x8072e0e
        return 1;
    }
    // 0x8072dd2
    if (HTSABEql((int32_t *)(0x1000000 * v6 >> 24), (int32_t *)v7) != 0) {
        // 0x8072e0e
        return 0;
    }
    // 0x8072e0e
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8072e14 - 0x80735ac
// Line range:    11982 - 12223
int32_t increment_tagged_htline(int32_t * ht, int32_t * a, int32_t * lx_val, int32_t * old_val, int32_t incr, int32_t mode) {
    char lxbuf[2048]; // bp-3088, 0x8072e14
    char v1[2048]; // 0x8072f2d
    char v2[2048]; // 0x8072e52
    char v3[2048]; // 0x807315a
    int32_t v4 = (int32_t)a;
    int32_t v5 = __readgsdword(20); // 0x8072e41
    v2[0] = v4;
    lxbuf = v2;
    int32_t v6 = *lx_val; // 0x8072e96
    int32_t v7 = 0; // 0x8072e9a
    if (v6 != 0) {
        int32_t v8 = *(int32_t *)&lxbuf;
        if (v8 == 0) {
            // 0x8072efe
            *lx_val = 0;
            v7 = v6;
        } else {
            int32_t v9 = v8;
            while (*(int32_t *)(v9 + 16) == *(int32_t *)(v4 + 16)) {
                int16_t * v10 = (int16_t *)(v9 + 20); // 0x8072eb4
                *v10 = *v10 + (int16_t)*lx_val;
                v9 = *(int32_t *)v9;
                if (v9 == 0) {
                    // break -> 0x8072efe
                    break;
                }
            }
            int32_t v11 = *(int32_t *)&lxbuf;
            int32_t v12 = *lx_val; // 0x8072f04
            *lx_val = 0;
            v7 = v12;
            if (v11 != 0) {
                // 0x8072f25
                v1[0] = (char)*(int32_t *)v11;
                lxbuf = v1;
                v7 = v12;
            }
        }
    }
    int32_t v13 = (int32_t)ht;
    int32_t v14 = v13 + 18;
    int32_t * str6 = (int32_t *)v14;
    int32_t str3; // bp-1032, 0x8072e14
    int32_t * str9 = &str3;
    char v15 = 0;
    int32_t * v16; // 0x8072e14
    int32_t * v17; // 0x8072e14
    int32_t * v18; // 0x8072e14
    char v19; // 0x8072e14
    char v20; // 0x8072e14
    int32_t v21; // 0x8072e14
    int32_t v22; // 0x8072e14
    int32_t v23; // 0x8072ff7
    int32_t str_as_i; // 0x8073039
    while (true) {
      lab_0x80733c7:
        // 0x80733c7
        v20 = v15;
        char v24 = *(char *)str6; // 0x80733cd
        v17 = str9;
        if (v24 == 0) {
            // break (via goto) -> 0x80733d8
            goto lab_0x80733d8;
        }
        // 0x8072f38
        *(char *)str9 = v24;
        v21 = (int32_t)str9 + 1;
        int32_t * v25 = (int32_t *)v21;
        v22 = (int32_t)str6 + 1;
        int32_t * v26 = (int32_t *)v22;
        int32_t * v27 = v26; // 0x8072f43
        int32_t * v28 = v25; // 0x8072f43
        while (v24 != 91) {
            // 0x80733c7
            v24 = *(char *)v27;
            v17 = v28;
            if (v24 == 0) {
                // break (via goto) -> 0x80733d8
                goto lab_0x80733d8;
            }
            // 0x8072f38
            *(char *)v28 = v24;
            v21 = (int32_t)v28 + 1;
            v25 = (int32_t *)v21;
            v22 = (int32_t)v27 + 1;
            v26 = (int32_t *)v22;
            v27 = v26;
            v28 = v25;
        }
        char * str = (char *)v22; // 0x8072f8e
        char v29 = *str; // 0x807300f
        char * v30 = str; // 0x8073014
        char v31 = v29; // 0x8073014
        char * v32 = NULL; // 0x8073014
        v19 = v20;
        v18 = v26;
        v16 = v25;
        if (v29 != 93) {
            v19 = 1;
            v18 = v26;
            v16 = v25;
            while (v31 != 0) {
                char * v33 = v30; // 0x8072fcb
                int16_t v34 = *(int16_t *)(2 * (int32_t)*v33 + (int32_t)*__ctype_b_loc()); // 0x8072fdc
                v19 = v20;
                v18 = v26;
                v16 = v25;
                if ((v34 & 2048) == 0) {
                    // break -> 0x8073160
                    break;
                }
                char * v35 = (char *)((int32_t)v33 + 1); // 0x8072fec
                v23 = (int32_t)v32 + 1;
                char * v36 = (char *)v23;
                char v37 = *v35; // 0x807300f
                v30 = v35;
                v31 = v37;
                v32 = v36;
                if (v37 == 93) {
                    // 0x8073016
                    v19 = v20;
                    v18 = v26;
                    v16 = v25;
                    if (v36 < (char *)1) {
                        goto lab_0x8073160;
                    } else {
                        // 0x8073030
                        str_as_i = atoi(str);
                        int32_t v38 = *old_val; // 0x807304a
                        v19 = v20;
                        v18 = v26;
                        v16 = v25;
                        if (v38 != str_as_i == (v38 != 0)) {
                            goto lab_0x8073160;
                        } else {
                            if (v38 == 0) {
                                goto lab_0x8073083;
                            } else {
                                // 0x8073070
                                *old_val = v38 + 1;
                                goto lab_0x8073083;
                            }
                        }
                    }
                }
                v19 = 1;
                v18 = v26;
                v16 = v25;
            }
        }
        goto lab_0x8073160;
    }
  lab_0x80733d8:
    // 0x80733d8
    *(char *)v17 = 0;
    char * str2 = (char *)v14;
    int32_t len = strlen(str2); // 0x80733ed
    char * str4; // 0x8072e14
    if (mode != 1) {
        uint32_t len2 = strlen((char *)&str3); // 0x807341d
        str4 = str2;
        if (len2 > (int32_t)*(int16_t *)(v13 + 10)) {
            int32_t len3 = strlen((char *)&str3); // 0x8073442
            int32_t * v39 = ALLOC_IN_POOL((int32_t **)&g216, len3 + 20); // 0x807345b
            if (v39 == NULL) {
                // 0x807346f
                outofmem("./GridText.c", "increment_tagged_htline");
                // UNREACHABLE
            }
            int32_t v40 = (int32_t)v39; // 0x807345b
            memcpy(v39, ht, 20);
            int16_t * v41 = (int16_t *)(v13 + 16); // 0x80734a9
            int32_t * v42 = ALLOC_IN_POOL((int32_t **)&g216, 4 * (int32_t)*v41); // 0x80734c8
            *(int32_t *)(v40 + 12) = (int32_t)v42;
            if (v42 == NULL) {
                // 0x80734e5
                outofmem("./GridText.c", "increment_tagged_htline");
                // UNREACHABLE
            }
            // 0x80734f9
            memcpy(v42, (int32_t *)*(int32_t *)(v13 + 12), 4 * (int32_t)*v41);
            *(int32_t *)*(int32_t *)(v40 + 4) = v40;
            *(int32_t *)(*v39 + 4) = v40;
            str4 = (char *)(v40 + 18);
        }
    } else {
        // 0x80733fe
        *(char *)(len + (int32_t)&str3) = 0;
        str4 = str2;
    }
    char * str5 = (char *)&str3;
    strcpy(str4, str5);
    int32_t result = v7 - len + strlen(str5); // 0x80735a3
    if (v5 != __readgsdword(20)) {
        // 0x80735a5
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80735aa
    return result;
  lab_0x8073160:
    // 0x8073160
    str9 = v16;
    str6 = v18;
    v15 = v19;
    int32_t len4 = strlen((char *)str6); // 0x8073169
    int32_t len5 = strlen((char *)(*ht + 18)); // 0x8073182
    int32_t v43; // 0x8072e14
    char * v44; // 0x8072e14
    int32_t str7; // bp-3080, 0x8072e14
    char * v45; // 0x8072e14
    int32_t v46; // 0x8072e14
    if (v15 != 0) {
        // 0x807319a
        v46 = len5 + 2;
        if (v46 + len4 <= 2047) {
            // 0x80731b6
            strcpy((char *)&str7, (char *)str6);
            strcat((char *)&str7, (char *)(*ht + 18));
            v43 = &str7;
            v44 = (char *)&str7;
            v45 = NULL;
            v17 = str9;
            if (*(char *)&str7 != 93) {
                goto lab_0x807320a;
            } else {
                goto lab_0x80733d8;
            }
        }
    }
    // 0x80733c7
    goto lab_0x80733c7;
  lab_0x8073083:;
    char * str8 = (char *)v21;
    sprintf(str8, "%d", str_as_i + incr);
    int32_t len6 = strlen(str8); // 0x80730b5
    int32_t * v47 = (int32_t *)(len6 + v21); // 0x80730c6
    int32_t * v48 = (int32_t *)(v23 + v22); // 0x80730d2
    int32_t v49 = len6 - v23; // 0x80730de
    v19 = v20;
    v18 = v48;
    v16 = v47;
    int32_t v50; // 0x8072e14
    int16_t v51; // 0x8072e14
    if (v49 == 0) {
        goto lab_0x8073160;
    } else {
        int32_t v52 = *(int32_t *)&lxbuf;
        v19 = v20;
        v18 = v48;
        v16 = v47;
        if (v52 == 0) {
            goto lab_0x8073160;
        } else {
            // 0x8073133
            v51 = v49;
            v50 = v52;
            goto lab_0x8073133_2;
        }
    }
  lab_0x8073133_2:;
    int32_t v53 = v50;
    if (*(int32_t *)(v53 + 16) == *(int32_t *)(v4 + 16)) {
        int16_t * v54 = (int16_t *)(v53 + 20); // 0x8073101
        *v54 = *v54 + v51;
        int32_t v55 = *(int32_t *)v53;
        v50 = v55;
        if (v55 == 0) {
            goto lab_0x8073149;
        } else {
            goto lab_0x8073133_2;
        }
    } else {
        goto lab_0x8073149;
    }
  lab_0x8073149:;
    int32_t v56 = *(int32_t *)&lxbuf;
    v19 = v20;
    v18 = v48;
    v16 = v47;
    if (v56 == 0) {
        goto lab_0x8073160;
    } else {
        // 0x8073152
        v3[0] = (char)*(int32_t *)v56;
        lxbuf = v3;
        v19 = v20;
        v18 = v48;
        v16 = v47;
        goto lab_0x8073160;
    }
  lab_0x807320a:;
    int16_t v57 = *(int16_t *)(2 * (int32_t)*v44 + (int32_t)*__ctype_b_loc()); // 0x8073222
    v17 = str9;
    int32_t v58; // 0x807323d
    int32_t str_as_i2; // 0x807329b
    if ((v57 & 2048) == 0) {
        goto lab_0x80733d8;
    } else {
        char * v59 = (char *)((int32_t)v44 + 1); // 0x8073232
        v58 = (int32_t)v45 + 1;
        char * v60 = (char *)v58;
        v44 = v59;
        v45 = v60;
        if (*v59 != 93) {
            goto lab_0x807320a;
        } else {
            // 0x807325c
            v17 = str9;
            if (v60 < (char *)1 || v58 + v46 > 1023) {
                goto lab_0x80733d8;
            } else {
                // 0x8073292
                str_as_i2 = atoi((char *)&str7);
                int32_t v61 = *old_val; // 0x80732ac
                v17 = str9;
                if (v61 != str_as_i2 == (v61 != 0)) {
                    goto lab_0x80733d8;
                } else {
                    if (v61 == 0) {
                        goto lab_0x80732e5;
                    } else {
                        // 0x80732d2
                        *old_val = v61 + 1;
                        goto lab_0x80732e5;
                    }
                }
            }
        }
    }
  lab_0x80732e5:
    // 0x80732e5
    sprintf((char *)&str7, "%d", str_as_i2 + incr);
    int32_t len7 = strlen((char *)&str7); // 0x8073317
    strcat((char *)&str7, strchr((char *)(*ht + 18), 93));
    char * dest_str = strncpy((char *)str9, (char *)&str7, len4); // 0x807336c
    strcpy((char *)(*ht + 18), (char *)(len4 + v43));
    *lx_val = len7 - v58;
    v17 = (int32_t *)(len4 + (int32_t)dest_str);
    goto lab_0x80733d8;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80735ac - 0x80738e4
// Line range:    12236 - 12347
void insert_new_textarea_anchor(int32_t ** curr_anchor, int32_t ** exit_htline) {
    int32_t * v1 = *curr_anchor; // 0x80735b5
    int32_t v2 = (int32_t)v1; // 0x80735b5
    int32_t * f = NULL; // bp-28, 0x80735cf
    int32_t * l = NULL; // bp-32, 0x80735d6
    int32_t v3 = (int32_t)HTMainAnchor;
    int32_t * anchor; // bp-12, 0x80735ac
    *(int32_t *)&anchor = v3;
    int32_t * v4 = (int32_t *)(v2 + 16); // 0x807360f
    if (*v4 != 0) {
        int32_t v5 = 0; // 0x8073608
        int32_t v6 = *HTMainAnchor; // 0x80735f6
        int32_t * v7 = (int32_t *)v6; // 0x80735f8
        anchor = v7;
        while (v6 != v3) {
            // 0x807360c
            v5++;
            if (*v4 == v5) {
                // break -> 0x8073617
                break;
            }
            v6 = *v7;
            v7 = (int32_t *)v6;
            anchor = v7;
        }
    }
    int32_t * v8 = ALLOC_IN_POOL((int32_t **)&g216, 1044); // 0x807362c
    int32_t * v9 = ALLOC_IN_POOL((int32_t **)&g216, 52); // 0x8073649
    int32_t * v10 = ALLOC_IN_POOL((int32_t **)&g216, 96); // 0x8073666
    if (v8 != NULL == (v9 != NULL) != v10 != NULL) {
        // 0x8073680
        outofmem("./GridText.c", "insert_new_textarea_anchor");
        // UNREACHABLE
    }
    // 0x8073694
    *v9 = *v1;
    int32_t v11 = (int32_t)v9; // 0x80736a4
    int32_t * v12 = (int32_t *)(v11 + 12); // 0x80736a7
    *v12 = *(int32_t *)(v2 + 12);
    *(int16_t *)(v11 + 20) = *(int16_t *)(v2 + 20);
    *(int16_t *)(v11 + 22) = *(int16_t *)(v2 + 22);
    *(int32_t *)(v11 + 8) = SGML_offset();
    *(int32_t *)(v11 + 16) = *v4 + 1;
    LYCopyHiText(v9, v1);
    *(char *)(v11 + 27) = *(char *)(v2 + 27);
    int32_t v13 = (int32_t)v10; // 0x8073704
    *(int32_t *)(v11 + 28) = v13;
    *(char *)(v11 + 24) = *(char *)(v2 + 24);
    *(char *)(v11 + 25) = *(char *)(v2 + 25);
    *(char *)(v11 + 26) = 1;
    *(int32_t *)(v11 + 48) = 0;
    int32_t * v14 = (int32_t *)(v2 + 28); // 0x8073738
    HTSACopy((char **)v10, (char *)*(int32_t *)*v14);
    *(int32_t *)(v13 + 4) = *(int32_t *)(*v14 + 4);
    *(int32_t *)(v13 + 8) = *(int32_t *)(*v14 + 8);
    HTSACopy((char **)(v13 + 16), (char *)&g12);
    *(int32_t *)(v13 + 20) = *(int32_t *)(*v14 + 20);
    *(int32_t *)(v13 + 24) = *(int32_t *)(*v14 + 24);
    *(char *)(v13 + 64) = *(char *)(*v14 + 64);
    *(int32_t *)(v13 + 80) = *(int32_t *)(*v14 + 80);
    *(int32_t *)(v13 + 88) = current_char_set;
    *v8 = *anchor;
    int32_t v15 = (int32_t)v8; // 0x80737d3
    *(int32_t *)(v15 + 4) = (int32_t)anchor;
    *(int16_t *)(v15 + 8) = *(int16_t *)((int32_t)anchor + 8);
    *(int16_t *)(v15 + 10) = *(int16_t *)((int32_t)anchor + 10);
    *(int16_t *)(v15 + 16) = *(int16_t *)((int32_t)anchor + 16);
    *(int32_t *)(v15 + 12) = *(int32_t *)((int32_t)anchor + 12);
    strcpy((char *)(v15 + 18), (char *)((int32_t)anchor + 18));
    *(int32_t *)(*anchor + 4) = v15;
    *anchor = v15;
    int32_t v16 = keypad_mode; // 0x807383d
    if (v16 != 3 != v16 != 2) {
        // 0x8073851
        *v12 = *v12 + 1;
        increment_tagged_htline(v8, v9, (int32_t *)&l, (int32_t *)&f, 1, 1);
    }
    // 0x8073890
    if (g204 == v2) {
        // 0x80738a0
        g204 = v11;
    }
    // 0x80738af
    if (HTMainAnchor == anchor) {
        // 0x80738bc
        *(int32_t *)&HTMainAnchor = v15;
    }
    // 0x80738c8
    *v1 = v11;
    *(int32_t *)curr_anchor = v11;
    *(int32_t *)exit_htline = *v8;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80738e4 - 0x8073ae9
// Line range:    12367 - 12493
void update_subsequent_anchors(int32_t newlines, int32_t * start_anchor, int32_t * start_htline, int32_t start_tag) {
    int32_t v1 = start_tag;
    int32_t line_adj = 0; // bp-24, 0x80738fe
    if (WWW_TraceFlag != 0) {
        // 0x807391e
        fprintf(TraceFP(), "GridText: adjusting struct's to add %d new line(s)\n", newlines);
    }
    int32_t v2 = *start_anchor;
    int32_t v3 = keypad_mode;
    bool v4 = v3 != 3 == (v3 != 2); // 0x8073992
    if (v2 != 0) {
        int32_t * v5; // 0x807395d
        int32_t v6; // 0x807395d
        if (v3 != 3 != v3 != 2) {
            // 0x807395a
            v5 = (int32_t *)(v2 + 12);
            v6 = *v5;
            if (v6 != 0) {
                // 0x8073964
                *v5 = v6 + newlines;
            }
        }
        int32_t * v7 = (int32_t *)(v2 + 16); // 0x8073978
        *v7 = *v7 + newlines;
        int32_t v8 = *(int32_t *)v2;
        int32_t v9 = keypad_mode;
        v4 = v9 != 3 == (v9 != 2);
        while (v8 != 0) {
            int32_t v10 = v8;
            if (v9 != 3 != v9 != 2) {
                // 0x807395a
                v5 = (int32_t *)(v10 + 12);
                v6 = *v5;
                if (v6 != 0) {
                    // 0x8073964
                    *v5 = v6 + newlines;
                }
            }
            // 0x8073975
            v7 = (int32_t *)(v10 + 16);
            *v7 = *v7 + newlines;
            v8 = *(int32_t *)v10;
            v9 = keypad_mode;
            v4 = v9 != 3 == (v9 != 2);
        }
    }
    // 0x8073994
    if (!v4) {
        // 0x80739ac
        if (HTMainAnchor != start_htline) {
            int32_t * v11 = start_htline; // 0x8073a4d
            int32_t v12 = *start_anchor;
            if (v12 == 0) {
                // break (via goto) -> 0x8073a5f
                goto lab_0x8073a5f;
            }
            int32_t v13 = 0;
            int32_t v14; // 0x80739cb
            int32_t v15; // 0x80739d2
            while (*(int32_t *)(v12 + 12) - newlines != v1) {
                // 0x80739cb
                v14 = v13 + 1;
                v15 = *(int32_t *)v12;
                if (v14 < 0x186a0 != v15 != v12) {
                    // 0x8073ace
                    HTAlert(gettext("Hang Detect: TextAnchor struct corrupted - suggest aborting!"));
                    goto lab_0x8073a5f;
                }
                v12 = v15;
                if (v12 == 0) {
                    // break (via goto) -> 0x8073a5f
                    goto lab_0x8073a5f;
                }
                // 0x80739b9
                v13 = v14;
            }
            int32_t v16 = increment_tagged_htline(v11, (int32_t *)v12, &line_adj, &v1, newlines, 0); // 0x8073a27
            int16_t * v17 = (int16_t *)((int32_t)v11 + 10); // 0x8073a32
            *v17 = *v17 + (int16_t)v16;
            v11 = (int32_t *)*v11;
            while (HTMainAnchor != v11) {
                // 0x80739f1
                if (v12 == 0) {
                    // break (via goto) -> 0x8073a5f
                    goto lab_0x8073a5f;
                }
                // 0x80739b9
                while (*(int32_t *)(v12 + 12) - newlines != v1) {
                    // 0x80739cb
                    v14 = v13 + 1;
                    v15 = *(int32_t *)v12;
                    if (v14 < 0x186a0 != v15 != v12) {
                        // 0x8073ace
                        HTAlert(gettext("Hang Detect: TextAnchor struct corrupted - suggest aborting!"));
                        goto lab_0x8073a5f;
                    }
                    v12 = v15;
                    if (v12 == 0) {
                        // break (via goto) -> 0x8073a5f
                        goto lab_0x8073a5f;
                    }
                    // 0x80739b9
                    v13 = v14;
                }
                // 0x80739fd
                v16 = increment_tagged_htline(v11, (int32_t *)v12, &line_adj, &v1, newlines, 0);
                v17 = (int16_t *)((int32_t)v11 + 10);
                *v17 = *v17 + (int16_t)v16;
                v11 = (int32_t *)*v11;
            }
        }
    }
    goto lab_0x8073a5f;
  lab_0x8073a5f:
    // 0x8073a5f
    nlinks += newlines;
    g202 += newlines;
    g206 += newlines;
    more_text = HText_canScrollDown();
    if (WWW_TraceFlag != 0) {
        // 0x8073ab5
        fprintf(TraceFP(), "GridText: TextAnchor and HTLine struct's adjusted\n");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8073ae9 - 0x8073b4e
// Line range:    12510 - 12515
char IsFormsTextarea(int32_t * form, int32_t * anchor_ptr) {
    int32_t v1 = (int32_t)anchor_ptr;
    if (*(char *)(v1 + 27) != 2) {
        // 0x8073b48
        return 0;
    }
    int32_t str = *(int32_t *)(v1 + 28); // 0x8073afd
    if (*(int32_t *)(str + 8) != 9 || *(int32_t *)(str + 4) != *(int32_t *)((int32_t)form + 4)) {
        // 0x8073b48
        return 0;
    }
    // 0x8073b1b
    if (strcmp((char *)*(int32_t *)str, (char *)*form) == 0) {
        // 0x8073b48
        return 1;
    }
    // 0x8073b48
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8073b4e - 0x8074412
// Line range:    12520 - 12763
int32_t finish_ExtEditForm(int32_t * form_link, int32_t * start_anchor, char * ed_temp, int32_t orig_cnt) {
    int32_t * fp = NULL; // bp-24, 0x8073b57
    int32_t v1 = *(int32_t *)((int32_t)form_link + 44); // 0x8073b65
    int32_t exit_line = 0; // bp-40, 0x8073b79
    if (WWW_TraceFlag != 0) {
        // 0x8073bae
        fprintf(TraceFP(), "GridText: entered HText_ExtEditForm()\n");
    }
    // 0x8073bc5
    int32_t v2; // 0x8073b4e
    char * v3; // 0x8073b4e
    int32_t v4; // 0x8073b4e
    char * v5; // 0x8073b4e
    char v6; // 0x8073b4e
    int32_t v7; // 0x8073b4e
    int32_t v8; // 0x8073b4e
    int32_t v9; // bp-188, 0x8073b4e
    int32_t v10; // 0x8073c57
    if (stat64((int32_t)ed_temp, &v9) < 0) {
        goto lab_0x8073c05;
    } else {
        int32_t nmemb; // 0x8073b4e
        if (nmemb != 0 == (nmemb & 0xf000) == 0x8000) {
            int32_t * mem = calloc(nmemb + 1, 1); // 0x8073c57
            if (mem == NULL) {
                // 0x8073c65
                HTAlwaysAlert(NULL, gettext("Not enough memory for file!"));
                // 0x807440a
                return 0;
            }
            // 0x8073cf2
            v10 = (int32_t)mem;
            struct _IO_FILE * stream = fopen64(ed_temp, "r"); // 0x8073c9e
            int32_t items_read = fread(mem, 1, nmemb, stream); // 0x8073cc2
            LYCloseInput(stream);
            *(char *)(items_read + v10) = 0;
            v8 = items_read;
            v7 = v10;
            if (items_read != 0) {
                while (true) {
                  lab_0x8073cfc:;
                    int32_t v11 = v8;
                    if (LYtrimInputFields == 0) {
                        int32_t v12 = v11 - 1;
                        char * v13 = (char *)(v12 + v10);
                        char v14 = *v13;
                        v5 = v13;
                        v4 = v12;
                        v6 = v14;
                        v3 = v13;
                        v2 = v12;
                        if (v14 != 13 == (v14 != 10)) {
                            goto lab_0x8073d78;
                        } else {
                            goto lab_0x8073ce2;
                        }
                    } else {
                        int16_t * v15 = *__ctype_b_loc(); // 0x8073d0c
                        int32_t v16 = v11 - 1;
                        char * v17 = (char *)(v16 + v10);
                        unsigned char v18 = *v17; // 0x8073d17
                        v5 = v17;
                        v4 = v16;
                        v6 = v18;
                        v3 = v17;
                        v2 = v16;
                        if ((*(int16_t *)(2 * (int32_t)v18 + (int32_t)v15) & 0x2000) != 0) {
                            goto lab_0x8073ce2;
                        } else {
                            goto lab_0x8073d78;
                        }
                    }
                }
            }
            goto lab_0x8073d8c_3;
        } else {
            goto lab_0x8073c05;
        }
    }
  lab_0x807415b:;
    // 0x807415b
    int32_t v19; // 0x8073b4e
    int32_t v20 = v19;
    int32_t v21; // 0x8073b4e
    int32_t v22 = v21;
    int32_t v23; // 0x8073b4e
    int32_t v24 = v23;
    int32_t v25; // 0x8073b4e
    int32_t v26 = v20 + v25;
    int32_t v27 = v26; // 0x807415f
    int32_t v28 = v22; // 0x807415f
    int32_t v29 = v24; // 0x807415f
    int32_t v30; // 0x8073b4e
    int32_t v31 = v30; // 0x807415f
    int32_t v32 = v20; // 0x807415f
    bool v33; // 0x8073b4e
    char * str; // 0x8073b4e
    if (v33 == v26 > v30) {
        int32_t v34 = (int32_t)str;
        int32_t v35 = v20;
        v27 = v26;
        v28 = v22;
        v29 = v24;
        v31 = v30;
        v32 = v20;
        while (v35 + v25 > v30) {
            // 0x807418e
            v35--;
            int16_t * v36 = *__ctype_b_loc(); // 0x8074193
            unsigned char v37 = *(char *)(v35 + v34); // 0x807419b
            if ((*(int16_t *)(2 * (int32_t)v37 + (int32_t)v36) & 0x2000) == 0) {
                v27 = v30;
                v28 = v22;
                v29 = v24;
                v31 = v30;
                v32 = v30 - v25;
                goto lab_0x80741d4;
            }
            v27 = v26;
            v28 = v22;
            v29 = v24;
            v31 = v30;
            v32 = v20;
        }
    }
    goto lab_0x80741d4;
  lab_0x8073f46:;
    // 0x8073f46
    int32_t v88; // 0x8073b4e
    v30 = v88;
    v33 = v30 > 0;
    v23 = 0;
    int32_t v85; // 0x8073b4e
    v21 = v85;
    int32_t v86; // 0x8073b4e
    v19 = v86;
    char * v94; // 0x8073b4e
    int32_t v100; // 0x8073b4e
    int32_t v87; // 0x8073b4e
    if (v30 > 0 == v87 > v30) {
        int32_t v104 = v30 / 4;
        v33 = true;
        v23 = 0;
        v21 = v85;
        v19 = v86;
        if (v30 < v104) {
            goto lab_0x807415b;
        } else {
            int32_t v105 = (int32_t)str;
            int32_t v106 = v30 - v25;
            int16_t * v107 = *__ctype_b_loc(); // 0x8073f7b
            int32_t v108 = v106 + v105; // 0x8073f80
            char * v109 = (char *)v108;
            while ((*(int16_t *)(2 * (int32_t)*v109 + (int32_t)v107) & 0x2000) == 0) {
                int32_t v110 = v106 - 1; // 0x8074136
                v33 = true;
                v23 = 0;
                v21 = v85;
                v19 = v86;
                if (v110 + v25 < v104) {
                    goto lab_0x807415b;
                }
                v106 = v110;
                v107 = *__ctype_b_loc();
                v108 = v106 + v105;
                v109 = (char *)v108;
            }
            int32_t v111 = v106 + 1; // 0x8073fa4
            char * v112 = (char *)(v108 + 1); // 0x8073fb9
            int32_t v113 = v111; // 0x8073fbe
            char * v114 = v109; // 0x8073fbe
            if (*v112 != 10) {
                int16_t v115 = *(int16_t *)(2 * (int32_t)*v112 + (int32_t)*__ctype_b_loc()); // 0x8073fd8
                v113 = v111;
                v114 = v109;
                if ((v115 & 0x2000) != 0) {
                    int16_t * v116 = *__ctype_b_loc(); // 0x8073fec
                    unsigned char v117 = *(char *)(v108 + 2); // 0x8073ff4
                    int16_t v118 = *(int16_t *)(2 * (int32_t)v117 + (int32_t)v116); // 0x8073fff
                    v113 = (v118 & 0x2000) != 0 ? v111 : v106 + 2;
                    v114 = (v118 & 0x2000) != 0 ? v109 : v112;
                }
            }
            char * v119 = v114;
            v100 = v113;
            int16_t * v120 = *__ctype_b_loc(); // 0x807401b
            unsigned char v121 = *(char *)((int32_t)v119 + 1); // 0x8074023
            v33 = true;
            v23 = 0;
            v21 = v85;
            v19 = v100;
            if ((*(int16_t *)(2 * (int32_t)v121 + (int32_t)v120) & 0x2000) != 0) {
                goto lab_0x807415b;
            } else {
                int32_t v122 = 3 * v30;
                int32_t v123 = v100 + ((v122 >> 31) / 0x40000000 + v122) / 4;
                char * v124 = v119; // 0x8073b4e
                char * v125; // 0x8073b4e
                char v126; // 0x807404a
                while (true) {
                  lab_0x8074047:
                    // 0x8074047
                    v125 = v124;
                    v126 = *v125;
                    switch (v126) {
                        case 0: {
                            goto lab_0x807408d;
                        }
                        case 13: {
                            goto lab_0x807408d;
                        }
                        case 10: {
                            goto lab_0x807408d;
                        }
                        default: {
                            int32_t v127 = (int32_t)v125; // 0x8074065
                            if (v127 - v105 > v123) {
                                // break -> 0x807408d
                                break;
                            }
                            // 0x8074043
                            v124 = (char *)(v127 + 1);
                            goto lab_0x8074047;
                        }
                    }
                }
              lab_0x807408d:;
                char v128 = v126; // 0x8074095
                v94 = v125;
                if (v126 == 13) {
                    char * v129 = (char *)((int32_t)v125 + 1); // 0x807409d
                    char * v130 = *v129 != 10 ? v125 : v129;
                    v128 = *v130;
                    v94 = v130;
                }
                // 0x80740a8
                v33 = true;
                v23 = 0;
                v21 = v85;
                v19 = v100;
                if (v128 != 10) {
                    goto lab_0x807415b;
                } else {
                    char * v131 = (char *)((int32_t)v94 + 1); // 0x80740bc
                    switch (*v131) {
                        case 13: {
                            goto lab_0x80740f7;
                        }
                        case 10: {
                            goto lab_0x80740f7;
                        }
                        default: {
                            int16_t v132 = *(int16_t *)(2 * (int32_t)*v131 + (int32_t)*__ctype_b_loc()); // 0x80740e8
                            if ((v132 & 0x2000) != 0) {
                                goto lab_0x807415b;
                            } else {
                                goto lab_0x80740f7;
                            }
                        }
                    }
                }
            }
        }
    } else {
        goto lab_0x807415b;
    }
  lab_0x80741d4:;
    int32_t v38 = v32;
    int32_t v39 = v27;
    int32_t v40 = v39; // 0x80741e2
    int32_t n = v38; // 0x80741e2
    char v41; // 0x8073b4e
    char v42 = v41; // 0x80741e2
    if (v39 >= 1024) {
        char v43 = v41; // 0x80741ec
        if (v41 == 0) {
            // 0x80741ee
            LYFixCursesOn("show alert:");
            HTAlert(gettext("Very long lines have been wrapped!"));
            v43 = 1;
        }
        int32_t v44 = 1023 - v25; // 0x8074217
        int32_t v45 = v39; // 0x8074256
        int32_t v46 = v38; // 0x8074256
        if (v44 >= 0 == (v44 != 0)) {
            int32_t v47 = v44;
            int16_t * v48 = *__ctype_b_loc(); // 0x8074224
            unsigned char v49 = *(char *)(v47 + (int32_t)str); // 0x807422c
            while ((*(int16_t *)(2 * (int32_t)v49 + (int32_t)v48) & 0x2000) == 0) {
                int32_t v50 = v47 - 1; // 0x807424e
                v45 = v39;
                v46 = v38;
                if (v50 >= 0 != v50 != 0) {
                    goto lab_0x8074258;
                }
                v47 = v50;
                v48 = *__ctype_b_loc();
                v49 = *(char *)(v47 + (int32_t)str);
            }
            // 0x807421f
            v45 = v47 + v25;
            v46 = v47;
        }
      lab_0x8074258:;
        int32_t v51 = v45 < 1024 ? v46 : v44;
        v40 = v51 + v25;
        n = v51;
        v42 = v43;
    }
    // 0x8074273
    int32_t * mem3; // 0x8073d93
    strncat((char *)mem3, str, n);
    int32_t v52; // 0x8073b4e
    *(char *)(v40 + v52) = 0;
    char * v53; // 0x8073b4e
    char * v54 = v53; // 0x80742a1
    int32_t v55; // 0x8073b4e
    int32_t v56 = v55; // 0x80742a1
    int32_t v57; // 0x8073b4e
    if (v57 > orig_cnt) {
        // 0x80742a3
        insert_new_textarea_anchor(&fp, (int32_t **)&exit_line);
        v54 = (char *)((int32_t)v53 + 1);
        v56 = (int32_t)fp;
    }
    int32_t v58 = v56;
    HTSACopy((char **)(*(int32_t *)(v58 + 28) + 12), (char *)mem3);
    int32_t * v59 = NULL; // 0x80742e1
    int32_t * v60; // 0x8073b4e
    if (v40 < 1) {
        // 0x80742ec
        v59 = v60;
        if (v60 == NULL) {
            // 0x80742f2
            v59 = (int32_t *)*(int32_t *)(v58 + 16);
        }
    }
    int32_t v61 = n + (int32_t)str; // 0x80742fe
    char * v62 = (char *)v61; // 0x80742fe
    char * v63 = v62; // 0x8074309
    if (*v62 != 0) {
        int16_t v64 = *(int16_t *)(2 * (int32_t)*v62 + (int32_t)*__ctype_b_loc()); // 0x8074320
        v63 = v62;
        if ((v64 & 0x2000) != 0) {
            // 0x807432f
            v63 = (char *)(v61 + 1);
        }
    }
    int32_t * v65 = (int32_t *)v58; // 0x8074336
    fp = v65;
    int32_t v66 = *v65; // 0x807433c
    char * v67; // 0x8073b4e
    char * v68 = v67; // 0x8074345
    if (v66 != 0) {
        // 0x8074347
        v68 = (char *)*(int32_t *)(v66 + 12);
    }
    char * v69 = v68; // 0x8074350
    char * v70 = v54; // 0x8074350
    int32_t v71 = v31; // 0x8074350
    int32_t v72 = v29; // 0x8074350
    int32_t v73 = v28; // 0x8074350
    int32_t v74 = v57 + 1; // 0x8074350
    int32_t * v75 = v59; // 0x8074350
    int32_t v76 = v66; // 0x8074350
    int32_t v77 = n; // 0x8074350
    char * v78 = v63; // 0x8074350
    char v79 = v42; // 0x8074350
    goto lab_0x8074354;
  lab_0x80740f7:
    // 0x80740f7
    *v94 = 32;
    int16_t * v95 = *__ctype_b_loc(); // 0x807410c
    int32_t v96 = (int32_t)v94;
    char * v97 = (char *)(v96 - 1); // 0x8074114
    int32_t v98 = v85 + 1; // 0x807412c
    char * v99 = v97; // 0x807412c
    v33 = true;
    v23 = v96;
    v21 = v85;
    v19 = v100;
    while ((*(int16_t *)(2 * (int32_t)*v97 + (int32_t)v95) & 0x2000) != 0) {
        int32_t v101 = v98;
        v95 = *__ctype_b_loc();
        v96 = (int32_t)v99;
        v97 = (char *)(v96 - 1);
        v98 = v101 + 1;
        v99 = v97;
        v33 = true;
        v23 = v96;
        v21 = v101;
        v19 = v100;
    }
    goto lab_0x807415b;
  lab_0x8073d78:
    // 0x8073d78
    v5 = v3;
    v4 = v2;
    v7 = v10;
    if (v6 != 0) {
        // break -> 0x8073d8c
        goto lab_0x8073d8c_3;
    }
    goto lab_0x8073ce2;
  lab_0x8073ce2:
    // 0x8073ce2
    *v5 = 0;
    v8 = v4;
    v7 = v10;
    if (v4 == 0) {
        // break -> 0x8073d8c
        goto lab_0x8073d8c_3;
    }
    goto lab_0x8073cfc;
  lab_0x8073c05:;
    int32_t * mem2 = calloc(1, 1); // 0x8073c1b
    v7 = (int32_t)mem2;
    if (mem2 == NULL) {
        // 0x8073c2d
        outofmem("./GridText.c", "HText_ExtEditForm");
        // UNREACHABLE
    }
    goto lab_0x8073d8c_3;
  lab_0x8073d8c_3:
    // 0x8073d8c
    mem3 = malloc(1024);
    if (mem3 == NULL) {
        // 0x8073da1
        outofmem("./GridText.c", "HText_ExtEditForm");
        // UNREACHABLE
    }
    int32_t v102 = (int32_t)start_anchor;
    int32_t v103 = v7;
    int32_t * v89 = (int32_t *)(v102 + 28); // 0x8073dbe
    v52 = (int32_t)mem3;
    v69 = NULL;
    v70 = NULL;
    v71 = *(int32_t *)(*v89 + 20) < 1024;
    v72 = 0;
    v73 = 0;
    v74 = 1;
    v75 = NULL;
    v76 = v102;
    v77 = 0;
    v78 = (char *)v103;
    v79 = 0;
    while (true) {
      lab_0x8074354:
        // 0x8074354
        v41 = v79;
        char * str2 = v78;
        v55 = v76;
        v60 = v75;
        v57 = v74;
        int32_t v80 = v73;
        int32_t v81 = v72;
        int32_t v82 = v71;
        v53 = v70;
        v67 = v69;
        if (v57 > orig_cnt) {
            // 0x8074360
            if (*str2 == 0) {
                // 0x807436e
                if (v77 == 0) {
                    // break -> 0x8074382
                    break;
                }
            }
        }
        int32_t v83 = v80; // 0x8073dfc
        char * v84 = str2; // 0x8073dfc
        int32_t n2 = 0; // 0x8073dfc
        if (v81 != 0) {
            // 0x8073dfe
            n2 = v81 - (int32_t)str2;
            strncpy((char *)mem3, str2, n2);
            *(char *)(n2 + v52) = 0;
            v83 = 0;
            v84 = (char *)(v80 + v81);
        }
        // 0x8073e4f
        v25 = n2;
        str = v84;
        v85 = v83;
        *(char *)(v25 + v52) = 0;
        char * found_char_pos = strchr(str, 10); // 0x8073e66
        int32_t len; // 0x8073b4e
        if (found_char_pos == NULL) {
            // 0x8073e8b
            len = strlen(str);
        } else {
            // 0x8073e74
            len = (int32_t)found_char_pos - (int32_t)str;
        }
        // 0x8073e9f
        v86 = len;
        v87 = v86 + v25;
        v88 = v82;
        if (v82 < 0 == v41 == 0) {
            // 0x8073eb3
            v27 = v87;
            v28 = v85;
            v29 = 0;
            v31 = v82;
            v32 = v86;
            if (v87 < *(int32_t *)(*v89 + 20)) {
                goto lab_0x80741d4;
            } else {
                char * found_char_pos2 = strchr(str, 32); // 0x8073ed7
                v27 = v87;
                v28 = v85;
                v29 = 0;
                v31 = v82;
                v32 = v86;
                if (found_char_pos2 == NULL) {
                    goto lab_0x80741d4;
                } else {
                    int32_t v90 = *(int32_t *)(*v89 + 20); // 0x8073ef3
                    v27 = v87;
                    v28 = v85;
                    v29 = 0;
                    v31 = v82;
                    v32 = v86;
                    if ((int32_t)found_char_pos2 - (int32_t)str < v90 - 1) {
                        // 0x8073efd
                        LYFixCursesOn("ask for confirmation:");
                        LYerase();
                        char * v91 = gettext("Wrap lines to fit displayed area?"); // 0x8073f15
                        v27 = v87;
                        v28 = v85;
                        v29 = 0;
                        v31 = 0;
                        v32 = v86;
                        if (HTConfirmDefault(v91, 0) == 0) {
                            goto lab_0x80741d4;
                        } else {
                            int32_t v92 = *v89; // 0x8073f31
                            int32_t v93 = *(int32_t *)(v92 + 20); // 0x8073f34
                            v88 = v93 - 1;
                            goto lab_0x8073f46;
                        }
                    } else {
                        goto lab_0x80741d4;
                    }
                }
            }
        } else {
            goto lab_0x8073f46;
        }
    }
    // 0x8074382
    if (WWW_TraceFlag != 0) {
        // 0x807438d
        fprintf(TraceFP(), "GridText: edited text inserted into lynx struct's\n");
    }
    if (v53 >= (char *)1) {
        // 0x80743aa
        update_subsequent_anchors((int32_t)v53, fp, (int32_t *)exit_line, (int32_t)v67);
    }
    // 0x80743e2
    free(mem3);
    if (v103 != 0) {
        // 0x80743e8
        free((int32_t *)v103);
    }
    // 0x807440a
    return (int32_t)v60 - v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8074412 - 0x80746d4
// Line range:    12778 - 12867
int32_t HText_ExtEditForm(int32_t * form_link) {
    int32_t v1 = (int32_t)form_link;
    int32_t v2 = __readgsdword(20); // 0x807441f
    int32_t v3 = *(int32_t *)(v1 + 64); // 0x807444f
    if (WWW_TraceFlag != 0) {
        // 0x8074460
        fprintf(TraceFP(), "GridText: entered HText_ExtEditForm()\n");
    }
    int32_t * mem = malloc(256); // 0x807447e
    struct _IO_FILE * stream = LYOpenTemp((char *)mem, (char *)&g12, "w"); // 0x807449c
    int32_t v4; // 0x8074412
    if (stream != NULL) {
        int32_t * v5 = NULL; // 0x8074550
        int32_t * v6 = NULL; // 0x8074550
        int32_t v7 = 0; // 0x8074550
        if (g203 != NULL) {
            int32_t * v8 = NULL;
            char v9 = 1;
            int32_t * v10 = NULL;
            int32_t v11 = 0;
            int32_t v12 = (int32_t)g203;
            int32_t * v13 = (int32_t *)v12; // 0x80744eb
            int32_t * v14; // 0x8074412
            int32_t * v15; // 0x8074412
            int32_t * v16; // 0x8074412
            int32_t * v17; // 0x8074412
            char v18; // 0x8074412
            int32_t v19; // 0x8074412
            if (IsFormsTextarea((int32_t *)v3, v13) == 0) {
                // 0x807453e
                v17 = v8;
                v18 = v9;
                v15 = v10;
                v19 = v11;
                if (v9 == 0) {
                    // break -> 0x8074552
                    break;
                }
            } else {
                // 0x80744f4
                v16 = v8;
                v14 = v10;
                if (v9 != 0) {
                    // 0x80744fa
                    v16 = v13;
                    v14 = (int32_t *)*(int32_t *)(v12 + 16);
                }
                // 0x807450d
                fputs((char *)*(int32_t *)(*(int32_t *)(v12 + 28) + 12), stream);
                fputc(10, stream);
                v17 = v16;
                v18 = 0;
                v15 = v14;
                v19 = v11 + 1;
            }
            int32_t v20 = v19;
            int32_t * v21 = v15;
            int32_t * v22 = v17;
            int32_t v23 = *v13; // 0x8074547
            v5 = v22;
            v6 = v21;
            v7 = v20;
            while (v23 != 0) {
                // 0x80744de
                v8 = v22;
                v9 = v18;
                v10 = v21;
                v11 = v20;
                v12 = v23;
                v13 = (int32_t *)v12;
                if (IsFormsTextarea((int32_t *)v3, v13) == 0) {
                    // 0x807453e
                    v17 = v8;
                    v18 = v9;
                    v15 = v10;
                    v19 = v11;
                    v5 = v8;
                    v6 = v10;
                    v7 = v11;
                    if (v9 == 0) {
                        // break -> 0x8074552
                        break;
                    }
                } else {
                    // 0x80744f4
                    v16 = v8;
                    v14 = v10;
                    if (v9 != 0) {
                        // 0x80744fa
                        v16 = v13;
                        v14 = (int32_t *)*(int32_t *)(v12 + 16);
                    }
                    // 0x807450d
                    fputs((char *)*(int32_t *)(*(int32_t *)(v12 + 28) + 12), stream);
                    fputc(10, stream);
                    v17 = v16;
                    v18 = 0;
                    v15 = v14;
                    v19 = v11 + 1;
                }
                // 0x8074544
                v20 = v19;
                v21 = v15;
                v22 = v17;
                v23 = *v13;
                v5 = v22;
                v6 = v21;
                v7 = v20;
            }
        }
        // 0x8074552
        LYCloseTempFP(stream);
        if (WWW_TraceFlag != 0) {
            int32_t v24 = *(int32_t *)v3; // 0x807456b
            fprintf(TraceFP(), "GridText: TEXTAREA name=|%s| dumped to tempfile\n", (char *)v24);
            if (WWW_TraceFlag != 0) {
                // 0x8074593
                fprintf(TraceFP(), "GridText: invoking editor (%s) on tempfile\n", (char *)editor);
            }
        }
        char str = 0; // bp-22, 0x80745b4
        uint32_t v25 = *(int32_t *)(v1 + 44) - (int32_t)v6; // 0x80745c0
        if (v25 >= 1) {
            // 0x80745c8
            if (editor_can_position() != 0) {
                // 0x80745d1
                sprintf(&str, "%d", v25 + 1);
            }
        }
        // 0x80745f3
        edit_temporary_file((char *)mem, &str, NULL);
        if (WWW_TraceFlag != 0) {
            // 0x8074618
            fprintf(TraceFP(), "GridText: returned from editor (%s)\n", (char *)editor);
        }
        int32_t v26 = 0; // 0x8074641
        if (*(int32_t *)(v3 + 80) == 0) {
            // 0x807464c
            v26 = finish_ExtEditForm(form_link, v5, (char *)mem, v7);
        }
        // 0x807466f
        LYRemoveTemp((char *)mem);
        if (mem != NULL) {
            // 0x8074680
            free(mem);
        }
        // 0x8074692
        v4 = v26;
        if (WWW_TraceFlag != 0) {
            // 0x807469d
            fprintf(TraceFP(), "GridText: exiting HText_ExtEditForm()\n");
            v4 = v26;
        }
    } else {
        // 0x80744aa
        v4 = 0;
        if (mem != NULL) {
            // 0x80744b0
            free(mem);
            v4 = 0;
        }
    }
    int32_t result = v4; // 0x80746c7
    if (v2 != __readgsdword(20)) {
        // 0x80746c9
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80746ce
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x80746d4 - 0x8074845
// Line range:    12876 - 12943
void HText_ExpandTextarea(int32_t * form_link, int32_t newlines) {
    int32_t * anchor_ptr = NULL; // bp-20, 0x80746db
    int32_t * end_anchor = NULL; // bp-28, 0x80746ef
    if (WWW_TraceFlag != 0) {
        // 0x8074708
        fprintf(TraceFP(), "GridText: entered HText_ExpandTextarea()\n");
    }
    if (newlines < 1) {
        // 0x807483f
        return;
    }
    int32_t * v1 = (int32_t *)*(int32_t *)((int32_t)form_link + 64); // 0x80746ec
    char v2 = 1; // 0x8074773
    if (g203 != NULL) {
        int32_t * v3 = (int32_t *)(int32_t)g203;
        char v4; // 0x80746d4
        if (IsFormsTextarea(v1, v3) == 0) {
            // 0x8074761
            v4 = v2;
            if (v2 == 0) {
                // break -> 0x807477e
                break;
            }
        } else {
            // 0x807474f
            anchor_ptr = v3;
            v4 = 0;
        }
        int32_t v5 = *v3; // 0x807476a
        v2 = v4;
        while (v5 != 0) {
            // 0x8074739
            v3 = (int32_t *)v5;
            if (IsFormsTextarea(v1, v3) == 0) {
                // 0x8074761
                v4 = v2;
                if (v2 == 0) {
                    // break -> 0x807477e
                    break;
                }
            } else {
                // 0x807474f
                anchor_ptr = v3;
                v4 = 0;
            }
            // 0x8074767
            v5 = *v3;
            v2 = v4;
        }
    }
    int32_t * v6 = NULL;
    for (int32_t i = 1; i < newlines + 1; i++) {
        // 0x807477e
        insert_new_textarea_anchor(&anchor_ptr, &end_anchor);
        int32_t v7 = *(int32_t *)((int32_t)anchor_ptr + 28); // 0x8074793
        HTSACopy((char **)(v7 + 12), (char *)&g12);
        int32_t v8 = *anchor_ptr; // 0x80747ac
        int32_t * v9 = v6; // 0x80747b0
        if (v8 != 0) {
            // 0x80747b2
            v9 = (int32_t *)*(int32_t *)(v8 + 12);
        }
        // 0x80747bd
        v6 = v9;
    }
    // 0x80747c9
    if (WWW_TraceFlag != 0) {
        // 0x80747d4
        fprintf(TraceFP(), "GridText: %d blank line(s) added to TEXTAREA name=|%s|\n", newlines, (char *)*v1);
    }
    // 0x80747fd
    update_subsequent_anchors(newlines, anchor_ptr, end_anchor, (int32_t)v6);
    if (WWW_TraceFlag != 0) {
        // 0x8074828
        fprintf(TraceFP(), "GridText: exiting HText_ExpandTextarea()\n");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8074845 - 0x807503a
// Line range:    12956 - 13246
int32_t HText_InsertFile(int32_t * form_link) {
    int32_t v1 = (int32_t)form_link;
    int32_t * anchor_ptr = NULL; // bp-32, 0x8074855
    int32_t * end_anchor = NULL; // bp-40, 0x807486d
    if (WWW_TraceFlag != 0) {
        // 0x80748ab
        fprintf(TraceFP(), "GridText: entered HText_InsertFile()\n");
    }
    char * v2 = GetFileName(); // 0x80748c2
    if (v2 == NULL) {
        // 0x80748d0
        HTInfoMsg(gettext("File insert cancelled!!!"));
        if (WWW_TraceFlag != 0) {
            // 0x80748ef
            fprintf(TraceFP(), "GridText: file insert cancelled - no filename provided\n");
        }
        // 0x8075032
        return 0;
    }
    // 0x8074915
    if (no_dotfiles != 0) {
        goto lab_0x807492b;
    } else {
        // 0x8074920
        if (show_dotfiles != 0) {
            goto lab_0x8074960;
        } else {
            goto lab_0x807492b;
        }
    }
  lab_0x807492b:
    // 0x807492b
    if (*LYPathLeaf(v2) == 46) {
        // 0x807493d
        HTUserMsg(gettext("File name may not begin with a dot."));
        // 0x8075032
        return 0;
    }
    goto lab_0x8074960;
  lab_0x8074960:;
    // 0x8074960
    int32_t v3; // bp-188, 0x8074845
    int32_t nmemb; // 0x8074845
    if (nmemb != 0 != stat64((int32_t)v2, &v3) > -1) {
        // 0x807498e
        HTInfoMsg(gettext("Nothing to insert - file is 0-length."));
        if (WWW_TraceFlag != 0) {
            // 0x80749ad
            fprintf(TraceFP(), "GridText: file insert aborted - file=|%s|- was 0-length\n", v2);
        }
        // 0x80749d1
        free((int32_t *)v2);
        // 0x8075032
        return 0;
    }
    int32_t * mem = calloc(nmemb + 1, 1); // 0x8074a03
    if (mem == NULL) {
        // 0x8074a11
        free((int32_t *)v2);
        HTAlert(gettext("Not enough memory for file!"));
        // 0x8075032
        return 0;
    }
    // 0x8074a3f
    char * cp; // bp-76, 0x8074845
    LYGetFileInfo(v2, NULL, NULL, NULL, NULL, NULL, (int32_t *)&cp);
    struct _IO_FILE * stream = fopen64(v2, "r"); // 0x8074a87
    if (stream == NULL) {
        // 0x8074a95
        free(mem);
        free((int32_t *)v2);
        HTAlert(gettext("Can't open file for reading."));
        // 0x8075032
        return 0;
    }
    int32_t items_read = fread(mem, 1, nmemb, stream); // 0x8074aea
    LYCloseInput(stream);
    free((int32_t *)v2);
    *(char *)(items_read + (int32_t)mem) = 0;
    int32_t * fp = (int32_t *)g203;
    int32_t * v4 = (int32_t *)g203; // 0x8074b63
    int32_t * v5 = (int32_t *)g203; // 0x8074b63
    char * v6 = NULL; // 0x8074b63
    if (g203 != NULL) {
        int32_t * v7 = fp;
        if (IsFormsTextarea((int32_t *)*(int32_t *)(v1 + 64), v4) != 0) {
            // 0x8074b46
            if (*(int32_t *)((int32_t)v7 + 16) == *(int32_t *)(v1 + 44)) {
                // break -> 0x8074b65
                break;
            }
        }
        int32_t v8 = *v7; // 0x8074b5a
        int32_t * v9 = (int32_t *)v8;
        fp = v9;
        v4 = v9;
        char * v10 = (char *)v7; // 0x8074b63
        v5 = v9;
        v6 = (char *)v7;
        while (v8 != 0) {
            // 0x8074b30
            v7 = fp;
            if (IsFormsTextarea((int32_t *)*(int32_t *)(v1 + 64), v4) != 0) {
                // 0x8074b46
                v5 = v7;
                v6 = v10;
                if (*(int32_t *)((int32_t)v7 + 16) == *(int32_t *)(v1 + 44)) {
                    // break -> 0x8074b65
                    break;
                }
            }
            // 0x8074b51
            v8 = *v7;
            v9 = (int32_t *)v8;
            fp = v9;
            v4 = v9;
            v10 = (char *)v7;
            v5 = v9;
            v6 = (char *)v7;
        }
    }
    int32_t v11 = (int32_t)HTMainAnchor;
    *(int32_t *)&end_anchor = v11;
    int32_t * v12 = (int32_t *)((int32_t)v5 + 16);
    if (*v12 != 0) {
        int32_t v13 = 0; // 0x8074b92
        int32_t v14 = *HTMainAnchor; // 0x8074b7e
        int32_t * v15 = (int32_t *)v14; // 0x8074b80
        end_anchor = v15;
        while (v14 != v11) {
            // 0x8074b96
            v13++;
            if (*v12 == v13) {
                // break -> 0x8074ba1
                break;
            }
            v14 = *v15;
            v15 = (int32_t *)v14;
            end_anchor = v15;
        }
    }
    int32_t * v16 = ALLOC_IN_POOL((int32_t **)&g216, 1044); // 0x8074bb6
    int32_t * v17 = ALLOC_IN_POOL((int32_t **)&g216, 52); // 0x8074bd3
    int32_t * form = v17; // bp-44, 0x8074bd8
    int32_t * v18 = ALLOC_IN_POOL((int32_t **)&g216, 96); // 0x8074bf0
    if (v16 != NULL == (v17 != NULL) != v18 != NULL) {
        // 0x8074c0a
        outofmem("./GridText.c", "HText_InsertFile");
        // UNREACHABLE
    }
    // 0x8074c1e
    *v17 = (int32_t)fp;
    int32_t v19 = *(int32_t *)((int32_t)fp + 12); // 0x8074c29
    *(int32_t *)((int32_t)v17 + 12) = v19;
    int16_t v20 = *(int16_t *)((int32_t)fp + 20); // 0x8074c35
    *(int16_t *)((int32_t)form + 20) = v20;
    int16_t v21 = *(int16_t *)((int32_t)fp + 22); // 0x8074c43
    *(int16_t *)((int32_t)form + 22) = v21;
    *(int32_t *)((int32_t)form + 8) = SGML_offset();
    int32_t v22 = *(int32_t *)((int32_t)fp + 16); // 0x8074c5e
    *(int32_t *)((int32_t)form + 16) = v22;
    LYCopyHiText(form, fp);
    char v23 = *(char *)((int32_t)fp + 27); // 0x8074c7c
    *(char *)((int32_t)form + 27) = v23;
    int32_t v24 = (int32_t)v18; // 0x8074c89
    *(int32_t *)((int32_t)form + 28) = v24;
    char v25 = *(char *)((int32_t)fp + 24); // 0x8074c92
    *(char *)((int32_t)form + 24) = v25;
    char v26 = *(char *)((int32_t)fp + 25); // 0x8074c9f
    *(char *)((int32_t)form + 25) = v26;
    *(char *)((int32_t)form + 26) = 1;
    *(int32_t *)((int32_t)form + 48) = 0;
    int32_t v27 = *(int32_t *)((int32_t)fp + 28); // 0x8074cbd
    HTSACopy((char **)v18, (char *)*(int32_t *)v27);
    int32_t v28 = *(int32_t *)((int32_t)fp + 28); // 0x8074cd4
    *(int32_t *)(v24 + 4) = *(int32_t *)(v28 + 4);
    int32_t v29 = *(int32_t *)((int32_t)fp + 28); // 0x8074ce3
    *(int32_t *)(v24 + 8) = *(int32_t *)(v29 + 8);
    HTSACopy((char **)(v24 + 16), (char *)&g12);
    int32_t v30 = *(int32_t *)((int32_t)fp + 28); // 0x8074d08
    *(int32_t *)(v24 + 20) = *(int32_t *)(v30 + 20);
    int32_t v31 = *(int32_t *)((int32_t)fp + 28); // 0x8074d17
    *(int32_t *)(v24 + 24) = *(int32_t *)(v31 + 24);
    int32_t v32 = *(int32_t *)((int32_t)fp + 28); // 0x8074d26
    *(char *)(v24 + 64) = *(char *)(v32 + 64);
    int32_t v33 = *(int32_t *)((int32_t)fp + 28); // 0x8074d36
    *(int32_t *)(v24 + 80) = *(int32_t *)(v33 + 80);
    char * v34 = cp; // 0x8074d42
    char * v35 = v34 < NULL ? (char *)current_char_set : v34;
    *(int32_t *)(v24 + 88) = (int32_t)v35;
    int32_t v36 = (int32_t)v16; // 0x8074d73
    *(int16_t *)(v36 + 8) = *(int16_t *)((int32_t)end_anchor + 8);
    *(int16_t *)(v36 + 10) = *(int16_t *)((int32_t)end_anchor + 10);
    *(int16_t *)(v36 + 16) = *(int16_t *)((int32_t)end_anchor + 16);
    *(int32_t *)(v36 + 12) = *(int32_t *)((int32_t)end_anchor + 12);
    int32_t v37 = (int32_t)end_anchor;
    strcpy((char *)(v36 + 18), (char *)(v37 + 18));
    if (g203 == (char *)fp) {
        // 0x8074dca
        g203 = (char *)form;
    }
    int32_t v38 = v37; // 0x8074ddd
    if (v6 != NULL) {
        // 0x8074ddf
        *(int32_t *)v6 = (int32_t)form;
        v38 = (int32_t)end_anchor;
    }
    int32_t * v39 = (int32_t *)*(int32_t *)(v38 + 4); // 0x8074ded
    end_anchor = v39;
    *v16 = *v39;
    *(int32_t *)(v36 + 4) = (int32_t)end_anchor;
    *(int32_t *)(*end_anchor + 4) = v36;
    *end_anchor = v36;
    int32_t * v40 = (int32_t *)*end_anchor; // 0x8074e1b
    end_anchor = v40;
    end_anchor = (int32_t *)*v40;
    *(int32_t *)&fp = (int32_t)form;
    int32_t * mem2 = malloc(1024); // 0x8074e37
    if (mem2 == NULL) {
        // 0x8074e45
        outofmem("./GridText.c", "HText_InsertFile");
        // UNREACHABLE
    }
    int32_t v41 = *(int32_t *)((int32_t)fp + 12); // 0x8074e5c
    int32_t result = 1; // 0x8074f8f
    if (*(char *)mem != 0) {
        char v42 = 0;
        int32_t v43 = 1;
        char * str = (char *)mem;
        char * found_char_pos = strchr(str, 10); // 0x8074e82
        int32_t len; // 0x8074845
        if (found_char_pos == NULL) {
            // 0x8074e9d
            len = strlen(str);
        } else {
            // 0x8074e90
            len = (int32_t)found_char_pos - (int32_t)str;
        }
        char v44 = v42; // 0x8074eb2
        int32_t n = len; // 0x8074eb2
        char v45; // 0x8074845
        char v46; // 0x8074845
        int32_t v47; // 0x8074edc
        if (len >= 1024) {
            // 0x8074eb4
            v45 = v42;
            if (v42 == 0) {
                // 0x8074eba
                HTAlert(gettext("Very long lines have been truncated!"));
                v45 = 1;
            }
            // 0x8074ed2
            v46 = v45;
            v47 = (int32_t)str;
            v44 = v46;
            n = 1023;
            if (*(char *)(v47 + 1023) != 0) {
                // 0x8074ee6
                *(char *)(v47 + 1024) = 0;
                v44 = v46;
                n = 1023;
            }
        }
        // 0x8074ef2
        strncpy((char *)mem2, str, n);
        *(char *)(n + (int32_t)mem2) = 0;
        int32_t * v48; // 0x8074845
        int32_t v49; // 0x8074845
        // 0x8074ef2
        v48 = fp;
        v49 = v43;
        int32_t v50 = v49;
        int32_t v51 = *(int32_t *)((int32_t)v48 + 28); // 0x8074f39
        HTSACopy((char **)(v51 + 12), (char *)mem2);
        int32_t v52; // 0x8074f58
        if (cp >= NULL) {
            // 0x8074f55
            v52 = *(int32_t *)((int32_t)fp + 28);
            *(int32_t *)(v52 + 88) = (int32_t)cp;
        }
        int32_t v53 = n + (int32_t)str; // 0x8074f64
        char * v54 = (char *)v53; // 0x8074f64
        char * v55 = *v54 == 0 ? v54 : (char *)(v53 + 1);
        *(int32_t *)&anchor_ptr = (int32_t)fp;
        fp = (int32_t *)*fp;
        char v56 = 0; // 0x8074f8f
        result = v50;
        while (*v55 != 0) {
            // 0x8074e74
            v42 = v44;
            v43 = v50;
            str = v55;
            found_char_pos = strchr(str, 10);
            if (found_char_pos == NULL) {
                // 0x8074e9d
                len = strlen(str);
            } else {
                // 0x8074e90
                len = (int32_t)found_char_pos - (int32_t)str;
            }
            // 0x8074eab
            v44 = v42;
            n = len;
            if (len >= 1024) {
                // 0x8074eb4
                v45 = v42;
                if (v42 == 0) {
                    // 0x8074eba
                    HTAlert(gettext("Very long lines have been truncated!"));
                    v45 = 1;
                }
                // 0x8074ed2
                v46 = v45;
                v47 = (int32_t)str;
                v44 = v46;
                n = 1023;
                if (*(char *)(v47 + 1023) != 0) {
                    // 0x8074ee6
                    *(char *)(v47 + 1024) = 0;
                    v44 = v46;
                    n = 1023;
                }
            }
            // 0x8074ef2
            strncpy((char *)mem2, str, n);
            *(char *)(n + (int32_t)mem2) = 0;
            if (v56 != 0) {
                // 0x8074ef2
                v48 = fp;
                v49 = v43;
            } else {
                // 0x8074f1a
                insert_new_textarea_anchor(&anchor_ptr, &end_anchor);
                *(int32_t *)&fp = (int32_t)anchor_ptr;
                v48 = anchor_ptr;
                v49 = v43 + 1;
            }
            // 0x8074f36
            v50 = v49;
            v51 = *(int32_t *)((int32_t)v48 + 28);
            HTSACopy((char **)(v51 + 12), (char *)mem2);
            if (cp >= NULL) {
                // 0x8074f55
                v52 = *(int32_t *)((int32_t)fp + 28);
                *(int32_t *)(v52 + 88) = (int32_t)cp;
            }
            // 0x8074f61
            v53 = n + (int32_t)str;
            v54 = (char *)v53;
            v55 = *v54 == 0 ? v54 : (char *)(v53 + 1);
            *(int32_t *)&anchor_ptr = (int32_t)fp;
            fp = (int32_t *)*fp;
            v56 = 0;
            result = v50;
        }
    }
    // 0x8074f95
    if (WWW_TraceFlag != 0) {
        // 0x8074fa0
        fprintf(TraceFP(), "GridText: file inserted into lynx struct's\n");
    }
    // 0x8075007
    update_subsequent_anchors(result, anchor_ptr, end_anchor, v41);
    free(mem2);
    free(mem);
    if (WWW_TraceFlag == 0) {
        // 0x8075032
        return result;
    }
    // 0x8075012
    fprintf(TraceFP(), "GridText: exiting HText_InsertFile()\n");
    // 0x8075032
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x807503a - 0x8075094
// Line range:    13250 - 13263
int32_t GetColumn(void) {
    // 0x807503a
    return LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8075094 - 0x8075121
// Line range:    13266 - 13278
char DidWrap(int32_t y0, int32_t x0) {
    int32_t * v1 = LYwin;
    int32_t v2 = v1 == NULL ? -1 : (int32_t)*(int16_t *)&g255;
    if ((LYwideLines != 0 ? 1014 : LYcols) > v2) {
        // 0x8075109
        if (v2 != 0 || (v1 == NULL ? -1 : 0x10000 * (int32_t)v1 >> 16) == y0) {
            // 0x807511b
            return 0;
        }
    }
    // 0x807511b
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8075121 - 0x8075496
// Line range:    13296 - 13454
void redraw_part_of_line(int32_t * line, char * str, int32_t len, int32_t * text) {
    int32_t v1 = (int32_t)line;
    char str2 = 0; // bp-46, 0x8075190
    char str4 = 0; // bp-47, 0x8075197
    char * v2 = (char *)((int32_t)str + len); // 0x80751a6
    int16_t * v3; // 0x8075121
    char * v4; // 0x8075121
    char * v5; // 0x8075121
    char * v6; // 0x8075121
    int32_t v7; // 0x8075121
    int32_t v8; // 0x8075121
    int32_t v9; // 0x8075121
    char * v10; // 0x8075121
    char * v11; // 0x8075121
    char v12; // 0x8075121
    char v13; // 0x8075121
    char v14; // 0x8075121
    int32_t v15; // 0x8075121
    int32_t v16; // 0x8075121
    char * str3; // 0x8075121
    int32_t v17; // 0x8075157
    int16_t * v18; // 0x8075121
    if (v2 > str) {
        int32_t * v19 = LYwin;
        v17 = v19 == NULL ? -1 : 0x10000 * (int32_t)v19 >> 16;
        v15 = v19 == NULL ? -1 : (int32_t)*(int16_t *)&g255;
        v18 = (int16_t *)(v1 + 16);
        v6 = NULL;
        v14 = 32;
        v11 = str;
        v9 = v15 + 1;
        while (true) {
          lab_0x80751b2:;
            char v20 = v14;
            int32_t v21 = 2 * (int32_t)v20;
            char * v22 = v6; // 0x8075121
            char * v23 = v11; // 0x8075121
            int32_t v24 = v9; // 0x8075121
            char * v25; // 0x8075121
            int32_t v26; // 0x80751bb
            char v27; // 0x8075256
            while (true) {
                // 0x80751b2
                v8 = v24;
                char * v28 = v22; // 0x8075121
                char * v29 = v23; // 0x8075121
                while (true) {
                    // 0x80751b2
                    v25 = v29;
                    str4 = *v25;
                    int32_t v30 = GetColumn(); // 0x80751bf
                    int32_t v31 = (int32_t)v28;
                    int32_t v32 = StyleToCols(text, line, v31); // 0x80751db
                    int32_t v33 = v31; // 0x807524c
                    char * v34 = v28; // 0x807524c
                    if (!((v30 < v32 | (int32_t)*v18 <= v31))) {
                        int32_t v35 = *(int32_t *)(v1 + 12) + 4 * v33; // 0x80751f1
                        uint16_t v36 = *(int16_t *)(v35 + 2); // 0x807520c
                        curses_style((int32_t)v36, (int32_t)(*(char *)v35 % 4));
                        int32_t v37 = v33 + 1; // 0x807521f
                        int32_t v38 = StyleToCols(text, line, v37); // 0x8075237
                        v33 = v37;
                        while (!((v30 < v38 | v37 >= (int32_t)*v18))) {
                            // 0x80751e5
                            v35 = *(int32_t *)(v1 + 12) + 4 * v33;
                            v36 = *(int16_t *)(v35 + 2);
                            curses_style((int32_t)v36, (int32_t)(*(char *)v35 % 4));
                            v37 = v33 + 1;
                            v38 = StyleToCols(text, line, v37);
                            v33 = v37;
                        }
                        // 0x807523f
                        v34 = (char *)v37;
                    }
                    // 0x8075256
                    v16 = (int32_t)v25;
                    v26 = v16 + 1;
                    str3 = (char *)v26;
                    v4 = v34;
                    v27 = str4;
                    if (v27 == 7) {
                        // 0x8075299
                        if (*str3 == 0) {
                            int16_t v39 = *(int16_t *)(v21 + (int32_t)*__ctype_b_loc()); // 0x80752ba
                            if (v20 != 45 && (v39 & 0x2000) == 0) {
                                // 0x80752db
                                str4 = 45;
                                v12 = v20;
                                goto lab_0x807537e;
                            }
                        }
                    } else {
                        if (v27 != 8) {
                            // break (via goto) -> 0x80752db
                            goto lab_0x80752db;
                        }
                        // 0x807526c
                        if (dump_output_immediately == 0) {
                            // break -> 0x807527b
                            break;
                        }
                    }
                    // 0x8075439
                    v28 = v4;
                    v29 = str3;
                    v3 = v18;
                    v5 = v4;
                    if (str3 >= v2) {
                        // break (via goto) -> 0x8075485
                        goto lab_0x8075485_3;
                    }
                }
                // 0x807527b
                function_804a8f4((int32_t)LYwin, 43);
                v22 = v4;
                v23 = str3;
                v24 = v8 + 1;
                v3 = v18;
                v5 = v4;
                if (str3 >= v2) {
                    // break (via goto) -> 0x8075485
                    goto lab_0x8075485_3;
                }
            }
          lab_0x80752db:;
            char v40 = *(char *)((int32_t)text + 2251); // 0x80752de
            v12 = v20;
            if (v27 >= 0 || v40 == 0) {
                goto lab_0x807537e;
            } else {
                int32_t n = utf8_length(v40, v25); // 0x807530b
                v12 = 77;
                if (n == 0) {
                    goto lab_0x807537e;
                } else {
                    // 0x807531d
                    strncpy(&str2, str3, n);
                    int32_t v41; // bp-4, 0x8075121
                    *(char *)((int32_t)&v41 - 42 + n) = 0;
                    int32_t len2 = strlen(&str4); // 0x807534a
                    LYwaddnstr(LYwin, &str4, len2);
                    str2 = 0;
                    v7 = v8;
                    v10 = (char *)(n + v26);
                    v13 = 77;
                    goto lab_0x807541f;
                }
            }
        }
    } else {
        // 0x8075121
        v3 = (int16_t *)(v1 + 16);
        v5 = NULL;
    }
  lab_0x8075485_3:;
    int32_t v42 = (int32_t)v5; // 0x807548f
    if ((int32_t)*v3 <= v42) {
        // 0x8075494
        return;
    }
    int32_t v43 = *(int32_t *)(v1 + 12) + 4 * v42; // 0x8075453
    uint16_t v44 = *(int16_t *)(v43 + 2); // 0x807546e
    curses_style((int32_t)v44, (int32_t)(*(char *)v43 % 4));
    int32_t v45 = v42 + 1; // 0x8075481
    int32_t v46 = v45; // 0x8075492
    while (v45 < (int32_t)*v3) {
        // 0x8075447
        v43 = *(int32_t *)(v1 + 12) + 4 * v46;
        v44 = *(int16_t *)(v43 + 2);
        curses_style((int32_t)v44, (int32_t)(*(char *)v43 % 4));
        v45 = v46 + 1;
        v46 = v45;
    }
  lab_0x807537e:
    // 0x807537e
    if (HTCJK == 0) {
        goto lab_0x80753f4;
    } else {
        // 0x8075387
        if (str4 >= 0) {
            goto lab_0x80753f4;
        } else {
            // 0x807538f
            v7 = v8;
            v10 = str3;
            v13 = v12;
            if ((LYwideLines != 0 ? 1014 : LYcols) >= v8) {
                // 0x80753b1
                str2 = *str3;
                int32_t len3 = strlen(&str4); // 0x80753cc
                LYwaddnstr(LYwin, &str4, len3);
                str2 = 0;
                v7 = v8 + 1;
                v10 = (char *)(v16 + 2);
                v13 = 77;
            }
            goto lab_0x807541f;
        }
    }
  lab_0x80753f4:;
    int32_t len4 = strlen(&str4); // 0x80753fa
    LYwaddnstr(LYwin, &str4, len4);
    v7 = v8;
    v10 = str3;
    v13 = str4;
    goto lab_0x807541f;
  lab_0x807541f:
    // 0x807541f
    v6 = v4;
    v14 = v13;
    v11 = v10;
    v9 = v7 + (int32_t)(DidWrap(v17, v15) == 0);
    v3 = v18;
    v5 = v4;
    if (v10 >= v2) {
        // break -> 0x8075485
        goto lab_0x8075485_3;
    }
    goto lab_0x80751b2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8075496 - 0x8075606
// Line range:    14033 - 14065
void redraw_lines_of_link(int32_t cur) {
    // 0x8075496
    int32_t v1; // 0x8075496
    if (g209 != (char *)HTMainAnchor) {
        int32_t v2 = *(int32_t *)(68 * cur + (int32_t)&g346); // 0x8075503
        v1 = 1 - v2 + display_lines;
    } else {
        int32_t v3 = *(int32_t *)(68 * cur + (int32_t)&g346); // 0x80754cc
        v1 = g202 + 1 - v3 - g208;
    }
    int32_t v4 = v1;
    int32_t v5 = v4; // 0x8075545
    int32_t v6 = (int32_t)g209; // 0x8075545
    if (v4 >= 0 == (v4 != 0)) {
        v5--;
        int32_t v7 = *(int32_t *)((int32_t)g209 + 4); // 0x8075532
        char * v8 = (char *)v7; // 0x8075545
        v6 = v7;
        while (v5 >= 0 == (v5 != 0)) {
            // 0x807552f
            v5--;
            v7 = *(int32_t *)((int32_t)v8 + 4);
            v8 = (char *)v7;
            v6 = v7;
        }
    }
    int32_t v9 = *(int32_t *)(68 * cur + (int32_t)&g346); // 0x8075554
    int32_t v10 = v9 + (int32_t)(no_title != 0);
    int32_t v11 = v6; // 0x80755df
    int32_t v12 = 0; // 0x80755df
    if (display_lines < v10) {
        // 0x8075600
        return;
    }
    int32_t v13 = v10; // 0x80755df
    char * str = LYGetHiliteStr(cur, v12); // 0x80755ee
    while (str != NULL) {
        int32_t v14 = v13;
        v13 = v14 + 1;
        LYmove(v14, LYGetHilitePos(cur, v12));
        int32_t * v15 = (int32_t *)v11;
        redraw_part_of_line(v15, str, strlen(str), HTMainText);
        v11 = *v15;
        v12++;
        if (display_lines < v13) {
            // break -> 0x8075600
            break;
        }
        str = LYGetHiliteStr(cur, v12);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x8075606 - 0x8075620
// Line range:    14070 - 14073
void HTMark_asSource(void) {
    // 0x8075606
    if (HTMainText != NULL) {
        // 0x8075612
        *(char *)&g207 = 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./GridText.c
// Address range: 0x807565e - 0x8075695
// Line range:    14097 - 14101
int32_t HTMainText_Get_UCLYhndl(void) {
    int32_t result = -1; // 0x807566b
    if (HTMainText != NULL) {
        // 0x807566d
        result = HTAnchor_getUCLYhndl(HTMainText, 0);
    }
    // 0x8075690
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYGetFile.c
// Address range: 0x8075698 - 0x807770e
// Line range:    71 - 1064
int32_t getfile(int32_t * doc, int32_t * target) {
    char * pound = NULL; // bp-24, 0x80756ad
    if (LYCancelDownload != 0) {
        // 0x80756bf
        if (WWW_TraceFlag != 0) {
            // 0x80756ca
            fprintf(TraceFP(), "getfile:    resetting LYCancelDownload to FALSE\n");
        }
        // 0x80756e1
        LYCancelDownload = 0;
    }
    int32_t v1 = (int32_t)doc;
    LYFakeZap(0);
    redirection_attempts = 0;
    int32_t v2 = v1 + 4; // 0x8075701
    int32_t * str5 = (int32_t *)v2;
    int32_t * v3 = (int32_t *)(v1 + 8);
    int32_t * v4 = (int32_t *)(v1 + 16);
    char ** v5 = (char **)v2;
    int32_t * v6 = (int32_t *)(v1 + 24);
    int32_t result; // 0x8075698
    char * str11; // bp-68, 0x8075698
    char * str3; // bp-88, 0x8075698
    int32_t v7; // 0x807570a
    int32_t v8; // 0x807571c
    int32_t v9; // 0x80759e8
    while (true) {
      lab_0x80756fe_2:
        // 0x80756fe
        str3 = (char *)*str5;
        v7 = *v3;
        v8 = *v4;
        HTPermitRedir = 0;
        if (WWW_Download_File != 0) {
            // 0x8075746
            free((int32_t *)WWW_Download_File);
            WWW_Download_File = 0;
        }
        // 0x807575d
        redirect_post_content = 0;
        HTNoDataOK = 0;
        if (WWW_TraceFlag != 0) {
            // 0x8075779
            fprintf(TraceFP(), "getfile: getting %s\n\n", (char *)*str5);
        }
        char * str = HTParse((char *)*str5, (char *)&g16, 8); // 0x80757b3
        pound = str;
        if (str != NULL) {
            // 0x80757c6
            if (strlen(str) >= 4) {
                char * found_char_pos = strchr(pound, 64); // 0x80757e8
                char * found_char_pos2 = strrchr(found_char_pos != NULL ? found_char_pos : pound, 58); // 0x807580a
                if (found_char_pos2 != NULL) {
                    char * str2 = (char *)((int32_t)found_char_pos2 + 1);
                    char * temp; // bp-32, 0x8075698
                    if (sscanf(str2, "%ld", &temp) != 1) {
                        int16_t v10 = *(int16_t *)(2 * (int32_t)*str2 + (int32_t)*__ctype_b_loc()); // 0x8075977
                        if ((v10 & 2048) != 0) {
                            // 0x8075986
                            HTAlert(gettext("URL has a bad port field."));
                            result = 3;
                            if (pound == NULL) {
                                return result;
                            } else {
                                // 0x80759a1
                                free((int32_t *)pound);
                                pound = NULL;
                                result = 3;
                                return result;
                            }
                        }
                    } else {
                        char * v11 = temp; // 0x8075843
                        if (v11 != (char *)19 != v11 != (char *)0x10013) {
                            // 0x8075855
                            HTAlert(gettext("Port 19 not permitted in URLs."));
                            result = 3;
                            if (pound == NULL) {
                                return result;
                            } else {
                                // 0x8075870
                                free((int32_t *)pound);
                                pound = NULL;
                                result = 3;
                                return result;
                            }
                        }
                        if (v11 != (char *)25 != v11 != (char *)0x10019) {
                            // 0x80758a0
                            HTAlert(gettext("Port 25 not permitted in URLs."));
                            result = 3;
                            if (pound == NULL) {
                                return result;
                            } else {
                                // 0x80758bb
                                free((int32_t *)pound);
                                pound = NULL;
                                result = 3;
                                return result;
                            }
                        }
                        if (v11 <= (char *)0xffff != v11 >= NULL) {
                            // 0x80758ee
                            str11 = NULL;
                            char * v12 = gettext("Port %lu not permitted in URLs."); // 0x8075901
                            HTSprintf0(&str11, v12);
                            HTAlert(str11);
                            if (str11 == NULL) {
                                goto lab_0x807593d;
                            } else {
                                // 0x807592b
                                free((int32_t *)str11);
                                str11 = NULL;
                                goto lab_0x807593d;
                            }
                        }
                    }
                }
            }
            char * v13 = pound;
            if (v13 != NULL) {
                // 0x80759cd
                free((int32_t *)v13);
                pound = NULL;
            }
        }
        // 0x80759df
        v9 = is_url((char *)*str5);
        if (v9 == 0) {
            // break -> 0x807769d
            break;
        }
        // 0x80759fa
        if (LYValidate == 0) {
            goto lab_0x8075b5a;
        } else {
            // 0x8075a09
            if (LYPermitURL != 0) {
                goto lab_0x8075b5a;
            } else {
                switch (v9) {
                    case 41: {
                        goto lab_0x8075b5a;
                    }
                    case 40: {
                        goto lab_0x8075b5a;
                    }
                    case 39: {
                        goto lab_0x8075b5a;
                    }
                    case 38: {
                        goto lab_0x8075b5a;
                    }
                    case 35: {
                        goto lab_0x8075b5a;
                    }
                    case 20: {
                        goto lab_0x8075b5a;
                    }
                    case 2: {
                        goto lab_0x8075b5a;
                    }
                    default: {
                        if (v7 != 0 == v9 == 42) {
                            goto lab_0x8075b5a;
                        } else {
                            int32_t len = strlen((char *)helpfilepath); // 0x8075a77
                            if (strncmp(str3, (char *)helpfilepath, len) == 0) {
                                goto lab_0x8075b5a;
                            } else {
                                // 0x8075a9d
                                if (lynxlistfile == 0) {
                                    goto lab_0x8075ad4;
                                } else {
                                    int32_t len2 = strlen((char *)lynxlistfile); // 0x8075aae
                                    if (strncmp(str3, (char *)lynxlistfile, len2) == 0) {
                                        goto lab_0x8075b5a;
                                    } else {
                                        goto lab_0x8075ad4;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    // 0x807769d
    if (WWW_TraceFlag != 0) {
        // 0x80776a8
        if (LYTraceLogFP == NULL) {
            // 0x80776b1
            sleep(MessageSecs);
        }
    }
    // 0x80776be
    HTUserMsg2(gettext("Badly formed address %s"), (char *)*str5);
    if (WWW_TraceFlag != 0) {
        // 0x80776e7
        fprintf(TraceFP(), "\n");
    }
    // 0x8077705
    return 3;
  lab_0x8075b3a_2:
    // 0x8075b3a
    HTUserMsg(gettext("Not an http URL or form ACTION!"));
    result = 3;
    return result;
  lab_0x8075d48_2:
    // 0x8075d48
    HTUserMsg(gettext("URL is not in starting realm!"));
    result = 3;
    goto lab_0x8077705;
  lab_0x80768ac_5:
    // 0x80768ac
    stop_curses();
    HTLoadAbsolute((int32_t *)&str3);
    result = 3;
    if (dump_output_immediately != 0) {
        goto lab_0x8077705;
    } else {
        // 0x80768c7
        start_curses();
        fflush((struct _IO_FILE *)g164);
        LYAddVisitedLink(doc);
        result = 3;
        goto lab_0x8077705;
    }
  lab_0x80769e4_5:
    // 0x80769e4
    stop_curses();
    HTLoadAbsolute((int32_t *)&str3);
    fflush((struct _IO_FILE *)g164);
    result = 3;
    if (dump_output_immediately != 0) {
        goto lab_0x8077705;
    } else {
        // 0x8076a0c
        start_curses();
        LYAddVisitedLink(doc);
        result = 3;
        goto lab_0x8077705;
    }
  lab_0x8075b5a:
    // 0x8075b5a
    if (traversal == 0) {
        // 0x8075b85
        if (check_realm == 0) {
            goto lab_0x8075d68;
        } else {
            // 0x8075b94
            if (LYPermitURL != 0) {
                goto lab_0x8075d68;
            } else {
                // 0x8075ba3
                if (LYJumpFileURL != 0) {
                    goto lab_0x8075d68;
                } else {
                    // 0x8075bb2
                    if (strncmp((char *)startrealm, str3, strlen((char *)startrealm)) == 0) {
                        goto lab_0x8075d68;
                    } else {
                        switch (v9) {
                            case 43: {
                                goto lab_0x8075d68;
                            }
                            case 42: {
                                goto lab_0x8075d68;
                            }
                            case 41: {
                                goto lab_0x8075d68;
                            }
                            case 40: {
                                goto lab_0x8075d68;
                            }
                            case 39: {
                                goto lab_0x8075d68;
                            }
                            case 38: {
                                goto lab_0x8075d68;
                            }
                            case 37: {
                                goto lab_0x8075d68;
                            }
                            case 35: {
                                goto lab_0x8075d68;
                            }
                            case 34: {
                                goto lab_0x8075d68;
                            }
                            case 33: {
                                goto lab_0x8075d68;
                            }
                            case 31: {
                                goto lab_0x8075d68;
                            }
                            case 30: {
                                goto lab_0x8075d68;
                            }
                            case 29: {
                                goto lab_0x8075d68;
                            }
                            case 28: {
                                goto lab_0x8075d68;
                            }
                            case 16: {
                                goto lab_0x8075d68;
                            }
                            default: {
                                // 0x8075c76
                                if (v9 < 28 == LYUserSpecifiedURL == 0) {
                                    goto lab_0x8075d68;
                                } else {
                                    if (v8 == 0) {
                                        goto lab_0x8075cb4;
                                    } else {
                                        // 0x8075ca6
                                        if (*(char *)v8 != 0) {
                                            goto lab_0x8075d68;
                                        } else {
                                            goto lab_0x8075cb4;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    } else {
        // 0x8075b65
        result = 3;
        switch (v9) {
            case 39: {
                goto lab_0x8075d68;
            }
            case 2: {
                goto lab_0x8075d68;
            }
            default: {
                goto lab_0x8077705;
            }
        }
    }
  lab_0x8075d68:
    if (v7 == 0) {
        goto lab_0x8075e56;
    } else {
        switch (v9) {
            case 44: {
                goto lab_0x8075e56;
            }
            case 42: {
                goto lab_0x8075e56;
            }
            case 39: {
                goto lab_0x8075e56;
            }
            case 25: {
                goto lab_0x8075e56;
            }
            case 20: {
                goto lab_0x8075e56;
            }
            case 19: {
                goto lab_0x8075e56;
            }
            case 12: {
                goto lab_0x8075e56;
            }
            case 2: {
                goto lab_0x8075e56;
            }
            default: {
                if (v9 != 3) {
                    goto lab_0x8075e07;
                } else {
                    // 0x8075dc9
                    if (LYIsUIPage3(str3, 4, 1) != 0) {
                        goto lab_0x8075e56;
                    } else {
                        // 0x8075de8
                        if (LYIsUIPage3(str3, 11, 1) != 0) {
                            goto lab_0x8075e56;
                        } else {
                            goto lab_0x8075e07;
                        }
                    }
                }
            }
        }
    }
  lab_0x8075e56:
    // 0x8075e56
    LYSyslog((char *)*str5);
    switch (v9) {
        case 23: {
        }
        case 1: {
          lab_0x8075e76:
            // 0x8075e76
            HTAlert(gettext("Unsupported URL scheme!"));
            // 0x8077705
            return 3;
        }
    }
    if (v9 == 22) {
        goto lab_0x8075e76;
    }
    if (v9 == 24) {
        // 0x8075e9c
        HTAlert(gettext("Unsupported data: URL!  Use SHOWINFO, for now."));
        result = 3;
        goto lab_0x8077705;
    }
    if (v9 == 43) {
        // 0x8075ec2
        result = printfile(doc);
        goto lab_0x8077705;
    }
    if (v9 == 42) {
        // 0x8075edb
        result = postoptions(doc);
        goto lab_0x8077705;
    }
    if (v9 == 33) {
        // 0x8075ef4
        if (no_lynxcfg_info == 0) {
            // 0x8075eff
            result = lynx_cfg_infopage(doc);
            goto lab_0x8077705;
        }
    }
    if (v9 == 34) {
        // 0x8075f18
        if (no_compileopts_info == 0) {
            // 0x8075f23
            result = lynx_compile_opts(doc);
            goto lab_0x8077705;
        }
    }
    if (v9 > 30 != v9 != 31) {
        // 0x8075f4e
        if (no_newspost == 0) {
            // 0x8075f79
            if (news_ok != 0) {
                // 0x8075fb0
                HTLoadAbsolute((int32_t *)&str3);
                result = 3;
                goto lab_0x8077705;
            } else {
                if (v9 != 28 == (v9 != 29)) {
                    // 0x8075fb0
                    HTLoadAbsolute((int32_t *)&str3);
                    result = 3;
                    goto lab_0x8077705;
                } else {
                    // 0x8075f90
                    HTUserMsg(gettext("USENET news access is disabled!"));
                    result = 3;
                    goto lab_0x8077705;
                }
            }
        } else {
            // 0x8075f59
            HTUserMsg(gettext("News posting is disabled!"));
            result = 3;
            goto lab_0x8077705;
        }
    }
    if (v9 == 37) {
        // 0x8075fcd
        LYDownload((char *)*str5);
        result = 1;
        goto lab_0x8077705;
    }
    if (v9 == 36) {
        // 0x8075ff1
        if (no_dired_support != 0) {
            // 0x8076066
            HTUserMsg(gettext("File management support is disabled!"));
            result = 3;
            goto lab_0x8077705;
        } else {
            // 0x8075ffc
            local_dired(doc);
            str3 = (char *)*str5;
            result = HTLoadAbsolute((int32_t *)&str3) != 0;
            goto lab_0x8077705;
        }
    }
    // 0x8076086
    char * str4; // 0x8075698
    char * v14; // 0x80761f7
    if (LYNoRefererHeader != 0) {
        // 0x80761f7
        v14 = HTLoadedDocumentURL();
        HTSACopy((char **)&LYRequestReferer, v14);
        goto lab_0x807620c;
    } else {
        // 0x8076095
        if (LYNoRefererForThis != 0) {
            // 0x80761f7
            v14 = HTLoadedDocumentURL();
            HTSACopy((char **)&LYRequestReferer, v14);
            goto lab_0x807620c;
        } else {
            char * v15 = HTLoadedDocumentURL(); // 0x80760a4
            str4 = strncasecomp(v15, "LYNXIMGMAP:", 11) != 0 ? v15 : (char *)((int32_t)v15 + 11);
            if (no_filereferer == 1) {
                char v16 = *str4; // 0x80760dd
                if (v16 != 102 != v16 != 70) {
                    // 0x80760ee
                    if (strncasecomp(str4, "file:", 5) == 0) {
                        // 0x807610d
                        LYNoRefererForThis = 1;
                    }
                }
            }
            // 0x8076114
            if (LYNoRefererForThis != 0) {
                goto lab_0x80761d7;
            } else {
                char * found_char_pos3 = strchr(str4, 63); // 0x8076131
                if (found_char_pos3 == NULL) {
                    goto lab_0x80761d7;
                } else {
                    // 0x8076143
                    if (strchr(found_char_pos3, 61) == NULL) {
                        goto lab_0x80761d7;
                    } else {
                        // 0x807615a
                        if (LYRefererWithQuery != 83) {
                            if (LYRefererWithQuery != 80) {
                                // 0x80761c7
                                LYNoRefererForThis = 1;
                            } else {
                                int32_t v17 = LYRequestReferer; // 0x8076185
                                if (v17 != 0) {
                                    // 0x807618e
                                    free((int32_t *)v17);
                                    LYRequestReferer = 0;
                                }
                                // 0x80761a5
                                LYRequestReferer = (int32_t)HTParse(str4, (char *)&g16, 57);
                            }
                        } else {
                            // 0x8076165
                            HTSACopy((char **)&LYRequestReferer, str4);
                        }
                        goto lab_0x807620c;
                    }
                }
            }
        }
    }
  lab_0x807620c:
    if (v9 == 38) {
        // 0x8076216
        result = 0;
        if (doc == NULL | historytarget(doc) == 0) {
            goto lab_0x8077705;
        } else {
            int32_t v18 = *str5; // 0x807622e
            result = 0;
            if (v18 != 0) {
                // 0x8076241
                str3 = (char *)v18;
                lynx_edit_mode = 0;
                result = HTLoadAbsolute((int32_t *)&str3) != 0;
                goto lab_0x8077705;
            } else {
                goto lab_0x8077705;
            }
        }
    }
    if (v9 != 26 != v9 != 27) {
        // 0x80762b7
        if (no_exec == 0) {
            goto lab_0x8076301;
        } else {
            char * v19 = HTLoadedDocumentURL(); // 0x80762cb
            if (exec_ok(v19, (char *)(*str5 + 9), 1) != 0) {
                goto lab_0x8076301;
            } else {
                // 0x80762e8
                HTUserMsg(gettext("Execution is disabled."));
                result = 3;
                goto lab_0x8077705;
            }
        }
    }
    int32_t v20; // 0x8075698
    if (v9 == 16) {
        // 0x8076535
        if (no_mail == 0) {
            int32_t * v21 = HTAnchor_findAddress((int32_t *)&str3); // 0x807655f
            str11 = NULL;
            if (HTAnchor_title(v21) == NULL) {
                // 0x8076597
                v20 = &g16;
                if (HTMainAnchor == NULL) {
                    goto lab_0x807661e;
                } else {
                    // 0x80765a0
                    v20 = &g16;
                    if (LYUserSpecifiedURL != 0) {
                        goto lab_0x807661e;
                    } else {
                        char * v22 = HTAnchor_subject(HTMainAnchor); // 0x80765b3
                        v20 = &g16;
                        if (v22 == NULL) {
                            goto lab_0x807661e;
                        } else {
                            // 0x80765c1
                            v20 = &g16;
                            if (*v22 == 0) {
                                goto lab_0x807661e;
                            } else {
                                int32_t v23 = strncasecomp(v22, "Re:", 3); // 0x80765e1
                                v20 = (int32_t)v22;
                                if (v23 == 0) {
                                    goto lab_0x807661e;
                                } else {
                                    // 0x80765ea
                                    HTSACopy(&str11, "Re: ");
                                    HTSACat(&str11, v22);
                                    v20 = (int32_t)str11;
                                    goto lab_0x807661e;
                                }
                            }
                        }
                    }
                }
            } else {
                // 0x8076584
                v20 = (int32_t)HTAnchor_title(v21);
                goto lab_0x807661e;
            }
        } else {
            // 0x8076540
            HTUserMsg(gettext("Mail access is disabled!"));
            result = 3;
            goto lab_0x8077705;
        }
    }
    // 0x80766d4
    if (local_host_only == 0) {
        goto lab_0x8076771;
    } else {
        switch (v9) {
            case 41: {
                goto lab_0x8076771;
            }
            case 40: {
                goto lab_0x8076771;
            }
            case 39: {
                goto lab_0x8076771;
            }
            case 35: {
                goto lab_0x8076771;
            }
            case 25: {
                goto lab_0x8076771;
            }
            default: {
                if (v9 != 7) {
                    goto lab_0x807672d;
                } else {
                    // 0x807670b
                    if (strncmp((char *)*str5, "news://", 7) != 0) {
                        goto lab_0x8076771;
                    } else {
                        goto lab_0x807672d;
                    }
                }
            }
        }
    }
  lab_0x8075e07:
    // 0x8075e07
    if (WWW_TraceFlag != 0) {
        // 0x8075e12
        fprintf(TraceFP(), "getfile: dropping post_data!\n");
    }
    // 0x8075e29
    HTAlert(gettext("POST not supported for this URL - ignoring POST data!"));
    LYFreePostData(doc);
    goto lab_0x8075e56;
  lab_0x8075ad4:
    // 0x8075ad4
    if (lynxlinksfile == 0) {
        goto lab_0x8075b07;
    } else {
        int32_t len3 = strlen((char *)lynxlinksfile); // 0x8075ae5
        if (strncmp(str3, (char *)lynxlinksfile, len3) == 0) {
            goto lab_0x8075b5a;
        } else {
            goto lab_0x8075b07;
        }
    }
  lab_0x8076771:
    if (v9 > 10 == (v9 != 14)) {
        // 0x80768f0
        if (news_ok == 0) {
            if (v9 != 7 != v9 != 8) {
                // 0x8076907
                HTUserMsg(gettext("USENET news access is disabled!"));
                result = 3;
                goto lab_0x8077705;
            }
        }
        if (v9 != 11) {
            if (v9 != 15) {
                goto lab_0x8076bd0;
            } else {
                // 0x8076a32
                if (strchr((char *)*str5, 63) != NULL) {
                    goto lab_0x8076bd0;
                } else {
                    char * substr_pos = strstr((char *)*str5, "%09"); // 0x8076a61
                    if (substr_pos == NULL) {
                        char v24 = HTLoadAbsolute((int32_t *)&str3); // 0x8076b3f
                        result = 0;
                        if (v24 != 0) {
                            int32_t v25 = do_www_search(doc); // 0x8076b5a
                            if (v25 != 3) {
                                // 0x8076bbe
                                lynx_edit_mode = 0;
                                result = v25;
                                goto lab_0x8077705;
                            } else {
                                // 0x8076b68
                                LYpop(doc);
                                str3 = (char *)*str5;
                                result = HTLoadAbsolute((int32_t *)&str3);
                                goto lab_0x8077705;
                            }
                        } else {
                            goto lab_0x8077705;
                        }
                    }
                    // 0x8076a73
                    *substr_pos = 0;
                    HTSACopy(&pound, (char *)*str5);
                    char * str6 = (char *)((int32_t)substr_pos + 3); // 0x8076a95
                    if (*str6 != 0) {
                        // 0x8076a9c
                        if (strncmp(str6, "%09", 3) != 0) {
                            // 0x8076abb
                            HTSACat(&pound, "?");
                            HTSACat(&pound, str6);
                            char * substr_pos2 = strstr(pound, "%09"); // 0x8076aee
                            if (substr_pos2 != NULL) {
                                // 0x8076afc
                                *substr_pos2 = 0;
                            }
                        }
                    }
                    // 0x8076b02
                    HTSACopy(v5, pound);
                    char * v26 = pound; // 0x8076b17
                    if (v26 != NULL) {
                        // 0x8076b22
                        free((int32_t *)v26);
                        pound = NULL;
                    }
                    goto lab_0x80756fe_2;
                }
            }
        } else {
            // 0x8076931
            if (rlogin_ok == 0) {
                // 0x807693c
                HTUserMsg(gettext("Rlogin access is disabled!"));
                result = 3;
                goto lab_0x8077705;
            }
            char * v27 = LYGetEnv("rlogin_proxy"); // 0x8076963
            if (v27 == NULL) {
                goto lab_0x80769e4_5;
            }
            // 0x8076971
            if (override_proxy((char *)*str5) != 0) {
                goto lab_0x80769e4_5;
            }
            // 0x8076983
            if (strncasecomp(v27, "telnet:", 7) == 0) {
                goto lab_0x80769e4_5;
            }
            // 0x80769a2
            if (strncasecomp(v27, "tn3270:", 7) == 0) {
                goto lab_0x80769e4_5;
            }
            // 0x80769c1
            if (strncasecomp(v27, "rlogin:", 7) == 0) {
                goto lab_0x80769e4_5;
            }
            goto lab_0x8076bd0;
        }
    } else {
        // 0x8076787
        if (telnet_ok == 0) {
            // 0x8076792
            HTUserMsg(gettext("Telnet access is disabled!"));
            result = 3;
            goto lab_0x8077705;
        }
        // 0x80767b2
        if (no_telnet_port != 0) {
            // 0x80767bd
            if (strchr((char *)(*str5 + 7), 58) != NULL) {
                // 0x80767da
                HTUserMsg(gettext("Telnet port specifications are disabled."));
                result = 3;
                goto lab_0x8077705;
            }
        }
        int32_t v28 = v9 != 14 ? (int32_t)"telnet_proxy" : (int32_t)&g17;
        char * v29 = LYGetEnv((char *)(v9 == 10 ? (int32_t)"tn3270_proxy" : v28)); // 0x807682b
        if (v29 == NULL) {
            goto lab_0x80768ac_5;
        }
        // 0x8076839
        if (override_proxy((char *)*str5) != 0) {
            goto lab_0x80768ac_5;
        }
        // 0x807684b
        if (strncasecomp(v29, "telnet:", 7) == 0) {
            goto lab_0x80768ac_5;
        }
        // 0x807686a
        if (strncasecomp(v29, "tn3270:", 7) == 0) {
            goto lab_0x80768ac_5;
        }
        // 0x8076889
        if (strncasecomp(v29, "rlogin:", 7) == 0) {
            goto lab_0x80768ac_5;
        }
        goto lab_0x8076bd0;
    }
  lab_0x80761d7:
    // 0x80761d7
    if (LYNoRefererForThis == 0) {
        // 0x80761e2
        HTSACopy((char **)&LYRequestReferer, str4);
    }
    goto lab_0x807620c;
  lab_0x8075b07:
    // 0x8075b07
    if (lynxjumpfile == 0) {
        goto lab_0x8075b3a_2;
    }
    // 0x8075b10
    if (strncmp(str3, (char *)lynxjumpfile, strlen((char *)lynxjumpfile)) != 0) {
        goto lab_0x8075b3a_2;
    }
    goto lab_0x8075b5a;
  lab_0x8076bd0:
    // 0x8076bd0
    if (ftp_ok == 0) {
        if (v9 != 4 != v9 != 5) {
            // 0x8076be7
            HTUserMsg(gettext("Ftp access is disabled!"));
            result = 3;
            goto lab_0x8077705;
        }
    }
    int32_t v30; // 0x8075698
    if (v9 != 13) {
        goto lab_0x8076d8f;
    } else {
        // 0x8076c11
        str11 = NULL;
        char * found_char_pos4 = strchr((char *)(*str5 + 9), 47); // 0x8076c2c
        if (found_char_pos4 == NULL) {
            goto lab_0x8076d8f;
        } else {
            int32_t v31 = (int32_t)found_char_pos4; // 0x8076c2c
            char * str7 = (char *)(v31 + 1);
            if (strncmp(str7, "hGET%20/", 8) != 0) {
                goto lab_0x8076d8f;
            } else {
                // 0x8076c65
                HTSACopy(&str11, "http://");
                if (WWW_TraceFlag != 0) {
                    // 0x8076c83
                    fprintf(TraceFP(), "getfile: URL '%s'\n", (char *)*str5);
                }
                // 0x8076ca4
                *str7 = 0;
                HTSACat(&str11, (char *)(*str5 + 9));
                if (strchr((char *)((int32_t)str11 + 6), 58) == NULL) {
                    // 0x8076cdc
                    HTSACat(&str11, "70/");
                    char * str8 = str11;
                    *(char *)(strlen(str8) - 4 + (int32_t)str8) = 58;
                }
                // 0x8076d06
                if (strlen((char *)(v31 + 8)) >= 2) {
                    // 0x8076d19
                    HTSACat(&str11, (char *)(v31 + 9));
                }
                // 0x8076d2e
                HTSACopy(v5, str11);
                if (WWW_TraceFlag != 0) {
                    // 0x8076d4e
                    fprintf(TraceFP(), "  changed to '%s'\n", (char *)*str5);
                }
                char * v32 = str11; // 0x8076d6f
                v30 = 2;
                if (v32 != NULL) {
                    // 0x8076d76
                    free((int32_t *)v32);
                    str11 = NULL;
                    v30 = 2;
                }
                goto lab_0x8076dad;
            }
        }
    }
  lab_0x807672d:
    // 0x807672d
    if (LYisLocalHost((char *)*str5) == 0) {
        // 0x807673f
        if (LYisLocalAlias((char *)*str5) == 0) {
            // 0x8076751
            HTUserMsg(gettext("Only files and servers on the local host can be accessed."));
            result = 3;
            goto lab_0x8077705;
        }
    }
    goto lab_0x8076771;
  lab_0x8075cb4:;
    int32_t len4 = strlen((char *)helpfilepath); // 0x8075cbc
    if (strncmp(str3, (char *)helpfilepath, len4) == 0) {
        goto lab_0x8075d68;
    } else {
        // 0x8075ce2
        if (lynxlistfile == 0) {
            goto lab_0x8075d15;
        } else {
            int32_t len5 = strlen((char *)lynxlistfile); // 0x8075cf3
            if (strncmp(str3, (char *)lynxlistfile, len5) == 0) {
                goto lab_0x8075d68;
            } else {
                goto lab_0x8075d15;
            }
        }
    }
  lab_0x8076d8f:
    // 0x8076d8f
    v30 = v9;
    int32_t v33; // 0x8075698
    switch (v9) {
        case 20: {
            goto lab_0x8076dad;
        }
        case 5: {
            goto lab_0x8076dad;
        }
        case 4: {
            goto lab_0x8076dad;
        }
        case 2: {
            goto lab_0x8076dad;
        }
        default: {
            // 0x8076da7
            v30 = v9;
            v33 = v9;
            if (v9 != 19) {
                goto lab_0x8076dbf;
            } else {
                goto lab_0x8076dad;
            }
        }
    }
  lab_0x8076dad:
    // 0x8076dad
    fix_httplike_urls(doc, v30);
    v33 = v30;
    goto lab_0x8076dbf;
  lab_0x8075d15:
    // 0x8075d15
    if (lynxjumpfile == 0) {
        goto lab_0x8075d48_2;
    }
    // 0x8075d1e
    if (strncmp(str3, (char *)lynxjumpfile, strlen((char *)lynxjumpfile)) != 0) {
        goto lab_0x8075d48_2;
    }
    goto lab_0x8075d68;
  lab_0x8076dbf:
    // 0x8076dbf
    str3 = (char *)*str5;
    lynx_edit_mode = 0;
    if (v33 != 17) {
        goto lab_0x8076f1d;
    } else {
        // 0x8076dd9
        str11 = NULL;
        if (BibP_bibhost_checked == 0) {
            // 0x8076deb
            LYCheckBibHost();
        }
        // 0x8076df0
        if (BibP_bibhost_available == 0) {
            // 0x8076e11
            if (HTMainAnchor == NULL) {
                // 0x8076e49
                HTSACopy(&str11, (char *)BibP_globalserver);
                goto lab_0x8076e5d;
            } else {
                // 0x8076e1a
                if (HTAnchor_citehost(HTMainAnchor) == NULL) {
                    // 0x8076e49
                    HTSACopy(&str11, (char *)BibP_globalserver);
                    goto lab_0x8076e5d;
                } else {
                    char * v34 = HTAnchor_citehost(HTMainAnchor); // 0x8076e33
                    HTSACopy(&str11, v34);
                    goto lab_0x8076e5d;
                }
            }
        } else {
            // 0x8076dfb
            HTSACopy(&str11, (char *)BibP_bibhost);
            goto lab_0x8076e5d;
        }
    }
  lab_0x8076f1d:
    if (v33 == 3) {
        // 0x8076f23
        LYTildeExpand(v5, 1);
        str3 = (char *)*str5;
    }
    // 0x8076f42
    if (WWW_TraceFlag != 0) {
        // 0x8076f4d
        if (LYTraceLogFP == NULL) {
            // 0x8076f56
            sleep(MessageSecs);
        }
    }
    // 0x8076f63
    user_message(gettext("Getting %s"), (char *)*str5);
    if (WWW_TraceFlag != 0) {
        // 0x8076f97
        fprintf(TraceFP(), "\n");
    }
    // 0x8076fae
    int32_t * v35; // 0x8077477
    if (HTLoadAbsolute((int32_t *)&str3) != 0) {
        // 0x8077444
        lynx_mode = 1;
        char * found_char_pos5 = strchr((char *)*str5, 35); // 0x807745c
        if (WWW_Download_File == 0) {
            if (found_char_pos5 != NULL) {
                // 0x8077659
                result = 3;
                if (HTMainText != NULL) {
                    // 0x807766e
                    result = 1;
                    if (HTFindPoundSelector((char *)((int32_t)found_char_pos5 + 1)) == 0) {
                        goto lab_0x8077705;
                    } else {
                        // 0x8077680
                        *target = www_search_result;
                        *v6 = -1;
                        result = 1;
                        goto lab_0x8077705;
                    }
                } else {
                    goto lab_0x8077705;
                }
            } else {
                // 0x80775f2
                if (strcmp((char *)*str5, HTLoadedDocumentURL()) != 0) {
                    // 0x807763c
                    LYAddVisitedLink(doc);
                    result = 3;
                    goto lab_0x8077705;
                } else {
                    int32_t * v36 = HTLoadedDocumentPost_data(); // 0x807760f
                    if (HTSABEql((int32_t *)*v3, v36) == 0) {
                        // 0x807763c
                        LYAddVisitedLink(doc);
                        result = 3;
                        goto lab_0x8077705;
                    } else {
                        // 0x807762c
                        result = 1;
                        if (*(char *)(v1 + 20) == HTLoadedDocumentIsHEAD()) {
                            goto lab_0x8077705;
                        } else {
                            // 0x807763c
                            LYAddVisitedLink(doc);
                            result = 3;
                            goto lab_0x8077705;
                        }
                    }
                }
            }
        } else {
            // 0x8077471
            v35 = HTAnchor_findAddress((int32_t *)&str3);
            str11 = NULL;
            if (HTAnchor_SugFname(v35) == NULL) {
                // 0x80774b1
                HTSACopy(&str11, (char *)*str5);
                goto lab_0x80774c6;
            } else {
                char * v37 = HTAnchor_SugFname(v35); // 0x807749b
                HTSACopy(&str11, v37);
                goto lab_0x80774c6;
            }
        }
    }
    // 0x8076fc1
    if (use_this_url_instead == 0) {
        // 0x8077423
        result = HTNoDataOK == 0 ? 0 : 3;
        goto lab_0x8077705;
    }
    // 0x8076fce
    char * v38; // 0x8075698
    if (is_url((char *)use_this_url_instead) != 0) {
        goto lab_0x8077050;
    } else {
        // 0x8076fdf
        HTUserMsg(gettext("Location URL is not absolute."));
        char * v39 = HTParse((char *)use_this_url_instead, str3, 31); // 0x807700b
        pound = v39;
        if (v39 == NULL) {
            goto lab_0x8077050;
        } else {
            // 0x807701a
            v38 = v39;
            if (*v39 == 0) {
                goto lab_0x807703e;
            } else {
                // 0x8077037
                HTSACopy((char **)&use_this_url_instead, v39);
                v38 = pound;
                if (pound == NULL) {
                    goto lab_0x8077050;
                } else {
                    goto lab_0x807703e;
                }
            }
        }
    }
  lab_0x8077050:;
    int32_t v40 = is_url((char *)use_this_url_instead); // 0x8077058
    if (HTPermitRedir == 0) {
        switch (v40) {
            case 43: {
            }
            case 42: {
            }
            case 41: {
            }
            case 38: {
            }
            case 37: {
            }
            case 36: {
            }
            case 35: {
            }
            case 34: {
            }
            case 33: {
            }
            case 27: {
            }
            case 26: {
              lab_0x807725a_18:
                // 0x807725a
                HTAlert(gettext("Illegal redirection URL received from server!"));
                if (LYCursesON == 0) {
                    // 0x8077299
                    fprintf((struct _IO_FILE *)g160, gettext("Illegal URL: %s"));
                } else {
                    // 0x8077279
                    HTUserMsg2(gettext("Illegal URL: %s"), (char *)use_this_url_instead);
                }
                // 0x80772c1
                result = 3;
                if (use_this_url_instead != 0) {
                    // 0x80772ca
                    free((int32_t *)use_this_url_instead);
                    use_this_url_instead = 0;
                    result = 3;
                }
              lab_0x8077705:
                // 0x8077705
                return result;
            }
        }
        // 0x80770dd
        if (v40 != 20 == (v40 != 2 && LYValidate != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x80770f8
        if (v40 == 3 == ((no_goto_file || no_file_url) != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x8077118
        if (v40 == 25 == (no_goto_lynxcgi != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x807712d
        if (v40 == 17 == (no_goto_bibp != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x8077142
        if (v40 == 19 == (no_goto_cso != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x8077157
        if (v40 == 18 == (no_goto_finger != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x807716c
        if ((v40 || 1) == 5 == (no_goto_ftp != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x807718b
        if (v40 == 12 == (no_goto_gopher != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x80771a0
        if (v40 == 2 == (no_goto_http != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x80771b5
        if (v40 == 20 == (no_goto_https != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x80771ca
        if (v40 == 16 == (no_goto_mailto != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x80771db
        if (v40 == 7 == (no_goto_news != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x80771ec
        if (v40 == 8 == (no_goto_nntp != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x80771fd
        if (v40 == 11 == (no_goto_rlogin != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x807720e
        if (v40 == 21 == (no_goto_snews != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x807721f
        if (v40 == 9 == (no_goto_telnet != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x8077230
        if (v40 == 10 == (no_goto_tn3270 != 0)) {
            goto lab_0x807725a_18;
        }
        // 0x8077241
        if (v40 == 6 && no_goto_wais != 0) {
            goto lab_0x807725a_18;
        }
    }
    char * found_char_pos6 = strchr((char *)*str5, 35); // 0x80772fe
    if (found_char_pos6 != NULL) {
        // 0x807730c
        if (strchr((char *)use_this_url_instead, 35) == NULL) {
            // 0x8077325
            if (WWW_TraceFlag != 0) {
                // 0x8077330
                fprintf(TraceFP(), "getfile: Adding fragment '%s' to redirection URL.\n", found_char_pos6);
            }
            // 0x807734e
            HTSACat((char **)&use_this_url_instead, found_char_pos6);
            *v6 = -1;
        }
    }
    // 0x807736b
    if (WWW_TraceFlag != 0) {
        // 0x8077376
        if (LYTraceLogFP == NULL) {
            // 0x807737f
            sleep(MessageSecs);
        }
    }
    // 0x807738c
    HTUserMsg2(gettext("Using %s"), (char *)use_this_url_instead);
    if (WWW_TraceFlag != 0) {
        // 0x80773b5
        fprintf(TraceFP(), "\n");
    }
    // 0x80773cc
    HTSACopy(v5, (char *)use_this_url_instead);
    int32_t v41 = use_this_url_instead; // 0x80773e4
    if (v41 != 0) {
        // 0x80773ed
        free((int32_t *)v41);
        use_this_url_instead = 0;
    }
    // 0x8077404
    if (redirect_post_content == 0) {
        // 0x8077413
        LYFreePostData(doc);
    }
    goto lab_0x80756fe_2;
  lab_0x8076e5d:
    // 0x8076e5d
    if (HTMainAnchor == NULL) {
        // 0x8076ebb
        HTSACat(&str11, "bibp1.0/resolve?usin=");
        goto lab_0x8076ece;
    } else {
        // 0x8076e66
        if (HTAnchor_citehost(HTMainAnchor) == NULL) {
            // 0x8076ebb
            HTSACat(&str11, "bibp1.0/resolve?usin=");
            goto lab_0x8076ece;
        } else {
            // 0x8076e77
            HTSACat(&str11, "bibp1.0/resolve?citehost=");
            char * v42 = HTAnchor_citehost(HTMainAnchor); // 0x8076e92
            HTSACat(&str11, v42);
            HTSACat(&str11, "&usin=");
            goto lab_0x8076ece;
        }
    }
  lab_0x807703e:
    // 0x807703e
    free((int32_t *)v38);
    pound = NULL;
    goto lab_0x8077050;
  lab_0x8076ece:
    // 0x8076ece
    HTSACat(&str11, (char *)(*str5 + 5));
    HTSACopy(v5, str11);
    str3 = (char *)*str5;
    char * v43 = str11; // 0x8076f04
    if (v43 != NULL) {
        // 0x8076f0b
        free((int32_t *)v43);
        str11 = NULL;
    }
    goto lab_0x8076f1d;
  lab_0x807593d:
    // 0x807593d
    result = 3;
    if (pound == NULL) {
        goto lab_0x8077705;
    } else {
        // 0x8075944
        free((int32_t *)pound);
        pound = NULL;
        result = 3;
        goto lab_0x8077705;
    }
  lab_0x8076301:
    // 0x8076301
    if (no_bookmark_exec == 0) {
        goto lab_0x807632e;
    } else {
        // 0x807630c
        if (HTLoadedDocumentBookmark() == NULL) {
            goto lab_0x807632e;
        } else {
            // 0x8076315
            HTUserMsg(gettext("Execution via bookmarks is disabled."));
            result = 3;
            goto lab_0x8077705;
        }
    }
  lab_0x807632e:
    // 0x807632e
    if (local_exec != 0) {
        goto lab_0x8076372;
    } else {
        // 0x8076339
        if (local_exec_on_local_files == 0) {
            goto lab_0x80764c7;
        } else {
            char * v44 = HTLoadedDocumentURL(); // 0x8076351
            if (exec_ok(v44, (char *)(*str5 + 9), 0) == 0) {
                goto lab_0x80764c7;
            } else {
                goto lab_0x8076372;
            }
        }
    }
  lab_0x8076372:
    // 0x8076372
    str11 = NULL;
    char * found_char_pos7 = strrchr((char *)*str5, 47); // 0x807638a
    int32_t str9 = *str5; // 0x8076398
    if ((int32_t)found_char_pos7 - str9 != strlen((char *)str9) - 1) {
        goto lab_0x80763d1;
    } else {
        int32_t str10 = *str5; // 0x80763b7
        *(char *)(str10 - 1 + strlen((char *)str10)) = 0;
        goto lab_0x80763d1;
    }
  lab_0x80763d1:
    // 0x80763d1
    HTSACopy(&str11, (char *)*str5);
    LYTildeExpand(&str11, 1);
    HTInfoMsg((char *)*str5);
    stop_curses();
    int32_t v45 = (int32_t)str11; // 0x8076421
    int32_t v46 = v45 + 9; // 0x8076424
    if (v46 != (int32_t)strstr(str11, "//")) {
        // 0x807643b
        LYSystem((char *)v46);
        goto lab_0x8076449;
    } else {
        // 0x807642b
        LYSystem((char *)(v45 + 11));
        goto lab_0x8076449;
    }
  lab_0x80764c7:
    // 0x80764c7
    str11 = NULL;
    key_for_func(49);
    char * v47 = gettext("Execution is not enabled for this file.  See the Options menu (use %s)."); // 0x80764e3
    HTSprintf0(&str11, v47);
    HTAlert(str11);
    result = 3;
    if (str11 == NULL) {
        goto lab_0x8077705;
    } else {
        // 0x807650d
        free((int32_t *)str11);
        str11 = NULL;
        result = 3;
        goto lab_0x8077705;
    }
  lab_0x8076449:
    // 0x8076449
    if (str11 == NULL) {
        goto lab_0x8076462;
    } else {
        // 0x8076450
        free((int32_t *)str11);
        str11 = NULL;
        goto lab_0x8076462;
    }
  lab_0x8076462:
    if (v9 == 27) {
        goto lab_0x80764aa;
    } else {
        // 0x8076468
        signal(SIGINT, SIG_IGN);
        printf("\n%s", gettext("Press <return> to return to Lynx."));
        fflush((struct _IO_FILE *)g164);
        LYgetch();
        goto lab_0x80764aa;
    }
  lab_0x80764aa:
    // 0x80764aa
    result = 3;
    if (dump_output_immediately != 0) {
        goto lab_0x8077705;
    } else {
        // 0x80764b5
        start_curses();
        LYAddVisitedLink(doc);
        result = 3;
        goto lab_0x8077705;
    }
  lab_0x807661e:;
    char * found_char_pos8 = strchr((char *)*str5, 58); // 0x807662f
    char * v48; // 0x8075698
    int32_t * v49; // 0x8075698
    if (HTMainAnchor == NULL) {
        // 0x8076686
        v48 = NULL;
        v49 = str5;
        goto lab_0x807668f;
    } else {
        // 0x8076643
        v48 = g197;
        v49 = (int32_t *)&LYShowScrollbar;
        if (LYUserSpecifiedURL != 0) {
            // 0x8076686
            v48 = NULL;
            v49 = str5;
            goto lab_0x807668f;
        } else {
            goto lab_0x807668f;
        }
    }
  lab_0x807668f:;
    int32_t v50 = *v49;
    reply_by_mail((char *)((int32_t)found_char_pos8 + 1), (char *)(0x1000000 * v50 >> 24), (char *)v20, v48);
    result = 3;
    if (str11 == NULL) {
        goto lab_0x8077705;
    } else {
        // 0x80766b6
        free((int32_t *)str11);
        str11 = NULL;
        result = 3;
        goto lab_0x8077705;
    }
  lab_0x80774c6:
    // 0x80774c6
    HTCheckFnameForCompression(&str11, v35, 0);
    if (LYdownload_options(&str11, (char *)WWW_Download_File) >= 0) {
        // 0x807751d
        LYAddVisitedLink(doc);
        HTSACopy(v5, str11);
        if (str11 == NULL) {
            goto lab_0x8077556;
        } else {
            // 0x8077544
            free((int32_t *)str11);
            str11 = NULL;
            goto lab_0x8077556;
        }
    } else {
        // 0x80774f8
        result = 0;
        if (str11 == NULL) {
            goto lab_0x8077705;
        } else {
            // 0x80774ff
            free((int32_t *)str11);
            str11 = NULL;
            result = 0;
            goto lab_0x8077705;
        }
    }
  lab_0x8077556:
    // 0x8077556
    *(char *)(v1 + 32) = 0;
    str3 = (char *)*str5;
    LYFreePostData(doc);
    *v4 = 0;
    *(char *)(v1 + 20) = 0;
    *(char *)(v1 + 21) = 0;
    int32_t * v51 = HTAtom_for("www/present"); // 0x80775bb
    *(int32_t *)&HTOutputFormat = (int32_t)v51;
    result = HTLoadAbsolute((int32_t *)&str3) != 0;
    goto lab_0x8077705;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYGetFile.c
// Address range: 0x807770e - 0x8077790
// Line range:    1074 - 1099
void srcmode_for_next_retrieval(int32_t mode) {
    if (mode < 0) {
        int32_t * v1 = HTAtom_for("www/present"); // 0x8077721
        *(int32_t *)&HTOutputFormat = (int32_t)v1;
        psrc_view = 0;
        // 0x807778e
        return;
    }
    if (mode != 0) {
        // 0x8077770
        if (LYpsrc == 0) {
            // 0x8077784
            *(int32_t *)&HTOutputFormat = (int32_t)WWW_SOURCE;
        } else {
            // 0x807777b
            psrc_view = 1;
        }
        // 0x807778e
        return;
    }
    // 0x807773a
    if (HTOutputFormat == WWW_SOURCE) {
        int32_t * v2 = HTAtom_for("www/present"); // 0x8077750
        *(int32_t *)&HTOutputFormat = (int32_t)v2;
        // 0x807778e
        return;
    }
    // 0x807775c
    if (LYpsrc != 0) {
        // 0x8077767
        psrc_view = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYGetFile.c
// Address range: 0x8077790 - 0x8077da8
// Line range:    1125 - 1247
int32_t follow_link_number(int32_t c, int32_t cur, int32_t * doc, int32_t * num) {
    char temp[120]; // bp-140, 0x8077790
    char v1[120]; // 0x80778a7
    char v2[120]; // 0x80777ba
    char v3[120]; // 0x807792b
    char v4[120]; // 0x8077913
    int32_t v5 = __readgsdword(20); // 0x80777ac
    char * v6; // bp-132, 0x8077790
    v2[0] = (int32_t)&v6;
    temp = v2;
    int32_t v7 = *num; // 0x80777d0
    if (WWW_TraceFlag != 0) {
        // 0x80777e3
        fprintf(TraceFP(), "follow_link_number(%d,%d,...)\n", c, cur);
    }
    // 0x807780a
    *(int32_t *)&v6 = c;
    *num = -1;
    mustshow = 1;
    statusline(gettext("Follow link (or goto link or page) number: "));
    int32_t v8; // 0x8077790
    if (LYgetstr((char *)&v6, 0, 120, 0) < 0) {
        goto lab_0x807786a;
    } else {
        // 0x8077862
        if ((char)(int32_t)v6 != 0) {
            int32_t v9 = *(int32_t *)&temp;
            char * str = (char *)v9;
            *num = atoi(str);
            int16_t * v10 = *__ctype_b_loc(); // 0x80778b3
            unsigned char v11 = *str; // 0x80778bb
            int32_t v12 = v9; // 0x80778d3
            char v13 = v11; // 0x80778d3
            if ((*(int16_t *)(2 * (int32_t)v11 + (int32_t)v10) & 2048) != 0) {
                v1[0] = (char)v9 + 1;
                temp = v1;
                int16_t * v14 = *__ctype_b_loc(); // 0x80778b3
                int32_t v15 = *(int32_t *)&temp; // 0x80778b5
                unsigned char v16 = *(char *)v15; // 0x80778bb
                v12 = v15;
                v13 = v16;
                while ((*(int16_t *)(2 * (int32_t)v16 + (int32_t)v14) & 2048) != 0) {
                    // 0x80778a7
                    v1[0] = (char)v15 + 1;
                    temp = v1;
                    v14 = *__ctype_b_loc();
                    v15 = *(int32_t *)&temp;
                    v16 = *(char *)v15;
                    v12 = v15;
                    v13 = v16;
                }
            }
            char * v17 = (char *)(int32_t)v13;
            char * v18 = NULL; // 0x8077790
            char * v19 = v17; // 0x8077790
            char * v20; // 0x80779e1
            switch (v13) {
                case 45: {
                }
                case 43: {
                    // 0x807790a
                    v4[0] = (char)v12 + 1;
                    temp = v4;
                    v18 = v17;
                    v19 = (char *)(int32_t)*(char *)*(int32_t *)&temp;
                }
                case 0: {
                  lab_0x8077944:
                    // 0x8077944
                    v20 = v19;
                    if (WWW_TraceFlag != 0) {
                        int32_t v21 = *num; // 0x8077955
                        struct _IO_FILE * stream = TraceFP(); // 0x8077957
                        fprintf(stream, "  temp=%s, *num=%d, rel='%c'\n", &v6, v21, (char)(int32_t)v18);
                    }
                    // break -> 0x8077985
                    break;
                }
                default: {
                    // 0x807792b
                    v3[0] = (char)v12 + 1;
                    temp = v3;
                    v18 = (char *)(int32_t)*(char *)*(int32_t *)&temp;
                    v19 = v17;
                    // branch (via goto) -> 0x8077944
                    goto lab_0x8077944;
                }
            }
            int32_t v22 = (int32_t)doc;
            if (v20 != (char *)112 == (v20 != (char *)80)) {
                int32_t v23 = *num;
                int32_t v24 = v23; // 0x8077c28
                if (v18 != NULL) {
                    // 0x8077c2a
                    v24 = HTGetRelLinkNum(v23, (int32_t)v18, cur);
                    *num = v24;
                }
                // 0x8077c55
                v8 = 5;
                if (v24 >= 1) {
                    char * v25 = NULL; // bp-176, 0x8077c65
                    int32_t v26 = 68 * cur; // 0x8077c7a
                    char * p; // bp-148, 0x8077790
                    int32_t rel; // bp-152, 0x8077790
                    int32_t v27 = HTGetLinkInfo(v24, (int32_t)(v20 == (char *)103 | v20 == (char *)71), (int32_t *)&p, &rel, &v25, (char **)(v26 + (int32_t)&links)); // 0x8077cba
                    if (v25 != NULL) {
                        // 0x8077ccf
                        LYSetHilite(cur, v25);
                    }
                    if (v27 != 6) {
                        if (v27 != 8) {
                            // 0x8077d46
                            v8 = 5;
                            if (v27 != 0) {
                                // 0x8077d4f
                                *(int32_t *)(v26 + (int32_t)&g347) = 2;
                                v8 = 1;
                            }
                        } else {
                            // 0x8077d19
                            *(int32_t *)(v22 + 28) = (int32_t)p + 1;
                            *(int32_t *)(v22 + 24) = rel;
                            v8 = 2;
                        }
                    } else {
                        // 0x8077ced
                        *(int32_t *)(v26 + (int32_t)&g347) = 6;
                        v8 = 1;
                    }
                }
            } else {
                // 0x8077991
                if (display_lines != 0) {
                    int32_t v28 = HText_getNumOfLines(); // 0x80779f1
                    int32_t v29 = 1; // 0x8077a0c
                    if (v28 + 1 > display_lines) {
                        int32_t v30 = display_lines + v28; // 0x8077a1f
                        v29 = (0x100000000 * (int64_t)(v30 >> 31) | (int64_t)v30) / (int64_t)display_lines;
                    }
                    int32_t v31 = 1; // 0x8077a69
                    if (v7 + 1 > display_lines) {
                        int32_t v32 = display_lines + v7; // 0x8077a7c
                        v31 = (0x100000000 * (int64_t)(v32 >> 31) | (int64_t)v32) / (int64_t)display_lines;
                    }
                    // 0x8077aaa
                    if (WWW_TraceFlag != 0) {
                        // 0x8077ac1
                        fprintf(TraceFP(), " nlines=%d, npages=%d, curline=%d, curpage=%d\n", v28, v29, v7, v31);
                    }
                    int32_t v33 = *num; // 0x8077b08
                    int32_t v34 = v33; // 0x8077b0c
                    if (v33 >= 0 != v33 != 0) {
                        // 0x8077b0e
                        v34 = v18 == NULL;
                        *num = v34;
                    }
                    // 0x8077b23
                    int32_t v35; // 0x8077790
                    if (v18 != (char *)43) {
                        // 0x8077b46
                        v35 = v34;
                        if (v18 == (char *)45) {
                            int32_t v36 = v31 - v34; // 0x8077b5f
                            *num = v36;
                            v35 = v36;
                        }
                    } else {
                        int32_t v37 = v34 + v31; // 0x8077b36
                        *num = v37;
                        v35 = v37;
                    }
                    int32_t v38 = 1; // 0x8077b72
                    if (v29 >= 2) {
                        // 0x8077b74
                        int32_t v39; // 0x8077790
                        if (v35 > v29) {
                            // 0x8077ba2
                            v39 = display_lines * (v29 - 1);
                        } else {
                            // 0x8077b84
                            v39 = display_lines * (v35 - 1);
                        }
                        // 0x8077bbc
                        v38 = v39 + 1;
                    }
                    // 0x8077bd4
                    *(int32_t *)(v22 + 28) = v38;
                    v8 = 3;
                } else {
                    // 0x807799a
                    v8 = 5;
                    if (WWW_TraceFlag != 0) {
                        // 0x80779a5
                        fprintf(TraceFP(), " curline=%d, LYlines=%d, display too small!\n", v7, LYlines);
                        v8 = 5;
                    }
                }
            }
            goto lab_0x8077d88;
        } else {
            goto lab_0x807786a;
        }
    }
  lab_0x807786a:
    // 0x807786a
    HTInfoMsg(gettext("Cancelled!!!"));
    v8 = 270;
    goto lab_0x8077d88;
  lab_0x8077d88:;
    int32_t result = v8; // 0x8077d98
    if (v5 != __readgsdword(20)) {
        // 0x8077d9a
        __stack_chk_fail();
        result = &g391;
    }
    // 0x8077d9f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYGetFile.c
// Address range: 0x8077da8 - 0x8077f0d
// Line range:    1320 - 1369
void add_trusted(char * str, int32_t type) {
    if (str == NULL) {
        // 0x8077f0b
        return;
    }
    // 0x8077dc4
    if (g97 != 0) {
        // 0x8077dcf
        g97 = 0;
    }
    char * found_char_pos = strchr(str, 9); // 0x8077de4
    char * v1 = (char *)&g16; // 0x8077df0
    if (found_char_pos != NULL) {
        // 0x8077df2
        *found_char_pos = 0;
        v1 = (char *)((int32_t)found_char_pos + 1);
    }
    int32_t * mem = malloc(16); // 0x8077e0c
    if (mem == NULL) {
        // 0x8077e1a
        outofmem("./LYGetFile.c", "add_trusted");
        // UNREACHABLE
    }
    int32_t v2 = (int32_t)mem; // 0x8077e0c
    *mem = 0;
    int32_t v3 = v2 + 4; // 0x8077e3a
    *(int32_t *)v3 = 0;
    *(int32_t *)(v2 + 8) = type;
    HTSACopy((char **)mem, str);
    HTSACopy((char **)v3, v1);
    if (type == 0) {
        // 0x8077e77
        if (trusted_exec != &trusted_exec_default) {
            // 0x8077e8f
            *(int32_t *)(v2 + 12) = (int32_t)trusted_exec;
        } else {
            // 0x8077e83
            *(int32_t *)(v2 + 12) = 0;
        }
        // 0x8077e9b
        *(int32_t *)&trusted_exec = v2;
        // 0x8077f0b
        return;
    }
    char * v4 = (char *)type; // 0x8077db7
    if (v4 == (char *)1) {
        // 0x8077eab
        if (always_trusted_exec != &always_trusted_exec_default) {
            // 0x8077ec3
            *(int32_t *)(v2 + 12) = (int32_t)always_trusted_exec;
        } else {
            // 0x8077eb7
            *(int32_t *)(v2 + 12) = 0;
        }
        // 0x8077ecf
        *(int32_t *)&always_trusted_exec = v2;
        // 0x8077f0b
        return;
    }
    if (v4 != (char *)2) {
        // 0x8077f0b
        return;
    }
    // 0x8077edf
    if (trusted_cgi != &trusted_cgi_default) {
        // 0x8077ef7
        *(int32_t *)(v2 + 12) = (int32_t)trusted_cgi;
    } else {
        // 0x8077eeb
        *(int32_t *)(v2 + 12) = 0;
    }
    // 0x8077f03
    *(int32_t *)&trusted_cgi = v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYGetFile.c
// Address range: 0x8077f0d - 0x80781e2
// Line range:    1377 - 1476
char exec_ok(char * source, char * linktext, int32_t type) {
    // 0x8077f0d
    if (LYJumpFileURL != 0) {
        // 0x80781d8
        return 1;
    }
    char * v1 = (char *)type;
    int32_t ** v2 = &trusted_exec; // 0x8077f32
    if (type != 0) {
        // 0x8077f3e
        v2 = &always_trusted_exec;
        if (v1 != (char *)1) {
            // 0x8077f4e
            v2 = &trusted_cgi;
            if (v1 != (char *)2) {
                // 0x8077f5e
                HTAlert(gettext("Executable link rejected due to malformed request."));
                // 0x80781d8
                return 0;
            }
        }
    }
    // 0x8077f7b
    if (strstr(linktext, "../") != NULL) {
        // 0x8077f92
        HTAlert(gettext("Executable link rejected due to relative path string ('../')."));
        // 0x80781d8
        return 0;
    }
    // 0x8077faf
    if (*linktext != 0) {
        char * str = v1 != (char *)2 ? " _-:./@~$+=\t" : " _-:./@~$&+=\t";
        int16_t * v3 = *__ctype_b_loc(); // 0x8077fd5
        unsigned char c = *linktext; // 0x8077fda
        char * allowed_extra_chars; // bp-28, 0x8077f0d
        char * v4; // 0x8078025
        if ((*(int16_t *)(2 * (int32_t)c + (int32_t)v3) & 8) == 0) {
            // 0x8077ff2
            if (strchr(str, (int32_t)c) == NULL) {
                // 0x807800e
                allowed_extra_chars = NULL;
                v4 = gettext("Executable link rejected due to `%c' character.");
                HTSprintf0(&allowed_extra_chars, v4);
                HTAlert(allowed_extra_chars);
                if (allowed_extra_chars == NULL) {
                    return 0;
                } else {
                    // 0x807804f
                    free((int32_t *)allowed_extra_chars);
                    allowed_extra_chars = NULL;
                    return 0;
                }
            }
        }
        int32_t v5 = (int32_t)(int32_t *)linktext + 1; // 0x807806a
        char * v6 = (char *)v5; // 0x8078071
        int32_t * v7 = (int32_t *)v5; // 0x8078076
        while (*v6 != 0) {
            // 0x8077fd0
            v3 = *__ctype_b_loc();
            c = *v6;
            if ((*(int16_t *)(2 * (int32_t)c + (int32_t)v3) & 8) == 0) {
                // 0x8077ff2
                if (strchr(str, (int32_t)c) == NULL) {
                    // 0x807800e
                    allowed_extra_chars = NULL;
                    v4 = gettext("Executable link rejected due to `%c' character.");
                    HTSprintf0(&allowed_extra_chars, v4);
                    HTAlert(allowed_extra_chars);
                    if (allowed_extra_chars == NULL) {
                        return 0;
                    } else {
                        // 0x807804f
                        free((int32_t *)allowed_extra_chars);
                        allowed_extra_chars = NULL;
                        return 0;
                    }
                }
            }
            // 0x807806a
            v5 = (int32_t)v7 + 1;
            v6 = (char *)v5;
            v7 = (int32_t *)v5;
        }
    }
    int32_t v8 = (int32_t)linktext;
    int32_t * v9 = *v2;
    char * v10 = v1;
    int32_t * str2; // 0x8077f0d
    int32_t str4; // 0x8077f0d
    int32_t v11; // 0x8077f0d
    int32_t v12; // 0x807817c
    int32_t * str3; // 0x8078149
    int32_t len; // 0x807814f
    int32_t v13; // 0x80780f4
    if (v9 != NULL) {
        // 0x8078081
        v11 = (int32_t)v9;
        if (*(int32_t *)(v11 + 8) == (int32_t)v10) {
            // 0x8078090
            str4 = strstr(linktext, "//") != linktext ? v8 : v8 + 2;
            str2 = (int32_t *)v11;
            if (WWW_TraceFlag != 0) {
                // 0x80780e6
                fprintf(TraceFP(), "comparing source\n\t'%s'\n\t'%s'\n", source, (char *)*str2);
                if (WWW_TraceFlag != 0) {
                    // 0x80780f1
                    v13 = *(int32_t *)(v11 + 4);
                    fprintf(TraceFP(), "comparing command\n\t'%s'\n\t'%s'\n", (char *)str4, (char *)v13);
                }
            }
            // 0x807811b
            if (strncmp(source, (char *)*str2, strlen((char *)*str2)) == 0) {
                // 0x8078146
                str3 = (int32_t *)(v11 + 4);
                len = strlen((char *)*str3);
                if (strncmp((char *)str4, (char *)*str3, len) == 0) {
                    // 0x80781d8
                    return 1;
                }
            }
        }
        // 0x8078179
        v12 = *(int32_t *)(v11 + 12);
        while (v12 != 0) {
            // 0x8078081
            v11 = v12;
            if (*(int32_t *)(v11 + 8) == (int32_t)v10) {
                // 0x8078090
                str4 = strstr(linktext, "//") != linktext ? v8 : v8 + 2;
                str2 = (int32_t *)v11;
                if (WWW_TraceFlag != 0) {
                    // 0x80780e6
                    fprintf(TraceFP(), "comparing source\n\t'%s'\n\t'%s'\n", source, (char *)*str2);
                    if (WWW_TraceFlag != 0) {
                        // 0x80780f1
                        v13 = *(int32_t *)(v11 + 4);
                        fprintf(TraceFP(), "comparing command\n\t'%s'\n\t'%s'\n", (char *)str4, (char *)v13);
                    }
                }
                // 0x807811b
                if (strncmp(source, (char *)*str2, strlen((char *)*str2)) == 0) {
                    // 0x8078146
                    str3 = (int32_t *)(v11 + 4);
                    len = strlen((char *)*str3);
                    if (strncmp((char *)str4, (char *)*str3, len) == 0) {
                        // 0x80781d8
                        return 1;
                    }
                }
            }
            // 0x8078179
            v12 = *(int32_t *)(v11 + 12);
        }
    }
    int32_t * v14 = always_trusted_exec; // 0x8078192
    while (v10 == NULL && v14 != &always_trusted_exec_default) {
        // 0x8078182
        v9 = v14;
        v10 = (char *)1;
        if (v9 != NULL) {
            // 0x8078081
            v11 = (int32_t)v9;
            if (*(int32_t *)(v11 + 8) == (int32_t)v10) {
                // 0x8078090
                str4 = strstr(linktext, "//") != linktext ? v8 : v8 + 2;
                str2 = (int32_t *)v11;
                if (WWW_TraceFlag != 0) {
                    // 0x80780e6
                    fprintf(TraceFP(), "comparing source\n\t'%s'\n\t'%s'\n", source, (char *)*str2);
                    if (WWW_TraceFlag != 0) {
                        // 0x80780f1
                        v13 = *(int32_t *)(v11 + 4);
                        fprintf(TraceFP(), "comparing command\n\t'%s'\n\t'%s'\n", (char *)str4, (char *)v13);
                    }
                }
                // 0x807811b
                if (strncmp(source, (char *)*str2, strlen((char *)*str2)) == 0) {
                    // 0x8078146
                    str3 = (int32_t *)(v11 + 4);
                    len = strlen((char *)*str3);
                    if (strncmp((char *)str4, (char *)*str3, len) == 0) {
                        // 0x80781d8
                        return 1;
                    }
                }
            }
            // 0x8078179
            v12 = *(int32_t *)(v11 + 12);
            while (v12 != 0) {
                // 0x8078081
                v11 = v12;
                if (*(int32_t *)(v11 + 8) == (int32_t)v10) {
                    // 0x8078090
                    str4 = strstr(linktext, "//") != linktext ? v8 : v8 + 2;
                    str2 = (int32_t *)v11;
                    if (WWW_TraceFlag != 0) {
                        // 0x80780e6
                        fprintf(TraceFP(), "comparing source\n\t'%s'\n\t'%s'\n", source, (char *)*str2);
                        if (WWW_TraceFlag != 0) {
                            // 0x80780f1
                            v13 = *(int32_t *)(v11 + 4);
                            fprintf(TraceFP(), "comparing command\n\t'%s'\n\t'%s'\n", (char *)str4, (char *)v13);
                        }
                    }
                    // 0x807811b
                    if (strncmp(source, (char *)*str2, strlen((char *)*str2)) == 0) {
                        // 0x8078146
                        str3 = (int32_t *)(v11 + 4);
                        len = strlen((char *)*str3);
                        if (strncmp((char *)str4, (char *)*str3, len) == 0) {
                            // 0x80781d8
                            return 1;
                        }
                    }
                }
                // 0x8078179
                v12 = *(int32_t *)(v11 + 12);
            }
        }
        // 0x807818c
        v14 = always_trusted_exec;
    }
    // 0x80781af
    if (v1 == (char *)1 != no_exec != 0) {
        // 0x80781c0
        HTAlert(gettext("Executable link rejected due to location or path."));
    }
  lab_0x80781d8:
    // 0x80781d8
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYGetFile.c
// Address range: 0x80781e2 - 0x80785c4
// Line range:    1480 - 1574
int32_t fix_httplike_urls(int32_t * doc, int32_t type) {
    int32_t v1 = (int32_t)doc + 4; // 0x80781ec
    int32_t * str = (int32_t *)v1; // 0x80781ec
    if (strchr((char *)*str, 35) != NULL) {
        // 0x80785bb
        return 0;
    }
    if (type != 4) {
        goto lab_0x807837f;
    } else {
        int32_t str2 = *str; // 0x807821c
        if (*(char *)(str2 - 1 + strlen((char *)str2)) != 47) {
            goto lab_0x807837f;
        } else {
            char * v2 = HTParse((char *)*str, (char *)&g16, 5); // 0x8078257
            if (v2 != NULL) {
                // 0x8078265
                if (*v2 == 47) {
                    // 0x807826f
                    if (*(char *)((int32_t)v2 + 1) == 0) {
                        // 0x8078282
                        free((int32_t *)v2);
                        // 0x80785bb
                        return 0;
                    }
                }
                // 0x80782a6
                free((int32_t *)v2);
            }
            // 0x80782b8
            if (LYGetEnv("ftp_proxy") != NULL) {
                // 0x80782cd
                if (override_proxy((char *)*str) == 0) {
                    // 0x80785bb
                    return 0;
                }
            }
            // 0x80782eb
            if (WWW_TraceFlag != 0) {
                // 0x80782f6
                fprintf(TraceFP(), "fix_httplike_urls: URL '%s'\n", (char *)*str);
            }
            // 0x8078317
            LYTrimHtmlSep((char *)*str);
            if (WWW_TraceFlag != 0) {
                // 0x8078351
                fprintf(TraceFP(), "            changed to '%s'\n", (char *)*str);
                if (WWW_TraceFlag != 0) {
                    // 0x8078360
                    if (LYTraceLogFP == NULL) {
                        // 0x807836d
                        sleep(MessageSecs);
                    }
                }
            }
            goto lab_0x8078486;
        }
    }
  lab_0x807837f:
    if (type == 5) {
        int32_t v3 = 0; // bp-24, 0x8078389
        char * str3 = (char *)*str; // 0x8078396
        char * found_char_pos = strchr(str3, 58); // 0x80783a7
        if (WWW_TraceFlag != 0) {
            // 0x80783ba
            fprintf(TraceFP(), "fix_httplike_urls: URL '%s'\n", (char *)*str);
        }
        // 0x80783db
        *found_char_pos = 0;
        HTSprintf0((char **)&v3, "%s//%s%s", "ftp:", str3, (char *)((int32_t)found_char_pos + 1));
        int32_t v4 = *str; // 0x8078411
        if (v4 != 0) {
            // 0x8078418
            free((int32_t *)v4);
            *str = 0;
        }
        // 0x8078430
        *str = v3;
        if (WWW_TraceFlag != 0) {
            // 0x8078465
            fprintf(TraceFP(), "            changed to '%s'\n", (char *)v3);
            if (WWW_TraceFlag != 0) {
                // 0x8078470
                if (LYTraceLogFP == NULL) {
                    // 0x8078479
                    sleep(MessageSecs);
                }
            }
        }
    }
    goto lab_0x8078486;
  lab_0x8078486:;
    char * found_char_pos2 = strrchr((char *)*str, 47); // 0x8078497
    if (found_char_pos2 != NULL) {
        int32_t v5 = (int32_t)found_char_pos2; // 0x8078497
        if (*(char *)(v5 - 1) != 47) {
            // 0x80785bb
            return 0;
        }
        int32_t v6 = v5 - 2; // 0x80784b9
        if (*(char *)v6 != 58) {
            // 0x80785bb
            return 0;
        }
        if (type != 2 != type != 20) {
            // 0x80784db
            if (v6 != (int32_t)strchr((char *)*str, 58) || strchr((char *)*str, 63) != NULL) {
                // 0x80785bb
                return 0;
            }
        }
    }
    // 0x807852d
    if (WWW_TraceFlag != 0) {
        // 0x8078538
        fprintf(TraceFP(), "fix_httplike_urls: URL '%s'\n", (char *)*str);
    }
    // 0x8078559
    LYAddHtmlSep((char **)v1);
    if (WWW_TraceFlag == 0) {
        // 0x80785bb
        return 1;
    }
    // 0x8078593
    fprintf(TraceFP(), "            changed to '%s'\n", (char *)*str);
    if (WWW_TraceFlag == 0) {
        // 0x80785bb
        return 1;
    }
    // 0x807859e
    if (LYTraceLogFP == NULL) {
        // 0x80785a7
        sleep(MessageSecs);
    }
    // 0x80785bb
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x80785c4 - 0x80785e3
// Line range:    819 - 822
void LYStdinArgs_free(void) {
    // 0x80785c4
    LYFreeStringList(LYStdinArgs);
    *(int32_t *)&LYStdinArgs = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x80785e3 - 0x8078646
// Line range:    825 - 837
void reset_signals(void) {
    // 0x80785e3
    signal(SIGHUP, SIG_DFL);
    signal(SIGTERM, SIG_DFL);
    signal(SIGINT, SIG_DFL);
    if (no_suspend != 0) {
        // 0x8078630
        signal(SIGCHLD, SIG_DFL);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x8078646 - 0x807865e
// Line range:    840 - 843
void exit_immediately(int32_t code) {
    // 0x8078646
    reset_signals();
    LYexit(code);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x807865e - 0x8078739
// Line range:    888 - 897
char GetStdin(char ** buf, char marker) {
    // 0x807865e
    if (LYSafeGets(buf, g163) == NULL) {
        goto lab_0x80786e8;
    } else {
        if (marker == 0) {
            goto lab_0x80786aa;
        } else {
            // 0x8078689
            if (strncmp(*buf, "---", 3) == 0) {
                goto lab_0x80786e8;
            } else {
                goto lab_0x80786aa;
            }
        }
    }
  lab_0x80786e8:
    // 0x80786e8
    if (WWW_TraceFlag != 0) {
        char * v1 = *buf;
        struct _IO_FILE * stream = TraceFP(); // 0x807870d
        fprintf(stream, "...mark: %s\n", v1 == NULL ? (char *)&g18 : v1);
    }
    // 0x807872f
    return 0;
  lab_0x80786aa:
    // 0x80786aa
    LYTrimTrailing(*buf);
    if (WWW_TraceFlag != 0) {
        // 0x80786c2
        fprintf(TraceFP(), "...data: %s\n", *buf);
    }
    // 0x807872f
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x8078739 - 0x8078790
// Line range:    955 - 973
void SetLocale(void) {
    // 0x8078739
    setlocale(LC_ALL, (char *)&g18);
    char * v1 = LYGetEnv("LYNX_LOCALEDIR"); // 0x807875a
    bindtextdomain("lynx", v1 != NULL ? v1 : "/usr/share/locale");
    textdomain("lynx");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x8078790 - 0x807a470
// Line range:    980 - 2203
int main(int argc, char ** argv) {
    char filename[256]; // bp-284, 0x8078790
    // 0x8078790
    int32_t v1; // 0x8078790
    int32_t v2 = *(int32_t *)((int32_t)&v1 + 4); // 0x80787b3
    __readgsdword(20);
    int32_t i2 = 0; // bp-556, 0x80787d1
    ftp_lasthost = (int32_t)calloc(1, 1);
    LYShowColor = 2;
    int32_t v3 = *(int32_t *)v2; // 0x807880b
    pgm = v3;
    char * v4 = LYLastPathSep((char *)v3); // 0x8078824
    if (v4 != NULL) {
        // 0x8078838
        pgm = (int32_t)v4 + 1;
    }
    // 0x8078846
    if (LYGetEnv("LYNX_TRACE") != NULL) {
        // 0x8078856
        WWW_TraceFlag = 1;
    }
    char * v5 = LYGetEnv("LYNX_TRACE_FILE"); // 0x8078864
    int32_t * mem = malloc(256); // 0x8078889
    LYTraceLogPath = (int32_t)mem;
    LYAddPathToHome((char *)mem, 256, v5 != NULL ? v5 : (char *)&g19);
    int32_t i = 1;
    if (v1 > 1) {
        parse_arg((char **)(4 + v2), 1, &i);
        int32_t v6 = i + 1; // 0x80788f0
        i = v6;
        while (v6 < v1) {
            // 0x80788bf
            parse_arg((char **)(4 * v6 + v2), 1, &i);
            v6 = i + 1;
            i = v6;
        }
    }
    // 0x8078909
    LYOpenTraceLog();
    SetLocale();
    memset(&links, 0, 0x11000);
    LYAllocHistory(8);
    memset(&MBM_A_subbookmark, 0, 26);
    memset(&MBM_A_subdescript, 0, 26);
    HTSACopy((char **)&list_format, "    %p %4l %-8.8o %-8.8g %7s %-12.12d %a");
    AlertSecs = 3000;
    DebugSecs = 0;
    InfoSecs = 1000;
    MessageSecs = 2000;
    ReplaySecs = 0;
    HTSACopy((char **)&LYTransferName, "KiB");
    HTSACopy((char **)&helpfile, "http://lynx.isc.org/release/lynx2-8-6/lynx_help/lynx_help_main.html");
    HTSACopy((char **)&startfile, "http://lynx.isc.org/");
    LYEscapeStartfile((char **)&startfile);
    HTSACopy((char **)&indexfile, "http://www.ncsa.uiuc.edu/SDG/Software/Mosaic/MetaIndex.html");
    HTSACopy((char **)&global_type_map, "/etc/mailcap");
    HTSACopy((char **)&personal_type_map, "~/.mailcap");
    HTSACopy((char **)&global_extension_map, "/etc/mime.types");
    HTSACopy((char **)&personal_extension_map, "~/.mime.types");
    HTSACopy((char **)&language, "en");
    HTSACopy((char **)&pref_charset, (char *)&g18);
    HTSACopy((char **)&system_mail, "/usr/sbin/sendmail");
    HTSACopy((char **)&system_mail_flags, "-t -oi");
    HTSACopy((char **)&LYUserAgent, "Lynx");
    HTSACat((char **)&LYUserAgent, "/");
    HTSACat((char **)&LYUserAgent, "2.8.7dev.11");
    if (HTLibraryVersion != NULL) {
        // 0x8078afa
        HTSACat((char **)&LYUserAgent, " libwww-FM/");
        HTSACat((char **)&LYUserAgent, HTLibraryVersion);
    }
    // 0x8078b23
    HTSACopy((char **)&LYUserAgentDefault, (char *)LYUserAgent);
    HTSACopy((char **)&lynx_version_putenv_command, "LYNX_VERSION=");
    HTSACat((char **)&lynx_version_putenv_command, "2.8.7dev.11");
    putenv((char *)lynx_version_putenv_command);
    char * v7 = LYGetEnv("LYNX_TEMP_SPACE"); // 0x8078b74
    if (v7 == NULL) {
        char * v8 = LYGetEnv("TMPDIR"); // 0x8078ba7
        if (v8 == NULL) {
            // 0x8078bd3
            HTSACopy((char **)&lynx_temp_space, "/tmp/");
        } else {
            // 0x8078bbb
            HTSACopy((char **)&lynx_temp_space, v8);
        }
    } else {
        // 0x8078b88
        HTSACopy((char **)&lynx_temp_space, v7);
    }
    // 0x8078be7
    LYTildeExpand((char **)&lynx_temp_space, 1);
    char * substr_pos = strstr((char *)lynx_temp_space, "$USER"); // 0x8078c0b
    if (substr_pos != NULL) {
        char * v9 = LYGetEnv("USER"); // 0x8078c2a
        if (v9 != NULL) {
            // 0x8078c42
            *substr_pos = 0;
            HTSACopy((char **)&i2, (char *)lynx_temp_space);
            *substr_pos = 36;
            HTSACat((char **)&i2, v9);
            HTSACat((char **)&i2, (char *)((int32_t)substr_pos + 5));
            HTSACopy((char **)&lynx_temp_space, (char *)i2);
            int32_t v10 = i2; // 0x8078cb8
            if (v10 != 0) {
                // 0x8078cc2
                free((int32_t *)v10);
                i2 = 0;
            }
        }
    }
    // 0x8078cda
    LYAddPathSep((char **)&lynx_temp_space);
    HTSACopy((char **)&lynx_temp_space, (char *)lynx_temp_space);
    int32_t dir_info; // bp-692, 0x8078790
    if (HTStat((char *)lynx_temp_space, &dir_info) >= 0) {
        goto lab_0x8078d30;
    } else {
        // 0x8078d17
        if (mkdir((char *)lynx_temp_space, 448) < 0) {
            goto lab_0x8078d42;
        } else {
            goto lab_0x8078d30;
        }
    }
  lab_0x8078ff3:;
    // 0x8078ff3
    int32_t * fp; // bp-572, 0x8078790
    if (WWW_TraceFlag != 0) {
        // 0x8078ffe
        fprintf(TraceFP(), "...complete:%s\n", fp);
    }
    goto lab_0x807901f;
  lab_0x807901f:
    // 0x807901f
    if (GetStdin((char **)&fp, 1) == 0) {
        // break -> 0x807903d
        goto lab_0x807903d;
    }
    goto lab_0x8078f21;
  lab_0x8078d30:;
    char v16; // 0x8078790
    char * v13; // bp-588, 0x8078790
    int32_t v11; // bp-596, 0x8078790
    int32_t v17; // 0x8078790
    if ((v17 & 0xf000) == 0x4000) {
        char * v18 = HTHostName(); // 0x8078d7e
        HTSACopy((char **)&LYHostName, v18);
        HTSACopy((char **)&LYLocalDomain, "ukans.edu");
        HTSACopy((char **)&URLDomainPrefixes, "www.");
        HTSACopy((char **)&URLDomainSuffixes, ".com,.edu,.net,.org");
        HTSACopy((char **)&XLoadImageCommand, "xli %s &");
        HTSACopy((char **)&SSL_cert_file, NULL);
        HTSACopy((char **)&BibP_globalserver, "http://usin.org/");
        HTSACopy((char **)&BibP_bibhost, "http://bibhost/");
        no_newspost = LYNewsPosting == 0;
        i = 1;
        if (v1 > 1) {
            parse_arg((char **)(4 + v2), 2, &i);
            int32_t v19 = i + 1; // 0x8078e6d
            i = v19;
            int32_t v20 = v19; // 0x8078e84
            while (v19 < v1) {
                // 0x8078e3c
                parse_arg((char **)(4 * v20 + v2), 2, &i);
                v19 = i + 1;
                i = v19;
                v20 = v19;
            }
            // 0x8078ecf
            i = 1;
            v16 = 0;
            if (v1 > 1) {
                int32_t str = *(int32_t *)(4 + v2); // 0x8078ea1
                while (strcmp((char *)str, "-") != 0) {
                    int32_t v21 = i + 1; // 0x8078ec6
                    i = v21;
                    v16 = 0;
                    if (v21 >= v1) {
                        goto lab_0x8079081;
                    }
                    str = *(int32_t *)(4 * v21 + v2);
                }
                // 0x8078eec
                fp = NULL;
                if (WWW_TraceFlag != 0) {
                    // 0x8078f05
                    fprintf(TraceFP(), "processing stdin arguments\n");
                }
                // 0x807901f
                if (GetStdin((char **)&fp, 1) != 0) {
                    while (true) {
                      lab_0x8078f21:
                        // 0x8078f21
                        v11 = (int32_t)fp;
                        LYTrimTrailing((char *)fp);
                        if (parse_arg((char **)&v11, 2, NULL) != 0) {
                            goto lab_0x8078ff3;
                        } else {
                            int32_t * v12 = fp; // 0x8078f6b
                            if (*(char *)v12 == 0) {
                                goto lab_0x8078ff3;
                            } else {
                                // 0x8078f78
                                v13 = NULL;
                                char * v14 = (char *)v12; // 0x8078f89
                                if (LYStdinArgs == NULL) {
                                    int32_t * v15 = HTList_new(); // 0x8078f8b
                                    *(int32_t *)&LYStdinArgs = (int32_t)v15;
                                    v14 = (char *)fp;
                                }
                                // 0x8078f95
                                HTSACopy(&v13, v14);
                                HTList_appendObject(LYStdinArgs, v13);
                                if (WWW_TraceFlag != 0) {
                                    // 0x8078fd0
                                    fprintf(TraceFP(), "...StdinArg:%s\n", v13);
                                }
                                goto lab_0x807901f;
                            }
                        }
                    }
                }
              lab_0x807903d:
                // 0x807903d
                if (WWW_TraceFlag != 0) {
                    // 0x8079048
                    fprintf(TraceFP(), "...done with stdin arguments\n");
                }
                // 0x807905f
                v16 = 1;
                if (fp != NULL) {
                    // 0x8079069
                    free(fp);
                    fp = NULL;
                    v16 = 1;
                }
            }
        } else {
            // 0x8078ecf
            i = 1;
            v16 = 0;
        }
      lab_0x8079081:
        // 0x8079081
        if (LYValidate == 1) {
            // 0x807908c
            parse_restrictions("all");
            LYUseTraceLog = 0;
        }
        // 0x807909f
        if (lynx_cmd_script != 0) {
            // 0x80790a8
            LYTildeExpand((char **)&lynx_cmd_script, 1);
            LYOpenCmdScript();
        }
        // 0x80790c1
        if (lynx_cmd_logfile != 0) {
            // 0x80790ca
            LYTildeExpand((char **)&lynx_cmd_logfile, 1);
            LYOpenCmdLogfile(v1, (char **)v2);
        }
        char * v22 = gettext("Jump to (use '?' for list): "); // 0x80790ff
        HTSACopy((char **)&jumpprompt, v22);
        if (lynx_cfg_file != 0) {
            goto lab_0x8079169;
        } else {
            char * v23 = LYGetEnv("LYNX_CFG"); // 0x8079124
            if (v23 != NULL) {
                // 0x8079153
                HTSACopy((char **)&lynx_cfg_file, v23);
                goto lab_0x8079169;
            } else {
                char * v24 = LYGetEnv("lynx_cfg"); // 0x807913f
                if (v24 == NULL) {
                    goto lab_0x8079169;
                } else {
                    // 0x8079153
                    HTSACopy((char **)&lynx_cfg_file, v24);
                    goto lab_0x8079169;
                }
            }
        }
    } else {
        goto lab_0x8078d42;
    }
  lab_0x8078d42:
    // 0x8078d42
    fprintf((struct _IO_FILE *)g160, "%s: %s\n", (char *)lynx_temp_space, gettext("No such directory"));
    exit_immediately(1);
    // UNREACHABLE
  lab_0x8079169:
    // 0x8079169
    if (lynx_cfg_file == 0) {
        // 0x8079172
        HTSACopy((char **)&lynx_cfg_file, "/etc/lynx-cur/lynx.cfg");
    }
    // 0x8079186
    LYTildeExpand((char **)&lynx_cfg_file, 0);
    if (LYCanReadFile((char *)lynx_cfg_file) == 0) {
        // 0x80791ab
        fprintf((struct _IO_FILE *)g160, gettext("\nConfiguration file \"%s\" is not available.\n\n"));
        exit_immediately(1);
        // UNREACHABLE
    }
    // 0x80791df
    if (LYCharSetsDeclared() == 0) {
        // 0x80791e8
        fprintf((struct _IO_FILE *)g160, gettext("\nLynx character sets not declared.\n\n"));
        exit_immediately(1);
        // UNREACHABLE
    }
    // 0x8079212
    current_char_set = safeUCGetLYhndl_byMIME("iso-8859-1");
    UCLYhndl_for_unspec = LATIN1;
    int32_t v25 = *(int32_t *)(32 * LATIN1 + (int32_t)&g143); // 0x8079235
    HTSACopy((char **)&UCAssume_MIMEcharset, (char *)v25);
    if (LYEditmapDeclared() == 0) {
        // 0x8079254
        fprintf((struct _IO_FILE *)g160, gettext("\nLynx edit map not declared.\n\n"));
        exit_immediately(1);
        // UNREACHABLE
    }
    // 0x807927e
    lynx_setup_colors();
    if (strcmp(Current_Dir(filename), ".") != 0) {
        // 0x80792d8
        HTSACopy((char **)&original_dir, filename);
    } else {
        char * v26 = LYGetEnv("PWD"); // 0x80792ac
        if (v26 != NULL) {
            // 0x80792c0
            HTSACopy((char **)&original_dir, v26);
        }
    }
    // 0x80792ee
    LYstrncpy(filename, ".lynxsig", 255);
    if (LYPathOffHomeOK(filename, 256) == 0) {
        // 0x807939f
        if (WWW_TraceFlag != 0) {
            // 0x80793aa
            fprintf(TraceFP(), "LYNX_SIG_FILE '%s' is bad. Ignoring.\n", ".lynxsig");
        }
    } else {
        // 0x8079326
        HTSACopy((char **)&LynxSigFile, filename);
        LYAddPathToHome(filename, 256, (char *)LynxSigFile);
        HTSACopy((char **)&LynxSigFile, filename);
        if (WWW_TraceFlag != 0) {
            // 0x807937c
            fprintf(TraceFP(), "LYNX_SIG_FILE set to '%s'\n", (char *)LynxSigFile);
        }
    }
    // 0x80793c9
    HTSwitchDTD(1);
    read_cfg((char *)lynx_cfg_file, "main program", 1, NULL);
    int32_t v27 = lynx_lss_file;
    int32_t v28 = v27; // 0x8079401
    if (lynx_lss_file2 != 0) {
        int32_t v29 = lynx_lss_file2; // 0x807940a
        if (v27 != 0) {
            // 0x807940c
            free((int32_t *)v27);
            lynx_lss_file = 0;
            v29 = lynx_lss_file2;
        }
        // 0x8079423
        lynx_lss_file = v29;
        lynx_lss_file2 = 0;
        v28 = v29;
    }
    // 0x8079437
    if (v28 != 0) {
        goto lab_0x807948c;
    } else {
        char * v30 = LYGetEnv("LYNX_LSS"); // 0x8079447
        if (v30 != NULL) {
            // 0x8079476
            HTSACopy((char **)&lynx_lss_file, v30);
            goto lab_0x807948c;
        } else {
            char * v31 = LYGetEnv("lynx_lss"); // 0x8079462
            if (v31 == NULL) {
                goto lab_0x807948c;
            } else {
                // 0x8079476
                HTSACopy((char **)&lynx_lss_file, v31);
                goto lab_0x807948c;
            }
        }
    }
  lab_0x807948c:
    // 0x807948c
    if (lynx_lss_file == 0) {
        // 0x8079495
        HTSACopy((char **)&lynx_lss_file, "/etc/lynx-cur/lynx.lss");
    }
    // 0x80794a9
    LYTildeExpand((char **)&lynx_lss_file, 1);
    int32_t v32 = 0; // 0x80794c4
    if (lynx_lss_file != 0) {
        char * v33 = (char *)lynx_lss_file; // 0x80794cb
        v32 = lynx_lss_file;
        if (*v33 != 0) {
            // 0x80794d2
            if (LYCanReadFile(v33) == 0) {
                // 0x80794e3
                fprintf((struct _IO_FILE *)g160, gettext("\nLynx file \"%s\" is not available.\n\n"));
                exit_immediately(1);
                // UNREACHABLE
            }
            // 0x80794d2
            v32 = lynx_lss_file;
        }
    }
    // 0x8079519
    style_readFromFile((char *)v32);
    read_rc(NULL);
    LYFindLocaleCharset();
    char * v34 = LYGetEnv("WWW_HOME"); // 0x807953e
    if (v34 != NULL) {
        // 0x8079552
        HTSACopy((char **)&startfile, v34);
        LYEscapeStartfile((char **)&startfile);
    }
    // 0x8079574
    HTSACopy((char **)&LynxHome, (char *)startfile);
    LYEnsureAbsoluteURL((char **)&LynxHome, "LynxHome", 0);
    i = 1;
    if (v1 > 1) {
        parse_arg((char **)(4 + v2), 4, &i);
        int32_t v35 = i + 1; // 0x80795e2
        i = v35;
        int32_t v36 = v35; // 0x80795f9
        while (v35 < v1) {
            // 0x80795b1
            parse_arg((char **)(4 * v36 + v2), 4, &i);
            v35 = i + 1;
            i = v35;
            v36 = v35;
        }
    }
    // 0x80795fb
    if (LYStdinArgs != NULL) {
        int32_t v37 = *(int32_t *)((int32_t)LYStdinArgs + 4); // 0x807964c
        int32_t v38 = v37; // 0x807965c
        if (v37 == 0) {
          lab_0x8079678:
            // 0x8079678
            v11 = 0;
        } else {
            int32_t v39 = *(int32_t *)v38; // 0x8079664
            v11 = v39;
            while (v39 != 0) {
                // 0x807961f
                parse_arg((char **)&v11, 4, NULL);
                int32_t v40 = *(int32_t *)(v38 + 4); // 0x807964c
                v38 = v40;
                if (v40 == 0) {
                    goto lab_0x8079678;
                }
                v39 = *(int32_t *)v38;
                v11 = v39;
            }
        }
        // 0x807968e
        LYStdinArgs_free();
    }
    if (v16 != 0) {
        // 0x80797a2
        goto lab_0x80797a2_2;
    } else {
        // 0x80796a0
        if (startfile_stdin != 0) {
            goto lab_0x80797a2_2;
        } else {
            // 0x80796af
            if (isatty(fileno(g163)) == 0) {
                int32_t fd = 1; // 0x80796db
                if (fileno((struct _IO_FILE *)g164) == 0) {
                    // 0x80796dd
                    fd = isatty(fileno((struct _IO_FILE *)g160)) != 0;
                }
                // 0x807970c
                if (isatty(fd) != 0) {
                    int32_t v41 = 0;
                    int32_t v42 = v41 + 1; // 0x807974f
                    while (fgetc(g163) != -1) {
                        // 0x8079735
                        v41 = v42;
                        v42 = v41 + 1;
                    }
                    if (v41 != 0) {
                        // 0x807975a
                        fprintf((struct _IO_FILE *)g160, gettext("Ignored %d characters from standard input.\n"));
                        fprintf((struct _IO_FILE *)g160, gettext("Use \"-stdin\" or \"-\" to tell how to handle piped input.\n"));
                    }
                }
            }
            // 0x80797a2
            goto lab_0x80797a2_2;
        }
    }
  lab_0x80797a2_2:
    // 0x80797a2
    if (startfile_stdin != 0) {
        // 0x80797b1
        v13 = NULL;
        if (WWW_TraceFlag != 0) {
            // 0x80797c6
            fprintf(TraceFP(), "processing stdin startfile\n");
        }
        // 0x80797dd
        int32_t v43; // bp-540, 0x8078790
        struct _IO_FILE * stream = LYOpenTemp((char *)&v43, ".html", "w"); // 0x80797f6
        if (stream != NULL) {
            // 0x807980e
            HTSACopy((char **)&startfile, (char *)&v43);
            char v44 = GetStdin(&v13, 0); // 0x8079865
            char * str2 = v13; // 0x807986c
            char * v45 = v13; // 0x807986c
            if (v44 != 0) {
                fputs(str2, stream);
                fputc(10, stream);
                char v46 = GetStdin(&v13, 0); // 0x8079865
                str2 = v13;
                v45 = v13;
                while (v46 != 0) {
                    // 0x8079826
                    fputs(str2, stream);
                    fputc(10, stream);
                    v46 = GetStdin(&v13, 0);
                    str2 = v13;
                    v45 = v13;
                }
            }
            // 0x807986e
            if (v45 != NULL) {
                // 0x8079878
                free((int32_t *)v45);
                v13 = NULL;
            }
            // 0x8079890
            LYCloseTempFP(stream);
        }
        // 0x807989e
        if (WWW_TraceFlag != 0) {
            // 0x80798a9
            fprintf(TraceFP(), "...done stdin startfile\n");
        }
    }
    // 0x80798c0
    if (Old_DTD != 0) {
        // 0x80798c9
        HTSwitchDTD(0);
    }
    // 0x80798de
    HTMLUseCharacterSet(current_char_set);
    if (persistent_cookies != 0) {
        // 0x80798f6
        if (LYCookieFile != 0) {
            // 0x807992f
            LYTildeExpand((char **)&LYCookieFile, 0);
        } else {
            int32_t * mem2 = malloc(256); // 0x8079906
            LYCookieFile = (int32_t)mem2;
            LYAddPathToHome((char *)mem2, 256, ".lynx_cookies");
        }
        // 0x8079943
        LYLoadCookies((char *)LYCookieFile);
    }
    // 0x8079950
    if (LYCookieSaveFile == 0) {
        goto lab_0x8079976;
    } else {
        // 0x807996d
        LYTildeExpand((char **)&LYCookieSaveFile, 0);
        if (LYCookieSaveFile != 0) {
            goto lab_0x80799ac;
        } else {
            goto lab_0x8079976;
        }
    }
  lab_0x8079976:
    // 0x8079976
    if (dump_output_immediately == 0) {
        // 0x8079997
        HTSACopy((char **)&LYCookieSaveFile, (char *)LYCookieFile);
    } else {
        // 0x8079981
        HTSACopy((char **)&LYCookieSaveFile, "/dev/null");
    }
    goto lab_0x80799ac;
  lab_0x80799ac:;
    char * v47 = LYGetEnv("LYNX_HELPFILE"); // 0x80799b3
    if (v47 != NULL) {
        // 0x80799c7
        HTSACopy((char **)&helpfile, v47);
    }
    // 0x80799dd
    HTSACopy((char **)&helpfilepath, (char *)helpfile);
    char * v48 = LYPathLeaf((char *)helpfilepath); // 0x80799fa
    if (helpfilepath != (int32_t)v48) {
        // 0x8079a12
        *v48 = 0;
    }
    // 0x8079a1b
    LYAddHtmlSep((char **)&helpfilepath);
    char * v49 = LYGetEnv("LYNX_SAVE_SPACE"); // 0x8079a2e
    if (v49 != NULL) {
        // 0x8079a42
        HTSACopy((char **)&lynx_save_space, v49);
    }
    // 0x8079a58
    if (lynx_save_space != 0) {
        // 0x8079a61
        if (*(char *)lynx_save_space != 0) {
            // 0x8079a96
            LYTildeExpand((char **)&lynx_save_space, 1);
            LYAddPathSep((char **)&lynx_save_space);
        } else {
            // 0x8079a76
            free((int32_t *)lynx_save_space);
            lynx_save_space = 0;
        }
    }
    // 0x8079ab6
    HTFormatInit();
    if (FileInitAlreadyDone == 0) {
        // 0x8079ac6
        HTFileInit();
    }
    // 0x8079acb
    if (LYCheckUserAgent() == 0) {
        char * v50 = gettext("User-Agent string does not contain \"Lynx\" or \"L_y_n_x\""); // 0x8079adb
        HTAlwaysAlert(gettext("Warning:"), v50);
    }
    // 0x8079afa
    if (LYPreparsedSource != 0) {
        // 0x8079b05
        HTPreparsedFormatInit();
    }
    // 0x8079b0a
    if (emacs_keys != 0) {
        // 0x8079b15
        set_emacs_keys();
    }
    // 0x8079b1a
    if (vi_keys != 0) {
        // 0x8079b25
        set_vi_keys();
    }
    // 0x8079b2a
    if (no_numbers != 0) {
        // 0x8079b35
        number_links = 0;
        number_fields = 0;
        keypad_mode = 0;
        set_numbers_as_arrows();
    }
    // 0x8079b52
    if (crawl != 0) {
        // 0x8079b5d
        if (number_links == 0) {
            // 0x8079b68
            keypad_mode = 0;
        }
    }
    // 0x8079b72
    if (keypad_mode >= 3) {
        // 0x8079b86
        if (number_fields != 0) {
            // 0x8079b91
            keypad_mode = 2;
        }
        // 0x8079b9b
        if (number_links != 0) {
            // 0x8079ba6
            keypad_mode = 1;
        }
        // 0x8079bb0
        set_numbers_as_arrows();
    }
    // 0x8079bb5
    if (LYUseDefSelPop == 0) {
        // 0x8079bc0
        LYSelectPopups = LYSelectPopups == 0;
    }
    // 0x8079bd1
    if (LYUseDefShoCur == 0) {
        // 0x8079bdc
        LYShowCursor = LYShowCursor == 0;
    }
    // 0x8079bed
    if (LYPrependBase != 0) {
        // 0x8079bf8
        if (HTAtom_for("www/download") == HTOutputFormat) {
            // 0x8079c0f
            LYPrependBaseToSource = 1;
        }
    }
    char v51 = no_multibook; // 0x8079c16
    if (v51 != 0) {
        // 0x8079c21
        LYMBMBlocked = 1;
    }
    // 0x8079c28
    if (dump_output_immediately != 0) {
        // 0x8079c88
        LYMultiBookmarks = 0;
        LYMBMBlocked = 1;
        no_multibook = 1;
        LYCacheSource = 0;
        display_partial_flag = 0;
    } else {
        // 0x8079c33
        if ((LYMBMBlocked || v51) != 0) {
            // 0x8079c61
            LYMultiBookmarks = 0;
            LYMBMBlocked = 1;
            no_multibook = 1;
        }
        // 0x8079c93
        signal(SIGHUP, 0x804b4e4);
    }
    // 0x8079ca7
    signal(SIGTERM, 0x804b4e4);
    LYExtSignal(28, (void (*)(int32_t))0x8096549);
    if (WWW_TraceFlag == 0) {
        // 0x8079cda
        if (dump_output_immediately == 0) {
            // 0x8079ce5
            if (stack_dump == 0) {
                // 0x8079cf0
                signal(SIGINT, 0x804b4e4);
                signal(SIGSEGV, 0x807bebf);
                signal(SIGILL, 0x807bebf);
                if (signal(SIGPIPE, SIG_IGN) != (void (*)(int32_t))1) {
                    // 0x8079d45
                    restore_sigpipe_for_children = 1;
                }
            }
        }
    }
    // 0x8079d4c
    if (no_suspend != 0) {
        // 0x8079d57
        signal(SIGCHLD, SIG_IGN);
    }
    // 0x8079d6b
    if (HEAD_request != 0) {
        // 0x8079d76
        if (LYCanDoHEAD((char *)startfile) != 1) {
            // 0x8079d87
            fprintf((struct _IO_FILE *)g160, "The '-head' switch is for http HEAD requests and cannot be used for\n'%s'.\n", (char *)startfile);
            exit_immediately(1);
            // UNREACHABLE
        }
    }
    // 0x8079db2
    if (keep_mime_headers != 0) {
        // 0x8079dbd
        if (LYCanDoHEAD((char *)startfile) != 1) {
            // 0x8079dce
            fprintf((struct _IO_FILE *)g160, "The '-mime_header' switch is for http URLs and cannot be used for\n'%s'.\n", (char *)startfile);
            exit_immediately(1);
            // UNREACHABLE
        }
    }
    // 0x8079df9
    if (traversal != 0) {
        // 0x8079e04
        if (strncmp((char *)startfile, "http", 4) != 0) {
            // 0x8079e25
            fprintf((struct _IO_FILE *)g160, "The '-traversal' switch is for http URLs and cannot be used for\n'%s'.\n", (char *)startfile);
            exit_immediately(1);
            // UNREACHABLE
        }
    }
    // 0x8079e50
    if (dump_output_immediately == 0) {
        // 0x8079e5b
        HTMLSRC_init_caches(0);
    }
    // 0x8079e67
    if (dump_output_immediately == 0) {
        // 0x8079e72
        setup((char *)terminal);
    }
    // 0x8079e7f
    LYEnsureAbsoluteURL((char **)&startfile, "STARTFILE", 0);
    if (homepage == 0) {
        // 0x8079ed5
        HTSACopy((char **)&homepage, (char *)startfile);
        goto lab_0x8079f01;
    } else {
        // 0x8079ec0
        LYEnsureAbsoluteURL((char **)&homepage, "HOMEPAGE", 0);
        if (homepage == 0) {
            // 0x8079ed5
            HTSACopy((char **)&homepage, (char *)startfile);
            goto lab_0x8079f01;
        } else {
            char * v52 = (char *)homepage; // 0x8079ece
            if (*v52 != 0) {
                // 0x8079eec
                HTSACopy((char **)&LynxHome, v52);
                goto lab_0x8079f01;
            } else {
                // 0x8079ed5
                HTSACopy((char **)&homepage, (char *)startfile);
                goto lab_0x8079f01;
            }
        }
    }
  lab_0x8079f01:;
    // 0x8079f01
    bool v53; // 0x8078790
    if (inlocaldomain() == 0) {
        if (WWW_TraceFlag != 0) {
            // 0x807a020
            fprintf(TraceFP(), "LYMain: User in REMOTE domain\n");
        }
        // 0x807a037
        telnet_ok = no_outside_telnet == 0 == (telnet_ok != 0);
        news_ok = no_outside_news == 0 == (news_ok != 0);
        ftp_ok = no_outside_ftp == 0 == (ftp_ok != 0);
        v53 = no_outside_rlogin == 0 == (rlogin_ok != 0);
    } else {
        if (WWW_TraceFlag != 0) {
            // 0x8079f19
            fprintf(TraceFP(), "LYMain: User in Local domain\n");
        }
        // 0x8079f30
        telnet_ok = no_inside_telnet == 0 == (telnet_ok != 0);
        news_ok = no_inside_news == 0 == (news_ok != 0);
        ftp_ok = no_inside_ftp == 0 == (ftp_ok != 0);
        v53 = no_inside_rlogin == 0 == (rlogin_ok != 0);
    }
    // 0x807a117
    rlogin_ok = v53;
    LYSetConfigValue("broken_ftp_retr", "ProFTPD 1.2.5");
    LYSetConfigValue("broken_ftp_retr", "spftp/");
    LYSetConfigValue("broken_ftp_epsv", "(Version wu-2.6.2-12)");
    if (bookmark_page == 0) {
        goto lab_0x807a168;
    } else {
        // 0x807a15c
        if (*(char *)bookmark_page != 0) {
            goto lab_0x807a1c0;
        } else {
            goto lab_0x807a168;
        }
    }
  lab_0x807a168:
    // 0x807a168
    i2 = 0;
    HTSprintf0((char **)&i2, "lynx_bookmarks%s", ".html");
    set_default_bookmark_page((char *)i2);
    if (i2 != 0) {
        // 0x807a1a8
        free((int32_t *)i2);
        i2 = 0;
    }
    goto lab_0x807a1c0;
  lab_0x807a1c0:
    // 0x807a1c0
    if (BookmarkPage == 0) {
        // 0x807a1d5
        set_default_bookmark_page((char *)bookmark_page);
        goto lab_0x807a1e2;
    } else {
        // 0x807a1c9
        if (*(char *)BookmarkPage != 0) {
            goto lab_0x807a1e2;
        } else {
            // 0x807a1d5
            set_default_bookmark_page((char *)bookmark_page);
            goto lab_0x807a1e2;
        }
    }
  lab_0x807a1e2:
    // 0x807a1e2
    LYOpenlog((char *)syslog_txt);
    if (x_display != 0) {
        // 0x807a1f8
        if (*(char *)x_display != 0) {
            // 0x807a204
            LYisConfiguredForX = 1;
        }
    }
    // 0x807a20b
    if (dump_output_immediately == 0) {
        // 0x807a3de
        cache_tag_styles();
        if (with_backspaces != 0) {
            // 0x807a3ee
            with_backspaces = 0;
        }
        int32_t v54 = *(int32_t *)(4 * current_char_set + (int32_t)&LYlowest_eightbit); // 0x807a3fa
        int32_t v55 = v54 - 155; // 0x807a401
        ena_csi((char)(v55 < 0 == (154 - v54 & v54) < 0 == (v55 != 0)));
        int32_t v56 = mainloop(); // 0x807a414
        LYCloseCloset(1);
        LYCloseCloset(3);
        cleanup();
        exit_immediately(v56);
        // UNREACHABLE
    }
    // 0x807a21a
    if (crawl == 0) {
        goto lab_0x807a247;
    } else {
        // 0x807a225
        if (number_links != 0) {
            goto lab_0x807a247;
        } else {
            // 0x807a230
            if (number_fields != 0) {
                goto lab_0x807a247;
            } else {
                // 0x807a23b
                keypad_mode = 0;
                goto lab_0x807a29e;
            }
        }
    }
  lab_0x807a247:
    // 0x807a247
    if (no_numbers == 0) {
        // 0x807a25e
        if (no_list == 0 && keypad_mode >= 3) {
            // 0x807a27d
            if (number_fields == 0) {
                // 0x807a294
                keypad_mode = 1;
            } else {
                // 0x807a288
                keypad_mode = 2;
            }
        }
    } else {
        // 0x807a252
        keypad_mode = 0;
    }
    goto lab_0x807a29e;
  lab_0x807a29e:
    // 0x807a29e
    if (dump_output_width >= 1) {
        // 0x807a2a7
        LYcols = dump_output_width;
    }
    // 0x807a2b1
    HTAddGotoURL((char *)startfile);
    int32_t v57 = HTList_count(Goto_URLs) - 1;
    i = v57;
    int32_t v58 = 0; // 0x807a3b0
    if (v57 >= 0) {
        char * v59 = HTList_objectAt(Goto_URLs, v57); // 0x807a2ec
        HTSACopy((char **)&startfile, v59);
        int32_t v60; // 0x807a31a
        if (WWW_TraceFlag != 0) {
            // 0x807a30c
            v60 = HTList_count(Goto_URLs);
            fprintf(TraceFP(), "dumping %d:%d %s\n", i + 1, v60, (char *)startfile);
        }
        int32_t v61 = mainloop(); // 0x807a34d
        if (no_list == 0) {
            // 0x807a363
            if (crawl == 0) {
                // 0x807a36e
                printlist((struct _IO_FILE *)g164, 0);
            }
        }
        while (i != 0) {
            // 0x807a399
            putchar(10);
            int32_t v62 = i - 1;
            i = v62;
            v58 = v61;
            if (v62 < 0) {
                goto lab_0x807a3b6;
            }
            v59 = HTList_objectAt(Goto_URLs, v62);
            HTSACopy((char **)&startfile, v59);
            if (WWW_TraceFlag != 0) {
                // 0x807a30c
                v60 = HTList_count(Goto_URLs);
                fprintf(TraceFP(), "dumping %d:%d %s\n", i + 1, v60, (char *)startfile);
            }
            // 0x807a34d
            v61 = mainloop();
            if (no_list == 0) {
                // 0x807a363
                if (crawl == 0) {
                    // 0x807a36e
                    printlist((struct _IO_FILE *)g164, 0);
                }
            }
        }
        // 0x807a399
        i = -1;
        v58 = v61;
    }
  lab_0x807a3b6:
    // 0x807a3b6
    if (persistent_cookies != 0) {
        // 0x807a3c1
        LYStoreCookies((char *)LYCookieSaveFile);
    }
    // 0x807a3ce
    exit_immediately(v58);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x807a470 - 0x807a4b4
// Line range:    2234 - 2243
void LYRegisterLynxProtocols(void) {
    // 0x807a470
    HTRegisterProtocol(&LYLynxKeymap);
    HTRegisterProtocol(&LYLynxCGI);
    HTRegisterProtocol(&LYLynxIMGmap);
    HTRegisterProtocol(&LYLynxCookies);
    HTRegisterProtocol(&LYLynxStatusMessages);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x807a4b4 - 0x807a78d
// Line range:    2263 - 2385
void reload_read_cfg(void) {
    // 0x807a4b4
    if (no_option_save != 0) {
        // 0x807a78b
        return;
    }
    int32_t * mem = calloc(256, 1); // 0x807a4d8
    if (mem == NULL) {
        // 0x807a4e6
        HTAlwaysAlert(NULL, gettext("Not enough memory!"));
        // 0x807a78b
        return;
    }
    struct _IO_FILE * v1 = LYOpenTemp((char *)mem, ".rc", "w"); // 0x807a51d
    if (v1 == NULL) {
        // 0x807a543
        free(mem);
        HTAlwaysAlert(NULL, gettext("Can't open temporary file!"));
        // 0x807a78b
        return;
    }
    // 0x807a564
    if (save_rc(v1) == 0) {
        // 0x807a5a4
        HTAlwaysAlert(NULL, gettext("Unable to save Options!"));
        LYRemoveTemp((char *)mem);
        free(mem);
        // 0x807a78b
        return;
    }
    char * tempfile = NULL; // bp-20, 0x807a5c5
    int32_t * rcfp = NULL; // bp-24, 0x807a5cc
    if (persistent_cookies != 0) {
        // 0x807a5de
        HTSACopy(&tempfile, (char *)LYCookieFile);
        HTSACopy((char **)&rcfp, (char *)LYCookieSaveFile);
    }
    // 0x807a680
    html_src_on_lynxcfg_reload();
    free_lynx_cfg();
    source_cache_file_error = 0;
    read_cfg((char *)lynx_cfg_file, "main program", 1, NULL);
    read_rc(fopen64((char *)mem, "r"));
    LYRemoveTemp((char *)mem);
    free(mem);
    LYSetDisplayLines();
    // 0x807a6ae
    if (persistent_cookies == 0) {
        // 0x807a78b
        return;
    }
    // 0x807a6bd
    if (strcmp((char *)LYCookieFile, tempfile) != 0) {
        // 0x807a6d6
        HTSACopy((char **)&LYCookieFile, tempfile);
        if (WWW_TraceFlag != 0) {
            // 0x807a6f4
            fprintf(TraceFP(), "cookie file can be changed in next session only, restored.\n");
        }
    }
    // 0x807a70b
    if (strcmp((char *)LYCookieSaveFile, (char *)rcfp) != 0) {
        // 0x807a724
        HTSACopy((char **)&LYCookieSaveFile, (char *)rcfp);
        if (WWW_TraceFlag != 0) {
            // 0x807a742
            fprintf(TraceFP(), "cookie save file can be changed in next session only, restored.\n");
        }
    }
    // 0x807a759
    if (tempfile != NULL) {
        // 0x807a760
        free((int32_t *)tempfile);
        tempfile = NULL;
    }
    // 0x807a772
    if (rcfp != NULL) {
        // 0x807a779
        free(rcfp);
        rcfp = NULL;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x807b300 - 0x807b4c0
// Line range:    4003 - 4048
void print_help_strings(char * name, char * help, char * value, char option) {
    int32_t v1 = 18 - (int32_t)option - strlen(name); // 0x807b332
    char * v2 = option == 0 ? (char *)&g18 : "-"; // 0x807b36d
    fprintf((struct _IO_FILE *)g164, "  %s%s", v2, name);
    int32_t v3 = v1; // 0x807b37a
    int32_t v4 = v1; // 0x807b37a
    if (*help != 61) {
        v3--;
        fputc(32, (struct _IO_FILE *)g164);
        v4 = 0;
        while (v3 >= 0 == (v3 != 0)) {
            // 0x807b39b
            v3--;
            fputc(32, (struct _IO_FILE *)g164);
            v4 = 0;
        }
    }
    // 0x807b3c5
    if (strchr(help, 10) != NULL) {
        char v5 = *help; // 0x807b479
        if (v5 != 0) {
            int32_t c = v5;
            int32_t v6; // 0x807b300
            int32_t v7; // 0x807b300
            int32_t v8; // 0x807b300
            int32_t v9; // 0x807b3ff
            int32_t v10; // 0x807b450
            if (v5 != 10) {
                // 0x807b45a
                fputc(c, (struct _IO_FILE *)g164);
                v7 = v4;
            } else {
                // 0x807b3ff
                v9 = v4 - 1;
                v6 = v9 >= 0 ? v9 : 20;
                fputc(v9 >= 0 ? 32 : c, (struct _IO_FILE *)g164);
                v8 = v6;
                v7 = v9;
                if (v6 != 0) {
                    v10 = v8 - 1;
                    fputc(32, (struct _IO_FILE *)g164);
                    v8 = v10;
                    v7 = v9;
                    while (v10 != 0) {
                        // 0x807b434
                        v10 = v8 - 1;
                        fputc(32, (struct _IO_FILE *)g164);
                        v8 = v10;
                        v7 = v9;
                    }
                }
            }
            char * v11 = (char *)((int32_t)help + 1); // 0x807b46e
            char v12 = *v11; // 0x807b479
            char v13 = v12; // 0x807b486
            char * v14 = v11; // 0x807b486
            while (v12 != 0) {
                int32_t v15 = v7 - 1;
                c = v13;
                if (v13 != 10) {
                    // 0x807b45a
                    fputc(c, (struct _IO_FILE *)g164);
                    v7 = v15;
                } else {
                    // 0x807b3ff
                    v9 = v15 - 1;
                    v6 = v9 >= 0 ? v9 : 20;
                    fputc(v9 >= 0 ? 32 : c, (struct _IO_FILE *)g164);
                    v8 = v6;
                    v7 = v9;
                    if (v6 != 0) {
                        v10 = v8 - 1;
                        fputc(32, (struct _IO_FILE *)g164);
                        v8 = v10;
                        v7 = v9;
                        while (v10 != 0) {
                            // 0x807b434
                            v10 = v8 - 1;
                            fputc(32, (struct _IO_FILE *)g164);
                            v8 = v10;
                            v7 = v9;
                        }
                    }
                }
                // 0x807b46e
                v11 = (char *)((int32_t)v14 + 1);
                v12 = *v11;
                v13 = v12;
                v14 = v11;
            }
        }
    } else {
        // 0x807b3e0
        fputs(help, (struct _IO_FILE *)g164);
    }
    if (value != NULL) {
        // 0x807b492
        printf(" (%s)", value);
    }
    // 0x807b4a5
    fputc(10, (struct _IO_FILE *)g164);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x807b4c0 - 0x807b776
// Line range:    4051 - 4102
void print_help_and_exit(int32_t exit_status) {
    // 0x807b4c0
    __readgsdword(20);
    if (pgm == 0) {
        // 0x807b4de
        pgm = (int32_t)"lynx";
    }
    char ** v1 = (char **)"USAGE: %s [options] [file]\n"; // bp-1084, 0x807b4ee
    char * format2 = gettext("USAGE: %s [options] [file]\n"); // 0x807b4f5
    *(int32_t *)&v1 = (int32_t)g164;
    fprintf((struct _IO_FILE *)g164, format2);
    v1 = (char **)"Options are:\n";
    char * format3 = gettext("Options are:\n"); // 0x807b517
    *(int32_t *)&v1 = (int32_t)g164;
    fprintf((struct _IO_FILE *)g164, format3);
    v1 = (char **)&g18;
    print_help_strings((char *)&g18, "receive options and arguments from stdin", NULL, 1);
    if (Arg_Table == 0) {
        // 0x807b751
        *(int32_t *)&v1 = exit_status;
        exit_immediately((int32_t)&Arg_Table);
        // UNREACHABLE
    }
    int32_t v2 = (int32_t)&v1; // 0x807b4c4
    int32_t * v3 = (int32_t *)(v2 + 4);
    int32_t v4; // bp-1036, 0x807b4c0
    int32_t v5 = &v4;
    int32_t v6 = v2 + 8;
    int32_t * v7 = (int32_t *)v6;
    int32_t v8 = &Arg_Table; // 0x807b73a
    int32_t * v9 = (int32_t *)(v8 + 8); // 0x807b576
    int32_t v10 = *(int32_t *)(v8 + 4) & 4080; // 0x807b587
    char * str = (char *)v10; // 0x807b58d
    char * str3; // 0x807b4c0
    char * str2; // 0x807b4c0
    int32_t * v11; // 0x807b4c0
    int32_t v12; // 0x807b6d7
    int32_t * v13; // 0x807b6d9
    int32_t v14; // 0x807b6a1
    if (v10 == 48) {
        // 0x807b631
        str2 = *(char *)*v9 == 0 ? "on" : "off";
        *v3 = (int32_t)str2;
        *(int32_t *)&v1 = v5;
        strcpy(str, str2);
        v11 = &v4;
    } else {
        if (str > (char *)48) {
            // 0x807b5c0
            v11 = NULL;
            switch (v10) {
                case 112: {
                    // 0x807b6cf
                    v12 = *(int32_t *)*v9;
                    v13 = (int32_t *)v12;
                    v11 = v13;
                    if (v12 != 0) {
                        // 0x807b6e8
                        v11 = *(char *)v12 != 0 ? v13 : NULL;
                    }
                    // break -> 0x807b70b
                    break;
                }
                case 128: {
                    // 0x807b699
                    v14 = *(int32_t *)*v9;
                    *(int32_t *)(v2 - 4) = v14;
                    *(float64_t *)v6 = (float64_t)((float80_t)v14 / 1000.0L);
                    *v3 = (int32_t)"%.3f";
                    *(int32_t *)&v1 = v5;
                    sprintf(str, (char *)&g391);
                    v11 = &v4;
                    // break -> 0x807b70b
                    break;
                }
                case 96: {
                    // 0x807b673
                    *v7 = *(int32_t *)*v9;
                    *v3 = (int32_t)"%d";
                    *(int32_t *)&v1 = v5;
                    sprintf(str, (char *)&g391);
                    v11 = &v4;
                    // break -> 0x807b70b
                    break;
                }
            }
        } else {
            // 0x807b5a9
            v11 = NULL;
            switch (v10) {
                case 32: {
                }
                case 16: {
                    // 0x807b5ef
                    str3 = *(char *)*v9 == 0 ? "off" : "on";
                    *v3 = (int32_t)str3;
                    *(int32_t *)&v1 = v5;
                    strcpy(str, str3);
                    v11 = &v4;
                    // break -> 0x807b70b
                    break;
                }
            }
        }
    }
    // 0x807b70b
    *(int32_t *)(v2 + 12) = 1;
    *v7 = (int32_t)v11;
    *v3 = *(int32_t *)(v8 + 12);
    *(int32_t *)&v1 = *&Arg_Table;
    print_help_strings((char *)&g391, (char *)&g391, (char *)&g391, (char)&g391);
    v8 += 16;
    int32_t * v15 = (int32_t *)v8; // 0x807b747
    int32_t v16 = v8; // 0x807b74b
    while (*v15 != 0) {
        // 0x807b561
        v9 = (int32_t *)(v8 + 8);
        v10 = *(int32_t *)(v8 + 4) & 4080;
        str = (char *)v10;
        if (v10 == 48) {
            // 0x807b631
            str2 = *(char *)*v9 == 0 ? "on" : "off";
            *v3 = (int32_t)str2;
            *(int32_t *)&v1 = v5;
            strcpy(str, str2);
            v11 = &v4;
        } else {
            if (str > (char *)48) {
                // 0x807b5c0
                v11 = NULL;
                switch (v10) {
                    case 112: {
                        // 0x807b6cf
                        v12 = *(int32_t *)*v9;
                        v13 = (int32_t *)v12;
                        v11 = v13;
                        if (v12 != 0) {
                            // 0x807b6e8
                            v11 = *(char *)v12 != 0 ? v13 : NULL;
                        }
                        // break -> 0x807b70b
                        break;
                    }
                    case 128: {
                        // 0x807b699
                        v14 = *(int32_t *)*v9;
                        *(int32_t *)(v2 - 4) = v14;
                        *(float64_t *)v6 = (float64_t)((float80_t)v14 / 1000.0L);
                        *v3 = (int32_t)"%.3f";
                        *(int32_t *)&v1 = v5;
                        sprintf(str, (char *)&g391);
                        v11 = &v4;
                        // break -> 0x807b70b
                        break;
                    }
                    case 96: {
                        // 0x807b673
                        *v7 = *(int32_t *)*v9;
                        *v3 = (int32_t)"%d";
                        *(int32_t *)&v1 = v5;
                        sprintf(str, (char *)&g391);
                        v11 = &v4;
                        // break -> 0x807b70b
                        break;
                    }
                }
            } else {
                // 0x807b5a9
                v11 = NULL;
                switch (v10) {
                    case 32: {
                    }
                    case 16: {
                        // 0x807b5ef
                        str3 = *(char *)*v9 == 0 ? "off" : "on";
                        *v3 = (int32_t)str3;
                        *(int32_t *)&v1 = v5;
                        strcpy(str, str3);
                        v11 = &v4;
                        // break -> 0x807b70b
                        break;
                    }
                }
            }
        }
        // 0x807b70b
        *(int32_t *)(v2 + 12) = 1;
        *v7 = (int32_t)v11;
        *v3 = *(int32_t *)(v8 + 12);
        *(int32_t *)&v1 = *v15;
        print_help_strings((char *)&g391, (char *)&g391, (char *)&g391, (char)&g391);
        v8 += 16;
        v15 = (int32_t *)v8;
        v16 = v8;
    }
    // 0x807b751
    *(int32_t *)&v1 = exit_status;
    exit_immediately(v16);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x807b776 - 0x807b8a0
// Line range:    4115 - 4165
int32_t arg_eqs_parse(char * a, char * b, char ** c) {
    // 0x807b776
    *(int32_t *)c = 0;
    int32_t v1 = (int32_t)b; // 0x807b776
    char * v2 = b; // 0x807b776
    char * v3 = a; // 0x807b776
    int32_t result = -1;
    int32_t v4; // 0x807b776
    char * v5; // 0x807b88d
    int32_t v6; // 0x807b776
    while (true) {
      lab_0x807b791:;
        int32_t v7 = result;
        v5 = v2;
        char v8 = *v3; // 0x807b794
        char v9 = *v5; // 0x807b79a
        v6 = v7;
        if (v9 != 0 == (v8 != 0 && v8 == v9)) {
            goto lab_0x807b889;
        } else {
            if (v8 != 0) {
                // 0x807b86e
                v6 = v8 == 95 == v9 == 45 ? v7 : 0;
                goto lab_0x807b889;
            } else {
                int32_t v10 = v9; // 0x807b7cd
                g385 = v10;
                v6 = 1;
                switch (v10) {
                    case 0: {
                        goto lab_0x807b889;
                    }
                    case 9: {
                        goto lab_0x807b7e9;
                    }
                    case 32: {
                        goto lab_0x807b7e9;
                    }
                    case 43: {
                        // 0x807b7c7
                        v4 = (int32_t)v5;
                        goto lab_0x807b84b;
                    }
                    case 45: {
                        int16_t * v11 = *__ctype_b_loc(); // 0x807b820
                        int32_t v12 = (int32_t)v5;
                        unsigned char v13 = *(char *)(v12 + 1); // 0x807b828
                        v4 = v12;
                        v6 = 0;
                        if ((*(int16_t *)(2 * (int32_t)v13 + (int32_t)v11) & 1024) == 0) {
                            goto lab_0x807b84b;
                        } else {
                            goto lab_0x807b889;
                        }
                    }
                    case 58: {
                        // 0x807b807
                        *(int32_t *)c = (int32_t)v5 + 1;
                        v6 = 1;
                        goto lab_0x807b889;
                    }
                    case 61: {
                        // 0x807b807
                        *(int32_t *)c = (int32_t)v5 + 1;
                        v6 = 1;
                        goto lab_0x807b889;
                    }
                    default: {
                        // 0x807b865
                        v6 = 0;
                        goto lab_0x807b889;
                    }
                }
            }
        }
    }
    // 0x807b89b
    return result;
  lab_0x807b889:
    // 0x807b889
    result = v6;
    int32_t v14 = (int32_t)v5 + 1; // 0x807b88d
    v1 = v14;
    v2 = (char *)v14;
    v3 = (char *)((int32_t)v3 + 1);
    if (result >= 0) {
        return result;
    }
    goto lab_0x807b791;
  lab_0x807b7e9:
    // 0x807b7e9
    *(int32_t *)c = (int32_t)LYSkipBlanks((char *)v1);
    v6 = 1;
    goto lab_0x807b889;
  lab_0x807b84b:
    // 0x807b84b
    *(int32_t *)c = v4;
    v6 = 1;
    goto lab_0x807b889;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMain.c
// Address range: 0x807b8a0 - 0x807bebf
// Line range:    4181 - 4362
char parse_arg(char ** argv, int32_t mask, int32_t * countp) {
    char * str = *argv; // 0x807b8ab
    if (WWW_TraceFlag != 0) {
        int32_t v1 = -1; // 0x807b8bf
        if (countp != NULL) {
            // 0x807b8c1
            v1 = *countp;
        }
        // 0x807b8d2
        fprintf(TraceFP(), "parse_arg(arg_name=%s, mask=%u, count=%d)\n", str, mask, v1);
    }
    if ((int32_t)(countp == NULL) == mask) {
        // 0x807b90f
        g230 = 0;
        int32_t v2 = nonoption; // 0x807b916
        if (v2 != 0) {
            // 0x807b928
            free((int32_t *)v2);
            nonoption = 0;
        }
    }
    // 0x807b93f
    int32_t v3; // 0x807b8a0
    char * v4; // 0x807b8a0
    char * str2; // bp-32, 0x807b8a0
    int32_t endptr; // bp-36, 0x807b8a0
    char result; // 0x807b8a0
    int32_t v5; // 0x807b8a0
    int32_t * v6; // 0x807baf0
    if (*str == 45) {
        // 0x807b949
        if (g230 != 1) {
            // 0x807ba1b
            if (strcmp(str, "--") == 0) {
                // 0x807ba32
                g230 = 1;
                result = 1;
                // 0x807beb4
                return result;
            }
            int32_t v7 = (int32_t)str; // 0x807ba42
            int32_t v8 = v7 + 1; // 0x807ba42
            char v9 = *(char *)v8; // 0x807ba49
            if (v9 == 0) {
                // 0x807beb4
                return 1;
            }
            int32_t v10 = v9 != 45 ? v8 : v7 + 2;
            if (WWW_TraceFlag != 0) {
                // 0x807ba72
                fprintf(TraceFP(), "parse_arg lookup(%s)\n", (int32_t *)v10);
            }
            // 0x807ba90
            if (Arg_Table != 0) {
                char * v11 = (char *)v10; // 0x807babe
                v5 = &Arg_Table;
                str2 = NULL;
                endptr = 0;
                char * v12 = (char *)*&Arg_Table; // 0x807bab8
                int32_t v13; // 0x807bb09
                char * v14; // 0x807bb0b
                if (*v12 == *v11) {
                    // 0x807bac5
                    if (arg_eqs_parse(v12, v11, &str2) != 0) {
                        // 0x807baed
                        v6 = (int32_t *)(v5 + 4);
                        if ((*v6 & 0x1000) == 0) {
                            goto lab_0x807bb67;
                        } else {
                            // 0x807bafc
                            v3 = (int32_t)str2;
                            v4 = str2;
                            if (str2 != NULL) {
                                goto lab_0x807bb28;
                            } else {
                                // 0x807bb03
                                v13 = *(int32_t *)((int32_t)argv + 4);
                                v14 = (char *)v13;
                                str2 = v14;
                                v3 = v13;
                                v4 = v14;
                                if (countp == NULL || v13 == 0) {
                                    goto lab_0x807bb28;
                                } else {
                                    // 0x807bb1b
                                    *countp = *countp + 1;
                                    v3 = v13;
                                    v4 = v14;
                                    goto lab_0x807bb28;
                                }
                            }
                        }
                    }
                }
                int32_t v15 = v5 + 16; // 0x807bae4
                int32_t * v16 = (int32_t *)v15; // 0x807be56
                while (*v16 != 0) {
                    // 0x807ba9c
                    v5 = v15;
                    str2 = NULL;
                    endptr = 0;
                    v12 = (char *)*v16;
                    if (*v12 == *v11) {
                        // 0x807bac5
                        if (arg_eqs_parse(v12, v11, &str2) != 0) {
                            // 0x807baed
                            v6 = (int32_t *)(v5 + 4);
                            if ((*v6 & 0x1000) == 0) {
                                goto lab_0x807bb67;
                            } else {
                                // 0x807bafc
                                v3 = (int32_t)str2;
                                v4 = str2;
                                if (str2 != NULL) {
                                    goto lab_0x807bb28;
                                } else {
                                    // 0x807bb03
                                    v13 = *(int32_t *)((int32_t)argv + 4);
                                    v14 = (char *)v13;
                                    str2 = v14;
                                    v3 = v13;
                                    v4 = v14;
                                    if (countp == NULL || v13 == 0) {
                                        goto lab_0x807bb28;
                                    } else {
                                        // 0x807bb1b
                                        *countp = *countp + 1;
                                        v3 = v13;
                                        v4 = v14;
                                        goto lab_0x807bb28;
                                    }
                                }
                            }
                        }
                    }
                    // 0x807bae4
                    v15 = v5 + 16;
                    v16 = (int32_t *)v15;
                }
            }
            // 0x807be60
            if (pgm == 0) {
                // 0x807be69
                pgm = (int32_t)"LYNX";
            }
            // 0x807be73
            fprintf((struct _IO_FILE *)g160, gettext("%s: Invalid Option: %s\n"));
            print_help_and_exit(-1);
            // UNREACHABLE
        }
    }
    if (mask == 4) {
        // 0x807b95e
        if (nonoption != 0) {
            // 0x807b967
            LYEnsureAbsoluteURL((char **)&nonoption, "NONOPTION", 0);
            HTAddGotoURL((char *)nonoption);
            if (nonoption != 0) {
                // 0x807b999
                free((int32_t *)nonoption);
                nonoption = 0;
            }
        }
        // 0x807b9b0
        HTSACopy((char **)&nonoption, str);
    }
    // 0x807b9c3
    HTSACopy((char **)&startfile, str);
    LYEscapeStartfile((char **)&startfile);
    if (WWW_TraceFlag != 0) {
        // 0x807b9ed
        fprintf(TraceFP(), "parse_arg startfile:%s\n", (char *)startfile);
    }
    // 0x807beb4
    return countp != NULL;
  lab_0x807bb67:;
    uint32_t v17 = *v6; // 0x807bb6a
    uint32_t v18; // 0x807b8a0
    int32_t * v19; // 0x807baa2
    if ((v17 & mask) != 0) {
        // 0x807bbb7
        v18 = v17 & 4080;
        if (v18 == 64) {
            goto lab_0x807be3e;
        } else {
            // 0x807bbd2
            v19 = (int32_t *)(v5 + 8);
            if (v18 > 64) {
                if (v18 == 96) {
                    int32_t v20 = *v19; // 0x807bd90
                    if (v20 == 0 || str2 == NULL) {
                        goto lab_0x807be3e;
                    } else {
                        // 0x807bda5
                        *(int32_t *)v20 = strtol(str2, (char **)&endptr, 0);
                        goto lab_0x807be3e;
                    }
                } else {
                    if (v18 > 96) {
                        switch (v18) {
                            case 112: {
                                int32_t v21 = *v19; // 0x807be27
                                if (v21 == 0 || str2 == NULL) {
                                    goto lab_0x807be3e;
                                } else {
                                    // 0x807be34
                                    *(int32_t *)v21 = (int32_t)str2;
                                    goto lab_0x807be3e;
                                }
                            }
                            case 128: {
                                // 0x807bdc8
                                if (*v19 == 0 || str2 == NULL) {
                                    goto lab_0x807be3e;
                                } else {
                                    // 0x807bdd8
                                    float32_t v22; // bp-40, 0x807b8a0
                                    if (sscanf(str2, "%f", &v22) != 1) {
                                        goto lab_0x807be3e;
                                    } else {
                                        // 0x807bdf7
                                        *(int32_t *)*v19 = (int32_t)(1000.0L * (float80_t)v22);
                                        goto lab_0x807be3e;
                                    }
                                }
                            }
                            default: {
                                goto lab_0x807be3e;
                            }
                        }
                    } else {
                        if (v18 == 80) {
                            int32_t v23 = *v19; // 0x807bd5f
                            if (v23 == 0 || str2 == NULL) {
                                goto lab_0x807be3e;
                            } else {
                                // 0x807bd74
                                HTSACopy((char **)v23, str2);
                                goto lab_0x807be3e;
                            }
                        } else {
                            goto lab_0x807be3e;
                        }
                    }
                }
            } else {
                switch (v18) {
                    case 48: {
                        goto lab_0x807bc2a;
                    }
                    case 32: {
                        goto lab_0x807bc2a;
                    }
                    case 16: {
                        goto lab_0x807bc2a;
                    }
                    default: {
                        goto lab_0x807be3e;
                    }
                }
            }
        }
    } else {
        // 0x807bb74
        result = 0;
        if (WWW_TraceFlag == 0) {
            return result;
        } else {
            // 0x807bb7f
            fprintf(TraceFP(), "...skip (mask %u/%d)\n", mask, v17 % 8);
            result = 0;
            return result;
        }
    }
  lab_0x807bb28:
    // 0x807bb28
    if (WWW_TraceFlag == 0) {
        goto lab_0x807bb67;
    } else {
        // 0x807bb33
        fprintf(TraceFP(), "...arg:%s\n", v4 == NULL ? "(null)" : (char *)v3);
        goto lab_0x807bb67;
    }
  lab_0x807be3e:
    // 0x807be3e
    Old_DTD = DTD_recovery;
    result = 1;
    return result;
  lab_0x807bc2a:;
    int32_t v24 = *v19; // 0x807bc2d
    if (v24 == 0) {
        goto lab_0x807be3e;
    } else {
        // 0x807bc37
        if (str2 != NULL) {
            // 0x807bc98
            char * v25; // 0x807bc37
            switch (*v25) {
                case 49: {
                    // 0x807bcda
                    *(char *)*v19 = 1;
                    goto lab_0x807be3e;
                }
                case 43: {
                    // 0x807bcda
                    *(char *)*v19 = 1;
                    goto lab_0x807be3e;
                }
                default: {
                    // 0x807bcac
                    if (strcasecomp(str2, "on") == 0) {
                        // 0x807bcda
                        *(char *)*v19 = 1;
                        goto lab_0x807be3e;
                    } else {
                        // 0x807bcc3
                        if (strcasecomp(str2, "true") != 0) {
                            // 0x807bce7
                            char * v26; // 0x807bce7
                            switch (*v26) {
                                case 48: {
                                    // 0x807bd2d
                                    *(char *)*v19 = 0;
                                    goto lab_0x807be3e;
                                }
                                case 45: {
                                    // 0x807bd2d
                                    *(char *)*v19 = 0;
                                    goto lab_0x807be3e;
                                }
                                default: {
                                    // 0x807bcfb
                                    if (strcasecomp(str2, "off") == 0) {
                                        // 0x807bd2d
                                        *(char *)*v19 = 0;
                                        goto lab_0x807be3e;
                                    } else {
                                        // 0x807bd12
                                        if (strcasecomp(str2, "false") != 0) {
                                            goto lab_0x807be3e;
                                        } else {
                                            // 0x807bd2d
                                            *(char *)*v19 = 0;
                                            goto lab_0x807be3e;
                                        }
                                    }
                                }
                            }
                        } else {
                            // 0x807bcda
                            *(char *)*v19 = 1;
                            goto lab_0x807be3e;
                        }
                    }
                }
            }
        } else {
            switch (v18) {
                case 32: {
                    // 0x807bc7e
                    *(char *)v24 = 1;
                    goto lab_0x807be3e;
                }
                case 48: {
                    // 0x807bc8b
                    *(char *)v24 = 0;
                    goto lab_0x807be3e;
                }
                default: {
                    if (v18 != 16) {
                        goto lab_0x807be3e;
                    } else {
                        char * v27 = (char *)v24; // 0x807bc6f
                        *v27 = (char)(*v27 == 0);
                        goto lab_0x807be3e;
                    }
                }
            }
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c0a0 - 0x807c0dd
// Line range:    193 - 197
int32_t sametext(char * een, char * twee) {
    int32_t result = 1; // 0x807c0aa
    if (een != NULL && twee != NULL) {
        // 0x807c0b2
        result = strcmp(een, twee) == 0;
    }
    // 0x807c0d8
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c0dd - 0x807c13f
// Line range:    261 - 269
void TracelogOpenFailed(void) {
    // 0x807c0dd
    WWW_TraceFlag = 0;
    char * v1 = gettext("Trace Log open failed.  Trace off!");
    if (LYCursesON != 0) {
        // 0x807c0f5
        HTUserMsg(v1);
        return;
    }
    // 0x807c10b
    fprintf((struct _IO_FILE *)g160, "%s\n", v1);
    exit_immediately(1);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c13f - 0x807c1b4
// Line range:    272 - 284
char LYReopenTracelog(char * trace_flag_ptr) {
    // 0x807c13f
    if (WWW_TraceFlag != 0) {
        // 0x807c150
        fprintf(TraceFP(), "\nTurning off TRACE for fetch of log.\n");
    }
    // 0x807c167
    LYCloseTracelog();
    struct _IO_FILE * v1 = LYAppendToTxtFile((char *)LYTraceLogPath); // 0x807c174
    *(int32_t *)&LYTraceLogFP = (int32_t)v1;
    if (v1 == NULL) {
        // 0x807c187
        TracelogOpenFailed();
        // 0x807c1ae
        return 0;
    }
    // 0x807c192
    if (WWW_TraceFlag != 0) {
        // 0x807c19d
        WWW_TraceFlag = 0;
        *trace_flag_ptr = 1;
    }
    // 0x807c1ae
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c1b4 - 0x807c1f8
// Line range:    287 - 293
void turn_trace_back_on(char * trace_flag_ptr) {
    // 0x807c1b4
    if (*trace_flag_ptr == 1) {
        // 0x807c1c4
        WWW_TraceFlag = 1;
        *trace_flag_ptr = 0;
        fwrite((int32_t *)"Turning TRACE back on.\n\n", 1, 24, TraceFP());
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c1f8 - 0x807c21e
// Line range:    300 - 307
struct _IO_FILE * TraceFP(void) {
    int32_t * v1 = LYTraceLogFP; // 0x807c1fe
    return v1 == NULL ? (struct _IO_FILE *)g160 : (struct _IO_FILE *)v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c21e - 0x807c4b9
// Line range:    310 - 373
char LYOpenTraceLog(void) {
    // 0x807c21e
    if (WWW_TraceFlag == 0 || LYUseTraceLog == 0 || LYTraceLogFP != NULL) {
        // 0x807c4af
        return 1;
    }
    struct _IO_FILE * v1 = LYNewTxtFile((char *)LYTraceLogPath); // 0x807c258
    *(int32_t *)&LYTraceLogFP = (int32_t)v1;
    if (v1 == NULL) {
        // 0x807c26b
        TracelogOpenFailed();
        // 0x807c4af
        return 0;
    }
    // 0x807c279
    fflush((struct _IO_FILE *)g164);
    fflush((struct _IO_FILE *)g160);
    char * v2 = gettext("Lynx Trace Log"); // 0x807c29a
    fprintf(TraceFP(), "\t\t%s (%s)\n\n", v2, "2.8.7dev.11");
    if (LYValidate != 0) {
        // 0x807c2d1
        if (LYRestricted != 0 && had_restrictions_default != 0) {
            // 0x807c2e7
            if (WWW_TraceFlag != 0) {
                // 0x807c2f6
                fprintf(TraceFP(), "Validate and some anonymous restrictions are set.\n");
            }
            // 0x807c4af
            return 1;
        }
        if (had_restrictions_default != 0) {
            // 0x807c31d
            if (WWW_TraceFlag != 0) {
                // 0x807c32c
                fprintf(TraceFP(), "Validate restrictions set, restriction \"default\" was given.\n");
            }
            // 0x807c4af
            return 1;
        }
        if (LYRestricted == 0) {
            // 0x807c37e
            if (WWW_TraceFlag != 0) {
                // 0x807c38d
                fprintf(TraceFP(), "Validate restrictions are set.\n");
            }
        } else {
            // 0x807c353
            if (WWW_TraceFlag != 0) {
                // 0x807c362
                fprintf(TraceFP(), "Validate restrictions set, additional anonymous restrictions ignored.\n");
            }
        }
        // 0x807c4af
        return 1;
    }
    // 0x807c3a9
    if (LYRestricted != 0) {
        // 0x807c3b4
        if (had_restrictions_all == 0) {
            // 0x807c3ea
            if (WWW_TraceFlag != 0) {
                // 0x807c3f9
                fprintf(TraceFP(), "Anonymous restrictions are set.\n");
            }
        } else {
            // 0x807c3bf
            if (WWW_TraceFlag != 0) {
                // 0x807c3ce
                fprintf(TraceFP(), "Anonymous restrictions set, restriction \"all\" was given.\n");
            }
        }
        // 0x807c4af
        return 1;
    }
    // 0x807c415
    if (had_restrictions_all != 0 && had_restrictions_default != 0) {
        // 0x807c42b
        if (WWW_TraceFlag != 0) {
            // 0x807c436
            fprintf(TraceFP(), "Restrictions \"all\" and \"default\" were given.\n");
        }
        // 0x807c4af
        return 1;
    }
    if (had_restrictions_default == 0) {
        // 0x807c47e
        if (had_restrictions_all != 0 && WWW_TraceFlag != 0) {
            // 0x807c494
            fprintf(TraceFP(), "\"all\" restrictions are set.\n");
        }
    } else {
        // 0x807c45a
        if (WWW_TraceFlag != 0) {
            // 0x807c465
            fprintf(TraceFP(), "Restriction \"default\" was given.\n");
        }
    }
    // 0x807c4af
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c4b9 - 0x807c4fb
// Line range:    376 - 385
void LYCloseTracelog(void) {
    // 0x807c4b9
    if (LYTraceLogFP != NULL) {
        // 0x807c4c8
        fflush((struct _IO_FILE *)g164);
        fflush((struct _IO_FILE *)g160);
        fclose((struct _IO_FILE *)LYTraceLogFP);
        *(int32_t *)&LYTraceLogFP = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c4fb - 0x807c553
// Line range:    388 - 396
void handle_LYK_TRACE_TOGGLE(void) {
    // 0x807c4fb
    WWW_TraceFlag = WWW_TraceFlag == 0;
    if (LYOpenTraceLog() == 0) {
        // 0x807c551
        return;
    }
    // 0x807c51b
    char * v1; // 0x807c4fb
    if (WWW_TraceFlag == 0) {
        // 0x807c537
        v1 = gettext("Trace OFF!");
    } else {
        // 0x807c526
        v1 = gettext("Trace ON!");
    }
    // 0x807c546
    HTUserMsg(v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c553 - 0x807c560
// Line range:    399 - 401
void LYSetNewline(int32_t value) {
    // 0x807c553
    Newline = value;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c560 - 0x807c56a
// Line range:    406 - 408
int32_t LYGetNewline(void) {
    // 0x807c560
    return Newline;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c57c - 0x807c5ad
// Line range:    426 - 436
char reparse_document(void) {
    // 0x807c57c
    from_source_cache = 1;
    char result = HTreparse_document(); // 0x807c589
    from_source_cache = result != 0;
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c5ad - 0x807c5d5
// Line range:    444 - 452
char reparse_or_reload(int32_t * cmd) {
    char result = 0; // 0x807c5ba
    if (reparse_document() == 0) {
        // 0x807c5c2
        *cmd = 12;
        result = 1;
    }
    // 0x807c5cf
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c5d5 - 0x807c5f2
// Line range:    458 - 460
void set_address(int32_t * doc, char * address) {
    // 0x807c5d5
    HTSACopy((char **)((int32_t)doc + 4), address);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c5f2 - 0x807c612
// Line range:    463 - 465
void copy_address(int32_t * dst, int32_t * src) {
    int32_t v1 = *(int32_t *)((int32_t)src + 4); // 0x807c5fb
    HTSACopy((char **)((int32_t)dst + 4), (char *)v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c612 - 0x807c63c
// Line range:    468 - 470
void free_address(int32_t * doc) {
    int32_t * v1 = (int32_t *)((int32_t)doc + 4); // 0x807c61b
    int32_t v2 = *v1; // 0x807c61b
    if (v2 != 0) {
        // 0x807c622
        free((int32_t *)v2);
        *v1 = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c63c - 0x807c661
// Line range:    473 - 476
void move_address(int32_t * dst, int32_t * src) {
    // 0x807c63c
    copy_address(dst, src);
    free_address(src);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c661 - 0x807c727
// Line range:    486 - 528
char LYMainLoop_pageDisplay(int32_t line_num) {
    int32_t v1 = Newline; // 0x807c667
    Newline = line_num;
    if (from_source_cache != 0 || display_partial == 0 || (char *)v1 == (char *)1 != (line_num == 1 == g242 == (char *)1)) {
        // 0x807c708
        HText_pageDisplay(Newline, prev_target);
        // 0x807c721
        return 1;
    }
    char * found_char_pos = strchr((char *)g235, 35); // 0x807c6b7
    if (found_char_pos == NULL || *found_char_pos == 0) {
        // 0x807c708
        HText_pageDisplay(Newline, prev_target);
        // 0x807c721
        return 1;
    }
    char * v2 = (char *)((int32_t)found_char_pos + 1); // 0x807c6d5
    if (*v2 == 0) {
        // 0x807c708
        HText_pageDisplay(Newline, prev_target);
        // 0x807c721
        return 1;
    }
    // 0x807c6dc
    if (HTFindPoundSelector(v2) == 0) {
        // 0x807c6fa
        Newline = v1;
        // 0x807c721
        return 0;
    }
    // 0x807c6ee
    Newline = www_search_result;
    // 0x807c708
    HText_pageDisplay(Newline, prev_target);
    // 0x807c721
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c727 - 0x807c792
// Line range:    532 - 545
char set_curdoc_link(int32_t nextlink) {
    int32_t v1 = g251; // 0x807c731
    if (nextlink < 0 || v1 == nextlink || nlinks <= nextlink) {
        // 0x807c78c
        return 0;
    }
    char result = 0; // 0x807c752
    if (v1 > -1 == v1 < nlinks) {
        // 0x807c763
        LYhighlight(0, v1, prev_target);
        result = 1;
    }
    // 0x807c784
    g251 = nextlink;
    // 0x807c78c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c792 - 0x807c85b
// Line range:    554 - 568
void goto_line(int32_t nextline) {
    int32_t v1 = g241; // 0x807c799
    g241 = 0;
    if (nlinks <= 0) {
        // 0x807c855
        return;
    }
    int32_t v2 = 0;
    int32_t v3 = *(int32_t *)(68 * v2 + (int32_t)&g350); // 0x807c7c4
    while (v3 + 1 != nextline) {
        int32_t v4 = v2 + 1; // 0x807c843
        if (v4 >= nlinks) {
            // 0x807c855
            return;
        }
        v2 = v4;
        v3 = *(int32_t *)(68 * v2 + (int32_t)&g350);
    }
    // 0x807c7d2
    if (WWW_TraceFlag != 0) {
        int32_t v5 = HText_getTopOfScreen(); // 0x807c7dd
        fprintf(TraceFP(), "top_of_screen %d\n", v5 + 1);
        if (WWW_TraceFlag != 0) {
            // 0x807c80b
            fprintf(TraceFP(), "goto_line(%d) -> link %d -> %d\n", nextline, v1, v2);
        }
    }
    // 0x807c839
    g241 = v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c85b - 0x807c899
// Line range:    572 - 577
void set_curdoc_link_by_mouse(int32_t nextlink) {
    // 0x807c85b
    if (set_curdoc_link(nextlink) != 0) {
        // 0x807c870
        LYhighlight(1, nextlink, prev_target);
        LYmsec_delay(20);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c899 - 0x807c92c
// Line range:    583 - 604
int32_t do_change_link(void) {
    int32_t v1 = get_mouse_link(); // 0x807c89f
    if (v1 == -1) {
        // 0x807c927
        return 0;
    }
    // 0x807c8ad
    if (v1 > -1 == v1 < nlinks) {
        // 0x807c915
        set_curdoc_link_by_mouse(v1);
        // 0x807c927
        return 0;
    }
    int32_t mouse_tmp = 0; // bp-12, 0x807c8bd
    char * v2 = gettext("Internal error: Invalid mouse link %d!"); // 0x807c8cb
    HTSprintf0((char **)&mouse_tmp, v2);
    HTAlert((char *)mouse_tmp);
    if (mouse_tmp != 0) {
        // 0x807c8fa
        free((int32_t *)mouse_tmp);
        mouse_tmp = 0;
    }
    // 0x807c927
    return -1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807c92c - 0x807cbb7
// Line range:    616 - 730
void do_check_goto_URL(char * user_input_buffer, char ** old_user_input, char * force_load) {
    // 0x807c92c
    if (*user_input_buffer == 35) {
        char * v1 = (char *)((int32_t)user_input_buffer + 1); // 0x807c947
        if (*v1 == 0) {
            // 0x807cbb1
            return;
        }
        // 0x807c952
        if (HTFindPoundSelector(v1) != 0) {
            // 0x807c968
            HTAddGotoURL(user_input_buffer);
            trimPoundSelector((char *)g245);
            HTSACat((char **)&g245, user_input_buffer);
        }
        // 0x807cbb1
        return;
    }
    // 0x807c998
    HTSACopy(old_user_input, user_input_buffer);
    LYEnsureAbsoluteURL(old_user_input, (char *)&g20, 1);
    sprintf(user_input_buffer, "%.*s", 1023, *old_user_input);
    char * v2 = *old_user_input;
    if (v2 != NULL) {
        // 0x807c9f2
        free((int32_t *)v2);
        *(int32_t *)old_user_input = 0;
    }
    for (int32_t i = 0; i < 29; i++) {
        int32_t v3 = 8 * i; // 0x807ca14
        if (*(char *)*(int32_t *)(v3 + (int32_t)&g99) != 0) {
            int32_t * str = (int32_t *)(v3 + (int32_t)&g98);
            if (strncmp(user_input_buffer, (char *)*str, strlen((char *)*str)) == 0) {
                // 0x807ca57
                HTUserMsg2(gettext("You are not allowed to goto \"%s\" URLs"), (char *)*str);
                return;
            }
        }
    }
    // 0x807ca93
    if (LYValidate != 0) {
        // 0x807ca9e
        if (strncasecomp(user_input_buffer, "http:", 5) != 0) {
            // 0x807cabd
            if (strncasecomp(user_input_buffer, "https:", 6) != 0) {
                // 0x807cadc
                HTUserMsg(gettext("Goto a non-http URL is disallowed!"));
                // 0x807cbb1
                return;
            }
        }
    }
    // 0x807caf5
    set_address(&newdoc, user_input_buffer);
    g239 = 0;
    if (are_different(&curdoc, &newdoc) == 0) {
        // 0x807cb9d
        LYUserSpecifiedURL = 1;
        HTAddGotoURL((char *)g235);
        // 0x807cbb1
        return;
    }
    char * v4 = gettext("A URL specified by the user"); // 0x807cb2e
    HTSACopy((char **)&newdoc, v4);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x807cb58
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x807cb6f
    g240 = 0;
    g243 = 0;
    *force_load = 1;
    if (lynx_edit_mode != 0 && LYAutoUncacheDirLists >= 2) {
        // 0x807cb98
        HTuncache_current_document();
    }
    // 0x807cb9d
    LYUserSpecifiedURL = 1;
    HTAddGotoURL((char *)g235);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807cbb7 - 0x807cfe6
// Line range:    740 - 877
char do_check_recall(int32_t ch, char * user_input_buffer, char ** old_user_input, int32_t URLTotal, int32_t * URLNum, int32_t recall, char * FirstURLRecall) {
    // 0x807cbb7
    if (*old_user_input == NULL) {
        // 0x807cbca
        HTSACopy(old_user_input, (char *)&g20);
    }
    int32_t v1 = URLTotal - 1;
    LYTrimAllStartfile(user_input_buffer);
    int32_t v2 = ch; // 0x807cbf0
    bool v3 = recall != 0 == (ch | 1) == 257; // 0x807cbf0
    char v4; // 0x807cbb7
    char v5; // 0x807cbb7
    char v6; // 0x807cbb7
    char v7; // 0x807cbb7
    char result; // 0x807cbb7
    if (recall != 0 == (ch | 1) == 257 | *user_input_buffer != 0) {
        while (true) {
          lab_0x807cc62:;
            bool v8 = v3;
            bool v9 = recall == 0 | v2 != 257;
            char * v10; // 0x807ccc6
            while (true) {
                if (recall == 0 || v2 != 256) {
                    // 0x807ce1f
                    result = 1;
                    if (v9) {
                        return result;
                    }
                    // 0x807ce36
                    int32_t v11; // 0x807cbb7
                    if (*FirstURLRecall == 0) {
                        // 0x807ce53
                        v11 = *URLNum - 1;
                    } else {
                        // 0x807ce40
                        *FirstURLRecall = 0;
                        v11 = v1;
                    }
                    int32_t v12 = v11;
                    int32_t v13 = v12 >= 0 ? v12 : v1;
                    *URLNum = v13;
                    char * v14 = HTList_objectAt(Goto_URLs, v13); // 0x807ce86
                    if (v14 != NULL) {
                        // 0x807ce98
                        LYstrncpy(user_input_buffer, v14, 1023);
                        v7 = 0;
                        if (goto_buffer == 0) {
                            goto lab_0x807cf0f;
                        } else {
                            char * str = *old_user_input;
                            v6 = goto_buffer;
                            if (*str == 0) {
                                goto lab_0x807cefe;
                            } else {
                                // 0x807cec9
                                if (strcmp(str, user_input_buffer) != 0) {
                                    // 0x807cec9
                                    v6 = goto_buffer;
                                    goto lab_0x807cefe;
                                } else {
                                    // 0x807cee1
                                    mustshow = 1;
                                    statusline(gettext("Edit the current Goto URL: "));
                                    goto lab_0x807cf58;
                                }
                            }
                        }
                    }
                } else {
                    // 0x807cc79
                    int32_t v15; // 0x807cbb7
                    if (*FirstURLRecall == 0) {
                        // 0x807cc94
                        v15 = *URLNum + 1;
                    } else {
                        // 0x807cc83
                        *FirstURLRecall = 0;
                        v15 = 0;
                    }
                    int32_t v16 = v15;
                    int32_t v17 = v16 < URLTotal ? v16 : 0;
                    *URLNum = v17;
                    v10 = HTList_objectAt(Goto_URLs, v17);
                    if (v10 != NULL) {
                        // break -> 0x807ccd8
                        break;
                    }
                }
                // 0x807cbdd
                LYTrimAllStartfile(user_input_buffer);
                if (!((v8 | *user_input_buffer != 0))) {
                    goto lab_0x807cc0a_2;
                }
            }
            // 0x807ccd8
            LYstrncpy(user_input_buffer, v10, 1023);
            v5 = 0;
            if (goto_buffer == 0) {
                goto lab_0x807cd4f;
            } else {
                char * str2 = *old_user_input;
                v4 = goto_buffer;
                if (*str2 == 0) {
                    goto lab_0x807cd3e;
                } else {
                    // 0x807cd09
                    if (strcmp(str2, user_input_buffer) != 0) {
                        // 0x807cd09
                        v4 = goto_buffer;
                        goto lab_0x807cd3e;
                    } else {
                        // 0x807cd21
                        mustshow = 1;
                        statusline(gettext("Edit the current Goto URL: "));
                        goto lab_0x807cd98;
                    }
                }
            }
        }
      lab_0x807cfe0:
        // 0x807cfe0
        return result;
    }
  lab_0x807cc0a_2:
    // 0x807cc0a
    LYstrncpy(user_input_buffer, *old_user_input, 1023);
    char * v18 = *old_user_input;
    if (v18 != NULL) {
        // 0x807cc2f
        free((int32_t *)v18);
        *(int32_t *)old_user_input = 0;
    }
    // 0x807cc45
    HTInfoMsg(gettext("Cancelled!!!"));
    // 0x807cfe0
    return 0;
  lab_0x807cd4f:
    // 0x807cd4f
    if (URLTotal == 1 == v5 == 0) {
        goto lab_0x807cd60;
    } else {
        // 0x807cd7d
        mustshow = 1;
        statusline(gettext("Edit a previous Goto URL: "));
        goto lab_0x807cd98;
    }
  lab_0x807cd60:
    // 0x807cd60
    mustshow = 1;
    statusline(gettext("Edit the previous Goto URL: "));
    goto lab_0x807cd98;
  lab_0x807cd3e:
    // 0x807cd3e
    v5 = v4;
    if (URLTotal == 2 == (v4 != 0)) {
        goto lab_0x807cd60;
    } else {
        goto lab_0x807cd4f;
    }
  lab_0x807cd98:;
    int32_t v19 = LYgetstr(user_input_buffer, 0, 1024, recall); // 0x807cdb5
    int32_t v20 = v19; // 0x807cdc1
    if (v19 < 0) {
        // 0x807cdc7
        LYstrncpy(user_input_buffer, *old_user_input, 1023);
        char * v21 = *old_user_input;
        if (v21 == NULL) {
            goto lab_0x807ce02;
        } else {
            // 0x807cdec
            free((int32_t *)v21);
            *(int32_t *)old_user_input = 0;
            goto lab_0x807ce02;
        }
    }
    goto lab_0x807cbdd;
  lab_0x807cbdd:
    // 0x807cbdd
    v2 = v20;
    LYTrimAllStartfile(user_input_buffer);
    v3 = recall != 0 == (v2 | 1) == 257;
    if (!((recall != 0 == (v2 | 1) == 257 | *user_input_buffer != 0))) {
        goto lab_0x807cc0a_2;
    }
    goto lab_0x807cc62;
  lab_0x807cf0f:
    // 0x807cf0f
    if (URLTotal == 1 == v7 == 0) {
        goto lab_0x807cf20;
    } else {
        // 0x807cf3d
        mustshow = 1;
        statusline(gettext("Edit a previous Goto URL: "));
        goto lab_0x807cf58;
    }
  lab_0x807cf20:
    // 0x807cf20
    mustshow = 1;
    statusline(gettext("Edit the previous Goto URL: "));
    goto lab_0x807cf58;
  lab_0x807cefe:
    // 0x807cefe
    v7 = v6;
    if (URLTotal == 2 == (v6 != 0)) {
        goto lab_0x807cf20;
    } else {
        goto lab_0x807cf0f;
    }
  lab_0x807cf58:;
    int32_t v22 = LYgetstr(user_input_buffer, 0, 1024, recall); // 0x807cf75
    v20 = v22;
    if (v22 >= 0) {
        goto lab_0x807cbdd;
    } else {
        // 0x807cf87
        LYstrncpy(user_input_buffer, *old_user_input, 1023);
        char * v23 = *old_user_input;
        if (v23 == NULL) {
            goto lab_0x807cfc2;
        } else {
            // 0x807cfac
            free((int32_t *)v23);
            *(int32_t *)old_user_input = 0;
            goto lab_0x807cfc2;
        }
    }
  lab_0x807cfc2:
    // 0x807cfc2
    HTInfoMsg(gettext("Cancelled!!!"));
    result = 0;
    goto lab_0x807cfe0;
  lab_0x807ce02:
    // 0x807ce02
    HTInfoMsg(gettext("Cancelled!!!"));
    result = 0;
    goto lab_0x807cfe0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807cfe6 - 0x807d03c
// Line range:    880 - 892
void do_cleanup_after_delete(void) {
    // 0x807cfe6
    HTuncache_current_document();
    move_address(&newdoc, &curdoc);
    *(int32_t *)&g242 = (int32_t)g252;
    int32_t v1 = g251; // 0x807d00f
    g241 = v1 + (int32_t)(v1 == nlinks - 1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807d03c - 0x807d199
// Line range:    896 - 922
int32_t find_link_near_col(int32_t col, int32_t delta) {
    int32_t v1 = g251;
    bool v2; // 0x807d03c
    int32_t v3; // 0x807d16f
    if (delta < 1) {
        // 0x807d178
        v2 = v1 > -1;
    } else {
        // 0x807d16a
        v3 = v1 - nlinks;
        v2 = v3 < 0 != ((v3 ^ v1) & (v1 ^ nlinks)) < 0;
    }
    int32_t result = -1; // 0x807d187
    int32_t v4; // 0x807d03c
    int32_t v5; // 0x807d03c
    int32_t v6; // 0x807d03c
    int32_t v7; // 0x807d05c
    while (v2) {
        // 0x807d04f
        v7 = *(int32_t *)(68 * v1 + (int32_t)&g346);
        v4 = -1;
        v5 = 0xf4240;
        v6 = v1;
        if ((v7 - *(int32_t *)(68 * g251 + (int32_t)&g346)) * delta >= 1) {
            goto lab_0x807d122;
        }
        // 0x807d15e
        v1 += delta;
        if (delta < 1) {
            // 0x807d178
            v2 = v1 > -1;
        } else {
            // 0x807d16a
            v3 = v1 - nlinks;
            v2 = v3 < 0 != ((v3 ^ v1) & (v1 ^ nlinks)) < 0;
        }
        // 0x807d183
        result = -1;
    }
    // 0x807d194
    return result;
  lab_0x807d122:;
    int32_t v8 = v6;
    int32_t v9 = v5;
    int32_t v10 = v4;
    if (delta < 1) {
        // 0x807d134
        result = v10;
        if (v8 < 0) {
            return result;
        } else {
            goto lab_0x807d13a;
        }
    } else {
        // 0x807d128
        result = v10;
        if (v8 < nlinks) {
            goto lab_0x807d13a;
        } else {
            return result;
        }
    }
  lab_0x807d13a:;
    int32_t v11 = 68 * v8; // 0x807d145
    result = v10;
    int32_t v12; // 0x807d03c
    if (*(int32_t *)(v11 + (int32_t)&g346) == v7) {
        int32_t v13 = *(int32_t *)(v11 + (int32_t)&g345); // 0x807d0bc
        char * str = LYGetHiliteStr(v8, 0); // 0x807d0d3
        v12 = v13;
        if (str == NULL) {
            goto lab_0x807d0f9;
        } else {
            // 0x807d0e1
            v12 = strlen(str) / 2 + v13;
            goto lab_0x807d0f9;
        }
    } else {
        return result;
    }
  lab_0x807d0f9:;
    int32_t v14 = v12 - col; // 0x807d0fc
    int32_t v15 = v14 >= 0 ? v14 : -v14;
    v4 = v15 < v9 ? v8 : v10;
    v5 = v15 < v9 ? v15 : v9;
    v6 = v8 + delta;
    goto lab_0x807d122;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807d199 - 0x807d548
// Line range:    932 - 1014
int32_t DoTraversal(int32_t c, char * crawl_ok) {
    // 0x807d199
    int32_t result; // 0x807d199
    if (nlinks < 1) {
        goto lab_0x807d456;
    } else {
        int32_t v1 = 68 * g251;
        if (*(int32_t *)(v1 + (int32_t)&g347) == 1) {
            goto lab_0x807d456;
        } else {
            int32_t v2 = *(int32_t *)(v1 + (int32_t)&links); // 0x807d1d5
            if (v2 == 0) {
                goto lab_0x807d456;
            } else {
                // 0x807d200
                if (lookup_reject((char *)v2) != 0 || traversal_host == 0) {
                    goto lab_0x807d439;
                } else {
                    int32_t v3 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807d246
                    if (v3 == 0) {
                        goto lab_0x807d439;
                    } else {
                        int32_t v4 = strncasecomp((char *)v3, "LYNXIMGMAP:", 11); // 0x807d27c
                        int32_t len = strlen((char *)traversal_host);
                        int32_t str = *(int32_t *)(68 * g251 + (int32_t)&links);
                        int32_t strncmp_rc; // 0x807d199
                        if (v4 == 0) {
                            // 0x807d2c9
                            strncmp_rc = strncmp((char *)traversal_host, (char *)(str + 11), len);
                        } else {
                            // 0x807d285
                            strncmp_rc = strncmp((char *)traversal_host, (char *)str, len);
                        }
                        // 0x807d31a
                        if (strncmp_rc != 0) {
                            goto lab_0x807d439;
                        } else {
                            int32_t v5 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807d33d
                            if (lookup_link((char *)v5) == 0) {
                                int32_t v6 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807d3ea
                                HTSACopy((char **)&traversal_link_to_add, (char *)v6);
                                result = 258;
                                if (strncasecomp((char *)traversal_link_to_add, "LYNXIMGMAP:", 11) != 0) {
                                    // 0x807d421
                                    *(char *)c = 1;
                                    result = 258;
                                }
                                goto lab_0x807d4d3;
                            } else {
                                // 0x807d353
                                result = 257;
                                if (more_links != 0) {
                                    goto lab_0x807d4d3;
                                } else {
                                    // 0x807d35e
                                    if (g251 < 0) {
                                        goto lab_0x807d385;
                                    } else {
                                        // 0x807d367
                                        result = 257;
                                        if (g251 < nlinks - 1) {
                                            goto lab_0x807d4d3;
                                        } else {
                                            goto lab_0x807d385;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x807d456:
    // 0x807d456
    result = 257;
    if (more_links != 0) {
        goto lab_0x807d4d3;
    } else {
        // 0x807d461
        if (g251 < 0) {
            goto lab_0x807d485;
        } else {
            // 0x807d46a
            result = 257;
            if (g251 < nlinks - 1) {
                goto lab_0x807d4d3;
            } else {
                goto lab_0x807d485;
            }
        }
    }
  lab_0x807d4d3:
    // 0x807d4d3
    if (WWW_TraceFlag != 0) {
        char * v7 = LYKeycodeToString(result, 0); // 0x807d4ec
        int32_t v8 = nlinks;
        fprintf(TraceFP(), "DoTraversal(%d:%d) -> %s\n", v8 < 1 ? 0 : g251, v8, v7);
    }
    // 0x807d543
    return result;
  lab_0x807d485:
    // 0x807d485
    if (strcmp((char *)curdoc, "Entry into main screen") == 0) {
        goto lab_0x807d4a7;
    } else {
        int32_t v9 = nhist; // 0x807d49e
        result = 259;
        if (v9 >= 0 == (v9 != 0)) {
            goto lab_0x807d4d3;
        } else {
            goto lab_0x807d4a7;
        }
    }
  lab_0x807d4a7:
    // 0x807d4a7
    result = -1;
    if (dump_output_immediately == 0) {
        // 0x807d4b2
        cleanup();
        exit_immediately(1);
        // UNREACHABLE
    }
    goto lab_0x807d4d3;
  lab_0x807d439:;
    int32_t v10 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807d448
    add_to_reject_list((char *)v10);
    goto lab_0x807d456;
  lab_0x807d385:
    // 0x807d385
    if (strcmp((char *)curdoc, "Entry into main screen") == 0) {
        goto lab_0x807d3a7;
    } else {
        int32_t v11 = nhist; // 0x807d39e
        result = 259;
        if (v11 >= 0 == (v11 != 0)) {
            goto lab_0x807d4d3;
        } else {
            goto lab_0x807d3a7;
        }
    }
  lab_0x807d3a7:
    // 0x807d3a7
    result = -1;
    if (dump_output_immediately == 0) {
        // 0x807d3b2
        cleanup();
        exit_immediately(1);
        // UNREACHABLE
    }
    goto lab_0x807d4d3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807d548 - 0x807e8fc
// Line range:    1059 - 1513
int32_t handle_LYK_ACTIVATE(int32_t * c, int32_t cmd, char * try_internal, char * refresh_screen, char * force_load, int32_t real_cmd) {
    // 0x807d548
    int32_t v1; // 0x807d548
    int32_t v2 = v1;
    if (do_change_link() == -1) {
        // 0x807d55b
        LYforce_no_cache = 0;
        reloading = 0;
        // 0x807e8f1
        return 1;
    }
    // 0x807d575
    if (nlinks < 1) {
        // 0x807e8f1
        return 0;
    }
    int32_t v3 = 68 * g251;
    int32_t v4; // 0x807d548
    int32_t v5; // 0x807d548
    char * v6; // 0x807d548
    int32_t v7; // bp-140, 0x807d548
    if (*(int32_t *)(v3 + (int32_t)&g347) != 1) {
        // 0x807e20e
        if (no_file_url == 0) {
            goto lab_0x807e3a2;
        } else {
            int32_t v8 = *(int32_t *)(v3 + (int32_t)&links); // 0x807e22c
            char * v9 = (char *)v8; // 0x807e232
            char v10 = *v9; // 0x807e232
            if (v10 != 102 == (v10 != 70)) {
                goto lab_0x807e3a2;
            } else {
                // 0x807e259
                v7 = v8;
                if (strncasecomp(v9, "file:", 5) != 0) {
                    goto lab_0x807e3a2;
                } else {
                    char v11 = *(char *)g245; // 0x807e293
                    v6 = (char *)g245;
                    if (v11 != 102 == (v11 != 70)) {
                        goto lab_0x807e2cb;
                    } else {
                        // 0x807e2a6
                        v7 = (int32_t)g245;
                        if (strncasecomp((char *)g245, "file:", 5) == 0) {
                            goto lab_0x807e372;
                        } else {
                            // 0x807e2a6
                            v6 = (char *)g245;
                            goto lab_0x807e2cb;
                        }
                    }
                }
            }
        }
    } else {
        // 0x807d5a0
        v5 = *(int32_t *)(v3 + (int32_t)&g354);
        v4 = *(int32_t *)(v5 + 8);
        if (v2 != 39 || textfields_need_activation == 0) {
            goto lab_0x807d6a2;
        } else {
            switch (v4) {
                case 1: {
                    goto lab_0x807d64a;
                }
                case 12: {
                    goto lab_0x807d64a;
                }
                case 2: {
                    goto lab_0x807d64a;
                }
                case 11: {
                    goto lab_0x807d64a;
                }
                default: {
                    if (v4 != 9) {
                        goto lab_0x807d6a2;
                    } else {
                        goto lab_0x807d64a;
                    }
                }
            }
        }
    }
  lab_0x807e3a2:;
    int32_t v12 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807e3b1
    v7 = v12;
    if (strncasecomp((char *)v12, "LYNXCOOKIE:", 11) != 0) {
        goto lab_0x807e43c;
    } else {
        // 0x807e3d3
        v7 = (int32_t)"Cookie Jar";
        char * str2 = gettext("Cookie Jar"); // 0x807e3da
        int32_t v13 = curdoc; // 0x807e3e2
        char * str = v13 == 0 ? (char *)&g20 : (char *)v13;
        v7 = (int32_t)str;
        if (strcmp(str, str2) != 0) {
            goto lab_0x807e610;
        } else {
            // 0x807e417
            v7 = (int32_t)g245;
            if (strncasecomp((char *)g245, "LYNXCOOKIE:", 11) != 0) {
                goto lab_0x807e610;
            } else {
                goto lab_0x807e43c;
            }
        }
    }
  lab_0x807d6a2:;
    int32_t v14; // 0x807d548
    switch (v4) {
        case 5: {
            goto lab_0x807d6fd;
        }
        case 13: {
            goto lab_0x807d6fd;
        }
        default: {
            // 0x807d6dc
            v14 = v5;
            if (v4 != 12) {
                goto lab_0x807dcdd;
            } else {
                goto lab_0x807d6fd;
            }
        }
    }
  lab_0x807e43c:;
    int32_t v15 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807e44b
    v7 = v15;
    if (strncasecomp((char *)v15, "LYNXDIRED:", 10) != 0) {
        goto lab_0x807e4d4;
    } else {
        // 0x807e46d
        v7 = (int32_t)g245;
        if (LYIsUIPage3((char *)g245, 8, 1) != 0) {
            goto lab_0x807e4d4;
        } else {
            // 0x807e48e
            v7 = (int32_t)g245;
            if (LYIsUIPage3((char *)g245, 9, 1) != 0) {
                goto lab_0x807e4d4;
            } else {
                // 0x807e4af
                v7 = (int32_t)g245;
                if (LYIsUIPage3((char *)g245, 10, 1) == 0) {
                    goto lab_0x807e610;
                } else {
                    goto lab_0x807e4d4;
                }
            }
        }
    }
  lab_0x807d6fd:
    // 0x807d6fd
    if (*(int32_t *)(v5 + 80) == 1) {
        // 0x807d71a
        v7 = (int32_t)"www/present";
        int32_t * v16 = HTAtom_for("www/present"); // 0x807d721
        *(int32_t *)&HTOutputFormat = (int32_t)v16;
        LYforce_no_cache = 0;
        reloading = 0;
        // 0x807e8f1
        return 0;
    }
    int32_t * v17 = (int32_t *)(v5 + 48);
    int32_t v18 = *v17; // 0x807d75a
    if (v18 == 0) {
        goto lab_0x807d780;
    } else {
        char * v19 = (char *)v18; // 0x807d779
        char v20 = *v19; // 0x807d779
        if (v20 != 0) {
            // 0x807d7bf
            if (*(int32_t *)(v5 + 52) == 3 && no_mail != 0) {
                // 0x807d7e7
                v7 = (int32_t)"Mail disallowed!  Cannot submit.";
                char * v21 = gettext("Mail disallowed!  Cannot submit."); // 0x807d7ee
                v7 = (int32_t)v21;
                HTAlert(v21);
                v7 = (int32_t)"www/present";
                int32_t * v22 = HTAtom_for("www/present"); // 0x807d802
                *(int32_t *)&HTOutputFormat = (int32_t)v22;
                LYforce_no_cache = 0;
                reloading = 0;
                // 0x807e8f1
                return 0;
            }
            int32_t * v23 = v17; // 0x807d82f
            if (no_file_url != 0) {
                // 0x807d835
                v23 = v17;
                if (v20 != 102 != v20 != 70) {
                    // 0x807d873
                    v7 = v18;
                    if (strncasecomp(v19, "file:", 5) == 0) {
                        // 0x807d8a7
                        v7 = (int32_t)"file: ACTIONs are disallowed!";
                        char * v24 = gettext("file: ACTIONs are disallowed!"); // 0x807d8ae
                        v7 = (int32_t)v24;
                        HTAlert(v24);
                        v7 = (int32_t)"www/present";
                        int32_t * v25 = HTAtom_for("www/present"); // 0x807d8c2
                        *(int32_t *)&HTOutputFormat = (int32_t)v25;
                        LYforce_no_cache = 0;
                        reloading = 0;
                        // 0x807e8f1
                        return 0;
                    }
                    int32_t v26 = *(int32_t *)(68 * g251 + (int32_t)&g354);
                    v23 = (int32_t *)(v26 + 48);
                }
            }
            int32_t v27 = *v23; // 0x807d8fb
            v7 = v27;
            if (strncasecomp((char *)v27, "LYNXCOOKIE:", 11) == 0) {
                goto lab_0x807dbc1;
            } else {
                int32_t v28 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807d92d
                int32_t v29 = *(int32_t *)(v28 + 48); // 0x807d933
                v7 = v29;
                if (strncasecomp((char *)v29, "LYNXDIRED:", 10) != 0) {
                    goto lab_0x807d9c1;
                } else {
                    // 0x807d952
                    if (no_dired_support != 0) {
                        goto lab_0x807dbc1;
                    } else {
                        int32_t v30 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807d970
                        int32_t v31 = *(int32_t *)(v30 + 48) + 10; // 0x807d979
                        v7 = v31;
                        if (strncasecomp((char *)v31, "//PERMIT_LOCATION", 17) != 0) {
                            goto lab_0x807dbc1;
                        } else {
                            // 0x807d99c
                            v7 = (int32_t)g245;
                            if (LYIsUIPage3((char *)g245, 9, 1) == 0) {
                                goto lab_0x807dbc1;
                            } else {
                                goto lab_0x807d9c1;
                            }
                        }
                    }
                }
            }
        } else {
            goto lab_0x807d780;
        }
    }
  lab_0x807d64a:
    // 0x807d64a
    textinput_activated = 1;
    __asm_rep_movsd_memcpy((char *)&v7, (char *)(v3 + (int32_t)&links), 17);
    show_main_statusline((int32_t)&g391, (int32_t)&g391);
    textfields_need_activation = textfields_activation_option;
    // 0x807e8f1
    return 0;
  lab_0x807e4d4:;
    int32_t v32 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807e4e3
    v7 = v32;
    if (strncasecomp((char *)v32, "LYNXDOWNLOAD:", 13) != 0) {
        goto lab_0x807e52a;
    } else {
        // 0x807e505
        v7 = (int32_t)g245;
        if (LYIsUIPage3((char *)g245, 1, 1) == 0) {
            goto lab_0x807e610;
        } else {
            goto lab_0x807e52a;
        }
    }
  lab_0x807e610:
    // 0x807e610
    v7 = (int32_t)"This special URL is not allowed in external documents!";
    char * v33 = gettext("This special URL is not allowed in external documents!"); // 0x807e617
    v7 = (int32_t)v33;
    HTAlert(v33);
    v7 = (int32_t)"www/present";
    int32_t * v34 = HTAtom_for("www/present"); // 0x807e62b
    *(int32_t *)&HTOutputFormat = (int32_t)v34;
    LYforce_no_cache = 0;
    reloading = 0;
    // 0x807e8f1
    return 0;
  lab_0x807dcdd:;
    int32_t v35 = *(int32_t *)(v14 + 8); // 0x807dcf2
    switch (v35) {
        case 1: {
            goto lab_0x807dd72;
        }
        case 12: {
            goto lab_0x807dd72;
        }
        case 2: {
            goto lab_0x807dd72;
        }
        case 11: {
            goto lab_0x807dd72;
        }
        default: {
            if (v35 != 9) {
                goto lab_0x807de09;
            } else {
                goto lab_0x807dd72;
            }
        }
    }
  lab_0x807d780:
    // 0x807d780
    v7 = (int32_t)"** Bad HTML!!  No form action defined. **";
    char * v36 = gettext("** Bad HTML!!  No form action defined. **"); // 0x807d787
    v7 = (int32_t)v36;
    HTUserMsg(v36);
    v7 = (int32_t)"www/present";
    int32_t * v37 = HTAtom_for("www/present"); // 0x807d79b
    *(int32_t *)&HTOutputFormat = (int32_t)v37;
    LYforce_no_cache = 0;
    reloading = 0;
    // 0x807e8f1
    return 0;
  lab_0x807e52a:;
    int32_t v38 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807e539
    v7 = v38;
    if (strncasecomp((char *)v38, "LYNXHIST:", 9) != 0) {
        goto lab_0x807e5be;
    } else {
        // 0x807e55b
        v7 = (int32_t)g245;
        if (LYIsUIPage3((char *)g245, 0, 1) != 0) {
            goto lab_0x807e5be;
        } else {
            // 0x807e57c
            v7 = (int32_t)g245;
            if (LYIsUIPage3((char *)g245, 4, 1) != 0) {
                goto lab_0x807e5be;
            } else {
                // 0x807e59d
                v7 = (int32_t)g245;
                if (LYIsUIPage3((char *)g245, 11, 1) == 0) {
                    goto lab_0x807e610;
                } else {
                    goto lab_0x807e5be;
                }
            }
        }
    }
  lab_0x807e2cb:
    // 0x807e2cb
    v7 = (int32_t)g245;
    if (strncasecomp(v6, "LYNXKEYMAP:", 11) == 0) {
        goto lab_0x807e30d;
    } else {
        // 0x807e2ec
        v7 = (int32_t)g245;
        if (strncasecomp((char *)g245, "LYNXCOOKIE:", 11) != 0) {
            goto lab_0x807e34b;
        } else {
            goto lab_0x807e30d;
        }
    }
  lab_0x807dd72:;
    int32_t v39 = 0; // 0x807d548
    switch (v2) {
        case 68: {
            goto lab_0x807dda5;
        }
        case 63: {
            goto lab_0x807dda5;
        }
        case 46: {
            goto lab_0x807dda5;
        }
        default: {
            if (v2 != 40) {
                // 0x807dd9e
                v39 = 2;
                goto lab_0x807dda5;
            } else {
                // 0x807dd8a
                v39 = 0;
                if (textinput_activated != 0) {
                    // 0x807dd9e
                    v39 = 2;
                    goto lab_0x807dda5;
                } else {
                    goto lab_0x807dda5;
                }
            }
        }
    }
  lab_0x807e5be:;
    int32_t v40 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807e5cd
    v7 = v40;
    if (strncasecomp((char *)v40, "LYNXPRINT:", 10) != 0) {
        goto lab_0x807e64f;
    } else {
        // 0x807e5ef
        v7 = (int32_t)g245;
        if (LYIsUIPage3((char *)g245, 2, 1) != 0) {
            goto lab_0x807e64f;
        } else {
            goto lab_0x807e610;
        }
    }
  lab_0x807e30d:
    // 0x807e30d
    v7 = helpfilepath;
    int32_t len = strlen((char *)helpfilepath); // 0x807e315
    int32_t str3 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807e331
    v7 = str3;
    if (strncmp((char *)str3, (char *)helpfilepath, len) == 0) {
        goto lab_0x807e372;
    } else {
        goto lab_0x807e34b;
    }
  lab_0x807e372:
    // 0x807e372
    if (g248 != NULL) {
        // 0x807e37b
        v7 = (int32_t)"file: URLs via bookmarks are disallowed!";
        char * v41 = gettext("file: URLs via bookmarks are disallowed!"); // 0x807e382
        v7 = (int32_t)v41;
        HTAlert(v41);
        reloading = 0;
        // 0x807e8f1
        return 0;
    }
    goto lab_0x807e3a2;
  lab_0x807de09:;
    char v42 = 1; // 0x807d548
    switch (v2) {
        case 63: {
            goto lab_0x807de31;
        }
        case 46: {
            goto lab_0x807de31;
        }
        case 40: {
            goto lab_0x807de31;
        }
        default: {
            // 0x807de1b
            v42 = v2 == 68;
            goto lab_0x807de31;
        }
    }
  lab_0x807dda5:
    // 0x807dda5
    v7 = v14;
    show_formlink_statusline((int32_t *)v14, v39);
    if (user_mode == 0 && textinput_activated != 0) {
        if (v2 != 39 != v2 != 40) {
            int32_t v43 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807ddf8
            int32_t v44 = *(int32_t *)(v43 + 80); // 0x807ddfe
            v7 = v44;
            form_noviceline(v44);
        }
    }
    goto lab_0x807de09;
  lab_0x807dbc1:
    // 0x807dbc1
    v7 = (int32_t)"This special URL cannot be a form ACTION!";
    char * v45 = gettext("This special URL cannot be a form ACTION!"); // 0x807dbc8
    v7 = (int32_t)v45;
    HTAlert(v45);
    if (WWW_TraceFlag != 0) {
        int32_t v46 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807dbef
        struct _IO_FILE * stream = TraceFP(); // 0x807dbf8
        v7 = (int32_t)stream;
        fprintf(stream, "LYMainLoop: Rejected '%s'\n", (char *)*(int32_t *)(v46 + 48));
    }
    // 0x807dc13
    v7 = (int32_t)"www/present";
    int32_t * v47 = HTAtom_for("www/present"); // 0x807dc1a
    *(int32_t *)&HTOutputFormat = (int32_t)v47;
    LYforce_no_cache = 0;
    reloading = 0;
    // 0x807e8f1
    return 0;
  lab_0x807e64f:;
    int32_t v48 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807e65e
    v7 = v48;
    if (run_external((char *)v48, 1) != 0) {
        // 0x807e8f1
        return 0;
    }
    int32_t v49 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807e699
    v7 = &newdoc;
    set_address(&newdoc, (char *)v49);
    v7 = g251;
    char * v50 = LYGetHiliteStr(g251, 0); // 0x807e6bf
    v7 = &newdoc;
    HTSACopy((char **)&newdoc, v50);
    v7 = &curdoc;
    if (are_different(&curdoc, &newdoc) != 0) {
        // 0x807e6ec
        v7 = &newdoc;
        LYFreePostData(&newdoc);
        if (g238 != NULL) {
            // 0x807e701
            v7 = (int32_t)g238;
            free((int32_t *)g238);
            g238 = NULL;
        }
        // 0x807e718
        v7 = (int32_t)g235;
        if (strncasecomp((char *)g235, "LYNXMESSAGES:", 13) == 0) {
            // 0x807e739
            LYforce_no_cache = 1;
        }
    }
    // 0x807e740
    if (no_jump != 0 || lynxjumpfile == 0 || g245 == NULL) {
        goto lab_0x807e78b;
    } else {
        // 0x807e75d
        v7 = lynxjumpfile;
        if (strcmp((char *)lynxjumpfile, (char *)g245) != 0) {
            goto lab_0x807e78b;
        } else {
            // 0x807e778
            LYJumpFileURL = 1;
            LYUserSpecifiedURL = 1;
            goto lab_0x807e858;
        }
    }
  lab_0x807e34b:
    // 0x807e34b
    v7 = (int32_t)"file: URLs via served links are disallowed!";
    char * v51 = gettext("file: URLs via served links are disallowed!"); // 0x807e352
    v7 = (int32_t)v51;
    HTAlert(v51);
    reloading = 0;
    // 0x807e8f1
    return 0;
  lab_0x807de31:
    // 0x807de31
    v7 = g251;
    char * v52; // 0x807d548
    int32_t v53 = change_form_link(g251, &newdoc, v52, 0, v42); // 0x807de5c
    *c = v53;
    if (v53 != 2046) {
        goto lab_0x807de82;
    } else {
        // 0x807de74
        if (*v52 == 0) {
            // 0x807df48
            v7 = (int32_t)"www/download";
            if (HTAtom_for("www/download") == HTOutputFormat && g236 != 0) {
                // 0x807df70
                if (g240 == 0) {
                    // 0x807df7f
                    v7 = &newdoc;
                    if (HText_POSTReplyLoaded(&newdoc) == 1) {
                        // 0x807df93
                        v7 = (int32_t)"Document from Form with POST content.  Resubmit?";
                        char * v54 = gettext("Document from Form with POST content.  Resubmit?"); // 0x807df9a
                        v7 = (int32_t)v54;
                        if (HTConfirm(v54) == 0) {
                            // 0x807dfaf
                            v7 = (int32_t)"Cancelled!!!";
                            char * v55 = gettext("Cancelled!!!"); // 0x807dfb6
                            v7 = (int32_t)v55;
                            HTInfoMsg(v55);
                            v7 = (int32_t)"www/present";
                            int32_t * v56 = HTAtom_for("www/present"); // 0x807dfca
                            *(int32_t *)&HTOutputFormat = (int32_t)v56;
                            LYforce_no_cache = 0;
                            v7 = &newdoc;
                            copy_address(&newdoc, &curdoc);
                            v7 = &newdoc;
                            HTSACopy((char **)&newdoc, (char *)curdoc);
                            int32_t v57 = 0; // 0x807e00b
                            char * v58 = NULL; // 0x807e00b
                            if (g246 != 0) {
                                // 0x807e02a
                                v57 = *(int32_t *)(g246 + 4);
                                v58 = (char *)*(int32_t *)g246;
                            }
                            // 0x807e03d
                            v7 = &g236;
                            HTSABCopy((int32_t **)&g236, v58, v57);
                            v7 = (int32_t)&g237;
                            HTSACopy(&g237, g247);
                            v7 = (int32_t)&g238;
                            HTSACopy(&g238, g248);
                            g239 = g249;
                            g240 = g250;
                            g243 = g253;
                            // 0x807e8f1
                            return 0;
                        }
                    }
                }
            }
            // 0x807e0b1
            if (check_realm != 0) {
                // 0x807e0bc
                if (LYValidate == 0) {
                    // 0x807e0c7
                    LYPermitURL = 1;
                }
            }
            goto lab_0x807e0ce;
        } else {
            goto lab_0x807de82;
        }
    }
  lab_0x807d9c1:;
    int32_t v59 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807d9d0
    int32_t v60 = *(int32_t *)(v59 + 48); // 0x807d9d6
    v7 = v60;
    int32_t * v61; // 0x807d548
    if (strncasecomp((char *)v60, "LYNXDOWNLOAD:", 13) == 0) {
        goto lab_0x807dbc1;
    } else {
        int32_t v62 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807da08
        int32_t v63 = *(int32_t *)(v62 + 48); // 0x807da0e
        v7 = v63;
        if (strncasecomp((char *)v63, "LYNXHIST:", 9) == 0) {
            goto lab_0x807dbc1;
        } else {
            int32_t v64 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807da40
            int32_t v65 = *(int32_t *)(v64 + 48); // 0x807da46
            v7 = v65;
            if (strncasecomp((char *)v65, "LYNXKEYMAP:", 11) == 0) {
                goto lab_0x807dbc1;
            } else {
                int32_t v66 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807da78
                int32_t v67 = *(int32_t *)(v66 + 48); // 0x807da7e
                v7 = v67;
                if (strncasecomp((char *)v67, "LYNXIMGMAP:", 11) == 0) {
                    goto lab_0x807dbc1;
                } else {
                    int32_t v68 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807dab0
                    int32_t v69 = *(int32_t *)(v68 + 48); // 0x807dab6
                    v7 = v69;
                    if (strncasecomp((char *)v69, "LYNXPRINT:", 10) == 0) {
                        goto lab_0x807dbc1;
                    } else {
                        int32_t v70 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807dae8
                        int32_t * v71 = (int32_t *)(v70 + 48);
                        int32_t v72 = *v71; // 0x807daee
                        char * v73 = (char *)v72; // 0x807daf1
                        char v74 = *v73; // 0x807daf1
                        v61 = v71;
                        if (v74 != 108 == (v74 != 76)) {
                            goto lab_0x807db4b;
                        } else {
                            // 0x807db17
                            v7 = v72;
                            if (strncasecomp(v73, "lynxexec:", 9) == 0) {
                                goto lab_0x807dbc1;
                            } else {
                                int32_t v75 = *(int32_t *)(68 * g251 + (int32_t)&g354);
                                v61 = (int32_t *)(v75 + 48);
                                goto lab_0x807db4b;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x807e78b:
    // 0x807e78b
    if (curdoc == 0) {
        goto lab_0x807e7d7;
    } else {
        // 0x807e794
        v7 = (int32_t)g245;
        if (LYIsUIPage3((char *)g245, 0, 1) != 0) {
            // 0x807e804
            LYUserSpecifiedURL = 1;
            goto lab_0x807e858;
        } else {
            // 0x807e7b5
            v7 = (int32_t)"History Page";
            char * str4 = gettext("History Page"); // 0x807e7bc
            v7 = curdoc;
            if (strcmp((char *)curdoc, str4) == 0) {
                // 0x807e804
                LYUserSpecifiedURL = 1;
                goto lab_0x807e858;
            } else {
                goto lab_0x807e7d7;
            }
        }
    }
  lab_0x807de82:;
    int32_t v76 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807de91
    int32_t v77 = *(int32_t *)(v76 + 8); // 0x807de97
    switch (v77) {
        case 5: {
            goto lab_0x807dedd;
        }
        case 13: {
            goto lab_0x807dedd;
        }
        default: {
            if (v77 != 12) {
                goto lab_0x807e0ce;
            } else {
                goto lab_0x807dedd;
            }
        }
    }
  lab_0x807e7d7:
    // 0x807e7d7
    if (g248 != NULL) {
        // 0x807e804
        LYUserSpecifiedURL = 1;
        goto lab_0x807e858;
    } else {
        // 0x807e7e0
        if (lynxjumpfile == 0) {
            goto lab_0x807e80d;
        } else {
            // 0x807e7e9
            v7 = lynxjumpfile;
            if (strcmp((char *)lynxjumpfile, (char *)g245) != 0) {
                goto lab_0x807e80d;
            } else {
                // 0x807e804
                LYUserSpecifiedURL = 1;
                goto lab_0x807e858;
            }
        }
    }
  lab_0x807dedd:
    // 0x807dedd
    if (*(int32_t *)(v76 + 52) != 3) {
        // 0x807defe
        if (HText_getTitle() == NULL) {
            // 0x807df21
            if (curdoc != 0) {
                // 0x807df2e
                v7 = &newdoc;
                HTSACopy((char **)&newdoc, (char *)curdoc);
            }
        } else {
            char * v78 = HText_getTitle(); // 0x807df07
            v7 = &newdoc;
            HTSACopy((char **)&newdoc, v78);
        }
    }
    goto lab_0x807e0ce;
  lab_0x807e858:
    // 0x807e858
    g241 = 0;
    psrc_view = 0;
    if (lynx_edit_mode != 0) {
        // 0x807e87a
        if (LYAutoUncacheDirLists >= 2) {
            // 0x807e884
            HTuncache_current_document();
        }
        // 0x807e889
        v7 = (int32_t)g235;
        HTUnEscapeSome((char *)g235, "/");
        v7 = (int32_t)g235;
        if (strcasecomp((char *)g235, "file://localhost/") != 0) {
            // 0x807e8b7
            v7 = (int32_t)g235;
            strip_trailing_slash((char *)g235);
        }
    }
    // 0x807e8c4
    v7 = (int32_t)g245;
    int32_t result = 0; // 0x807e8e3
    if (strncasecomp((char *)g245, "LYNXCOOKIE:", 11) == 0) {
        // 0x807e8e5
        HTuncache_current_document();
        result = 0;
    }
    // 0x807e8f1
    return result;
  lab_0x807e0ce:;
    uint32_t v79 = *c; // 0x807e0d1
    if (v79 == 2046) {
        // 0x807e0da
        *c = 270;
        // 0x807e8f1
        return 2;
    }
    if (v79 == 23) {
        // 0x807e0f2
        *c = 270;
        // 0x807e8f1
        return 2;
    }
    if ((v79 & 2048) != 0 && (int16_t)v79 > -1) {
        int32_t v80 = v79 % 256; // 0x807e127
        v7 = v80;
        if (LYReverseKeymap(v80) >= 0) {
            int32_t v81 = *c % 256; // 0x807e13d
            v7 = v81;
            LYReverseKeymap(v81);
        }
    }
    if (v2 != 39 == (v2 != 40)) {
        // 0x807e8f1
        return 2;
    }
    int32_t v82 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807e169
    int32_t v83 = *(int32_t *)(v82 + 8); // 0x807e16f
    switch (v83) {
        default: {
            if (v83 != 9) {
                // 0x807e8f1
                return 2;
            }
        }
        case 1: {
        }
        case 12: {
        }
        case 2: {
        }
        case 11: {
            // 0x807e1eb
            if (textinput_activated == 0) {
                // 0x807e8f1
                return 2;
            }
            // 0x807e8f1
            return 3;
        }
    }
  lab_0x807e80d:
    // 0x807e80d
    if (no_filereferer == 1) {
        char v84 = *(char *)g245; // 0x807e81d
        if (v84 != 102 != v84 != 70) {
            // 0x807e830
            v7 = (int32_t)g245;
            if (strncasecomp((char *)g245, "file:", 5) == 0) {
                // 0x807e851
                LYNoRefererForThis = 1;
            }
        }
    }
    goto lab_0x807e858;
  lab_0x807db4b:;
    int32_t v85 = *v61; // 0x807db60
    char * v86 = (char *)v85; // 0x807db63
    char v87 = *v86; // 0x807db63
    if (v87 != 108 == (v87 != 76)) {
        goto lab_0x807dc3e;
    } else {
        // 0x807db8d
        v7 = v85;
        if (strncasecomp(v86, "lynxprog:", 9) != 0) {
            goto lab_0x807dc3e;
        } else {
            goto lab_0x807dbc1;
        }
    }
  lab_0x807dc3e:
    // 0x807dc3e
    if (check_realm != 0) {
        // 0x807dc49
        LYPermitURL = 1;
    }
    // 0x807dc50
    if (no_filereferer == 1) {
        char v88 = *(char *)g245; // 0x807dc60
        if (v88 != 102 != v88 != 70) {
            // 0x807dc73
            v7 = (int32_t)g245;
            if (strncasecomp((char *)g245, "file:", 5) == 0) {
                // 0x807dc94
                LYNoRefererForThis = 1;
            }
        }
    }
    int32_t v89 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x807dcaa
    v14 = v89;
    if (*(int32_t *)(v89 + 52) != 3) {
        // 0x807dcb8
        v7 = g251;
        char * v90 = LYGetHiliteStr(g251, 0); // 0x807dcc8
        v7 = &newdoc;
        HTSACopy((char **)&newdoc, v90);
        v14 = *(int32_t *)(68 * g251 + (int32_t)&g354);
    }
    goto lab_0x807dcdd;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807e8fc - 0x807ef83
// Line range:    1552 - 1696
void handle_LYK_ADD_BOOKMARK(char * refresh_screen, int32_t * old_c, int32_t real_c) {
    // 0x807e8fc
    if (LYValidate != 0) {
        // 0x807e90d
        if (*old_c != real_c) {
            // 0x807e91b
            *old_c = real_c;
            HTUserMsg(gettext("Bookmark features are currently disabled."));
        }
        // 0x807ef81
        return;
    }
    // 0x807e93c
    int32_t v1; // 0x807e8fc
    if (LYIsUIPage3((char *)g245, 0, 1) != 0) {
        goto lab_0x807ef5b;
    } else {
        // 0x807e961
        if (LYIsUIPage3((char *)g245, 3, 1) != 0) {
            goto lab_0x807ef5b;
        } else {
            // 0x807e986
            if (LYIsUIPage3((char *)g245, 2, 1) != 0) {
                goto lab_0x807ef5b;
            } else {
                // 0x807e9ab
                if (LYIsUIPage3((char *)g245, 8, 1) != 0) {
                    goto lab_0x807ef5b;
                } else {
                    // 0x807e9d0
                    if (LYIsUIPage3((char *)g245, 9, 1) != 0) {
                        goto lab_0x807ef5b;
                    } else {
                        // 0x807e9f5
                        if (LYIsUIPage3((char *)g245, 10, 1) != 0) {
                            goto lab_0x807ef5b;
                        } else {
                            // 0x807ea1a
                            if (LYIsUIPage3((char *)g245, 1, 1) != 0) {
                                goto lab_0x807ef5b;
                            } else {
                                // 0x807ea3f
                                if (strncasecomp((char *)g245, "LYNXCOOKIE:", 11) == 0) {
                                    goto lab_0x807ef5b;
                                } else {
                                    // 0x807ea64
                                    if (LYIsUIPage3((char *)g245, 7, 1) != 0) {
                                        goto lab_0x807ef5b;
                                    } else {
                                        // 0x807ea89
                                        char * v2; // 0x807ee61
                                        if (nlinks < 1) {
                                            // 0x807ebf1
                                            if (g246 != 0) {
                                                // 0x807ee5a
                                                v2 = gettext("Documents from forms with POST content cannot be saved as bookmarks.");
                                                HTUserMsg(v2);
                                                // 0x807ef81
                                                return;
                                            }
                                            goto lab_0x807ee73;
                                        } else {
                                            int32_t v3 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807eaa5
                                            if (v3 == 0) {
                                                goto lab_0x807ef5b;
                                            } else {
                                                // 0x807eab3
                                                if (strncasecomp((char *)v3, "LYNXHIST:", 9) == 0) {
                                                    goto lab_0x807ef5b;
                                                } else {
                                                    int32_t v4 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807eaf7
                                                    if (strncasecomp((char *)v4, "LYNXPRINT:", 10) == 0) {
                                                        goto lab_0x807ef5b;
                                                    } else {
                                                        int32_t v5 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807eb2c
                                                        if (strncasecomp((char *)v5, "LYNXDIRED:", 10) == 0) {
                                                            goto lab_0x807ef5b;
                                                        } else {
                                                            int32_t v6 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807eb61
                                                            if (strncasecomp((char *)v6, "LYNXDOWNLOAD:", 13) == 0) {
                                                                goto lab_0x807ef5b;
                                                            } else {
                                                                int32_t v7 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807eb96
                                                                if (strncasecomp((char *)v7, "LYNXCOOKIE:", 11) == 0) {
                                                                    goto lab_0x807ef5b;
                                                                } else {
                                                                    int32_t v8 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807ebcb
                                                                    if (strncasecomp((char *)v8, "LYNXPRINT:", 10) == 0) {
                                                                        goto lab_0x807ef5b;
                                                                    } else {
                                                                        // 0x807ebf1
                                                                        if (nlinks < 1) {
                                                                            if (g246 != 0) {
                                                                                // 0x807ee5a
                                                                                v2 = gettext("Documents from forms with POST content cannot be saved as bookmarks.");
                                                                                HTUserMsg(v2);
                                                                                // 0x807ef81
                                                                                return;
                                                                            }
                                                                            goto lab_0x807ee73;
                                                                        } else {
                                                                            if (g246 != 0) {
                                                                                goto lab_0x807ecce;
                                                                            } else {
                                                                                // 0x807ec0b
                                                                                if (g248 != NULL) {
                                                                                    goto lab_0x807ecce;
                                                                                } else {
                                                                                    // 0x807ec18
                                                                                    if (LYIsUIPage3((char *)g245, 4, 1) != 0) {
                                                                                        goto lab_0x807ecce;
                                                                                    } else {
                                                                                        // 0x807ec3d
                                                                                        if (LYIsUIPage3((char *)g245, 11, 1) != 0) {
                                                                                            goto lab_0x807ecce;
                                                                                        } else {
                                                                                            // 0x807ec5e
                                                                                            if (LYIsUIPage3((char *)g245, 5, 1) != 0) {
                                                                                                goto lab_0x807ecce;
                                                                                            } else {
                                                                                                // 0x807ec7f
                                                                                                mustshow = 1;
                                                                                                statusline(gettext("Save D)ocument or L)ink to bookmark file or C)ancel? (d,l,c): "));
                                                                                                int32_t v9 = LYgetch_single(); // 0x807ec9a
                                                                                                v1 = v9;
                                                                                                if (v9 != 68) {
                                                                                                    goto lab_0x807ed95;
                                                                                                } else {
                                                                                                    // 0x807ecac
                                                                                                    save_bookmark_link((char *)g245, (char *)curdoc);
                                                                                                    *refresh_screen = 1;
                                                                                                    goto lab_0x807eedb;
                                                                                                }
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x807ef5b:
    // 0x807ef5b
    if (*old_c != real_c) {
        // 0x807ef65
        *old_c = real_c;
        HTUserMsg(gettext("History, showinfo, menu and list files cannot be saved as bookmarks."));
    }
  lab_0x807ee73:
    // 0x807ee73
    if (g248 != NULL) {
        // 0x807ee7c
        HTUserMsg(gettext("There are no links in this bookmark file!"));
        // 0x807ef81
        return;
    }
    // 0x807ee95
    mustshow = 1;
    statusline(gettext("Save D)ocument to bookmark file or C)ancel? (d,c): "));
    if (LYgetch_single() != 68) {
        // 0x807ef81
        return;
    }
    // 0x807eebe
    save_bookmark_link((char *)g245, (char *)curdoc);
    *refresh_screen = 1;
    goto lab_0x807eedb;
  lab_0x807eedb:
    // 0x807eedb
    if (g248 == NULL || BookmarkPage == 0) {
        // 0x807ef81
        return;
    }
    // 0x807eef5
    if (strcmp(g248, (char *)BookmarkPage) == 0) {
        // 0x807ef10
        HTuncache_current_document();
        move_address(&newdoc, &curdoc);
        HTSACopy(&g238, g248);
        *(int32_t *)&g242 = (int32_t)g252;
        g241 = g251;
        g243 = 0;
    }
    // 0x807ef81
    return;
  lab_0x807ecce:
    // 0x807ecce
    if (LYMultiBookmarks != 0 || g248 == NULL) {
        goto lab_0x807ed36;
    } else {
        char v10 = *(char *)bookmark_page; // 0x807ece5
        if (strstr((char *)g245, (char *)(bookmark_page + (int32_t)(v10 == 46))) == NULL) {
            goto lab_0x807ed36;
        } else {
            // 0x807ed19
            mustshow = 1;
            statusline(gettext("Reproduce L)ink in this bookmark file or C)ancel? (l,c): "));
            // 0x807ed8d
            v1 = LYgetch_single();
            goto lab_0x807ed95;
        }
    }
  lab_0x807ed36:
    // 0x807ed36
    if (g246 != 0) {
        // 0x807ed3f
        if (*(int32_t *)(68 * g251 + (int32_t)&g347) == 6) {
            // 0x807ed59
            HTUserMsg(gettext("Documents from forms with POST content cannot be saved as bookmarks."));
            // 0x807ef81
            return;
        }
    }
    // 0x807ed72
    mustshow = 1;
    statusline(gettext("Save L)ink to bookmark file or C)ancel? (l,c): "));
    // 0x807ed8d
    v1 = LYgetch_single();
    goto lab_0x807ed95;
  lab_0x807ed95:
    // 0x807ed95
    if (v1 != 76) {
        // 0x807ef81
        return;
    }
    int32_t v11 = *(int32_t *)(68 * g251 + (int32_t)&g347);
    if (g246 != 0 && v11 == 6) {
        // 0x807edc2
        HTUserMsg(gettext("Documents from forms with POST content cannot be saved as bookmarks."));
        // 0x807ef81
        return;
    }
    if (v11 == 1) {
        // 0x807ee38
        HTUserMsg(gettext("Cannot save form fields/links"));
        // 0x807ef81
        return;
    }
    char * v12 = LYGetHiliteStr(g251, 0); // 0x807ee05
    int32_t v13 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807ee1b
    save_bookmark_link((char *)v13, v12);
    *refresh_screen = 1;
    goto lab_0x807eedb;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807ef83 - 0x807f076
// Line range:    1700 - 1720
void handle_LYK_CLEAR_AUTH(int32_t * old_c, int32_t real_c) {
    // 0x807ef83
    if (*old_c == real_c) {
        // 0x807f074
        return;
    }
    // 0x807ef97
    *old_c = real_c;
    char * v1 = gettext("Clear all authorization info for this session?"); // 0x807efa6
    if (HTConfirm(v1) == 0) {
        // 0x807f060
        HTUserMsg(gettext("Cancelled!!!"));
        // 0x807f074
        return;
    }
    // 0x807efbb
    if (authentication_info != 0) {
        // 0x807efc4
        free((int32_t *)authentication_info);
        authentication_info = 0;
    }
    // 0x807efdb
    if (g228 != NULL) {
        // 0x807efe4
        free((int32_t *)g228);
        g228 = NULL;
    }
    // 0x807effb
    if (proxyauth_info != 0) {
        // 0x807f004
        free((int32_t *)proxyauth_info);
        proxyauth_info = 0;
    }
    // 0x807f01b
    if (g229 != 0) {
        // 0x807f024
        free((int32_t *)g229);
        g229 = 0;
    }
    // 0x807f03b
    HTClearHTTPAuthInfo();
    HTClearNNTPAuthInfo();
    HTClearFTPPassword();
    HTUserMsg(gettext("Authorization info cleared."));
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807f076 - 0x807f182
// Line range:    1723 - 1743
int32_t handle_LYK_COMMAND(char * user_input_buffer) {
    // 0x807f076
    *user_input_buffer = 0;
    mustshow = 1;
    statusline(": ");
    if (LYgetstr(user_input_buffer, 0, 1024, 2) < 0) {
        // 0x807f17d
        return (int32_t)NULL;
    }
    char * v1 = LYSkipBlanks(user_input_buffer); // 0x807f0c6
    char * v2 = LYSkipNonBlanks(v1); // 0x807f0d4
    *v2 = 0;
    int32_t * v3 = LYStringToKcmd(v1); // 0x807f0e8
    char * v4 = NULL; // 0x807f0f4
    if (v3 != NULL) {
        // 0x807f0f6
        v4 = (char *)*v3;
    }
    // 0x807f107
    if (WWW_TraceFlag != 0) {
        // 0x807f118
        fprintf(TraceFP(), "LYK_COMMAND(%s.%s) = %d\n", v1, v2, (int32_t)v4);
    }
    char * v5 = v4; // 0x807f14a
    if (v4 == NULL) {
        // 0x807f14c
        v5 = (char *)(int32_t)(*v1 != 0);
    }
    // 0x807f17d
    return (int32_t)v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807f182 - 0x807f599
// Line range:    1749 - 1847
void handle_LYK_COMMENT(char * refresh_screen, char ** owner_address_p, int32_t * old_c, int32_t real_c) {
    // 0x807f182
    if (*owner_address_p == NULL) {
        // 0x807f192
        if (strncasecomp((char *)g245, "http", 4) != 0) {
            // 0x807f1b3
            if (*old_c != real_c) {
                // 0x807f1c1
                *old_c = real_c;
                HTUserMsg(gettext("No owner is defined for this file so you cannot send a comment"));
            }
            // 0x807f593
            return;
        }
    }
    // 0x807f1e2
    if (no_mail != 0) {
        // 0x807f1ed
        if (*old_c != real_c) {
            // 0x807f1fb
            *old_c = real_c;
            HTUserMsg(gettext("Mail is disallowed so you cannot send a comment"));
        }
        // 0x807f593
        return;
    }
    char * v1 = gettext("Do you wish to send a comment?"); // 0x807f223
    if (HTConfirmDefault(v1, 0) == 0) {
        // 0x807f593
        return;
    }
    // 0x807f240
    char * v2; // bp-32, 0x807f182
    if (*owner_address_p == NULL) {
        int32_t c = 0; // bp-16, 0x807f24d
        char * v3 = HTParse((char *)g245, (char *)&g20, 4); // 0x807f26c
        v2 = v3;
        if (v3 != NULL) {
            // 0x807f27f
            HTUnEscape(v3);
            char * str = v2;
            char * v4 = str; // 0x807f292
            if (*str == 126) {
                // 0x807f294
                if (strlen(str) >= 2) {
                    char * found_char_pos = strchr((char *)((int32_t)v2 + 1), 47); // 0x807f2b5
                    if (found_char_pos != NULL) {
                        // 0x807f2c3
                        *found_char_pos = 0;
                    }
                    // 0x807f2c9
                    HTSACopy((char **)&c, "mailto:");
                    HTSACat((char **)&c, (char *)((int32_t)v2 + 1));
                    HTSACat((char **)&c, "@");
                }
                // 0x807f304
                v4 = v2;
            }
            // 0x807f304
            if (v4 != NULL) {
                // 0x807f30b
                free((int32_t *)v4);
                v2 = NULL;
            }
        }
        // 0x807f31d
        if (c == 0) {
            // 0x807f324
            HTSACopy((char **)&c, "mailto:WebMaster@");
        }
        char * v5 = HTParse((char *)g245, (char *)&g20, 8); // 0x807f34f
        v2 = v5;
        HTSACat((char **)&c, v5);
        char * v6 = gettext("No owner is defined. Use %s?"); // 0x807f373
        HTSprintf0(&v2, v6);
        int32_t v7 = HTConfirmDefault(v2, 0); // 0x807f399
        char * v8 = v2; // 0x807f3a1
        if (v8 != NULL) {
            // 0x807f3a8
            free((int32_t *)v8);
            v2 = NULL;
        }
        int32_t v9 = c;
        if (v7 != 1) {
            if (v9 != 0) {
                // 0x807f3f8
                free((int32_t *)v9);
                c = 0;
            }
            // 0x807f593
            return;
        }
        // 0x807f3c0
        HTSACopy(owner_address_p, (char *)v9);
        if (c != 0) {
            // 0x807f3d9
            free((int32_t *)c);
            c = 0;
        }
    }
    // 0x807f40f
    if (is_url(*owner_address_p) != 16) {
        // 0x807f421
        set_address(&newdoc, *owner_address_p);
        g243 = 0;
        // 0x807f593
        return;
    }
    char * v10 = HText_getRevTitle(); // 0x807f442
    char * v11 = HText_getMessageID(); // 0x807f44a
    v2 = NULL;
    int32_t v12 = (int32_t)v10; // 0x807f45d
    char * v13 = v10; // 0x807f45d
    if (v10 == NULL && HTMainAnchor != NULL) {
        char * v14 = HTAnchor_subject(HTMainAnchor); // 0x807f470
        int32_t v15 = (int32_t)v14;
        v12 = v15;
        v13 = NULL;
        if (v14 != NULL) {
            // 0x807f47e
            v12 = v15;
            v13 = v14;
            if (*v14 != 0) {
                int32_t v16 = strncasecomp(v14, "Re: ", 4); // 0x807f49e
                v12 = v15;
                v13 = v14;
                if (v16 != 0) {
                    // 0x807f4a7
                    HTSACopy(&v2, "Re: ");
                    HTSACat(&v2, v14);
                    v12 = (int32_t)v2;
                    v13 = v2;
                }
            }
        }
    }
    char * found_char_pos2 = strchr(*owner_address_p, 58); // 0x807f4e2
    char * v17 = v13 == NULL ? (char *)&g20 : (char *)v12;
    char * str2 = *owner_address_p;
    if (found_char_pos2 == NULL) {
        // 0x807f54f
        reply_by_mail(str2, (char *)g245, v17, v11);
    } else {
        // 0x807f500
        reply_by_mail((char *)((int32_t)strchr(str2, 58) + 1), (char *)g245, v17, v11);
    }
    // 0x807f574
    if (v2 != NULL) {
        // 0x807f57b
        free((int32_t *)v2);
        v2 = NULL;
    }
    // 0x807f58d
    *refresh_screen = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807f599 - 0x807f652
// Line range:    1878 - 1901
char handle_LYK_COOKIE_JAR(int32_t * cmd) {
    // 0x807f599
    if (strncasecomp((char *)g245, "LYNXCOOKIE:", 11) == 0) {
        // 0x807f63f
        *cmd = 37;
        // 0x807f64c
        return 1;
    }
    // 0x807f5c0
    set_address(&newdoc, "LYNXCOOKIE:/");
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x807f5e9
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x807f600
    g239 = 0;
    g240 = 0;
    g243 = 0;
    LYforce_no_cache = 1;
    if ((check_realm || LYValidate) != 0) {
        // 0x807f632
        LYPermitURL = 1;
    }
    // 0x807f64c
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807f652 - 0x807f707
// Line range:    1905 - 1919
void handle_LYK_CREATE(void) {
    // 0x807f652
    if (lynx_edit_mode == 0 || no_dired_support != 0 || local_create(&curdoc) < 1) {
        // 0x807f705
        return;
    }
    // 0x807f686
    if (LYAutoUncacheDirLists >= 1) {
        // 0x807f68f
        HTuncache_current_document();
    }
    // 0x807f694
    move_address(&newdoc, &curdoc);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x807f6bd
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x807f6d4
    g239 = 0;
    g240 = 0;
    *(int32_t *)&g242 = (int32_t)g252;
    int32_t v1 = g251; // 0x807f6ec
    g241 = v1 & (int32_t)(v1 < 0) - 1;
    LYclear();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807f707 - 0x807f787
// Line range:    1925 - 1940
void handle_LYK_DEL_BOOKMARK(char * refresh_screen, int32_t * old_c, int32_t real_c) {
    // 0x807f707
    if (g248 == NULL) {
        // 0x807f768
        *refresh_screen = 1;
        if (*old_c != real_c) {
            // 0x807f778
            *old_c = real_c;
            lynx_force_repaint();
        }
    } else {
        char * v1 = gettext("Do you really want to delete this link from your bookmark file?"); // 0x807f71d
        if (HTConfirmDefault(v1, 0) == 1) {
            int32_t v2 = *(int32_t *)(68 * g251 + (int32_t)&g349); // 0x807f74c
            remove_bookmark_link(v2 - 1, g248);
            do_cleanup_after_delete();
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807f787 - 0x807f823
// Line range:    1946 - 2059
void handle_LYK_DIRED_MENU(char * refresh_screen, int32_t * old_c, int32_t real_c) {
    // 0x807f787
    if (lynx_edit_mode == 0 || no_dired_support != 0 || LYIsUIPage3((char *)g245, 8, 1) != 0) {
        // 0x807f821
        return;
    }
    char * str = gettext("File Management Options"); // 0x807f7cf
    int32_t v1 = curdoc; // 0x807f7d7
    if (strcmp(v1 == 0 ? (char *)&g20 : (char *)v1, str) != 0) {
        // 0x807f807
        dired_options(&curdoc, (char **)&g235);
        *refresh_screen = 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x807f823 - 0x80803ea
// Line range:    2065 - 2273
int32_t handle_LYK_DOWNLOAD(int32_t * cmd, int32_t * old_c, int32_t real_c) {
    // 0x807f823
    if (LYValidate != 0) {
        goto lab_0x807f855;
    } else {
        // 0x807f834
        if (no_download == 0) {
            goto lab_0x807f887;
        } else {
            // 0x807f83f
            if (override_no_download != 0 || no_disk_save == 0) {
                goto lab_0x807f887;
            } else {
                goto lab_0x807f855;
            }
        }
    }
  lab_0x807f855:
    // 0x807f855
    if (*old_c != real_c) {
        // 0x807f85f
        *old_c = real_c;
        HTUserMsg(gettext("The 'd'ownload command is currently disabled."));
    }
    // 0x80803e5
    return 0;
  lab_0x807f887:
    // 0x807f887
    if (LYIsUIPage3((char *)g245, 1, 1) != 0) {
        // 0x80803e5
        return 0;
    }
    // 0x807f8b4
    if (do_change_link() == -1) {
        // 0x80803e5
        return 1;
    }
    // 0x807f8ca
    if (nlinks < 1) {
        // 0x80803b8
        if (*old_c != real_c) {
            // 0x80803c2
            *old_c = real_c;
            HTUserMsg(gettext("Nothing to download."));
        }
        // 0x80803e5
        return 0;
    }
    int32_t v1 = 68 * g251;
    if (*(int32_t *)(v1 + (int32_t)&g347) == 1) {
        int32_t v2 = *(int32_t *)(v1 + (int32_t)&g354); // 0x807f904
        int32_t v3 = *(int32_t *)(v2 + 8); // 0x807f90a
        switch (v3) {
            default: {
                if (v3 != 12) {
                    // 0x807fa32
                    if (*old_c != real_c) {
                        // 0x807fa40
                        *old_c = real_c;
                        HTUserMsg(gettext("You cannot download an input field."));
                    }
                    // 0x80803e5
                    return 0;
                }
            }
            case 5: {
            }
            case 13: {
                // 0x807f950
                if (*(int32_t *)(v2 + 52) == 3) {
                    // 0x807f96d
                    if (*old_c != real_c) {
                        // 0x807f977
                        *old_c = real_c;
                        HTUserMsg(gettext("Form has a mailto action!  Cannot download."));
                    }
                    // 0x80803e5
                    return 0;
                }
                // break -> 0x807f99f
                break;
            }
        }
        // 0x807f99f
        if (strncasecomp((char *)*(int32_t *)(v2 + 48), "LYNXOPTIONS:", 12) == 0) {
            // 0x807f9d3
            if (*old_c != real_c) {
                // 0x807f9dd
                *old_c = real_c;
                HTUserMsg(gettext("This special URL cannot be downloaded!"));
            }
            // 0x80803e5
            return 0;
        }
        int32_t * v4 = HTAtom_for("www/download"); // 0x807fa0c
        *(int32_t *)&HTOutputFormat = (int32_t)v4;
        LYforce_no_cache = 1;
        *cmd = 39;
        // 0x80803e5
        return 2;
    }
    // 0x807fa61
    if (strncasecomp((char *)g245, "LYNXCOOKIE:", 11) == 0 || LYIsUIPage3((char *)g245, 2, 1) != 0 || LYIsUIPage3((char *)g245, 10, 1) != 0 || LYIsUIPage3((char *)g245, 9, 1) != 0) {
        // 0x807fa82
        if (*old_c != real_c) {
            // 0x807fa90
            *old_c = real_c;
            HTUserMsg(gettext("You cannot download cookies."));
        }
        // 0x80803e5
        return 0;
    }
    // 0x807fba1
    if (lynx_edit_mode != 0) {
        // 0x807fbb0
        if (no_dired_support == 0) {
            int32_t str = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807fbce
            if (strstr((char *)str, "/SugFile=") == NULL) {
                // 0x807fbec
                copy_address(&g231, &newdoc);
                int32_t v5 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807fc0f
                set_address(&newdoc, (char *)v5);
                int32_t v6 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807fc34
                if (LYdownload_options((char **)&g235, (char *)v6) >= 0) {
                    // 0x807fc64
                    g243 = 0;
                } else {
                    // 0x807fc4e
                    copy_address(&newdoc, &g231);
                }
                // 0x807fc6b
                LYFreeDocInfo(&g231);
                // 0x80803e5
                return 0;
            }
        }
    }
    // 0x807fc7c
    if (LYIsUIPage3((char *)g245, 0, 1) != 0) {
        int32_t v7 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807fcb0
        if (strncasecomp((char *)v7, "LYNXHIST:", 9) == 0) {
            int32_t v8 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807fce5
            int32_t str_as_i = atoi((char *)(v8 + 9)); // 0x807fcf1
            if (str_as_i < nhist != str_as_i >= 0) {
                // 0x807fd09
                HTUserMsg(gettext("This special URL cannot be downloaded!"));
                // 0x80803e5
                return 0;
            }
            int32_t v9 = 44 * str_as_i; // 0x807fd32
            int32_t v10 = v9 + (int32_t)history;
            int32_t v11 = v10; // 0x807fd3d
            if (*(int32_t *)(v10 + 8) != 0) {
                // 0x807fd3f
                v11 = v10;
                if (*(char *)(v10 + 21) != 1) {
                    char * v12 = gettext("Document from Form with POST content.  Resubmit?"); // 0x807fd5d
                    if (HTConfirm(v12) == 0) {
                        // 0x807fd6e
                        HTInfoMsg(gettext("Cancelled!!!"));
                        // 0x80803e5
                        return 0;
                    }
                    // 0x807fd56
                    v11 = v9 + (int32_t)history;
                }
            }
            // 0x807fd8e
            copy_address(&newdoc, (int32_t *)v11);
            char * v13 = LYGetHiliteStr(g251, 0); // 0x807fdbd
            HTSACopy((char **)&newdoc, v13);
            int32_t v14 = *(int32_t *)(v9 + 16 + (int32_t)history); // 0x807fde1
            HTSACopy(&g238, (char *)v14);
            LYFreePostData(&newdoc);
            int32_t v15 = (int32_t)history;
            int32_t v16 = *(int32_t *)(v9 + 8 + v15); // 0x807fe0f
            int32_t v17 = v15; // 0x807fe14
            if (v16 != 0) {
                int32_t v18 = *(int32_t *)v16; // 0x807fe79
                HTSABCopy((int32_t **)&g236, (char *)v18, *(int32_t *)(v16 + 4));
                v17 = (int32_t)history;
            }
            int32_t v19 = *(int32_t *)(v9 + 12 + v17); // 0x807feb0
            int32_t v20 = v17; // 0x807feb5
            if (v19 != 0) {
                // 0x807feb7
                HTSACopy(&g237, (char *)v19);
                v20 = (int32_t)history;
            }
            int32_t v21 = v20 + v9;
            g239 = *(char *)(v21 + 20);
            g240 = *(char *)(v21 + 21);
            g243 = 0;
            g241 = user_mode == 0;
            int32_t * v22 = HTAtom_for("www/download"); // 0x807ff29
            *(int32_t *)&HTOutputFormat = (int32_t)v22;
            LYUserSpecifiedURL = 1;
            LYforce_no_cache = 1;
            // 0x80803e5
            return 0;
        }
    }
    int32_t str2 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807ff55
    if (strncmp((char *)str2, "data:", 5) == 0) {
        // 0x807ff77
        if (*old_c != real_c) {
            // 0x807ff85
            *old_c = real_c;
            HTAlert(gettext("Unsupported data: URL!  Use SHOWINFO, for now."));
        }
        // 0x80803e5
        return 0;
    }
    int32_t v23 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807ffb5
    char * v24; // 0x8080227
    if (strncasecomp((char *)v23, "LYNXCOOKIE:", 11) == 0) {
        // 0x8080220
        v24 = gettext("This special URL cannot be downloaded!");
        HTUserMsg(v24);
        // 0x80803e5
        return 0;
    }
    int32_t v25 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x807ffea
    if (strncasecomp((char *)v25, "LYNXDIRED:", 10) == 0) {
        // 0x8080220
        v24 = gettext("This special URL cannot be downloaded!");
        HTUserMsg(v24);
        // 0x80803e5
        return 0;
    }
    int32_t v26 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x808001f
    if (strncasecomp((char *)v26, "LYNXDOWNLOAD:", 13) == 0) {
        // 0x8080220
        v24 = gettext("This special URL cannot be downloaded!");
        HTUserMsg(v24);
        // 0x80803e5
        return 0;
    }
    int32_t v27 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x8080054
    if (strncasecomp((char *)v27, "LYNXPRINT:", 10) == 0) {
        // 0x8080220
        v24 = gettext("This special URL cannot be downloaded!");
        HTUserMsg(v24);
        // 0x80803e5
        return 0;
    }
    int32_t v28 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x8080089
    if (strncasecomp((char *)v28, "LYNXOPTIONS:", 12) == 0) {
        // 0x8080220
        v24 = gettext("This special URL cannot be downloaded!");
        HTUserMsg(v24);
        // 0x80803e5
        return 0;
    }
    int32_t v29 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x80800be
    if (strncasecomp((char *)v29, "LYNXHIST:", 9) == 0) {
        // 0x8080220
        v24 = gettext("This special URL cannot be downloaded!");
        HTUserMsg(v24);
        // 0x80803e5
        return 0;
    }
    int32_t v30 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x80800f3
    if (strncasecomp((char *)v30, "LYNXHIST:", 9) == 0) {
        // 0x8080220
        v24 = gettext("This special URL cannot be downloaded!");
        HTUserMsg(v24);
        // 0x80803e5
        return 0;
    }
    int32_t v31 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x8080128
    if (strncasecomp((char *)v31, "LYNXCOMPILEOPTS:", 16) == 0) {
        // 0x8080220
        v24 = gettext("This special URL cannot be downloaded!");
        HTUserMsg(v24);
        // 0x80803e5
        return 0;
    }
    int32_t v32 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x808015d
    char * v33 = (char *)v32;
    char v34 = *v33; // 0x8080163
    char * v35 = v33; // 0x8080168
    char v36 = v34; // 0x8080168
    if (v34 != 108 != v34 != 76) {
        // 0x8080186
        if (strncasecomp(v33, "lynxexec:", 9) == 0) {
            // 0x8080220
            v24 = gettext("This special URL cannot be downloaded!");
            HTUserMsg(v24);
            // 0x80803e5
            return 0;
        }
        int32_t v37 = *(int32_t *)(68 * g251 + (int32_t)&links);
        char * v38 = (char *)v37;
        v35 = v38;
        v36 = *v38;
    }
    char v39 = v36; // 0x80801cc
    char * v40 = v35; // 0x80801d1
    if (v39 != 108 != v39 != 76) {
        // 0x80801ef
        if (strncasecomp(v35, "lynxprog:", 9) == 0) {
            // 0x8080220
            v24 = gettext("This special URL cannot be downloaded!");
            HTUserMsg(v24);
            // 0x80803e5
            return 0;
        }
        int32_t v41 = *(int32_t *)(68 * g251 + (int32_t)&links);
        v40 = (char *)v41;
    }
    // 0x8080239
    if (strncasecomp(v40, "mailto:", 7) == 0) {
        // 0x808026a
        HTUserMsg(gettext("You cannot download a mailto: link."));
        // 0x80803e5
        return 0;
    }
    // 0x8080283
    if (local_host_only != 0) {
        int32_t v42 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x808029d
        if (LYisLocalHost((char *)v42) == 0) {
            int32_t v43 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x80802be
            if (LYisLocalAlias((char *)v43) == 0) {
                // 0x80802d0
                HTUserMsg(gettext("Only files and servers on the local host can be accessed."));
                // 0x80803e5
                return 0;
            }
        }
    }
    int32_t v44 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x80802f8
    set_address(&newdoc, (char *)v44);
    char * v45 = LYGetHiliteStr(g251, 0); // 0x808031e
    HTSACopy((char **)&newdoc, v45);
    if (are_different(&curdoc, &newdoc) != 0) {
        // 0x808034b
        LYFreePostData(&newdoc);
        if (g238 != NULL) {
            // 0x8080360
            free((int32_t *)g238);
            g238 = NULL;
        }
        // 0x8080377
        g239 = 0;
        g240 = 0;
    }
    // 0x8080385
    g243 = 0;
    g241 = user_mode == 0;
    int32_t * v46 = HTAtom_for("www/download"); // 0x80803a5
    *(int32_t *)&HTOutputFormat = (int32_t)v46;
    LYforce_no_cache = 1;
    // 0x80803e5
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80803ea - 0x808049e
// Line range:    2278 - 2293
void handle_LYK_DOWN_xxx(int32_t * old_c, int32_t real_c, int32_t scroll_by) {
    // 0x80803ea
    if (more_text == 0) {
        // 0x8080476
        if (*old_c != real_c) {
            // 0x8080480
            *old_c = real_c;
            HTInfoMsg(gettext("You are already at the end of this document."));
        }
        // 0x808049c
        return;
    }
    // 0x80803fb
    Newline += scroll_by;
    if (nlinks < 1 || g251 < 0 || *(int32_t *)(68 * g251 + (int32_t)&g346) <= scroll_by) {
        // 0x808049c
        return;
    }
    // 0x8080438
    g241 = g251;
    int32_t v1 = g251; // 0x8080472
    if (g346 > scroll_by) {
        // 0x808049c
        return;
    }
    int32_t v2 = 0; // 0x8080472
    v1--;
    g241 = v1;
    while (*(int32_t *)(68 * (v2 + 1) + (int32_t)&g346) <= scroll_by) {
        // 0x808044b
        v2++;
        v1--;
        g241 = v1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808049e - 0x80804cb
// Line range:    2297 - 2299
void handle_LYK_DOWN_HALF(int32_t * old_c, int32_t real_c) {
    int32_t v1 = display_lines; // 0x80804a4
    handle_LYK_DOWN_xxx(old_c, real_c, v1 + (int32_t)(v1 < 0) >> 1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80804cb - 0x8080608
// Line range:    2304 - 2333
void handle_LYK_DOWN_LINK(int32_t * follow_col, int32_t * old_c, int32_t real_c) {
    uint32_t v1 = g251; // 0x80804d2
    if (v1 >= nlinks - 1) {
        // 0x80805bd
        if (more_text != 0) {
            // 0x80805c8
            Newline += display_lines;
            // 0x8080602
            return;
        }
        // 0x80805dc
        if (*old_c != real_c) {
            // 0x80805e6
            *old_c = real_c;
            HTInfoMsg(gettext("You are already at the end of this document."));
        }
        // 0x8080602
        return;
    }
    int32_t v2 = *follow_col; // 0x80804eb
    int32_t v3 = v2; // 0x80804f0
    if (v2 == -1) {
        char * str = LYGetHiliteStr(v1, 0); // 0x8080502
        int32_t v4 = *(int32_t *)(68 * g251 + (int32_t)&g345); // 0x8080519
        *follow_col = v4;
        v3 = v4;
        if (str != NULL) {
            int32_t v5 = strlen(str) / 2 + v4; // 0x808053e
            *follow_col = v5;
            v3 = v5;
        }
    }
    uint32_t v6 = find_link_near_col(v3, 1); // 0x8080558
    if (v6 >= 0) {
        // 0x8080566
        set_curdoc_link(v6);
        // 0x8080602
        return;
    }
    // 0x8080576
    if (more_text != 0) {
        // 0x8080581
        Newline += display_lines;
        // 0x8080602
        return;
    }
    // 0x8080595
    if (*old_c != real_c) {
        // 0x808059f
        *old_c = real_c;
        HTUserMsg(gettext("There are no links below this line of the document."));
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8080608 - 0x808062a
// Line range:    2337 - 2339
void handle_LYK_DOWN_TWO(int32_t * old_c, int32_t real_c) {
    // 0x8080608
    handle_LYK_DOWN_xxx(old_c, real_c, 2);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808062a - 0x8080728
// Line range:    2344 - 2381
int32_t handle_LYK_DWIMEDIT(int32_t * cmd, int32_t * old_c, int32_t real_c) {
    // 0x808062a
    if ((uint32_t)nlinks >= 1) {
        int32_t v1 = 68 * g251;
        if (*(int32_t *)(v1 + (int32_t)&g347) == 1) {
            int32_t v2 = *(int32_t *)(*(int32_t *)(v1 + (int32_t)&g354) + 8); // 0x8080668
            if (v2 == 9) {
                // 0x8080670
                *cmd = 86;
                // 0x8080723
                return 2;
            }
            if (v2 == 1) {
                // 0x80806c5
                HTUserMsg(gettext("This field cannot be (e)dited with an external editor."));
                // 0x8080723
                return 1;
            }
        }
    }
    // 0x80806e2
    if (no_editor == 0) {
        // 0x8080723
        return 0;
    }
    // 0x80806ed
    if (*old_c != real_c) {
        // 0x80806f7
        *old_c = real_c;
        HTUserMsg(gettext("External editing is currently disabled."));
    }
    // 0x8080723
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8080728 - 0x808093f
// Line range:    2388 - 2450
int32_t handle_LYK_ECGOTO(int32_t * ch, char * user_input_buffer, char ** old_user_input, int32_t * old_c, int32_t real_c) {
    // 0x8080728
    if (no_goto != 0) {
        // 0x8080739
        if (LYValidate == 0) {
            // 0x8080744
            if (*old_c != real_c) {
                // 0x808074e
                *old_c = real_c;
                HTUserMsg(gettext("Goto a random URL is disallowed!"));
            }
            // 0x808093a
            return 0;
        }
    }
    // 0x8080776
    if (LYIsUIPage3((char *)g245, 8, 1) == 0) {
        // 0x8080797
        if (LYIsUIPage3((char *)g245, 9, 1) == 0) {
            // 0x80807b8
            if (LYIsUIPage3((char *)g245, 10, 1) == 0) {
                // 0x808080b
                HTSACopy(old_user_input, user_input_buffer);
                LYstrncpy(user_input_buffer, (char *)g245, 1023);
                if (g246 != 0) {
                    // 0x8080842
                    HTAlert(gettext("Current document has POST data."));
                }
                // 0x8080856
                mustshow = 1;
                statusline(gettext("Edit this document's URL: "));
                uint32_t v1 = LYgetstr(user_input_buffer, 0, 1024, 1); // 0x808088f
                *ch = v1;
                if (v1 >= 0) {
                    // 0x80808a4
                    if (*user_input_buffer != 0) {
                        // 0x80808ae
                        if (strcmp(user_input_buffer, (char *)g245) != 0) {
                            // 0x80808c6
                            LYTrimAllStartfile(user_input_buffer);
                            if (*user_input_buffer != 0) {
                                // 0x808093a
                                return 2;
                            }
                        }
                    }
                }
                // 0x80808e4
                HTInfoMsg(gettext("Cancelled!!!"));
                LYstrncpy(user_input_buffer, *old_user_input, 1023);
                char * v2 = *old_user_input;
                if (v2 != NULL) {
                    // 0x808091d
                    free((int32_t *)v2);
                    *(int32_t *)old_user_input = 0;
                }
                // 0x808093a
                return 0;
            }
        }
    }
    // 0x80807d9
    if (*old_c != real_c) {
        // 0x80807e3
        *old_c = real_c;
        HTUserMsg(gettext("You cannot edit File Management URLs"));
    }
    // 0x808093a
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808093f - 0x8080bd3
// Line range:    2454 - 2538
void handle_LYK_EDIT(int32_t * old_c, int32_t real_c) {
    char * cp = NULL; // bp-12, 0x8080948
    if (no_editor != 0) {
        // 0x808095a
        if (*old_c != real_c) {
            // 0x8080968
            *old_c = real_c;
            HTUserMsg(gettext("The 'e'dit command is currently disabled."));
        }
        // 0x8080bd1
        return;
    }
    // 0x8080989
    if (lynx_edit_mode != 0 && editor != 0) {
        // 0x80809a5
        if (*(char *)editor != 0) {
            // 0x80809b5
            if (no_dired_support == 0) {
                // 0x80809c4
                if (nlinks < 1) {
                    // 0x8080bd1
                    return;
                }
                char * v1 = (char *)*(int32_t *)(68 * g251 + (int32_t)&links);
                if (is_url(v1) != 3) {
                    // 0x8080bd1
                    return;
                }
                char * v2 = HTnameOfFile_WWW(v1, 0, 1); // 0x8080a13
                HTSACopy(&cp, v2);
                if (v2 != NULL) {
                    // 0x8080a33
                    free((int32_t *)v2);
                }
                // 0x8080a45
                int32_t v3; // bp-108, 0x808093f
                if (stat64((int32_t)cp, &v3) != -1) {
                    int32_t v4; // 0x808093f
                    if ((v4 & 0xf000) == 0x8000) {
                        int32_t v5 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x8080a97
                        HTSACopy(&cp, (char *)v5);
                        HTUnEscapeSome(cp, "/");
                        if (edit_current_file(cp, g251, Newline) != 0) {
                            // 0x8080ae1
                            if (LYAutoUncacheDirLists >= 1) {
                                // 0x8080aea
                                HTuncache_current_document();
                            }
                            // 0x8080aef
                            move_address(&newdoc, &curdoc);
                            *(int32_t *)&g242 = (int32_t)g252;
                            g241 = g251;
                            LYclear();
                        }
                    }
                } else {
                    // 0x8080a5c
                    HTAlert(gettext("System error - failure to get status."));
                }
                // 0x8080b1c
                if (cp != NULL) {
                    // 0x8080b27
                    free((int32_t *)cp);
                    cp = NULL;
                }
                // 0x8080bd1
                return;
            }
        }
    }
    if (editor != 0) {
        // 0x8080b47
        if (*(char *)editor != 0) {
            // 0x8080b53
            if (edit_current_file((char *)g235, g251, Newline) != 0) {
                // 0x8080b78
                HTuncache_current_document();
                LYforce_no_cache = 1;
                free_address(&curdoc);
                *(int32_t *)&g242 = (int32_t)g252;
                g241 = g251;
                LYclear();
            }
            // 0x8080bd1
            return;
        }
    }
    // 0x8080bab
    if (*old_c != real_c) {
        // 0x8080bb5
        *old_c = real_c;
        HTUserMsg(gettext("No editor is defined!"));
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8080bd3 - 0x8080cd6
// Line range:    2541 - 2552
void handle_LYK_DWIMHELP(char ** cshelpfile) {
    int32_t v1 = g251; // 0x8080bd9
    if (v1 > -1 != v1 < nlinks) {
        // 0x8080cd4
        return;
    }
    int32_t v2 = 68 * v1; // 0x8080c06
    if (*(int32_t *)(v2 + (int32_t)&g347) != 1) {
        // 0x8080cd4
        return;
    }
    int32_t v3 = *(int32_t *)(v2 + (int32_t)&g354); // 0x8080c26
    if (*(int32_t *)(v3 + 80) != 0) {
        // 0x8080cd4
        return;
    }
    int32_t v4 = *(int32_t *)(v3 + 8); // 0x8080c4c
    switch (v4) {
        case 1: {
        }
        case 12: {
        }
        case 2: {
        }
        case 11: {
            // 0x8080cc8
            *(int32_t *)cshelpfile = (int32_t)LYLineeditHelpURL();
            // 0x8080cd4
            return;
        }
    }
    if (v4 != 9) {
        // 0x8080cd4
        return;
    }
    // 0x8080cc8
    *(int32_t *)cshelpfile = (int32_t)LYLineeditHelpURL();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8080cd6 - 0x8080ddd
// Line range:    2557 - 2601
void handle_LYK_EDIT_TEXTAREA(char * refresh_screen, int32_t * old_c, int32_t real_c) {
    // 0x8080cd6
    if (no_editor != 0) {
        // 0x8080ce7
        if (*old_c != real_c) {
            // 0x8080cf5
            *old_c = real_c;
            HTUserMsg(gettext("External editing is currently disabled."));
        }
        // 0x8080ddb
        return;
    }
    // 0x8080d16
    if (editor != 0) {
        // 0x8080d1f
        if (*(char *)editor != 0) {
            int32_t v1 = 68 * g251; // 0x8080d67
            char * v2; // 0x8080dce
            if (*(int32_t *)(v1 + (int32_t)&g347) != 1) {
                // 0x8080dc7
                v2 = gettext("Not in a TEXTAREA; cannot use external editor.");
                HTInfoMsg(v2);
                // 0x8080ddb
                return;
            }
            int32_t v3 = *(int32_t *)(v1 + (int32_t)&g354); // 0x8080d83
            if (*(int32_t *)(v3 + 8) != 9) {
                // 0x8080dc7
                v2 = gettext("Not in a TEXTAREA; cannot use external editor.");
                HTInfoMsg(v2);
                // 0x8080ddb
                return;
            }
            // 0x8080d91
            stop_curses();
            HText_ExtEditForm((int32_t *)(68 * g251 + (int32_t)&links));
            start_curses();
            *refresh_screen = 1;
            // 0x8080ddb
            return;
        }
    }
    // 0x8080d2b
    if (*old_c != real_c) {
        // 0x8080d39
        *old_c = real_c;
        HTUserMsg(gettext("No editor is defined!"));
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8080ddd - 0x80811ea
// Line range:    2608 - 2695
int32_t handle_LYK_ELGOTO(int32_t * ch, char * user_input_buffer, char ** old_user_input, int32_t * old_c, int32_t real_c) {
    // 0x8080ddd
    if (no_goto != 0) {
        // 0x8080dee
        if (LYValidate == 0) {
            // 0x8080df9
            if (*old_c != real_c) {
                // 0x8080e03
                *old_c = real_c;
                HTUserMsg(gettext("Goto a random URL is disallowed!"));
            }
            // 0x80811e5
            return 0;
        }
    }
    // 0x8080e2b
    int32_t v1; // 0x8080e6a
    int32_t v2; // 0x8080ddd
    if (nlinks < 1 || g251 < 0) {
        goto lab_0x8080eb2;
    } else {
        // 0x8080e3d
        v2 = 68 * g251;
        if (*(int32_t *)(v2 + (int32_t)&g347) != 1) {
            goto lab_0x8080f6b;
        } else {
            // 0x8080e5b
            v1 = *(int32_t *)(v2 + (int32_t)&g354);
            switch (*(int32_t *)(v1 + 8)) {
                case 5: {
                    goto lab_0x8080efe;
                }
                case 13: {
                    goto lab_0x8080efe;
                }
                case 12: {
                    goto lab_0x8080efe;
                }
                default: {
                    goto lab_0x8080eb2;
                }
            }
        }
    }
  lab_0x8080eb2:
    // 0x8080eb2
    if (*old_c != real_c) {
        // 0x8080ebc
        *old_c = real_c;
        HTUserMsg(gettext("You are not on a form submission button or normal link."));
    }
    // 0x80811e5
    return 0;
  lab_0x8080f6b:;
    int32_t v3 = *(int32_t *)(v2 + (int32_t)&links); // 0x8080f7a
    if (strncasecomp((char *)v3, "LYNXDIRED:", 10) != 0) {
        // 0x8080f9c
        if (LYIsUIPage3((char *)g245, 8, 1) == 0) {
            // 0x8080fbd
            if (LYIsUIPage3((char *)g245, 9, 1) == 0) {
                // 0x8080fde
                if (LYIsUIPage3((char *)g245, 10, 1) == 0) {
                    // 0x8081031
                    HTSACopy(old_user_input, user_input_buffer);
                    int32_t v4 = 68 * g251; // 0x8081050
                    int32_t v5; // 0x8080ddd
                    if (*(int32_t *)(v4 + (int32_t)&g347) != 1) {
                        // 0x808107a
                        v5 = v4 + (int32_t)&links;
                    } else {
                        // 0x808105d
                        v5 = *(int32_t *)(v4 + (int32_t)&g354) + 48;
                    }
                    // 0x8081092
                    LYstrncpy(user_input_buffer, (char *)*(int32_t *)v5, 1023);
                    mustshow = 1;
                    statusline(gettext("Edit the current link's URL: "));
                    uint32_t v6 = LYgetstr(user_input_buffer, 0, 1024, 1); // 0x80810e5
                    *ch = v6;
                    if (v6 >= 0) {
                        // 0x80810fe
                        if (*user_input_buffer != 0) {
                            int32_t v7 = 68 * g251; // 0x8081119
                            int32_t str; // 0x8080ddd
                            if (*(int32_t *)(v7 + (int32_t)&g347) != 1) {
                                // 0x8081143
                                str = v7 + (int32_t)&links;
                            } else {
                                // 0x8081126
                                str = *(int32_t *)(v7 + (int32_t)&g354) + 48;
                            }
                            // 0x808115b
                            if (strcmp(user_input_buffer, (char *)*(int32_t *)str) != 0) {
                                // 0x8081171
                                LYTrimAllStartfile(user_input_buffer);
                                if (*user_input_buffer != 0) {
                                    // 0x80811e5
                                    return 2;
                                }
                            }
                        }
                    }
                    // 0x808118f
                    HTInfoMsg(gettext("Cancelled!!!"));
                    LYstrncpy(user_input_buffer, *old_user_input, 1023);
                    char * v8 = *old_user_input;
                    if (v8 != NULL) {
                        // 0x80811c8
                        free((int32_t *)v8);
                        *(int32_t *)old_user_input = 0;
                    }
                    // 0x80811e5
                    return 0;
                }
            }
        }
    }
    // 0x8080fff
    if (*old_c != real_c) {
        // 0x8081009
        *old_c = real_c;
        HTUserMsg(gettext("You cannot edit File Management URLs"));
    }
    // 0x80811e5
    return 0;
  lab_0x8080efe:;
    int32_t v9 = *(int32_t *)(v1 + 48); // 0x8080f13
    if (v9 == 0) {
        goto lab_0x8080f39;
    } else {
        // 0x8080f1a
        if (*(char *)v9 != 0) {
            goto lab_0x8080f6b;
        } else {
            goto lab_0x8080f39;
        }
    }
  lab_0x8080f39:
    // 0x8080f39
    if (*old_c != real_c) {
        // 0x8080f43
        *old_c = real_c;
        HTUserMsg(gettext("** Bad HTML!!  No form action defined. **"));
    }
    // 0x80811e5
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80811ea - 0x808123f
// Line range:    2699 - 2704
void handle_LYK_EXTERN_LINK(char * refresh_screen) {
    // 0x80811ea
    if (nlinks < 1) {
        // 0x808123d
        return;
    }
    int32_t v1 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x8081208
    if (v1 != 0) {
        // 0x8081212
        run_external((char *)v1, 0);
        *refresh_screen = 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808123f - 0x808126b
// Line range:    2707 - 2712
void handle_LYK_EXTERN_PAGE(char * refresh_screen) {
    // 0x808123f
    if (g245 != NULL) {
        // 0x808124e
        run_external((char *)g245, 0);
        *refresh_screen = 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808126b - 0x8081765
// Line range:    2718 - 2815
char handle_LYK_FASTBACKW_LINK(int32_t * cmd, int32_t * old_c, int32_t real_c) {
    // 0x808126b
    int32_t v1; // 0x80812e9
    int32_t v2; // 0x8081304
    int32_t v3; // 0x8081278
    if (nlinks < 2) {
        // 0x80816c0
        goto lab_0x80816c0_2;
    } else {
        // 0x8081295
        v3 = g251;
        int32_t v4 = 68 * v3; // 0x80812a2
        if (*(int32_t *)(v4 + (int32_t)&g347) != 1) {
            goto lab_0x8081515;
        } else {
            int32_t v5 = *(int32_t *)(v4 + (int32_t)&g354); // 0x80812c2
            if (*(int32_t *)(v5 + 8) != 9) {
                goto lab_0x8081515;
            } else {
                // 0x80812d4
                v1 = *(int32_t *)(v5 + 4);
                v2 = *(int32_t *)v5;
                if (v3 < 1) {
                    goto lab_0x80813de;
                } else {
                    // 0x8081316
                    if (g347 != 1) {
                        goto lab_0x8081358;
                    } else {
                        // 0x8081320
                        if (*(int32_t *)(g354 + 8) != 9) {
                            goto lab_0x8081358;
                        } else {
                            // 0x808132d
                            if (*(int32_t *)(g354 + 4) != v1) {
                                goto lab_0x8081358;
                            } else {
                                int32_t v6 = *(int32_t *)g354; // 0x808133f
                                if (sametext((char *)v6, (char *)v2) != 0) {
                                    goto lab_0x80813de;
                                } else {
                                    goto lab_0x8081358;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x80816c0_2:
    // 0x80816c0
    if (Newline >= 2) {
        int32_t v7 = HTGetLinkOrFieldStart(g251, &Newline, &g241, -1, 1); // 0x80816f2
        if (v7 != 0) {
            if (v7 != 16) {
                // 0x808172b
                Newline++;
                // 0x8081760
                return 0;
            }
            // 0x8081706
            if (nlinks >= 1) {
                // 0x808170f
                g251 = 0;
            }
            // 0x8081719
            *cmd = 26;
            // 0x8081760
            return 1;
        }
    }
    // 0x808173a
    if (*old_c != real_c) {
        // 0x8081744
        *old_c = real_c;
        HTInfoMsg(gettext("There are no links above this line of the document."));
    }
    // 0x8081760
    return 0;
  lab_0x8081515:;
    int32_t v8; // 0x808126b
    int32_t v9; // 0x808126b
    if (v3 < 1) {
        // 0x808152b
        if (more_text != 0) {
            // 0x80816c0
            goto lab_0x80816c0_2;
        } else {
            // 0x8081536
            if (Newline != 1) {
                goto lab_0x80816c0_2;
            } else {
                // 0x808155c
                v8 = nlinks - 1;
                goto lab_0x8081566;
            }
        }
    } else {
        // 0x808151e
        v9 = v3 - 1;
        goto lab_0x808155c;
    }
  lab_0x808155c:
    // 0x808155c
    v8 = v9;
    if (v9 < 1) {
        // 0x80816b0
        set_curdoc_link(v9);
        // 0x8081760
        return 0;
    }
    goto lab_0x8081566;
  lab_0x80813de:
    // 0x80813de
    if (more_text != 0) {
        goto lab_0x80814e7;
    } else {
        // 0x80813ed
        if (Newline != 1) {
            goto lab_0x80814e7;
        } else {
            // 0x80813fb
            if (g347 != 1) {
                goto lab_0x80814e7;
            } else {
                // 0x8081409
                if (*(int32_t *)(g354 + 8) != 9) {
                    goto lab_0x80814e7;
                } else {
                    // 0x808141a
                    if (*(int32_t *)(g354 + 4) != v1) {
                        goto lab_0x80814e7;
                    } else {
                        char * v21 = (char *)v2; // 0x808143c
                        if (sametext((char *)*(int32_t *)g354, v21) == 0) {
                            goto lab_0x80814e7;
                        } else {
                            int32_t v22 = 68 * nlinks;
                            if (*(int32_t *)(v22 + (int32_t)&g347 - 68) != 1) {
                                // 0x80814d3
                                v9 = nlinks - 1;
                                goto lab_0x808155c;
                            } else {
                                int32_t v23 = *(int32_t *)(v22 + (int32_t)&g354 - 68); // 0x8081478
                                if (*(int32_t *)(v23 + 8) != 9) {
                                    // 0x80814d3
                                    v9 = nlinks - 1;
                                    goto lab_0x808155c;
                                } else {
                                    // 0x8081486
                                    if (*(int32_t *)(v23 + 4) != v1) {
                                        // 0x80814d3
                                        v9 = nlinks - 1;
                                        goto lab_0x808155c;
                                    } else {
                                        // 0x80814a6
                                        if (sametext((char *)*(int32_t *)v23, v21) != 0) {
                                            goto lab_0x80814e7;
                                        } else {
                                            // 0x80814d3
                                            v9 = nlinks - 1;
                                            goto lab_0x808155c;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x8081566:;
    int32_t v10 = 68 * v8; // 0x8081571
    if (*(int32_t *)(v10 + (int32_t)&g347) != 1) {
        // 0x80816b0
        set_curdoc_link(v8);
        // 0x8081760
        return 0;
    }
    int32_t v11 = *(int32_t *)(v10 + (int32_t)&g354); // 0x808158f
    if (*(int32_t *)(v11 + 8) != 9) {
        // 0x80816b0
        set_curdoc_link(v8);
        // 0x8081760
        return 0;
    }
    int32_t v12 = *(int32_t *)(v11 + 4); // 0x80815b4
    char * v13 = (char *)*(int32_t *)v11; // 0x80815cf
    if (g347 == 1) {
        // 0x80815dc
        if (*(int32_t *)(g354 + 8) == 9) {
            // 0x80815e9
            if (*(int32_t *)(g354 + 4) == v12) {
                // 0x80815f6
                if (sametext((char *)*(int32_t *)g354, v13) != 0) {
                    // 0x80816b0
                    set_curdoc_link(0);
                    // 0x8081760
                    return 0;
                }
            }
        }
    }
    // 0x8081620
    if (v8 < 2) {
        // 0x80816b0
        set_curdoc_link(1);
        // 0x8081760
        return 0;
    }
    int32_t v14 = v8;
    int32_t v15 = 68 * v14;
    int32_t v16 = v14; // 0x8081643
    while (*(int32_t *)(v15 + (int32_t)&g347 - 68) == 1) {
        int32_t v17 = *(int32_t *)(v15 + (int32_t)&g354 - 68); // 0x8081655
        v16 = v14;
        if (*(int32_t *)(v17 + 8) != 9) {
            // break -> 0x80816b0
            break;
        }
        // 0x8081663
        v16 = v14;
        if (*(int32_t *)(v17 + 4) != v12) {
            // break -> 0x80816b0
            break;
        }
        // 0x8081681
        v16 = v14;
        if (sametext((char *)*(int32_t *)v17, v13) == 0) {
            // break -> 0x80816b0
            break;
        }
        // 0x808161c
        v16 = 1;
        if (v14 < 3) {
            // break -> 0x80816b0
            break;
        }
        v14--;
        v15 = 68 * v14;
        v16 = v14;
    }
    // 0x80816b0
    set_curdoc_link(v16);
    // 0x8081760
    return 0;
  lab_0x80814e7:
    // 0x80814e7
    if (more_text == 0) {
        // 0x8081552
        if (Newline == 1 && g251 >= 1) {
            // 0x80816b0
            set_curdoc_link(0);
            // 0x8081760
            return 0;
        }
    }
    // 0x80816c0
    goto lab_0x80816c0_2;
  lab_0x8081358:;
    int32_t v18 = v3 - 1; // 0x8081358
    int32_t v19 = 68 * v18; // 0x8081367
    v9 = v18;
    while (*(int32_t *)(v19 + (int32_t)&g347) == 1) {
        int32_t v20 = *(int32_t *)(v19 + (int32_t)&g354); // 0x8081381
        v9 = v18;
        if (*(int32_t *)(v20 + 8) != 9) {
            // break -> 0x808155c
            break;
        }
        // 0x808138f
        v9 = v18;
        if (*(int32_t *)(v20 + 4) != v1) {
            // break -> 0x808155c
            break;
        }
        // 0x80813aa
        v9 = v18;
        if (sametext((char *)*(int32_t *)v20, (char *)v2) == 0) {
            // break -> 0x808155c
            break;
        }
        v18--;
        v19 = 68 * v18;
        v9 = v18;
    }
    goto lab_0x808155c;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8081765 - 0x8081a5a
// Line range:    2819 - 2877
void handle_LYK_FASTFORW_LINK(int32_t * old_c, int32_t real_c) {
    // 0x8081765
    int32_t v1; // 0x80817dc
    int32_t v2; // 0x80817f7
    if (nlinks < 2) {
        // 0x8081765
        goto lab_0x80819b2;
    } else {
        int32_t v3 = 68 * g251; // 0x8081795
        if (*(int32_t *)(v3 + (int32_t)&g347) != 1) {
            goto lab_0x8081951;
        } else {
            int32_t v4 = *(int32_t *)(v3 + (int32_t)&g354); // 0x80817b5
            if (*(int32_t *)(v4 + 8) != 9) {
                goto lab_0x8081951;
            } else {
                if (g251 < nlinks - 1) {
                    // 0x8081812
                    v1 = *(int32_t *)(v4 + 4);
                    v2 = *(int32_t *)v4;
                    int32_t v5 = 68 * nlinks;
                    if (*(int32_t *)(v5 + (int32_t)&g347 - 68) != 1) {
                        goto lab_0x80818a0;
                    } else {
                        int32_t v6 = *(int32_t *)(v5 + (int32_t)&g354 - 68); // 0x8081841
                        if (*(int32_t *)(v6 + 8) != 9) {
                            goto lab_0x80818a0;
                        } else {
                            // 0x808184f
                            if (*(int32_t *)(v6 + 4) != v1) {
                                goto lab_0x80818a0;
                            } else {
                                // 0x808186f
                                if (sametext((char *)*(int32_t *)v6, (char *)v2) != 0) {
                                    goto lab_0x8081923;
                                } else {
                                    goto lab_0x80818a0;
                                }
                            }
                        }
                    }
                } else {
                    goto lab_0x8081923;
                }
            }
        }
    }
  lab_0x80819b2:
    // 0x80819b2
    if (more_text != 0) {
        // 0x80819f2
        if (HTGetLinkOrFieldStart(g251, &Newline, &g241, 1, 1) != 0) {
            // 0x8081a23
            Newline++;
            // 0x8081a58
            return;
        }
    } else {
        // 0x80819bd
        if (Newline == 1) {
            // 0x80819c7
            if (g251 == nlinks - 1) {
                // 0x80819d9
                set_curdoc_link(0);
                // 0x8081a58
                return;
            }
        }
    }
    // 0x8081a32
    if (*old_c != real_c) {
        // 0x8081a3c
        *old_c = real_c;
        HTInfoMsg(gettext("There are no links below this line of the document."));
    }
  lab_0x8081951:
    if (g251 < nlinks - 1) {
        // 0x80819a2
        set_curdoc_link(g251 + 1);
        // 0x8081a58
        return;
    }
    // 0x8081970
    if (more_text == 0) {
        // 0x808199c
        if (g251 >= 1 && Newline == 1) {
            // 0x80819a2
            set_curdoc_link(0);
            // 0x8081a58
            return;
        }
    }
    goto lab_0x80819b2;
  lab_0x8081923:
    // 0x8081923
    if (more_text == 0) {
        // 0x808192e
        if (Newline == 1 && g251 >= 1) {
            // 0x80819a2
            set_curdoc_link(0);
            // 0x8081a58
            return;
        }
    }
    goto lab_0x80819b2;
  lab_0x80818a0:;
    int32_t v7 = g251 + 1; // 0x80818a0
    int32_t v8 = 68 * v7; // 0x80818af
    int32_t v9 = v7; // 0x80818ba
    while (*(int32_t *)(v8 + (int32_t)&g347) == 1) {
        int32_t v10 = *(int32_t *)(v8 + (int32_t)&g354); // 0x80818c9
        v9 = v7;
        if (*(int32_t *)(v10 + 8) != 9) {
            // break -> 0x80819a2
            break;
        }
        // 0x80818d7
        v9 = v7;
        if (*(int32_t *)(v10 + 4) != v1) {
            // break -> 0x80819a2
            break;
        }
        // 0x80818f2
        v9 = v7;
        if (sametext((char *)*(int32_t *)v10, (char *)v2) == 0) {
            // break -> 0x80819a2
            break;
        }
        v7++;
        v8 = 68 * v7;
        v9 = v7;
    }
    // 0x80819a2
    set_curdoc_link(v9);
    // 0x8081a58
    return;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8081a5a - 0x8081aae
// Line range:    2880 - 2889
void handle_LYK_FIRST_LINK(void) {
    int32_t v1 = g251;
    int32_t v2 = v1 - 1; // 0x8081a68
    while (v2 >= 0) {
        int32_t v3 = *(int32_t *)(68 * g251 + (int32_t)&g346); // 0x8081a94
        if (*(int32_t *)(68 * v2 + (int32_t)&g346) != v3) {
            // break -> 0x8081a9e
            break;
        }
        v1 = v2;
        v2 = v1 - 1;
    }
    // 0x8081a9e
    set_curdoc_link(v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8081aae - 0x8081c4f
// Line range:    2901 - 2942
char handle_LYK_GOTO(int32_t * ch, char * user_input_buffer, char ** old_user_input, int32_t * recall, int32_t * URLTotal, int32_t * URLNum, char * FirstURLRecall, int32_t * old_c, int32_t real_c) {
    // 0x8081aae
    if (no_goto != 0) {
        // 0x8081abf
        if (LYValidate == 0) {
            // 0x8081aca
            if (*old_c != real_c) {
                // 0x8081ad4
                *old_c = real_c;
                HTUserMsg(gettext("Goto a random URL is disallowed!"));
            }
            // 0x8081c49
            return 0;
        }
    }
    // 0x8081af9
    HTSACopy(old_user_input, user_input_buffer);
    if (goto_buffer == 0) {
        // 0x8081b16
        *user_input_buffer = 0;
    }
    int32_t v1 = 0; // 0x8081b23
    if (Goto_URLs != NULL) {
        // 0x8081b25
        v1 = HTList_count(Goto_URLs);
    }
    int32_t v2 = v1; // 0x8081b82
    *URLTotal = v2;
    char v3; // 0x8081aae
    int32_t v4; // 0x8081aae
    if (goto_buffer == 0) {
        goto lab_0x8081b7f;
    } else {
        // 0x8081b51
        if (*user_input_buffer == 0) {
            goto lab_0x8081b7f;
        } else {
            int32_t v5 = v2 - 1; // 0x8081b60
            *recall = (int32_t)(v5 < 0 == (v2 & -v2) < 0 == (v5 != 0));
            v4 = 0;
            v3 = 0;
            goto lab_0x8081ba1;
        }
    }
  lab_0x8081b7f:
    // 0x8081b7f
    *recall = (int32_t)(v2 >= 0 == (v2 != 0));
    v4 = *URLTotal;
    v3 = 1;
    goto lab_0x8081ba1;
  lab_0x8081ba1:
    // 0x8081ba1
    *URLNum = v4;
    *FirstURLRecall = v3;
    mustshow = 1;
    statusline(gettext("URL to open: "));
    int32_t v6 = LYgetstr(user_input_buffer, 0, 1024, *recall); // 0x8081bdb
    *ch = v6;
    if (v6 >= 0) {
        // 0x8081c49
        return 1;
    }
    // 0x8081bf0
    LYstrncpy(user_input_buffer, *old_user_input, 1023);
    char * v7 = *old_user_input;
    if (v7 != NULL) {
        // 0x8081c15
        free((int32_t *)v7);
        *(int32_t *)old_user_input = 0;
    }
    // 0x8081c2b
    HTInfoMsg(gettext("Cancelled!!!"));
    // 0x8081c49
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8081c4f - 0x8081cd3
// Line range:    2945 - 2959
void handle_LYK_GROW_TEXTAREA(char * refresh_screen) {
    int32_t v1 = 68 * g251; // 0x8081c62
    char * v2; // 0x8081cc4
    if (*(int32_t *)(v1 + (int32_t)&g347) != 1) {
        // 0x8081cbd
        v2 = gettext("Not in a TEXTAREA; cannot use command.");
        HTInfoMsg(v2);
        // 0x8081cd1
        return;
    }
    int32_t v3 = *(int32_t *)(*(int32_t *)(v1 + (int32_t)&g354) + 8); // 0x8081c84
    if (v3 != 9) {
        // 0x8081cbd
        v2 = gettext("Not in a TEXTAREA; cannot use command.");
        HTInfoMsg(v2);
        // 0x8081cd1
        return;
    }
    // 0x8081c8c
    HText_ExpandTextarea((int32_t *)(v1 + (int32_t)&links), 5);
    *refresh_screen = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8081cd3 - 0x80822be
// Line range:    2962 - 3087
char handle_LYK_HEAD(int32_t * cmd) {
    // 0x8081cd3
    if (nlinks < 1) {
        goto lab_0x8082174;
    } else {
        int32_t v1 = 68 * g251; // 0x8081cf3
        if (*(int32_t *)(v1 + (int32_t)&g347) != 1) {
            goto lab_0x8081d5b;
        } else {
            int32_t v2 = *(int32_t *)(v1 + (int32_t)&g354); // 0x8081d0f
            int32_t v3 = *(int32_t *)(v2 + 8); // 0x8081d15
            switch (v3) {
                case 5: {
                    goto lab_0x8081d5b;
                }
                case 13: {
                    goto lab_0x8081d5b;
                }
                default: {
                    if (v3 != 12) {
                        goto lab_0x8082174;
                    } else {
                        goto lab_0x8081d5b;
                    }
                }
            }
        }
    }
  lab_0x8082174:
    // 0x8082174
    if (g246 != 0 && g250 != 1) {
        char * v4 = gettext("Document from POST action, HEAD may not be understood.  Proceed?"); // 0x808218f
        if (HTConfirm(v4) == 0) {
            // 0x80821a0
            HTInfoMsg(gettext("Cancelled!!!"));
            // 0x80822b8
            return 0;
        }
    }
    // 0x80821b9
    if (nlinks >= 1) {
        // 0x80821c2
        mustshow = 1;
        statusline(gettext("Send HEAD request for D)ocument, or C)ancel? (d,c): "));
        if (LYgetch_single() != 68) {
            // 0x80822b8
            return 0;
        }
    }
    int32_t v5 = strncasecomp((char *)g245, "LYNXIMGMAP:", 11); // 0x8082210
    int32_t v6 = (int32_t)g245;
    if (LYCanDoHEAD((char *)(v5 == 0 ? v6 + 11 : v6)) != 1) {
        // 0x8082243
        HTUserMsg(gettext("Sorry, the document is not an http URL."));
        // 0x80822b8
        return 0;
    }
    // 0x8082259
    HEAD_request = 1;
    LYforce_no_cache = 1;
    HTSACopy((char **)&newdoc, (char *)curdoc);
    if (HTLoadedDocumentIsHEAD() == 0) {
        // 0x80822a0
        HTSACat((char **)&newdoc, " - HEAD");
    } else {
        // 0x8082285
        HText_setNoCache(HTMainText);
        free_address(&curdoc);
    }
    // 0x80822b8
    return 0;
  lab_0x8081d5b:
    // 0x8081d5b
    mustshow = 1;
    statusline(gettext("Send HEAD request for D)ocument or L)ink, or C)ancel? (d,l,c): "));
    int32_t v7 = LYgetch_single(); // 0x8081d76
    if (v7 == 68) {
        int32_t v8 = strncasecomp((char *)g245, "LYNXIMGMAP:", 11); // 0x8081da0
        int32_t v9 = (int32_t)g245;
        if (LYCanDoHEAD((char *)(v8 == 0 ? v9 + 11 : v9)) != 1) {
            // 0x8081dd3
            HTUserMsg(gettext("Sorry, the document is not an http URL."));
            // 0x80822b8
            return 0;
        }
        // 0x8081dec
        if (g246 != 0 && g250 != 1) {
            char * v10 = gettext("Document from POST action, HEAD may not be understood.  Proceed?"); // 0x8081e07
            if (HTConfirm(v10) == 0) {
                // 0x8081e18
                HTInfoMsg(gettext("Cancelled!!!"));
                // 0x80822b8
                return 0;
            }
        }
        // 0x8081e31
        HEAD_request = 1;
        LYforce_no_cache = 1;
        HTSACopy((char **)&newdoc, (char *)curdoc);
        if (HTLoadedDocumentIsHEAD() == 0) {
            // 0x8081e7b
            HTSACat((char **)&newdoc, " - HEAD");
        } else {
            // 0x8081e5d
            HText_setNoCache(HTMainText);
            free_address(&curdoc);
        }
        // 0x80822b8
        return 0;
    }
    // 0x8081e94
    if (v7 != 76) {
        // 0x80822b8
        return 0;
    }
    int32_t v11 = 68 * g251; // 0x8081eab
    if (*(int32_t *)(v11 + (int32_t)&g347) != 1) {
        int32_t str = *(int32_t *)(v11 + (int32_t)&links); // 0x8081ecb
        if (strncmp((char *)str, "http", 4) != 0) {
            int32_t str2 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x8081f00
            if (strncmp((char *)str2, "LYNXIMGMAP:http", 15) != 0) {
                int32_t v12 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x8081f31
                if (LYCanDoHEAD((char *)v12) != 1) {
                    int32_t v13 = *(int32_t *)(68 * g251 + (int32_t)&g347); // 0x8081f52
                    if (v13 != 6 || g245 == NULL || strncmp((char *)g245, "http", 4) != 0) {
                        // 0x8081f87
                        HTUserMsg(gettext("Sorry, the link is not an http URL."));
                        // 0x80822b8
                        return 0;
                    }
                }
            }
        }
    }
    int32_t v14 = 68 * g251;
    int32_t * str3; // 0x8081cd3
    if (*(int32_t *)(v14 + (int32_t)&g347) != 1) {
        goto lab_0x80820ec;
    } else {
        int32_t v15 = *(int32_t *)(v14 + (int32_t)&g354); // 0x8081fc9
        if (*(int32_t *)(v15 + 80) != 0) {
            // 0x8081fd6
            HTUserMsg(gettext("Sorry, the ACTION for this form is disabled."));
            // 0x80822b8
            return 0;
        }
        int32_t * v16 = (int32_t *)(v15 + 48);
        int32_t v17 = *v16; // 0x8082022
        if (v17 == 0) {
            goto lab_0x80820ec;
        } else {
            char * v18 = (char *)v17; // 0x8082045
            char v19 = *v18; // 0x8082045
            str3 = v16;
            if (v19 != 108 == (v19 != 76)) {
                goto lab_0x808209f;
            } else {
                // 0x808206b
                if (strncasecomp(v18, "lynxcgi:", 8) == 0) {
                    goto lab_0x80820ec;
                } else {
                    int32_t v20 = *(int32_t *)(68 * g251 + (int32_t)&g354);
                    str3 = (int32_t *)(v20 + 48);
                    goto lab_0x808209f;
                }
            }
        }
    }
  lab_0x80820ec:;
    int32_t v21 = 68 * g251; // 0x80820f9
    if (*(int32_t *)(v21 + (int32_t)&g347) == 1) {
        int32_t v22 = *(int32_t *)(v21 + (int32_t)&g354); // 0x8082115
        if (*(int32_t *)(v22 + 52) == 2) {
            char * v23 = gettext("Form submit action is POST, HEAD may not be understood.  Proceed?"); // 0x808212a
            if (HTConfirm(v23) == 0) {
                // 0x808213b
                HTInfoMsg(gettext("Cancelled!!!"));
                // 0x80822b8
                return 0;
            }
        }
    }
    // 0x8082154
    HEAD_request = 1;
    LYforce_no_cache = 1;
    *cmd = 39;
    // 0x80822b8
    return 1;
  lab_0x808209f:
    // 0x808209f
    if (strncmp((char *)*str3, "http", 4) != 0) {
        // 0x80820d3
        HTUserMsg(gettext("Sorry, the ACTION for this form is not an http URL."));
        // 0x80822b8
        return 0;
    }
    goto lab_0x80820ec;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80822be - 0x80823bc
// Line range:    3090 - 3114
void handle_LYK_HELP(char ** cshelpfile) {
    char * str = NULL; // bp-8, 0x80822c4
    char * v1 = *cshelpfile; // 0x80822ce
    char * v2 = v1; // 0x80822d2
    if (v1 == NULL) {
        // 0x80822d4
        *(int32_t *)cshelpfile = helpfile;
        v2 = (char *)helpfile;
    }
    // 0x80822df
    HTSACopy(&str, v2);
    LYEnsureAbsoluteURL(&str, *cshelpfile, 0);
    if (strcmp((char *)g245, str) != 0) {
        // 0x8082328
        set_address(&newdoc, str);
        char * v3 = gettext("Help Screen"); // 0x8082342
        HTSACopy((char **)&newdoc, v3);
        LYFreePostData(&newdoc);
        if (g238 != NULL) {
            // 0x808236c
            free((int32_t *)g238);
            g238 = NULL;
        }
        // 0x8082383
        g239 = 0;
        g240 = 0;
        g243 = 0;
    }
    // 0x8082398
    if (str != NULL) {
        // 0x808239f
        free((int32_t *)str);
        str = NULL;
    }
    // 0x80823b1
    *(int32_t *)cshelpfile = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80823bc - 0x80824e8
// Line range:    3117 - 3150
void handle_LYK_HISTORICAL(void) {
    // 0x80823bc
    if (HTcan_reparse_document() != 0) {
        goto lab_0x8082457;
    } else {
        // 0x80823cf
        if (g246 == 0 || g250 == 1) {
            goto lab_0x8082422;
        } else {
            // 0x80823e3
            if (confirm_post_resub((char *)g245, NULL, 0, 0) != 0) {
                goto lab_0x8082422;
            } else {
                // 0x808240c
                HTInfoMsg(gettext("Document will not be reloaded!"));
                goto lab_0x8082457;
            }
        }
    }
  lab_0x8082457:;
    char v1 = historical_comments; // 0x8082457
    historical_comments = v1 == 0;
    if (minimal_comments == 0) {
        char * v2; // 0x80823bc
        if (v1 != 0) {
            // 0x80824c7
            v2 = gettext("Historical comment parsing OFF (Valid is in effect)!");
        } else {
            // 0x80824b6
            v2 = gettext("Historical comment parsing ON (Valid is overridden)!");
        }
        // 0x80824d6
        HTAlert(v2);
        // 0x80824e1
        reparse_document();
        return;
    }
    char * v3; // 0x80823bc
    if (v1 != 0) {
        // 0x808248f
        v3 = gettext("Historical comment parsing OFF (Minimal is in effect)!");
    } else {
        // 0x808247e
        v3 = gettext("Historical comment parsing ON (Minimal is overridden)!");
    }
    // 0x808249e
    HTAlert(v3);
    // 0x80824e1
    reparse_document();
  lab_0x8082422:
    // 0x8082422
    HText_setNoCache(HTMainText);
    move_address(&newdoc, &curdoc);
    *(int32_t *)&g242 = (int32_t)g252;
    g241 = g251;
    goto lab_0x8082457;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80824e8 - 0x808266c
// Line range:    3153 - 3194
char handle_LYK_HISTORY(char ForcePush) {
    // 0x80824e8
    if (curdoc == 0 || LYIsUIPage3((char *)g245, 0, 1) != 0) {
        // 0x8082666
        return 0;
    }
    // 0x8082526
    if (WWW_TraceFlag != 0) {
        // 0x8082531
        if (LYUseTraceLog == 0 && LYCursesON != 0) {
            // 0x8082547
            LYmove(LYlines - 1, LYcols + (int32_t)(LYShowScrollbar != 0) - 1);
            LYrefresh();
        }
    }
    // 0x808257e
    LYpush(&curdoc, ForcePush);
    if (showhistory((char **)&g235) < 0) {
        // 0x80825a2
        LYpop(&curdoc);
        // 0x8082666
        return 1;
    }
    // 0x80825b7
    LYRegisterUIPage((char *)g235, 0);
    char * v1 = gettext("History Page"); // 0x80825d3
    HTSACopy((char **)&newdoc, v1);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x80825fd
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x8082614
    g239 = 0;
    g240 = 0;
    g243 = 0;
    g241 = 1;
    free_address(&curdoc);
    if ((check_realm || LYValidate) != 0) {
        // 0x8082655
        LYPermitURL = 1;
    }
    // 0x8082666
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808266c - 0x80826c6
// Line range:    3197 - 3203
char handle_LYK_IMAGE_TOGGLE(int32_t * cmd) {
    char v1 = clickable_images; // 0x8082672
    clickable_images = v1 == 0;
    char * v2; // 0x808266c
    if (v1 != 0) {
        // 0x808269f
        v2 = gettext("Standard image handling restored!  Reloading...");
    } else {
        // 0x808268e
        v2 = gettext("Links will be included for all images!  Reloading...");
    }
    // 0x80826ae
    HTUserMsg(v2);
    return reparse_or_reload(cmd);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80826c6 - 0x8082797
// Line range:    3207 - 3234
void handle_LYK_INDEX(int32_t * old_c, int32_t real_c) {
    // 0x80826c6
    if (strcmp((char *)g245, (char *)indexfile) == 0) {
        // 0x8082795
        return;
    }
    char * v1 = (char *)indexfile; // 0x80826f0
    if (*v1 == 0) {
        // 0x80826f7
        if (*old_c != real_c) {
            // 0x8082705
            *old_c = real_c;
            HTUserMsg(gettext("No index is currently available."));
        }
        // 0x8082795
        return;
    }
    // 0x8082723
    set_address(&newdoc, v1);
    char * v2 = gettext("System Index"); // 0x808273f
    HTSACopy((char **)&newdoc, v2);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x8082769
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x8082780
    g239 = 0;
    g240 = 0;
    g243 = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8082797 - 0x8082a81
// Line range:    3240 - 3313
void handle_LYK_INDEX_SEARCH(char * force_load, char ForcePush, int32_t * old_c, int32_t real_c) {
    // 0x8082797
    if (is_www_index == 0) {
        // 0x8082a55
        if (*old_c != real_c) {
            // 0x8082a5f
            *old_c = real_c;
            HTUserMsg(gettext("Not a searchable indexed document -- press '/' to search for a text string"));
        }
        // 0x8082a7b
        return;
    }
    // 0x80827b3
    g239 = 0;
    g240 = 0;
    if (do_www_search(&newdoc) == 1) {
        // 0x80827d6
        if (WWW_TraceFlag != 0) {
            // 0x80827e1
            if (LYUseTraceLog == 0 && LYCursesON != 0) {
                // 0x80827f7
                LYmove(LYlines - 1, LYcols + (int32_t)(LYShowScrollbar != 0) - 1);
                LYrefresh();
            }
        }
        // 0x808282e
        LYpush(&curdoc, ForcePush);
        copy_address(&curdoc, &newdoc);
        int32_t v1 = 0; // 0x808285d
        char * v2 = NULL; // 0x808285d
        if (g246 != 0) {
            // 0x808287c
            v1 = *(int32_t *)(g246 + 4);
            v2 = (char *)*(int32_t *)g246;
        }
        // 0x808288f
        HTSABCopy((int32_t **)&g236, v2, v1);
        HTSACopy(&g237, g247);
        g243 = 0;
        g252 = (char *)-1;
        Newline = 0;
        // 0x8082a7b
        return;
    }
    // 0x80828de
    if (use_this_url_instead == 0) {
        // 0x808299e
        copy_address(&newdoc, &curdoc);
        int32_t v3 = 0; // 0x80829b9
        char * v4 = NULL; // 0x80829b9
        if (g246 != 0) {
            // 0x80829d8
            v3 = *(int32_t *)(g246 + 4);
            v4 = (char *)*(int32_t *)g246;
        }
        // 0x80829eb
        HTSABCopy((int32_t **)&g236, v4, v3);
        HTSACopy(&g237, g247);
        HTSACopy(&g238, g248);
        g239 = g249;
        g240 = g250;
        g243 = g253;
        // 0x8082a7b
        return;
    }
    // 0x80828eb
    HTUserMsg2(gettext("Using %s"), (char *)use_this_url_instead);
    HTSACopy((char **)&newdoc, "A URL specified by redirection");
    set_address(&newdoc, (char *)use_this_url_instead);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x8082947
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x808295e
    g239 = 0;
    g240 = 0;
    g243 = 0;
    if (use_this_url_instead != 0) {
        // 0x808297c
        free((int32_t *)use_this_url_instead);
        use_this_url_instead = 0;
    }
    // 0x8082993
    *force_load = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8082a81 - 0x8082b8e
// Line range:    3316 - 3342
char handle_LYK_INFO(int32_t * cmd) {
    // 0x8082a81
    if (LYIsUIPage3((char *)g245, 3, 1) != 0) {
        // 0x8082b7b
        *cmd = 37;
        // 0x8082b88
        return 1;
    }
    // 0x8082aac
    if (do_change_link() == -1 || LYShowInfo(&curdoc, &newdoc, (char *)owner_address) < 0) {
        // 0x8082b88
        return 0;
    }
    // 0x8082adf
    LYRegisterUIPage((char *)g235, 3);
    char * v1 = gettext("Information about the current document"); // 0x8082afb
    HTSACopy((char **)&newdoc, v1);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x8082b25
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x8082b3c
    g239 = 0;
    g240 = 0;
    g243 = 0;
    LYforce_no_cache = 1;
    if ((check_realm || LYValidate) != 0) {
        // 0x8082b6e
        LYPermitURL = 1;
    }
    // 0x8082b88
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8082b8e - 0x8082be8
// Line range:    3345 - 3351
char handle_LYK_INLINE_TOGGLE(int32_t * cmd) {
    char v1 = pseudo_inline_alts; // 0x8082b94
    pseudo_inline_alts = v1 == 0;
    char * v2; // 0x8082b8e
    if (v1 != 0) {
        // 0x8082bc1
        v2 = gettext("Inlines without an ALT string specified will be ignored!  Reloading...");
    } else {
        // 0x8082bb0
        v2 = gettext("Pseudo_ALTs will be inserted for inlines without ALT strings!  Reloading...");
    }
    // 0x8082bd0
    HTUserMsg(v2);
    return reparse_or_reload(cmd);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8082be8 - 0x8082d01
// Line range:    3356 - 3407
void handle_LYK_INSERT_FILE(char * refresh_screen, int32_t * old_c, int32_t real_c) {
    int32_t v1 = 68 * g251; // 0x8082bfb
    char * v2; // 0x8082cf2
    if (*(int32_t *)(v1 + (int32_t)&g347) != 1) {
        // 0x8082ceb
        v2 = gettext("Not in a TEXTAREA; cannot use command.");
        HTInfoMsg(v2);
        // 0x8082cff
        return;
    }
    int32_t v3 = *(int32_t *)(*(int32_t *)(v1 + (int32_t)&g354) + 8); // 0x8082c21
    if (v3 != 9) {
        // 0x8082ceb
        v2 = gettext("Not in a TEXTAREA; cannot use command.");
        HTInfoMsg(v2);
        // 0x8082cff
        return;
    }
    // 0x8082c2d
    if (no_file_url == 0) {
        int32_t v4 = HTDirAccess; // 0x8082c43
        if (no_goto_file == 0 == (v4 != 0) == (v4 != 1)) {
            // 0x8082cbf
            HText_InsertFile((int32_t *)(v1 + (int32_t)&links));
            *refresh_screen = 1;
            // 0x8082cff
            return;
        }
    }
    // 0x8082c56
    if (*old_c == real_c) {
        // 0x8082cff
        return;
    }
    // 0x8082c64
    *old_c = real_c;
    if (no_goto_file == 0) {
        // 0x8082c95
        HTUserMsg(gettext("Access to local files denied."));
    } else {
        // 0x8082c77
        HTUserMsg2(gettext("You are not allowed to goto \"%s\" URLs"), "file:");
    }
    // 0x8082ca9
    HTInfoMsg(gettext("File insert cancelled!!!"));
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8082d01 - 0x8082e5c
// Line range:    3427 - 3482
char handle_LYK_JUMP(int32_t c, char * user_input_buffer, char ** old_user_input, int32_t * recall, char * FirstURLRecall, int32_t * URLNum, int32_t * URLTotal, int32_t * ch, int32_t * old_c, int32_t real_c) {
    // 0x8082d01
    if (no_jump == 0) {
        // 0x8082d12
        if (JThead != NULL) {
            // 0x8082d6e
            LYJumpFileURL = 1;
            char * v1 = LYJump(c); // 0x8082d7b
            if (v1 == NULL) {
                // 0x8082e4e
                LYJumpFileURL = 0;
                // 0x8082e55
                return 0;
            }
            char * v2 = HTParse(v1, (char *)startfile, 31); // 0x8082da4
            if (LYTrimStartfile(v2) == 0) {
                // 0x8082dbb
                LYRemoveBlanks(user_input_buffer);
            }
            // 0x8082dc6
            set_address(&newdoc, v2);
            HTSACopy((char **)&lynxjumpfile, v2);
            LYFreePostData(&newdoc);
            if (g238 != NULL) {
                // 0x8082e01
                free((int32_t *)g238);
                g238 = NULL;
            }
            // 0x8082e18
            g239 = 0;
            g240 = 0;
            g243 = 0;
            if (v2 != NULL) {
                // 0x8082e33
                free((int32_t *)v2);
            }
            // 0x8082e45
            LYUserSpecifiedURL = 1;
            // 0x8082e55
            return 0;
        }
    }
    // 0x8082d1b
    int32_t v3; // 0x8082d01
    if (*(int32_t *)v3 == v3) {
        // 0x8082e55
        return 0;
    }
    if (no_jump == 0) {
        // 0x8082d55
        HTUserMsg(gettext("No jump file is currently available."));
    } else {
        // 0x8082d3c
        HTUserMsg(gettext("Jumping to a shortcut URL is disallowed!"));
    }
    // 0x8082e55
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8082e5c - 0x8082f4a
// Line range:    3488 - 3519
void handle_LYK_KEYMAP(char * vi_keys_flag, char * emacs_keys_flag, int32_t * old_c, int32_t real_c) {
    // 0x8082e5c
    if (*old_c == real_c) {
        // 0x8082f48
        return;
    }
    // 0x8082e70
    *old_c = real_c;
    set_address(&newdoc, "LYNXKEYMAP:");
    char * v1 = gettext("Current Key Map"); // 0x8082e93
    HTSACopy((char **)&newdoc, v1);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x8082ebd
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x8082ed4
    g239 = 0;
    g240 = 0;
    g243 = 0;
    if (*vi_keys_flag != vi_keys) {
        goto lab_0x8082f0b;
    } else {
        // 0x8082efa
        if (*emacs_keys_flag == emacs_keys) {
            goto lab_0x8082f2a;
        } else {
            goto lab_0x8082f0b;
        }
    }
  lab_0x8082f0b:
    // 0x8082f0b
    LYforce_no_cache = 1;
    *vi_keys_flag = vi_keys;
    *emacs_keys_flag = emacs_keys;
    goto lab_0x8082f2a;
  lab_0x8082f2a:
    // 0x8082f2a
    if (no_dired_support == 0) {
        // 0x8082f35
        prev_lynx_edit_mode = lynx_edit_mode;
    }
    // 0x8082f41
    LYforce_no_cache = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8082f4a - 0x8082fa2
// Line range:    3522 - 3531
void handle_LYK_LAST_LINK(void) {
    int32_t v1 = g251;
    int32_t v2 = v1 + 1; // 0x8082f58
    while (v2 < nlinks) {
        int32_t v3 = *(int32_t *)(68 * g251 + (int32_t)&g346); // 0x8082f88
        if (*(int32_t *)(68 * v2 + (int32_t)&g346) != v3) {
            // break -> 0x8082f92
            break;
        }
        v1 = v2;
        v2 = v1 + 1;
    }
    // 0x8082f92
    set_curdoc_link(v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8082fa2 - 0x8082ff4
// Line range:    3535 - 3540
void handle_LYK_LEFT_LINK(void) {
    // 0x8082fa2
    if (g251 < 1) {
        // 0x8082ff2
        return;
    }
    int32_t v1 = 68 * g251; // 0x8082fbe
    int32_t v2 = *(int32_t *)(v1 + (int32_t)&g346 - 68); // 0x8082fd8
    if (*(int32_t *)(v1 + (int32_t)&g346) == v2) {
        // 0x8082fe2
        set_curdoc_link(g251 - 1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8082ff4 - 0x80830df
// Line range:    3543 - 3573
char handle_LYK_LIST(int32_t * cmd) {
    char * str = gettext("List Page"); // 0x8083001
    int32_t v1 = curdoc; // 0x8083009
    if (strcmp(v1 == 0 ? (char *)&g20 : (char *)v1, str) == 0) {
        // 0x8083039
        if (LYIsUIPage3((char *)g245, 4, 1) != 0) {
            // 0x808305a
            *cmd = 37;
            // 0x80830d9
            return 1;
        }
    }
    // 0x8083069
    if (showlist(&newdoc, 1) < 0) {
        // 0x80830d9
        return 0;
    }
    char * v2 = gettext("List Page"); // 0x808308e
    HTSACopy((char **)&newdoc, v2);
    if ((check_realm || LYValidate) != 0) {
        // 0x80830b9
        LYPermitURL = 1;
        HTSACopy((char **)&lynxlistfile, (char *)g235);
    }
    // 0x80830d9
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80830df - 0x80831fc
// Line range:    3577 - 3604
void handle_LYK_MAIN_MENU(int32_t * old_c, int32_t real_c) {
    // 0x80830df
    if (strcmp((char *)g245, (char *)homepage) == 0) {
        // 0x80831d4
        if (*old_c != real_c) {
            // 0x80831de
            *old_c = real_c;
            HTUserMsg(gettext("You are already at main screen!"));
        }
        // 0x80831fa
        return;
    }
    char * v1 = gettext("Do you really want to go to the Main screen?"); // 0x808310b
    if (HTConfirmDefault(v1, 0) != 1) {
        // 0x80831fa
        return;
    }
    // 0x8083129
    set_address(&newdoc, (char *)homepage);
    char * v2 = gettext("Entry into main screen"); // 0x8083145
    HTSACopy((char **)&newdoc, v2);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x808316f
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x8083186
    g239 = 0;
    g240 = 0;
    g243 = 0;
    LYhighlight(0, g251, prev_target);
    if (lynx_edit_mode != 0 && LYAutoUncacheDirLists >= 2) {
        // 0x80831cd
        HTuncache_current_document();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80831fc - 0x8083337
// Line range:    3607 - 3642
void handle_LYK_MINIMAL(void) {
    // 0x80831fc
    if (historical_comments != 0) {
        goto lab_0x80832a6;
    } else {
        // 0x8083211
        if (HTcan_reparse_document() != 0) {
            goto lab_0x80832a6;
        } else {
            // 0x808321e
            if (g246 == 0 || g250 == 1) {
                goto lab_0x8083271;
            } else {
                // 0x8083232
                if (confirm_post_resub((char *)g245, NULL, 0, 0) != 0) {
                    goto lab_0x8083271;
                } else {
                    // 0x808325b
                    HTInfoMsg(gettext("Document will not be reloaded!"));
                    goto lab_0x80832a6;
                }
            }
        }
    }
  lab_0x80832a6:;
    char v1 = minimal_comments; // 0x80832a6
    minimal_comments = v1 == 0;
    if (historical_comments != 0) {
        char * v2; // 0x80831fc
        if (v1 != 0) {
            // 0x8083316
            v2 = gettext("Minimal comment parsing OFF (Historical is in effect)!");
        } else {
            // 0x8083305
            v2 = gettext("Minimal comment parsing ON (but Historical is in effect)!");
        }
        // 0x8083325
        HTAlert(v2);
        // 0x8083330
        reparse_document();
        return;
    }
    char * v3; // 0x80831fc
    if (v1 != 0) {
        // 0x80832de
        v3 = gettext("Minimal comment parsing OFF (Valid is in effect)!");
    } else {
        // 0x80832cd
        v3 = gettext("Minimal comment parsing ON (and in effect)!");
    }
    // 0x80832ed
    HTAlert(v3);
    // 0x8083330
    reparse_document();
  lab_0x8083271:
    // 0x8083271
    HText_setNoCache(HTMainText);
    move_address(&newdoc, &curdoc);
    *(int32_t *)&g242 = (int32_t)g252;
    g241 = g251;
    goto lab_0x80832a6;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8083337 - 0x8083414
// Line range:    3646 - 3666
void handle_LYK_MODIFY(char * refresh_screen) {
    // 0x8083337
    if (lynx_edit_mode == 0 || nlinks < 1 || no_dired_support != 0) {
        // 0x8083412
        return;
    }
    int32_t v1 = local_modify(&curdoc, (char **)&g235); // 0x8083377
    if (v1 == -99) {
        // 0x8083385
        *refresh_screen = 1;
        // 0x8083412
        return;
    }
    if (v1 == 0) {
        // 0x8083412
        return;
    }
    // 0x8083396
    if (LYAutoUncacheDirLists >= 1) {
        // 0x808339f
        HTuncache_current_document();
    }
    // 0x80833a4
    move_address(&newdoc, &curdoc);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x80833cd
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x80833e4
    g239 = 0;
    g240 = 0;
    g243 = 0;
    *(int32_t *)&g242 = (int32_t)g252;
    g241 = g251;
    LYclear();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8083414 - 0x808346e
// Line range:    3671 - 3675
char handle_LYK_NESTED_TABLES(int32_t * cmd) {
    char v1 = nested_tables; // 0x808341a
    nested_tables = v1 == 0;
    char * v2; // 0x8083414
    if (v1 != 0) {
        // 0x8083447
        v2 = gettext("Parsing nested-tables toggled OFF!  Reloading...");
    } else {
        // 0x8083436
        v2 = gettext("Parsing nested-tables toggled ON!  Reloading...");
    }
    // 0x8083456
    HTUserMsg(v2);
    return reparse_or_reload(cmd);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808346e - 0x8083b4b
// Line range:    3680 - 3835
char handle_LYK_OPTIONS(int32_t * cmd, char * refresh_screen) {
    // 0x808346e
    if (LYUseFormsOptions != 0) {
        // 0x8083a98
        if (LYIsUIPage3((char *)g245, 7, 1) != 0) {
            // 0x8083b38
            *cmd = 37;
            // 0x8083b45
            return 1;
        }
        // 0x8083ab9
        set_address(&newdoc, "LYNXOPTIONS:/");
        LYFreePostData(&newdoc);
        if (g238 != NULL) {
            // 0x8083ae2
            free((int32_t *)g238);
            g238 = NULL;
        }
        // 0x8083af9
        g239 = 0;
        g240 = 0;
        g243 = 0;
        LYforce_no_cache = 1;
        if ((check_realm || LYValidate) != 0) {
            // 0x8083b2b
            LYPermitURL = 1;
        }
        // 0x8083b45
        return 0;
    }
    int32_t str = 0; // bp-28, 0x80834d3
    int32_t str3 = 0; // bp-32, 0x80834da
    int32_t str5 = 0; // bp-36, 0x80834e1
    int32_t v1 = LYUserAgent; // 0x80834e8
    int32_t v2 = v1 == 0 ? (int32_t)&g20 : v1;
    HTSACopy((char **)&str, (char *)v2);
    int32_t v3 = language; // 0x8083514
    int32_t v4 = v3 == 0 ? (int32_t)&g20 : v3;
    HTSACopy((char **)&str3, (char *)v4);
    int32_t v5 = pref_charset; // 0x8083540
    int32_t v6 = v5 == 0 ? (int32_t)&g20 : v5;
    HTSACopy((char **)&str5, (char *)v6);
    LYoptions();
    if (0x1000000 * keypad_mode >> 24 != keypad_mode) {
        goto lab_0x8083760;
    } else {
        // 0x8083582
        if (0x1000000 * user_mode >> 24 == user_mode) {
            goto lab_0x80835a6;
        } else {
            if ((char)user_mode == 0 || user_mode == 0) {
                goto lab_0x8083760;
            } else {
                goto lab_0x80835a6;
            }
        }
    }
  lab_0x8083760:;
    char v7 = 0; // 0x808376b
    if (g246 == 0 || g250 == 1) {
        goto lab_0x80837ca;
    } else {
        char v8 = HTcan_reparse_document(); // 0x8083778
        v7 = v8;
        if (v8 != 0) {
            goto lab_0x80837ca;
        } else {
            // 0x8083786
            v7 = v8;
            if (confirm_post_resub((char *)g245, (char *)curdoc, 2, 1) != 0) {
                goto lab_0x80837ca;
            } else {
                // 0x80837b1
                HTInfoMsg(gettext("Document will not be reloaded!"));
                goto lab_0x8083a3e;
            }
        }
    }
  lab_0x80837ca:
    // 0x80837ca
    copy_address(&newdoc, &curdoc);
    int32_t v9 = LYUserAgent; // 0x80837de
    int32_t str2 = v9 == 0 ? (int32_t)&g20 : v9;
    if (strcmp((char *)str, (char *)str2) != 0) {
        goto lab_0x808386e;
    } else {
        int32_t v10 = language; // 0x808380e
        int32_t str4 = v10 == 0 ? (int32_t)&g20 : v10;
        if (strcmp((char *)str3, (char *)str4) != 0) {
            goto lab_0x808386e;
        } else {
            int32_t v11 = pref_charset; // 0x808383e
            int32_t str6 = v11 == 0 ? (int32_t)&g20 : v11;
            if (strcmp((char *)str5, (char *)str6) == 0) {
                goto lab_0x80838e5;
            } else {
                goto lab_0x808386e;
            }
        }
    }
  lab_0x80835a6:;
    // 0x80835a6
    char * v12; // 0x808346e
    goto lab_0x808361e;
  lab_0x808386e:
    // 0x808386e
    if (strncmp((char *)g245, "http", 4) == 0) {
        // 0x80838de
        reloading = 1;
        goto lab_0x80838e5;
    } else {
        char v17 = *(char *)g245; // 0x8083894
        if (v17 != 108 == (v17 != 76)) {
            goto lab_0x80838e5;
        } else {
            // 0x80838a7
            if (strncasecomp((char *)g245, "lynxcgi:", 8) == 0) {
                // 0x80838de
                reloading = 1;
                goto lab_0x80838e5;
            } else {
                goto lab_0x80838e5;
            }
        }
    }
  lab_0x808361e:;
    int32_t v13 = LYUserAgent; // 0x808366a
    int32_t str7 = v13 == 0 ? (int32_t)&g20 : v13;
    if (strcmp((char *)str, (char *)str7) != 0) {
        goto lab_0x80836fe;
    } else {
        int32_t v14 = language; // 0x808369a
        int32_t str8 = v14 == 0 ? (int32_t)&g20 : v14;
        if (strcmp((char *)str3, (char *)str8) != 0) {
            goto lab_0x80836fe;
        } else {
            int32_t v15 = pref_charset; // 0x80836ca
            int32_t str9 = v15 == 0 ? (int32_t)&g20 : v15;
            if (strcmp((char *)str5, (char *)str9) == 0) {
                goto lab_0x8083a3e;
            } else {
                goto lab_0x80836fe;
            }
        }
    }
  lab_0x80835f9:
    // 0x80835f9
    if (strncasecomp(v12, "ftp:", 4) == 0) {
        goto lab_0x8083760;
    } else {
        goto lab_0x808361e;
    }
  lab_0x80838e5:
    // 0x80838e5
    if (HTisDocumentSource() != 0) {
        // 0x80838ee
        srcmode_for_next_retrieval(1);
    }
    // 0x80838fa
    if (reloading == 0) {
        // 0x8083905
        if (reparse_document() != 0) {
            // 0x808390e
            if (str != 0) {
                // 0x8083915
                free((int32_t *)str);
                str = 0;
            }
            // 0x8083927
            if (str3 != 0) {
                // 0x808392e
                free((int32_t *)str3);
                str3 = 0;
            }
            // 0x8083940
            if (str5 != 0) {
                // 0x8083947
                free((int32_t *)str5);
                str5 = 0;
            }
            // 0x8083b45
            return 0;
        }
    }
    if (v7 != 0) {
        // 0x808396c
        if (confirm_post_resub((char *)g245, (char *)curdoc, 2, 1) == 0) {
            // 0x8083997
            if (HTisDocumentSource() != 0) {
                // 0x80839a0
                srcmode_for_next_retrieval(0);
            }
            // 0x80839ac
            if (str != 0) {
                // 0x80839b3
                free((int32_t *)str);
                str = 0;
            }
            // 0x80839c5
            if (str3 != 0) {
                // 0x80839cc
                free((int32_t *)str3);
                str3 = 0;
            }
            // 0x80839de
            if (str5 != 0) {
                // 0x80839e5
                free((int32_t *)str5);
                str5 = 0;
            }
            // 0x8083b45
            return 0;
        }
    }
    // 0x8083a00
    HEAD_request = HTLoadedDocumentIsHEAD();
    HText_setNoCache(HTMainText);
    *(int32_t *)&g242 = (int32_t)g252;
    g241 = g251;
    LYforce_no_cache = 1;
    free_address(&curdoc);
    goto lab_0x8083a3e;
  lab_0x8083a3e:
    // 0x8083a3e
    if (str != 0) {
        // 0x8083a45
        free((int32_t *)str);
        str = 0;
    }
    // 0x8083a57
    if (str3 != 0) {
        // 0x8083a5e
        free((int32_t *)str3);
        str3 = 0;
    }
    // 0x8083a70
    if (str5 != 0) {
        // 0x8083a77
        free((int32_t *)str5);
        str5 = 0;
    }
    // 0x8083a89
    *refresh_screen = 1;
    // 0x8083b45
    return 0;
  lab_0x80836fe:
    // 0x80836fe
    if (strncmp((char *)g245, "http", 4) == 0) {
        goto lab_0x8083760;
    } else {
        char v16 = *(char *)g245; // 0x8083724
        if (v16 != 108 == (v16 != 76)) {
            goto lab_0x8083a3e;
        } else {
            // 0x808373b
            if (strncasecomp((char *)g245, "lynxcgi:", 8) != 0) {
                goto lab_0x8083a3e;
            } else {
                goto lab_0x8083760;
            }
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8083b4b - 0x8083b8d
// Line range:    3838 - 3844
void handle_NEXT_DOC(void) {
    // 0x8083b4b
    if (LYhist_next(&curdoc, &newdoc) == 0) {
        // 0x8083b77
        HTUserMsg(gettext("No next document present"));
    } else {
        // 0x8083b69
        free_address(&curdoc);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8083b8d - 0x8083d85
// Line range:    3849 - 3886
void handle_LYK_NEXT_LINK(int32_t c, int32_t * old_c, int32_t real_c) {
    int32_t v1 = g251; // 0x8083b93
    int32_t v2 = nlinks - 1; // 0x8083b9e
    if (v1 >= v2) {
        int32_t v3 = Newline;
        if (more_text != 0) {
            // 0x8083d49
            Newline = display_lines + v3;
            // 0x8083d83
            return;
        }
        if (v1 == v2 == v3 == 1) {
            // 0x8083d30
            set_curdoc_link(0);
            // 0x8083d83
            return;
        }
        // 0x8083d5d
        if (*old_c != real_c) {
            // 0x8083d67
            *old_c = real_c;
            HTInfoMsg(gettext("You are already at the end of this document."));
        }
        // 0x8083d83
        return;
    }
    // 0x8083ba9
    LYhighlight(0, v1, prev_target);
    int32_t v4 = g251; // 0x8083bc6
    int32_t v5 = 68 * v4; // 0x8083bd3
    if (*(int32_t *)(v5 + (int32_t)&g347) != 1) {
        // 0x8083cfa
        g251 = v4 + 1;
        // 0x8083d83
        return;
    }
    int32_t v6 = *(int32_t *)(v5 + (int32_t)&g354); // 0x8083bf3
    if (c == 9 != (*(int32_t *)(v6 + 8) == 9)) {
        // 0x8083cfa
        g251 = v4 + 1;
        // 0x8083d83
        return;
    }
    char * v7 = (char *)*(int32_t *)v6; // 0x8083c41
    int32_t v8 = v4 + 1; // 0x8083c49
    g251 = v8;
    if (v8 >= nlinks - 1) {
        // 0x8083d83
        return;
    }
    int32_t v9 = 68 * v8; // 0x8083c74
    while (*(int32_t *)(v9 + (int32_t)&g347) == 1) {
        int32_t v10 = *(int32_t *)(v9 + (int32_t)&g354); // 0x8083c94
        if (*(int32_t *)(v10 + 8) != 9) {
            // break -> 0x8083d83
            break;
        }
        // 0x8083ca6
        if (*(int32_t *)(v10 + 4) != *(int32_t *)(v6 + 4)) {
            // break -> 0x8083d83
            break;
        }
        // 0x8083cc7
        if (sametext((char *)*(int32_t *)v10, v7) == 0) {
            // break -> 0x8083d83
            break;
        }
        int32_t v11 = g251 + 1; // 0x8083c49
        g251 = v11;
        if (v11 >= nlinks - 1) {
            // break -> 0x8083d83
            break;
        }
        v9 = 68 * v11;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8083d85 - 0x8083df6
// Line range:    3890 - 3899
void handle_LYK_NEXT_PAGE(int32_t * old_c, int32_t real_c) {
    // 0x8083d85
    if (more_text != 0) {
        // 0x8083d96
        Newline += display_lines;
        // 0x8083df4
        return;
    }
    int32_t v1 = nlinks - 1; // 0x8083db5
    if (g251 < v1) {
        // 0x8083dbc
        set_curdoc_link(v1);
        // 0x8083df4
        return;
    }
    // 0x8083dce
    if (*old_c != real_c) {
        // 0x8083dd8
        *old_c = real_c;
        HTInfoMsg(gettext("You are already at the end of this document."));
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8083df6 - 0x8083ec2
// Line range:    3903 - 3920
char handle_LYK_NOCACHE(int32_t * old_c, int32_t real_c) {
    // 0x8083df6
    if (nlinks < 1) {
        // 0x8083ebc
        return 1;
    }
    int32_t v1 = 68 * g251; // 0x8083e16
    if (*(int32_t *)(v1 + (int32_t)&g347) != 1) {
        // 0x8083eaa
        LYforce_no_cache = 1;
        reloading = 1;
        // 0x8083ebc
        return 1;
    }
    int32_t v2 = *(int32_t *)(*(int32_t *)(v1 + (int32_t)&g354) + 8); // 0x8083e3c
    switch (v2) {
        case 5: {
        }
        case 13: {
        }
        case 12: {
            // 0x8083eaa
            LYforce_no_cache = 1;
            reloading = 1;
            // 0x8083ebc
            return 1;
        }
    }
    // 0x8083e7e
    if (*old_c != real_c) {
        // 0x8083e88
        *old_c = real_c;
        HTUserMsg(gettext("You are not on a form submission button or normal link."));
    }
    // 0x8083ebc
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8083ec2 - 0x8083fea
// Line range:    3925 - 3960
void handle_LYK_PREV_LINK(int32_t * arrowup, int32_t * old_c, int32_t real_c) {
    uint32_t v1 = g251; // 0x8083ec8
    if (v1 >= 1) {
        // 0x8083ed1
        set_curdoc_link(v1 - 1);
        // 0x8083fe8
        return;
    }
    // 0x8083ee6
    if (v1 == 0 == more_text == 0) {
        // 0x8083efa
        if (Newline == 1) {
            // 0x8083f04
            set_curdoc_link(nlinks - 1);
            // 0x8083fe8
            return;
        }
    }
    // 0x8083f19
    if (g252 < (char *)2) {
        // 0x8083fc2
        if (*old_c != real_c) {
            // 0x8083fcc
            *old_c = real_c;
            HTInfoMsg(gettext("You are already at the beginning of this document."));
        }
        // 0x8083fe8
        return;
    }
    int32_t v2 = Newline;
    int32_t v3 = display_lines;
    int32_t v4 = v2 > v3 ? v3 : v2 - 1;
    Newline = v2 - v4;
    if (v1 != 0 || v4 >= v3 || nlinks < 1 || v4 - 1 + g346 > v3) {
        // 0x8083fb7
        *arrowup = 1;
        // 0x8083fe8
        return;
    }
    // 0x8083f90
    g241 = HText_LinksInLines(HTMainText, 1, v4) - 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8083fea - 0x8084392
// Line range:    3967 - 4068
int32_t handle_PREV_DOC(int32_t * cmd, int32_t * old_c, int32_t real_c) {
    // 0x8083fea
    int32_t result; // 0x8083fea
    if (nhist < 1) {
        // 0x8084348
        if (child_lynx == 1) {
            // 0x8084389
            return 1;
        }
        // 0x808435c
        result = 0;
        if (*old_c != real_c) {
            // 0x8084366
            *old_c = real_c;
            HTUserMsg(gettext("You are already at the first document"));
            result = 0;
        }
      lab_0x8084389:
        // 0x8084389
        return result;
    }
    // 0x8083ffe
    HTLastConfirmCancelled();
    int32_t v1 = nhist; // 0x80842fa
    int32_t v2; // 0x8083fea
    char v3; // 0x8083fea
    char v4; // 0x8083fea
    if (v1 >= 0 == (v1 != 0)) {
        // 0x8084010
        v2 = v1;
        v3 = 1;
        while (true) {
          lab_0x8084010:
            // 0x8084010
            v4 = v3;
            int32_t v5 = 44 * v2 - 44 + (int32_t)history; // 0x8084025
            if (*(int32_t *)(v5 + 8) == 0) {
                // break -> 0x8084307
                break;
            }
            char * v6 = (char *)*(int32_t *)(v5 + 4); // bp-40, 0x808404a
            int32_t * v7 = HTAnchor_findAddress((int32_t *)&v6); // 0x80840d7
            if (HTAnchor_safe(v7) != 0) {
                // break -> 0x8084307
                break;
            }
            // 0x80840f2
            if (HTAnchor_document(v7) != NULL) {
                // 0x808416b
                if (LYresubmit_posts == 0) {
                    // break -> 0x8084307
                    break;
                }
                // 0x8084184
                if (are_different((int32_t *)((int32_t)history - 44 + 44 * nhist), &curdoc) == 0) {
                    // 0x80841ac
                    if (are_different((int32_t *)((int32_t)history - 44 + 44 * nhist), &newdoc) == 0) {
                        // break -> 0x8084307
                        break;
                    }
                }
                int32_t v8 = *(int32_t *)((int32_t)history - 44 + 44 * nhist); // 0x80841ec
                if (confirm_post_resub(v6, (char *)v8, 2, 2) != 0) {
                    // break -> 0x8084307
                    break;
                }
            } else {
                // 0x8084106
                if (strncasecomp(v6, "LYNXIMGMAP:", 11) != 0) {
                    int32_t v9 = *(int32_t *)((int32_t)history - 44 + 44 * nhist); // 0x808413d
                    if (confirm_post_resub(v6, (char *)v9, 0, 0) != 0) {
                        // 0x80842f1
                        LYforce_no_cache = 1;
                        goto lab_0x8084307;
                    }
                }
            }
            // 0x8084215
            if (HTLastConfirmCancelled() != 0) {
                // 0x808421e
                if (v4 != 0 || g253 == 0) {
                    // 0x808423b
                    *cmd = 69;
                    result = 2;
                    return result;
                } else {
                    // 0x808422f
                    free_address(&curdoc);
                    // 0x808423b
                    *cmd = 69;
                    result = 2;
                    return result;
                }
            }
            // 0x8084250
            if (nhist == 1) {
                // 0x808425a
                HTInfoMsg(gettext("Cancelled!!!"));
                *old_c = 0;
                *cmd = 69;
                result = 2;
                return result;
            }
            // 0x808428c
            HTUserMsg2(gettext("Skipping %s"), v6);
            LYpop(&curdoc);
            while (nhist >= 2) {
                // 0x80842bd
                if (are_different((int32_t *)(44 * nhist - 44 + (int32_t)history), &curdoc) != 0) {
                    // 0x80842bd
                    goto lab_0x80842e5;
                }
                LYpop(&curdoc);
            }
            goto lab_0x80842e5;
        }
        goto lab_0x8084307;
    } else {
        goto lab_0x8084314;
    }
  lab_0x80842e5:;
    int32_t v10 = nhist; // 0x80842fa
    v2 = v10;
    v3 = 0;
    if (v10 >= 0 != v10 != 0) {
        goto lab_0x808430d;
    }
    goto lab_0x8084010;
  lab_0x8084314:
    // 0x8084314
    LYhist_prev_register(&curdoc);
    free_address(&newdoc);
    if (lynx_edit_mode != 0 && LYAutoUncacheDirLists >= 2) {
        // 0x8084341
        HTuncache_current_document();
    }
    // 0x8084389
    return 0;
  lab_0x8084307:
    if (v4 == 0) {
      lab_0x808430d:
        // 0x808430d
        g253 = 0;
    }
    goto lab_0x8084314;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8084392 - 0x80843f5
// Line range:    4072 - 4081
void handle_LYK_PREV_PAGE(int32_t * old_c, int32_t real_c) {
    uint32_t v1 = Newline; // 0x8084398
    if (v1 >= 2) {
        // 0x80843a2
        Newline = v1 - display_lines;
        // 0x80843f3
        return;
    }
    // 0x80843b6
    if (g251 >= 1) {
        // 0x80843bf
        set_curdoc_link(0);
        // 0x80843f3
        return;
    }
    // 0x80843cd
    if (*old_c != real_c) {
        // 0x80843d7
        *old_c = real_c;
        HTInfoMsg(gettext("You are already at the beginning of this document."));
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80843f5 - 0x8084506
// Line range:    4086 - 4111
void handle_LYK_PRINT(char * ForcePush, int32_t * old_c, int32_t real_c) {
    // 0x80843f5
    if (LYValidate != 0) {
        // 0x8084406
        if (*old_c != real_c) {
            // 0x8084414
            *old_c = real_c;
            HTUserMsg(gettext("The 'p'rint command is currently disabled."));
        }
        // 0x8084504
        return;
    }
    // 0x8084435
    if (LYIsUIPage3((char *)g245, 2, 1) != 0) {
        // 0x8084504
        return;
    }
    int32_t v1 = HText_getNumOfLines(); // 0x808445a
    if (print_options((char **)&g235, (char *)g245, v1) < 0) {
        // 0x8084504
        return;
    }
    // 0x8084481
    LYRegisterUIPage((char *)g235, 2);
    char * v2 = gettext("Printing Options"); // 0x808449d
    HTSACopy((char **)&newdoc, v2);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x80844c7
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x80844de
    g239 = 0;
    g240 = 0;
    *ForcePush = 1;
    if (check_realm != 0) {
        // 0x80844fd
        LYPermitURL = 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8084506 - 0x80845ae
// Line range:    4114 - 4134
char handle_LYK_QUIT(void) {
    char * v1 = gettext("Are you sure you want to quit?");
    int32_t v2; // 0x8084506
    if (LYQuitDefaultYes != 1) {
        // 0x8084538
        v2 = HTConfirmDefault(v1, 0);
    } else {
        // 0x8084517
        v2 = HTConfirmDefault(v1, 1);
    }
    // 0x8084557
    char result; // 0x8084506
    if (LYQuitDefaultYes != 1) {
        // 0x8084584
        result = 1;
        if (v2 != 1) {
            // 0x8084590
            HTInfoMsg(gettext("Excellent!!!"));
            result = 0;
        }
        // 0x80845a8
        return result;
    }
    // 0x8084562
    result = 1;
    if (v2 == 0) {
        // 0x808456e
        HTInfoMsg(gettext("Excellent!!!"));
        result = 0;
    }
    // 0x80845a8
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80845ae - 0x808463f
// Line range:    4137 - 4147
char handle_LYK_RAW_TOGGLE(int32_t * cmd) {
    // 0x80845ae
    if (HTLoadedDocumentCharset() != NULL) {
        // 0x80845bd
        HTUserMsg(gettext("charset for this document specified explicitly, sorry..."));
        // 0x8084639
        return 0;
    }
    // 0x80845d7
    LYUseDefaultRawMode = LYUseDefaultRawMode == 0;
    char * v1; // 0x80845ae
    if (LYRawMode == 0) {
        // 0x8084604
        v1 = gettext("Raw 8-bit or CJK mode toggled ON!  Reloading...");
    } else {
        // 0x80845f3
        v1 = gettext("Raw 8-bit or CJK mode toggled OFF!  Reloading...");
    }
    // 0x8084613
    HTUserMsg(v1);
    HTMLSetCharacterHandling(current_char_set);
    // 0x8084639
    return reparse_or_reload(cmd);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808463f - 0x80846fc
// Line range:    4150 - 4198
void handle_LYK_RELOAD(int32_t real_cmd) {
    // 0x808463f
    if (g246 != 0 && g250 != 1) {
        char * v1 = gettext("Document from Form with POST content.  Resubmit?"); // 0x8084660
        if (HTConfirm(v1) == 0) {
            // 0x8084671
            HTInfoMsg(gettext("Cancelled!!!"));
            // 0x80846fa
            return;
        }
    }
    // 0x8084687
    if (HTisDocumentSource() != 0) {
        int32_t v2 = HTMainText_Get_UCLYhndl(); // 0x8084690
        forced_UCLYhdnl = v2;
        if (v2 >= 0) {
            // 0x80846a3
            force_old_UCLYhndl_on_reload = 1;
        }
        // 0x80846aa
        srcmode_for_next_retrieval(1);
    }
    // 0x80846b6
    HEAD_request = HTLoadedDocumentIsHEAD();
    HText_setNoCache(HTMainText);
    *(int32_t *)&g242 = (int32_t)g252;
    g241 = g251;
    free_address(&curdoc);
    if (real_cmd == 12) {
        // 0x80846f3
        reloading = 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80846fc - 0x8084757
// Line range:    4202 - 4212
void handle_LYK_REMOVE(char * refresh_screen) {
    // 0x80846fc
    if (lynx_edit_mode == 0 || nlinks < 1 || no_dired_support != 0) {
        // 0x8084755
        return;
    }
    // 0x8084721
    local_remove(&curdoc);
    if (LYAutoUncacheDirLists >= 1) {
        // 0x808473e
        do_cleanup_after_delete();
        // 0x8084755
        return;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8084757 - 0x80847b2
// Line range:    4216 - 4221
void handle_LYK_RIGHT_LINK(void) {
    uint32_t v1 = g251; // 0x808475d
    if (v1 >= nlinks - 1) {
        // 0x80847b0
        return;
    }
    int32_t v2 = 68 * v1; // 0x808477c
    int32_t v3 = *(int32_t *)(v2 + (int32_t)&g346 + 68); // 0x8084796
    if (*(int32_t *)(v2 + (int32_t)&g346) == v3) {
        // 0x80847a0
        set_curdoc_link(v1 + 1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80847b2 - 0x8084844
// Line range:    4226 - 4251
void handle_LYK_SHELL(char * refresh_screen, int32_t * old_c, int32_t real_c) {
    // 0x80847b2
    if (no_shell != 0) {
        // 0x808481c
        if (*old_c != real_c) {
            // 0x8084826
            *old_c = real_c;
            HTUserMsg(gettext("Spawning is currently disabled."));
        }
        // 0x8084842
        return;
    }
    // 0x80847c3
    stop_curses();
    printf("%s\r\n", gettext("Spawning your default shell.  Use 'exit' to return to Lynx.\n"));
    int32_t v1 = g232; // 0x80847eb
    if (g232 == 0) {
        char * v2 = LYSysShell(); // 0x80847ed
        HTSACopy((char **)&g232, v2);
        v1 = g232;
    }
    // 0x8084802
    LYSystem((char *)v1);
    start_curses();
    *refresh_screen = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8084844 - 0x808492d
// Line range:    4254 - 4282
void handle_LYK_SOFT_DQUOTES(void) {
    // 0x8084844
    if (HTcan_reparse_document() != 0) {
        goto lab_0x80848df;
    } else {
        // 0x8084857
        if (g246 == 0 || g250 == 1) {
            goto lab_0x80848aa;
        } else {
            // 0x808486b
            if (confirm_post_resub((char *)g245, NULL, 1, 1) != 0) {
                goto lab_0x80848aa;
            } else {
                // 0x8084894
                HTInfoMsg(gettext("Document will not be reloaded!"));
                goto lab_0x80848df;
            }
        }
    }
  lab_0x80848df:;
    char v1 = soft_dquotes; // 0x80848df
    soft_dquotes = v1 == 0;
    char * v2; // 0x8084844
    if (v1 != 0) {
        // 0x808490c
        v2 = gettext("Soft double-quote parsing OFF!");
    } else {
        // 0x80848fb
        v2 = gettext("Soft double-quote parsing ON!");
    }
    // 0x808491b
    HTUserMsg(v2);
    reparse_document();
  lab_0x80848aa:
    // 0x80848aa
    HText_setNoCache(HTMainText);
    move_address(&newdoc, &curdoc);
    *(int32_t *)&g242 = (int32_t)g252;
    g241 = g251;
    goto lab_0x80848df;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808492d - 0x8084ba4
// Line range:    4299 - 4349
int32_t wrap_reparse_document(void) {
    int32_t v1 = g251; // 0x808493e
    int32_t v2 = -1; // 0x808493c
    if (nlinks >= 1 && v1 >= 0) {
        // 0x8084947
        v2 = *(int32_t *)(68 * v1 + (int32_t)&g349);
    }
    int32_t v3 = HText_getAbsLineNumber(HTMainText, v2); // 0x808497e
    int32_t v4 = g251; // 0x80849a0
    int32_t v5 = -1; // 0x808499e
    if (nlinks >= 1 && v4 >= 0) {
        // 0x80849a9
        v5 = *(int32_t *)(68 * v4 + (int32_t)&g348);
    }
    // 0x80849ca
    if (WWW_TraceFlag != 0) {
        // 0x80849db
        fprintf(TraceFP(), "original anchor %d, topline %d, link %d, offset %d\n", v2, v3, v4, v5);
    }
    unsigned char result = reparse_document(); // 0x8084a13
    if (v5 < 0 || result == 0) {
        // 0x8084b9a
        return result;
    }
    int32_t v6 = HText_closestAnchor(HTMainText, v5); // 0x8084a42
    int32_t v7 = HText_getAbsLineNumber(HTMainText, v6); // 0x8084a5a
    if (WWW_TraceFlag != 0) {
        // 0x8084a6d
        fprintf(TraceFP(), "old anchor %d -> new anchor %d\n", v2, v6);
    }
    int32_t v8 = v3 - Newline + 1; // 0x8084991
    int32_t v9 = HText_getPreferredTopLine(HTMainText, v7 - (v7 - v8 >= 0 ? v8 : v7)); // 0x8084abf
    int32_t v10 = v9 + 1; // 0x8084ac4
    if (WWW_TraceFlag != 0) {
        // 0x8084ad5
        fprintf(TraceFP(), "preferred top %d\n", v10);
    }
    // 0x8084af3
    if (v10 == Newline) {
        // 0x8084b90
        g241 = g251;
        // 0x8084b9a
        return result;
    }
    // 0x8084b01
    Newline = v10;
    int32_t v11 = HText_anchorRelativeTo(HTMainText, v9, v6); // 0x8084b23
    g241 = v11;
    g251 = v11;
    if (WWW_TraceFlag != 0) {
        int32_t v12 = HText_locateAnchor(HTMainText, v6); // 0x8084b52
        fprintf(TraceFP(), "adjusted anchor %d, topline %d, link %d, offset %d\n", v6, v10, g251, v12);
    }
    // 0x8084b9a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8084ba4 - 0x8084d48
// Line range:    4353 - 4412
void handle_LYK_SOURCE(char ** ownerS_address_p) {
    char v1 = 0; // 0x8084bb5
    if (g246 != 0 && g250 != 1) {
        char v2 = HTcan_reparse_document(); // 0x8084bca
        v1 = v2;
        if (v2 == 0) {
            // 0x8084bd8
            char v3; // 0x8084ba4
            if (g249 == 0) {
                // 0x8084bff
                v3 = confirm_post_resub((char *)g245, (char *)curdoc, 1, 1);
            } else {
                // 0x8084be3
                v3 = HTConfirm(gettext("Document from Form with POST content.  Resubmit?"));
            }
            // 0x8084c2c
            v1 = v2;
            if (v3 == 0) {
                // 0x8084c32
                HTInfoMsg(gettext("Cancelled!!!"));
                // 0x8084d46
                return;
            }
        }
    }
    // 0x8084c4b
    if (HTisDocumentSource() == 0) {
        // 0x8084c62
        if (HText_getOwner() != NULL) {
            // 0x8084c6b
            HTSACopy(ownerS_address_p, HText_getOwner());
        }
        // 0x8084c7f
        LYUCPushAssumed(HTMainAnchor);
        srcmode_for_next_retrieval(1);
    } else {
        // 0x8084c54
        srcmode_for_next_retrieval(-1);
    }
    // 0x8084c98
    if (wrap_reparse_document() == 0) {
        if (v1 != 0) {
            // 0x8084d02
            srcmode_for_next_retrieval(0);
            LYUCPopAssumed();
            // 0x8084d46
            return;
        }
        // 0x8084d15
        if (curdoc != 0) {
            // 0x8084d1e
            HTSACopy((char **)&newdoc, (char *)curdoc);
        }
        // 0x8084d33
        free_address(&curdoc);
        LYforce_no_cache = 1;
        // 0x8084d46
        return;
    }
    int32_t * v4 = HTAtom_for("www/present"); // 0x8084ca8
    *(int32_t *)&HTOutputFormat = (int32_t)v4;
    if (psrc_view != 0) {
        // 0x8084cbd
        HTMark_asSource();
    }
    // 0x8084cc2
    psrc_view = 0;
    char * v5 = *ownerS_address_p;
    if (v5 != NULL) {
        // 0x8084cd2
        free((int32_t *)v5);
        *(int32_t *)ownerS_address_p = 0;
    }
    // 0x8084ce8
    LYUCPopAssumed();
    HTMLSetCharacterHandling(current_char_set);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8084d48 - 0x8084ea4
// Line range:    4415 - 4467
void handle_LYK_SWITCH_DTD(void) {
    char v1 = HTcan_reparse_document(); // 0x8084d52
    if (v1 != 0) {
        goto lab_0x8084e0c;
    } else {
        // 0x8084d64
        if (g246 == 0 || g250 == 1) {
            goto lab_0x8084db7;
        } else {
            // 0x8084d78
            if (confirm_post_resub((char *)g245, NULL, 1, 1) != 0) {
                goto lab_0x8084db7;
            } else {
                // 0x8084da1
                HTInfoMsg(gettext("Document will not be reloaded!"));
                goto lab_0x8084e0c;
            }
        }
    }
  lab_0x8084e0c:;
    int32_t v2 = Old_DTD; // 0x8084e0c
    Old_DTD = v2 == 0;
    HTSwitchDTD((int32_t)(v2 != 0));
    char * v3; // 0x8084d48
    if (Old_DTD == 0) {
        // 0x8084e4d
        v3 = gettext("Now using SortaSGML parsing of HTML!");
    } else {
        // 0x8084e3c
        v3 = gettext("Now using TagSoup parsing of HTML.");
    }
    // 0x8084e5c
    HTUserMsg(v3);
    if (v1 == 0) {
        // 0x8084ea2
        return;
    }
    // 0x8084e6d
    if (HTisDocumentSource() != 0 && LYPreparsedSource != 0) {
        // 0x8084e81
        srcmode_for_next_retrieval(1);
    }
    // 0x8084e8d
    if (reparse_document() == 0) {
        // 0x8084e96
        srcmode_for_next_retrieval(0);
    }
  lab_0x8084db7:
    // 0x8084db7
    if (HTisDocumentSource() != 0 && LYPreparsedSource != 0) {
        // 0x8084dcb
        srcmode_for_next_retrieval(1);
    }
    // 0x8084dd7
    HText_setNoCache(HTMainText);
    move_address(&newdoc, &curdoc);
    *(int32_t *)&g242 = (int32_t)g252;
    g241 = g251;
    goto lab_0x8084e0c;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8084ea4 - 0x8085113
// Line range:    4471 - 4515
void handle_LYK_TAG_LINK(void) {
    // 0x8084ea4
    if (lynx_edit_mode == 0 || nlinks < 1 || no_dired_support != 0 || strcmp(LYGetHiliteStr(g251, 0), "..") == 0) {
        // 0x8085111
        return;
    }
    char * str = LYGetHiliteStr(g251, 0);
    if (dir_list_style != 2) {
        // 0x8084f3b
        if (strncmp(str, "Up to ", 6) == 0) {
            // 0x8085111
            return;
        }
    } else {
        // 0x8084f0c
        if (strcmp(str, "../") == 0) {
            // 0x8085111
            return;
        }
    }
    char * v1 = NULL; // bp-16, 0x8084f78
    char * v2 = (char *)tagged; // 0x8084f83
    while (v2 != NULL) {
        int32_t v3 = *(int32_t *)((int32_t)v2 + 4); // 0x8084fff
        if (v3 == 0) {
            // break -> 0x808501c
            break;
        }
        int32_t str3 = *(int32_t *)v3; // 0x808500e
        *(int32_t *)&v1 = str3;
        if (str3 == 0) {
            goto lab_0x8085033;
        }
        int32_t str2 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x8084f97
        v2 = (char *)v3;
        if (strcmp((char *)str2, (char *)str3) == 0) {
            // 0x8084fad
            HTList_removeObject(tagged, v1);
            if (v1 == NULL) {
                // 0x8084fdf
                tagflag(0, g251);
                goto lab_0x808509b;
            } else {
                // 0x8084fcd
                free((int32_t *)v1);
                v1 = NULL;
                // 0x8084fdf
                tagflag(0, g251);
                goto lab_0x808509b;
            }
        }
    }
    // 0x808501c
    *(int32_t *)&v1 = 0;
  lab_0x8085033:
    // 0x8085033
    if (tagged == NULL) {
        int32_t * v4 = HTList_new(); // 0x808503c
        *(int32_t *)&tagged = (int32_t)v4;
    }
    // 0x8085046
    v1 = NULL;
    int32_t v5 = *(int32_t *)(68 * g251 + (int32_t)&links); // 0x808505c
    HTSACopy(&v1, (char *)v5);
    HTList_addObject(tagged, v1);
    tagflag(1, g251);
    goto lab_0x808509b;
  lab_0x808509b:;
    int32_t v6 = nlinks - 1; // 0x80850a6
    if (g251 < v6) {
        // 0x80850ad
        set_curdoc_link(g251 + 1);
        // 0x8085111
        return;
    }
    int32_t v7 = Newline;
    if (more_text != 0) {
        // 0x80850ff
        Newline = display_lines + v7;
        // 0x8085111
        return;
    }
    if (g251 == v6 == v7 == 1) {
        // 0x80850e6
        set_curdoc_link(0);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8085113 - 0x808513b
// Line range:    4519 - 4524
void handle_LYK_TOGGLE_HELP(void) {
    // 0x8085113
    if (user_mode == 0) {
        // 0x8085122
        toggle_novice_line();
        noviceline((int32_t)more_text);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808513b - 0x808521a
// Line range:    4530 - 4549
void handle_LYK_TOOLBAR(char * try_internal, char * force_load, int32_t * old_c, int32_t real_c) {
    char * cp = NULL; // bp-12, 0x8085141
    char v1 = HText_hasToolbar(HTMainText); // 0x8085150
    int32_t v2 = *old_c;
    if (v1 == 0) {
        if (v2 != real_c) {
            // 0x8085167
            *old_c = real_c;
            HTUserMsg(gettext("Document has no Toolbar links or Banner."));
        }
        // 0x8085218
        return;
    }
    if (v2 == real_c) {
        // 0x8085218
        return;
    }
    // 0x8085196
    *old_c = real_c;
    char * v3 = trimPoundSelector((char *)g245); // 0x80851a6
    HTSprintf0(&cp, "%s#%s", g245, LYToolbarName);
    if (v3 != NULL) {
        // 0x80851da
        *v3 = 35;
    }
    // 0x80851e0
    set_address(&newdoc, cp);
    if (cp != NULL) {
        // 0x80851fa
        free((int32_t *)cp);
        cp = NULL;
    }
    // 0x808520c
    *try_internal = 1;
    *force_load = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808521a - 0x8085327
// Line range:    4552 - 4595
void handle_LYK_TRACE_LOG(char * trace_flag_ptr) {
    // 0x808521a
    if (LYTraceLogFP == NULL) {
        // 0x8085229
        HTUserMsg(gettext("No trace log has been started for this session."));
        // 0x8085325
        return;
    }
    // 0x8085242
    if (LYIsUIPage3((char *)g245, 13, 1) != 0 || LYReopenTracelog(trace_flag_ptr) == 0) {
        // 0x8085325
        return;
    }
    // 0x808527a
    LYLocalFileToURL((char **)&g235, (char *)LYTraceLogPath);
    LYRegisterUIPage((char *)g235, 13);
    char * v1 = gettext("Lynx Trace Log"); // 0x80852ab
    HTSACopy((char **)&newdoc, v1);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x80852d5
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x80852ec
    g239 = 0;
    g240 = 0;
    g243 = 0;
    if ((check_realm || LYValidate) != 0) {
        // 0x8085317
        LYPermitURL = 1;
    }
    // 0x808531e
    LYforce_no_cache = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8085327 - 0x80853f2
// Line range:    4599 - 4620
void handle_LYK_UPLOAD(void) {
    // 0x8085327
    if (LYIsUIPage3((char *)g245, 10, 1) != 0 || lynx_edit_mode == 0 || no_dired_support != 0) {
        // 0x80853f0
        return;
    }
    // 0x8085370
    LYUpload_options((char **)&g235, (char *)g245);
    char * v1 = gettext("Upload Options"); // 0x808538c
    HTSACopy((char **)&newdoc, v1);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x80853b6
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x80853cd
    g239 = 0;
    g240 = 0;
    g243 = 0;
    if (LYAutoUncacheDirLists >= 1) {
        // 0x80853eb
        HTuncache_current_document();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80853f2 - 0x80854ce
// Line range:    4627 - 4646
void handle_LYK_UP_xxx(int32_t * arrowup, int32_t * old_c, int32_t real_c, int32_t scroll_by) {
    // 0x80853f2
    if (Newline < 2) {
        // 0x80854a2
        if (*old_c != real_c) {
            // 0x80854ac
            *old_c = real_c;
            HTInfoMsg(gettext("You are already at the beginning of this document."));
        }
        // 0x80854c8
        return;
    }
    int32_t v1 = Newline - scroll_by; // 0x808540c
    int32_t v2 = v1 >= 0 == (v1 != 0) ? scroll_by : Newline - 1;
    int32_t v3 = Newline - v2; // 0x8085423
    Newline = v3;
    if (nlinks < 1 || g251 < 0) {
        // 0x80854c8
        return;
    }
    int32_t v4 = *(int32_t *)(68 * g251 + (int32_t)&g346); // 0x8085454
    if (v4 + v2 > display_lines) {
        // 0x8085497
        *arrowup = 1;
    } else {
        // 0x8085468
        g241 = HText_LinksInLines(HTMainText, v3, v2) + g251;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80854ce - 0x8085502
// Line range:    4651 - 4653
void handle_LYK_UP_HALF(int32_t * arrowup, int32_t * old_c, int32_t real_c) {
    int32_t v1 = display_lines; // 0x80854d4
    handle_LYK_UP_xxx(arrowup, old_c, real_c, v1 + (int32_t)(v1 < 0) >> 1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8085502 - 0x80856ff
// Line range:    4659 - 4704
void handle_LYK_UP_LINK(int32_t * follow_col, int32_t * arrowup, int32_t * old_c, int32_t real_c) {
    // 0x8085502
    if (g251 < 1) {
        goto lab_0x808561c;
    } else {
        int32_t v1 = *(int32_t *)(68 * g251 + (int32_t)&g346); // 0x808552b
        if (g346 != v1) {
            goto lab_0x808555f;
        } else {
            // 0x8085535
            if (HText_LinksInLines(HTMainText, 1, Newline - 1) != 0) {
                goto lab_0x808561c;
            } else {
                goto lab_0x808555f;
            }
        }
    }
  lab_0x808561c:;
    int32_t v2 = Newline; // 0x808562a
    if (g252 < (char *)2 || v2 < 2) {
        // 0x80856d3
        if (*old_c != real_c) {
            // 0x80856dd
            *old_c = real_c;
            HTInfoMsg(gettext("You are already at the beginning of this document."));
        }
        // 0x80856f9
        return;
    }
    int32_t v3 = display_lines;
    int32_t v4 = v2 > v3 ? v3 : v2 - 1;
    Newline = v2 - v4;
    if (v4 >= v3 || nlinks < 1 || g251 < 0 || v4 - 1 + g346 > v3) {
        // 0x80856c8
        *arrowup = 1;
        // 0x80856f9
        return;
    }
    // 0x80856a1
    g241 = HText_LinksInLines(HTMainText, 1, v4) - 1;
  lab_0x808555f:;
    int32_t v5 = *follow_col; // 0x8085562
    int32_t v6 = v5; // 0x8085567
    if (v5 == -1) {
        char * str = LYGetHiliteStr(g251, 0); // 0x8085579
        int32_t v7 = *(int32_t *)(68 * g251 + (int32_t)&g345); // 0x8085590
        *follow_col = v7;
        v6 = v7;
        if (str != NULL) {
            int32_t v8 = strlen(str) / 2 + v7; // 0x80855b5
            *follow_col = v8;
            v6 = v8;
        }
    }
    uint32_t v9 = find_link_near_col(v6, -1); // 0x80855cf
    if (v9 >= 0) {
        // 0x80855dd
        set_curdoc_link(v9);
        // 0x80856f9
        return;
    }
    // 0x80855ed
    if (*old_c != real_c) {
        // 0x80855fb
        *old_c = real_c;
        HTUserMsg(gettext("There are no links above this line of the document."));
    }
    // 0x80856f9
    return;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80856ff - 0x8085728
// Line range:    4709 - 4711
void handle_LYK_UP_TWO(int32_t * arrowup, int32_t * old_c, int32_t real_c) {
    // 0x80856ff
    handle_LYK_UP_xxx(arrowup, old_c, real_c, 2);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8085728 - 0x808586c
// Line range:    4716 - 4760
void handle_LYK_VIEW_BOOKMARK(char * refresh_screen, int32_t * old_c, int32_t real_c) {
    // 0x8085728
    if (LYValidate != 0) {
        // 0x8085739
        if (*old_c != real_c) {
            // 0x8085747
            *old_c = real_c;
            HTUserMsg(gettext("Bookmark features are currently disabled."));
        }
        // 0x808586a
        return;
    }
    char * str = get_bookmark_filename((char **)&g235); // 0x808576f
    if (str == NULL) {
        // 0x8085830
        if (*old_c == real_c) {
            // 0x808586a
            return;
        }
        // 0x808583a
        *old_c = real_c;
        LYMBM_statusline(gettext("Unable to open bookmark file, use 'a' to save a link first"));
        LYSleepAlert();
        if (LYMultiBookmarks != 0) {
            // 0x8085864
            *refresh_screen = 1;
        }
        // 0x808586a
        return;
    }
    // 0x8085781
    if (*str != 0) {
        // 0x808578b
        if (strcmp(str, " ") != 0) {
            // 0x80857a2
            if (strcmp((char *)g245, (char *)g235) != 0) {
                // 0x80857d5
                LYforce_no_cache = 1;
                char * v1 = gettext("Bookmark file"); // 0x80857e3
                HTSACopy((char **)&newdoc, v1);
                HTSACopy(&g238, (char *)BookmarkPage);
                LYFreePostData(&newdoc);
                g239 = 0;
                g240 = 0;
                g243 = 0;
                // 0x808586a
                return;
            }
        }
    }
    // 0x80857bd
    if (LYMultiBookmarks != 0) {
        // 0x80857ca
        *refresh_screen = 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808586c - 0x8085987
// Line range:    4764 - 4799
char handle_LYK_VLINKS(int32_t * cmd, char * newdoc_link_is_absolute) {
    // 0x808586c
    if (LYIsUIPage3((char *)g245, 5, 1) != 0) {
        // 0x8085893
        *cmd = 37;
        // 0x8085981
        return 1;
    }
    int32_t v1 = LYShowVisitedLinks((char **)&g235); // 0x80858ac
    if (v1 < 0) {
        // 0x80858ba
        HTUserMsg(gettext("No previously visited links available!"));
        // 0x8085981
        return 0;
    }
    char * v2 = gettext("Visited Links Page"); // 0x80858de
    HTSACopy((char **)&newdoc, v2);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x8085908
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x808591f
    g239 = 0;
    g240 = 0;
    g243 = 0;
    if (v1 >= 1) {
        // 0x808593a
        *newdoc_link_is_absolute = 1;
        g241 = v1 - 1;
    }
    // 0x808594b
    if ((check_realm || LYValidate) != 0) {
        // 0x8085961
        LYPermitURL = 1;
        HTSACopy((char **)&lynxlinksfile, (char *)g235);
    }
    // 0x8085981
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8085987 - 0x8085b7b
// Line range:    4803 - 4856
void handle_LYK_WHEREIS(int32_t cmd, char * refresh_screen) {
    // 0x8085987
    bool v1; // 0x8085987
    int32_t v2; // 0x8085987
    int32_t oldcur; // bp-20, 0x8085987
    char v3; // 0x8085987
    if (prev_target[0] == 0) {
        goto lab_0x80859e3;
    } else {
        // 0x8085999
        if (HText_pageHasPrevTarget() == 0) {
            goto lab_0x80859e3;
        } else {
            // 0x80859ce
            oldcur = 0;
            HTSACopy((char **)&oldcur, prev_target);
            v1 = false;
            v2 = g251;
            v3 = 1;
            goto lab_0x80859f6;
        }
    }
  lab_0x80859e3:
    // 0x80859e3
    oldcur = 0;
    HTSACopy((char **)&oldcur, (char *)&g20);
    v1 = true;
    v2 = g251;
    v3 = 0;
    goto lab_0x80859f6;
  lab_0x80859f6:;
    // 0x80859f6
    int32_t v4; // 0x8085987
    if (cmd != 51) {
        // 0x8085a09
        v4 = cmd != 53 ? -1 : 1;
    } else {
        // 0x8085a03
        prev_target[0] = 0;
        v4 = 0;
    }
    char v5 = textsearch(&curdoc, prev_target, 1023, v4); // 0x8085a4c
    if (www_search_result < 0) {
        goto lab_0x8085a77;
    } else {
        // 0x8085a5d
        if (www_search_result == (int32_t)g252) {
            goto lab_0x8085a77;
        } else {
            // 0x8085a6c
            *refresh_screen = 1;
            goto lab_0x8085b5c;
        }
    }
  lab_0x8085a77:
    if (v5 != 0) {
        if (!v1) {
            // 0x8085aa2
            if (www_search_result != (int32_t)g252) {
                goto lab_0x8085b12;
            } else {
                int32_t v6 = g251; // 0x8085ab1
                if (nlinks < 1 || v6 < 0 || v6 != v2) {
                    goto lab_0x8085b12;
                } else {
                    // 0x8085acd
                    if (*(int32_t *)(68 * v6 + (int32_t)&g346) < display_lines / 3) {
                        goto lab_0x8085b12;
                    } else {
                        // 0x8085b0a
                        *refresh_screen = 1;
                        goto lab_0x8085b5c;
                    }
                }
            }
        } else {
            // 0x8085a97
            *refresh_screen = 1;
            goto lab_0x8085b5c;
        }
    } else {
        // 0x8085a7d
        *refresh_screen = v3;
        goto lab_0x8085b5c;
    }
  lab_0x8085b5c:
    // 0x8085b5c
    if (oldcur != 0) {
        // 0x8085b63
        free((int32_t *)oldcur);
        oldcur = 0;
    }
  lab_0x8085b12:
    // 0x8085b12
    if (case_sensitive == 0) {
        goto lab_0x8085b3f;
    } else {
        // 0x8085b1d
        if (strcmp(prev_target, (char *)oldcur) != 0) {
            // 0x8085b56
            *refresh_screen = 1;
            goto lab_0x8085b5c;
        } else {
            // 0x8085b34
            if (case_sensitive != 0) {
                goto lab_0x8085b5c;
            } else {
                goto lab_0x8085b3f;
            }
        }
    }
  lab_0x8085b3f:
    // 0x8085b3f
    if (strcasecomp8(prev_target, (char *)oldcur) == 0) {
        goto lab_0x8085b5c;
    } else {
        // 0x8085b56
        *refresh_screen = 1;
        goto lab_0x8085b5c;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8085b7b - 0x8085ec6
// Line range:    4867 - 5037
void handle_LYK_digit(int32_t c, char * force_load, char * user_input_buffer, int32_t * old_c, int32_t real_c, char * try_internal) {
    int32_t v1 = nlinks < 1 ? 0 : g251;
    int32_t lindx2 = 0; // bp-20, 0x8085ba2
    int32_t lindx = (int32_t)g252; // bp-16, 0x8085bae
    int32_t v2 = follow_link_number(c, v1, &newdoc, &lindx); // 0x8085bcd
    if (v2 == 2) {
        char * v3 = g242; // 0x8085cdb
        Newline = (int32_t)v3;
        g242 = (char *)1;
        if (g252 != v3 || nlinks < 1 || g251 < 0) {
            // 0x8085ec0
            return;
        }
        // 0x8085d1c
        if (g251 != g241) {
            // 0x8085da6
            set_curdoc_link(g241);
            g241 = 0;
            // 0x8085ec0
            return;
        }
        // 0x8085d2b
        HTSACopy((char **)&lindx2, user_input_buffer);
        sprintf(user_input_buffer, gettext("Link number %d already is current."));
        HTUserMsg(user_input_buffer);
        LYstrncpy(user_input_buffer, (char *)lindx2, 1023);
        if (lindx2 != 0) {
            // 0x8085d8f
            free((int32_t *)lindx2);
            lindx2 = 0;
        }
        // 0x8085ec0
        return;
    }
    char * v4 = (char *)v2; // 0x8085bd2
    if (v4 <= (char *)2) {
        if (v4 != (char *)1) {
            // 0x8085ec0
            return;
        }
        int32_t v5 = *(int32_t *)(68 * v1 + (int32_t)&links); // 0x8085c16
        set_address(&newdoc, (char *)v5);
        char * v6 = LYGetHiliteStr(v1, 0); // 0x8085c3a
        HTSACopy((char **)&newdoc, v6);
        if (are_different(&curdoc, &newdoc) != 0) {
            // 0x8085c67
            LYFreePostData(&newdoc);
            if (g238 != NULL) {
                // 0x8085c7c
                free((int32_t *)g238);
                g238 = NULL;
            }
            // 0x8085c93
            g239 = 0;
            g240 = 0;
            if (strncasecomp((char *)g235, "LYNXMESSAGES:", 13) == 0) {
                // 0x8085cc2
                LYforce_no_cache = 1;
            }
        }
        // 0x8085cc9
        g243 = 0;
        *force_load = 1;
        // 0x8085ec0
        return;
    }
    switch (v2) {
        case 3: {
            char * v7 = g242; // 0x8085dc2
            Newline = (int32_t)v7;
            g242 = (char *)1;
            if (g252 != v7) {
                // 0x8085ec0
                return;
            }
            if (v7 <= (char *)1) {
                // 0x8085df3
                HTInfoMsg(gettext("You are already at the beginning of this document."));
                // 0x8085ec0
                return;
            }
            // break -> 0x8085e0c
            break;
        }
        case 5: {
            // 0x8085ea4
            *old_c = real_c;
            HTUserMsg(gettext("You have entered an invalid link number."));
            // 0x8085ec0
            return;
        }
        default: {
            // 0x8085ec0
            return;
        }
    }
    // 0x8085e0c
    if (more_text == 0) {
        // 0x8085e17
        HTInfoMsg(gettext("You are already at the end of this document."));
        // 0x8085ec0
        return;
    }
    // 0x8085e30
    HTSACopy((char **)&lindx2, user_input_buffer);
    sprintf(user_input_buffer, gettext("You are already at page %d of this document."));
    HTUserMsg(user_input_buffer);
    LYstrncpy(user_input_buffer, (char *)lindx2, 1023);
    if (lindx2 != 0) {
        // 0x8085e90
        free((int32_t *)lindx2);
        lindx2 = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8085ec6 - 0x80861e3
// Line range:    5043 - 5110
void handle_LYK_CHDIR(void) {
    int32_t v1 = __readgsdword(20); // 0x8085ed0
    char * path = NULL; // bp-272, 0x8085edb
    if (no_chdir == 0) {
        // 0x8085f09
        mustshow = 1;
        statusline(gettext("cd to:"));
        char * v2; // 0x8085f5e
        if (LYgetstr((char *)&g233, 0, 255, 0) < 0) {
            // 0x8085f57
            v2 = gettext("Cancelled!!!");
            HTInfoMsg(v2);
            goto lab_0x80861c9;
        } else {
            char v3 = *(char *)&g233; // 0x8085f4c
            if (v3 != 0) {
                if (v3 != 126) {
                    // 0x8085fba
                    HTSACopy(&path, (char *)&g233);
                    goto lab_0x8085fd0;
                } else {
                    char v4 = *(char *)&g234; // 0x8085f7b
                    if (v4 != 47 == (v4 != 0)) {
                        // 0x8085fba
                        HTSACopy(&path, (char *)&g233);
                        goto lab_0x8085fd0;
                    } else {
                        char * v5 = Home_Dir(); // 0x8085f91
                        HTSprintf0(&path, "%s%s", v5, (char *)&g234);
                        goto lab_0x8085fd0;
                    }
                }
            } else {
                // 0x8085f57
                v2 = gettext("Cancelled!!!");
                HTInfoMsg(v2);
                goto lab_0x80861c9;
            }
        }
    } else {
        // 0x8085ef0
        HTUserMsg(gettext("Changing working-directory is currently disabled."));
        goto lab_0x80861c9;
    }
  lab_0x80861c9:
    // 0x80861c9
    if (v1 != __readgsdword(20)) {
        // 0x80861d5
        __stack_chk_fail();
    }
  lab_0x8085fd0:
    // 0x8085fd0
    if (WWW_TraceFlag != 0) {
        // 0x8085fdb
        fprintf(TraceFP(), "changing directory to '%s'\n", path);
    }
    // 0x8085ffc
    if (chdir(path) == 0) {
        // 0x80860a0
        char * v6; // 0x808619a
        if (no_dired_support != 0) {
            // 0x8086193
            v6 = gettext("Done!");
            HTInfoMsg(v6);
            goto lab_0x80861a7;
        } else {
            // 0x80860af
            if (lynx_edit_mode != 0) {
                goto lab_0x80860df;
            } else {
                // 0x80860ba
                if (LYIsUIPage3((char *)g245, 8, 1) == 0) {
                    // 0x8086193
                    v6 = gettext("Done!");
                    HTInfoMsg(v6);
                    goto lab_0x80861a7;
                } else {
                    goto lab_0x80860df;
                }
            }
        }
    } else {
        // 0x8086012
        switch (*__errno_location()) {
            case 13: {
                // 0x808603c
                HTInfoMsg(gettext("Could not access directory."));
                // break -> 0x80861a7
                break;
            }
            case 20: {
                // 0x808606e
                HTInfoMsg(gettext("A component of path is not a directory"));
                // break -> 0x80861a7
                break;
            }
            case 2: {
                // 0x8086055
                HTInfoMsg(gettext("No such directory"));
                // break -> 0x80861a7
                break;
            }
            default: {
                // 0x8086087
                HTInfoMsg(gettext("failed to change directory"));
                // break -> 0x80861a7
                break;
            }
        }
        goto lab_0x80861a7;
    }
  lab_0x80861a7:
    // 0x80861a7
    if (path != NULL) {
        // 0x80861b1
        free((int32_t *)path);
        path = NULL;
    }
    goto lab_0x80861c9;
  lab_0x80860df:;
    char * p = NULL; // bp-276, 0x80860df
    int32_t v7; // bp-268, 0x8085ec6
    Current_Dir((char *)&v7);
    LYLocalFileToURL(&p, (char *)&v7);
    g235 = (char **)p;
    g239 = 0;
    char * v8 = gettext("A URL specified by the user"); // 0x8086128
    HTSACopy((char **)&newdoc, v8);
    LYFreePostData(&newdoc);
    if (g238 != NULL) {
        // 0x8086152
        free((int32_t *)g238);
        g238 = NULL;
    }
    // 0x8086169
    g240 = 0;
    g243 = 0;
    if (lynx_edit_mode != 0 && LYAutoUncacheDirLists >= 2) {
        // 0x808618c
        HTuncache_current_document();
    }
    goto lab_0x80861a7;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80861e3 - 0x8086252
// Line range:    5128 - 5139
int32_t repeat_to_delta(int32_t n) {
    int32_t v1 = LYcols; // 0x80861e9
    if (v1 >= -2 != v1 >= 3) {
        // 0x808624d
        return n;
    }
    int32_t v2 = v1;
    int32_t v3 = v2 / 3;
    int32_t result = v3; // 0x8086217
    while (v3 > n) {
        int32_t v4 = 2 * v3; // 0x8086224
        result = n;
        if (v2 >= -5 != v4 >= 3) {
            // break -> 0x808624d
            break;
        }
        v2 = v4;
        v3 = v2 / 3;
        result = v3;
    }
    // 0x808624d
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8086252 - 0x80862bc
// Line range:    5142 - 5153
void handle_LYK_SHIFT_LEFT(char * flag, int32_t count) {
    // 0x8086252
    if (LYwideLines == 0) {
        // 0x8086262
        HTAlert(gettext("Shifting is disabled while line-wrap is in effect"));
        // 0x80862b6
        return;
    }
    int32_t v1 = LYshiftWin; // 0x8086278
    int32_t v2 = v1; // 0x808627f
    if (v1 >= 1) {
        // 0x8086281
        LYshiftWin = v1 - repeat_to_delta(count);
        *flag = 1;
        v2 = LYshiftWin;
    }
    // 0x80862a3
    if (v2 < 0) {
        // 0x80862ac
        LYshiftWin = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x80862bc - 0x8086303
// Line range:    5156 - 5163
void handle_LYK_SHIFT_RIGHT(char * flag, int32_t count) {
    // 0x80862bc
    if (LYwideLines != 0) {
        // 0x80862e1
        LYshiftWin += repeat_to_delta(count);
        *flag = 1;
    } else {
        // 0x80862cb
        HTAlert(gettext("Shifting is disabled while line-wrap is in effect"));
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x8086303 - 0x808641f
// Line range:    5167 - 5216
char handle_LYK_LINEWRAP_TOGGLE(int32_t * cmd, char * flag) {
    // 0x8086303
    if (g158 == (int32_t)LYwin) {
        // 0x8086419
        return 0;
    }
    int32_t v1 = LYcols - (int32_t)(LYShowScrollbar != 0); // 0x8086336
    int32_t v2 = LYlines; // 0x8086344
    int32_t v3 = popup_choice((int32_t)(LYwideLines == 0), (v2 + (int32_t)(v2 < 0) >> 1) - 2, (v1 + (int32_t)(v1 < 0) >> 1) - 6, g101, 8, 0, 1); // 0x808638e
    if (term_options != 0) {
        // 0x8086419
        return 0;
    }
    // 0x80863a7
    LYwideLines = v3;
    LYtableCols = *(int32_t *)(4 * v3 + (int32_t)&g100);
    if (v3 == 0) {
        // 0x80863c7
        LYshiftWin = 0;
    }
    // 0x80863d1
    *flag = 1;
    char * v4; // 0x8086303
    if (LYwideLines == 0) {
        // 0x80863f1
        v4 = gettext("Linewrap ON!");
    } else {
        // 0x80863e0
        v4 = gettext("Linewrap OFF!");
    }
    // 0x8086400
    HTUserMsg(v4);
    // 0x8086419
    return reparse_or_reload(cmd);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808641f - 0x808ad77
// Line range:    5229 - 7445
int32_t mainloop(void) {
    char user_input_buffer2[1024]; // bp-1176, 0x808641f
    char user_input_buffer[1024]; // bp-1180, 0x808641f
    char v1[1024]; // 0x80864ce
    int32_t v2 = __readgsdword(20); // 0x808642b
    char ForcePush = 0; // bp-1192, 0x8086436
    int32_t c = 0; // bp-1200, 0x808644a
    int32_t old_c = 69; // bp-1208, 0x808645e
    int32_t real_cmd = 0; // bp-1220, 0x8086472
    int32_t arrowup = 0; // bp-1228, 0x8086486
    char v3 = 0; // bp-1175, 0x808649e
    user_input_buffer2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char first_file2 = 0; // bp-1177, 0x80864ac
    char popped_doc = 0; // bp-1178, 0x80864b3
    char refresh_screen = vi_keys; // bp-1179, 0x80864c1
    v1[0] = emacs_keys;
    user_input_buffer = v1;
    char first_file = 0; // bp-1181, 0x80864d4
    int32_t * cfp = NULL; // bp-1240, 0x80864e8
    char * cp = NULL; // bp-1244, 0x80864f2
    int32_t ch = 0; // bp-1248, 0x80864fc
    char refresh_screen2 = 1; // bp-1183, 0x8086506
    int32_t URLTotal = 0; // bp-1256, 0x808650d
    char force_load = 0; // bp-1184, 0x8086517
    char crawl_ok = 0; // bp-1186, 0x8086525
    int32_t len = -1; // bp-1268, 0x808652c
    char ** v4 = (char **)"internal link"; // bp-1692, 0x808654a
    int32_t * v5 = HTAtom_for("internal link"); // 0x8086551
    *(int32_t *)&HTInternalLink = (int32_t)v5;
    v4 = (char **)"www/source";
    int32_t * v6 = HTAtom_for("www/source"); // 0x8086562
    *(int32_t *)&WWW_SOURCE = (int32_t)v6;
    g235 = NULL;
    newdoc = 0;
    g236 = 0;
    g237 = NULL;
    g238 = NULL;
    g243 = 0;
    g245 = NULL;
    curdoc = 0;
    g246 = 0;
    g247 = NULL;
    g248 = NULL;
    g253 = 0;
    g254 = NULL;
    g244 = 0;
    nhist = 0;
    prev_target[0] = 0;
    char v7 = 0; // bp-1172, 0x808660a
    v4 = (char **)&newdoc;
    set_address(&newdoc, (char *)startfile);
    v4 = (char **)&startrealm;
    HTSACopy((char **)&startrealm, (char *)startfile);
    v4 = (char **)"Entry into main screen";
    char * v8 = gettext("Entry into main screen"); // 0x8086642
    v4 = (char **)&newdoc;
    HTSACopy((char **)&newdoc, v8);
    g239 = 0;
    g240 = 0;
    g242 = (char *)1;
    g241 = 0;
    struct _IO_FILE * stream; // 0x808668a
    if (WWW_TraceFlag != 0) {
        // 0x8086684
        stream = TraceFP();
        v4 = (char **)stream;
        fprintf(stream, "Entering mainloop, startfile=%s\n", (char *)startfile);
    }
    int32_t v9 = form_post_data; // 0x80866a5
    int32_t v10; // 0x80866d9
    if (v9 == 0) {
        // 0x80866d9
        v10 = form_get_data;
        if (v10 != 0) {
            // 0x80866e2
            v4 = (char **)&g235;
            HTSACat((char **)&g235, (char *)v10);
        }
    } else {
        // 0x80866ae
        v4 = (char **)&g236;
        HTSABCopy0((int32_t **)&g236, (char *)v9);
        v4 = &g237;
        HTSACopy(&g237, "application/x-www-form-urlencoded");
    }
    while (bookmark_start != 0) {
        // 0x8086706
        if (LYValidate == 0) {
            // 0x8086731
            if (traversal == 0) {
                // 0x808676a
                v4 = (char **)&g235;
                char * str = get_bookmark_filename((char **)&g235); // 0x8086771
                if (str != NULL) {
                    // 0x8086789
                    if (*str != 0) {
                        // 0x808679a
                        v4 = (char **)str;
                        if (strcmp(str, " ") != 0) {
                            // 0x80867b8
                            v4 = (char **)"Bookmark file";
                            char * v11 = gettext("Bookmark file"); // 0x80867bf
                            v4 = (char **)&newdoc;
                            HTSACopy((char **)&newdoc, v11);
                            v4 = &g238;
                            HTSACopy(&g238, (char *)BookmarkPage);
                            v4 = (char **)&startrealm;
                            HTSACopy((char **)&startrealm, (char *)g235);
                            v4 = (char **)&newdoc;
                            LYFreePostData(&newdoc);
                            g239 = 0;
                            g240 = 0;
                            if (WWW_TraceFlag == 0) {
                                goto lab_0x8086866;
                            } else {
                                struct _IO_FILE * stream2 = TraceFP(); // 0x8086829
                                v4 = (char **)stream2;
                                fprintf(stream2, "Using bookmarks=%s\n", g235);
                                goto lab_0x8086866;
                            }
                        }
                    }
                }
                // 0x8086846
                v4 = (char **)"Unable to open bookmark file, use 'a' to save a link first";
                char * v12 = gettext("Unable to open bookmark file, use 'a' to save a link first"); // 0x808684d
                v4 = (char **)v12;
                HTUserMsg(v12);
                bookmark_start = 0;
            } else {
                // 0x808673c
                v4 = (char **)"Bookmark files cannot be traversed (only http URLs).";
                char * v13 = gettext("Bookmark files cannot be traversed (only http URLs)."); // 0x8086743
                v4 = (char **)v13;
                HTAlert(v13);
                traversal = 0;
                crawl = 0;
                bookmark_start = 0;
            }
        } else {
            // 0x8086711
            v4 = (char **)"Bookmark features are currently disabled.";
            char * v14 = gettext("Bookmark features are currently disabled."); // 0x8086718
            v4 = (char **)v14;
            HTAlert(v14);
            bookmark_start = 0;
        }
        v4 = (char **)&newdoc;
        set_address(&newdoc, (char *)startfile);
        v4 = (char **)&startrealm;
        HTSACopy((char **)&startrealm, (char *)startfile);
        v4 = (char **)"Entry into main screen";
        v8 = gettext("Entry into main screen");
        v4 = (char **)&newdoc;
        HTSACopy((char **)&newdoc, v8);
        g239 = 0;
        g240 = 0;
        g242 = (char *)1;
        g241 = 0;
        if (WWW_TraceFlag != 0) {
            // 0x8086684
            stream = TraceFP();
            v4 = (char **)stream;
            fprintf(stream, "Entering mainloop, startfile=%s\n", (char *)startfile);
        }
        // 0x80866a5
        v9 = form_post_data;
        if (v9 == 0) {
            // 0x80866d9
            v10 = form_get_data;
            if (v10 != 0) {
                // 0x80866e2
                v4 = (char **)&g235;
                HTSACat((char **)&g235, (char *)v10);
            }
        } else {
            // 0x80866ae
            v4 = (char **)&g236;
            HTSABCopy0((int32_t **)&g236, (char *)v9);
            v4 = &g237;
            HTSACopy(&g237, "application/x-www-form-urlencoded");
        }
    }
    goto lab_0x8086866;
  lab_0x808ad55_2:;
    // 0x808ad55
    int32_t v36; // 0x808641f
    int32_t result = v36; // 0x808ad65
    if (v2 != __readgsdword(20)) {
        // 0x808ad67
        __stack_chk_fail();
        result = &g391;
    }
    // 0x808ad6c
    return result;
  lab_0x80868ab_14:;
    // 0x80868ab
    char v37; // 0x808641f
    char v15 = v37; // 0x808641f
    int32_t v38; // 0x808641f
    int32_t v16 = v38; // 0x808641f
    int32_t v39; // 0x808641f
    int32_t v17 = v39; // 0x808641f
    int32_t v40; // 0x808641f
    int32_t v18 = v40; // 0x808641f
    char v41; // 0x808641f
    char v19 = v41; // 0x808641f
    char v42; // 0x808641f
    char v20 = v42; // 0x808641f
    int32_t v43; // 0x808641f
    int32_t v21 = v43; // 0x808641f
    int32_t v44; // 0x808641f
    int32_t v22 = v44; // 0x808641f
    goto lab_0x80868ab_15;
  lab_0x808a211_2:;
    // 0x808a211
    char * v45; // bp-1340, 0x808641f
    int32_t v46; // 0x808641f
    *(int32_t *)&v45 = v46;
    char * v47; // bp-1316, 0x808641f
    char * v48 = v47; // 0x808a21d
    char * c3; // 0x808641f
    char * v49 = c3; // 0x808a21d
    char * v50; // 0x808641f
    char * v51 = v50; // 0x808a21d
    char * v52 = v50; // 0x808a21d
    char * v53; // 0x808641f
    if (v47 > c3) {
        goto lab_0x808a1d8;
    } else {
        // 0x808a240
        v53 = v52;
        goto lab_0x808a240_2;
    }
  lab_0x8089cdf:
    // 0x8089cdf
    v4 = (char **)v39;
    handle_LYK_RELOAD(v39);
    int32_t v54; // 0x808641f
    v38 = v54;
    int32_t v55; // 0x808641f
    v40 = v55;
    goto lab_0x80868ab_14;
  lab_0x808a33c:
    // 0x808a33c
    v4 = (char **)&real_cmd;
    int32_t v56; // 0x808641f
    handle_LYK_PREV_LINK(&real_cmd, &c, v56);
    v38 = v54;
    v40 = v55;
    goto lab_0x80868ab_14;
  lab_0x808a363:;
    int32_t v57 = ForcePush; // 0x808a363
    v4 = (char **)v57;
    handle_LYK_NEXT_LINK(v57, &c, v56);
    v38 = v54;
    v40 = v55;
    goto lab_0x80868ab_14;
  lab_0x808a481:
    // 0x808a481
    v4 = (char **)&old_c;
    int32_t v58 = handle_PREV_DOC(&old_c, &c, v56); // 0x808a49e
    v38 = v54;
    v40 = v55;
    v36 = 0;
    switch (v58) {
        case 1: {
            goto lab_0x808ad55_2;
        }
        case 2: {
            goto lab_0x8089985_2;
        }
        default: {
            goto lab_0x80868ab_14;
        }
    }
  lab_0x808a4fd:
    // 0x808a4fd
    v4 = (char **)&ForcePush;
    int32_t v59; // 0x808641f
    int32_t v60 = handle_LYK_ACTIVATE((int32_t *)&ForcePush, v59, &first_file2, &v3, user_input_buffer2, v39); // 0x808a538
    char v61 = v37; // 0x808641f
    int32_t v62 = v54; // 0x808641f
    int32_t v63 = v55; // 0x808641f
    char v64 = v41; // 0x808641f
    char v65 = v42; // 0x808641f
    int32_t v66 = v43; // 0x808641f
    int32_t v67 = v44; // 0x808641f
    v38 = v54;
    v40 = v55;
    switch (v60) {
        case 2: {
            goto lab_0x80897b4;
        }
        case 3: {
            // 0x808a565
            v38 = ForcePush;
            v40 = v55;
            goto lab_0x80868ab_14;
        }
        default: {
            goto lab_0x80868ab_14;
        }
    }
  lab_0x808a72d:
    // 0x808a72d
    v4 = (char **)&arrowup;
    handle_LYK_HELP((char **)&arrowup);
    v38 = v54;
    v40 = v55;
    goto lab_0x80868ab_14;
  lab_0x808a7ef:;
    // 0x808a7ef
    int32_t v68; // 0x808641f
    v4 = (char **)v68;
    handle_LYK_WHEREIS(v68, &v3);
    v38 = v54;
    v40 = v55;
    goto lab_0x80868ab_14;
  lab_0x808a8a4:
    // 0x808a8a4
    v4 = (char **)&c;
    handle_LYK_EDIT(&c, v56);
    v38 = v54;
    v40 = v55;
    goto lab_0x80868ab_14;
  lab_0x8087bcf:
    // 0x8087bcf
    if (WWW_TraceFlag == 0) {
        goto lab_0x8087bf3;
    } else {
        // 0x8087bda
        if (LYTraceLogFP != NULL == first_file == 0) {
            goto lab_0x8087bf3;
        } else {
            // 0x8087bee
            LYSleepAlert();
            goto lab_0x8087bf3;
        }
    }
  lab_0x8087a29_5:;
    int32_t v69 = URLTotal;
    if (v69 == 0) {
        goto lab_0x8087a4b;
    } else {
        // 0x8087a33
        v4 = (char **)v69;
        free((int32_t *)v69);
        URLTotal = 0;
        goto lab_0x8087a4b;
    }
  lab_0x808729f_2:
    // 0x808729f
    v4 = (char **)3;
    char v26; // 0x808641f
    exit_immediately_with_error_message(3, v26);
    v36 = 1;
    goto lab_0x808ad55_2;
  lab_0x8087a4b:
    // 0x8087a4b
    if (traversal == 0) {
        goto lab_0x8087aeb;
    } else {
        int32_t v70 = traversal_link_to_add; // 0x8087a5a
        if (v70 == 0) {
            goto lab_0x8087aa1;
        } else {
            // 0x8087a63
            v4 = (char **)v70;
            if (lookup_link((char *)v70) != 0) {
                goto lab_0x8087a81;
            } else {
                // 0x8087a74
                v4 = (char **)traversal_link_to_add;
                add_to_table((char *)traversal_link_to_add);
                goto lab_0x8087a81;
            }
        }
    }
  lab_0x8086a09:;
    // 0x8086a09
    char v71; // 0x808641f
    char v72 = v71;
    if (HEAD_request != 0) {
        // 0x8086a1f
        if (g235 != NULL) {
            // 0x8086a2c
            *(int32_t *)&v4 = (int32_t)g235;
            if (LYCanDoHEAD((char *)g235) != 1) {
                // 0x8086a46
                *(int32_t *)&v4 = (int32_t)g235;
                if (strncasecomp((char *)g235, "LYNXIMGMAP:", 11) == 0) {
                    int32_t v73 = (int32_t)g235 + 11; // 0x8086a6c
                    v4 = (char **)v73;
                    if (LYCanDoHEAD((char *)v73) == 1) {
                        // 0x8086a7b
                        v4 = (char **)&URLTotal;
                        HTSACopy((char **)&URLTotal, (char *)((int32_t)g235 + 11));
                        v4 = (char **)&newdoc;
                        free_address(&newdoc);
                        g235 = (char **)URLTotal;
                        g239 = 1;
                        URLTotal = 0;
                    }
                }
            } else {
                // 0x8086a3d
                g239 = 1;
            }
        }
        // 0x8086abd
        first_file2 = 0;
        HEAD_request = 0;
    }
    // 0x8086acb
    if (LYUseTraceLog == 1) {
        // 0x8086ada
        if (first_file == 0 && LYTraceLogFP != NULL) {
            // 0x8086af6
            *(int32_t *)&v4 = (int32_t)g235;
            if (LYIsUIPage3((char *)g235, 13, 1) != 0) {
                // 0x8086b1b
                char ** v74; // bp-1360, 0x808641f
                *(int32_t *)&v74 = (int32_t)g235;
                v4 = (char **)&v74;
                int32_t * v75 = HTAnchor_findAddress((int32_t *)&v74); // 0x8086b6a
                v4 = (char **)v75;
                if (HTAnchor_document(v75) == NULL) {
                    // 0x8086b87
                    v4 = (char **)&first_file;
                    if (LYReopenTracelog(&first_file) == 0) {
                        // break -> 0x8086b99
                        goto lab_0x8086b99;
                    }
                }
            }
        }
    }
    // 0x8086bb2
    LYRequestTitle = newdoc;
    if (g238 != NULL) {
        // 0x8086bc5
        LYforce_HTML_mode = 1;
    }
    char ** str2 = g235; // 0x8086be2
    if (LYValidate == 0 | startfile_ok == 0 | str2 == NULL || startfile == 0 || homepage == 0) {
        goto lab_0x8086c3a;
    } else {
        // 0x8086bfd
        *(int32_t *)&v4 = (int32_t)str2;
        if (strcmp((char *)str2, (char *)startfile) == 0) {
            // 0x8086c33
            LYPermitURL = 1;
            goto lab_0x8086c3a;
        } else {
            // 0x8086c18
            *(int32_t *)&v4 = (int32_t)g235;
            if (strcmp((char *)g235, (char *)homepage) != 0) {
                goto lab_0x8086c3a;
            } else {
                // 0x8086c33
                LYPermitURL = 1;
                goto lab_0x8086c3a;
            }
        }
    }
  lab_0x8086c3a:
    // 0x8086c3a
    prev_target[0] = 0;
    Newline = (int32_t)g242;
    psrc_first_tag = 1;
    textfields_need_activation = textfields_activation_option;
    if (LYRequestReferer != 0) {
        // 0x8086c67
        v4 = (char **)LYRequestReferer;
        free((int32_t *)LYRequestReferer);
        LYRequestReferer = 0;
    }
    if (v72 != 0) {
        // 0x8086c87
        LYNoRefererForThis = 1;
    }
    int32_t v76 = g241; // 0x8086cd0
    int32_t key_count = -1; // bp-1280, 0x8086cfc
    v4 = (char **)&newdoc;
    int32_t v77 = getfile(&newdoc, &key_count); // 0x8086d17
    if (reloading != 0) {
        // 0x8086d4d
        g241 = v76;
        goto lab_0x8086d58;
    } else {
        int32_t v78 = key_count; // 0x8086d36
        if (v72 != 0 || v78 < 0) {
            // 0x8086d4d
            g241 = v76;
            goto lab_0x8086d58;
        } else {
            // 0x8086d40
            Newline = v78;
            goto lab_0x8086d58;
        }
    }
  lab_0x8086d58:;
    char * cshelpfile; // bp-1236, 0x808641f
    char * v79; // 0x808641f
    switch (v77) {
        case 1: {
            // 0x8087538
            LYoverride_no_cache = 0;
            LYinternal_flag = 0;
            v4 = (char **)&first_file;
            turn_trace_back_on(&first_file);
            if (v26 != 1) {
                goto lab_0x8087a29_5;
            }
            // 0x8087561
            if (dump_output_immediately != 0) {
                goto lab_0x8087a29_5;
            }
            char * v80 = g238; // 0x8087570
            if (v80 != NULL) {
                // 0x8087579
                if (*v80 != 0) {
                    goto lab_0x8087a29_5;
                }
            }
            // 0x8087589
            *(int32_t *)&v4 = (int32_t)g235;
            if (LYisLocalFile((char *)g235) != 1) {
                goto lab_0x8087a29_5;
            }
            // 0x808759e
            v4 = (char **)"Bookmark file";
            char * str4 = gettext("Bookmark file"); // 0x80875a5
            char * v81 = HText_getTitle(); // 0x80875b0
            char * str3 = (char *)&g20; // 0x80875b7
            if (v81 != NULL) {
                // 0x80875b9
                str3 = HText_getTitle();
            }
            // 0x80875d0
            v4 = (char **)str3;
            if (strcmp(str3, str4) != 0) {
                goto lab_0x8087a29_5;
            }
            // 0x80875f0
            *(int32_t *)&v4 = (int32_t)g235;
            char * v82 = HTParse((char *)g235, (char *)&g20, 5); // 0x8087608
            URLTotal = (int32_t)v82;
            if (v82 == NULL) {
                goto lab_0x8087a4b;
            }
            char * v83 = Home_Dir(); // 0x8087621
            v4 = (char **)v83;
            char * str5 = wwwName(v83); // 0x8087629
            v4 = (char **)str5;
            uint32_t len2 = strlen(str5); // 0x808763d
            v4 = (char **)URLTotal;
            if (strncmp((char *)URLTotal, str5, len2) != 0) {
                // 0x8087a1f
                cshelpfile = NULL;
                goto lab_0x8087a29_5;
            }
            // 0x8087672
            v4 = (char **)URLTotal;
            if (strlen((char *)URLTotal) <= len2) {
                // 0x8087a1f
                cshelpfile = NULL;
                goto lab_0x8087a29_5;
            }
            // 0x808768c
            cshelpfile = NULL;
            int32_t v84 = URLTotal; // 0x8087696
            char * v85 = (char *)(v84 + len2); // 0x80876a2
            if (*v85 != 47) {
                // 0x808771d
                v4 = &cshelpfile;
                HTSACopy(&cshelpfile, v85);
            } else {
                int32_t v86 = len2 + 1; // 0x80876b5
                int32_t str6 = v84 + v86; // 0x80876b8
                v4 = (char **)str6;
                int32_t v87 = URLTotal;
                if (strchr((char *)str6, 47) == NULL) {
                    // 0x80876f7
                    v4 = &cshelpfile;
                    HTSACopy(&cshelpfile, (char *)(v87 + v86));
                } else {
                    // 0x80876cf
                    v4 = &cshelpfile;
                    HTSprintf0(&cshelpfile, ".%s", (char *)(v87 + len2));
                }
            }
            char * v88 = NULL;
            int32_t v89 = (int32_t)v88; // 0x8087747
            int32_t * v90 = (int32_t *)(4 * v89 + (int32_t)&MBM_A_subbookmark);
            int32_t str7 = *v90; // 0x808774d
            if (str7 != 0) {
                // 0x8087758
                v4 = (char **)cshelpfile;
                if (strcmp(cshelpfile, (char *)str7) == 0) {
                    // 0x808777b
                    v4 = (char **)&BookmarkPage;
                    HTSACopy((char **)&BookmarkPage, (char *)*v90);
                    v79 = v88;
                    goto lab_0x80877aa;
                }
            }
            char * v91 = (char *)(v89 + 1);
            v79 = v91;
            while (v91 < (char *)26) {
                // 0x8087747
                v88 = v91;
                v89 = (int32_t)v88;
                v90 = (int32_t *)(4 * v89 + (int32_t)&MBM_A_subbookmark);
                str7 = *v90;
                if (str7 != 0) {
                    // 0x8087758
                    v4 = (char **)cshelpfile;
                    if (strcmp(cshelpfile, (char *)str7) == 0) {
                        // 0x808777b
                        v4 = (char **)&BookmarkPage;
                        HTSACopy((char **)&BookmarkPage, (char *)*v90);
                        v79 = v88;
                        goto lab_0x80877aa;
                    }
                }
                // 0x808779a
                v91 = (char *)(v89 + 1);
                v79 = v91;
            }
            goto lab_0x80877aa;
        }
        case 3: {
            goto lab_0x8087114;
        }
        default: {
            if (v77 != 0) {
                goto lab_0x8087bcf;
            }
            // 0x8086d8b
            LYoverride_no_cache = 0;
            LYinternal_flag = 0;
            v4 = (char **)&first_file;
            turn_trace_back_on(&first_file);
            if (v26 == 0) {
                // 0x8086db4
                if (LYCancelledFetch == 0) {
                    // 0x8086dc3
                    if (v72 == 0 && error_logging != 0 && nhist >= 1) {
                        int32_t v92 = nlinks; // 0x8086e08
                        if (g251 < v92 == (LYUserSpecifiedURL == 0 && HTMainText != NULL && v92 >= 1)) {
                            char ** v93 = g235; // 0x8086e28
                            int32_t v94 = v93 == NULL ? (int32_t)&g20 : (int32_t)v93;
                            *(int32_t *)&v4 = v94;
                            if (strncasecomp((char *)v94, "LYNXHIST:", 9) != 0) {
                                char ** v95 = g235; // 0x8086e6f
                                int32_t v96 = v95 == NULL ? (int32_t)&g20 : (int32_t)v95;
                                *(int32_t *)&v4 = v96;
                                if (strncasecomp((char *)v96, "LYNXCOOKIE:", 11) != 0) {
                                    // 0x8086eb6
                                    if (owner_address != 0) {
                                        // 0x8086ec9
                                        v4 = (char **)owner_address;
                                        if (strncasecomp((char *)owner_address, "mailto:", 7) == 0) {
                                            int32_t v97 = owner_address + 7; // 0x8086eef
                                            if (v97 != 0) {
                                                int32_t v98 = (int32_t)history - 44 + 44 * nhist; // 0x8086f12
                                                int32_t v99 = *(int32_t *)v98; // 0x8086f15
                                                int32_t v100 = *(int32_t *)(v98 + 4); // 0x8086f2b
                                                v4 = (char **)g251;
                                                mailmsg(g251, (char *)v97, (char *)v100, (char *)v99);
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                    // 0x8086f4e
                    if (traversal != 0) {
                        // 0x8086f5d
                        v4 = (char **)"traverse.errors";
                        struct _IO_FILE * v101 = LYAppendToTxtFile("traverse.errors"); // 0x8086f64
                        struct _IO_FILE * v102 = v101; // 0x8086f76
                        if (v101 == NULL) {
                            // 0x8086f78
                            v4 = (char **)"traverse.errors";
                            v102 = LYNewTxtFile("traverse.errors");
                            if (v102 == NULL) {
                                // 0x8086f93
                                v4 = (char **)"Unable to open traversal errors output file";
                                char * str8 = gettext("Unable to open traversal errors output file"); // 0x8086f9a
                                v4 = (char **)str8;
                                perror(str8);
                                v4 = (char **)1;
                                exit_immediately(1);
                                // UNREACHABLE
                            }
                        }
                        struct _IO_FILE * stream3 = v102;
                        if (nhist < 1) {
                            int32_t v103 = 68 * g251; // 0x808706d
                            int32_t v104 = *(int32_t *)(v103 + (int32_t)&g343); // 0x808706f
                            int32_t * v105 = v72 == 0 ? (int32_t *)(v103 + (int32_t)&links) : (int32_t *)&g235;
                            v4 = (char **)stream3;
                            fprintf(stream3, "%s %s\t\n", (char **)*v105, (char *)v104);
                        } else {
                            int32_t v106 = *(int32_t *)(44 * nhist - 40 + (int32_t)history); // 0x8086fd4
                            int32_t v107 = 68 * g251; // 0x8086fea
                            int32_t v108 = *(int32_t *)(v107 + (int32_t)&g343); // 0x8086fec
                            int32_t * v109 = v72 == 0 ? (int32_t *)(v107 + (int32_t)&links) : (int32_t *)&g235;
                            int32_t v110 = *v109;
                            v4 = (char **)stream3;
                            fprintf(stream3, "%s %s\tin %s\n", (char **)v110, (char *)v108, (char *)v106);
                        }
                        // 0x80870d7
                        v4 = (char **)stream3;
                        LYCloseOutput(stream3);
                    }
                }
            }
            // 0x80870e5
            if (nhist == 0) {
                // 0x80870ee
                v4 = NULL;
                exit_immediately_with_error_message(0, v26);
                v36 = 1;
                goto lab_0x808ad55_2;
            }
            goto lab_0x8087114;
        }
    }
  lab_0x8087114:
    // 0x8087114
    LYoverride_no_cache = 0;
    LYinternal_flag = 0;
    v4 = (char **)&first_file;
    turn_trace_back_on(&first_file);
    v4 = (char **)&newdoc;
    free_address(&newdoc);
    char * v111 = g238; // 0x8087143
    if (v111 != NULL) {
        // 0x808714c
        v4 = (char **)v111;
        free((int32_t *)v111);
        g238 = NULL;
    }
    // 0x8087163
    LYJumpFileURL = 0;
    reloading = 0;
    LYPermitURL = 0;
    LYCancelledFetch = 0;
    force_load = 0;
    LYforce_HTML_mode = 0;
    force_old_UCLYhndl_on_reload = 0;
    if (traversal != 0) {
        // 0x808719f
        popped_doc = 0;
        int32_t v112 = traversal_link_to_add; // 0x80871a6
        if (v112 != 0) {
            // 0x80871af
            v4 = (char **)v112;
            if (lookup_reject((char *)v112) == 0) {
                // 0x80871c0
                v4 = (char **)traversal_link_to_add;
                add_to_reject_list((char *)traversal_link_to_add);
            }
            int32_t v113 = traversal_link_to_add; // 0x80871cd
            if (v113 != 0) {
                // 0x80871d6
                v4 = (char **)v113;
                free((int32_t *)v113);
                traversal_link_to_add = 0;
            }
        }
    }
    // 0x80871ed
    char v114; // 0x808641f
    char * v115; // 0x808641f
    char v116; // 0x808641f
    int32_t v117; // 0x8087479
    if (nhist != 0) {
        // 0x80872c5
        LYforce_no_cache = 0;
        int32_t v118 = 44 * nhist - 44 + (int32_t)history; // 0x80872dd
        v114 = 0;
        v116 = 1;
        if (*(int32_t *)(v118 + 8) != 0) {
            // 0x80872eb
            v114 = 0;
            v116 = 1;
            if (*(char *)(v118 + 21) == 0) {
                // 0x808730b
                v4 = (char **)v118;
                v114 = 0;
                v116 = 1;
                if (HText_POSTReplyLoaded((int32_t *)v118) == 0) {
                    // 0x8087337
                    if (g245 != NULL) {
                        // 0x8087442
                        v4 = (char **)&newdoc;
                        copy_address(&newdoc, &curdoc);
                        v4 = (char **)&newdoc;
                        HTSACopy((char **)&newdoc, (char *)curdoc);
                        v117 = 0;
                        v115 = NULL;
                        if (g246 == 0) {
                            goto lab_0x80874b0;
                        } else {
                            // 0x8087497
                            v117 = *(int32_t *)(g246 + 4);
                            v115 = (char *)*(int32_t *)g246;
                            goto lab_0x80874b0;
                        }
                    } else {
                        char * v119 = HTLoadedDocumentURL(); // 0x8087344
                        v4 = (char **)&newdoc;
                        set_address(&newdoc, v119);
                        char * v120 = HTLoadedDocumentTitle(); // 0x8087359
                        v4 = (char **)&newdoc;
                        HTSACopy((char **)&newdoc, v120);
                        if (HTMainAnchor == NULL || search_queries == NULL) {
                            // 0x8087416
                            v4 = (char **)&g236;
                            HTSABFree((int32_t **)&g236);
                            goto lab_0x8087422;
                        } else {
                            // 0x808738b
                            v4 = (char **)&g236;
                            HTSABCopy((int32_t **)&g236, (char *)search_queries, HTFormNumber);
                            v4 = &g237;
                            HTSACopy(&g237, (char *)HTFormNumber);
                            goto lab_0x8087422;
                        }
                    }
                }
            }
        }
    } else {
        // 0x80871fa
        if (v26 == 0 || homepage == 0) {
            goto lab_0x808729f_2;
        }
        // 0x8087214
        v4 = (char **)homepage;
        if (strcmp((char *)homepage, (char *)startfile) == 0) {
            goto lab_0x808729f_2;
        }
        // 0x808722f
        v4 = (char **)&newdoc;
        set_address(&newdoc, (char *)homepage);
        v4 = (char **)&newdoc;
        LYFreePostData(&newdoc);
        char * v121 = g238; // 0x8087250
        if (v121 != NULL) {
            // 0x8087259
            v4 = (char **)v121;
            free((int32_t *)v121);
            g238 = NULL;
        }
        // 0x8087270
        v4 = (char **)&startfile;
        HTSACopy((char **)&startfile, (char *)homepage);
        g239 = 0;
        g240 = 0;
        g243 = 0;
        v114 = 0;
        v116 = 0;
    }
    goto lab_0x8086941;
  lab_0x80877aa:;
    char * v319 = cshelpfile; // 0x80877aa
    if (v319 != NULL) {
        // 0x80877b4
        v4 = (char **)v319;
        free((int32_t *)v319);
        cshelpfile = NULL;
    }
    if (v79 > (char *)25) {
        // 0x8087a1f
        cshelpfile = NULL;
        goto lab_0x8087a29_5;
    }
    int32_t v320 = URLTotal; // 0x80877d9
    if (v320 != 0) {
        // 0x80877e3
        v4 = (char **)v320;
        free((int32_t *)v320);
        URLTotal = 0;
    }
    // 0x80877fb
    if (LYValidate != 0) {
        // 0x8087806
        v4 = (char **)"Bookmark features are currently disabled.";
        char * v321 = gettext("Bookmark features are currently disabled."); // 0x808780d
        v4 = (char **)v321;
        HTAlert(v321);
        v36 = 1;
        goto lab_0x808ad55_2;
    }
    // 0x8087829
    *(int32_t *)&v4 = (int32_t)g235;
    char * v322 = HTParse((char *)g235, (char *)&g20, 25); // 0x8087841
    URLTotal = (int32_t)v322;
    if (v322 == NULL) {
        // 0x8087a1f
        cshelpfile = NULL;
        goto lab_0x8087a29_5;
    }
    // 0x808785a
    v4 = (char **)&newdoc;
    set_address(&newdoc, v322);
    HTuncache_current_document();
    v4 = (char **)&curdoc;
    free_address(&curdoc);
    char * v323 = Home_Dir(); // 0x8087881
    v4 = (char **)v323;
    char * v324 = wwwName(v323); // 0x8087889
    v4 = (char **)&g235;
    HTSACat((char **)&g235, v324);
    v4 = (char **)&g235;
    HTSACat((char **)&g235, "/");
    v4 = (char **)BookmarkPage;
    int32_t v325 = BookmarkPage;
    int32_t v326 = strncmp((char *)BookmarkPage, "./", 2) != 0 ? v325 : v325 + 2;
    v4 = (char **)&g235;
    HTSACat((char **)&g235, (char *)v326);
    v4 = (char **)"Bookmark file";
    char * v327 = gettext("Bookmark file"); // 0x808790c
    v4 = (char **)&newdoc;
    HTSACopy((char **)&newdoc, v327);
    v4 = &g238;
    HTSACopy(&g238, (char *)BookmarkPage);
    if (g254 != NULL) {
        // 0x808793f
        v4 = (char **)&g244;
        HTSACopy((char **)&g244, g254);
    }
    // 0x8087954
    v4 = (char **)&startrealm;
    HTSACopy((char **)&startrealm, (char *)g235);
    v4 = (char **)&newdoc;
    LYFreePostData(&newdoc);
    g239 = 0;
    g240 = 0;
    int32_t v328 = URLTotal; // 0x8087983
    if (v328 != 0) {
        // 0x808798d
        v4 = (char **)v328;
        free((int32_t *)v328);
        URLTotal = 0;
    }
    // 0x80879a5
    v4 = (char **)homepage;
    if (strcmp((char *)homepage, (char *)startfile) == 0) {
        // 0x80879c0
        v4 = (char **)&homepage;
        HTSACopy((char **)&homepage, (char *)g235);
    }
    // 0x80879d5
    v4 = (char **)&startfile;
    HTSACopy((char **)&startfile, (char *)g235);
    v114 = v72;
    v116 = 0;
    if (WWW_TraceFlag != 0) {
        struct _IO_FILE * stream7 = TraceFP(); // 0x80879ff
        v4 = (char **)stream7;
        fprintf(stream7, "Reloading as bookmarks=%s\n", g235);
        v114 = v72;
        v116 = 0;
    }
    goto lab_0x8086941;
  lab_0x8086941:;
    char v122 = v114; // 0x808641f
    char v123 = v116; // 0x808641f
    goto lab_0x8086941_2;
  lab_0x80868ed:
    // 0x80868ed
    user_input_buffer2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    if (WWW_TraceFlag != 0 && LYCursesON != 0) {
        int32_t v126 = LYlines - 1; // 0x808692d
        v4 = (char **)v126;
        LYmove(v126, LYcols + (int32_t)(LYShowScrollbar != 0) - 1);
        LYrefresh();
    }
    // 0x8086941
    char v25; // 0x808641f
    v122 = v25;
    v123 = 0;
    while (true) {
      lab_0x8086941_2:;
        char v124 = v122;
        char ** v125 = g235; // 0x808694a
        if (g245 == NULL || v125 == NULL) {
            // 0x8086994
            v71 = v124;
            if (v125 != NULL) {
                goto lab_0x8086a09;
            } else {
                // 0x808699d
                v4 = (char **)&newdoc;
                LYhist_prev(&newdoc);
                if (g238 != NULL) {
                    // 0x80869f9
                    LYoverride_no_cache = 0;
                    v71 = 1;
                    goto lab_0x8086a09;
                } else {
                    // 0x80869b9
                    if (g236 == 0) {
                        // 0x8086a02
                        LYoverride_no_cache = 1;
                        v71 = 1;
                        goto lab_0x8086a09;
                    } else {
                        // 0x80869c2
                        if (LYresubmit_posts == 0 || (g240 || v123) != 0) {
                            // 0x8086a02
                            LYoverride_no_cache = 1;
                            v71 = 1;
                            goto lab_0x8086a09;
                        } else {
                            // 0x80869e1
                            v4 = (char **)&curdoc;
                            if (are_different(&curdoc, &newdoc) == 0) {
                                // 0x8086a02
                                LYoverride_no_cache = 1;
                                v71 = 1;
                                goto lab_0x8086a09;
                            } else {
                                // 0x80869f9
                                LYoverride_no_cache = 0;
                                v71 = 1;
                                goto lab_0x8086a09;
                            }
                        }
                    }
                }
            }
        } else {
            // 0x8086953
            *(int32_t *)&v4 = (int32_t)v125;
            v71 = v124;
            if (strncasecomp((char *)v125, "LYNXDOWNLOAD:", 13) != 0) {
                // 0x8086978
                v4 = (char **)&curdoc;
                LYpush(&curdoc, force_load);
                v71 = v124;
            }
            goto lab_0x8086a09;
        }
    }
  lab_0x8086b99:
    // 0x8086b99
    c = 0;
    old_c = 37;
    char v30; // 0x808641f
    char v127 = v30; // 0x8086bad
    int32_t v29; // 0x808641f
    int32_t v128 = v29; // 0x8086bad
    int32_t v28; // 0x808641f
    int32_t v129 = v28; // 0x8086bad
    int32_t v27; // 0x808641f
    int32_t v130 = v27; // 0x8086bad
    char v131 = v26; // 0x8086bad
    char v132 = v72; // 0x8086bad
    int32_t v24; // 0x808641f
    int32_t v133 = v24; // 0x8086bad
    int32_t v23; // 0x808641f
    int32_t v134 = v23; // 0x8086bad
    goto lab_0x8089985_3;
  lab_0x8089985_3:
    // 0x8089985
    v44 = v134;
    v43 = v133;
    v42 = v132;
    v41 = v131;
    v55 = v130;
    v39 = v129;
    v54 = v128;
    v37 = v127;
    v56 = v37;
    int32_t * v135; // 0x808641f
    char v136; // 0x808641f
    while (true) {
      lab_0x8089985_2:
        // 0x8089985
        force_old_UCLYhndl_on_reload = 0;
        if (WWW_TraceFlag != 0) {
            struct _IO_FILE * stream4 = TraceFP(); // 0x8089997
            v4 = (char **)stream4;
            fflush(stream4);
        }
        // 0x80899a4
        v68 = old_c;
        if ((v68 || 1) != 33) {
            // 0x80899ba
            len = -1;
        }
        // 0x80899c4
        g386 = v68 + 1;
        v38 = v54;
        v40 = v55;
        v59 = v68;
        v36 = 0;
        int32_t recall; // bp-1252, 0x808641f
        switch (v68) {
            case -1: {
                // 0x80899eb
                v4 = (char **)"Unknown or ambiguous command";
                char * v137 = gettext("Unknown or ambiguous command"); // 0x80899f2
                v4 = (char **)v137;
                HTUserMsg(v137);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 1: {
                // 0x8089c23
                v4 = (char **)&v7;
                old_c = handle_LYK_COMMAND(&v7);
                goto lab_0x8089985_2;
            }
            case 2: {
                // 0x8089c46
                v136 = ForcePush;
                goto lab_0x8089c46_2;
            }
            case 3: {
                // 0x8089c46
                v136 = ForcePush;
                goto lab_0x8089c46_2;
            }
            case 4: {
                // 0x8089c46
                v136 = ForcePush;
                goto lab_0x8089c46_2;
            }
            case 5: {
                // 0x8089c46
                v136 = ForcePush;
                goto lab_0x8089c46_2;
            }
            case 6: {
                // 0x8089c46
                v136 = ForcePush;
                goto lab_0x8089c46_2;
            }
            case 7: {
                // 0x8089c46
                v136 = ForcePush;
                goto lab_0x8089c46_2;
            }
            case 8: {
                // 0x8089c46
                v136 = ForcePush;
                goto lab_0x8089c46_2;
            }
            case 9: {
                // 0x8089c46
                v136 = ForcePush;
                goto lab_0x8089c46_2;
            }
            case 10: {
                // 0x8089c46
                v136 = ForcePush;
                goto lab_0x8089c46_2;
            }
            case 11: {
                // 0x8089c8b
                v4 = (char **)&ownerS_address;
                handle_LYK_SOURCE((char **)&ownerS_address);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 12: {
                goto lab_0x8089cdf;
            }
            case 13: {
                // 0x8089d1a
                v38 = v54;
                v40 = v55;
                v36 = 0;
                if (handle_LYK_QUIT() != 0) {
                    goto lab_0x808ad55_2;
                }
                goto lab_0x80868ab_14;
            }
            case 14: {
                goto lab_0x808ad55_2;
            }
            case 15: {
                // 0x8089d45
                v4 = (char **)&c;
                handle_LYK_NEXT_PAGE(&c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 16: {
                // 0x8089d62
                v4 = (char **)&c;
                handle_LYK_PREV_PAGE(&c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 17: {
                // 0x8089d7f
                v4 = (char **)&real_cmd;
                handle_LYK_UP_TWO(&real_cmd, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 18: {
                // 0x8089da6
                v4 = (char **)&c;
                handle_LYK_DOWN_TWO(&c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 19: {
                // 0x8089dc3
                v4 = (char **)&real_cmd;
                handle_LYK_UP_HALF(&real_cmd, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 20: {
                // 0x8089dea
                v4 = (char **)&c;
                handle_LYK_DOWN_HALF(&c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 21: {
                // 0x808a295
                v3 = 1;
                lynx_force_repaint();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 22: {
                // 0x808a2a6
                if (g252 >= (char *)2) {
                    // 0x808a2b0
                    Newline = 1;
                    v38 = v54;
                    v40 = v55;
                    goto lab_0x80868ab_14;
                }
                // 0x808a2bf
                old_c = 16;
                goto lab_0x8089985_2;
            }
            case 23: {
                int32_t v138 = HText_getNumOfLines() - display_lines + 2; // 0x808a2e0
                if (v138 >= 1 && Newline != v138) {
                    // 0x808a2ff
                    Newline = v138;
                    real_cmd = 1;
                    v38 = v54;
                    v40 = v55;
                    goto lab_0x80868ab_14;
                }
                // 0x808a319
                old_c = 15;
                goto lab_0x8089985_2;
            }
            case 24: {
                // 0x808a328
                handle_LYK_FIRST_LINK();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 25: {
                // 0x808a332
                handle_LYK_LAST_LINK();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 26: {
                goto lab_0x808a33c;
            }
            case 27: {
                goto lab_0x808a363;
            }
            case 28: {
                goto lab_0x808a33c;
            }
            case 29: {
                goto lab_0x808a363;
            }
            case 30: {
                // 0x808a3a7
                v4 = (char **)&old_c;
                char v139 = handle_LYK_FASTBACKW_LINK(&old_c, &c, v56); // 0x808a3c4
                v38 = v54;
                v40 = v55;
                if (v139 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 31: {
                // 0x808a38a
                v4 = (char **)&c;
                handle_LYK_FASTFORW_LINK(&c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 32: {
                // 0x808a3d6
                v4 = (char **)&len;
                handle_LYK_UP_LINK(&len, &real_cmd, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 33: {
                // 0x808a407
                v4 = (char **)&len;
                handle_LYK_DOWN_LINK(&len, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 34: {
                // 0x808a438
                handle_LYK_RIGHT_LINK();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 35: {
                // 0x808a442
                handle_LYK_LEFT_LINK();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 36: {
                // 0x808a467
                v4 = (char **)(int32_t)force_load;
                v38 = v54;
                v40 = v55;
                if (handle_LYK_HISTORY(force_load) != 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x808a481;
            }
            case 37: {
                goto lab_0x808a481;
            }
            case 38: {
                // 0x808a4d3
                handle_NEXT_DOC();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 39: {
                goto lab_0x808a4fd;
            }
            case 40: {
                goto lab_0x808a4fd;
            }
            case 41: {
                // 0x808a640
                v4 = (char **)&cfp;
                char v140 = handle_LYK_GOTO((int32_t *)&cfp, &v7, (char **)&URLTotal, (int32_t *)&cp, &ch, &recall, &refresh_screen2, &c, v56); // 0x808a699
                v38 = v54;
                v40 = v55;
                if (v140 != 0) {
                    // 0x808a6a6
                    v4 = (char **)cfp;
                    char v141 = do_check_recall((int32_t)cfp, &v7, (char **)&URLTotal, ch, &recall, (int32_t)cp, &refresh_screen2); // 0x808a6eb
                    v38 = v54;
                    v40 = v55;
                    if (v141 != 0) {
                        // 0x808a6f8
                        v4 = (char **)&v7;
                        do_check_goto_URL(&v7, (char **)&URLTotal, user_input_buffer2);
                        v38 = v54;
                        v40 = v55;
                    }
                }
                goto lab_0x80868ab_14;
            }
            case 42: {
                // 0x808a5db
                v4 = (char **)&cfp;
                int32_t v142 = handle_LYK_ECGOTO((int32_t *)&cfp, &v7, (char **)&URLTotal, &c, v56); // 0x808a60c
                v38 = v54;
                v40 = v55;
                if (v142 != 0) {
                    // 0x808a619
                    v4 = (char **)&v7;
                    do_check_goto_URL(&v7, (char **)&URLTotal, user_input_buffer2);
                    v38 = v54;
                    v40 = v55;
                }
                goto lab_0x80868ab_14;
            }
            case 43: {
                goto lab_0x808a72d;
            }
            case 44: {
                // 0x808a71f
                v4 = (char **)&arrowup;
                handle_LYK_DWIMHELP((char **)&arrowup);
                goto lab_0x808a72d;
            }
            case 45: {
                // 0x808a740
                v4 = (char **)&c;
                handle_LYK_INDEX(&c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 46: {
                // 0x808a4dd
                v4 = (char **)&c;
                char v143 = handle_LYK_NOCACHE(&c, v56); // 0x808a4f0
                v38 = v54;
                v40 = v55;
                if (v143 == 0) {
                    goto lab_0x80868ab_14;
                } else {
                    // 0x808a4dd
                    v59 = old_c;
                    goto lab_0x808a4fd;
                }
            }
            case 47: {
                goto lab_0x80868ab_14;
            }
            case 48: {
                // 0x808a75d
                v4 = (char **)&c;
                handle_LYK_MAIN_MENU(&c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 49: {
                // 0x808a795
                v4 = (char **)&old_c;
                char v144 = handle_LYK_OPTIONS(&old_c, &v3); // 0x808a7a8
                v38 = v54;
                v40 = v55;
                if (v144 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 50: {
                // 0x808a7ba
                v4 = (char **)&user_input_buffer2;
                handle_LYK_INDEX_SEARCH(user_input_buffer2, force_load, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 51: {
                goto lab_0x808a7ef;
            }
            case 52: {
                goto lab_0x808a7ef;
            }
            case 53: {
                goto lab_0x808a7ef;
            }
            case 54: {
                // 0x808a80c
                v4 = (char **)&v3;
                handle_LYK_COMMENT(&v3, (char **)&owner_address, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 55: {
                goto lab_0x808a8a4;
            }
            case 56: {
                // 0x808a8fb
                v4 = (char **)&old_c;
                char v145 = handle_LYK_INFO(&old_c); // 0x808a904
                v38 = v54;
                v40 = v55;
                if (v145 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 57: {
                // 0x808a977
                v4 = (char **)&force_load;
                handle_LYK_PRINT(&force_load, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 58: {
                // 0x808aa5c
                v4 = (char **)&v3;
                handle_LYK_ADD_BOOKMARK(&v3, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 59: {
                // 0x808a8c1
                v4 = (char **)&v3;
                handle_LYK_DEL_BOOKMARK(&v3, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 60: {
                // 0x808aa83
                v4 = (char **)&v3;
                handle_LYK_VIEW_BOOKMARK(&v3, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 61: {
                // 0x808a9b9
                v4 = (char **)&old_c;
                char v146 = handle_LYK_VLINKS(&old_c, &crawl_ok); // 0x808a9cc
                v38 = v54;
                v40 = v55;
                if (v146 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 62: {
                // 0x808aaaa
                v4 = (char **)&v3;
                handle_LYK_SHELL(&v3, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 63: {
                // 0x808aad1
                v4 = (char **)&old_c;
                int32_t v147 = handle_LYK_DOWNLOAD(&old_c, &c, v56); // 0x808aaee
                v38 = v54;
                v40 = v55;
                if (v147 != 2) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 64: {
                // 0x808ab22
                handle_LYK_TRACE_TOGGLE();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 65: {
                // 0x808ab2c
                v4 = (char **)&first_file;
                handle_LYK_TRACE_LOG(&first_file);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 66: {
                // 0x808ab3f
                v4 = (char **)&old_c;
                char v148 = handle_LYK_IMAGE_TOGGLE(&old_c); // 0x808ab48
                v38 = v54;
                v40 = v55;
                if (v148 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 67: {
                // 0x808ab5a
                v4 = (char **)&old_c;
                char v149 = handle_LYK_INLINE_TOGGLE(&old_c); // 0x808ab63
                v38 = v54;
                v40 = v55;
                if (v149 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 68: {
                // 0x808ab90
                v4 = (char **)&old_c;
                char v150 = handle_LYK_HEAD(&old_c); // 0x808ab99
                v38 = v54;
                v40 = v55;
                if (v150 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 69: {
                goto lab_0x80868ab_14;
            }
            case 70: {
                // 0x808abab
                handle_LYK_TOGGLE_HELP();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 71: {
                int32_t v151 = ForcePush; // 0x808abe6
                v4 = (char **)v151;
                char v152 = handle_LYK_JUMP(v151, &v7, (char **)&URLTotal, (int32_t *)&cp, &refresh_screen2, &recall, &ch, (int32_t *)&cfp, &c, v56); // 0x808ac49
                v38 = v54;
                v40 = v55;
                if (v152 != 0) {
                    // 0x808ac56
                    v4 = (char **)cfp;
                    char v153 = do_check_recall((int32_t)cfp, &v7, (char **)&URLTotal, ch, &recall, (int32_t)cp, &refresh_screen2); // 0x808ac9b
                    v38 = v54;
                    v40 = v55;
                    if (v153 != 0) {
                        // 0x808aca8
                        v4 = (char **)&v7;
                        do_check_goto_URL(&v7, (char **)&URLTotal, user_input_buffer2);
                        v38 = v54;
                        v40 = v55;
                    }
                }
                goto lab_0x80868ab_14;
            }
            case 72: {
                // 0x808abb5
                v4 = (char **)&refresh_screen;
                handle_LYK_KEYMAP(&refresh_screen, user_input_buffer, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 73: {
                // 0x808a99e
                v4 = (char **)&old_c;
                char v154 = handle_LYK_LIST(&old_c); // 0x808a9a7
                v38 = v54;
                v40 = v55;
                if (v154 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 74: {
                // 0x808a9de
                v4 = (char **)&first_file2;
                handle_LYK_TOOLBAR(&first_file2, user_input_buffer2, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 75: {
                // 0x8089cf2
                handle_LYK_HISTORICAL();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 76: {
                // 0x8089cfc
                handle_LYK_MINIMAL();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 77: {
                // 0x8089d06
                handle_LYK_SOFT_DQUOTES();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 78: {
                // 0x808ab75
                v4 = (char **)&old_c;
                char v155 = handle_LYK_RAW_TOGGLE(&old_c); // 0x808ab7e
                v38 = v54;
                v40 = v55;
                if (v155 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 79: {
                // 0x808a44c
                v4 = (char **)&old_c;
                char v156 = handle_LYK_COOKIE_JAR(&old_c); // 0x808a455
                v38 = v54;
                v40 = v55;
                if (v156 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 80: {
                // 0x8089c3c
                ForcePush = 0;
                v136 = 0;
                goto lab_0x8089c46_2;
            }
            case 81: {
                // 0x808accf
                v4 = (char **)&c;
                handle_LYK_CLEAR_AUTH(&c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 82: {
                // 0x8089d10
                handle_LYK_SWITCH_DTD();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 83: {
                // 0x808a576
                v4 = (char **)&cfp;
                int32_t v157 = handle_LYK_ELGOTO((int32_t *)&cfp, &v7, (char **)&URLTotal, &c, v56); // 0x808a5a7
                v38 = v54;
                v40 = v55;
                if (v157 != 0) {
                    // 0x808a5b4
                    v4 = (char **)&v7;
                    do_check_goto_URL(&v7, (char **)&URLTotal, user_input_buffer2);
                    v38 = v54;
                    v40 = v55;
                }
                goto lab_0x80868ab_14;
            }
            case 84: {
                // 0x808a42e
                do_change_link();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 85: {
                // 0x808a862
                v4 = (char **)&old_c;
                int32_t v158 = handle_LYK_DWIMEDIT(&old_c, &c, v56); // 0x808a87f
                v38 = v54;
                v40 = v55;
                switch (v158) {
                    case 1: {
                        goto lab_0x80868ab_14;
                    }
                    case 2: {
                        goto lab_0x8089985_2;
                    }
                    default: {
                        goto lab_0x808a8a4;
                    }
                }
            }
            case 86: {
                // 0x808a916
                v4 = (char **)&v3;
                handle_LYK_EDIT_TEXTAREA(&v3, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 87: {
                // 0x808a93d
                v4 = (char **)&v3;
                handle_LYK_GROW_TEXTAREA(&v3);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 88: {
                // 0x808a950
                v4 = (char **)&v3;
                handle_LYK_INSERT_FILE(&v3, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 89: {
                // 0x808aa36
                v4 = (char **)&v3;
                handle_LYK_EXTERN_LINK(&v3);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 90: {
                // 0x808aa49
                v4 = (char **)&v3;
                handle_LYK_EXTERN_PAGE(&v3);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 91: {
                // 0x808aa0f
                v4 = (char **)&v3;
                handle_LYK_DIRED_MENU(&v3, &c, v56);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 92: {
                // 0x808a858
                handle_LYK_CREATE();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 93: {
                // 0x808a8e8
                v4 = (char **)&v3;
                handle_LYK_REMOVE(&v3);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 94: {
                // 0x808a845
                v4 = (char **)&v3;
                handle_LYK_MODIFY(&v3);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 95: {
                // 0x808a83b
                handle_LYK_TAG_LINK();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 96: {
                // 0x808ab18
                handle_LYK_UPLOAD();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 98: {
                // 0x8089c9c
                if (no_table_center == 0) {
                    // 0x8089cc4
                    no_table_center = 1;
                    v4 = (char **)"TABLE center disable.";
                    char * v159 = gettext("TABLE center disable."); // 0x8089cd2
                    v4 = (char **)v159;
                    HTInfoMsg(v159);
                } else {
                    // 0x8089ca7
                    no_table_center = 0;
                    v4 = (char **)"TABLE center enable.";
                    char * v160 = gettext("TABLE center enable."); // 0x8089cb5
                    v4 = (char **)v160;
                    HTInfoMsg(v160);
                }
                goto lab_0x8089cdf;
            }
            case 99: {
                // 0x808acec
                handle_LYK_CHDIR();
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 100: {
                // 0x808acf6
                v4 = (char **)&v3;
                handle_LYK_SHIFT_LEFT(&v3, v43);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 101: {
                // 0x808ad13
                v4 = (char **)&v3;
                handle_LYK_SHIFT_RIGHT(&v3, v43);
                v38 = v54;
                v40 = v55;
                goto lab_0x80868ab_14;
            }
            case 102: {
                // 0x808ad30
                v4 = (char **)&old_c;
                char v161 = handle_LYK_LINEWRAP_TOGGLE(&old_c, &v3); // 0x808ad43
                v38 = v54;
                v40 = v55;
                if (v161 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            case 103: {
                // 0x8089f44
                if (no_goto == 0) {
                    goto lab_0x8089f73;
                } else {
                    // 0x8089f4f
                    if (LYValidate != 0) {
                        goto lab_0x8089f73;
                    } else {
                        // 0x8089f5a
                        v4 = (char **)"Goto a random URL is disallowed!";
                        char * v162 = gettext("Goto a random URL is disallowed!"); // 0x8089f61
                        v4 = (char **)v162;
                        HTUserMsg(v162);
                        v38 = v54;
                        v40 = v55;
                        goto lab_0x80868ab_14;
                    }
                }
            }
            case 104: {
                // 0x8089e07
                v135 = (int32_t *)&g245;
                if (nlinks < 1) {
                    goto lab_0x8089eb0;
                } else {
                    int32_t v163 = 68 * g251; // 0x8089e21
                    v135 = (int32_t *)&g245;
                    if (*(int32_t *)(v163 + (int32_t)&links) == 0) {
                        goto lab_0x8089eb0;
                    } else {
                        // 0x8089e2d
                        v135 = (int32_t *)&g245;
                        if (*(int32_t *)(v163 + (int32_t)&g347) == 1) {
                            goto lab_0x8089eb0;
                        } else {
                            // 0x8089e47
                            mustshow = 1;
                            v4 = (char **)"Copy D)ocument's or L)ink's URL to clipboard or C)ancel?";
                            statusline("Copy D)ocument's or L)ink's URL to clipboard or C)ancel?");
                            int32_t v164 = LYgetch_single(); // 0x8089e5a
                            v135 = (int32_t *)&g245;
                            if (v164 != 68) {
                                // 0x8089e7b
                                v38 = v54;
                                v40 = v55;
                                if (v164 == 67) {
                                    goto lab_0x80868ab_14;
                                } else {
                                    // 0x8089e88
                                    v135 = (int32_t *)(68 * g251 + (int32_t)&links);
                                    goto lab_0x8089eb0;
                                }
                            } else {
                                goto lab_0x8089eb0;
                            }
                        }
                    }
                }
            }
            case 105: {
                // 0x808a77a
                v4 = (char **)&old_c;
                char v165 = handle_LYK_NESTED_TABLES(&old_c); // 0x808a783
                v38 = v54;
                v40 = v55;
                if (v165 == 0) {
                    goto lab_0x80868ab_14;
                }
                goto lab_0x8089985_2;
            }
            default: {
                goto lab_0x8089a04;
            }
        }
    }
  lab_0x8089a04:;
    int32_t v166 = g251; // 0x8089a04
    if (v166 > -1 == v166 < nlinks) {
        int32_t v167 = 68 * v166;
        if (*(int32_t *)(v167 + (int32_t)&g347) != 1) {
            goto lab_0x8089b7f;
        } else {
            int32_t v168 = *(int32_t *)(v167 + (int32_t)&g354); // 0x8089a51
            int32_t v169 = *(int32_t *)(v168 + 8); // 0x8089a57
            switch (v169) {
                case 1: {
                    // 0x8089ad7
                    __asm_rep_movsd_memcpy((char *)&v4, (char *)(v167 + (int32_t)&links), 17);
                    show_main_statusline((int32_t)&g391, (int32_t)&g391);
                    goto lab_0x8089bb4;
                }
                case 12: {
                    // 0x8089ad7
                    __asm_rep_movsd_memcpy((char *)&v4, (char *)(v167 + (int32_t)&links), 17);
                    show_main_statusline((int32_t)&g391, (int32_t)&g391);
                    goto lab_0x8089bb4;
                }
                case 2: {
                    // 0x8089ad7
                    __asm_rep_movsd_memcpy((char *)&v4, (char *)(v167 + (int32_t)&links), 17);
                    show_main_statusline((int32_t)&g391, (int32_t)&g391);
                    goto lab_0x8089bb4;
                }
                case 11: {
                    // 0x8089ad7
                    __asm_rep_movsd_memcpy((char *)&v4, (char *)(v167 + (int32_t)&links), 17);
                    show_main_statusline((int32_t)&g391, (int32_t)&g391);
                    goto lab_0x8089bb4;
                }
                default: {
                    if (v169 != 9) {
                        goto lab_0x8089b7f;
                    } else {
                        // 0x8089ad7
                        __asm_rep_movsd_memcpy((char *)&v4, (char *)(v167 + (int32_t)&links), 17);
                        show_main_statusline((int32_t)&g391, (int32_t)&g391);
                        goto lab_0x8089bb4;
                    }
                }
            }
        }
    } else {
        goto lab_0x8089b7f;
    }
  lab_0x8089b7f:
    // 0x8089b7f
    if (more_text == 0) {
        // 0x8089ba0
        v4 = (char **)"Commands: Use arrow keys to move, '?' for help, 'q' to quit, '<-' to go back.";
        char * v170 = gettext("Commands: Use arrow keys to move, '?' for help, 'q' to quit, '<-' to go back."); // 0x8089ba7
        v4 = (char **)v170;
        HTInfoMsg(v170);
    } else {
        // 0x8089b8a
        v4 = (char **)"-- press space for more, use arrow keys to move, '?' for help, 'q' to quit.";
        char * v171 = gettext("-- press space for more, use arrow keys to move, '?' for help, 'q' to quit."); // 0x8089b91
        v4 = (char **)v171;
        HTInfoMsg(v171);
    }
    goto lab_0x8089bb4;
  lab_0x8087e3d:
    // 0x8087e3d
    if (dump_output_immediately != 0) {
        // break -> 0x8087e48
        goto lab_0x8087e48;
    }
    // 0x8087eb9
    char v33; // 0x808641f
    char v222 = v33;
    int32_t v32; // 0x808641f
    int32_t v202 = v32;
    if (recent_sizechange != 0) {
        // 0x8087ec4
        v4 = (char **)LYlines;
        function_804aa94(LYlines, LYcols);
        v4 = (char **)LYwin;
        function_804afb4((int32_t)LYwin, LYlines, LYcols);
        v3 = 1;
        if (HTMainText != NULL) {
            // 0x8087f0c
            v4 = (char **)HTMainText;
            HText_setStale(HTMainText);
        }
        // 0x8087f19
        recent_sizechange = 0;
        LYSetDisplayLines();
    }
    int32_t v304 = www_search_result; // 0x8087f25
    if (v304 != -1) {
        // 0x8087f2f
        Newline = v304;
        www_search_result = -1;
    }
    char v173 = v26; // 0x8087f4a
    if (v26 != 1) {
        goto lab_0x80883da;
    } else {
        // 0x8087f50
        *(int32_t *)&v4 = (int32_t)g245;
        char * v305 = HTParse((char *)g245, (char *)&g20, 25); // 0x8087f6f
        URLTotal = (int32_t)v305;
        if (v305 == NULL) {
            goto lab_0x8087f91;
        } else {
            // 0x8087f84
            if (*v305 != 0) {
                // 0x8087fb2
                v4 = (char **)&startrealm;
                HTSACopy((char **)&startrealm, v305);
                int32_t v306 = URLTotal; // 0x8087fc8
                if (v306 != 0) {
                    // 0x8087fd2
                    v4 = (char **)v306;
                    free((int32_t *)v306);
                    URLTotal = 0;
                }
                char ** v307 = g245;
                *(int32_t *)&v4 = (int32_t)v307;
                char * v308 = HTParse((char *)v307, (char *)&g20, 5); // 0x8088002
                URLTotal = (int32_t)v308;
                if (v308 != NULL) {
                    char v309; // 0x80864db
                    if (v309 != 0) {
                        char v310 = dump_output_immediately; // 0x8088035
                        if (v310 == 0) {
                            char * v311 = g248; // 0x8088044
                            if (v311 == NULL) {
                                char ** v312 = g245; // 0x8088051
                                char v313 = *(char *)v312; // 0x8088056
                                if (v313 != 102 != v313 != 70) {
                                    // 0x808806d
                                    *(int32_t *)&v4 = (int32_t)v312;
                                    if (strncasecomp((char *)v312, "file:", 5) == 0) {
                                        int32_t str19 = URLTotal; // 0x808808e
                                        v4 = (char **)str19;
                                        if (strlen((char *)str19) >= 2) {
                                            int32_t v314 = URLTotal; // 0x80880a1
                                            v4 = (char **)v314;
                                            int32_t v315; // bp-1304, 0x808641f
                                            int32_t * v316 = HTFileFormat((char *)v314, (int32_t **)&v315, NULL); // 0x80880bc
                                            v4 = (char **)"text/html";
                                            if (v316 != HTAtom_for("text/html")) {
                                                int32_t v317 = URLTotal; // 0x80880d3
                                                v4 = (char **)v317;
                                                HTSetSuffix5((char *)v317, "text/html", "8bit", NULL, 1.0);
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                    int32_t str20 = URLTotal; // 0x80880ff
                    v4 = (char **)str20;
                    char * found_char_pos = strrchr((char *)str20, 47); // 0x8088110
                    cshelpfile = found_char_pos;
                    if (found_char_pos != NULL) {
                        // 0x8088125
                        *(char *)((int32_t)found_char_pos + 1) = 0;
                        int32_t v318 = URLTotal; // 0x8088131
                        v4 = (char **)&startrealm;
                        HTSACat((char **)&startrealm, (char *)v318);
                    }
                } else {
                    // 0x8088017
                    v4 = (char **)&startrealm;
                    LYAddHtmlSep((char **)&startrealm);
                }
                goto lab_0x8088147;
            } else {
                goto lab_0x8087f91;
            }
        }
    }
  lab_0x8089bb4:
    // 0x8089bb4
    v38 = v54;
    v40 = 1;
    int32_t str9; // bp-148, 0x808641f
    if (WWW_TraceFlag != 0) {
        // 0x8089bcd
        v4 = (char **)&str9;
        sprintf((char *)&str9, "%d", (int32_t)ForcePush);
        v4 = (char **)&str9;
        int32_t len3 = strlen((char *)&str9); // 0x8089bf6
        v4 = (char **)LYwin;
        LYwaddnstr(LYwin, (char *)&str9, len3);
        str9 = 0;
        v38 = v54;
        v40 = 1;
    }
    goto lab_0x80868ab_14;
  lab_0x80883da:;
    char v172 = v173;
    if (HTdocument_settings_changed() != 0) {
        // 0x80883e3
        if (HTcan_reparse_document() != 0) {
            // 0x80883ec
            v4 = (char **)"Reparsing document under current settings...";
            char * v174 = gettext("Reparsing document under current settings..."); // 0x80883f3
            v4 = (char **)v174;
            HTInfoMsg(v174);
            reparse_document();
        }
    }
    // 0x8088405
    char * v175; // 0x808641f
    if (from_source_cache == 0) {
        // 0x8088405
        v175 = g252;
    } else {
        // 0x8088410
        from_source_cache = 0;
        g252 = (char *)-1;
        v175 = (char *)-1;
    }
    int32_t v176 = Newline; // 0x8088427
    int32_t v177; // 0x808641f
    if (v176 == (int32_t)v175) {
        // 0x80885db
        v177 = v27;
        if (g241 < 0) {
            // 0x80885e4
            g241 = 0;
            v177 = v27;
        }
    } else {
        // 0x8088434
        v3 = 0;
        v4 = (char **)v176;
        HText_pageDisplay(v176, prev_target);
        if (!((lynx_edit_mode == 0 | nlinks < 1)) && tagged != NULL && dir_list_order != 0) {
            // 0x8088479
            v4 = (char **)tagged;
            showtags(tagged);
        }
        // 0x8088486
        more_text = HText_canScrollDown();
        if (g241 < 0) {
            // 0x8088499
            v4 = (char **)Newline;
            goto_line(Newline);
        }
        int32_t v178 = HText_getTopOfScreen() + 1; // 0x80884ab
        Newline = v178;
        g252 = (char *)v178;
        if (curdoc == 0) {
            // 0x80884c6
            if (HText_getTitle() == NULL) {
                // 0x80884e6
                v4 = (char **)&curdoc;
                HTSACopy((char **)&curdoc, (char *)newdoc);
            } else {
                char * v179 = HText_getTitle(); // 0x80884cf
                v4 = (char **)&curdoc;
                HTSACopy((char **)&curdoc, v179);
            }
        }
        // 0x80884fb
        if (crawl_ok != 0) {
            // 0x8088506
            crawl_ok = 0;
            char * v180 = g252; // 0x808850d
            if (v180 >= (char *)2) {
                // 0x8088517
                v4 = (char **)HTMainText;
                g241 -= HText_LinksInLines(HTMainText, 1, (int32_t)v180 - 1);
            }
        }
        // 0x808854a
        if (real_cmd == 0) {
            int32_t v181 = g241; // 0x808856d
            g251 = v181;
            if (v181 < nlinks) {
                if (v181 < 0 && nlinks >= 1) {
                    // 0x80885a7
                    g251 = 0;
                }
            } else {
                // 0x8088586
                g251 = nlinks - 1;
            }
        } else {
            // 0x8088554
            g251 = nlinks - 1;
            real_cmd = 0;
        }
        // 0x80885b1
        g242 = (char *)1;
        g241 = 0;
        g252 = (char *)Newline;
        v177 = 0;
    }
    int32_t v182 = v177;
    if (v3 != 0) {
        // 0x80885fd
        if (enable_scrollback == 0) {
            // 0x808860f
            LYerase();
        } else {
            // 0x8088608
            LYclear();
        }
        // 0x8088614
        v4 = (char **)Newline;
        HText_pageDisplay(Newline, prev_target);
        if (!((lynx_edit_mode == 0 | nlinks < 1)) && tagged != NULL && dir_list_order != 0) {
            // 0x8088652
            v4 = (char **)tagged;
            showtags(tagged);
        }
        char v183 = HText_canScrollDown(); // 0x808865f
        more_text = v183;
        int32_t v184 = g251; // 0x8088669
        if (v184 < nlinks) {
            if (v184 < 0 && nlinks >= 1) {
                // 0x8088699
                g251 = 0;
            }
        } else {
            // 0x8088678
            g251 = nlinks - 1;
        }
        // 0x80886a3
        if (user_mode == 0) {
            int32_t v185 = v183; // 0x80886b3
            v4 = (char **)v185;
            noviceline(v185);
        }
        // 0x80886be
        v3 = 0;
    }
    bool v186 = true; // 0x80886cc
    if (nlinks < 1) {
        goto lab_0x80887cb;
    } else {
        int32_t v187 = 68 * g251; // 0x80886df
        v186 = true;
        if (*(int32_t *)(v187 + (int32_t)&g347) != 1) {
            goto lab_0x80887cb;
        } else {
            int32_t v188 = *(int32_t *)(v187 + (int32_t)&g354); // 0x80886ff
            int32_t v189 = *(int32_t *)(v188 + 8); // 0x8088705
            switch (v189) {
                case 1: {
                    goto lab_0x80887ad;
                }
                case 12: {
                    goto lab_0x80887ad;
                }
                case 2: {
                    goto lab_0x80887ad;
                }
                case 11: {
                    goto lab_0x80887ad;
                }
                default: {
                    // 0x8088764
                    v186 = true;
                    if (v189 != 9) {
                        goto lab_0x80887cb;
                    } else {
                        goto lab_0x80887ad;
                    }
                }
            }
        }
    }
  lab_0x80887cb:;
    bool v190 = v186; // 0x80887cb
    char v191 = 0; // 0x80887cb
    goto lab_0x80887d5;
  lab_0x8087f91:
    // 0x8087f91
    v4 = (char **)"None";
    char * v303 = gettext("None"); // 0x8087f98
    v4 = (char **)&startrealm;
    HTSACopy((char **)&startrealm, v303);
    goto lab_0x8088147;
  lab_0x80887d5:;
    char v192 = v191;
    bool v193 = v190;
    if (textfields_need_activation == 0) {
        // 0x80887ed
        textinput_activated = 1;
    }
    // 0x80887f4
    if (check_mail != 0) {
        // 0x80887ff
        if (no_mail == 0) {
            // 0x808880a
            LYCheckMail();
        }
    }
    int32_t v194 = 0; // 0x8088816
    if (v182 == 0) {
        // 0x8088818
        __asm_rep_movsd_memcpy((char *)&v4, (char *)(68 * g251 + (int32_t)&links), 17);
        show_main_statusline((int32_t)&g391, (int32_t)&g391);
        v194 = v182;
    }
    int32_t v195 = v194;
    if (nlinks >= 1) {
        if (!v193) {
            // 0x80888cc
            if (textinput_activated == 0) {
                // 0x80888d7
                v4 = (char **)1;
                LYhighlight(1, g251, prev_target);
            }
        } else {
            // 0x80888ad
            v4 = (char **)1;
            LYhighlight(1, g251, prev_target);
        }
    }
    // 0x80888f4
    int32_t v196; // 0x808641f
    int32_t v197; // 0x808641f
    int32_t v198; // 0x808641f
    char v199; // 0x808641f
    uint32_t v200; // 0x808641f
    char v201; // 0x808641f
    if (traversal == 0) {
        if (v193) {
            goto lab_0x8089670;
        } else {
            // 0x8088a40
            if (v202 == -1 == textinput_activated == 0) {
                goto lab_0x8089670;
            } else {
                int32_t v203 = v202; // 0x8088a5f
                if (v202 == -1) {
                    // 0x8088a79
                    if (user_mode == 0) {
                        int32_t v204 = *(int32_t *)(68 * g251 + (int32_t)&g354); // 0x8088a91
                        int32_t v205 = *(int32_t *)(v204 + 80); // 0x8088a97
                        v4 = (char **)v205;
                        form_noviceline(v205);
                    }
                    // 0x8088aa2
                    v4 = (char **)g251;
                    v203 = change_form_link(g251, &newdoc, &v3, v192, 0);
                }
                // 0x8088adb
                v200 = v203;
                if (textfields_need_activation != 0) {
                    // 0x8088ae6
                    textinput_activated = 0;
                }
                // 0x8088afd
                v199 = v200;
                char v206 = v199; // 0x8088b0a
                if (v199 > -1) {
                    uint32_t v207 = 0x1000000 * v200 / 0x1000000; // 0x8088b10
                    int32_t v208; // 0x808641f
                    if ((v207 & 2048) == 0) {
                        // 0x8088b78
                        v208 = v207 % 2048;
                    } else {
                        uint32_t v209 = v200 % 256;
                        char ** v210 = (char **)v209; // 0x8088b2a
                        v4 = v210;
                        if (LYReverseKeymap(v209) < 0) {
                            // 0x8088b51
                            v208 = v209 | 2048;
                        } else {
                            // 0x8088b36
                            v4 = v210;
                            v208 = LYReverseKeymap(v209);
                        }
                    }
                    // 0x8088b8c
                    v206 = v208;
                }
                // 0x8088bbe
                ForcePush = v206;
                if (peek_mouse_link() != -1) {
                    // 0x8088be1
                    if (peek_mouse_link() != -2) {
                        // 0x8088beb
                        c = 0;
                    }
                }
                // 0x8088bf5
                if (peek_mouse_link() < 0) {
                    goto lab_0x8088d53;
                } else {
                    if (v199 != -1) {
                        int32_t v211 = 0x1000000 * v200;
                        if ((v211 >> 24 & 0x8800) == 0) {
                            // 0x8088c43
                            if (*(int16_t *)((v211 >> 23 & 4094) + 0x8197ea2) == 84) {
                                goto lab_0x8088d53;
                            } else {
                                goto lab_0x8088c63;
                            }
                        } else {
                            if (v199 == 84) {
                                goto lab_0x8088d53;
                            } else {
                                goto lab_0x8088c63;
                            }
                        }
                    } else {
                        // 0x8088c0b
                        if (keymap[0] == 84) {
                            goto lab_0x8088d53;
                        } else {
                            goto lab_0x8088c63;
                        }
                    }
                }
            }
        }
    } else {
        // 0x8088903
        v201 = v30;
        v198 = v202;
        v197 = v24;
        v196 = v23;
        if (crawl != 0 && popped_doc != 0) {
            // 0x8088921
            popped_doc = 0;
            v4 = (char **)&str9;
            sprintf((char *)&str9, "lnk%08d.dat", crawl_count);
            crawl_count++;
            v4 = (char **)&str9;
            struct _IO_FILE * v212 = LYNewTxtFile((char *)&str9); // 0x808895d
            if (v212 == NULL) {
                // 0x80889a5
                if (dump_output_immediately != 0) {
                    goto lab_0x80889b5;
                } else {
                    // 0x80889b0
                    cleanup();
                    goto lab_0x80889b5;
                }
            }
            // 0x8088971
            v4 = (char **)v212;
            print_crawl_to_fd(v212, (char *)g245, (char *)curdoc);
            v4 = (char **)v212;
            LYCloseOutput(v212);
            v201 = v30;
            v198 = v202;
            v197 = v24;
            v196 = v23;
        }
        goto lab_0x8089795;
    }
  lab_0x8088147:;
    int32_t v213 = URLTotal; // 0x8088147
    if (v213 != 0) {
        // 0x8088151
        v4 = (char **)v213;
        free((int32_t *)v213);
        URLTotal = 0;
    }
    // 0x8088169
    if (WWW_TraceFlag != 0) {
        struct _IO_FILE * stream5 = TraceFP(); // 0x808817a
        v4 = (char **)stream5;
        fprintf(stream5, "Starting realm is '%s'\n\n", (char *)startrealm);
    }
    // 0x8088195
    if (traversal == 0) {
        goto lab_0x8088344;
    } else {
        int32_t str10 = (int32_t)"NULL"; // 0x80881ab
        if (g245 != NULL) {
            // 0x80881ad
            *(int32_t *)&v4 = (int32_t)g245;
            if (lookup_link((char *)g245) == 0) {
                // 0x80881be
                *(int32_t *)&v4 = (int32_t)g245;
                if (strncasecomp((char *)g245, "LYNXIMGMAP:", 11) != 0) {
                    // 0x80881df
                    popped_doc = 1;
                }
                // 0x80881e6
                *(int32_t *)&v4 = (int32_t)g245;
                add_to_table((char *)g245);
            }
            // 0x80881f3
            str10 = (int32_t)"NULL";
            if (g245 != NULL) {
                // 0x80881fc
                str10 = (int32_t)g245;
            }
        }
        // 0x8088214
        *(int32_t *)&v4 = str10;
        if (strncmp((char *)str10, "http", 4) == 0) {
            // 0x8088257
            if (check_realm == 0) {
                // 0x808827c
                *(int32_t *)&v4 = (int32_t)g245;
                char * v214 = HTParse((char *)g245, (char *)&g20, 25); // 0x8088294
                URLTotal = (int32_t)v214;
                if (v214 == NULL) {
                    goto lab_0x80882b6;
                } else {
                    // 0x80882a9
                    if (*v214 != 0) {
                        // 0x80882d4
                        v4 = (char **)&traversal_host;
                        HTSACopy((char **)&traversal_host, v214);
                        v4 = (char **)&traversal_host;
                        LYAddHtmlSep((char **)&traversal_host);
                        goto lab_0x80882f6;
                    } else {
                        goto lab_0x80882b6;
                    }
                }
            } else {
                // 0x8088262
                v4 = (char **)&traversal_host;
                HTSACopy((char **)&traversal_host, (char *)startrealm);
                goto lab_0x8088318;
            }
        } else {
            // 0x8088236
            v4 = (char **)"None";
            char * v215 = gettext("None"); // 0x808823d
            v4 = (char **)&traversal_host;
            HTSACopy((char **)&traversal_host, v215);
            goto lab_0x8088318;
        }
    }
  lab_0x80887ad:
    // 0x80887ad
    v186 = false;
    v190 = false;
    v191 = 1;
    if (v28 != 28 == (v28 != 29)) {
        goto lab_0x80887cb;
    } else {
        goto lab_0x80887d5;
    }
  lab_0x8088344:
    // 0x8088344
    if (startfile == 0) {
        goto lab_0x80883af;
    } else {
        // 0x808834d
        if (homepage != 0) {
            // 0x8088356
            int32_t str11; // 0x8088344
            v4 = (char **)str11;
            int32_t str12; // 0x808834d
            if (strcmp((char *)str11, (char *)str12) != 0) {
                int32_t v216 = homepage; // 0x8088371
                v4 = (char **)v216;
                HTAddGotoURL((char *)v216);
            }
        }
        // 0x808837e
        v4 = (char **)startfile;
        if (strcmp((char *)startfile, (char *)g235) != 0) {
            goto lab_0x80883a2;
        } else {
            // 0x8088399
            if (g236 != 0) {
                goto lab_0x80883af;
            } else {
                goto lab_0x80883a2;
            }
        }
    }
  lab_0x8089670:;
    int32_t v217 = LYgetch(); // 0x8089670
    char v218 = v217; // 0x8089675
    ForcePush = v218;
    int32_t v219 = 0x1000000 * v217 >> 24;
    int32_t v220 = v219 == v23 ? v24 + 1 : 1; // 0x808969f
    if (v218 != 3) {
        if (v218 >= 0 && (v219 & 0x2000) != 0) {
            // 0x8089716
            v4 = (char **)v219;
            if (EditBinding(v219) != 6) {
                // 0x8089729
                v4 = NULL;
                int32_t v221 = 2048; // 0x808974b
                if (LYReverseKeymap(0) >= 0) {
                    // 0x808974d
                    v4 = NULL;
                    v221 = LYReverseKeymap(0);
                }
                // 0x808976b
                ForcePush = v221;
            }
        }
        // 0x808977d
        v201 = v218;
        v198 = v202;
        v197 = v220;
        v196 = v219;
        if (c != v219) {
            // 0x808978b
            c = 0;
            v201 = v218;
            v198 = v202;
            v197 = v220;
            v196 = v219;
        }
        goto lab_0x8089795;
    } else {
        // 0x80896bd
        v4 = (char **)2;
        signal(SIGINT, 0x804b4e4);
        c = 0;
        old_c = 13;
        v127 = v218;
        v128 = v202;
        v129 = v28;
        v130 = v195;
        v131 = v172;
        v132 = v222;
        v133 = v220;
        v134 = v219;
        goto lab_0x8089985_3;
    }
  lab_0x8089795:;
    int32_t v223 = v196;
    int32_t v224 = v197;
    int32_t v225 = v198;
    char v226 = v201;
    v61 = v226;
    v62 = v225;
    v63 = v195;
    v64 = v172;
    v65 = v222;
    v66 = v224;
    v67 = v223;
    if (recent_sizechange != 0) {
        char v227 = ForcePush; // 0x80897a0
        v61 = v226;
        v62 = v225;
        v63 = v195;
        v64 = v172;
        v65 = v222;
        v66 = v224;
        v67 = v223;
        if (v227 >= 0 != v227 != 0) {
            // 0x80897aa
            ForcePush = 14;
            v61 = v226;
            v62 = v225;
            v63 = v195;
            v64 = v172;
            v65 = v222;
            v66 = v224;
            v67 = v223;
        }
    }
    goto lab_0x80897b4;
  lab_0x80883af:
    // 0x80883af
    v173 = 0;
    if (WWW_TraceFlag != 0) {
        // 0x80883ba
        v3 = 1;
        v173 = 0;
        if (LYTraceLogFP != NULL != (first_file == 0)) {
            // 0x80883d5
            LYSleepAlert();
            v173 = 0;
        }
    }
    goto lab_0x80883da;
  lab_0x80897b4:;
    int32_t v228 = v67;
    int32_t v229 = v66;
    char v230 = v65;
    char v231 = v64;
    int32_t v232 = v63;
    int32_t v233 = v62;
    char v234 = v61;
    char v235 = ForcePush;
    char v236 = v235; // 0x80897bd
    if (traversal != 0) {
        int32_t v237 = v235; // 0x80897bf
        v4 = (char **)v237;
        char v238 = DoTraversal(v237, &popped_doc); // 0x80897d7
        ForcePush = v238;
        v236 = v238;
        v36 = 1;
        if (v238 < 0) {
            goto lab_0x808ad55_2;
        }
    }
    char v239 = v236; // 0x8089903
    int32_t v240; // 0x808641f
    if (v239 != -1) {
        int32_t v241 = v239; // 0x8089813
        if ((v241 & 0x8800) == 0) {
            uint16_t v242 = *(int16_t *)((2 * v241 & 4094) + (int32_t)&keymap + 2); // 0x8089843
            v240 = v242;
        } else {
            // 0x8089822
            v240 = v239;
        }
    } else {
        // 0x8089801
        v240 = keymap[0];
    }
    int32_t v243 = v240;
    old_c = v243;
    v127 = v234;
    v128 = v233;
    v129 = v243;
    v130 = v232;
    v131 = v231;
    v132 = v230;
    v133 = v229;
    v134 = v228;
    if (lynx_edit_mode != 0) {
        // 0x808987b
        v127 = v234;
        v128 = v233;
        v129 = v243;
        v130 = v232;
        v131 = v231;
        v132 = v230;
        v133 = v229;
        v134 = v228;
        if (no_dired_support == 0) {
            bool v244; // 0x808641f
            if (v239 != -1) {
                int32_t v245 = v239; // 0x80898a8
                if ((v245 & 0x8800) == 0) {
                    // 0x80898cd
                    v244 = *(int16_t *)((2 * v245 & 4094) + 0x81983e2) == 0;
                } else {
                    // 0x80898b7
                    v244 = v239 == 0;
                }
            } else {
                // 0x8089895
                v244 = key_override[0] == 0;
            }
            // 0x80898fa
            v127 = v234;
            v128 = v233;
            v129 = v243;
            v130 = v232;
            v131 = v231;
            v132 = v230;
            v133 = v229;
            v134 = v228;
            if (!v244) {
                int32_t v246; // 0x808641f
                if (v239 != -1) {
                    int32_t v247 = v239; // 0x8089920
                    if ((v247 & 0x8800) == 0) {
                        uint16_t v248 = *(int16_t *)((2 * v247 & 4094) + (int32_t)&key_override + 2); // 0x8089950
                        v246 = v248;
                    } else {
                        // 0x808992f
                        v246 = v239;
                    }
                } else {
                    // 0x808990e
                    v246 = key_override[0];
                }
                // 0x808996d
                old_c = v246;
                v127 = v234;
                v128 = v233;
                v129 = v246;
                v130 = v232;
                v131 = v231;
                v132 = v230;
                v133 = v229;
                v134 = v228;
            }
        }
    }
    goto lab_0x8089985_3;
  lab_0x80883a2:
    // 0x80883a2
    v4 = (char **)startfile;
    HTAddGotoURL((char *)startfile);
    goto lab_0x80883af;
  lab_0x8088318:
    // 0x8088318
    if (WWW_TraceFlag != 0) {
        struct _IO_FILE * stream6 = TraceFP(); // 0x8088329
        v4 = (char **)stream6;
        fprintf(stream6, "Traversal host is '%s'\n\n", (char *)traversal_host);
    }
    goto lab_0x8088344;
  lab_0x8088d53:;
    int32_t v249 = 68 * g251; // 0x8088d60
    int16_t v250; // 0x808641f
    int16_t v251; // 0x808641f
    if (*(int32_t *)(v249 + (int32_t)&g347) != 1) {
        goto lab_0x808931a;
    } else {
        int32_t v252 = *(int32_t *)(v249 + (int32_t)&g354); // 0x8088d80
        if (*(int32_t *)(v252 + 8) != 9 || textfields_need_activation == 0) {
            goto lab_0x808931a;
        } else {
            // 0x8088da1
            if (*(int32_t *)(v252 + 80) != 0) {
                goto lab_0x808931a;
            } else {
                // 0x8088dc1
                if (peek_mouse_link() >= 0) {
                    goto lab_0x808931a;
                } else {
                    if (v199 != -1) {
                        int32_t v253 = 0x1000000 * v200;
                        if ((v253 >> 24 & 0x8800) == 0) {
                            int16_t v254 = *(int16_t *)((v253 >> 23 & 4094) + 0x8197ea2);
                            switch (v254) {
                                case 27: {
                                    goto lab_0x8088f48;
                                }
                                case 39: {
                                    goto lab_0x8088f48;
                                }
                                case 29: {
                                    goto lab_0x8088f48;
                                }
                                default: {
                                    // 0x8088f28
                                    v251 = v254;
                                    if (v254 != 33) {
                                        goto lab_0x8089096;
                                    } else {
                                        goto lab_0x8088f48;
                                    }
                                }
                            }
                        } else {
                            unsigned char v255 = v199 - 27;
                            switch (v255 / 2 || 128 * v255) {
                                case 0: {
                                    goto lab_0x8088f48;
                                }
                                case 6: {
                                    goto lab_0x8088f48;
                                }
                                case 1: {
                                    goto lab_0x8088f48;
                                }
                                case 3: {
                                    goto lab_0x8088f48;
                                }
                                default: {
                                    goto lab_0x8089080;
                                }
                            }
                        }
                    } else {
                        int16_t v256 = keymap[0];
                        uint16_t v257 = v256 - 27;
                        v250 = v256;
                        switch (v257 / 2 || 0x8000 * v257) {
                            case 6: {
                                goto lab_0x8088f48;
                            }
                            case 1: {
                                goto lab_0x8088f48;
                            }
                            case 0: {
                                goto lab_0x8088f48;
                            }
                            case 3: {
                                goto lab_0x8088f48;
                            }
                            default: {
                                goto lab_0x808905e;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x80882b6:
    // 0x80882b6
    v4 = (char **)"None";
    char * v258 = gettext("None"); // 0x80882bd
    v4 = (char **)&traversal_host;
    HTSACopy((char **)&traversal_host, v258);
    goto lab_0x80882f6;
  lab_0x808931a:;
    char v296 = ForcePush; // 0x808931a
    int32_t v266; // 0x808641f
    int32_t v265; // 0x808641f
    if (v296 != 10 == (v296 != 13)) {
        int32_t v297 = c; // 0x8089627
        v201 = v199;
        v198 = -1;
        v197 = v24;
        v196 = v23;
        if (v297 != (int32_t)v296) {
            char v298 = v296 == v199 | v297 == 0x1000000 * v200 / 0x1000000 ? v199 : v296;
            v201 = v298;
            v198 = -1;
            v197 = v24;
            v196 = v23;
        }
        goto lab_0x8089795;
    } else {
        int32_t v299 = g251; // 0x808933c
        int32_t v300 = 68 * v299; // 0x8089349
        if (*(int32_t *)(v300 + (int32_t)&g347) != 1) {
            goto lab_0x8089618;
        } else {
            int32_t v301 = *(int32_t *)(v300 + (int32_t)&g354); // 0x8089369
            if (*(int32_t *)(v301 + 8) != 9) {
                goto lab_0x8089618;
            } else {
                int32_t v302 = nlinks - 1;
                v266 = v302;
                v265 = v299;
                if (v299 != v302) {
                    goto lab_0x80893b9;
                } else {
                    // 0x808938d
                    if (more_text == 0) {
                        goto lab_0x80894e7;
                    } else {
                        // 0x808939c
                        v4 = (char **)v299;
                        if (HText_TAHasMoreLines(v299, 1) == 0) {
                            goto lab_0x80894e7;
                        } else {
                            // 0x808939c
                            v266 = nlinks - 1;
                            v265 = g251;
                            goto lab_0x80893b9;
                        }
                    }
                }
            }
        }
    }
  lab_0x80882f6:;
    int32_t v259 = URLTotal; // 0x80882f6
    if (v259 != 0) {
        // 0x8088300
        v4 = (char **)v259;
        free((int32_t *)v259);
        URLTotal = 0;
    }
    goto lab_0x8088318;
  lab_0x8088c63:
    // 0x8088c63
    do_change_link();
    char v260 = ForcePush; // 0x8088c68
    v201 = v199;
    v198 = -1;
    v197 = v24;
    v196 = v23;
    if (v260 != 10 == (v260 != 13)) {
        goto lab_0x8089795;
    } else {
        int32_t v261 = 68 * g251; // 0x8088c8f
        v201 = v199;
        v198 = -1;
        v197 = v24;
        v196 = v23;
        if (*(int32_t *)(v261 + (int32_t)&g347) != 1) {
            goto lab_0x8089795;
        } else {
            int32_t v262 = *(int32_t *)(v261 + (int32_t)&g354); // 0x8088caf
            int32_t v263 = *(int32_t *)(v262 + 8); // 0x8088cb5
            switch (v263) {
                case 1: {
                    goto lab_0x8088d35;
                }
                case 12: {
                    goto lab_0x8088d35;
                }
                case 2: {
                    goto lab_0x8088d35;
                }
                case 11: {
                    goto lab_0x8088d35;
                }
                default: {
                    // 0x8088d14
                    v201 = v199;
                    v198 = -1;
                    v197 = v24;
                    v196 = v23;
                    if (v263 != 9) {
                        goto lab_0x8089795;
                    } else {
                        goto lab_0x8088d35;
                    }
                }
            }
        }
    }
  lab_0x8089618:
    // 0x8089618
    ForcePush = 27;
    v201 = v199;
    v198 = -1;
    v197 = v24;
    v196 = v23;
    goto lab_0x8089795;
  lab_0x80893b9:;
    int32_t v264 = v265; // 0x8089410
    if (v264 < v266) {
        int32_t v267 = 68 * v264;
        if (*(int32_t *)(v267 + (int32_t)&g347 + 68) != 1) {
            goto lab_0x80894e7;
        } else {
            int32_t str14 = *(int32_t *)(v267 + (int32_t)&g354 + 68); // 0x80893fe
            if (*(int32_t *)(str14 + 8) != 9) {
                goto lab_0x80894e7;
            } else {
                int32_t v268 = *(int32_t *)(v267 + (int32_t)&g354); // 0x808947a
                if (*(int32_t *)(v268 + 4) != *(int32_t *)(str14 + 4)) {
                    goto lab_0x80894e7;
                } else {
                    int32_t str13 = *(int32_t *)v268; // 0x80894d1
                    v4 = (char **)str13;
                    if (strcmp((char *)str13, (char *)*(int32_t *)str14) == 0) {
                        goto lab_0x8089618;
                    } else {
                        goto lab_0x80894e7;
                    }
                }
            }
        }
    } else {
        goto lab_0x8089618;
    }
  lab_0x8088d35:
    // 0x8088d35
    v201 = v199;
    v198 = -1;
    v197 = v24;
    v196 = v23;
    if (textfields_need_activation == 0) {
        // 0x8088d44
        ForcePush = 14;
        v201 = v199;
        v198 = -1;
        v197 = v24;
        v196 = v23;
    }
    goto lab_0x8089795;
  lab_0x80894e7:;
    int32_t v269 = 68 * g251 + (int32_t)&links; // 0x80894fb
    v4 = (char **)v269;
    HText_ExpandTextarea((int32_t *)v269, 1);
    int32_t v270 = g251;
    int32_t * v271 = (int32_t *)(68 * v270 + (int32_t)&g346);
    int32_t v272 = display_lines; // 0x8089525
    if (*v271 < v272) {
        // 0x808952e
        v3 = 1;
    } else {
        int32_t v273 = v272 + (int32_t)(v272 < 0) >> 1;
        Newline += v273;
        if (v270 >= 0 && nlinks >= 1) {
            // 0x8089572
            if (*v271 > v273) {
                // 0x808959a
                g241 = v270;
                int32_t v274 = v270; // 0x80895eb
                int32_t v275 = v270; // 0x80895eb
                if (g346 <= v273) {
                    int32_t v276 = v274 - 1;
                    g241 = v276;
                    int32_t v277 = 1; // 0x80895bd
                    v274 = v276;
                    int32_t v278 = v277; // 0x80895eb
                    v275 = v276;
                    while (*(int32_t *)(68 * v277 + (int32_t)&g346) <= v273) {
                        // 0x80895b0
                        v276 = v274 - 1;
                        g241 = v276;
                        v277 = v278 + 1;
                        v274 = v276;
                        v278 = v277;
                        v275 = v276;
                    }
                }
                // 0x80895ed
                g241 = v275 + 1;
            }
        }
    }
    // 0x80895fa
    if (textfields_need_activation != 0) {
        // 0x8089605
        textinput_activated = 1;
        textfields_need_activation = textfields_activation_option;
    }
    goto lab_0x8089618;
  lab_0x8088f48:;
    int32_t v279 = g251; // 0x8088f48
    int32_t v280 = nlinks - 1;
    int32_t v281 = v280; // 0x8088f58
    int32_t v282 = v279; // 0x8088f58
    if (v279 < v280) {
        int32_t v283 = 68 * v279;
        v281 = v280;
        v282 = v279;
        if (*(int32_t *)(v283 + (int32_t)&g347 + 68) != 1) {
            goto lab_0x808901b;
        } else {
            int32_t str16 = *(int32_t *)(v283 + (int32_t)&g354 + 68); // 0x8088f91
            v281 = v280;
            v282 = v279;
            if (*(int32_t *)(str16 + 8) != 9) {
                goto lab_0x808901b;
            } else {
                int32_t v284 = *(int32_t *)(v283 + (int32_t)&g354); // 0x8088fae
                v281 = v280;
                v282 = v279;
                if (*(int32_t *)(v284 + 4) != *(int32_t *)(str16 + 4)) {
                    goto lab_0x808901b;
                } else {
                    int32_t str15 = *(int32_t *)v284; // 0x8089005
                    v4 = (char **)str15;
                    if (strcmp((char *)str15, (char *)*(int32_t *)str16) == 0) {
                        goto lab_0x808926c;
                    } else {
                        // 0x8088fd6
                        v281 = nlinks - 1;
                        v282 = g251;
                        goto lab_0x808901b;
                    }
                }
            }
        }
    } else {
        goto lab_0x808901b;
    }
  lab_0x808905e:
    // 0x808905e
    switch (v250) {
        case 32: {
            goto lab_0x808916e;
        }
        case 28: {
            goto lab_0x808916e;
        }
        case 26: {
            goto lab_0x808916e;
        }
        default: {
            goto lab_0x808931a;
        }
    }
  lab_0x8089080:
    switch (v199) {
        case 26: {
            goto lab_0x808916e;
        }
        case 28: {
            goto lab_0x808916e;
        }
        case 32: {
            goto lab_0x808916e;
        }
        default: {
            goto lab_0x808931a;
        }
    }
  lab_0x808916e:;
    int32_t v285 = g251; // 0x808916e
    int32_t v286 = v285; // 0x8089175
    if (v285 < 1) {
        goto lab_0x8089234;
    } else {
        int32_t v287 = 68 * v285;
        if (*(int32_t *)(v287 + (int32_t)&g347 - 68) != 1) {
            goto lab_0x808931a;
        } else {
            int32_t str18 = *(int32_t *)(v287 + (int32_t)&g354 - 68); // 0x80891ae
            if (*(int32_t *)(str18 + 8) != 9) {
                goto lab_0x808931a;
            } else {
                int32_t v288 = *(int32_t *)(v287 + (int32_t)&g354); // 0x80891cb
                if (*(int32_t *)(v288 + 4) != *(int32_t *)(str18 + 4)) {
                    goto lab_0x808931a;
                } else {
                    int32_t str17 = *(int32_t *)v288; // 0x8089222
                    v4 = (char **)str17;
                    if (strcmp((char *)str17, (char *)*(int32_t *)str18) == 0) {
                        goto lab_0x808926c;
                    } else {
                        // 0x80891f3
                        v286 = g251;
                        goto lab_0x8089234;
                    }
                }
            }
        }
    }
  lab_0x808901b:;
    int32_t v289 = v282; // 0x808901b
    if (more_text == 0 || v289 != v281) {
        goto lab_0x8089055;
    } else {
        // 0x8089038
        v4 = (char **)v289;
        if (HText_TAHasMoreLines(v289, 1) != 0) {
            goto lab_0x808926c;
        } else {
            goto lab_0x8089055;
        }
    }
  lab_0x8089096:;
    int16_t v290 = v251; // 0x80890a4
    switch (v290) {
        case 26: {
            goto lab_0x808916e;
        }
        case 28: {
            goto lab_0x808916e;
        }
        default: {
            if (v290 != 32) {
                goto lab_0x808931a;
            } else {
                goto lab_0x808916e;
            }
        }
    }
  lab_0x8089234:;
    int32_t v291 = v286; // 0x8089234
    if (v291 != 0 || g252 < (char *)2) {
        goto lab_0x808931a;
    } else {
        // 0x808924f
        v4 = (char **)v291;
        if (HText_TAHasMoreLines(v291, -1) == 0) {
            goto lab_0x808931a;
        } else {
            goto lab_0x808926c;
        }
    }
  lab_0x8089055:
    if (v199 != -1) {
        int32_t v292 = 0x1000000 * v200;
        if ((v292 >> 24 & 0x8800) == 0) {
            // 0x8089071
            v251 = *(int16_t *)((v292 >> 23 & 4094) + 0x8197ea2);
            goto lab_0x8089096;
        } else {
            goto lab_0x8089080;
        }
    } else {
        // 0x808905e
        v250 = keymap[0];
        goto lab_0x808905e;
    }
  lab_0x808926c:
    // 0x808926c
    textinput_activated = 1;
    char v293 = ForcePush; // 0x8089273
    v201 = v199;
    v198 = -1;
    v197 = v24;
    v196 = v23;
    if (v293 != 10 != v293 != 13) {
        bool v294; // 0x808641f
        if (v199 != -1) {
            int32_t v295 = 0x1000000 * v200;
            if ((v295 >> 24 & 0x8800) == 0) {
                // 0x80892d0
                v294 = *(int16_t *)((v295 >> 23 & 4094) + 0x8197ea2) == 39;
            } else {
                // 0x80892b9
                v294 = v199 == 39;
            }
        } else {
            // 0x8089296
            v294 = keymap[0] == 39;
        }
        // 0x80892fe
        v201 = v199;
        v198 = -1;
        v197 = v24;
        v196 = v23;
        if (v294) {
            // 0x808930b
            ForcePush = 27;
            v201 = v199;
            v198 = -1;
            v197 = v24;
            v196 = v23;
        }
    }
    goto lab_0x8089795;
  lab_0x8086866:
    // 0x8086866
    if (form_post_data != 0) {
        // 0x808686f
        v4 = (char **)form_post_data;
        free((int32_t *)form_post_data);
        form_post_data = 0;
    }
    // 0x8086886
    if (form_get_data != 0) {
        // 0x808688f
        v4 = (char **)form_get_data;
        free((int32_t *)form_get_data);
        form_get_data = 0;
    }
    // 0x80868a6
    LYSetDisplayLines();
    v15 = 0;
    v16 = -1;
    v17 = 69;
    v18 = 0;
    v19 = 1;
    v20 = 0;
    v21 = 0;
    v22 = 0;
    while (true) {
      lab_0x80868ab_15:
        // 0x80868ab
        v23 = v22;
        v24 = v21;
        v25 = v20;
        v26 = v19;
        v27 = v18;
        v28 = v17;
        v29 = v16;
        v30 = v15;
        if (g254 != NULL) {
            // 0x80868b4
            user_input_buffer2 = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        }
        // 0x80868bb
        if (LYforce_no_cache != 0) {
            goto lab_0x80868ed;
        } else {
            // 0x80868c6
            if (user_input_buffer2[0] != 0) {
                goto lab_0x80868ed;
            } else {
                // 0x80868d1
                v4 = (char **)&curdoc;
                int32_t v31 = are_different(&curdoc, &newdoc); // 0x80868e0
                v32 = v29;
                v33 = v25;
                if (v31 == 0) {
                    goto lab_0x8087e3d;
                } else {
                    goto lab_0x80868ed;
                }
            }
        }
    }
  lab_0x8087e48:
    // 0x8087e48
    if (crawl == 0) {
        // 0x8087e76
        if (dump_links_only == 0) {
            // 0x8087e81
            *(int32_t *)&v4 = (int32_t)g164;
            print_wwwfile_to_fd((struct _IO_FILE *)g164, 0, 0);
        }
    } else {
        // 0x8087e53
        *(int32_t *)&v4 = (int32_t)g164;
        print_crawl_to_fd((struct _IO_FILE *)g164, (char *)g245, (char *)curdoc);
    }
    int32_t v34 = dump_server_status; // 0x8087e9e
    int32_t v35 = v34 - 399; // 0x8087ea3
    v36 = v35 < 0 == (398 - v34 & v34) < 0 == (v35 != 0);
    goto lab_0x808ad55_2;
  lab_0x808a022:;
    char * v329 = v47; // 0x808a022
    char * v330 = v329; // 0x808a02d
    int32_t v331; // 0x808641f
    int32_t v332 = v331; // 0x808a02d
    if (*v329 == 60) {
        uint32_t v333 = (int32_t)v329; // 0x808a035
        v330 = v329;
        v332 = v331;
        if (v331 > v333) {
            int32_t v334 = v331 - 1; // 0x808a043
            v330 = v329;
            v332 = v331;
            if (*(char *)v334 == 62) {
                int32_t v335 = v333 + 1; // 0x808a04d
                char * v336 = (char *)v335; // 0x808a04d
                v47 = v336;
                v4 = (char **)v335;
                char * v337 = v47;
                v330 = v337;
                v332 = v334;
                if (strncasecomp(v336, "URL:", 4) == 0) {
                    char * v338 = (char *)((int32_t)v337 + 4); // 0x808a07d
                    v47 = v338;
                    v330 = v338;
                    v332 = v334;
                }
            }
        }
    }
    uint32_t v339 = v332;
    uint32_t v340 = (int32_t)v330; // 0x808a084
    if (v339 > v340) {
        uint32_t v341 = v339 - v340 + 1; // 0x808a0bd
        int32_t size = v341 > 1024 ? v341 : 1024;
        v4 = (char **)size;
        int32_t * mem = malloc(size); // 0x808a0e5
        char * str21 = v47;
        v4 = (char **)mem;
        strncpy((char *)mem, str21, v339 - (int32_t)str21);
        *(char *)(v339 + (int32_t)mem - (int32_t)v47) = 0;
        v53 = (char *)mem;
        int32_t v342; // 0x808641f
        while (true) {
          lab_0x808a240_2:
            // 0x808a240
            v50 = v53;
            v342 = (int32_t)v45;
            char * c2 = v47; // 0x808a240
            if (v339 <= (int32_t)c2) {
                // break (via goto) -> 0x808a252
                goto lab_0x808a252;
            }
            // 0x808a14a
            v4 = (char **)" \t\n\r";
            while (strchr(" \t\n\r", (int32_t)*c2) != NULL) {
                // 0x808a16e
                c3 = v47;
                v46 = (int32_t)c3;
                v4 = (char **)" \t\n\r";
                if (strchr(" \t\n\r", (int32_t)*c3) == NULL) {
                    goto lab_0x808a211_2;
                }
                int32_t v343 = 0;
                char * v344 = v47;
                int32_t v345 = v343; // 0x808a18d
                // 0x808a18f
                v345 = *v344 != 10 ? v343 : 1;
                int32_t v346 = v345;
                char * c4 = (char *)((int32_t)v344 + 1); // 0x808a1a6
                v47 = c4;
                v4 = (char **)" \t\n\r";
                bool v347 = v346 != 0; // 0x808a1cb
                int32_t v348 = v346; // 0x808a1cb
                while (strchr(" \t\n\r", (int32_t)*c4) != NULL) {
                    // 0x808a186
                    v343 = v348;
                    v344 = v47;
                    v345 = v343;
                    if (!v347) {
                        // 0x808a18f
                        v345 = *v344 != 10 ? v343 : 1;
                    }
                    // 0x808a1a6
                    v346 = v345;
                    c4 = (char *)((int32_t)v344 + 1);
                    v47 = c4;
                    v4 = (char **)" \t\n\r";
                    v347 = v346 != 0;
                    v348 = v346;
                }
                int32_t v349 = v46; // 0x808a1d4
                if (v346 == 0) {
                    goto lab_0x808a211_2;
                }
                v342 = v349;
                c2 = v47;
                if (v339 <= (int32_t)c2) {
                    // break (via goto) -> 0x808a252
                    goto lab_0x808a252;
                }
                // 0x808a14a
                v4 = (char **)" \t\n\r";
            }
            // 0x808a221
            *(int32_t *)&v45 = v342;
            *v50 = *v47;
            v47 = (char *)((int32_t)v47 + 1);
            // 0x808a240
            v53 = (char *)((int32_t)v50 + 1);
            goto lab_0x808a240_2;
        }
      lab_0x808a252:
        // 0x808a252
        *(int32_t *)&v45 = v342;
        *v50 = 0;
        get_clip_release();
        v4 = (char **)mem;
        do_check_goto_URL((char *)mem, (char **)&URLTotal, user_input_buffer2);
        v4 = (char **)mem;
        free(mem);
        v38 = v54;
        v40 = v55;
    } else {
        // 0x808a092
        v4 = (char **)"No URL in the clipboard.";
        char * v350 = gettext("No URL in the clipboard."); // 0x808a099
        v4 = (char **)v350;
        HTInfoMsg(v350);
        v38 = v54;
        v40 = v55;
    }
    goto lab_0x80868ab_14;
  lab_0x808a1d8:;
    char * v351 = v51;
    char v352 = *v49; // 0x808a1de
    char * v353 = v48; // 0x808a1e3
    char * v354 = v49; // 0x808a1e3
    if (v352 == 13) {
        goto lab_0x808a203;
    } else {
        // 0x808a1f2
        *v351 = v352;
        v353 = v47;
        v354 = v45;
        goto lab_0x808a203;
    }
  lab_0x808a203:;
    char * v355 = (char *)((int32_t)v351 + 1);
    char * v356 = (char *)((int32_t)v354 + 1); // 0x808a20a
    v45 = v356;
    v48 = v353;
    v49 = v356;
    v51 = v355;
    v52 = v355;
    if (v353 > v356) {
        goto lab_0x808a1d8;
    } else {
        // 0x808a240
        v53 = v52;
        goto lab_0x808a240_2;
    }
  lab_0x8089c46_2:;
    int32_t v357 = v136; // 0x8089c46
    v4 = (char **)v357;
    handle_LYK_digit(v357, user_input_buffer2, &v7, &c, v56, &first_file2);
    v38 = v54;
    v40 = v55;
    goto lab_0x80868ab_14;
  lab_0x8089f73:;
    char * str22 = get_clip_grab(); // 0x8089f73
    v47 = str22;
    v38 = v54;
    v40 = v55;
    if (str22 == NULL) {
        goto lab_0x80868ab_14;
    } else {
        // 0x8089f8b
        v4 = (char **)str22;
        uint32_t v358 = (int32_t)v47;
        uint32_t v359 = strlen(str22) + v358; // 0x8089fa5
        char * c5 = v47; // 0x8089fc6
        if (v359 > v358) {
            v4 = (char **)" \t\n\r";
            while (strchr(" \t\n\r", (int32_t)*c5) != NULL) {
                uint32_t v360 = (int32_t)v47 + 1; // 0x8089fb3
                char * v361 = (char *)v360; // 0x8089fb3
                v47 = v361;
                c5 = v361;
                if (v359 <= v360) {
                    // break -> 0x8089ff1
                    break;
                }
                v4 = (char **)" \t\n\r";
            }
        }
        // 0x8089ff1
        v331 = v359;
        while (v331 > (int32_t)v47) {
            int32_t c6 = v331 - 1; // 0x808a005
            v4 = (char **)" \t\n\r";
            if (strchr(" \t\n\r", (int32_t)*(char *)c6) == NULL) {
                // 0x8089fff
                goto lab_0x808a022;
            }
            v331 = c6;
        }
        goto lab_0x808a022;
    }
  lab_0x8089eb0:;
    int32_t v362 = *v135;
    char * v363 = (char *)v362;
    if (v362 == 0) {
        goto lab_0x8089ec6;
    } else {
        // 0x8089eb9
        if (*v363 != 0) {
            goto lab_0x8089eda;
        } else {
            goto lab_0x8089ec6;
        }
    }
  lab_0x8089ec6:
    // 0x8089ec6
    v4 = (char **)"Current URL is empty.";
    char * v364 = gettext("Current URL is empty."); // 0x8089ecd
    v4 = (char **)v364;
    HTInfoMsg(v364);
    goto lab_0x8089eda;
  lab_0x8089eda:
    // 0x8089eda
    *(int32_t *)&v4 = v362;
    if (put_clip(v363) == 0) {
        // 0x8089f05
        if (g245 != (char **)v362) {
            // 0x8089f2b
            v4 = (char **)"Link URL put to clipboard.";
            char * v365 = gettext("Link URL put to clipboard."); // 0x8089f32
            v4 = (char **)v365;
            HTInfoMsg(v365);
            v38 = v54;
            v40 = v55;
        } else {
            // 0x8089f12
            v4 = (char **)"Document URL put to clipboard.";
            char * v366 = gettext("Document URL put to clipboard."); // 0x8089f19
            v4 = (char **)v366;
            HTInfoMsg(v366);
            v38 = v54;
            v40 = v55;
        }
    } else {
        // 0x8089eec
        v4 = (char **)"Copy to clipboard failed.";
        char * v367 = gettext("Copy to clipboard failed."); // 0x8089ef3
        v4 = (char **)v367;
        HTInfoMsg(v367);
        v38 = v54;
        v40 = v55;
    }
    goto lab_0x80868ab_14;
  lab_0x8087bf3:
    // 0x8087bf3
    v4 = (char **)&curdoc;
    copy_address(&curdoc, &newdoc);
    int32_t v368 = 0; // 0x8087c0e
    char * v369 = NULL; // 0x8087c0e
    if (g236 == 0) {
        goto lab_0x8087c4c;
    } else {
        // 0x8087c33
        v368 = *(int32_t *)(g236 + 4);
        v369 = (char *)*(int32_t *)g236;
        goto lab_0x8087c4c;
    }
  lab_0x8087c4c:
    // 0x8087c4c
    v4 = (char **)&g246;
    HTSABCopy((int32_t **)&g246, v369, v368);
    v4 = &g247;
    HTSACopy(&g247, g237);
    v4 = &g248;
    HTSACopy(&g248, g238);
    char * v370 = HText_getStyle(); // 0x8087c96
    v4 = &g254;
    HTSACopy(&g254, v370);
    if (g254 == NULL) {
        goto lab_0x8087cc1;
    } else {
        // 0x8087cb4
        v4 = (char **)g254;
        style_readFromFile(g254);
        goto lab_0x8087cc1;
    }
  lab_0x8087cc1:
    // 0x8087cc1
    g249 = g239;
    g253 = g243;
    bool v371; // 0x808641f
    if (ownerS_address == 0) {
        goto lab_0x8087d52;
    } else {
        // 0x8087ce2
        if (LYpsrc == 0) {
            // 0x8087cff
            v371 = HTOutputFormat == WWW_SOURCE;
            goto lab_0x8087d13;
        } else {
            // 0x8087ced
            v371 = psrc_view != 0;
            goto lab_0x8087d13;
        }
    }
  lab_0x8087d52:
    // 0x8087d52
    if (HText_getTitle() == NULL) {
        // 0x8087d72
        if (dump_output_immediately != 0) {
            goto lab_0x8087d92;
        } else {
            // 0x8087d7d
            v4 = (char **)&curdoc;
            HTSACopy((char **)&curdoc, (char *)newdoc);
            goto lab_0x8087d92;
        }
    } else {
        char * v372 = HText_getTitle(); // 0x8087d5b
        v4 = (char **)&curdoc;
        HTSACopy((char **)&curdoc, v372);
        goto lab_0x8087d92;
    }
  lab_0x8087d92:;
    char * v373 = HText_getOwner(); // 0x8087d92
    v4 = (char **)&owner_address;
    HTSACopy((char **)&owner_address, v373);
    g250 = HTLoadedDocumentIsSafe();
    if (dump_output_immediately != 0) {
        goto lab_0x8087dc8;
    } else {
        // 0x8087dbc
        v4 = (char **)&curdoc;
        LYAddVisitedLink(&curdoc);
        goto lab_0x8087dc8;
    }
  lab_0x8087d13:
    // 0x8087d13
    if (!v371) {
        goto lab_0x8087d32;
    } else {
        // 0x8087d1c
        if (HText_getOwner() != NULL) {
            goto lab_0x8087d32;
        } else {
            // 0x8087d25
            v4 = (char **)ownerS_address;
            HText_setMainTextOwner((char *)ownerS_address);
            goto lab_0x8087d32;
        }
    }
  lab_0x8087dc8:
    // 0x8087dc8
    v4 = (char **)"www/present";
    int32_t * v374 = HTAtom_for("www/present"); // 0x8087dcf
    *(int32_t *)&HTOutputFormat = (int32_t)v374;
    psrc_view = 0;
    v4 = (char **)current_char_set;
    HTMLSetCharacterHandling(current_char_set);
    LYUserSpecifiedURL = 0;
    LYJumpFileURL = 0;
    LYNoRefererForThis = 0;
    reloading = 0;
    HEAD_request = 0;
    LYPermitURL = 0;
    force_load = 0;
    LYforce_HTML_mode = 0;
    force_old_UCLYhndl_on_reload = 0;
    v32 = -1;
    v33 = 0;
    goto lab_0x8087e3d;
  lab_0x8087d32:
    // 0x8087d32
    if (ownerS_address == 0) {
        goto lab_0x8087d52;
    } else {
        // 0x8087d3b
        v4 = (char **)ownerS_address;
        free((int32_t *)ownerS_address);
        ownerS_address = 0;
        goto lab_0x8087d52;
    }
  lab_0x8087aeb:;
    char ** v375 = g235; // 0x8087aeb
    if (v375 == NULL || g245 == NULL) {
        goto lab_0x8087ba1;
    } else {
        // 0x8087b05
        *(int32_t *)&v4 = (int32_t)v375;
        if (strncasecomp((char *)v375, "LYNXDOWNLOAD:", 13) != 0) {
            goto lab_0x8087ba1;
        } else {
            // 0x8087b26
            v4 = (char **)&newdoc;
            copy_address(&newdoc, &curdoc);
            int32_t v376 = curdoc; // 0x8087b3a
            char * v377 = v376 == 0 ? (char *)&g20 : (char *)v376;
            v4 = (char **)&newdoc;
            HTSACopy((char **)&newdoc, v377);
            v4 = &g238;
            HTSACopy(&g238, g248);
            *(int32_t *)&g242 = (int32_t)g252;
            g241 = g251;
            g243 = 0;
            goto lab_0x8087ba1;
        }
    }
  lab_0x8087ba1:
    // 0x8087ba1
    display_partial = 0;
    if (v72 != 1 == Newline < 2) {
        // 0x8087bc5
        g252 = (char *)-1;
        goto lab_0x8087bcf;
    } else {
        // 0x8087bbb
        www_search_result = -1;
        // 0x8087bc5
        g252 = (char *)-1;
        goto lab_0x8087bcf;
    }
  lab_0x8087aa1:
    // 0x8087aa1
    if (g245 == NULL || curdoc == 0) {
        goto lab_0x8087aeb;
    } else {
        // 0x8087ab3
        *(int32_t *)&v4 = (int32_t)g245;
        if (strncasecomp((char *)g245, "LYNXIMGMAP:", 11) == 0) {
            goto lab_0x8087aeb;
        } else {
            // 0x8087ad4
            *(int32_t *)&v4 = (int32_t)g245;
            add_to_traverse_list((char *)g245, (char *)curdoc);
            goto lab_0x8087aeb;
        }
    }
  lab_0x8087a81:;
    int32_t v378 = traversal_link_to_add; // 0x8087a81
    if (v378 == 0) {
        goto lab_0x8087aa1;
    } else {
        // 0x8087a8a
        v4 = (char **)v378;
        free((int32_t *)v378);
        traversal_link_to_add = 0;
        goto lab_0x8087aa1;
    }
  lab_0x80874b0:
    // 0x80874b0
    v4 = (char **)&g236;
    HTSABCopy((int32_t **)&g236, v115, v117);
    v4 = &g237;
    HTSACopy(&g237, g247);
    g239 = g249;
    g240 = g250;
    g243 = g253;
    *(int32_t *)&g242 = (int32_t)g252;
    g241 = g251;
    goto lab_0x808751d;
  lab_0x808751d:
    // 0x808751d
    old_c = 37;
    v127 = v30;
    v128 = v29;
    v129 = v28;
    v130 = v27;
    v131 = v26;
    v132 = 0;
    v133 = v24;
    v134 = v23;
    goto lab_0x8089985_3;
  lab_0x8087422:
    // 0x8087422
    g239 = HTLoadedDocumentIsHEAD();
    g240 = HTLoadedDocumentIsSafe();
    g243 = 0;
    goto lab_0x808751d;
  lab_0x80889b5:
    // 0x80889b5
    v4 = (char **)"Fatal error - could not open output file %s\n";
    char * format2 = gettext("Fatal error - could not open output file %s\n"); // 0x80889bc
    char ** stream8 = dump_output_immediately == 0 ? g164 : g160;
    *(int32_t *)&v4 = (int32_t)stream8;
    fprintf((struct _IO_FILE *)stream8, format2);
    v36 = 1;
    if (dump_output_immediately == 0) {
        // 0x8088a18
        v4 = (char **)1;
        exit_immediately(1);
        // UNREACHABLE
    }
    goto lab_0x808ad55_2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808ad77 - 0x808ae93
// Line range:    7448 - 7496
int32_t are_different(int32_t * doc1, int32_t * doc2) {
    int32_t v1 = (int32_t)doc1;
    int32_t * str = (int32_t *)(v1 + 4); // 0x808ad80
    int32_t v2 = *str; // 0x808ad80
    if (v2 == 0) {
        // 0x808ae8e
        return 1;
    }
    int32_t v3 = (int32_t)doc2;
    int32_t * str2 = (int32_t *)(v3 + 4); // 0x808ad8a
    if (*str2 == 0 || *(char *)(v1 + 20) != *(char *)(v3 + 20)) {
        // 0x808ae8e
        return 1;
    }
    char * v4 = trimPoundSelector((char *)v2); // 0x808adc4
    char * v5 = trimPoundSelector((char *)*str2); // 0x808add5
    if (strcmp((char *)*str, (char *)*str2) != 0) {
        if (v4 != NULL) {
            // 0x808adff
            *v4 = 35;
        }
        // 0x808ae05
        if (v5 != NULL) {
            // 0x808ae0b
            *v5 = 35;
        }
        // 0x808ae8e
        return 1;
    }
    if (v4 != NULL) {
        // 0x808ae20
        *v4 = 35;
    }
    if (v5 != NULL) {
        // 0x808ae2c
        *v5 = 35;
    }
    int32_t v6 = *(int32_t *)(v1 + 8); // 0x808ae35
    int32_t v7 = *(int32_t *)(v3 + 8);
    if (v6 == 0) {
        // 0x808ae74
        if (v7 != 0) {
            // 0x808ae8e
            return 1;
        }
        // 0x808ae8e
        return 0;
    }
    // 0x808ae3c
    if (v7 == 0) {
        // 0x808ae8e
        return 1;
    }
    // 0x808ae46
    if (HTSABEql((int32_t *)v6, (int32_t *)v7) != 0) {
        // 0x808ae8e
        return 0;
    }
    // 0x808ae8e
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808ae93 - 0x808afb8
// Line range:    7585 - 7616
void HTAddGotoURL(char * url) {
    char * str2 = NULL; // bp-8, 0x808ae99
    if (url == NULL || *url == 0) {
        // 0x808afb6
        return;
    }
    // 0x808aeb8
    if (WWW_TraceFlag != 0) {
        // 0x808aec3
        fprintf(TraceFP(), "HTAddGotoURL %s\n", url);
    }
    // 0x808aee1
    HTSACopy(&str2, url);
    if (Goto_URLs == NULL) {
        int32_t * v1 = HTList_new(); // 0x808aefc
        *(int32_t *)&Goto_URLs = (int32_t)v1;
        HTList_addObject(v1, str2);
        // 0x808afb6
        return;
    }
    char * v2 = (char *)Goto_URLs; // 0x808af28
    while (v2 != NULL) {
        int32_t v3 = *(int32_t *)((int32_t)v2 + 4); // 0x808af78
        if (v3 == 0) {
            // break -> 0x808afa1
            break;
        }
        int32_t v4 = *(int32_t *)v3; // 0x808af87
        if (v4 == 0) {
            // break -> 0x808afa1
            break;
        }
        char * str = (char *)v4;
        v2 = (char *)v3;
        if (strcmp(str, str2) == 0) {
            // 0x808af5b
            HTList_removeObject(Goto_URLs, str);
            free((int32_t *)v4);
            goto lab_0x808afa1;
        }
    }
  lab_0x808afa1:
    // 0x808afa1
    HTList_addObject(Goto_URLs, str2);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808afb8 - 0x808b334
// Line range:    7624 - 7712
void show_main_statusline(int32_t curlink, int32_t for_what) {
    int32_t v1 = __readgsdword(20); // 0x808afc2
    int32_t v2; // 0x808afb8
    if (v2 != 2 && user_mode == 0) {
        // 0x808afdc
        noviceline((int32_t)more_text);
    }
    // 0x808afee
    if (HTisDocumentSource() == 0) {
        // 0x808b017
        if (lynx_mode != 2 || nlinks < 1) {
            goto lab_0x808b11c;
        } else {
            if (user_mode != 2) {
                goto lab_0x808b04b;
            } else {
                if ((v2 & 2) != 0) {
                    goto lab_0x808b11c;
                } else {
                    goto lab_0x808b04b;
                }
            }
        }
    } else {
        // 0x808aff7
        mustshow = 1;
        statusline(gettext("Currently viewing document source.  Press '\\' to return to rendered version."));
        goto lab_0x808b2dd;
    }
  lab_0x808b11c:
    if (nlinks < 1 || user_mode != 2) {
        // 0x808b1c2
        int32_t str; // bp-140, 0x808afb8
        if (is_www_index == 0 || more_text == 0) {
            if (is_www_index == 0) {
                if (more_text == 0) {
                    // 0x808b2c2
                    mustshow = 1;
                    statusline(gettext("Commands: Use arrow keys to move, '?' for help, 'q' to quit, '<-' to go back."));
                } else {
                    // 0x808b27f
                    mustshow = 1;
                    if (user_mode != 0) {
                        // 0x808b2a5
                        statusline(gettext("-- press space for more, use arrow keys to move, '?' for help, 'q' to quit."));
                    } else {
                        // 0x808b288
                        statusline(gettext("-- press space for next page --"));
                    }
                }
            } else {
                // 0x808b22d
                key_for_func(50);
                sprintf((char *)&str, gettext("This is a searchable index.  Use %s to search."));
                mustshow = 1;
                statusline((char *)&str);
            }
        } else {
            // 0x808b1d8
            key_for_func(50);
            sprintf((char *)&str, gettext("--More--  This is a searchable index.  Use %s to search."));
            mustshow = 1;
            statusline((char *)&str);
        }
    } else {
        int32_t found_char_pos = 0; // 0x808b147
        if (v2 == 6) {
            char * str2 = (char *)curlink;
            found_char_pos = 0;
            if (strncasecomp(str2, "LYNXIMGMAP:", 11) != 0) {
                // 0x808b168
                found_char_pos = (int32_t)strchr(str2, 35);
            }
        }
        int32_t v3 = found_char_pos;
        int32_t v4 = v3 != 0 ? v3 : curlink;
        status_link((char *)v4, more_text, is_www_index);
    }
    goto lab_0x808b2dd;
  lab_0x808b2dd:
    // 0x808b2dd
    if (LYShowCursor == 0) {
        // 0x808b2e8
        LYmove(LYlines - 1, LYcols + (int32_t)(LYShowScrollbar != 0) - 1);
    }
    // 0x808b31a
    if (v1 != __readgsdword(20)) {
        // 0x808b326
        __stack_chk_fail();
    }
  lab_0x808b04b:
    if (v2 != 1) {
        // 0x808b067
        statusline(gettext("(NORMAL LINK)   Use right-arrow or <return> to activate."));
    } else {
        // 0x808b053
        show_formlink_statusline((int32_t *)v2, v2);
    }
    // 0x808b07b
    if (is_www_index != 0) {
        char * str3 = gettext("-index-"); // 0x808b091
        LYmove(LYlines - 1, LYcols - strlen(str3) + (int32_t)(LYShowScrollbar != 0));
        lynx_start_reverse();
        LYwaddnstr(LYwin, str3, strlen(str3));
        lynx_stop_reverse();
    }
    goto lab_0x808b2dd;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808b334 - 0x808b396
// Line range:    7720 - 7723
void repaint_main_statusline(int32_t for_what) {
    int32_t v1 = g251; // 0x808b33c
    if (v1 > -1 == v1 < nlinks) {
        // 0x808b354
        int32_t v2; // bp-108, 0x808b334
        __asm_rep_movsd_memcpy((char *)&v2, (char *)(68 * v1 + (int32_t)&links), 17);
        show_main_statusline((int32_t)&g391, (int32_t)&g391);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808b396 - 0x808b5b4
// Line range:    7726 - 7758
void form_noviceline(int32_t disabled) {
    // 0x808b396
    LYmove(LYlines - 2, 0);
    LYclrtoeol();
    if (disabled != 0) {
        // 0x808b5ae
        LYmove(LYlines - 1, 0);
        LYclrtoeol();
        // 0x808b5ae
        return;
    }
    int32_t len = strlen(gettext("            Enter text into the field by typing on the keyboard              ")); // 0x808b3cf
    LYwaddnstr(LYwin, gettext("            Enter text into the field by typing on the keyboard              "), len);
    LYmove(LYlines - 1, 0);
    LYclrtoeol();
    if (EditBinding(21) == 12) {
        int32_t len2 = strlen(gettext("    Ctrl-U to delete all text in field, [Backspace] to delete a character    ")); // 0x808b43f
        LYwaddnstr(LYwin, gettext("    Ctrl-U to delete all text in field, [Backspace] to delete a character    "), len2);
        // 0x808b5ae
        return;
    }
    // 0x808b46d
    if (EditBinding(21) == 25) {
        int32_t len3 = strlen(gettext("      Ctrl-U to delete text in field, [Backspace] to delete a character    ")); // 0x808b48d
        LYwaddnstr(LYwin, gettext("      Ctrl-U to delete text in field, [Backspace] to delete a character    "), len3);
        // 0x808b5ae
        return;
    }
    char * str = NULL; // bp-12, 0x808b4bb
    char * v1 = fmt_keys(LYKeyForEditAction(12), -1); // 0x808b4d9
    int32_t v2; // 0x808b396
    if (v1 == NULL) {
        char * v3 = fmt_keys(LYKeyForEditAction(25), -1); // 0x808b522
        int32_t v4 = (int32_t)v3; // 0x808b522
        v2 = v4;
        if (v3 != NULL) {
            char * v5 = gettext("      %s to delete text in field, [Backspace] to delete a character    "); // 0x808b537
            HTSprintf0(&str, v5);
            v2 = v4;
        }
    } else {
        char * v6 = gettext("    %s to delete all text in field, [Backspace] to delete a character    "); // 0x808b4ee
        HTSprintf0(&str, v6);
        v2 = (int32_t)v1;
    }
    // 0x808b552
    if (str != NULL) {
        // 0x808b559
        LYwaddnstr(LYwin, str, strlen(str));
        if (str != NULL) {
            // 0x808b584
            free((int32_t *)str);
            str = NULL;
        }
    }
    if (v2 != 0) {
        // 0x808b59c
        free((int32_t *)v2);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808b5b4 - 0x808b75f
// Line range:    7762 - 7812
void exit_immediately_with_error_message(int32_t state, char first_file) {
    int32_t str = 0; // bp-8, 0x808b5c0
    char * buf = NULL; // bp-12, 0x808b5c7
    if (first_file != 0) {
        // 0x808b5d4
        LYstatusline_messages_on_exit(&buf);
    }
    int32_t v1; // 0x808b5b4
    if (state != 0) {
        goto lab_0x808b66d;
    } else {
        // 0x808b5e9
        if (buf == NULL) {
            // 0x808b60f
            v1 = startfile;
            goto lab_0x808b620;
        } else {
            char * substr_pos = strstr(buf, gettext("Can't Access")); // 0x808b606
            v1 = (int32_t)&g20;
            if (substr_pos != NULL) {
                goto lab_0x808b620;
            } else {
                // 0x808b60f
                v1 = startfile;
                goto lab_0x808b620;
            }
        }
    }
  lab_0x808b66d:
    if (state == 3) {
        char * v2 = gettext("      Exiting..."); // 0x808b67a
        char * v3 = gettext("lynx: Start file could not be found or is not text/html or text/plain"); // 0x808b689
        char * v4 = buf; // 0x808b691
        char * v5 = v4 == NULL ? (char *)&g20 : v4;
        HTSprintf0((char **)&str, "%s\n%s\n%s\n", v5, v3, v2);
    }
    // 0x808b6cf
    if (buf != NULL) {
        // 0x808b6d6
        free((int32_t *)buf);
        buf = NULL;
    }
    // 0x808b6e8
    if (dump_output_immediately == 0) {
        // 0x808b6f3
        cleanup();
    }
    // 0x808b6f8
    if (dump_output_immediately == 0) {
        // 0x808b719
        fputs((char *)str, (struct _IO_FILE *)g164);
    } else {
        // 0x808b703
        fputs((char *)str, (struct _IO_FILE *)g160);
    }
    // 0x808b72d
    if (str != 0) {
        // 0x808b734
        free((int32_t *)str);
        str = 0;
    }
    // 0x808b746
    if (dump_output_immediately != 0) {
        // 0x808b75d
        return;
    }
    // 0x808b751
    exit_immediately(1);
    // UNREACHABLE
  lab_0x808b620:;
    char * v6 = gettext("lynx: Can't access startfile"); // 0x808b627
    char * v7 = buf; // 0x808b62f
    char * v8 = v7 == NULL ? (char *)&g20 : v7;
    HTSprintf0((char **)&str, "%s\n%s %s\n", v8, v6, (char *)v1);
    goto lab_0x808b66d;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808b75f - 0x808bb66
// Line range:    7817 - 7884
void status_link(char * curlink_name, char show_more, char show_indx) {
    char format3[1024]; // bp-1040, 0x808b75f
    char format2[1024]; // bp-1044, 0x808b75f
    char v1[1024]; // 0x808b864
    char v2[1024]; // 0x808b7f0
    char v3[1024]; // 0x808b850
    int32_t v4 = __readgsdword(20); // 0x808b784
    format3 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char str = 0; // bp-1036, 0x808b799
    if (show_more != 0) {
        // 0x808b7a9
        if (nomore == 0) {
            // 0x808b7b4
            sprintf(&str, "%.*s ", 1022, gettext("-more-"));
            int32_t len = strlen(&str); // 0x808b7eb
            v2[0] = len;
            format3 = v2;
        }
    }
    if (show_indx == 0) {
        // branch -> 0x808b842
    } else {
        char * v5 = gettext("-index-"); // 0x808b806
        int32_t v6 = *(int32_t *)&format3;
        sprintf((char *)(v6 + (int32_t)&str), "%.*s ", 1022 - v6, v5);
    }
    int32_t * v7 = (int32_t *)&format3;
    int32_t len2 = strlen(&str); // 0x808b84b
    v3[0] = len2;
    format3 = v3;
    int32_t len3 = strlen(curlink_name); // 0x808b85f
    v1[0] = len3;
    format2 = v1;
    int32_t v8 = LYcols + (int32_t)(LYShowScrollbar != 0) - 1; // 0x808b885
    int32_t v9 = *v7; // 0x808b888
    int32_t v10; // 0x808b75f
    int32_t prefix; // bp-1048, 0x808b75f
    int32_t v11; // 0x808b75f
    int32_t v12; // 0x808b75f
    int32_t v13; // 0x808b75f
    if (v9 < 1023 == v8 >= v9) {
        // 0x808b8be
        sprintf((char *)(v9 + (int32_t)&str), "%%.%ds", v8 - v9);
        int32_t v14 = *(int32_t *)&format2; // 0x808b90c
        int32_t v15 = v14 + v9;
        if (long_url_ok == 0 || v15 <= LYcols + (int32_t)(LYShowScrollbar != 0) - 1) {
            // 0x808bb2d
            mustshow = 1;
            user_message(&str, curlink_name);
            goto lab_0x808bb4c;
        } else {
            // 0x808b94a
            prefix = 0;
            HTSACopy((char **)&prefix, curlink_name);
            int32_t v16 = v14 - 2; // 0x808b972
            v12 = v16;
            if (v16 >= 1) {
                int32_t v17 = v16; // 0x808b97d
                v12 = v17;
                while (*(char *)(v17 + prefix) != 47) {
                    // 0x808b97d
                    v17--;
                    v12 = 0;
                    if (v17 < 1) {
                        // break -> 0x808b9a3
                        break;
                    }
                    v12 = v17;
                }
            }
            int32_t v18 = v12 - 4; // 0x808b9a9
            if (v18 >= 1) {
                int32_t v19 = LYcols + (int32_t)(LYShowScrollbar != 0) - 1;
                v11 = v18;
                int32_t v20 = v11 + prefix;
                if (*(char *)v20 == 47) {
                    // 0x808b9da
                    v13 = v11 + 4;
                    if (v15 - v12 + v13 < v19) {
                        // 0x808ba36
                        *(char *)(v20 + 1) = 46;
                        v10 = 2;
                        goto lab_0x808ba36_2;
                    }
                }
                int32_t v21 = v11 - 1; // 0x808b9b4
                while (v21 >= 1) {
                    // 0x808b9c4
                    v11 = v21;
                    v20 = v11 + prefix;
                    if (*(char *)v20 == 47) {
                        // 0x808b9da
                        v13 = v11 + 4;
                        if (v15 - v12 + v13 < v19) {
                            // 0x808ba36
                            *(char *)(v20 + 1) = 46;
                            v10 = 2;
                            goto lab_0x808ba36_2;
                        }
                    }
                    // 0x808b9b4
                    v21 = v11 - 1;
                }
            }
            goto lab_0x808babe;
        }
    } else {
        // 0x808b89c
        mustshow = 1;
        user_message("%s", &str);
        goto lab_0x808bb4c;
    }
  lab_0x808bb4c:
    // 0x808bb4c
    if (v4 != __readgsdword(20)) {
        // 0x808bb58
        __stack_chk_fail();
    }
  lab_0x808babe:
    // 0x808babe
    mustshow = 1;
    user_message(&str, (char *)prefix);
    if (WWW_TraceFlag != 0) {
        // 0x808bae8
        fprintf(TraceFP(), "lastline = %s\n", (char *)prefix);
    }
    // 0x808bb09
    if (prefix != 0) {
        // 0x808bb13
        free((int32_t *)prefix);
        prefix = 0;
    }
    goto lab_0x808bb4c;
  lab_0x808ba36_2:
    // 0x808ba36
    *(char *)(prefix + v11 + v10) = 46;
    int32_t v22 = v10 + 1; // 0x808ba50
    v10 = v22;
    int32_t v23; // 0x808b75f
    int32_t v24; // 0x808b75f
    if (v22 == 4) {
        // 0x808baa7
        v23 = v12;
        v24 = 0;
        if (v12 > *(int32_t *)&format2) {
            goto lab_0x808babe;
        } else {
            goto lab_0x808ba6c;
        }
    } else {
        goto lab_0x808ba36_2;
    }
  lab_0x808ba6c:;
    int32_t v25 = prefix;
    *(char *)(v24 + v13 + v25) = *(char *)(v25 + v23);
    int32_t v26 = v24 + 1; // 0x808baa0
    int32_t v27 = v26 + v12; // 0x808bab3
    v23 = v27;
    v24 = v26;
    if (v27 > *(int32_t *)&format2) {
        goto lab_0x808babe;
    } else {
        goto lab_0x808ba6c;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMainLoop.c
// Address range: 0x808bb66 - 0x808bb8b
// Line range:    7887 - 7889
char * LYDownLoadAddress(void) {
    char ** v1 = g235; // 0x808bb6c
    return v1 == NULL ? (char *)&g20 : (char *)v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808bb8c - 0x808bbdd
// Line range:    242 - 251
int32_t string_to_attr(char * name) {
    int32_t v1 = 0; // 0x808bbc7
    int32_t v2 = 8 * v1; // 0x808bb9e
    int32_t v3 = *(int32_t *)(v2 + (int32_t)&Mono_Attrs); // 0x808bb9e
    while (strcasecomp((char *)v3, name) != 0) {
        // 0x808bbcb
        v1++;
        if (v1 >= 7) {
            // 0x808bbd8
            return 0;
        }
        v2 = 8 * v1;
        v3 = *(int32_t *)(v2 + (int32_t)&Mono_Attrs);
    }
    // 0x808bbd8
    return *(int32_t *)(v2 + (int32_t)&g102);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808bbdd - 0x808bd63
// Line range:    256 - 286
char * attr_to_string(uint32_t code) {
    uint32_t v1 = code / 256 % 256; // 0x808bbeb
    bool v2 = (code & 0x200000) == 0 | v1 == 0;
    *(char *)&g257 = 0;
    for (int32_t i = 0; i < 7; i++) {
        int32_t v3 = 8 * i; // 0x808bc39
        int32_t v4 = *(int32_t *)(v3 + (int32_t)&g102); // 0x808bc39
        if ((v4 & (v2 ? code : code & -0x200001)) != 0) {
            // 0x808bc47
            if (*(char *)&g257 != 0) {
                int32_t len = strlen((char *)&g257); // 0x808bc69
                memcpy((int32_t *)(len + (int32_t)&g257), &g391, (int32_t)&g391);
            }
            int32_t str = *(int32_t *)(v3 + (int32_t)&Mono_Attrs); // 0x808bc7e
            strcat((char *)&g257, (char *)str);
        }
    }
    int32_t v5; // bp-6, 0x808bbdd
    int32_t v6; // bp-8, 0x808bbdd
    if (v1 == 0 || function_804aca4(v1, &v5, &v6) == -1) {
        // 0x808bd5c
        return (char *)&g257;
    }
    char * v7 = lookup_color((v2 ? 0 : (int32_t)g157) + (0x10000 * v5 >> 16)); // 0x808bcf5
    char * v8 = lookup_color(0x10000 * v6 >> 16); // 0x808bd05
    if (*(char *)&g257 != 0) {
        // 0x808bd18
        strcat((char *)&g257, "+");
    }
    int32_t len2 = strlen((char *)&g257); // 0x808bd33
    sprintf((char *)(len2 + (int32_t)&g257), "%s/%s", v7, v8);
    // 0x808bd5c
    return (char *)&g257;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808bd63 - 0x808bef1
// Line range:    295 - 357
void LYbox(int32_t * win, char formfield) {
    int32_t v1 = (int32_t)win;
    int32_t boxvert; // bp-16, 0x808bd63
    int32_t v2; // bp-12, 0x808bd63
    UCSetBoxChars(current_char_set, &v2, &boxvert, 0, 0);
    curses_w_style(win, s_menu_frame, 1);
    int32_t v3 = v2; // 0x808bdb8
    int32_t v4 = boxvert;
    if (v3 != 0 != v4 != 0) {
        // 0x808bdc6
        function_804b194(v1, v3, v3, v4, v4, 0, 0, 0, 0);
        // 0x808bec4
        curses_w_style(win, s_menu_frame, 0);
        function_804ade4(v1);
        return;
    }
    if (v3 != 42 == (v4 != 42)) {
        // 0x808be77
        function_804b194(v1, v3, v3, v4, v4, 47, 92, 92, 47);
    } else {
        // 0x808be28
        function_804b194(v1, v3, v3, v4, v4, 42, 42, 42, 42);
    }
    // 0x808bec4
    curses_w_style(win, s_menu_frame, 0);
    function_804ade4(v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808bef1 - 0x808bf41
// Line range:    373 - 377
void setStyle(int32_t style, int32_t color, int32_t cattr, int32_t mono) {
    int32_t v1 = 12 * style; // 0x808befd
    *(int32_t *)(v1 + (int32_t)&displayStyles) = color;
    *(int32_t *)(v1 + (int32_t)&g356) = cattr;
    *(int32_t *)(v1 + (int32_t)&g355) = mono;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808bf41 - 0x808bffe
// Line range:    384 - 397
void setHashStyle(int32_t style, int32_t color, int32_t cattr, int32_t mono, char * element) {
    // 0x808bf41
    if (WWW_TraceFlag != 0) {
        // 0x808bf66
        if ((WWW_TraceMask & 2) != 0) {
            // 0x808bf72
            fprintf(TraceFP(), "CSS(SET): <%s> hash=%d, ca=%#x, ma=%#x\n", element, style, color, mono);
        }
    }
    int32_t v1 = 24 * style; // 0x808bf50
    int32_t v2 = v1 + (int32_t)&hashStyles; // 0x808bf53
    *(int32_t *)(v1 + (int32_t)&hashStyles + 8) = color;
    *(int32_t *)(v1 + (int32_t)&hashStyles + 16) = cattr;
    *(int32_t *)(v1 + (int32_t)&hashStyles + 12) = mono;
    *(int32_t *)(v1 + (int32_t)&hashStyles + 4) = style;
    int32_t * v3 = (int32_t *)v2; // 0x808bfce
    int32_t v4 = *v3; // 0x808bfce
    if (v4 != 0) {
        // 0x808bfd4
        free((int32_t *)v4);
        *v3 = 0;
    }
    // 0x808bfea
    HTSACopy((char **)v2, element);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808bffe - 0x808c10b
// Line range:    404 - 419
void LYAttrset(int32_t * win, int32_t color, int32_t mono) {
    int32_t v1 = (int32_t)win;
    if (color >= 0 && lynx_has_color != 0 && LYShowColor >= 2) {
        // 0x808c01e
        if (WWW_TraceFlag != 0) {
            // 0x808c029
            if ((WWW_TraceMask & 2) != 0) {
                char * v2 = attr_to_string(color); // 0x808c03b
                fprintf(TraceFP(), "CSS:LYAttrset color %#x -> (%s)\n", color, v2);
            }
        }
        // 0x808c066
        *(int32_t *)(v1 + 16) = color;
        // 0x808c105
        return;
    }
    // 0x808c074
    if (mono < 0) {
        if (WWW_TraceFlag != 0) {
            // 0x808c0d8
            if ((WWW_TraceMask & 2) != 0) {
                // 0x808c0e4
                fprintf(TraceFP(), "CSS:LYAttrset (A_NORMAL)\n");
            }
        }
        // 0x808c0fb
        *(int32_t *)(v1 + 16) = 0;
        // 0x808c105
        return;
    }
    if (WWW_TraceFlag != 0) {
        // 0x808c085
        if ((WWW_TraceMask & 2) != 0) {
            char * v3 = attr_to_string(mono); // 0x808c097
            fprintf(TraceFP(), "CSS:LYAttrset mono %#x -> (%s)\n", mono, v3);
        }
    }
    // 0x808c0c2
    *(int32_t *)(v1 + 16) = mono;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808c10b - 0x808c47f
// Line range:    423 - 507
void curses_w_style(int32_t * win, int32_t style, int32_t dir) {
    int32_t v1 = style == -1 ? (int32_t)&nostyle_bucket : 24 * style + (int32_t)&hashStyles;
    int32_t * v2 = (int32_t *)v1; // 0x808c13e
    int32_t v3 = *v2; // 0x808c13e
    if (v3 == 0) {
        if (WWW_TraceFlag == 0) {
            // 0x808c479
            return;
        }
        // 0x808c153
        if ((WWW_TraceMask & 2) != 0) {
            // 0x808c163
            fprintf(TraceFP(), "CSS.CS:Style %d not configured\n", style);
        }
        // 0x808c479
        return;
    }
    if (WWW_TraceFlag != 0) {
        // 0x808c191
        if ((WWW_TraceMask & 2) != 0) {
            int32_t v4 = *(int32_t *)(v1 + 8); // 0x808c1a0
            int32_t v5 = *(int32_t *)(v1 + 4); // 0x808c1a9
            char * v6 = dir == 0 ? (char *)&g22 : (char *)&g21;
            fprintf(TraceFP(), "CSS.CS:<%s%s> style %d code %#x, color %#x\n", v6, (char *)v3, style, v5, v4);
        }
    }
    int32_t v7 = -1; // 0x808c20b
    int32_t * v8 = (int32_t *)-1; // 0x808c20b
    if (win != NULL) {
        int16_t v9 = *(int16_t *)((int32_t)win + 2); // 0x808c22f
        v7 = (int32_t)*(int16_t *)win;
        v8 = (int32_t *)(int32_t)v9;
    }
    int32_t v10 = (int32_t)v8; // 0x808c240
    if (dir != 0 && s_normal == style) {
        // 0x808c256
        LYAttrset(win, *(int32_t *)(v1 + 8), *(int32_t *)(v1 + 12));
        if (LYwin == win) {
            // 0x808c283
            SetCachedStyle(v7, v10, s_normal);
        }
        // 0x808c479
        return;
    }
    switch (dir) {
        case 1: {
            int32_t v11 = last_colorattr_ptr; // 0x808c326
            int32_t v12 = v11; // 0x808c32e
            if (v11 >= 128) {
                // 0x808c330
                if (WWW_TraceFlag != 0) {
                    // 0x808c33b
                    if ((WWW_TraceMask & 2) != 0) {
                        int32_t v13 = *(int32_t *)(4 * v11 + (int32_t)&last_styles); // 0x808c34c
                        fprintf(TraceFP(), "........... %s (0x%x) %s\r\n", "attribute cache FULL, dropping last", v13, "in LynxChangeStyle(curses_w_style)");
                    }
                }
                // 0x808c37e
                last_colorattr_ptr = 127;
                v12 = 127;
            }
            int32_t v14 = LYgetattrs(win); // 0x808c394
            *(int32_t *)(4 * v12 + (int32_t)&last_styles) = v14;
            last_colorattr_ptr = v12 + 1;
        }
        case 2: {
            // 0x808c3a8
            if (s_alink == style | s_curedit == style | s_aedit == style | s_aedit_sel == style || s_aedit_pad == style || s_aedit_arr == style) {
                // 0x808c45a
                LYAttrset(win, *(int32_t *)(v1 + 8), *(int32_t *)(v1 + 12));
                // 0x808c479
                return;
            }
            // 0x808c3f0
            if (WWW_TraceFlag != 0) {
                // 0x808c3fb
                if ((WWW_TraceMask & 2) != 0) {
                    // 0x808c407
                    fprintf(TraceFP(), "CACHED: <%s> @(%d,%d)\n", (char *)*v2, v7, v10);
                }
            }
            // 0x808c437
            if (LYwin == win) {
                // 0x808c441
                SetCachedStyle(v7, v10, style);
            }
            // 0x808c45a
            LYAttrset(win, *(int32_t *)(v1 + 8), *(int32_t *)(v1 + 12));
            // 0x808c479
            return;
        }
        default: {
            if (dir != 0) {
                // 0x808c479
                return;
            }
            // 0x808c2c3
            if (last_colorattr_ptr == 0) {
                // 0x808c306
                LYAttrset(win, 0, -1);
            } else {
                int32_t v15 = last_colorattr_ptr - 1; // 0x808c2d1
                last_colorattr_ptr = v15;
                int32_t v16 = *(int32_t *)(4 * v15 + (int32_t)&last_styles); // 0x808c2de
                LYAttrset(win, v16, v16);
            }
            // 0x808c479
            return;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808c5d9 - 0x808c5fc
// Line range:    545 - 547
void curses_style(int32_t style, int32_t dir) {
    // 0x808c5d9
    curses_w_style(LYwin, style, dir);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808c5fc - 0x808c647
// Line range:    596 - 604
int32_t get_color_pair(int32_t n) {
    if (n > 24) {
        // 0x808c642
        return 256 * n;
    }
    int32_t v1 = 8 * n; // 0x808c60b
    if (*(int32_t *)(v1 + (int32_t)&lynx_color_pairs) != default_fg) {
        // 0x808c642
        return 256 * n;
    }
    // 0x808c61b
    if (*(int32_t *)(v1 + (int32_t)&g278) == default_bg) {
        // 0x808c642
        return 0;
    }
    // 0x808c642
    return 256 * n;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808c647 - 0x808c694
// Line range:    621 - 631
int32_t lynx_color_cfg_attr(uint32_t code) {
    if (code > 7) {
        // 0x808c68f
        return 0;
    }
    int32_t v1 = *(int32_t *)(16 * code + (int32_t)&lynx_color_cfg); // 0x808c666
    int32_t v2 = g157; // 0x808c66f
    return v2 - 1 >= v1 | (v1 & v2) == 0 ? 0 : 0x200000;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808c694 - 0x808c710
// Line range:    634 - 651
int32_t encode_color_attr(uint32_t color_attr) {
    int32_t v1 = (bool)((color_attr & 0x200000) != 0);
    int32_t v2 = ((color_attr & 0x140000) == 0 ? v1 : v1 | 2) | color_attr / 0x8000 & 4;
    int32_t v3 = lynx_color_cfg_attr(v2); // 0x808c6de
    int32_t v4 = v2 + 1; // 0x808c6ec
    int32_t result = v3; // 0x808c6f6
    if (v4 < g172) {
        // 0x808c6f8
        result = get_color_pair(v4) | v3;
    }
    // 0x808c70b
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808c710 - 0x808c761
// Line range:    654 - 665
int32_t decode_mono_code(int32_t mono_code) {
    // 0x808c710
    return 0x20000 * mono_code & 0x40000 | 0x200000 * mono_code & 0x200000 | 0x8000 * mono_code & 0x20000;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808c7a0 - 0x808c987
// Line range:    689 - 723
char * LYgetTableString(int32_t code) {
    int32_t v1 = decode_mono_code(code); // 0x808c7ad
    uint32_t v2 = encode_color_attr(v1); // 0x808c7bb
    uint32_t v3 = v2 / 256 % 256; // 0x808c7cb
    int32_t v4 = v1 & -256; // 0x808c7d4
    int32_t v5 = 8 * v3; // 0x808c7dc
    int32_t v6 = *(int32_t *)(v5 + (int32_t)&lynx_color_pairs); // 0x808c7dc
    uint32_t v7 = *(int32_t *)(v5 + (int32_t)&g278); // 0x808c7e9
    int32_t bg = 0; // bp-40, 0x808c7f3
    int32_t v8; // 0x808c7a0
    if (WWW_TraceFlag == 0) {
        // 0x808c823
        v8 = (v7 | v6) == 0 ? 7 : v6;
    } else {
        // 0x808c823
        fprintf(TraceFP(), "LYgetTableString(%d)\n", code);
        int32_t v9 = (v7 | v6) == 0 ? 7 : v6;
        v8 = v9;
        if (WWW_TraceFlag != 0) {
            // 0x808c841
            fprintf(TraceFP(), "%#x -> %#x (mono %#x pair %d) fg=%d, bg=%d\n", v1, v2, v4, v3, v9, v7);
            v8 = v9;
        }
    }
    for (int32_t i = 0; i < 7; i++) {
        int32_t v10 = 8 * i; // 0x808c890
        if ((*(int32_t *)(v10 + (int32_t)&g102) & v4) != 0) {
            // 0x808c89e
            if (bg != 0) {
                // 0x808c8a5
                HTSACat((char **)&bg, "+");
            }
            int32_t v11 = *(int32_t *)(v10 + (int32_t)&Mono_Attrs); // 0x808c8bb
            HTSACat((char **)&bg, (char *)v11);
        }
    }
    // 0x808c8db
    if (bg == 0) {
        // 0x808c8e2
        HTSACopy((char **)&bg, "normal");
    }
    // 0x808c8f5
    HTSACat((char **)&bg, ":");
    char * v12 = lookup_color(v8); // 0x808c90e
    HTSACat((char **)&bg, v12);
    if (v7 >= 0) {
        // 0x808c928
        HTSACat((char **)&bg, ":");
        char * v13 = lookup_color(v7); // 0x808c941
        HTSACat((char **)&bg, v13);
    }
    // 0x808c955
    if (WWW_TraceFlag != 0) {
        // 0x808c960
        fprintf(TraceFP(), "->%s\n", (char *)bg);
    }
    // 0x808c97e
    return (char *)bg;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808c987 - 0x808c98c
// Line range:    730 - 750
void lynx_init_color_pair(int32_t n) {
    // 0x808c987
    return;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808c98c - 0x808ca26
// Line range:    753 - 769
void lynx_map_color(int32_t n) {
    // 0x808c98c
    if (WWW_TraceFlag != 0) {
        // 0x808c99d
        fprintf(TraceFP(), "lynx_map_color(%d)\n", n);
    }
    int32_t v1 = n + 1; // 0x808c9be
    if (v1 > 24) {
        // 0x808ca19
        lynx_init_color_pair(n);
        return;
    }
    int32_t v2 = 16 * n; // 0x808c9d7
    for (int32_t i = v1; i < 25; i += 8) {
        int32_t v3 = *(int32_t *)(v2 + (int32_t)&lynx_color_cfg); // 0x808c9da
        int32_t v4 = 8 * i; // 0x808c9e0
        *(int32_t *)(v4 + (int32_t)&lynx_color_pairs) = v3;
        int32_t v5 = *(int32_t *)(v2 + (int32_t)&g104); // 0x808c9f0
        *(int32_t *)(v4 + (int32_t)&g278) = v5;
    }
    // 0x808ca07
    *(int32_t *)(8 * n + (int32_t)&g278 + 72) = g104;
    // 0x808ca19
    lynx_init_color_pair(n);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808cb78 - 0x808cc0d
// Line range:    812 - 828
void lynx_init_colors(void) {
    // 0x808cb78
    if (lynx_has_color == 0) {
        // 0x808cbf3
        if (LYShowColor != 0) {
            // 0x808cbfc
            LYShowColor = 1;
        }
        // 0x808cc06
        return;
    }
    // 0x808cb89
    if (WWW_TraceFlag != 0) {
        // 0x808cb94
        fprintf(TraceFP(), "lynx_init_colors (default %d/%d)\n", default_fg, default_bg);
    }
    // 0x808cbbf
    lynx_color_cfg = default_fg;
    g104 = default_bg;
    for (int32_t i = 0; i < 8; i++) {
        // 0x808cbdc
        lynx_init_color_pair(i);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808cc0d - 0x808ccb3
// Line range:    831 - 847
void lynx_setup_colors(void) {
    // 0x808cc0d
    if (WWW_TraceFlag != 0) {
        // 0x808cc1e
        fprintf(TraceFP(), "lynx_setup_colors\n");
    }
    // 0x808cc35
    if (LYuse_default_colors == 0) {
        int32_t v1 = (int32_t)NULL;
        int32_t v2 = 16 * v1;
        if (*(int32_t *)(v2 + (int32_t)&g103) != 0) {
            // 0x808cc59
            *(int32_t *)(v2 + (int32_t)&lynx_color_cfg) = 0;
        }
        // 0x808cc69
        if (*(int32_t *)(v2 + (int32_t)&g105) != 0) {
            // 0x808cc79
            *(int32_t *)(v2 + (int32_t)&g104) = 7;
        }
        struct _IO_FILE * v3 = (struct _IO_FILE *)(v1 + 1); // 0x808cc89
        while (v3 < (struct _IO_FILE *)8) {
            // 0x808cc49
            v1 = (int32_t)v3;
            v2 = 16 * v1;
            if (*(int32_t *)(v2 + (int32_t)&g103) != 0) {
                // 0x808cc59
                *(int32_t *)(v2 + (int32_t)&lynx_color_cfg) = 0;
            }
            // 0x808cc69
            if (*(int32_t *)(v2 + (int32_t)&g105) != 0) {
                // 0x808cc79
                *(int32_t *)(v2 + (int32_t)&g104) = 7;
            }
            // 0x808cc89
            v3 = (struct _IO_FILE *)(v1 + 1);
        }
    }
    for (int32_t i = 0; i < 8; i++) {
        // 0x808cc9c
        lynx_map_color(i);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808ccb3 - 0x808ccf4
// Line range:    851 - 866
void LYnoVideo(int32_t a) {
    // 0x808ccb3
    if (WWW_TraceFlag != 0) {
        // 0x808ccc4
        fprintf(TraceFP(), "LYnoVideo(%d)\n", a);
    }
    // 0x808cce2
    Masked_Attr = decode_mono_code(a);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808ccf4 - 0x808d157
// Line range:    910 - 1279
void start_curses(void) {
    // 0x808ccf4
    if (isatty(fileno((struct _IO_FILE *)g164)) != 0) {
        // 0x808cd1c
        if (LYReopenInput() < 0) {
            // 0x808cd25
            fwrite((int32_t *)"Cannot open tty input\n", 1, 22, (struct _IO_FILE *)g160);
            exit_immediately(1);
            // UNREACHABLE
        }
    }
    // 0x808cd56
    if (LYscreen != NULL) {
        // 0x808d0df
        function_804af04();
        signal(SIGINT, 0x804b4e4);
        function_804b394();
        function_804a934((int32_t)LYwin, 1);
        goto lab_0x808d0f4;
    } else {
        // 0x808cd63
        size_change(0);
        if (WWW_TraceFlag != 0) {
            // 0x808cd8d
            fprintf(TraceFP(), "Screen size: %s()\n", "initscr");
        }
        int32_t v1 = function_804abb4(); // 0x808cdac
        *(int32_t *)&LYscreen = v1;
        if (v1 == 0) {
            char * v2 = gettext("Terminal initialisation failed - unknown terminal type?"); // 0x808cdc6
            fprintf(TraceFP(), "%s\n", v2);
            exit_immediately(1);
            // UNREACHABLE
        }
        // 0x808cdf2
        lynx_called_initscr = 1;
        LYlines = LYscreenHeight();
        LYcols = LYscreenWidth();
        size_change(0);
        recent_sizechange = 0;
        if (WWW_TraceFlag != 0) {
            // 0x808ce2b
            fprintf(TraceFP(), "Screen size is now %d x %d\n", LYlines, LYcols);
        }
        // 0x808ce56
        int32_t v3; // 0x808ccf4
        if (LYuseCursesPads == 0) {
            // 0x808ce91
            *(int32_t *)&LYwin = g158;
            v3 = g158;
        } else {
            int32_t v4 = function_804b094(LYlines, 1014); // 0x808ce71
            *(int32_t *)&LYwin = v4;
            LYshiftWin = 0;
            LYwideLines = 0;
            v3 = v4;
        }
        // 0x808ce9b
        function_804a934(v3, 1);
        if (lynx_initialize_keymaps() == -1) {
            // 0x808cec1
            function_804a9c4();
            exit_immediately(1);
            // UNREACHABLE
        }
        // 0x808ced2
        if ((char)function_804b0e4() == 0) {
            goto lab_0x808d07e;
        } else {
            // 0x808cedf
            lynx_has_color = 1;
            function_804af84();
            int32_t v5 = g157; // 0x808ceee
            if (v5 < 17) {
                if (v5 > 7) {
                    switch (v5) {
                        case 16: {
                            goto lab_0x808cf34;
                        }
                        case 8: {
                            goto lab_0x808cf34;
                        }
                        default: {
                            // 0x808cf2a
                            g157 = 8;
                            goto lab_0x808cf34;
                        }
                    }
                } else {
                    // 0x808cf0c
                    g157 = 2;
                    goto lab_0x808cf34;
                }
            } else {
                // 0x808cf02
                g157 = 16;
                goto lab_0x808cf34;
            }
        }
    }
  lab_0x808d0f4:
    // 0x808d0f4
    lynx_enable_mouse(1);
    fflush(g163);
    fflush((struct _IO_FILE *)g164);
    fflush((struct _IO_FILE *)g160);
    LYCursesON = 1;
    if (WWW_TraceFlag != 0) {
        // 0x808d139
        fprintf(TraceFP(), "start_curses: done.\n");
    }
  lab_0x808d07e:
    // 0x808d07e
    if (lynx_lss_file != 0) {
        char * v6 = (char *)lynx_lss_file; // 0x808d08c
        if (*v6 != 0) {
            // 0x808d093
            if (LYCanReadFile(v6) != 0) {
                // 0x808d0a4
                style_readFromFile((char *)lynx_lss_file);
            }
        }
    }
    // 0x808d0b1
    parse_userstyles();
    lynx_init_colors();
    function_804af04();
    signal(SIGINT, 0x804b4e4);
    function_804b394();
    goto lab_0x808d0f4;
  lab_0x808cf34:
    // 0x808cf34
    if (LYuse_default_colors != 0) {
        // 0x808cf43
        if (function_804b214(default_fg, default_bg) != 0) {
            // 0x808cf5e
            default_fg = 7;
            default_bg = 0;
        }
        // 0x808cf72
        if (WWW_TraceFlag != 0) {
            // 0x808cf7d
            fprintf(TraceFP(), "initializing default colors %d/%d\n", default_fg, default_bg);
        }
        // 0x808cfa8
        if (default_fg < 0 != default_bg < 0) {
            int32_t v7 = 0;
            int32_t * v8; // 0x808cfd9
            if (default_fg >= 0) {
                // 0x808cfd3
                v8 = (int32_t *)(16 * v7 + (int32_t)&lynx_color_cfg);
                if (*v8 < 0) {
                    // 0x808cfe3
                    *v8 = default_fg;
                }
            }
            // 0x808cff5
            int32_t * v9; // 0x808d004
            if (default_bg >= 0) {
                // 0x808cffe
                v9 = (int32_t *)(16 * v7 + (int32_t)&g104);
                if (*v9 < 0) {
                    // 0x808d00e
                    *v9 = default_bg;
                }
            }
            // 0x808d020
            int32_t v10; // 0x808d02e
            int32_t v11; // 0x808d031
            int32_t v12; // 0x808d03d
            if (WWW_TraceFlag != 0) {
                // 0x808d02b
                v10 = 16 * v7;
                v11 = *(int32_t *)(v10 + (int32_t)&g104);
                v12 = *(int32_t *)(v10 + (int32_t)&lynx_color_cfg);
                fprintf(TraceFP(), "color_cfg[%u] = %d/%d\n", v7, v12, v11);
            }
            while (v7 != 7) {
                // 0x808d06b
                v7++;
                if (default_fg >= 0) {
                    // 0x808cfd3
                    v8 = (int32_t *)(16 * v7 + (int32_t)&lynx_color_cfg);
                    if (*v8 < 0) {
                        // 0x808cfe3
                        *v8 = default_fg;
                    }
                }
                // 0x808cff5
                if (default_bg >= 0) {
                    // 0x808cffe
                    v9 = (int32_t *)(16 * v7 + (int32_t)&g104);
                    if (*v9 < 0) {
                        // 0x808d00e
                        *v9 = default_bg;
                    }
                }
                // 0x808d020
                if (WWW_TraceFlag != 0) {
                    // 0x808d02b
                    v10 = 16 * v7;
                    v11 = *(int32_t *)(v10 + (int32_t)&g104);
                    v12 = *(int32_t *)(v10 + (int32_t)&lynx_color_cfg);
                    fprintf(TraceFP(), "color_cfg[%u] = %d/%d\n", v7, v12, v11);
                }
            }
            // 0x808d079
            lynx_setup_colors();
        }
    }
    goto lab_0x808d07e;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808d157 - 0x808d1d4
// Line range:    1282 - 1370
void lynx_enable_mouse(int32_t state) {
    // 0x808d157
    if (LYUseMouse == 0) {
        // 0x808d1d2
        return;
    }
    if (state == 0) {
        // 0x808d1be
        function_804acc4(0, 0);
        // 0x808d1d2
        return;
    }
    // 0x808d16e
    if (g258 == 0) {
        uint32_t v1 = function_804a854(-1); // 0x808d17e
        g258++;
        if (v1 <= 199) {
            // 0x808d19c
            function_804a854(300);
        }
    }
    // 0x808d1a8
    function_804acc4(0x501f1df, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808d1d4 - 0x808d3e6
// Line range:    1393 - 1432
void lynx_nl2crlf(int32_t normal) {
    // 0x808d1d4
    if (g260 == 0) {
        // 0x808d1e7
        if (g165 == 0) {
            // 0x808d2af
            g106 = 0;
            // 0x808d3e4
            return;
        }
        // 0x808d1ff
        g261 = (struct termios *)*(int32_t *)(g165 + 104);
        g262 = *(int32_t *)(g165 + 108);
        g263 = *(int32_t *)(g165 + 112);
        g264 = *(int32_t *)(g165 + 116);
        g265 = *(int32_t *)(g165 + 120);
        g266 = *(int32_t *)(g165 + 124);
        g267 = *(int32_t *)(g165 + 128);
        g268 = *(int32_t *)(g165 + 132);
        g269 = *(int32_t *)(g165 + 136);
        g270 = *(int32_t *)(g165 + 140);
        g271 = *(int32_t *)(g165 + 144);
        g272 = *(int32_t *)(g165 + 148);
        g273 = *(int32_t *)(g165 + 152);
        g274 = *(int32_t *)(g165 + 156);
        g275 = *(int32_t *)(g165 + 160);
        g260 = 1;
    }
    // 0x808d2af
    if (g106 == 0) {
        // 0x808d3e4
        return;
    }
    int32_t v1 = g259;
    if (normal != 0) {
        if (v1 == 0) {
            int32_t * v2 = (int32_t *)(g165 + 108); // 0x808d2da
            *v2 = *v2 | 4;
            g259 = 1;
            int32_t v3; // 0x808d1d4
            function_804ace4(v3);
        }
        // 0x808d3e4
        return;
    }
    if (v1 != 0) {
        // 0x808d304
        *(int32_t *)(g165 + 104) = (int32_t)g261;
        *(int32_t *)(g165 + 108) = g262;
        *(int32_t *)(g165 + 112) = g263;
        *(int32_t *)(g165 + 116) = g264;
        *(int32_t *)(g165 + 120) = g265;
        *(int32_t *)(g165 + 124) = g266;
        *(int32_t *)(g165 + 128) = g267;
        *(int32_t *)(g165 + 132) = g268;
        *(int32_t *)(g165 + 136) = g269;
        *(int32_t *)(g165 + 140) = g270;
        *(int32_t *)(g165 + 144) = g271;
        *(int32_t *)(g165 + 148) = g272;
        *(int32_t *)(g165 + 152) = g273;
        *(int32_t *)(g165 + 156) = g274;
        *(int32_t *)(g165 + 160) = g275;
        tcsetattr(fileno((struct _IO_FILE *)g164), TCSADRAIN, (struct termios *)&g261);
        g259 = 0;
        function_804b364();
        LYrefresh();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808d3e6 - 0x808d496
// Line range:    1435 - 1500
void stop_curses(void) {
    // 0x808d3e6
    if (LYCursesON != 0) {
        // 0x808d401
        FreeCachedStyles();
        function_804a964();
        if (LYCursesON == 1) {
            // 0x808d40c
            lynx_nl2crlf(1);
            lynx_enable_mouse(0);
            if (LYscreen == NULL != (lynx_called_initscr == 0)) {
                // 0x808d438
                function_804a9c4();
            }
        }
    }
    // 0x808d43d
    fflush((struct _IO_FILE *)g164);
    fflush((struct _IO_FILE *)g160);
    LYCursesON = 0;
    if (WWW_TraceFlag != 0) {
        // 0x808d469
        fprintf(TraceFP(), "stop_curses: done.\n");
    }
    // 0x808d480
    signal(SIGINT, SIG_DFL);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808d496 - 0x808d680
// Line range:    1575 - 1639
char setup(char * terminal2) {
    int32_t str = 0; // bp-12, 0x808d49d
    char * term_putenv = NULL; // bp-16, 0x808d4a4
    char * v1 = LYgetXDisplay(); // 0x808d4ab
    if (v1 == NULL) {
        // 0x808d4ce
        if (x_display != 0) {
            // 0x808d4d7
            free((int32_t *)x_display);
            x_display = 0;
        }
    } else {
        // 0x808d4b9
        HTSACopy((char **)&x_display, v1);
    }
    if (terminal2 != NULL) {
        // 0x808d4f4
        HTSprintf0((char **)&str, "TERM=%.106s", terminal2);
        putenv((char *)str);
    }
    char * v2 = LYGetEnv("TERM"); // 0x808d520
    char * v3; // 0x808d496
    if (dumbterm(v2) == 0) {
        goto lab_0x808d630;
    } else {
        // 0x808d535
        printf("\n\n  %s\n\n", gettext("Your Terminal type is unknown!"));
        printf("  %s [vt100] ", gettext("Enter a terminal type:"));
        if (LYSafeGets(&term_putenv, g163) != NULL) {
            // 0x808d585
            LYTrimLeading(term_putenv);
            LYTrimTrailing(term_putenv);
        }
        char * v4 = term_putenv; // 0x808d59b
        if (v4 == NULL) {
            goto lab_0x808d5ac;
        } else {
            // 0x808d5a2
            v3 = v4;
            if (*v4 != 0) {
                goto lab_0x808d5bf;
            } else {
                goto lab_0x808d5ac;
            }
        }
    }
  lab_0x808d630:
    // 0x808d630
    start_curses();
    if (strncmp((char *)&g173, "sun", 3) == 0) {
        // 0x808d655
        LYnoVideo(2);
    }
    // 0x808d661
    LYlines = LYscreenHeight();
    LYcols = LYscreenWidth();
    return 1;
  lab_0x808d5ac:
    // 0x808d5ac
    HTSACopy(&term_putenv, "vt100");
    v3 = term_putenv;
    goto lab_0x808d5bf;
  lab_0x808d5bf:
    // 0x808d5bf
    HTSprintf0((char **)&str, "TERM=%.106s", v3);
    if (term_putenv != NULL) {
        // 0x808d5e0
        free((int32_t *)term_putenv);
        term_putenv = NULL;
    }
    // 0x808d5f2
    putenv((char *)str);
    printf("\n%s %s\n", gettext("TERMINAL TYPE IS SET TO"), LYGetEnv("TERM"));
    LYSleepMsg();
    goto lab_0x808d630;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808d680 - 0x808d72d
// Line range:    1642 - 1658
int32_t dumbterm(char * terminal2) {
    if (terminal2 == NULL || strcasecomp(terminal2, "network") == 0 || strcasecomp(terminal2, "unknown") == 0 || strcasecomp(terminal2, "dialup") == 0 || strcasecomp(terminal2, "dumb") == 0 || strcasecomp(terminal2, "switch") == 0) {
        // 0x808d728
        return 1;
    }
    // 0x808d70a
    if (strcasecomp(terminal2, "ethernet") != 0) {
        // 0x808d728
        return 0;
    }
    // 0x808d728
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808d72d - 0x808d829
// Line range:    1704 - 1717
void LYpaddstr(int32_t * the_window, int32_t width, char * the_string) {
    int32_t v1 = (int32_t)the_window;
    int32_t len = strlen(the_string); // 0x808d73a
    int32_t v2 = -1; // 0x808d765
    if (the_window != NULL) {
        // 0x808d767
        v2 = (int32_t)*(int16_t *)(v1 + 2);
    }
    int32_t v3 = v2;
    int32_t v4 = LYcols - (int32_t)(LYShowScrollbar != 0); // 0x808d7a1
    int32_t v5 = v3 + width > v4 ? v4 - v3 : width;
    int32_t v6 = len > v5 ? v5 : len;
    LYwaddnstr(the_window, the_string, v6);
    int32_t v7 = v5 - v6; // 0x808d7f4
    if (v7 >= 0 != v7 != 0) {
        // 0x808d823
        return;
    }
    int32_t v8 = v7; // 0x808d821
    v8--;
    function_804b144(v1, &g23, -1);
    while (v8 >= 0 == (v8 != 0)) {
        // 0x808d7f9
        v8--;
        function_804b144(v1, &g23, -1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808d829 - 0x808d932
// Line range:    1729 - 1752
void LYsubwindow(int32_t * param) {
    if (param == NULL) {
        int32_t v1 = LYwin == NULL ? -1 : (int32_t)&g256;
        function_804ad84((int32_t)LYwin, 0, v1, 1, v1);
        function_804ab84((int32_t)my_subwindow);
        *(int32_t *)&my_subwindow = 0;
    } else {
        int32_t v2 = (int32_t)param;
        *(int32_t *)&my_subwindow = v2;
        function_804a934(v2, 1);
        curses_w_style(my_subwindow, s_menu_bg, 1);
        int32_t v3 = LYgetattrs(my_subwindow); // 0x808d87d
        function_804b034((int32_t)my_subwindow, v3 | 32);
        curses_w_style(my_subwindow, s_menu_bg, 0);
        function_804a784((int32_t)my_subwindow, 1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808d932 - 0x808d958
// Line range:    1755 - 1757
int32_t * LYtopwindow(void) {
    int32_t * v1 = my_subwindow;
    return v1 == NULL ? LYwin : v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808d958 - 0x808dacb
// Line range:    1764 - 1802
int32_t * LYstartPopup(int32_t * top_y, int32_t * left_x, int32_t * height, int32_t * width) {
    int32_t v1 = *left_x; // 0x808d969
    int32_t v2; // 0x808d958
    if (v1 < 1) {
        goto lab_0x808d9d9;
    } else {
        int32_t v3 = *width + 4;
        if (v3 + v1 < LYcols - (int32_t)(LYShowScrollbar != 0)) {
            int32_t v4 = function_804a8b4(*height, v3, *top_y, v1 - 1); // 0x808d9c7
            v2 = v4;
            if (v4 != 0) {
                goto lab_0x808da9b;
            } else {
                goto lab_0x808d9d9;
            }
        } else {
            goto lab_0x808d9d9;
        }
    }
  lab_0x808d9d9:;
    int32_t v5 = *width; // 0x808d9dc
    int32_t v6 = LYcols - (int32_t)(LYShowScrollbar != 0) - 4; // 0x808d9f9
    int32_t v7; // 0x808d958
    if (v6 < v5) {
        // 0x808da00
        *width = v6;
        v7 = 1;
    } else {
        int32_t v8 = v6 - v5; // 0x808da51
        v7 = v8 >= 0 == (v8 != 0) ? v8 : 1;
    }
    // 0x808da6a
    *left_x = v7;
    v2 = function_804a8b4(*height, *width + 4, *top_y, v7 - 1);
    goto lab_0x808da9b;
  lab_0x808da9b:;
    // 0x808da9b
    int32_t * result; // 0x808d958
    if (v2 != 0) {
        int32_t * v9 = (int32_t *)v2;
        LYsubwindow(v9);
        result = v9;
    } else {
        // 0x808daa1
        HTAlert(gettext("Unable to create popup window!"));
        result = (int32_t *)v2;
    }
    // 0x808dac2
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808dacb - 0x808db03
// Line range:    1805 - 1817
void LYstartTargetEmphasis(void) {
    // 0x808dacb
    if (s_whereis == -1) {
        // 0x808daf2
        lynx_start_bold();
        lynx_start_reverse();
        lynx_start_underline();
    } else {
        // 0x808dadb
        curses_style(s_whereis, 1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808db03 - 0x808db3b
// Line range:    1820 - 1832
void LYstopTargetEmphasis(void) {
    // 0x808db03
    if (s_whereis == -1) {
        // 0x808db2a
        lynx_stop_underline();
        lynx_stop_reverse();
        lynx_stop_bold();
    } else {
        // 0x808db13
        curses_style(s_whereis, 0);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808db68 - 0x808df0d
// Line range:    1868 - 1936
void LYwaddnstr(int32_t * w, char * src, int32_t len) {
    int32_t v1 = (int32_t)LYwin;
    int32_t v2 = LYwin == NULL ? -1 : 0x10000 * v1 >> 16;
    int16_t v3 = *(int16_t *)&g255;
    int32_t v4 = LYwin == NULL ? -1 : (int32_t)v3;
    if (LYwin == w && LYuseCursesPads != 0) {
        // 0x808dbd5
        if (LYshiftWin == 0) {
            // 0x808dbe2
            if (LYwideLines == 0) {
                int32_t v5 = LYcols - (int32_t)(LYShowScrollbar != 0); // 0x808dc09
                if (v5 > v4 == v5 - v4 < len) {
                    int32_t v6 = function_804aab4(v1, LYlines, v5, 0, 0); // 0x808dc7e
                    if (v6 != 0) {
                        // 0x808dc90
                        function_804a914(v6, v2, v4);
                        LYwideLines = 1;
                        LYwaddnstr((int32_t *)v6, src, len);
                        int16_t v7 = *(int16_t *)v6; // 0x808dcd5
                        int16_t v8 = *(int16_t *)(v6 + 2); // 0x808dcf4
                        function_804ab84(v6);
                        function_804a914((int32_t)LYwin, (int32_t)v7, (int32_t)v8);
                    }
                    // 0x808dd32
                    LYwideLines = 0;
                    // 0x808df07
                    return;
                }
            }
        }
    }
    int16_t v9 = v3; // 0x808dd4a
    if (WWW_TraceFlag != 0) {
        // 0x808dda4
        v9 = v3;
        if ((WWW_TraceMask & 2) != 0) {
            // 0x808ddb0
            fprintf(TraceFP(), "[%2d,%2d] LYwaddnstr(%.*s, %u)\n", v2, v4, len, src, len);
            v9 = *(int16_t *)&g255;
        }
    }
    if (len == 0) {
        // 0x808df07
        return;
    }
    int32_t v10 = (int32_t)w;
    int32_t v11 = 0; // 0x808def7
    unsigned char v12 = *(char *)(v11 + (int32_t)src); // 0x808de49
    int32_t v13; // 0x808deb2
    if (v12 != 9) {
        // 0x808deda
        function_804a8f4(v10, (int32_t)v12);
    } else {
        // 0x808de72
        v13 = LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
        v13++;
        function_804a8f4(v10, 32);
        while ((v13 - (LYwin == NULL ? 7 : (int32_t)v9)) % 8 != 0) {
            // 0x808deb2
            v13++;
            function_804a8f4(v10, 32);
        }
    }
    // 0x808def7
    v11++;
    while (v11 != len) {
        // 0x808de41
        v12 = *(char *)(v11 + (int32_t)src);
        if (v12 != 9) {
            // 0x808deda
            function_804a8f4(v10, (int32_t)v12);
        } else {
            // 0x808de72
            v13 = LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
            v13++;
            function_804a8f4(v10, 32);
            while ((v13 - (LYwin == NULL ? 7 : (int32_t)v9)) % 8 != 0) {
                // 0x808deb2
                v13++;
                function_804a8f4(v10, 32);
            }
        }
        // 0x808def7
        v11++;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808df0d - 0x808e0d3
// Line range:    1947 - 1994
int32_t LYstrExtent(char * string, int32_t len, int32_t maxCells) {
    int32_t len2 = len; // 0x808df1e
    if (len < 0) {
        // 0x808df20
        len2 = strlen(string);
    }
    // 0x808df36
    int32_t v1; // 0x808df0d
    if (len2 < 1 || lynx_called_initscr == 0) {
        // 0x808e0c0
        v1 = len2;
        return v1 > maxCells ? maxCells : v1;
    }
    int32_t v2 = g276; // 0x808df55
    int32_t v3; // 0x808df0d
    int32_t v4; // 0x808df0d
    char * v5; // 0x808df0d
    if (v2 < maxCells) {
        int32_t v6 = 2 * maxCells + 2; // 0x808df65
        g276 = v6;
        char * v7 = g277; // 0x808df6c
        v3 = v6;
        if (v7 != NULL) {
            // 0x808df75
            function_804ab84((int32_t)v7);
            g277 = NULL;
            v3 = g276;
        }
        goto lab_0x808df95;
    } else {
        // 0x808df8c
        v3 = v2;
        v4 = (int32_t)g277;
        v5 = g277;
        if (g277 != NULL) {
            goto lab_0x808dfbf;
        } else {
            goto lab_0x808df95;
        }
    }
  lab_0x808e0b0:;
    // 0x808e0b0
    int32_t v8; // 0x808df0d
    int32_t v9 = v8 + 1; // 0x808e0b0
    v8 = v9;
    int32_t v10; // 0x808df0d
    int32_t v11 = v10; // 0x808e0ba
    int32_t v12 = v10; // 0x808e0ba
    if (v9 >= len2) {
        // break -> 0x808e0c0
        goto lab_0x808e0c0;
    }
    goto lab_0x808e00a;
  lab_0x808df95:;
    int32_t v17 = function_804a8b4(2, v3, 0, 0); // 0x808dfb5
    char * v18 = (char *)v17; // 0x808dfba
    g277 = v18;
    v4 = v17;
    v5 = v18;
    goto lab_0x808dfbf;
  lab_0x808dfbf:
    // 0x808dfbf
    if (v5 == NULL) {
        // 0x808e0c0
        v1 = len2;
        return v1 > maxCells ? maxCells : v1;
    }
    // 0x808e00a
    function_804a914(v4, 0, 0);
    v8 = 0;
    v11 = 0;
    while (true) {
      lab_0x808e00a:;
        unsigned char v13 = *(char *)(v8 + (int32_t)string); // 0x808e010
        v10 = v11;
        switch (v13) {
            case 8: {
                goto lab_0x808e0b0;
            }
            case 7: {
                goto lab_0x808e0b0;
            }
            case 6: {
                goto lab_0x808e0b0;
            }
            case 5: {
                goto lab_0x808e0b0;
            }
            case 4: {
                goto lab_0x808e0b0;
            }
            case 3: {
                goto lab_0x808e0b0;
            }
            case 0: {
                goto lab_0x808e0b0;
            }
            default: {
                // 0x808e035
                function_804a8f4((int32_t)g277, (int32_t)v13);
                int32_t v14 = -1; // 0x808e05a
                int32_t v15 = -1; // 0x808e05a
                if (g277 != NULL) {
                    // 0x808e080
                    v14 = (int32_t)*(int16_t *)g277;
                    v15 = (int32_t)*(int16_t *)((int32_t)g277 + 2);
                }
                int32_t v16 = v14;
                v10 = v15;
                if (v15 > maxCells || v16 >= 0 == (v16 != 0)) {
                    // break -> 0x808e0c0
                    break;
                }
                goto lab_0x808e0b0;
            }
        }
    }
  lab_0x808e0c0:
    // 0x808e0c0
    v1 = v12;
    return v1 > maxCells ? maxCells : v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e0d3 - 0x808e0f7
// Line range:    2004 - 2006
int32_t LYstrExtent2(char * string, int32_t len) {
    // 0x808e0d3
    return LYstrExtent(string, len, 8 * len);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e0f7 - 0x808e119
// Line range:    2012 - 2014
int32_t LYstrCells(char * string) {
    // 0x808e0f7
    return LYstrExtent2(string, strlen(string));
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e119 - 0x808e139
// Line range:    2492 - 2498
int32_t LYscreenHeight(void) {
    int32_t v1 = g161; // 0x808e11f
    return v1 >= 0 == (v1 != 0) ? v1 : 24;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e139 - 0x808e159
// Line range:    2501 - 2515
int32_t LYscreenWidth(void) {
    int32_t v1 = g162; // 0x808e13f
    return v1 >= 0 == (v1 != 0) ? v1 : 80;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e159 - 0x808e19b
// Line range:    2522 - 2533
void LYnormalColor(void) {
    int32_t v1 = (int32_t)LYwin; // 0x808e15f
    if (g158 == v1) {
        // 0x808e199
        return;
    }
    // 0x808e16e
    if (g357 >= 0) {
        // 0x808e17c
        function_804b034(v1, g357 | 32);
        LYrefresh();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e19b - 0x808e1b5
// Line range:    2540 - 2547
void LYclear(void) {
    // 0x808e19b
    int32_t v1; // 0x808e19b
    function_804b324((int32_t)LYwin, v1);
    LYnormalColor();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e1b5 - 0x808e1ca
// Line range:    2550 - 2556
void LYclrtoeol(void) {
    // 0x808e1b5
    int32_t v1; // 0x808e1b5
    function_804ac24((int32_t)LYwin, v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e1ca - 0x808e1e4
// Line range:    2559 - 2566
void LYerase(void) {
    // 0x808e1ca
    int32_t v1; // 0x808e1ca
    function_804ab94((int32_t)LYwin, v1);
    LYnormalColor();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e1e4 - 0x808e207
// Line range:    2569 - 2575
void LYmove(int32_t y, int32_t x) {
    // 0x808e1e4
    function_804a914((int32_t)LYwin, y, x);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e207 - 0x808e38d
// Line range:    2578 - 2614
void LYrefresh(void) {
    int32_t v1 = (int32_t)LYwin;
    if (g158 == v1) {
        // 0x808e37a
        function_804ade4(v1);
        // 0x808e387
        return;
    }
    int32_t v2 = LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
    int32_t v3 = LYcols - (int32_t)(LYShowScrollbar != 0); // 0x808e281
    int32_t v4 = v3 < v2 ? v3 : v2;
    function_804a914(g158, LYwin == NULL ? -1 : 0x10000 * v1 >> 16, v4);
    function_804b2a4(g158);
    int32_t v5 = LYscreenWidth(); // 0x808e2d1
    function_804ac04((int32_t)LYwin, 0, LYshiftWin, 0, 0, LYlines, v5 - 1);
    if (my_subwindow != NULL) {
        // 0x808e320
        function_804ad84((int32_t)my_subwindow, 0, (int32_t)&g279, 1, (int32_t)&g391);
        function_804b2a4((int32_t)my_subwindow);
    }
    // 0x808e373
    function_804aa84();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e38d - 0x808e3aa
// Line range:    2617 - 2619
void lynx_force_repaint(void) {
    // 0x808e38d
    int32_t v1; // 0x808e38d
    function_804ac64(g159, 1, v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e3aa - 0x808e3af
// Line range:    2622 - 2626
void lynx_start_title_color(void) {
    // 0x808e3aa
    return;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e3af - 0x808e3b4
// Line range:    2629 - 2633
void lynx_stop_title_color(void) {
    // 0x808e3af
    return;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e3f1 - 0x808e424
// Line range:    2668 - 2693
void lynx_stop_link_color(int32_t flag, int32_t pending) {
    // 0x808e3f1
    curses_style(flag != 1 ? s_a : s_alink, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e4ae - 0x808e4d1
// Line range:    2732 - 2735
void lynx_start_h1_color(void) {
    // 0x808e4ae
    if ((bold_headers || bold_H1) != 0) {
        // 0x808e4ca
        lynx_start_bold();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e4d1 - 0x808e4f4
// Line range:    2738 - 2741
void lynx_stop_h1_color(void) {
    // 0x808e4d1
    if ((bold_headers || bold_H1) != 0) {
        // 0x808e4ed
        lynx_stop_bold();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e4f4 - 0x808e501
// Line range:    2744 - 2746
void lynx_start_prompt_color(void) {
    // 0x808e4f4
    lynx_start_reverse();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e501 - 0x808e50e
// Line range:    2749 - 2751
void lynx_stop_prompt_color(void) {
    // 0x808e501
    lynx_stop_reverse();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e50e - 0x808e51b
// Line range:    2754 - 2756
void lynx_start_radio_color(void) {
    // 0x808e50e
    lynx_start_bold();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e51b - 0x808e528
// Line range:    2759 - 2761
void lynx_stop_radio_color(void) {
    // 0x808e51b
    lynx_stop_bold();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e528 - 0x808e53f
// Line range:    2764 - 2768
void lynx_stop_all_colors(void) {
    // 0x808e528
    lynx_stop_underline();
    lynx_stop_reverse();
    lynx_stop_bold();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e53f - 0x808e57e
// Line range:    2774 - 2776
void lynx_start_bold(void) {
    // 0x808e53f
    function_804b404((int32_t)LYwin, LYUnderlineLinks == 0 ? 0x200000 : 0x20000, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e57e - 0x808e5a3
// Line range:    2779 - 2781
void lynx_start_reverse(void) {
    // 0x808e57e
    function_804b404((int32_t)LYwin, 0x40000, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e5a3 - 0x808e5e2
// Line range:    2784 - 2786
void lynx_start_underline(void) {
    // 0x808e5a3
    function_804b404((int32_t)LYwin, LYUnderlineLinks == 0 ? 0x20000 : 0x200000, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e5e2 - 0x808e621
// Line range:    2789 - 2791
void lynx_stop_bold(void) {
    // 0x808e5e2
    function_804b264((int32_t)LYwin, LYUnderlineLinks == 0 ? 0x200000 : 0x20000, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e621 - 0x808e646
// Line range:    2794 - 2796
void lynx_stop_reverse(void) {
    // 0x808e621
    function_804b264((int32_t)LYwin, 0x40000, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e646 - 0x808e685
// Line range:    2799 - 2801
void lynx_stop_underline(void) {
    // 0x808e646
    function_804b264((int32_t)LYwin, LYUnderlineLinks == 0 ? 0x20000 : 0x200000, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e685 - 0x808e6e1
// Line range:    2804 - 2815
void LYSetDisplayLines(void) {
    // 0x808e685
    if (no_title != 0) {
        if (user_mode != 0) {
            // 0x808e6d2
            display_lines = LYlines - 1;
        } else {
            // 0x808e6c3
            display_lines = LYlines - 3;
        }
    } else {
        if (user_mode != 0) {
            // 0x808e6ab
            display_lines = LYlines - 2;
        } else {
            // 0x808e69c
            display_lines = LYlines - 4;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e6e1 - 0x808e74c
// Line range:    2827 - 2838
void LYstowCursor(int32_t * win, int32_t row, int32_t col) {
    int32_t v1 = (int32_t)win;
    if (LYShowCursor == 0) {
        // 0x808e70d
        LYmove(LYlines - 1, LYcols + (int32_t)(LYShowScrollbar != 0) - 1);
    } else {
        // 0x808e6f2
        function_804a914(v1, row, col);
    }
    // 0x808e73f
    function_804ade4(v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCurses.c
// Address range: 0x808e74c - 0x808e77f
// Line range:    2861 - 2877
int32_t LYgetattrs(int32_t * win) {
    // 0x808e74c
    return *(int32_t *)((int32_t)win + 16);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x808e780 - 0x808e7b0
// Line range:    30 - 34
int32_t LYindex2MBM(uint32_t n) {
    int32_t result = 63; // 0x808e78a
    if (n <= 25) {
        char v1 = *(char *)(n + (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZ"); // 0x808e795
        result = v1;
    }
    // 0x808e7ab
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x808e7b0 - 0x808e849
// Line range:    37 - 47
int32_t LYMBM2index(uint32_t ch) {
    int16_t * v1 = *__ctype_b_loc(); // 0x808e7bb
    int32_t c = ch % 256;
    int32_t c2 = c; // 0x808e7d5
    if ((*(int16_t *)((2 * ch & 510) + (int32_t)v1) & 512) != 0) {
        // 0x808e7d7
        c2 = toupper(c);
    }
    // 0x808e7f3
    if (c2 < 1) {
        // 0x808e844
        return -1;
    }
    char * found_char_pos = strchr("ABCDEFGHIJKLMNOPQRSTUVWXYZ", c2); // 0x808e813
    if (found_char_pos == NULL) {
        // 0x808e844
        return -1;
    }
    int32_t v2 = (int32_t)found_char_pos - (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZ"; // 0x808e827
    return v2 > 25 ? -1 : v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x808e849 - 0x808e8ae
// Line range:    50 - 58
void show_bookmark_not_defined(void) {
    int32_t v1 = 0; // bp-12, 0x808e850
    key_for_func(49);
    char * v2 = gettext("Bookmark file is not defined. Use %s to see options."); // 0x808e86c
    HTSprintf0((char **)&v1, v2);
    LYMBM_statusline((char *)v1);
    if (v1 != 0) {
        // 0x808e896
        free((int32_t *)v1);
        v1 = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x808e8ae - 0x808ea41
// Line range:    72 - 140
char * get_bookmark_filename(char ** URL) {
    int32_t str = 0; // bp-12, 0x808e8b5
    int32_t v1 = select_multi_bookmarks(); // 0x808e8bc
    if (v1 == -2) {
        // 0x808ea38
        return (char *)(int32_t)&g24;
    }
    if ((char *)v1 == (char *)-1) {
        // 0x808e8dc
        show_bookmark_not_defined();
        // 0x808ea38
        return (char *)(int32_t)" ";
    }
    int32_t v2 = *(int32_t *)(4 * v1 + (int32_t)&MBM_A_subbookmark); // 0x808e8f0
    HTSACopy((char **)&BookmarkPage, (char *)v2);
    LYAddPathToHome((char *)&g280, 256, (char *)BookmarkPage);
    if (WWW_TraceFlag != 0) {
        struct _IO_FILE * stream = TraceFP(); // 0x808e935
        fprintf(stream, "\nget_bookmark_filename: SEEKING %s\n   AS %s\n\n", (char *)BookmarkPage, (char *)&g280);
    }
    struct _IO_FILE * v3 = fopen64((char *)&g280, "r"); // 0x808e967
    if (v3 == NULL) {
        // 0x808ea38
        return (char *)0;
    }
    // 0x808e979
    if (LYSafeGets((char **)&str, v3) == NULL) {
        // 0x808e9ea
        is_mosaic_hotlist = 0;
        LYLocalFileToURL(URL, (char *)&g280);
        goto lab_0x808ea04;
    } else {
        // 0x808e98f
        if (*LYTrimNewline((char *)str) == 0) {
            // 0x808e9ea
            is_mosaic_hotlist = 0;
            LYLocalFileToURL(URL, (char *)&g280);
            goto lab_0x808ea04;
        } else {
            // 0x808e9a1
            if (strncmp((char *)str, "ncsa-xmosaic-hotlist-format-1", 29) != 0) {
                // 0x808e9ea
                is_mosaic_hotlist = 0;
                LYLocalFileToURL(URL, (char *)&g280);
                goto lab_0x808ea04;
            } else {
                // 0x808e9c0
                is_mosaic_hotlist = 1;
                char * v4 = convert_mosaic_bookmark_file((char *)&g280); // 0x808e9ce
                LYLocalFileToURL(URL, v4);
                goto lab_0x808ea04;
            }
        }
    }
  lab_0x808ea04:
    // 0x808ea04
    if (str != 0) {
        // 0x808ea0b
        free((int32_t *)str);
        str = 0;
    }
    // 0x808ea1d
    LYCloseInput(v3);
    // 0x808ea38
    return (char *)(int32_t)&g280;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x808ea41 - 0x808ebc9
// Line range:    147 - 188
char * convert_mosaic_bookmark_file(char * filename_buffer) {
    int32_t * fp = NULL; // bp-16, 0x808ea47
    LYRemoveTemp((char *)&g281);
    struct _IO_FILE * stream = LYOpenTemp((char *)&g281, ".html", "w"); // 0x808ea78
    if (stream == NULL) {
        // 0x808ea86
        LYMBM_statusline(gettext("Unable to open tempfile for X Mosaic hotlist conversion."));
        LYSleepAlert();
        // 0x808ebc4
        return (char *)&g24;
    }
    struct _IO_FILE * v1 = fopen64(filename_buffer, "r"); // 0x808eab9
    if (v1 == NULL) {
        // 0x808ebc4
        return (char *)&g24;
    }
    // 0x808ead3
    fprintf(stream, "<head>\n<title>%s</title>\n</head>\n", gettext("Converted Mosaic Hotlist"));
    fprintf(stream, "%s\n\n<p>\n<ol>\n", gettext("     This file is an HTML representation of the X Mosaic hotlist file.\n     Outdated or invalid links may be removed by using the\n     remove bookmark command, it is usually the 'R' key but may have\n     been remapped by you or your system administrator."));
    if (LYSafeGets((char **)&fp, v1) == NULL) {
        // 0x808eba7
        LYCloseTempFP(stream);
        LYCloseInput(v1);
        // 0x808ebc4
        return (char *)&g281;
    }
    int32_t * v2 = (int32_t *)-2;
    int32_t v3; // 0x808ea41
    int32_t v4; // 0x808ea41
    if (v2 < NULL) {
        // 0x808eb1b
        v3 = (int32_t)v2;
    } else {
        // 0x808eb21
        LYTrimNewline((char *)fp);
        v4 = (int32_t)v2;
        if (v4 % 2 != 0) {
            // 0x808eb6f
            fprintf(stream, "%s</a>\n", fp);
            v3 = v4;
        } else {
            // 0x808eb36
            v3 = v4;
            if (*(char *)fp != 0) {
                // 0x808eb40
                strtok((char *)fp, " ");
                fprintf(stream, "<LI><a href=\"%s\">", fp);
                v3 = v4;
            }
        }
    }
    char * v5 = LYSafeGets((char **)&fp, v1); // 0x808eb9a
    while (v5 != NULL) {
        // 0x808eb1b
        v2 = (int32_t *)(v3 + 1);
        if (v2 < NULL) {
            // 0x808eb1b
            v3 = (int32_t)v2;
        } else {
            // 0x808eb21
            LYTrimNewline((char *)fp);
            v4 = (int32_t)v2;
            if (v4 % 2 != 0) {
                // 0x808eb6f
                fprintf(stream, "%s</a>\n", fp);
                v3 = v4;
            } else {
                // 0x808eb36
                v3 = v4;
                if (*(char *)fp != 0) {
                    // 0x808eb40
                    strtok((char *)fp, " ");
                    fprintf(stream, "<LI><a href=\"%s\">", fp);
                    v3 = v4;
                }
            }
        }
        // 0x808eb89
        v5 = LYSafeGets((char **)&fp, v1);
    }
    // 0x808eba7
    LYCloseTempFP(stream);
    LYCloseInput(v1);
    // 0x808ebc4
    return (char *)&g281;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x808ebc9 - 0x808f414
// Line range:    201 - 437
void save_bookmark_link(char * address, char * title) {
    char tmp_buffer[8192]; // bp-16664, 0x808ebc9
    char v1[8192]; // 0x808f04b
    int32_t v2 = __readgsdword(20); // 0x808ebe6
    int32_t * fp = NULL; // bp-16672, 0x808ebf8
    char * filename = NULL; // bp-16676, 0x808ec02
    char * bookmark_URL = NULL; // bp-16680, 0x808ec0c
    char v3; // 0x808ebc9
    char v4; // bp-272, 0x808ebc9
    char * v5; // 0x808ec33
    if (address == NULL) {
        // 0x808ec2c
        v5 = gettext("Malformed address.");
        HTAlert(v5);
        goto lab_0x808f3f9;
    } else {
        // 0x808ec1f
        if (*address != 0) {
            char * str = get_bookmark_filename((char **)&fp); // 0x808ec4e
            if (str != NULL) {
                // 0x808ec72
                if (*str == 0) {
                    goto lab_0x808ec99;
                } else {
                    // 0x808ec7f
                    if (strcmp(str, " ") != 0) {
                        // 0x808ecc4
                        LYstrncpy(&v4, str, 255);
                    } else {
                        goto lab_0x808ec99;
                    }
                }
            } else {
                // 0x808ec62
                v4 = 0;
                v3 = 1;
                goto lab_0x808ece4;
            }
        } else {
            // 0x808ec2c
            v5 = gettext("Malformed address.");
            HTAlert(v5);
            goto lab_0x808f3f9;
        }
    }
  lab_0x808f3f9:
    // 0x808f3f9
    if (v2 != __readgsdword(20)) {
        // 0x808f405
        __stack_chk_fail();
    }
  lab_0x808ec99:
    // 0x808ec99
    if (fp != NULL) {
        // 0x808eca7
        free(fp);
        fp = NULL;
    }
    goto lab_0x808f3f9;
  lab_0x808ece4:
    // 0x808ece4
    if (BookmarkPage != 0) {
        // 0x808ed18
        if (LYMultiBookmarks == 0) {
            goto lab_generated_0;
        } else {
            char * str2 = HTLoadedDocumentURL(); // 0x808ed25
            char v6 = *(char *)BookmarkPage; // 0x808ed35
            if (strstr(str2, (char *)(BookmarkPage + (int32_t)(v6 == 46))) == NULL) {
                goto lab_generated_1;
            } else {
                // 0x808ed7f
                LYMBM_statusline(gettext("Reproduce L)ink in this bookmark file or C)ancel? (l,c): "));
                if (LYgetch_single() == 76) {
                    goto lab_generated_2;
                } else {
                    // 0x808eda7
                    if (fp != NULL) {
                        // 0x808edb5
                        free(fp);
                        fp = NULL;
                    }
                    goto lab_0x808f3f9;
                }
            }
        }
    } else {
        // 0x808eced
        if (fp != NULL) {
            // 0x808ecfb
            free(fp);
            fp = NULL;
        }
        goto lab_0x808f3f9;
    }
  lab_generated_3:;
    int32_t v7; // bp-16656, 0x808ebc9
    int32_t v8; // bp-8464, 0x808ebc9
    if (HTCJK != 1) {
        // 0x808ee4f
        LYstrncpy((char *)&v8, title, 0x1fff);
    } else {
        // 0x808eddc
        switch (kanji_code) {
            case 1: {
                // 0x808edfb
                TO_EUC(title, (char *)&v7);
                // break -> 0x808ee2d
                break;
            }
            case 2: {
                // 0x808ee15
                TO_SJIS(title, (char *)&v7);
                // break -> 0x808ee2d
                break;
            }
        }
        // 0x808ee2d
        LYstrncpy((char *)&v8, (char *)&v7, 0x1fff);
    }
    // 0x808ee6f
    LYReduceBlanks((char *)&v8);
    LYMBM_statusline(gettext("Title: "));
    LYgetstr((char *)&v8, 0, 0x2000, 0);
    while ((char)v8 != 0) {
        // 0x808ef06
        if (havevisible((char *)&v8) != 0) {
            // 0x808ef1c
            LYformTitle(&bookmark_URL, (char *)&v8);
            LYEntify(&bookmark_URL, 1);
            if (UCSaveBookmarksInUnicode == 0) {
                goto lab_0x808efb4;
            } else {
                // 0x808ef55
                if (have8bit(bookmark_URL) == 0) {
                    goto lab_0x808efb4;
                } else {
                    // 0x808ef67
                    if (LYHaveCJKCharacterSet != 0) {
                        goto lab_0x808efb4;
                    } else {
                        char * v9 = title_convert8bit(bookmark_URL); // 0x808ef7b
                        char * v10 = bookmark_URL; // 0x808ef86
                        if (v10 == NULL) {
                            // 0x808efa8
                            *(int32_t *)&bookmark_URL = (int32_t)v9;
                            goto lab_0x808efb4;
                        } else {
                            // 0x808ef90
                            free((int32_t *)v10);
                            bookmark_URL = NULL;
                            // 0x808efa8
                            *(int32_t *)&bookmark_URL = (int32_t)v9;
                            goto lab_0x808efb4;
                        }
                    }
                }
            }
        }
        if (HTCJK != 1) {
            // 0x808ee4f
            LYstrncpy((char *)&v8, title, 0x1fff);
        } else {
            // 0x808eddc
            switch (kanji_code) {
                case 1: {
                    // 0x808edfb
                    TO_EUC(title, (char *)&v7);
                    // break -> 0x808ee2d
                    break;
                }
                case 2: {
                    // 0x808ee15
                    TO_SJIS(title, (char *)&v7);
                    // break -> 0x808ee2d
                    break;
                }
            }
            // 0x808ee2d
            LYstrncpy((char *)&v8, (char *)&v7, 0x1fff);
        }
        // 0x808ee6f
        LYReduceBlanks((char *)&v8);
        LYMBM_statusline(gettext("Title: "));
        LYgetstr((char *)&v8, 0, 0x2000, 0);
    }
    // 0x808eec2
    LYMBM_statusline(gettext("Cancelled!!!"));
    LYSleepMsg();
    if (fp != NULL) {
        // 0x808eee9
        free(fp);
        fp = NULL;
    }
    goto lab_0x808f3f9;
  lab_0x808efb4:
    if (v3 == 0) {
        goto lab_0x808efdc;
    } else {
        // 0x808efbd
        LYAddPathToHome(&v4, 256, (char *)BookmarkPage);
        goto lab_0x808efdc;
    }
  lab_0x808efdc:
    // 0x808efdc
    if (WWW_TraceFlag == 0) {
        goto lab_0x808f014;
    } else {
        struct _IO_FILE * stream = TraceFP(); // 0x808efed
        fprintf(stream, "\nsave_bookmark_link: SEEKING %s\n   AS %s\n\n", (char *)BookmarkPage, &v4);
        goto lab_0x808f014;
    }
  lab_0x808f014:;
    struct _IO_FILE * v11 = fopen64(&v4, v3 == 0 ? "a+" : "w"); // 0x808f046
    v1[0] = (int32_t)v11;
    tmp_buffer = v1;
    int32_t v12 = *(int32_t *)&tmp_buffer; // 0x808f051
    if (v12 != 0) {
        // 0x808f0c0
        HTSACopy(&filename, address);
        LYEntify(&filename, 0);
        if (v3 == 0) {
            goto lab_0x808f1a7;
        } else {
            struct _IO_FILE * stream2 = (struct _IO_FILE *)v12;
            fwrite((int32_t *)"<head>\n", 1, 7, stream2);
            LYAddMETAcharsetToFD(stream2, -1);
            fprintf(stream2, "<title>%s</title>\n</head>\n", gettext("Bookmark file"));
            char * v13 = gettext("Note: if you edit this file manually\n      you should not change the format within the lines\n      or add other HTML markup.\n      Make sure any bookmark link is saved as a single line."); // 0x808f164
            char * v14 = gettext("     This file also may be edited with a standard text editor to delete\n     outdated or invalid links, or to change their order."); // 0x808f172
            fprintf(stream2, "%s<br>\n%s\n\n<!--\n%s\n-->\n\n<p>\n<ol>\n", gettext("     You can delete links using the remove bookmark command.  It is usually\n     the 'R' key but may have been remapped by you or your system\n     administrator."), v14, v13);
            goto lab_0x808f1a7;
        }
    } else {
        // 0x808f05a
        LYMBM_statusline(gettext("ERROR - unable to open bookmark file."));
        LYSleepAlert();
        if (bookmark_URL == NULL) {
            goto lab_0x808f095;
        } else {
            // 0x808f07d
            free((int32_t *)bookmark_URL);
            bookmark_URL = NULL;
            goto lab_0x808f095;
        }
    }
  lab_0x808f1a7:;
    // 0x808f1a7
    struct _IO_FILE * v15; // 0x808ebc9
    if (is_mosaic_hotlist == 0) {
        struct _IO_FILE * stream3 = (struct _IO_FILE *)v12;
        fprintf(stream3, "<LI><a href=\"%s\">%s</a>\n", filename, bookmark_URL);
        v15 = stream3;
        goto lab_0x808f238;
    } else {
        int32_t time_val = time(NULL); // bp-16712, 0x808f1be
        char * time_str = ctime(&time_val); // 0x808f1cd
        struct _IO_FILE * stream4 = (struct _IO_FILE *)v12;
        fprintf(stream4, "%s %s%s\n", filename, time_str, bookmark_URL);
        v15 = stream4;
        goto lab_0x808f238;
    }
  lab_0x808f095:
    // 0x808f095
    if (fp == NULL) {
        goto lab_0x808f3f9;
    } else {
        // 0x808f0a3
        free(fp);
        fp = NULL;
        goto lab_0x808f3f9;
    }
  lab_0x808f238:
    // 0x808f238
    LYCloseOutput(v15);
    int32_t v16 = nhist; // 0x808f24d
    int32_t v17 = 0; // 0x808f24d
    if (v3 != 0 || nhist < 1 || fp == NULL) {
        goto lab_0x808f37a;
    } else {
        goto lab_0x808f27d;
    }
  lab_0x808f37a:
    // 0x808f37a
    if (bookmark_URL == NULL) {
        goto lab_0x808f39c;
    } else {
        // 0x808f384
        free((int32_t *)bookmark_URL);
        bookmark_URL = NULL;
        goto lab_0x808f39c;
    }
  lab_0x808f27d:;
    int32_t v18 = 44 * v17; // 0x808f289
    int32_t v19 = v18 + (int32_t)history; // 0x808f28c
    int32_t v20 = v16; // 0x808f294
    if (*(int32_t *)(v19 + 16) == 0) {
        goto lab_0x808f362;
    } else {
        // 0x808f29a
        if (strcmp((char *)*(int32_t *)(v19 + 4), (char *)fp) != 0) {
            // 0x808f29a
            v20 = nhist;
            goto lab_0x808f362;
        } else {
            int32_t v21 = *(int32_t *)(v18 + 4 + (int32_t)history); // bp-16736, 0x808f2de
            int32_t * v22 = HTAnchor_findAddress(&v21); // 0x808f32a
            int32_t * v23 = HTAnchor_document(v22); // 0x808f33e
            if (v23 == NULL) {
                goto lab_0x808f37a;
            } else {
                // 0x808f352
                HText_setNoCache(v23);
                goto lab_0x808f37a;
            }
        }
    }
  lab_0x808f39c:
    // 0x808f39c
    if (filename == NULL) {
        goto lab_0x808f3be;
    } else {
        // 0x808f3a6
        free((int32_t *)filename);
        filename = NULL;
        goto lab_0x808f3be;
    }
  lab_0x808f362:;
    int32_t v24 = v17 + 1; // 0x808f362
    v16 = v20;
    v17 = v24;
    if (v20 > v24) {
        goto lab_0x808f27d;
    } else {
        goto lab_0x808f37a;
    }
  lab_0x808f3be:
    // 0x808f3be
    if (fp == NULL) {
        goto lab_0x808f3e0;
    } else {
        // 0x808f3c8
        free(fp);
        fp = NULL;
        goto lab_0x808f3e0;
    }
  lab_0x808f3e0:
    // 0x808f3e0
    LYMBM_statusline(gettext("Done!"));
    LYSleepMsg();
    goto lab_0x808f3f9;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x808f414 - 0x808fcaa
// Line range:    447 - 682
void remove_bookmark_link(uint32_t cur, char * cur_bookmark_page) {
    char homepath[256]; // bp-788, 0x808f414
    char v1[256]; // 0x808f4ee
    int32_t v2 = __readgsdword(20); // 0x808f427
    int32_t * fp = NULL; // bp-796, 0x808f432
    if (WWW_TraceFlag != 0) {
        // 0x808f455
        fprintf(TraceFP(), "remove_bookmark_link: deleting link number: %d\n", cur);
    }
    int32_t file_path; // bp-268, 0x808f414
    int32_t path; // bp-524, 0x808f414
    char v3; // 0x808f414
    int32_t v4; // 0x808f4f4
    struct _IO_FILE * stream; // 0x808f619
    int32_t v5; // 0x808f414
    if (cur_bookmark_page == NULL) {
        goto lab_0x808fc90;
    } else {
        // 0x808f480
        LYAddPathToHome((char *)&file_path, 256, cur_bookmark_page);
        if (WWW_TraceFlag != 0) {
            // 0x808f4ab
            fprintf(TraceFP(), "\nremove_bookmark_link: SEEKING %s\n   AS %s\n\n", cur_bookmark_page, &file_path);
        }
        struct _IO_FILE * v6 = fopen64((char *)&file_path, "r"); // 0x808f4e9
        v1[0] = (int32_t)v6;
        homepath = v1;
        v4 = *(int32_t *)&homepath;
        if (v4 != 0) {
            // 0x808f516
            int32_t v7; // bp-780, 0x808f414
            LYAddPathToHome((char *)&v7, 256, (char *)&g24);
            struct _IO_FILE * v8 = LYOpenScratch((char *)&path, (char *)&v7); // 0x808f547
            if (v8 != NULL) {
                // 0x808f582
                int32_t v9; // bp-928, 0x808f414
                int32_t v10 = stat64((int32_t)&file_path, &v9); // 0x808f595
                v3 = 0;
                stream = v8;
                if (v10 != 0) {
                    goto lab_0x808f654;
                } else {
                    // 0x808f5a2
                    chmod((char *)&path, v5 % 128 | 384);
                    stream = LYReopenTemp((char *)&path);
                    v3 = v5 == 1 == (v5 & 0xf000) == 0x8000;
                    if (stream != NULL) {
                        goto lab_0x808f654;
                    } else {
                        // 0x808f62d
                        LYCloseInput((struct _IO_FILE *)v4);
                        HTAlert(gettext("Unable to reopen temporary file for deletion of link."));
                        goto lab_0x808fc90;
                    }
                }
            } else {
                // 0x808f55b
                LYCloseInput((struct _IO_FILE *)v4);
                HTAlert(gettext("Unable to open scratch file for deletion of link."));
                goto lab_0x808fc90;
            }
        } else {
            // 0x808f4fd
            HTAlert(gettext("Unable to open bookmark file for deletion of link."));
            goto lab_0x808fc90;
        }
    }
  lab_0x808f7b3_3:
    // 0x808f7b3
    HTAlert(gettext("Link is not by itself all on one line in bookmark file."));
    char v11 = 0; // 0x808f7c7
    int32_t * v12 = &stream->e0; // 0x808f7c7
    goto lab_0x808fbf3_2;
  lab_0x808f8b3:;
    int32_t * v45 = fp; // 0x808f8b3
    if (v45 != NULL) {
        // 0x808f8bd
        free(v45);
        fp = NULL;
    }
    // 0x808f8d5
    if (WWW_TraceFlag != 0) {
        // 0x808f8e0
        fprintf(TraceFP(), "remove_bookmark_link: files: %s %s\n", &path, &file_path);
    }
    // 0x808f90d
    LYCloseInput((struct _IO_FILE *)v4);
    homepath = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char v42; // 0x808f414
    if (fflush(stream) != -1) {
        // 0x808f978
        LYCloseTempFP(stream);
        v42 = 0;
        if (v3 != 0) {
            goto lab_0x808f9e8;
        } else {
            // 0x808f999
            if (LYCopyFile((char *)&path, (char *)&file_path) != 0) {
                // 0x808f9c8
                LYSleepAlert();
                HTUserMsg(gettext("Unable to copy temporary file for deletion of link."));
                v42 = 1;
                goto lab_0x808f9e8;
            } else {
                // 0x808f9b5
                LYRemoveTemp((char *)&path);
                goto lab_0x808fc90;
            }
        }
    } else {
        // 0x808f938
        v11 = 0;
        v12 = &stream->e0;
        if (WWW_TraceFlag != 0) {
            char * err_str2 = strerror(*__errno_location()); // 0x808f951
            fprintf(TraceFP(), "fflush(nfp): %s", err_str2);
            v11 = 0;
            v12 = &stream->e0;
        }
        goto lab_0x808fbf3_2;
    }
  lab_0x808f872:;
    int32_t fputs_rc2 = fputs((char *)fp, stream); // 0x808f885
    int32_t * v21; // 0x808f414
    int32_t * v35 = v21; // 0x808f88d
    v11 = 0;
    v12 = &stream->e0;
    if (fputs_rc2 == -1) {
        // break -> 0x808fbf3
        goto lab_0x808fbf3_2;
    }
    goto lab_0x808f893;
  lab_0x808f893:;
    // 0x808f893
    struct _IO_FILE * v15; // 0x808f414
    char * v46 = LYSafeGets((char **)&fp, v15); // 0x808f8a6
    int32_t * v16 = v35; // 0x808f8ad
    if (v46 == NULL) {
        goto lab_0x808f8b3;
    }
    goto lab_0x808f6ed;
  lab_0x808fbf3_2:
    // 0x808fbf3
    if (fp != NULL) {
        // 0x808fbfd
        free(fp);
        fp = NULL;
    }
    // 0x808fc15
    HTAlert(gettext("Bookmark deletion failed."));
    if (v12 != NULL) {
        // 0x808fc32
        LYCloseTempFP((struct _IO_FILE *)v12);
    }
    int32_t v13 = *(int32_t *)&homepath; // 0x808fc40
    if (v13 != 0) {
        // 0x808fc49
        LYCloseInput((struct _IO_FILE *)v13);
    }
    if (v11 == 0) {
        // 0x808fc82
        LYRemoveTemp((char *)&path);
    } else {
        char * v14 = gettext("File may be recoverable from %s during this session"); // 0x808fc67
        HTUserMsg2(v14, (char *)&path);
    }
    goto lab_0x808fc90;
  lab_0x808fc90:
    // 0x808fc90
    if (v2 != __readgsdword(20)) {
        // 0x808fc9c
        __stack_chk_fail();
    }
  lab_0x808f654:
    // 0x808f654
    if (is_mosaic_hotlist == 0) {
        // 0x808f893
        v15 = (struct _IO_FILE *)v4;
        if (LYSafeGets((char **)&fp, v15) != NULL) {
            // 0x808f6ed
            v16 = (int32_t *)-1;
            while (true) {
              lab_0x808f6ed:;
                int32_t * v17 = v16;
                int32_t * v18 = fp; // 0x808f708
                int32_t v19 = 0; // 0x808f718
                if (cur == 0) {
                    // 0x808f71e
                    v19 = LYstrstr((char *)v18, "<ol><LI>") != NULL;
                }
                int32_t v20 = (int32_t)v17; // 0x808f835
                v21 = v17;
                if (v20 < cur) {
                    int32_t v22 = v19;
                    char * v23 = LYstrstr((char *)v18, "<a href="); // 0x808f851
                    char * v24 = v23; // 0x808f863
                    int32_t v25 = v20; // 0x808f863
                    v21 = v17;
                    if (v23 != NULL) {
                        int32_t v26 = 0;
                        int32_t v27 = (int32_t)v24;
                        int32_t v28 = v25 + 1; // 0x808f75d
                        char v29 = 1; // 0x808f76d
                        if (v28 == cur) {
                            if (v26 != 0) {
                                goto lab_0x808f7b3_3;
                            }
                            // 0x808f77c
                            if (LYstrstr((char *)fp, "</a>") == NULL) {
                                goto lab_0x808f7b3_3;
                            }
                            // 0x808f796
                            if (LYstrstr((char *)(v27 + 1), "<a href=") != NULL) {
                                goto lab_0x808f7b3_3;
                            }
                            // 0x808f7cc
                            if (WWW_TraceFlag != 0) {
                                // 0x808f7d7
                                fprintf(TraceFP(), "remove_bookmark_link: skipping link %d\n", v28);
                            }
                            // 0x808f7f8
                            v29 = 0;
                            if (v22 != 0) {
                                // 0x808f801
                                fwrite((int32_t *)"<ol>\n", 1, 5, stream);
                                v29 = 0;
                            }
                        }
                        int32_t * v30 = (int32_t *)v28;
                        char v31 = v29;
                        while (v28 < cur) {
                            char * v32 = LYstrstr((char *)(v27 + 8), "<a href="); // 0x808f851
                            v24 = v32;
                            char v33 = v31; // 0x808f863
                            int32_t v34 = v26 + 1; // 0x808f863
                            v25 = v28;
                            if (v32 == NULL) {
                                // break -> 0x808f869
                                break;
                            }
                            v26 = v34;
                            v27 = (int32_t)v24;
                            v28 = v25 + 1;
                            v29 = v33;
                            if (v28 == cur) {
                                if (v26 != 0) {
                                    goto lab_0x808f7b3_3;
                                }
                                // 0x808f77c
                                if (LYstrstr((char *)fp, "</a>") == NULL) {
                                    goto lab_0x808f7b3_3;
                                }
                                // 0x808f796
                                if (LYstrstr((char *)(v27 + 1), "<a href=") != NULL) {
                                    goto lab_0x808f7b3_3;
                                }
                                // 0x808f7cc
                                if (WWW_TraceFlag != 0) {
                                    // 0x808f7d7
                                    fprintf(TraceFP(), "remove_bookmark_link: skipping link %d\n", v28);
                                }
                                // 0x808f7f8
                                v29 = 0;
                                if (v22 != 0) {
                                    // 0x808f801
                                    fwrite((int32_t *)"<ol>\n", 1, 5, stream);
                                    v29 = 0;
                                }
                            }
                            // 0x808f82e
                            v30 = (int32_t *)v28;
                            v31 = v29;
                        }
                        // 0x808f869
                        v35 = v30;
                        v21 = v30;
                        if (v31 == 0) {
                            goto lab_0x808f893;
                        } else {
                            goto lab_0x808f872;
                        }
                    } else {
                        goto lab_0x808f872;
                    }
                } else {
                    goto lab_0x808f872;
                }
            }
            goto lab_0x808fbf3_2;
        } else {
            goto lab_0x808f8b3;
        }
    } else {
        struct _IO_FILE * v36 = (struct _IO_FILE *)v4;
        if (LYSafeGets((char **)&fp, v36) != NULL) {
            int32_t v37 = 2 * cur; // 0x808f662
            int32_t v38 = (int32_t)(int32_t *)-3 + 1; // 0x808f676
            int32_t fputs_rc; // 0x808f6af
            if (v38 != v37 && (v37 || 1) != v38) {
                // 0x808f69c
                fputs_rc = fputs((char *)fp, stream);
                v11 = 0;
                v12 = &stream->e0;
                if (fputs_rc == -1) {
                    goto lab_0x808fbf3_2;
                }
            }
            char * v39 = LYSafeGets((char **)&fp, v36); // 0x808f6d0
            int32_t * v40 = (int32_t *)v38; // 0x808f6d7
            while (v39 != NULL) {
                // 0x808f676
                v38 = (int32_t)v40 + 1;
                if (v38 != v37 && (v37 || 1) != v38) {
                    // 0x808f69c
                    fputs_rc = fputs((char *)fp, stream);
                    v11 = 0;
                    v12 = &stream->e0;
                    if (fputs_rc == -1) {
                        goto lab_0x808fbf3_2;
                    }
                }
                // 0x808f6bd
                v39 = LYSafeGets((char **)&fp, v36);
                v40 = (int32_t *)v38;
            }
        }
        goto lab_0x808f8b3;
    }
  lab_0x808f9e8:
    // 0x808f9e8
    if (rename((char *)&path, (char *)&file_path) == -1) {
        // 0x808fa34
        if (*__errno_location() != 18) {
            // 0x808fb91
            if (WWW_TraceFlag != 0) {
                int32_t * v41 = __errno_location(); // 0x808fb9c
                int32_t err_num = *v41; // 0x808fba1
                char * err_str = strerror(err_num); // 0x808fba6
                fprintf(TraceFP(), "rename(): %s", err_str);
            }
            // 0x808fbc8
            HTAlert(gettext("Error renaming temporary file."));
            v11 = v42;
            v12 = NULL;
            if (WWW_TraceFlag != 0) {
                // 0x808fbe7
                perror("renaming the file");
                v11 = v42;
                v12 = NULL;
            }
            goto lab_0x808fbf3_2;
        } else {
            int32_t v43 = 0; // bp-828, 0x808fa44
            char * v44 = HTGetProgramPath(10); // 0x808fa55
            v11 = 1;
            v12 = NULL;
            if (v44 == NULL) {
                goto lab_0x808fbf3_2;
            } else {
                // 0x808fa6d
                HTAddParam((char **)&v43, "%s %s %s", 1, v44);
                HTAddParam((char **)&v43, "%s %s %s", 2, (char *)&path);
                HTAddParam((char **)&v43, "%s %s %s", 3, (char *)&file_path);
                HTEndParam((char **)&v43, "%s %s %s", 3);
                if (LYSystem((char *)v43) != 0) {
                    // 0x808fb66
                    v11 = 1;
                    v12 = NULL;
                    if (v43 != 0) {
                        // 0x808fb70
                        free((int32_t *)v43);
                        v43 = 0;
                        v11 = 1;
                        v12 = NULL;
                    }
                    goto lab_0x808fbf3_2;
                } else {
                    if (v3 != 0) {
                        // 0x808fb1e
                        chmod((char *)&file_path, v5 % 0x1000);
                    }
                    // 0x808fb3b
                    if (v43 != 0) {
                        // 0x808fb49
                        free((int32_t *)v43);
                        v43 = 0;
                    }
                    goto lab_0x808fc90;
                }
            }
        }
    } else {
        if (v3 != 0) {
            // 0x808fa12
            chmod((char *)&file_path, v5 % 0x1000);
        }
        goto lab_0x808fc90;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x808fcaa - 0x808fe01
// Line range:    688 - 762
int32_t select_multi_bookmarks(void) {
    // 0x808fcaa
    if (LYMultiBookmarks == 0 || LYHaveSubBookmarks() == 0) {
        // 0x808fdfc
        return MBM_A_subbookmark == 0;
    }
    // 0x808fce3
    if (LYMultiBookmarks != 2 || user_mode != 2) {
        // 0x808fdfc
        return select_menu_multi_bookmarks();
    }
    // 0x808fcff
    LYMBM_statusline(gettext("Select subbookmark, '=' for menu, or ^G to cancel: "));
    int32_t v1 = LYgetch(); // 0x808fd13
    if (v1 != 7 != (v1 != 3 == LYisNonAlnumKeyname(v1, 37) == 0)) {
        // 0x808fdfc
        return -2;
    }
    int32_t v2 = v1; // 0x808fd30
    while (true) {
        int32_t v3 = v2;
        int32_t result; // 0x808fcaa
        if (LYisNonAlnumKeyname(v3, 21) == 0) {
            // 0x808fd6d
            if (LYisNonAlnumKeyname(v3, 39) != 0) {
                // break -> 0x808fd84
                break;
            }
            if (v3 == 61) {
                // 0x808fdad
                result = select_menu_multi_bookmarks();
                return result;
            }
            uint32_t v4 = LYMBM2index(v3); // 0x808fdbd
            if (v4 >= 0) {
                int32_t v5 = *(int32_t *)(4 * v4 + (int32_t)&MBM_A_subbookmark); // 0x808fdd2
                result = v5 == 0 ? -1 : v4;
                return result;
            }
        } else {
            // 0x808fd61
            lynx_force_repaint();
            LYrefresh();
        }
        // 0x808fd13
        v2 = LYgetch();
        result = -2;
        if (v2 != 7 != (v2 != 3 == LYisNonAlnumKeyname(v2, 37) == 0)) {
          lab_0x808fdfc:
            // 0x808fdfc
            return result;
        }
    }
    // 0x808fdfc
    return MBM_A_subbookmark == 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x808fe01 - 0x8090388
// Line range:    768 - 937
int32_t select_menu_multi_bookmarks(void) {
    // 0x808fe01
    if (LYMultiBookmarks == 0) {
        // 0x809037f
        return 0;
    }
    int32_t v1 = LYlines - 7; // 0x808fe22
    if (v1 >= 0 != v1 != 0) {
        // 0x808fe2e
        HTAlert(gettext("Screen too small! (8x35 min)"));
        // 0x809037f
        return -2;
    }
    int32_t v2 = 25 / v1 + 1; // 0x808fe60
    int32_t v3 = 1; // 0x808fe66
    int32_t result; // 0x808fe01
    while (true) {
      lab_0x808fe6d_2:;
        int32_t v4 = v3;
        LYclear();
        LYmove(1, 5);
        lynx_start_h1_color();
        if (v2 < 2) {
            int32_t len = strlen(gettext("       Select Bookmark")); // 0x808ff4c
            LYwaddnstr(LYwin, gettext("       Select Bookmark"), len);
        } else {
            int32_t MBM_to = 0; // bp-44, 0x808fecc
            char * v5 = gettext(" Select Bookmark (screen %d of %d)"); // 0x808feda
            HTSprintf0((char **)&MBM_to, v5);
            LYwaddnstr(LYwin, (char *)MBM_to, strlen((char *)MBM_to));
            int32_t v6 = MBM_to; // 0x808ff22
            if (v6 != 0) {
                // 0x808ff29
                free((int32_t *)v6);
                MBM_to = 0;
            }
        }
        uint32_t v7 = v4 - 1; // 0x808fe70
        int32_t v8 = v7 * v1; // 0x808fe73
        int32_t v9 = (v8 >= 0 ? v8 : 0) + (int32_t)(v4 != 1);
        int32_t v10 = v4 * v1; // 0x808fe94
        uint32_t v11 = v10 < 25 ? v10 : 25;
        lynx_stop_h1_color();
        int32_t v12 = v9; // 0x80900ae
        int32_t v13 = 0; // 0x80900ae
        if (v9 <= v11) {
            uint32_t v14 = v12;
            int32_t v15 = v13 + 3; // 0x808ff8f
            LYmove(v15, 5);
            int32_t v16 = LYindex2MBM(v14); // 0x808ffa8
            function_804a8f4((int32_t)LYwin, v16);
            LYwaddnstr(LYwin, " : ", 3);
            int32_t v17 = 4 * v14; // 0x808ffdf
            int32_t * v18 = (int32_t *)(v17 + (int32_t)&MBM_A_subdescript); // 0x808ffdf
            int32_t str = *v18; // 0x808ffdf
            int32_t len2; // 0x808fff7
            if (str != 0) {
                // 0x808ffea
                len2 = strlen((char *)str);
                LYwaddnstr(LYwin, (char *)*v18, len2);
            }
            // 0x809001e
            LYmove(v15, 36);
            function_804a8f4((int32_t)LYwin, 40);
            int32_t * v19 = (int32_t *)(v17 + (int32_t)&MBM_A_subbookmark); // 0x809004c
            int32_t str2 = *v19; // 0x809004c
            int32_t len3; // 0x8090064
            if (str2 != 0) {
                // 0x8090057
                len3 = strlen((char *)str2);
                LYwaddnstr(LYwin, (char *)*v19, len3);
            }
            // 0x809008b
            function_804a8f4((int32_t)LYwin, 41);
            v12 = v14 + 1;
            v13++;
            while (v14 < v11) {
                // 0x808ff8c
                v14 = v12;
                v15 = v13 + 3;
                LYmove(v15, 5);
                v16 = LYindex2MBM(v14);
                function_804a8f4((int32_t)LYwin, v16);
                LYwaddnstr(LYwin, " : ", 3);
                v17 = 4 * v14;
                v18 = (int32_t *)(v17 + (int32_t)&MBM_A_subdescript);
                str = *v18;
                if (str != 0) {
                    // 0x808ffea
                    len2 = strlen((char *)str);
                    LYwaddnstr(LYwin, (char *)*v18, len2);
                }
                // 0x809001e
                LYmove(v15, 36);
                function_804a8f4((int32_t)LYwin, 40);
                v19 = (int32_t *)(v17 + (int32_t)&MBM_A_subbookmark);
                str2 = *v19;
                if (str2 != 0) {
                    // 0x8090057
                    len3 = strlen((char *)str2);
                    LYwaddnstr(LYwin, (char *)*v19, len3);
                }
                // 0x809008b
                function_804a8f4((int32_t)LYwin, 41);
                v12 = v14 + 1;
                v13++;
            }
        }
        if (v2 >= 2) {
            // 0x80900be
            LYmove(LYlines - 2, 0);
            LYwaddnstr(LYwin, "'", 1);
            lynx_start_bold();
            LYwaddnstr(LYwin, "[", 1);
            lynx_stop_bold();
            LYwaddnstr(LYwin, "' ", 2);
            int32_t len4 = strlen(gettext("previous")); // 0x8090146
            LYwaddnstr(LYwin, gettext("previous"), len4);
            LYwaddnstr(LYwin, ", '", 3);
            lynx_start_bold();
            LYwaddnstr(LYwin, "]", 1);
            lynx_stop_bold();
            LYwaddnstr(LYwin, "' ", 2);
            int32_t len5 = strlen(gettext("next screen")); // 0x80901df
            LYwaddnstr(LYwin, gettext("next screen"), len5);
        }
        // 0x8090208
        LYMBM_statusline(gettext("Select destination or ^G to Cancel: "));
        while (true) {
            int32_t v20 = LYgetch(); // 0x809021c
            int32_t v21 = LYMBM2index(v20); // 0x809022a
            if (v21 < 0) {
                // 0x809026c
                result = -2;
                if (v20 != 3 != (v20 != 7 == LYisNonAlnumKeyname(v20, 37) == 0)) {
                    return result;
                }
                // 0x809029b
                if (LYisNonAlnumKeyname(v20, 21) == 0) {
                    // 0x80902c1
                    if (LYisNonAlnumKeyname(v20, 39) != 0) {
                        // 0x80902d8
                        result = MBM_A_subbookmark == 0;
                        return result;
                    }
                    if (v20 == 93) {
                        if (v2 >= 2) {
                            // break -> 0x809031f
                            break;
                        }
                        // 0x8090341
                        LYisNonAlnumKeyname(93, 16);
                    } else {
                        // 0x8090302
                        if (!((v2 < 2 | LYisNonAlnumKeyname(v20, 15) == 0))) {
                            // break -> 0x809031f
                            break;
                        }
                        if (v20 == 91) {
                            if (v2 >= 2) {
                                // 0x808fe6d
                                v3 = v7 >= 0 == (v7 != 0) ? v7 : v2;
                                goto lab_0x808fe6d_2;
                            }
                        } else {
                            // 0x8090341
                            if (!((v2 < 2 | LYisNonAlnumKeyname(v20, 16) == 0))) {
                                // 0x808fe6d
                                v3 = v7 >= 0 == (v7 != 0) ? v7 : v2;
                                goto lab_0x808fe6d_2;
                            }
                        }
                    }
                } else {
                    // 0x80902b2
                    lynx_force_repaint();
                    LYrefresh();
                }
            } else {
                // 0x8090238
                result = v21;
                if (*(int32_t *)(4 * v21 + (int32_t)&MBM_A_subbookmark) != 0) {
                    return result;
                }
                // 0x8090251
                show_bookmark_not_defined();
                LYMBM_statusline(gettext("Select destination or ^G to Cancel: "));
            }
        }
        int32_t v22 = v4 + 1; // 0x809031f
        // 0x808fe6d
        v3 = v22 > v2 ? 1 : v22;
        goto lab_0x808fe6d_2;
    }
  lab_0x809037f_2:
    // 0x809037f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x8090388 - 0x80903d0
// Line range:    944 - 953
char LYHaveSubBookmarks(void) {
    int32_t v1 = 1; // 0x80903bc
    int32_t v2 = *(int32_t *)(4 * v1 + (int32_t)&MBM_A_subbookmark); // 0x809039a
    if (v2 != 0) {
        // 0x80903a5
        if (*(char *)v2 != 0) {
            // break -> 0x80903ca
            break;
        }
    }
    // 0x80903bc
    v1++;
    char result = 0; // 0x80903c4
    while (v1 < 25) {
        // 0x8090397
        v2 = *(int32_t *)(4 * v1 + (int32_t)&MBM_A_subbookmark);
        if (v2 != 0) {
            // 0x80903a5
            result = 1;
            if (*(char *)v2 != 0) {
                // break -> 0x80903ca
                break;
            }
        }
        // 0x80903bc
        v1++;
        result = 0;
    }
    // 0x80903ca
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x80903d0 - 0x8090427
// Line range:    963 - 971
void LYMBM_statusline(char * text) {
    // 0x80903d0
    if (LYMultiBookmarks == 0 || user_mode != 0) {
        // 0x8090413
        mustshow = 1;
        statusline(text);
        // 0x8090425
        return;
    }
    // 0x80903e8
    LYStatusLine = LYlines - 1;
    mustshow = 1;
    statusline(text);
    LYStatusLine = -1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x8090427 - 0x8090508
// Line range:    977 - 1000
char havevisible(char * Title) {
    char v1 = *Title; // 0x80904f3
    char v2 = v1; // 0x80904f8
    if (v1 == 0) {
        // 0x8090502
        return 0;
    }
    char * v3 = Title; // 0x80904f8
    char result; // 0x8090427
    char * v4; // 0x8090427
    while (true) {
      lab_0x8090438:;
        unsigned char v5 = v2;
        result = 1;
        if (v5 < 127) {
            // break -> 0x8090502
            break;
        }
        // 0x8090456
        v4 = v3;
        if (v5 < 33 || v5 == 127) {
            goto lab_0x80904ec;
        } else {
            // 0x809046a
            result = 1;
            if (LYHaveCJKCharacterSet != 0) {
                // break -> 0x8090502
                break;
            }
            // 0x8090475
            result = 1;
            if (UCCanUniTranslateFrom(current_char_set) == 0) {
                // break -> 0x8090502
                break;
            }
            int32_t v6 = UCTransToUni(*v4, current_char_set); // 0x80904a2
            char * v7 = (char *)v6; // 0x80904a7
            result = 1;
            if (v6 >= 33 && v7 <= (char *)126) {
                // break -> 0x8090502
                break;
            }
            if (v7 < (char *)33) {
                goto lab_0x80904ec;
            } else {
                switch (v6) {
                    case 173: {
                        goto lab_0x80904ec;
                    }
                    case 160: {
                        goto lab_0x80904ec;
                    }
                    default: {
                        // 0x80904d4
                        if (v7 >= (char *)0x2000 != v7 < (char *)0x200f) {
                            // break -> 0x8090502
                            break;
                        }
                        goto lab_0x80904ec;
                    }
                }
            }
        }
    }
    // 0x8090502
    return result;
  lab_0x80904ec:
    // 0x80904ec
    v3 = (char *)((int32_t)v4 + 1);
    v2 = *v3;
    result = 0;
    if (v2 == 0) {
        return result;
    }
    goto lab_0x8090438;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x8090508 - 0x809053e
// Line range:    1006 - 1014
char have8bit(char * Title) {
    char v1 = *Title; // 0x809052d
    char v2 = v1; // 0x8090532
    if (v1 == 0) {
        // 0x8090538
        return 0;
    }
    char * v3 = Title; // 0x8090532
    char result = 1; // 0x809051e
    while (v2 >= 0) {
        // 0x8090526
        v3 = (char *)((int32_t)v3 + 1);
        v2 = *v3;
        result = 0;
        if (v2 == 0) {
            // break -> 0x8090538
            break;
        }
        result = 1;
    }
    // 0x8090538
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x809053e - 0x8090794
// Line range:    1034 - 1091
char * title_convert8bit(char * Title) {
    int32_t v1 = __readgsdword(20); // 0x809054a
    char * p0 = NULL; // bp-60, 0x809055b
    char * q = NULL; // bp-64, 0x8090562
    char * comment = NULL; // bp-68, 0x8090569
    int32_t v2 = UCGetLYhndl_byMIME("us-ascii"); // 0x809057f
    int32_t v3 = 0; // 0x8090698
    if (*Title != 0) {
        char * v4 = Title; // 0x809068c
        int32_t v5; // bp-42, 0x809053e
        LYstrncpy((char *)&v5, v4, 1);
        char v6 = v5; // 0x80905aa
        int32_t str; // bp-40, 0x809053e
        int32_t v7; // 0x8090632
        if (v6 < 0) {
            // 0x80905d7
            if (UCTransCharStr((char *)&str, 32, v6, current_char_set, v2, 1) >= 1) {
                // 0x809060f
                HTSACat(&p0, (char *)&str);
            }
            // 0x8090621
            v7 = UCTransToUni((char)v5, current_char_set);
            HTSACat(&q, "&#");
            sprintf((char *)&str, "%ld", v7);
            HTSACat(&q, (char *)&str);
            HTSACat(&q, ";");
        } else {
            // 0x80905ae
            HTSACat(&p0, (char *)&v5);
            HTSACat(&q, (char *)&v5);
        }
        // 0x809068c
        v4 = (char *)((int32_t)v4 + 1);
        while (*v4 != 0) {
            // 0x809058c
            LYstrncpy((char *)&v5, v4, 1);
            v6 = v5;
            if (v6 < 0) {
                // 0x80905d7
                if (UCTransCharStr((char *)&str, 32, v6, current_char_set, v2, 1) >= 1) {
                    // 0x809060f
                    HTSACat(&p0, (char *)&str);
                }
                // 0x8090621
                v7 = UCTransToUni((char)v5, current_char_set);
                HTSACat(&q, "&#");
                sprintf((char *)&str, "%ld", v7);
                HTSACat(&q, (char *)&str);
                HTSACat(&q, ";");
            } else {
                // 0x80905ae
                HTSACat(&p0, (char *)&v5);
                HTSACat(&q, (char *)&v5);
            }
            // 0x809068c
            v4 = (char *)((int32_t)v4 + 1);
        }
        // 0x8090690
        v3 = (int32_t)p0;
    }
    // 0x809069e
    char * p; // bp-52, 0x809053e
    *(int32_t *)&p = v3;
    char * v8 = (char *)v3;
    char v9 = *v8; // 0x80906f5
    char * v10 = v8; // 0x80906fa
    char * v11 = v8; // 0x80906fa
    char * v12 = v8; // 0x80906fa
    char * v13 = v8; // 0x80906fa
    char v14 = v9; // 0x80906fa
    char * v15 = v8; // 0x80906fa
    char * v16; // 0x809053e
    char * v17; // 0x809053e
    char * v18; // 0x809053e
    unsigned char v19; // 0x80906e2
    if (v9 != 0) {
        while (true) {
          lab_0x80906ac:
            // 0x80906ac
            v19 = v14;
            char * v20 = v13; // 0x80906c3
            v18 = v12;
            char * v21 = v11;
            char * v22 = v10;
            v16 = v22;
            v17 = v21;
            v12 = v18;
            v13 = v20;
            if (v19 < 32 || v19 == 62) {
                goto lab_0x80906ee;
            } else {
                // 0x80906c0
                if (v19 != 45 || v20 == p0) {
                    goto lab_0x80906df;
                } else {
                    // 0x80906d2
                    v16 = v22;
                    v17 = v21;
                    v12 = v18;
                    v13 = v20;
                    if (*(char *)((int32_t)v20 - 1) == 45) {
                        goto lab_0x80906ee;
                    } else {
                        goto lab_0x80906df;
                    }
                }
            }
        }
    }
  lab_0x80906fc:
    // 0x80906fc
    *v15 = 0;
    HTSACat(&comment, "<!-- ");
    HTSACat(&comment, p0);
    HTSACat(&comment, " -->");
    HTSACat(&comment, q);
    if (p0 != NULL) {
        // 0x8090753
        free((int32_t *)p0);
        p0 = NULL;
    }
    // 0x8090765
    if (q != NULL) {
        // 0x809076c
        free((int32_t *)q);
        q = NULL;
    }
    int32_t v23 = (int32_t)comment; // 0x809078b
    if (v1 != __readgsdword(20)) {
        // 0x809078d
        __stack_chk_fail();
        v23 = &g391;
    }
    // 0x8090792
    return (char *)v23;
  lab_0x80906ee:
    // 0x80906ee
    v10 = v16;
    v11 = (char *)((int32_t)v17 + 1);
    p = v11;
    v14 = *v11;
    v15 = v10;
    if (v14 == 0) {
        // break -> 0x80906fc
        goto lab_0x80906fc;
    }
    goto lab_0x80906ac;
  lab_0x80906df:
    // 0x80906df
    *v18 = v19;
    char * v24 = (char *)((int32_t)v18 + 1); // 0x80906ea
    v16 = v24;
    v17 = p;
    v12 = v24;
    v13 = v24;
    goto lab_0x80906ee;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYBookmark.c
// Address range: 0x8090794 - 0x809081c
// Line range:    1098 - 1108
void set_default_bookmark_page(char * value) {
    if (value == NULL) {
        // 0x809081a
        return;
    }
    // 0x80907a0
    if (bookmark_page == 0) {
        // 0x80907c1
        HTSACopy((char **)&bookmark_page, value);
        goto lab_0x80907d4;
    } else {
        // 0x80907a9
        if (strcmp((char *)bookmark_page, value) == 0) {
            goto lab_0x80907d4;
        } else {
            // 0x80907c1
            HTSACopy((char **)&bookmark_page, value);
            goto lab_0x80907d4;
        }
    }
  lab_0x80907d4:
    // 0x80907d4
    HTSACopy((char **)&BookmarkPage, (char *)bookmark_page);
    HTSACopy((char **)&MBM_A_subbookmark, (char *)bookmark_page);
    char * v1 = gettext("Default Bookmark File"); // 0x8090805
    HTSACopy((char **)&MBM_A_subdescript, v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80908f0 - 0x809092c
// Line range:    194 - 203
int32_t * FindTempfileByName(char * name) {
    int32_t v1 = (int32_t)ly_temp; // 0x80908f6
    if (ly_temp == NULL) {
        // 0x8090927
        return (int32_t *)v1;
    }
    int32_t v2 = v1; // 0x8090925
    int32_t v3 = v2; // 0x8090917
    while (strcmp((char *)*(int32_t *)(v2 + 4), name) != 0) {
        // 0x8090919
        v2 = *(int32_t *)v2;
        v3 = v2;
        if (v2 == 0) {
            // break -> 0x8090927
            break;
        }
        v3 = v2;
    }
    // 0x8090927
    return (int32_t *)v3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809092c - 0x809095a
// Line range:    206 - 215
int32_t * FindTempfileByFP(struct _IO_FILE * fp) {
    int32_t v1 = (int32_t)ly_temp; // 0x8090932
    if (ly_temp == NULL) {
        // 0x8090955
        return (int32_t *)v1;
    }
    int32_t v2 = v1; // 0x809094a
    while (*(int32_t *)(v2 + 12) != (int32_t)fp) {
        // 0x8090947
        v2 = *(int32_t *)v2;
        if (v2 == 0) {
            // break -> 0x8090955
            break;
        }
    }
    // 0x8090955
    return (int32_t *)v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809095a - 0x8090992
// Line range:    221 - 225
char * LYGetEnv(char * name) {
    char * env_val = getenv(name); // 0x8090966
    if (env_val != NULL) {
        // 0x8090974
        if (*env_val != 0) {
            // 0x809098d
            return env_val;
        }
    }
    // 0x809098d
    return NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8090992 - 0x8090a79
// Line range:    264 - 292
int32_t utf8_length(char utf_flag, char * data) {
    if (utf_flag == 0) {
        // 0x8090a74
        return 0;
    }
    char v1 = *data; // 0x80909b2
    if (v1 >= 0) {
        // 0x8090a74
        return 0;
    }
    // 0x80909bd
    uint32_t v2; // 0x8090992
    uint32_t len; // 0x8090a63
    if ((v1 & -32) == -64) {
        // 0x8090a5a
        v2 = 1;
        len = strlen((char *)((int32_t)data + 1));
        return len >= v2 ? v2 : 0;
    }
    // 0x80909db
    if ((v1 & -16) == -32) {
        // 0x8090a5a
        v2 = 2;
        len = strlen((char *)((int32_t)data + 1));
        return len >= v2 ? v2 : 0;
    }
    // 0x80909f9
    if ((v1 & -8) == -16) {
        // 0x8090a5a
        v2 = 3;
        len = strlen((char *)((int32_t)data + 1));
        return len >= v2 ? v2 : 0;
    }
    int32_t v3 = 4; // 0x8090a2a
    if ((v1 & -4) != -8) {
        // 0x8090a35
        v3 = (v1 & -2) != -4 ? 0 : 5;
    }
    // 0x8090a5a
    v2 = v3;
    len = strlen((char *)((int32_t)data + 1));
    return len >= v2 ? v2 : 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8090a79 - 0x8090af1
// Line range:    298 - 305
void LYFreeHilites(uint32_t first, uint32_t last) {
    // 0x8090a79
    if (first >= last) {
        // 0x8090aef
        return;
    }
    int32_t v1 = first; // 0x8090aed
    LYSetHilite(v1, NULL);
    int32_t * v2 = (int32_t *)(68 * v1 + (int32_t)&links); // 0x8090aa7
    int32_t v3 = *v2; // 0x8090aa7
    if (v3 != 0) {
        // 0x8090ab1
        free((int32_t *)v3);
        *v2 = 0;
    }
    // 0x8090ae3
    v1++;
    while (v1 != last) {
        // 0x8090a87
        LYSetHilite(v1, NULL);
        v2 = (int32_t *)(68 * v1 + (int32_t)&links);
        v3 = *v2;
        if (v3 != 0) {
            // 0x8090ab1
            free((int32_t *)v3);
            *v2 = 0;
        }
        // 0x8090ae3
        v1++;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8090af1 - 0x8090b78
// Line range:    315 - 319
void LYSetHilite(int32_t cur, char * text) {
    int32_t v1 = 68 * cur; // 0x8090b05
    *(int32_t *)(v1 + (int32_t)&g352) = (int32_t)text;
    *(int16_t *)(v1 + (int32_t)&g353) = (int16_t)(text != NULL);
    int32_t * v2 = (int32_t *)(v1 + (int32_t)&g351); // 0x8090b3a
    int32_t v3 = *v2; // 0x8090b3a
    if (v3 != 0) {
        // 0x8090b44
        free((int32_t *)v3);
        *v2 = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8090b78 - 0x8090c27
// Line range:    327 - 341
void LYAddHilite(int32_t cur, char * text, int32_t x) {
    int32_t v1 = 68 * cur; // 0x8090b89
    int32_t * v2 = (int32_t *)(v1 + (int32_t)&links + 48); // 0x8090b99
    int32_t v3 = *v2; // 0x8090b99
    int16_t * v4 = (int16_t *)(v1 + (int32_t)&links + 60); // 0x8090ba1
    int16_t v5 = *v4;
    int16_t v6 = v5 + 1; // 0x8090bb3
    *v4 = v6;
    int32_t size = 8 * (int32_t)v6;
    int32_t * mem; // 0x8090b78
    if (v3 == 0) {
        // 0x8090bea
        mem = malloc(size);
    } else {
        // 0x8090bd0
        mem = realloc((int32_t *)v3, size);
    }
    int32_t v7 = (int32_t)mem; // 0x8090bfe
    *v2 = v7;
    int32_t v8 = 8 * (int32_t)v5 - 8 + v7; // 0x8090c0b
    *(int32_t *)v8 = (int32_t)text;
    *(int16_t *)(v8 + 4) = (int16_t)x;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8090c27 - 0x8090c9d
// Line range:    348 - 358
char * LYGetHiliteStr(int32_t cur, uint32_t count) {
    int32_t v1 = 68 * cur; // 0x8090c38
    if ((int32_t)*(int16_t *)(v1 + (int32_t)&g353) <= count) {
        // 0x8090c98
        return NULL;
    }
    char * result; // 0x8090c27
    if (count < 1) {
        int32_t v2 = *(int32_t *)(v1 + (int32_t)&g352); // 0x8090c8f
        result = (char *)v2;
    } else {
        int32_t v3 = *(int32_t *)(v1 + (int32_t)&g351); // 0x8090c63
        result = (char *)*(int32_t *)(8 * count - 8 + v3);
    }
    // 0x8090c98
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8090c9d - 0x8090d16
// Line range:    365 - 375
int32_t LYGetHilitePos(int32_t cur, uint32_t count) {
    int32_t v1 = 68 * cur; // 0x8090cae
    if ((int32_t)*(int16_t *)(v1 + (int32_t)&g353) <= count) {
        // 0x8090d11
        return -1;
    }
    int32_t result; // 0x8090c9d
    if (count < 1) {
        // 0x8090cfb
        result = *(int32_t *)(v1 + (int32_t)&g345);
    } else {
        int32_t v2 = *(int32_t *)(v1 + (int32_t)&g351); // 0x8090cd9
        result = (int32_t)*(int16_t *)(8 * count - 4 + v2);
    }
    // 0x8090d11
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8090d16 - 0x80928f2
// Line range:    402 - 962
char show_whereis_targets(int32_t flag, int32_t cur, int32_t count, char * target, char TargetEmphasisON, char utf_flag) {
    char buffer2[1024]; // bp-1040, 0x8090d16
    char buffer[1024]; // bp-1044, 0x8090d16
    char v1[1024]; // 0x80919fc
    char v2[1024]; // 0x8091a7f
    char v3[1024]; // 0x8092446
    char v4[1024]; // 0x809287a
    char v5[1024]; // 0x8091004
    char v6[1024]; // 0x80910d3
    char v7[1024]; // 0x8091107
    int32_t v8 = __readgsdword(20); // 0x8090d3b
    buffer2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char * Data = NULL; // bp-1048, 0x8090d50
    char v9 = 0; // bp-1118, 0x8090d68
    char str2 = 0; // bp-1119, 0x8090d75
    char v10 = TargetEmphasisON; // 0x8090d82
    int32_t v11; // 0x8090d16
    int32_t v12; // 0x8090d16
    char * cp; // bp-1052, 0x8090d16
    int32_t HitOffset; // bp-1060, 0x8090d16
    int32_t LenNeeded; // bp-1064, 0x8090d16
    int32_t v13; // 0x8090d16
    int32_t str; // bp-1036, 0x8090d16
    char * str3; // bp-1088, 0x8090d16
    char v14; // 0x8090d16
    char v15; // 0x8090d16
    char v16; // 0x8090d16
    char * theData; // bp-1056, 0x8090d16
    int32_t v17; // 0x8090d16
    int32_t len; // 0x8090e81
    int32_t v18; // 0x8090eb5
    int32_t v19; // 0x8090d16
    int32_t len2; // 0x8090fbc
    int32_t v20; // 0x8090e9f
    if (target == NULL) {
        goto lab_0x80928d1;
    } else {
        // 0x8090d88
        v15 = TargetEmphasisON;
        if (*target == 0) {
            goto lab_0x80928af_7;
        } else {
            int32_t v21 = 68 * cur; // 0x8090da4
            v15 = TargetEmphasisON;
            if ((*(int32_t *)(v21 + (int32_t)&g347) & 2) == 0) {
                goto lab_0x80928af_7;
            } else {
                // 0x8090db7
                v15 = TargetEmphasisON;
                if (LYGetHiliteStr(cur, count) == NULL) {
                    goto lab_0x80928af_7;
                } else {
                    char v22 = *LYGetHiliteStr(cur, count); // 0x8090de3
                    v15 = TargetEmphasisON;
                    if (v22 == 0) {
                        goto lab_0x80928af_7;
                    } else {
                        int32_t * v23 = (int32_t *)(v21 + (int32_t)&g346); // 0x8090dfb
                        v15 = TargetEmphasisON;
                        if (*v23 + count < display_lines) {
                            int32_t v24 = *(int32_t *)(v21 + (int32_t)&g350); // 0x8090e27
                            char v25 = HText_getFirstTargetInLine(HTMainText, v24 + count, utf_flag, &HitOffset, &LenNeeded, &Data, target); // 0x8090e6b
                            v15 = TargetEmphasisON;
                            if (v25 == 0) {
                                goto lab_0x80928af_7;
                            } else {
                                // 0x8090e78
                                len = strlen(target);
                                v18 = LYGetHilitePos(cur, count);
                                int32_t v26 = LYGetHilitePos(cur, count); // 0x8090efd
                                char * v27 = LYGetHiliteStr(cur, count); // 0x8090f19
                                char * v28 = (char *)&g25; // 0x8090f20
                                if (v27 != NULL) {
                                    // 0x8090f22
                                    v28 = LYGetHiliteStr(cur, count);
                                }
                                // 0x8090f46
                                LYmbcsstrncpy((char *)&str, v28, 1023, LYcols - v26 + (int32_t)(LYShowScrollbar != 0), utf_flag);
                                len2 = strlen((char *)&str);
                                if (utf_flag == 0 != (HTCJK == 0)) {
                                    // 0x8090fa0
                                    len2 = LYmbcsstrlen((char *)&str, utf_flag, 1);
                                }
                                // 0x8090fd5
                                v19 = len2 + v18;
                                int32_t v29 = HitOffset; // 0x8090ff0
                                v15 = TargetEmphasisON;
                                if (v19 > v29) {
                                    // 0x8090ffe
                                    v5[0] = (int32_t)Data;
                                    buffer2 = v5;
                                    v11 = v29;
                                    if (v29 < v18) {
                                        int32_t v30 = LenNeeded + v29;
                                        v11 = v29;
                                        while (v30 <= v18) {
                                            char * v31 = (char *)(*(int32_t *)&buffer2 + len); // 0x809101b
                                            str3 = v31;
                                            char * v32; // 0x8090d16
                                            if (case_sensitive == 0) {
                                                char * v33 = LYno_attr_mbcs_case_strstr(v31, target, utf_flag, 1, (int32_t *)&cp, (int32_t *)&theData); // 0x80910c2
                                                v32 = v33;
                                            } else {
                                                char * v34 = LYno_attr_mbcs_strstr(v31, target, utf_flag, 1, (int32_t *)&cp, (int32_t *)&theData); // 0x809107b
                                                v32 = v34;
                                            }
                                            // 0x80910cd
                                            v6[0] = (int32_t)v32;
                                            buffer = v6;
                                            int32_t v35 = *(int32_t *)&buffer; // 0x80910d9
                                            v15 = TargetEmphasisON;
                                            if (v35 == 0) {
                                                goto lab_0x80928af_7;
                                            }
                                            // 0x80910e6
                                            v15 = TargetEmphasisON;
                                            if (v30 + (int32_t)theData >= LYcols) {
                                                goto lab_0x80928af_7;
                                            }
                                            // 0x8091101
                                            v7[0] = v35;
                                            buffer2 = v7;
                                            int32_t v36 = v30 + (int32_t)cp; // 0x8091113
                                            HitOffset = v36;
                                            v11 = v36;
                                            if (v36 >= v18) {
                                                // break -> 0x8091147
                                                break;
                                            }
                                            v30 = LenNeeded + v36;
                                            v11 = v36;
                                        }
                                    }
                                    // 0x8091147
                                    v20 = *v23 + count;
                                    str3 = (char *)&str;
                                    v12 = v11;
                                    v14 = TargetEmphasisON;
                                    if (v11 < v18) {
                                        // 0x8091171
                                        v12 = v11;
                                        v14 = TargetEmphasisON;
                                        if (LenNeeded + v11 > v18) {
                                            // 0x809118b
                                            LYmove(v20, v18);
                                            str2 = *str3;
                                            int32_t v37 = utf8_length(utf_flag, str3); // 0x80911fe
                                            if (v37 == 0) {
                                                // 0x80912da
                                                if (HTCJK == 0) {
                                                    goto lab_0x809137b;
                                                } else {
                                                    // 0x80912e7
                                                    if (str2 >= 0) {
                                                        goto lab_0x809137b;
                                                    } else {
                                                        // 0x80912f6
                                                        v9 = *(char *)((int32_t)str3 + 1);
                                                        char v38; // 0x8090d16
                                                        if (flag == 1) {
                                                            // 0x8091350
                                                            LYmove(v20, v18 + 1);
                                                            v38 = TargetEmphasisON;
                                                        } else {
                                                            // 0x8091318
                                                            LYstartTargetEmphasis();
                                                            int32_t len3 = strlen(&str2); // 0x809132d
                                                            LYwaddnstr(LYwin, &str2, len3);
                                                            v38 = 1;
                                                        }
                                                        // 0x809136b
                                                        v9 = 0;
                                                        v16 = v38;
                                                        v13 = 1;
                                                        v17 = 2;
                                                        goto lab_0x80913db;
                                                    }
                                                }
                                            } else {
                                                // 0x8091216
                                                LYstrncpy(&v9, (char *)((int32_t)str3 + 1), v37);
                                                char v39; // 0x8090d16
                                                if (flag == 1) {
                                                    // 0x8091294
                                                    LYmove(v20, v18 + 1);
                                                    v39 = TargetEmphasisON;
                                                } else {
                                                    // 0x809125c
                                                    LYstartTargetEmphasis();
                                                    int32_t len4 = strlen(&str2); // 0x8091271
                                                    LYwaddnstr(LYwin, &str2, len4);
                                                    v39 = 1;
                                                }
                                                // 0x80912af
                                                v9 = 0;
                                                v16 = v39;
                                                v13 = v37;
                                                v17 = v37 + 1;
                                                goto lab_0x80913db;
                                            }
                                        } else {
                                            goto lab_0x8091aaf;
                                        }
                                    } else {
                                        goto lab_0x8091aaf;
                                    }
                                } else {
                                    goto lab_0x80928af_7;
                                }
                            }
                        } else {
                            goto lab_0x80928af_7;
                        }
                    }
                }
            }
        }
    }
  lab_0x80928af_7:
    // 0x80928af
    v10 = v15;
    if (Data != NULL) {
        // 0x80928b9
        free((int32_t *)Data);
        Data = NULL;
        v10 = v15;
    }
    goto lab_0x80928d1;
  lab_0x80920f9:;
    int32_t v108; // 0x8090d16
    char v109; // 0x8090d16
    if (flag != 1) {
        goto lab_0x80921a7;
    } else {
        char v110 = *(char *)(v108 + 1 + (int32_t)str3); // 0x8092112
        if (v110 != 0) {
            goto lab_0x80921a7;
        } else {
            // 0x809211d
            LYstopTargetEmphasis();
            LYmove(v20, LYwin == NULL ? 0 : (int32_t)*(int16_t *)&g255 + 1);
            v109 = 0;
            goto lab_0x80921d1;
        }
    }
  lab_0x8091f81:;
    int32_t len10 = strlen(&str2); // 0x8091f8a
    LYwaddnstr(LYwin, &str2, len10);
    char v111; // 0x8090d16
    char v112 = v111; // 0x8091fa6
    goto lab_0x8091fab;
  lab_0x80921a7:;
    int32_t len18 = strlen(&str2); // 0x80921b0
    LYwaddnstr(LYwin, &str2, len18);
    v109 = v111;
    goto lab_0x80921d1;
  lab_0x8091fab:
    // 0x8091fab
    v9 = 0;
    char v113 = v112; // 0x8091fd1
    int32_t v114; // 0x8091ec7
    int32_t v115 = v114; // 0x8091fd1
    int32_t v116; // 0x8090d16
    int32_t v117; // 0x8091e7b
    int32_t v118 = v116 + 1 + v117; // 0x8091fd1
    goto lab_0x80921d8;
  lab_0x80921d1:
    // 0x80921d1
    v113 = v109;
    v115 = v108;
    v118 = v116 + 1;
    goto lab_0x80921d8;
  lab_0x80920bc:;
    int32_t len17 = strlen(&str2); // 0x80920c5
    LYwaddnstr(LYwin, &str2, len17);
    char v126 = v111; // 0x80920e1
    goto lab_0x80920e6;
  lab_0x80921d8:;
    int32_t v119 = v118; // 0x80921eb
    int32_t v120 = v115 + 1; // 0x80921eb
    char v121 = v113; // 0x80921eb
    if (v118 >= len) {
        // break -> 0x8092211
        goto lab_0x8092211;
    }
    goto lab_0x80921ed;
  lab_0x80920e6:
    // 0x80920e6
    v9 = 0;
    v113 = v126;
    int32_t v124; // 0x8091ff2
    v115 = v124;
    v118 = v116 + 2;
    goto lab_0x80921d8;
  lab_0x8091da1:;
    int32_t v49; // 0x8091b66
    if (flag != 1) {
        goto lab_0x8091e25;
    } else {
        if (v49 > v18) {
            char * v127 = str3; // 0x8091dbe
            char v128 = *(char *)((int32_t)v127 + 1); // 0x8091dc4
            if (v128 == 0) {
                goto lab_0x8091e03;
            } else {
                goto lab_0x8091e25;
            }
        } else {
            goto lab_0x8091e03;
        }
    }
  lab_0x8091c5b:
    // 0x8091c5b
    LYstartTargetEmphasis();
    int32_t len11 = strlen(&str2); // 0x8091c70
    LYwaddnstr(LYwin, &str2, len11);
    char v54 = 1; // 0x8091c91
    goto lab_0x8091cae;
  lab_0x8091e25:
    // 0x8091e25
    LYstartTargetEmphasis();
    int32_t len16 = strlen(&str2); // 0x8091de0
    LYwaddnstr(LYwin, &str2, len16);
    int32_t v132 = 1; // 0x8090d16
    int32_t v133 = 1; // 0x8090d16
    char v134 = 1; // 0x8090d16
    goto lab_0x80921df;
  lab_0x8091cae:
    // 0x8091cae
    v9 = 0;
    char v129 = v54; // 0x8091cd4
    int32_t v50; // 0x8091bd9
    int32_t v130 = v50; // 0x8091cd4
    int32_t v131 = v50 + 1; // 0x8091cd4
    goto lab_0x8091e25_2;
  lab_0x80921df:
    // 0x80921df
    v119 = v133;
    v120 = v132;
    v121 = v134;
    if (v133 < len) {
        while (true) {
          lab_0x80921ed:
            // 0x80921ed
            v111 = v121;
            v108 = v120;
            char * v122 = (char *)(v108 + (int32_t)str3);
            char v123 = *v122; // 0x80921f9
            str2 = v123;
            if (v123 == 0) {
                // break -> 0x8092211
                break;
            }
            // 0x8091e61
            v116 = v119;
            v117 = utf8_length(utf_flag, v122);
            if (v117 == 0) {
                // 0x8091fd6
                if (HTCJK == 0) {
                    goto lab_0x80920f9;
                } else {
                    // 0x8091fe3
                    if (str2 >= 0) {
                        goto lab_0x80920f9;
                    } else {
                        // 0x8091ff2
                        v124 = v108 + 1;
                        int32_t v125 = (int32_t)str3;
                        v9 = *(char *)(v124 + v125);
                        if (flag != 1) {
                            goto lab_0x80920bc;
                        } else {
                            // 0x8092018
                            if (*(char *)(v108 + 2 + v125) != 0) {
                                goto lab_0x80920bc;
                            } else {
                                // 0x8092032
                                LYstopTargetEmphasis();
                                LYmove(v20, LYwin == NULL ? 0 : (int32_t)*(int16_t *)&g255 + 1);
                                v126 = 0;
                                goto lab_0x80920e6;
                            }
                        }
                    }
                }
            } else {
                // 0x8091e93
                LYstrncpy(&v9, (char *)(v108 + 1 + (int32_t)str3), v117);
                v114 = v117 + v108;
                if (flag != 1) {
                    goto lab_0x8091f81;
                } else {
                    // 0x8091edd
                    if (*(char *)(v114 + 1 + (int32_t)str3) != 0) {
                        goto lab_0x8091f81;
                    } else {
                        // 0x8091ef7
                        LYstopTargetEmphasis();
                        LYmove(v20, LYwin == NULL ? 0 : (int32_t)*(int16_t *)&g255 + 1);
                        v112 = 0;
                        goto lab_0x8091fab;
                    }
                }
            }
        }
    }
  lab_0x8092211:
    // 0x8092211
    if (v134 != 0) {
        // 0x809221a
        LYstopTargetEmphasis();
    }
    uint32_t v140 = LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
    v15 = 0;
    uint32_t v42; // 0x8090d16
    if (v42 <= v140) {
        // break -> 0x80928af
        goto lab_0x80928af_7;
    }
    int32_t v141 = v140 - HitOffset;
    int32_t v142 = *(int32_t *)&buffer2;
    char * v143; // 0x8090d16
    if (case_sensitive == 0) {
        int32_t v144; // 0x8090d16
        if (utf_flag == 0) {
            // 0x80923d4
            v144 = v142 + v141;
        } else {
            // 0x80923a1
            v144 = (int32_t)LYmbcs_skip_glyphs((char *)v142, v141, utf_flag);
        }
        char * v145 = LYno_attr_mbcs_case_strstr((char *)v144, target, utf_flag, 1, (int32_t *)&cp, (int32_t *)&theData); // 0x8092435
        v143 = v145;
    } else {
        int32_t v146; // 0x8090d16
        if (utf_flag == 0) {
            // 0x809231a
            v146 = v142 + v141;
        } else {
            // 0x80922e7
            v146 = (int32_t)LYmbcs_skip_glyphs((char *)v142, v141, utf_flag);
        }
        char * v147 = LYno_attr_mbcs_strstr((char *)v146, target, utf_flag, 1, (int32_t *)&cp, (int32_t *)&theData); // 0x809237b
        v143 = v147;
    }
    // 0x8092440
    v3[0] = (int32_t)v143;
    buffer = v3;
    int32_t v148 = *(int32_t *)&buffer; // 0x809244c
    v15 = 0;
    if (v148 == 0) {
        // break -> 0x80928af
        goto lab_0x80928af_7;
    }
    // 0x8092459
    v15 = 0;
    if (v140 + (int32_t)theData >= LYcols) {
        // break -> 0x80928af
        goto lab_0x80928af_7;
    }
    int32_t v86 = v140 + (int32_t)cp;
    v15 = 0;
    if (v86 >= v42) {
        // break -> 0x80928af
        goto lab_0x80928af_7;
    }
    // 0x80924c3
    if (LenNeeded + v86 >= v19) {
        int32_t v149 = v86 - v18;
        if (utf_flag == 0) {
            // 0x8092554
            *(int32_t *)&str3 = v149 + v142;
            goto lab_0x809256e;
        } else {
            char * v150 = LYmbcs_skip_glyphs((char *)v142, v149, utf_flag); // 0x809252b
            *(int32_t *)&str3 = (int32_t)v150;
            LYrefresh();
            goto lab_0x809256e;
        }
    }
    // 0x8092874
    v4[0] = v148;
    buffer2 = v4;
    HitOffset = v86;
    str3 = (char *)&str;
    int32_t v151 = v86 - v18; // 0x8091ab7
    int32_t v43 = v86; // 0x8091af2
    int32_t v44 = v151; // 0x8091af2
    char v45 = 0; // 0x8091af2
    v15 = 0;
    int32_t v41; // 0x8090d16
    if (v151 > v41) {
        // break -> 0x80928af
        goto lab_0x80928af_7;
    }
    goto lab_0x8091af8;
  lab_0x8091e03:
    // 0x8091e03
    LYmove(v20, v49 + 1);
    char v46; // 0x8090d16
    v129 = v46;
    v130 = 0;
    v131 = 1;
    goto lab_0x8091e25_2;
  lab_0x8091d3b:
    // 0x8091d3b
    LYstartTargetEmphasis();
    int32_t len12 = strlen(&str2); // 0x8091d50
    LYwaddnstr(LYwin, &str2, len12);
    char v53 = 1; // 0x8091d71
    goto lab_0x8091d8e;
  lab_0x8091e25_2:
    // 0x8091e25
    v132 = v130 + 1;
    v133 = v131;
    v134 = v129;
    if (v129 == 0) {
        char * v135 = str3; // 0x8091e3f
        int32_t v136; // 0x8091e25
        char v137 = *(char *)(v136 + (int32_t)v135); // 0x8091e45
        v132 = v136;
        int32_t v138; // 0x8090d16
        v133 = v138;
        char v139; // 0x8090d16
        v134 = v139;
        if (v137 != 0) {
            // 0x8091e50
            LYstartTargetEmphasis();
            v132 = v136;
            v133 = v138;
            v134 = 1;
        }
    }
    goto lab_0x80921df;
  lab_0x8091d8e:
    // 0x8091d8e
    v9 = 0;
    v129 = v53;
    v130 = 1;
    v131 = 2;
    goto lab_0x8091e25_2;
  lab_0x80916af:;
    int32_t v65; // 0x8090d16
    char v152; // 0x8090d16
    if (flag != 1) {
        goto lab_0x809175d;
    } else {
        char v153 = *(char *)(v65 + 1 + (int32_t)str3); // 0x80916c8
        if (v153 != 0) {
            goto lab_0x809175d;
        } else {
            // 0x80916d3
            LYstopTargetEmphasis();
            LYmove(v20, LYwin == NULL ? 0 : (int32_t)*(int16_t *)&g255 + 1);
            v152 = 0;
            goto lab_0x8091787;
        }
    }
  lab_0x8091537:;
    int32_t len13 = strlen(&str2); // 0x8091540
    LYwaddnstr(LYwin, &str2, len13);
    char v64; // 0x8090d16
    char v74 = v64; // 0x809155c
    goto lab_0x8091561;
  lab_0x809175d:;
    int32_t len15 = strlen(&str2); // 0x8091766
    LYwaddnstr(LYwin, &str2, len15);
    v152 = v64;
    goto lab_0x8091787;
  lab_0x8091561:
    // 0x8091561
    v9 = 0;
    char v154 = v74; // 0x8091587
    int32_t v73; // 0x809147d
    int32_t v155 = v73; // 0x8091587
    int32_t v68; // 0x8090d16
    int32_t v69; // 0x8091431
    int32_t v156 = v68 + 1 + v69; // 0x8091587
    goto lab_0x809178e;
  lab_0x8091787:
    // 0x8091787
    v154 = v152;
    v155 = v65;
    v156 = v68 + 1;
    goto lab_0x809178e;
  lab_0x8091672:;
    int32_t len14 = strlen(&str2); // 0x809167b
    LYwaddnstr(LYwin, &str2, len14);
    char v72 = v64; // 0x8091697
    goto lab_0x809169c;
  lab_0x809178e:;
    int32_t v61 = v156; // 0x80917a1
    int32_t v62 = v155 + 1; // 0x80917a1
    char v63 = v154; // 0x80917a1
    int32_t v59; // 0x80911ab
    if (v156 >= v59) {
        // break -> 0x80917c7
        goto lab_0x80917c7;
    }
    goto lab_0x80917a3;
  lab_0x809169c:
    // 0x809169c
    v9 = 0;
    v154 = v72;
    int32_t v70; // 0x80915a8
    v155 = v70;
    v156 = v68 + 2;
    goto lab_0x809178e;
  lab_0x80928d1:;
    char result = v10; // 0x80928e2
    if (v8 != __readgsdword(20)) {
        // 0x80928e4
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80928e9
    return result;
  lab_0x8091aaf:;
    int32_t v40 = v12 - v18; // 0x8091ab7
    v41 = len2 + (int32_t)(flag == 1);
    v15 = v14;
    if (v40 <= v41) {
        // 0x8091af8
        v42 = v41 + v18;
        v43 = v12;
        v44 = v40;
        v45 = v14;
        while (true) {
          lab_0x8091af8:
            // 0x8091af8
            v46 = v45;
            int32_t v47 = v44;
            int32_t v48; // 0x8090d16
            if (utf_flag == 0) {
                // 0x8091b4c
                str3 = (char *)(v47 + (int32_t)&str);
                v48 = v43;
            } else {
                // 0x8091b61
                str3 = LYmbcs_skip_glyphs((char *)&str, v47, utf_flag);
                LYrefresh();
                v48 = HitOffset;
            }
            // 0x8091b66
            v49 = v48;
            LYmove(v20, v49);
            str2 = *str3;
            v50 = utf8_length(utf_flag, str3);
            if (v50 == 0) {
                // 0x8091cd9
                if (HTCJK == 0) {
                    goto lab_0x8091da1;
                } else {
                    // 0x8091ce6
                    if (str2 >= 0) {
                        goto lab_0x8091da1;
                    } else {
                        // 0x8091cf5
                        v9 = *(char *)((int32_t)str3 + 1);
                        if (flag != 1) {
                            goto lab_0x8091d3b;
                        } else {
                            if (v49 > v18) {
                                // 0x8091d25
                                int32_t v51; // 0x8090d16
                                char v52 = *(char *)(v51 + 2); // 0x8091d34
                                if (v52 == 0) {
                                    // 0x8091d73
                                    LYmove(v20, v49 + 2);
                                    v53 = v46;
                                    goto lab_0x8091d8e;
                                } else {
                                    goto lab_0x8091d3b;
                                }
                            } else {
                                // 0x8091d73
                                LYmove(v20, v49 + 2);
                                v53 = v46;
                                goto lab_0x8091d8e;
                            }
                        }
                    }
                }
            } else {
                // 0x8091bf1
                LYstrncpy(&v9, (char *)((int32_t)str3 + 1), v50);
                if (flag != 1) {
                    goto lab_0x8091c5b;
                } else {
                    if (v49 > v18) {
                        // 0x8091c45
                        if (*(char *)(v50 + 1 + (int32_t)str3) == 0) {
                            // 0x8091c93
                            LYmove(v20, v49 + 1);
                            v54 = v46;
                            goto lab_0x8091cae;
                        } else {
                            goto lab_0x8091c5b;
                        }
                    } else {
                        // 0x8091c93
                        LYmove(v20, v49 + 1);
                        v54 = v46;
                        goto lab_0x8091cae;
                    }
                }
            }
        }
    }
    goto lab_0x80928af_7;
  lab_0x809137b:;
    int32_t v55; // 0x8090d16
    char v56; // 0x8090d16
    int32_t v57; // 0x8090d16
    if (flag == 1) {
        // 0x80913b9
        LYmove(v20, v18 + 1);
        v16 = TargetEmphasisON;
        v13 = 0;
        v17 = 1;
        goto lab_0x80913db;
    } else {
        // 0x80913db
        LYstartTargetEmphasis();
        int32_t len5 = strlen(&str2); // 0x8091396
        LYwaddnstr(LYwin, &str2, len5);
        v55 = 1;
        v57 = 1;
        v56 = 1;
        goto lab_0x8091795;
    }
  lab_0x80913db:;
    int32_t v58 = v13 + 1; // 0x80913db
    v55 = v58;
    v57 = v17;
    v56 = v16;
    if (v16 == 0) {
        // 0x80913ef
        v55 = v58;
        v57 = v17;
        v56 = v16;
        if (*(char *)(v58 + (int32_t)str3) != 0) {
            // 0x8091406
            LYstartTargetEmphasis();
            v55 = v58;
            v57 = v17;
            v56 = 1;
        }
    }
    goto lab_0x8091795;
  lab_0x8091795:
    // 0x8091795
    v59 = v11 + len - v18;
    char v60 = v56; // 0x80917a1
    if (v57 < v59) {
        // 0x80917a3
        v61 = v57;
        v62 = v55;
        v63 = v56;
        while (true) {
          lab_0x80917a3:
            // 0x80917a3
            v64 = v63;
            v65 = v62;
            char * v66 = (char *)(v65 + (int32_t)str3);
            char v67 = *v66; // 0x80917af
            str2 = v67;
            v60 = v64;
            if (v67 == 0) {
                // break -> 0x80917c7
                break;
            }
            // 0x8091417
            v68 = v61;
            v69 = utf8_length(utf_flag, v66);
            if (v69 == 0) {
                // 0x809158c
                if (HTCJK == 0) {
                    goto lab_0x80916af;
                } else {
                    // 0x8091599
                    if (str2 >= 0) {
                        goto lab_0x80916af;
                    } else {
                        // 0x80915a8
                        v70 = v65 + 1;
                        int32_t v71 = (int32_t)str3;
                        v9 = *(char *)(v70 + v71);
                        if (flag != 1) {
                            goto lab_0x8091672;
                        } else {
                            // 0x80915ce
                            if (*(char *)(v65 + 2 + v71) != 0) {
                                goto lab_0x8091672;
                            } else {
                                // 0x80915e8
                                LYstopTargetEmphasis();
                                LYmove(v20, LYwin == NULL ? 0 : (int32_t)*(int16_t *)&g255 + 1);
                                v72 = 0;
                                goto lab_0x809169c;
                            }
                        }
                    }
                }
            } else {
                // 0x8091449
                LYstrncpy(&v9, (char *)(v65 + 1 + (int32_t)str3), v69);
                v73 = v69 + v65;
                if (flag != 1) {
                    goto lab_0x8091537;
                } else {
                    // 0x8091493
                    if (*(char *)(v73 + 1 + (int32_t)str3) != 0) {
                        goto lab_0x8091537;
                    } else {
                        // 0x80914ad
                        LYstopTargetEmphasis();
                        LYmove(v20, LYwin == NULL ? 0 : (int32_t)*(int16_t *)&g255 + 1);
                        v74 = 0;
                        goto lab_0x8091561;
                    }
                }
            }
        }
    }
  lab_0x80917c7:
    // 0x80917c7
    if (v60 != 0) {
        // 0x80917d0
        LYstopTargetEmphasis();
    }
    int32_t v75 = LYwin == NULL ? -1 : (int32_t)*(int16_t *)&g255;
    int32_t v76 = v19 + (int32_t)(flag == 1); // 0x8091866
    v15 = 0;
    if (v76 > v75) {
        int32_t v77 = v75 - HitOffset;
        int32_t v78 = *(int32_t *)&buffer2;
        char * v79; // 0x8090d16
        if (case_sensitive == 0) {
            int32_t v80; // 0x8090d16
            if (utf_flag == 0) {
                // 0x809198a
                v80 = v78 + v77;
            } else {
                // 0x8091957
                v80 = (int32_t)LYmbcs_skip_glyphs((char *)v78, v77, utf_flag);
            }
            char * v81 = LYno_attr_mbcs_case_strstr((char *)v80, target, utf_flag, 1, (int32_t *)&cp, (int32_t *)&theData); // 0x80919eb
            v79 = v81;
        } else {
            int32_t v82; // 0x8090d16
            if (utf_flag == 0) {
                // 0x80918d0
                v82 = v78 + v77;
            } else {
                // 0x809189d
                v82 = (int32_t)LYmbcs_skip_glyphs((char *)v78, v77, utf_flag);
            }
            char * v83 = LYno_attr_mbcs_strstr((char *)v82, target, utf_flag, 1, (int32_t *)&cp, (int32_t *)&theData); // 0x8091931
            v79 = v83;
        }
        // 0x80919f6
        v1[0] = (int32_t)v79;
        buffer = v1;
        int32_t v84 = *(int32_t *)&buffer; // 0x8091a02
        v15 = 0;
        if (v84 == 0) {
            goto lab_0x80928af_7;
        } else {
            // 0x8091a0f
            v15 = 0;
            if (v75 + (int32_t)theData < LYcols) {
                int32_t v85 = v75 + (int32_t)cp;
                v15 = 0;
                if (v85 < v76) {
                    // 0x8091a79
                    v2[0] = v84;
                    buffer2 = v2;
                    HitOffset = v85;
                    str3 = (char *)&str;
                    v12 = v85;
                    v14 = 0;
                    goto lab_0x8091aaf;
                } else {
                    goto lab_0x80928af_7;
                }
            } else {
                goto lab_0x80928af_7;
            }
        }
    } else {
        goto lab_0x80928af_7;
    }
  lab_0x809256e:
    // 0x809256e
    LYmove(v20, v86);
    int32_t len6 = strlen(str3); // 0x80925a3
    LYstartTargetEmphasis();
    int32_t v87 = 0; // 0x809283e
    int32_t v88 = 0; // 0x809283e
    char v89 = 1; // 0x809283e
    char v90 = 1; // 0x809283e
    if (len6 > 0) {
        goto lab_0x8092840;
    } else {
        goto lab_0x809286d;
    }
  lab_0x8092840:;
    char v91 = v89;
    int32_t v92 = v88;
    char * v93 = (char *)(v92 + (int32_t)str3);
    char v94 = *v93; // 0x809284c
    str2 = v94;
    char v95 = v91; // 0x809285e
    char v96; // 0x8090d16
    char v97; // 0x8090d16
    int32_t v98; // 0x8090d16
    int32_t v99; // 0x80925d9
    int32_t v100; // 0x8092625
    int32_t v101; // 0x8092750
    if (v94 != 0) {
        // 0x80925bf
        v98 = v87;
        v99 = utf8_length(utf_flag, v93);
        if (v99 == 0) {
            // 0x8092734
            if (HTCJK == 0) {
                goto lab_0x80927d0;
            } else {
                // 0x8092741
                if (str2 >= 0) {
                    goto lab_0x80927d0;
                } else {
                    // 0x8092750
                    v101 = v92 + 1;
                    int32_t v102 = (int32_t)str3;
                    v9 = *(char *)(v101 + v102);
                    if (flag != 1) {
                        goto lab_0x8092796;
                    } else {
                        // 0x8092772
                        if (*(char *)(v92 + 2 + v102) != 0) {
                            goto lab_0x8092796;
                        } else {
                            // 0x8092788
                            LYstopTargetEmphasis();
                            v97 = 0;
                            goto lab_0x80927c0;
                        }
                    }
                }
            }
        } else {
            // 0x80925f1
            LYstrncpy(&v9, (char *)(v92 + 1 + (int32_t)str3), v99);
            v100 = v99 + v92;
            if (flag != 1) {
                goto lab_0x80926df;
            } else {
                // 0x809263b
                if (*(char *)(v100 + 1 + (int32_t)str3) != 0) {
                    goto lab_0x80926df;
                } else {
                    // 0x8092655
                    LYstopTargetEmphasis();
                    LYmove(v20, LYwin == NULL ? 0 : (int32_t)*(int16_t *)&g255 + 1);
                    v96 = 0;
                    goto lab_0x8092709;
                }
            }
        }
    } else {
        goto lab_0x8092864;
    }
  lab_0x809286d:
    // 0x809286d
    LYstopTargetEmphasis();
    v15 = v90;
    goto lab_0x80928af_7;
  lab_0x8092864:
    // 0x8092864
    v90 = v95;
    v15 = 0;
    if (v95 == 0) {
        goto lab_0x80928af_7;
    } else {
        goto lab_0x809286d;
    }
  lab_0x80927d0:;
    char v103; // 0x8090d16
    if (flag != 1) {
        goto lab_0x80927fa;
    } else {
        char v104 = *(char *)(v92 + 1 + (int32_t)str3); // 0x80927e5
        if (v104 != 0) {
            goto lab_0x80927fa;
        } else {
            // 0x80927ec
            LYstopTargetEmphasis();
            v103 = 0;
            goto lab_0x8092824;
        }
    }
  lab_0x80926df:;
    int32_t len7 = strlen(&str2); // 0x80926e8
    LYwaddnstr(LYwin, &str2, len7);
    v96 = v91;
    goto lab_0x8092709;
  lab_0x80927fa:;
    int32_t len9 = strlen(&str2); // 0x8092803
    LYwaddnstr(LYwin, &str2, len9);
    v103 = v91;
    goto lab_0x8092824;
  lab_0x8092709:
    // 0x8092709
    v9 = 0;
    char v105 = v96; // 0x809272f
    int32_t v106 = v100; // 0x809272f
    int32_t v107 = v98 + 1 + v99; // 0x809272f
    goto lab_0x809282b;
  lab_0x8092824:
    // 0x8092824
    v105 = v103;
    v106 = v92;
    v107 = v98 + 1;
    goto lab_0x809282b;
  lab_0x8092796:;
    int32_t len8 = strlen(&str2); // 0x809279f
    LYwaddnstr(LYwin, &str2, len8);
    v97 = v91;
    goto lab_0x80927c0;
  lab_0x809282b:
    // 0x809282b
    v87 = v107;
    v88 = v106 + 1;
    v89 = v105;
    v95 = v105;
    if (v107 < len6) {
        goto lab_0x8092840;
    } else {
        goto lab_0x8092864;
    }
  lab_0x80927c0:
    // 0x80927c0
    v9 = 0;
    v105 = v97;
    v106 = v101;
    v107 = v98 + 2;
    goto lab_0x809282b;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80928f2 - 0x8092cab
// Line range:    968 - 1019
int32_t find_cached_style(int32_t cur, int32_t flag) {
    int32_t result = s_alink; // 0x809290b
    if (textfields_need_activation == 0) {
        goto lab_0x80929bc;
    } else {
        int32_t v1 = 68 * cur; // 0x809291c
        result = s_alink;
        if (*(int32_t *)(v1 + (int32_t)&g347) != 1) {
            goto lab_0x80929bc;
        } else {
            int32_t v2 = *(int32_t *)(v1 + (int32_t)&g354); // 0x809293a
            int32_t v3 = *(int32_t *)(v2 + 8); // 0x8092940
            switch (v3) {
                case 1: {
                    // 0x80929b4
                    result = s_curedit;
                    goto lab_0x80929bc;
                }
                case 12: {
                    // 0x80929b4
                    result = s_curedit;
                    goto lab_0x80929bc;
                }
                case 2: {
                    // 0x80929b4
                    result = s_curedit;
                    goto lab_0x80929bc;
                }
                case 11: {
                    // 0x80929b4
                    result = s_curedit;
                    goto lab_0x80929bc;
                }
                default: {
                    // 0x8092999
                    result = s_alink;
                    if (v3 != 9) {
                        goto lab_0x80929bc;
                    } else {
                        // 0x80929b4
                        result = s_curedit;
                        goto lab_0x80929bc;
                    }
                }
            }
        }
    }
  lab_0x80929bc:
    if (flag == 1) {
        // 0x8092c45
        if (WWW_TraceFlag == 0) {
            // 0x8092ca1
            return result;
        }
        // 0x8092c50
        if ((WWW_TraceMask & 2) != 0) {
            int32_t v4 = 68 * cur; // 0x8092c67
            int32_t v5 = *(int32_t *)(v4 + (int32_t)&g345); // 0x8092c69
            int32_t v6 = *(int32_t *)(v4 + (int32_t)&g346); // 0x8092c7c
            fprintf(TraceFP(), "STYLE.highlight.on: @(%d,%d).\n", v6, v5);
        }
        // 0x8092ca1
        return result;
    }
    int32_t v7 = 68 * cur; // 0x80929d1
    int32_t * v8 = (int32_t *)(v7 + (int32_t)&g345); // 0x80929d3
    int32_t * v9 = (int32_t *)(v7 + (int32_t)&g346); // 0x80929e6
    if (ValidCachedStyle(*v9, *v8) == 0) {
        if (WWW_TraceFlag != 0) {
            // 0x8092c18
            if ((WWW_TraceMask & 2) != 0) {
                // 0x8092c24
                fprintf(TraceFP(), "STYLE.highlight.off: can't use cache.\n");
            }
        }
        // 0x8092ca1
        return s_a;
    }
    if (WWW_TraceFlag != 0) {
        // 0x8092a0b
        if ((WWW_TraceMask & 2) != 0) {
            // 0x8092a17
            fprintf(TraceFP(), "STYLE.highlight.off: cached style @(%d,%d): ", *v9, *v8);
        }
    }
    int32_t result2 = GetCachedStyle(*v9, *v8); // 0x8092a89
    if (result2 != 0) {
        // 0x8092bcb
        if (WWW_TraceFlag == 0) {
            // 0x8092ca1
            return result2;
        }
        // 0x8092bda
        if ((WWW_TraceMask & 2) != 0) {
            // 0x8092bea
            fprintf(TraceFP(), "found %d.\n", result2);
        }
        // 0x8092ca1
        return result2;
    }
    int32_t v10 = *v8 - 1;
    if (v10 < 0) {
      lab_0x8092b90:
        // 0x8092b90
        if (WWW_TraceFlag != 0) {
            // 0x8092b9b
            if ((WWW_TraceMask & 2) != 0) {
                // 0x8092ba7
                fprintf(TraceFP(), "not found, assume <a>.\n");
            }
        }
        // 0x8092ca1
        return s_a;
    }
    int32_t v11 = v10;
    int32_t result3 = GetCachedStyle(*v9, v11); // 0x8092ad6
    while (result3 == 0) {
        int32_t v12 = v11 - 1;
        if (v12 < 0) {
            goto lab_0x8092b90;
        }
        v11 = v12;
        result3 = GetCachedStyle(*v9, v11);
    }
    // 0x8092ae8
    SetCachedStyle(*v9, *v8, result3);
    if (WWW_TraceFlag == 0) {
        // 0x8092ca1
        return result3;
    }
    // 0x8092b2c
    if ((WWW_TraceMask & 2) != 0) {
        // 0x8092b38
        fprintf(TraceFP(), "found %d, x_offset=%d.\n", result3, v11 - *v8);
    }
    // 0x8092ca1
    return result3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8092cab - 0x8093603
// Line range:    1028 - 1209
void LYhighlight(int32_t flag, int32_t cur, char * target) {
    char buffer[1024]; // bp-1044, 0x8092cab
    int32_t v1 = __readgsdword(20); // 0x8092cbf
    int32_t v2 = *(int32_t *)(32 * current_char_set + (int32_t)&g144); // 0x8092d0d
    buffer = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char str2 = 0; // bp-1095, 0x8092d48
    int32_t v3 = cur; // 0x8092d52
    int32_t v4; // 0x8092cab
    if (cur >= 0) {
        goto lab_0x8092d84;
    } else {
        // 0x8092d54
        v4 = 0;
        if (WWW_TraceFlag == 0) {
            goto lab_0x8092e55;
        } else {
            // 0x8092d5f
            fprintf(TraceFP(), "LYhighlight cur %d (bug workaround)\n", cur);
            v3 = 0;
            goto lab_0x8092d84;
        }
    }
  lab_0x8092d84:
    // 0x8092d84
    v4 = v3;
    if (WWW_TraceFlag != 0) {
        char * v5 = target == NULL ? "(null)" : target;
        int32_t v6 = 68 * v3; // 0x8092dbf
        int32_t v7 = *(int32_t *)(v6 + (int32_t)&g349); // 0x8092dc1
        char * v8 = flag == 0 ? "off" : "on";
        int32_t v9 = *(int32_t *)(v6 + (int32_t)&g345); // 0x8092df6
        int32_t v10 = *(int32_t *)(v6 + (int32_t)&g346); // 0x8092e09
        fprintf(TraceFP(), "LYhighlight at(%2d,%2d) %s %d [%d]:%s\n", v10, v9, v8, v3, v7, v5);
        v4 = v3;
    }
    goto lab_0x8092e55;
  lab_0x8092e55:;
    // 0x8092e55
    int32_t v11; // 0x8092cab
    int32_t * v12; // 0x8092cab
    int32_t v13; // 0x8092cab
    int32_t v14; // 0x8092cab
    if (nlinks < 1) {
        goto lab_0x80935e8;
    } else {
        // 0x8092e62
        v11 = no_title != 0;
        v13 = 68 * v4;
        v12 = (int32_t *)(v13 + (int32_t)&g347);
        if (flag == 1) {
            goto lab_0x8092e80;
        } else {
            int32_t v15 = *v12; // 0x8092e75
            v14 = v15;
            if (v15 != 1) {
                goto lab_0x8092eda;
            } else {
                goto lab_0x8092e80;
            }
        }
    }
  lab_0x80935e8:
    // 0x80935e8
    if (v1 != __readgsdword(20)) {
        // 0x80935f4
        __stack_chk_fail();
    }
  lab_0x8092e80:;
    int32_t v16 = *(int32_t *)(v13 + (int32_t)&g346); // 0x8092ea0
    LYmove(v16 + v11, *(int32_t *)(v13 + (int32_t)&g345));
    curses_style(find_cached_style(v4, flag), 1);
    v14 = *v12;
    goto lab_0x8092eda;
  lab_0x8092eda:;
    char v17 = v2 == 7; // 0x8092d16
    if (v14 != 1) {
        if (flag != 0) {
            // 0x8093107
            if (buffer[0] == 0) {
                int32_t v18 = *(int32_t *)(v13 + (int32_t)&g345); // 0x8093147
                char * v19 = LYGetHiliteStr(v4, 0); // 0x8093165
                char * v20 = (char *)&g25; // 0x809316c
                if (v19 != NULL) {
                    // 0x809316e
                    v20 = LYGetHiliteStr(v4, 0);
                }
                // 0x8093193
                int32_t str; // bp-1040, 0x8092cab
                LYmbcsstrncpy((char *)&str, v20, 1023, LYcols - v18 + (int32_t)(LYShowScrollbar != 0), v17);
                int32_t len = strlen((char *)&str); // 0x80931d0
                LYwaddnstr(LYwin, (char *)&str, len);
            }
            goto lab_0x8093444;
        } else {
            // 0x809308c
            redraw_lines_of_link(v4);
            if (WWW_TraceFlag != 0) {
                // 0x80930ad
                if ((WWW_TraceMask & 2) != 0) {
                    int32_t v21 = *(int32_t *)(v13 + (int32_t)&g345); // 0x80930ca
                    int32_t v22 = *(int32_t *)(v13 + (int32_t)&g346); // 0x80930dd
                    fprintf(TraceFP(), "STYLE.highlight.off: NOFIX branch @(%d,%d).\n", v22, v21);
                }
            }
            goto lab_0x80934bd;
        }
    } else {
        int32_t v23 = LYcols - (int32_t)(LYShowScrollbar != 0); // 0x8092f0d
        int32_t v24 = *(int32_t *)(v13 + (int32_t)&g345); // 0x8092f1c
        int32_t v25 = *(int32_t *)(v13 + (int32_t)&g346); // 0x8092f52
        int32_t v26 = v23 - v24 + (LYlines - v25) * v23; // 0x8092f61
        char * v27 = LYGetHiliteStr(v4, 0); // 0x8092f78
        char * v28 = v27 != NULL ? v27 : (char *)&g25;
        int32_t v29 = *(int32_t *)(v13 + (int32_t)&g354); // 0x8092fa3
        int32_t v30 = *(int32_t *)(v29 + 20); // 0x8092fa9
        int32_t v31 = v30 < v26 ? v30 : v26;
        int32_t v32 = LYmbcsstrlen(v28, v17, 1); // 0x8092fec
        char * v33 = LYmbcs_skip_cells(v28, v31, v17); // 0x8093015
        LYwaddnstr(LYwin, v28, (int32_t)v33 - (int32_t)v28);
        int32_t v34 = v32 - v31; // 0x809306d
        int32_t v35 = v32; // 0x809307f
        if (v34 < 0 != ((v34 ^ v32) & (v31 ^ v32)) < 0) {
            int32_t v36 = v35 + 1; // 0x8093076
            function_804a8f4((int32_t)LYwin, 95);
            int32_t v37 = v36 - v31; // 0x809306d
            v35 = v36;
            while (v37 < 0 != ((v37 ^ v36) & (v36 ^ v31)) < 0) {
                // 0x8093052
                v36 = v35 + 1;
                function_804a8f4((int32_t)LYwin, 95);
                v37 = v36 - v31;
                v35 = v36;
            }
        }
        goto lab_0x8093444;
    }
  lab_0x8093444:;
    char * v38 = LYGetHiliteStr(v4, 1); // 0x8093454
    char * v39 = (char *)(v13 + (int32_t)&g344);
    int32_t v40 = flag == 1;
    if (v38 != NULL) {
        char * v41 = v38; // 0x8093454
        int32_t v42 = 1; // 0x809343d
        int32_t v43 = *(int32_t *)(v13 + (int32_t)&g346) + v42; // 0x809347d
        while (v43 <= display_lines) {
            int32_t v44 = v43 + v11; // 0x8093226
            int32_t v45 = LYGetHilitePos(v4, v42); // 0x8093242
            lynx_stop_link_color(v40, (int32_t)*v39);
            LYmove(v44, v45);
            if (WWW_TraceFlag != 0) {
                // 0x809329d
                if ((WWW_TraceMask & 2) != 0) {
                    // 0x80932a9
                    fprintf(TraceFP(), "STYLE.highlight.line2: @(%d,%d), style=%d.\n", v44, v45, flag != 1 ? s_a : s_alink);
                }
            }
            int32_t v46 = (int32_t)v41;
            curses_style(flag != 1 ? s_a : s_alink, 2);
            char v47 = *v41; // 0x809340d
            str2 = v47;
            char v48 = v47; // 0x809341f
            char * v49 = v41; // 0x809341f
            int32_t v50 = 0; // 0x809341f
            char v51 = 0; // 0x809341f
            if (v47 != 0) {
                while (v50 + v45 < LYcols) {
                    char v52 = v51;
                    char v53 = v52; // 0x8093354
                    if (*v49 >= 9) {
                        // 0x809336d
                        if (v48 >= 0 || HTCJK == 0) {
                            int32_t len2 = strlen(&str2); // 0x80933d9
                            LYwaddnstr(LYwin, &str2, len2);
                            v53 = v52;
                        } else {
                            int32_t len3 = strlen(&str2); // 0x80933a6
                            LYwaddnstr(LYwin, &str2, len3);
                            v53 = v52 + 1;
                        }
                    }
                    char v54 = v53 + 1; // 0x80933fa
                    int32_t v55 = v54; // 0x8093401
                    char * v56 = (char *)(v55 + v46); // 0x809340d
                    char v57 = *v56; // 0x809340d
                    str2 = v57;
                    v48 = v57;
                    v49 = v56;
                    v50 = v55;
                    v51 = v54;
                    if (v57 == 0) {
                        // break -> 0x809343d
                        break;
                    }
                }
            }
            // 0x809343d
            v42++;
            v41 = LYGetHiliteStr(v4, v42);
            if (v41 == NULL) {
                // break -> 0x8093490
                break;
            }
            v43 = *(int32_t *)(v13 + (int32_t)&g346) + v42;
        }
    }
    // 0x8093490
    lynx_stop_link_color(v40, (int32_t)*v39);
    goto lab_0x80934bd;
  lab_0x80934bd:;
    int32_t v58 = 0; // 0x8093532
    if (LYGetHiliteStr(v4, 0) != NULL) {
        char v59 = show_whereis_targets(flag, v4, v58, target, 0, v17); // 0x8093509
        int32_t v60 = v58 + 1; // 0x8093514
        char * v61 = LYGetHiliteStr(v4, v60); // 0x809352b
        v58 = v60;
        char v62 = v59; // 0x8093532
        while (v61 != NULL) {
            // 0x80934d2
            v59 = show_whereis_targets(flag, v4, v58, target, v62, v17);
            v60 = v58 + 1;
            v61 = LYGetHiliteStr(v4, v60);
            v58 = v60;
            v62 = v59;
        }
    }
    // 0x8093534
    if (LYShowCursor != 0) {
        int32_t v63 = *(int32_t *)(v13 + (int32_t)&g345); // 0x8093580
        int32_t v64 = *(int32_t *)(v13 + (int32_t)&g346); // 0x80935bf
        LYmove(v64 + v11, v63 < 1 ? 0 : v63 - 1);
    } else {
        // 0x809353f
        LYmove(LYlines - 1, LYcols + (int32_t)(LYShowScrollbar != 0) - 1);
    }
    if (flag != 0) {
        // 0x80935e3
        LYrefresh();
    }
    goto lab_0x80935e8;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809363c - 0x80936f9
// Line range:    1233 - 1270
void convert_to_spaces(char * string, char condense) {
    if (string == NULL) {
        // 0x80936f7
        return;
    }
    char * v1 = LYSkipNonBlanks(string); // 0x8093662
    char v2 = *v1; // 0x80936ea
    char * v3 = v1; // 0x80936ef
    char v4; // 0x809363c
    char v5; // 0x80936d3
    char * v6; // 0x809363c
    char * v7; // 0x809363c
    char * v8; // 0x809363c
    char v9; // 0x809363c
    char v10; // 0x809363c
    if (v2 != 0) {
        // 0x8093672
        v8 = v1;
        v4 = v2;
        v6 = v1;
        v9 = 0;
        while (true) {
          lab_0x8093672:
            // 0x8093672
            v10 = v9;
            v7 = v6;
            v5 = v4;
            if (v5 == 10) {
                goto lab_0x80936ba;
            } else {
                if (v5 > 10) {
                    if (v5 == 13) {
                        goto lab_0x80936ba;
                    } else {
                        if (v5 != 32) {
                            goto lab_0x80936d0;
                        } else {
                            goto lab_0x809369e;
                        }
                    }
                } else {
                    if (v5 == 9) {
                        goto lab_0x809369e;
                    } else {
                        goto lab_0x80936d0;
                    }
                }
            }
        }
    }
  lab_0x80936f1:
    // 0x80936f1
    *v3 = 0;
  lab_0x80936ba:;
    char v11 = v10; // 0x80936be
    char * v12 = v7; // 0x80936be
    if (v10 == 0) {
        // 0x80936c0
        *v7 = 32;
        v11 = 1;
        v12 = (char *)((int32_t)v7 + 1);
    }
    goto lab_0x80936e3;
  lab_0x80936e3:;
    char * v13 = (char *)((int32_t)v8 + 1); // 0x80936e3
    char v14 = *v13; // 0x80936ea
    v8 = v13;
    v4 = v14;
    v6 = v12;
    v9 = v11;
    v3 = v12;
    if (v14 == 0) {
        // break -> 0x80936f1
        goto lab_0x80936f1;
    }
    goto lab_0x8093672;
  lab_0x809369e:
    // 0x809369e
    v11 = 1;
    v12 = v7;
    if (condense != 0 != v10 != 0) {
        // 0x80936aa
        *v7 = 32;
        v11 = 1;
        v12 = (char *)((int32_t)v7 + 1);
    }
    goto lab_0x80936e3;
  lab_0x80936d0:
    // 0x80936d0
    *v7 = v5;
    v11 = 0;
    v12 = (char *)((int32_t)v7 + 1);
    goto lab_0x80936e3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80936f9 - 0x8093737
// Line range:    1276 - 1283
char * strip_trailing_slash(char * dirname) {
    int32_t v1 = strlen(dirname) - 1;
    if (v1 < 0) {
        // 0x8093732
        return dirname;
    }
    int32_t v2 = v1; // 0x8093723
    char * v3 = (char *)(v2 + (int32_t)dirname); // 0x809372b
    while (*v3 == 47) {
        // 0x8093712
        *v3 = 0;
        v2--;
        if (v2 < 0) {
            // break -> 0x8093732
            break;
        }
        v3 = (char *)(v2 + (int32_t)dirname);
    }
    // 0x8093732
    return dirname;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8093737 - 0x80937b1
// Line range:    1289 - 1296
void remove_most_blanks(char * buffer) {
    int32_t len = strlen(buffer); // 0x8093743
    if (len == 0) {
        // 0x809376a
        LYReduceBlanks(buffer);
        // 0x80937af
        return;
    }
    int32_t v1 = (int32_t)buffer;
    if (*(char *)(v1 - 1 + len) != 32) {
        // 0x809376a
        LYReduceBlanks(buffer);
        // 0x80937af
        return;
    }
    // 0x8093771
    LYReduceBlanks(buffer);
    memcpy((int32_t *)(strlen(buffer) + v1), &g391, (int32_t)&g391);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80937b1 - 0x8093ec6
// Line range:    1304 - 1503
void statusline(char * text) {
    char text_buff[1024]; // bp-2064, 0x80937b1
    char v1[1024]; // 0x80938e9
    int32_t v2 = __readgsdword(20); // 0x80937c3
    text_buff = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    if (text != NULL) {
        // 0x80937e5
        if (dump_output_immediately == 0) {
            // 0x80937f4
            if (mustshow != 1 != (no_statusline == 1)) {
                // 0x809380e
                int32_t v3; // bp-4, 0x80937b1
                int32_t v4 = &v3; // 0x80937b2
                mustshow = 0;
                int32_t str; // bp-2056, 0x80937b1
                LYstrncpy((char *)&str, text, 1023);
                strchr((char *)&str, 10);
                int32_t v5 = LYcols + (int32_t)(LYShowScrollbar != 0) - 1; // 0x809387f
                int32_t v6 = v5 < 1023 ? v5 : 1023;
                char * temp; // bp-2068, 0x80937b1
                *(int32_t *)&temp = v6;
                int32_t str2; // bp-1032, 0x80937b1
                if ((char)str == 0 || LYHaveCJKCharacterSet == 0) {
                    // 0x8093b13
                    remove_most_blanks((char *)&str);
                    int32_t len = strlen((char *)&str); // 0x8093b2a
                    char * v7 = len < 1023 ? (char *)len : (char *)1023;
                    int32_t n = (int32_t)v7; // 0x8093b4b
                    char * dest_str = strncpy((char *)&str2, (char *)&str, n); // 0x8093b68
                    *(char *)(n + (int32_t)dest_str) = 0;
                    if (v7 >= (char *)1) {
                        int32_t v8 = (int32_t)v7; // 0x8093b9b
                        while (LYstrExtent((char *)&str2, v8, v8) > (int32_t)temp) {
                            int32_t v9 = v8 - 1; // 0x8093b7d
                            char * v10 = (char *)v9; // 0x8093b7d
                            *(char *)(v4 - 1028 + v9) = 0;
                            if (v10 < (char *)1) {
                                // break -> 0x8093bc5
                                break;
                            }
                            v8 = (int32_t)v10;
                        }
                    }
                } else {
                    int32_t * mem = calloc(strlen((char *)&str) + 1, 1); // 0x80938e4
                    v1[0] = (int32_t)mem;
                    text_buff = v1;
                    int32_t v11 = *(int32_t *)&text_buff; // 0x80938ef
                    if (v11 == 0) {
                        // 0x80938f8
                        outofmem("./LYUtils.c", "statusline");
                        // UNREACHABLE
                    }
                    char * v12 = (char *)v6;
                    char * v13; // 0x80937b1
                    char * v14; // 0x80937b1
                    if (kanji_code != 1) {
                        if (kanji_code != 2) {
                            int32_t v15 = v4 - 2052; // 0x80939b1
                            char v16 = *(char *)v15; // 0x80939b1
                            int32_t v17 = v11; // 0x80939bb
                            int32_t v18 = 0; // 0x80939bb
                            if (v16 != 0) {
                                int32_t v19 = 0;
                                int32_t v20 = v19; // 0x809397d
                                if (v16 != 27) {
                                    // 0x809397f
                                    *(char *)(*(int32_t *)&text_buff + v19) = v16;
                                    v20 = v19 + 1;
                                }
                                int32_t v21 = v20;
                                int32_t v22 = 1; // 0x80939a4
                                char v23 = *(char *)(v22 + v15); // 0x80939b1
                                int32_t v24 = v22; // 0x80939bb
                                while (v23 != 0) {
                                    // 0x809396d
                                    v19 = v21;
                                    char v25 = v23;
                                    v20 = v19;
                                    if (v25 != 27) {
                                        // 0x809397f
                                        *(char *)(*(int32_t *)&text_buff + v19) = v25;
                                        v20 = v19 + 1;
                                    }
                                    // 0x80939a4
                                    v21 = v20;
                                    v22 = v24 + 1;
                                    v23 = *(char *)(v22 + v15);
                                    v24 = v22;
                                }
                                // 0x80939ab
                                v17 = *(int32_t *)&text_buff;
                                v18 = v21;
                            }
                            // 0x80939bd
                            *(char *)(v18 + v17) = 0;
                            v13 = (char *)*(int32_t *)&text_buff;
                            v14 = temp;
                        } else {
                            char * str3 = (char *)v11;
                            strcpy(str3, (char *)&str);
                            v13 = str3;
                            v14 = v12;
                        }
                    } else {
                        char * v26 = (char *)v11;
                        TO_EUC((char *)&str, v26);
                        v13 = v26;
                        v14 = v12;
                    }
                    // 0x80939cc
                    remove_most_blanks(v13);
                    char v27 = *v13; // 0x8093ac2
                    int32_t v28 = v4 - 1028;
                    int32_t v29 = 0; // 0x8093ac7
                    if (v14 > NULL == (v27 != 0)) {
                        int32_t v30 = 0;
                        int32_t v31 = 0;
                        char * v32 = NULL;
                        char v33 = 0;
                        int32_t v34; // 0x80937b1
                        char v35; // 0x80937b1
                        char * v36; // 0x80937b1
                        char v37; // 0x8093a3a
                        if (v33 == 0) {
                            // 0x8093a5b
                            v34 = v31;
                            v36 = v32;
                            v35 = v27;
                            if (v27 >= 0) {
                                // 0x8093a85
                                *(char *)(v31 + v28) = v27;
                                v34 = v31 + 1;
                                v36 = (char *)((int32_t)v32 + 1);
                                v35 = 0;
                            }
                        } else {
                            // 0x8093a0d
                            *(char *)(v31 + v28) = v33;
                            v37 = *(char *)(*(int32_t *)&text_buff + v30);
                            *(char *)(v4 - 1027 + v31) = v37;
                            v34 = v31 + 2;
                            v36 = (char *)((int32_t)v32 + 2);
                            v35 = 0;
                        }
                        char * v38 = v36;
                        int32_t v39 = v34;
                        int32_t v40 = v30 + 1; // 0x8093aaf
                        char v41 = *(char *)(*(int32_t *)&text_buff + v40); // 0x8093ac2
                        v29 = v39;
                        while (v41 != 0 == v38 < temp) {
                            // 0x8093a04
                            v30 = v40;
                            v31 = v39;
                            v32 = v38;
                            v33 = v35;
                            if (v33 == 0) {
                                char v42 = v41;
                                v34 = v31;
                                v36 = v32;
                                v35 = v42;
                                if (v42 >= 0) {
                                    // 0x8093a85
                                    *(char *)(v31 + v28) = v42;
                                    v34 = v31 + 1;
                                    v36 = (char *)((int32_t)v32 + 1);
                                    v35 = 0;
                                }
                            } else {
                                // 0x8093a0d
                                *(char *)(v31 + v28) = v33;
                                v37 = *(char *)(*(int32_t *)&text_buff + v30);
                                *(char *)(v4 - 1027 + v31) = v37;
                                v34 = v31 + 2;
                                v36 = (char *)((int32_t)v32 + 2);
                                v35 = 0;
                            }
                            // 0x8093aaf
                            v38 = v36;
                            v39 = v34;
                            v40 = v30 + 1;
                            v41 = *(char *)(*(int32_t *)&text_buff + v40);
                            v29 = v39;
                        }
                    }
                    // 0x8093adb
                    *(char *)(v29 + v28) = 0;
                    int32_t v43 = *(int32_t *)&text_buff; // 0x8093ae9
                    if (v43 != 0) {
                        // 0x8093af6
                        free((int32_t *)v43);
                        text_buff = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                    }
                }
                int32_t v44 = LYStatusLine; // 0x8093bc5
                int32_t v45; // 0x80937b1
                if (v44 < 0) {
                    // 0x8093bfc
                    if (user_mode != 0) {
                        // 0x8093c15
                        v45 = LYlines - 1;
                    } else {
                        // 0x8093c05
                        v45 = LYlines - 3;
                    }
                } else {
                    int32_t v46 = LYlines - 1; // 0x8093bd3
                    v45 = v46 > v44 ? v44 : v46;
                }
                // 0x8093c23
                LYmove(v45, 0);
                LYclrtoeol();
                if ((char)str2 != 0) {
                    // 0x8093c4d
                    if (HTCJK != 0) {
                        int32_t v47 = v4 - 1028; // 0x8093c91
                        char v48 = *(char *)v47; // 0x8093c91
                        char v49 = v48; // 0x8093c9b
                        int32_t v50 = 0; // 0x8093c9b
                        if (v48 != 0) {
                            while (v49 >= 0) {
                                int32_t v51 = v50 + 1; // 0x8093c84
                                char v52 = *(char *)(v51 + v47); // 0x8093c91
                                v49 = v52;
                                v50 = v51;
                                if (v52 == 0) {
                                    goto lab_0x8093cab;
                                }
                            }
                            // 0x8093ca6
                            LYrefresh();
                        }
                    }
                  lab_0x8093cab:;
                    int32_t strncmp_rc = strncmp((char *)&str2, gettext("Alert!: %s"), 5); // 0x8093ccc
                    int32_t * v53 = &s_status; // 0x8093cd3
                    if (strncmp_rc == 0) {
                        int32_t v54 = *(int32_t *)(24 * s_alert + (int32_t)&hashStyles); // 0x8093ce4
                        v53 = v54 != 0 ? &s_alert : &s_status;
                    }
                    int32_t v55 = *v53;
                    curses_style(v55, 1);
                    int32_t len2 = strlen((char *)&str2); // 0x8093d33
                    LYwaddnstr(LYwin, (char *)&str2, len2);
                    int32_t v56 = 32; // 0x8093d5b
                    if (lynx_has_color != 0 && LYShowColor >= 2) {
                        int32_t v57 = *(int32_t *)(24 * v55 + (int32_t)&g358); // 0x8093d76
                        v56 = v57 | 32;
                    }
                    // 0x8093d93
                    function_804b3b4((int32_t)LYwin, v56);
                    int32_t * v58 = LYwin; // 0x8093daa
                    if ((v58 == NULL ? -1 : 0x10000 * (int32_t)v58 >> 16) == v45) {
                        // 0x8093e19
                        LYclrtoeol();
                    }
                    // 0x8093e1e
                    if (lynx_has_color != 0 == LYShowColor > 1) {
                        // 0x8093e48
                        if (s_normal == -1) {
                            // 0x8093e7e
                            function_804b3b4((int32_t)LYwin, g357 | 32);
                        } else {
                            int32_t v59 = *(int32_t *)(24 * s_normal + (int32_t)&g358); // 0x8093e61
                            function_804b3b4((int32_t)LYwin, v59 | 32);
                        }
                    } else {
                        // 0x8093e31
                        function_804b3b4((int32_t)LYwin, 32);
                    }
                    // 0x8093e98
                    curses_style(v55, 0);
                }
                // 0x8093eae
                LYrefresh();
            }
        }
    }
    // 0x8093eb3
    if (v2 != __readgsdword(20)) {
        // 0x8093ebf
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8093ec6 - 0x8093f23
// Line range:    1506 - 1517
char * novice_lines(int32_t lineno2) {
    switch (lineno2) {
        case 1: {
            // 0x8093f1e
            return gettext("  O)ther cmds  B)ack  E)dit  D)ownload ^R)eload ^W)ipe screen  search doc: / \n");
        }
        case 2: {
            // 0x8093f1e
            return gettext("O)ther cmds  C)omment  History: <backspace>  Bookmarks: V)iew, A)dd, R)emove \n");
        }
    }
    char * result = (char *)&g25; // 0x8093ee2
    if (lineno2 == 0) {
        // 0x8093ee4
        result = gettext("  O)ther cmds  H)elp  K)eymap  G)oto  P)rint  M)ain screen  o)ptions  Q)uit  \n");
    }
    // 0x8093f1e
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8093f23 - 0x8093f56
// Line range:    1522 - 1527
void toggle_novice_line(void) {
    int32_t v1 = lineno + 1; // 0x8093f2e
    lineno = v1;
    if (*novice_lines(v1) == 0) {
        // 0x8093f4a
        lineno = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8093f56 - 0x80940b8
// Line range:    1530 - 1553
void noviceline(int32_t more_flag) {
    // 0x8093f56
    if (dump_output_immediately != 0) {
        // 0x80940b2
        return;
    }
    // 0x8093f6c
    LYmove(LYlines - 2, 0);
    LYclrtoeol();
    int32_t len = strlen(gettext("  Arrow keys: Up and Down to move.  Right to follow a link; Left to go back.  \n")); // 0x8093f98
    LYwaddnstr(LYwin, gettext("  Arrow keys: Up and Down to move.  Right to follow a link; Left to go back.  \n"), len);
    LYmove(LYlines - 1, 0);
    LYclrtoeol();
    if (lynx_edit_mode != 0) {
        // 0x8093fe9
        if (no_dired_support == 0) {
            int32_t len2 = strlen(gettext("  C)reate  D)ownload  E)dit  F)ull menu  M)odify  R)emove  T)ag  U)pload     \n")); // 0x8094003
            LYwaddnstr(LYwin, gettext("  C)reate  D)ownload  E)dit  F)ull menu  M)odify  R)emove  T)ag  U)pload     \n"), len2);
            // 0x80940ad
            LYrefresh();
            // 0x80940b2
            return;
        }
    }
    // 0x809402e
    if (LYUseNoviceLineTwo == 0) {
        int32_t len3 = strlen(novice_lines(lineno)); // 0x8094083
        char * v1 = novice_lines(lineno); // 0x8094092
        LYwaddnstr(LYwin, v1, len3);
    } else {
        int32_t len4 = strlen(gettext(" H)elp O)ptions P)rint G)o M)ain screen Q)uit /=search [delete]=history list \n")); // 0x8094048
        LYwaddnstr(LYwin, gettext(" H)elp O)ptions P)rint G)o M)ain screen Q)uit /=search [delete]=history list \n"), len4);
    }
    // 0x80940ad
    LYrefresh();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80940b8 - 0x80942db
// Line range:    1568 - 1615
int32_t LYReopenInput(void) {
    int32_t fd = fileno(g163); // 0x80940cf
    if (fd != 0 || isatty(fd) != 0 || LYConsoleInputFD(0) != fd) {
        // 0x80942d1
        return 0;
    }
    int32_t fd2 = fileno((struct _IO_FILE *)g164); // 0x809411f
    int32_t v1 = -1; // 0x809412e
    int32_t v2 = 0; // 0x809412e
    int32_t v3; // 0x80940b8
    int32_t v4; // 0x80940b8
    if (isatty(fd2) == 0) {
        goto lab_0x809416a;
    } else {
        char * v5 = ttyname(fileno((struct _IO_FILE *)g164)); // 0x8094140
        int32_t v6 = (int32_t)v5; // 0x8094140
        v1 = -1;
        v2 = v6;
        if (v5 == NULL) {
            goto lab_0x809416a;
        } else {
            int32_t v7 = open64(v5, 0); // 0x809415c
            v1 = v7;
            v2 = v6;
            v4 = v6;
            v3 = v7;
            if (v7 != -1) {
                goto lab_0x80941b7;
            } else {
                goto lab_0x809416a;
            }
        }
    }
  lab_0x809416a:;
    int32_t fd3 = fileno((struct _IO_FILE *)g160); // 0x8094172
    v4 = v2;
    v3 = v1;
    if (isatty(fd3) != 0) {
        char * v8 = ttyname(fileno((struct _IO_FILE *)g160)); // 0x8094193
        int32_t v9 = (int32_t)v8; // 0x8094193
        v4 = v9;
        v3 = v1;
        if (v8 != NULL) {
            // 0x80941a1
            v4 = v9;
            v3 = open64(v8, 0);
        }
    }
    goto lab_0x80941b7;
  lab_0x80941b7:;
    int32_t v10 = v4; // 0x80941bb
    int32_t v11 = v3; // 0x80941bb
    if (v3 == -1) {
        char * v12 = ctermid(NULL); // 0x80941c4
        int32_t v13 = (int32_t)v12; // 0x80941c4
        v10 = v13;
        v11 = v3;
        if (v12 != NULL) {
            // 0x80941d2
            v10 = v13;
            v11 = open64(v12, 0);
        }
    }
    int32_t v14 = v10; // 0x80941ec
    int32_t fd4 = v11; // 0x80941ec
    if (v11 == -1) {
        // 0x80941ee
        v14 = (int32_t)"/dev/tty";
        fd4 = open64("/dev/tty", 0);
    }
    // 0x809420c
    if (WWW_TraceFlag != 0) {
        // 0x8094217
        fprintf(TraceFP(), "LYReopenInput open(%s) returned %d.\n", (char *)v14, fd4);
    }
    // 0x809423e
    if (fd4 < 0) {
        // 0x80942d1
        return -1;
    }
    // 0x8094248
    close(fd4);
    char * v15 = (char *)v14;
    struct _IO_FILE * v16 = freopen64(v15, "r", g163); // 0x809426a
    if (WWW_TraceFlag != 0) {
        int32_t v17 = fileno(g163); // 0x8094285
        struct _IO_FILE * stream = TraceFP(); // 0x8094292
        fprintf(stream, "LYReopenInput freopen(%s,\"r\",stdin) returned %p, stdin is now %p with fd %d.\n", v15, &v16->e0, &g163->e0, v17);
    }
    // 0x80942d1
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80942db - 0x8094335
// Line range:    1626 - 1651
int32_t LYConsoleInputFD(char need_selectable) {
    int32_t fd = fileno(g163); // 0x80942f6
    int32_t result = fd; // 0x8094302
    if (need_selectable != 0 && fd != -1) {
        // 0x809430a
        result = isatty(fd) == 0 ? -1 : fd;
    }
    // 0x8094330
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8094335 - 0x8094477
// Line range:    1657 - 1671
void LYFakeZap(char set) {
    int32_t v1 = fake_zap;
    if (set != 0) {
        if (v1 >= 0 == (v1 != 0)) {
            // 0x8094471
            return;
        }
        // 0x8094359
        if (WWW_TraceFlag != 0) {
            // 0x809437b
            fprintf(TraceFP(), "\r *** Set simulated 'Z'");
            int32_t v2 = fake_zap;
            if (v2 != 0 && WWW_TraceFlag != 0) {
                // 0x809438f
                fprintf(TraceFP(), ", %d pending", v2);
            }
            // 0x80943b0
            if (WWW_TraceFlag != 0) {
                // 0x80943bb
                fprintf(TraceFP(), " ***\n");
            }
        }
        // 0x80943d2
        fake_zap++;
        // 0x8094471
        return;
    }
    if (v1 == 0) {
        // 0x8094471
        return;
    }
    // 0x80943f7
    if (WWW_TraceFlag != 0) {
        // 0x8094419
        fprintf(TraceFP(), "\r *** Unset simulated 'Z'");
        if (WWW_TraceFlag == 0) {
            // 0x8094467
            fake_zap = 0;
            // 0x8094471
            return;
        }
        // 0x8094445
        fprintf(TraceFP(), ", %d pending", fake_zap);
        if (WWW_TraceFlag != 0) {
            // 0x8094450
            fprintf(TraceFP(), " ***\n");
        }
    }
    // 0x8094467
    fake_zap = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8094477 - 0x80944fd
// Line range:    1674 - 1709
int32_t DontCheck(void) {
    // 0x8094477
    if (dump_output_immediately != 0 || LYHaveCmdScript() != 0) {
        // 0x80944f8
        return 1;
    }
    // 0x80944a3
    int32_t next; // bp-16, 0x8094477
    gettimeofday((struct timeval *)&next, NULL);
    int32_t v1; // 0x8094477
    int32_t v2 = v1 / 0x186a3; // 0x80944cf
    int32_t result = 1; // 0x80944de
    if (v2 != g282) {
        // 0x80944e9
        g282 = v2;
        result = 0;
    }
    // 0x80944f8
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80944fd - 0x8094a52
// Line range:    1712 - 1928
int32_t HTCheckForInterrupt(void) {
    uint32_t v1 = fake_zap; // 0x8094506
    if (v1 >= 1) {
        // 0x809450f
        fake_zap = v1 - 1;
        if (WWW_TraceFlag == 0) {
            // 0x8094a4a
            return 1;
        }
        // 0x809453e
        fprintf(TraceFP(), "\r *** Got simulated 'Z' ***\n");
        if (WWW_TraceFlag == 0) {
            // 0x8094a4a
            return 1;
        }
        // 0x8094556
        fflush(TraceFP());
        if (WWW_TraceFlag == 0) {
            // 0x8094a4a
            return 1;
        }
        // 0x8094561
        if (LYTraceLogFP == NULL) {
            // 0x809456a
            sleep(AlertSecs);
        }
        // 0x8094a4a
        return 1;
    }
    // 0x8094586
    if (DontCheck() != 0) {
        // 0x8094a4a
        return 0;
    }
    int32_t timeout = 0; // bp-48, 0x80945a5
    int32_t readfds; // bp-176, 0x80944fd
    for (int32_t i = 0; i < 32; i++) {
        // 0x80945c5
        *(int32_t *)(4 * i + (int32_t)&readfds) = 0;
    }
    // 0x80945dc
    readfds |= 1;
    if (select(1, (struct _TYPEDEF_fd_set *)&readfds, NULL, NULL, (struct timeval *)&timeout) == -1) {
        // 0x8094621
        if (*__errno_location() == 4) {
            // 0x8094a4a
            return 0;
        }
    }
    // 0x809463c
    if (readfds % 2 == 0) {
        // 0x8094a4a
        return 0;
    }
    uint32_t v2 = LYgetch(); // 0x8094658
    if ((v2 || 4) == 7) {
        // 0x8094a4a
        return 1;
    }
    int32_t v3; // 0x80944fd
    if (v2 != -1) {
        if ((v2 & 0x8800) == 0) {
            int32_t v4 = 2 * v2 & 4094; // 0x80946a4
            if (*(int16_t *)(v4 + 0x8197ea2) == 47) {
                // 0x8094a4a
                return 1;
            }
            // 0x80946f8
            v3 = (int32_t)*(int16_t *)(v4 + (int32_t)&keymap + 2);
        } else {
            int32_t v5 = v2 % 256; // 0x8094690
            v3 = v5;
            if (v5 == 47) {
                // 0x8094a4a
                return 1;
            }
        }
    } else {
        uint16_t v6 = keymap[0]; // 0x8094672
        if (v6 == 47) {
            // 0x8094a4a
            return 1;
        }
        // 0x80946ca
        v3 = v6;
    }
    int16_t v7 = v3;
    switch (v7) {
        case 64: {
            // 0x8094746
            handle_LYK_TRACE_TOGGLE();
            // 0x8094a4a
            return 0;
        }
        case 104: {
            char * v8 = LYDownLoadAddress(); // 0x8094750
            char * v9; // 0x809477e
            if (v8 == NULL || *v8 == 0) {
                // 0x8094777
                v9 = gettext("Copy to clipboard failed.");
                HTInfoMsg(v9);
                // 0x8094a4a
                return 0;
            }
            // 0x8094768
            if (put_clip(v8) == 0) {
                // 0x8094790
                HTInfoMsg(gettext("Download document URL put to clipboard."));
                // 0x8094a4a
                return 0;
            }
            // 0x8094777
            v9 = gettext("Copy to clipboard failed.");
            HTInfoMsg(v9);
            // 0x8094a4a
            return 0;
        }
    }
    // 0x80947a9
    if (display_partial == 0 || NumOfLines_partial < 3) {
        // 0x8094a4a
        return 0;
    }
    int32_t v10 = LYGetNewline(); // 0x80947c6
    char * v11 = (char *)v10; // 0x80947cb
    char * v12 = v11; // bp-40, 0x80947cb
    g372 = v3 - 15;
    switch (v7) {
        case 15: {
            // 0x809493d
            if (HText_canScrollDown() != 0) {
                // 0x809494a
                v12 = (char *)(display_lines + (int32_t)v12);
            }
        }
        case 21: {
          lab_0x8094a19:;
            char * v13 = v12; // 0x8094a19
            char * v14 = v13; // 0x8094a1e
            if (v13 >= NULL != v13 != NULL) {
                // 0x8094a20
                v12 = (char *)1;
                v14 = (char *)1;
            }
            int32_t result = 0; // 0x8094a34
            if (LYMainLoop_pageDisplay((int32_t)v14) != 0) {
                // 0x8094a36
                NumOfLines_partial = HText_getNumOfLines();
                result = 0;
            }
            // 0x8094a4a
            return result;
        }
        case 16: {
            if (v11 >= (char *)2) {
                // 0x809492a
                v12 = (char *)(v10 - display_lines);
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        case 17: {
            if (v11 >= (char *)2) {
                // 0x80949ba
                v12 = (char *)(v10 - 2);
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        case 18: {
            // 0x80949c5
            if (HText_canScrollDown() != 0) {
                // 0x80949ce
                v12 = (char *)((int32_t)v12 + 2);
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        case 19: {
            if (v11 >= (char *)2) {
                int32_t v15 = display_lines; // 0x809496c
                v12 = (char *)(v10 - (v15 + (int32_t)(v15 < 0) >> 1));
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        case 20: {
            // 0x8094989
            if (HText_canScrollDown() != 0) {
                int32_t v16 = display_lines; // 0x8094996
                v12 = (char *)((v16 + (int32_t)(v16 < 0) >> 1) + (int32_t)v12);
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        case 22: {
            if (v11 >= (char *)2) {
                // 0x80949e1
                v12 = (char *)1;
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        case 23: {
            // 0x80949ea
            if (HText_canScrollDown() != 0) {
                // 0x80949f3
                v12 = (char *)(HText_getNumOfLines() + 1 - display_lines);
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        case 30: {
            // 0x809482d
            if (display_lines + 1 < v10) {
                int32_t v17 = HTGetLinkOrFieldStart(-1, (int32_t *)&v12, NULL, -1, 1); // 0x8094875
                if (v17 != 8) {
                    if (v17 == 16) {
                        // 0x809489b
                        v12 = (char *)((int32_t)v12 - display_lines);
                    }
                } else {
                    // 0x8094883
                    v12 = (char *)((int32_t)v12 + 1);
                }
            } else {
                // 0x809483c
                v12 = (char *)(v10 - display_lines);
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        case 31: {
            // 0x80948ae
            if (HText_canScrollDown() != 0) {
                int32_t v18 = HText_LinksInLines(HTMainText, (int32_t)v12, display_lines); // 0x80948d4
                if (HTGetLinkOrFieldStart(v18 - 1, (int32_t *)&v12, NULL, 1, 1) == 8) {
                    // 0x8094910
                    v12 = (char *)((int32_t)v12 + 1);
                }
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        case 51: {
        }
        case 52: {
        }
        case 53: {
            // 0x80947f6
            int32_t v19; // bp-5, 0x80944fd
            handle_LYK_WHEREIS(v3, (char *)&v19);
            if (www_search_result != -1) {
                // 0x8094816
                v12 = (char *)www_search_result;
                www_search_result = -1;
            }
            // branch (via goto) -> 0x8094a19
            goto lab_0x8094a19;
        }
        default: {
            // 0x8094a4a
            return 0;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8094a52 - 0x8094a80
// Line range:    1935 - 1952
char LYisAbsPath(char * path) {
    // 0x8094a52
    if (path == NULL) {
        // 0x8094a7a
        return 0;
    }
    char v1 = *path; // 0x8094a65
    char result = 0; // 0x8094a6a
    if (v1 != 0) {
        // 0x8094a6c
        result = v1 == 47;
    }
    // 0x8094a7a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8094a80 - 0x8094ab6
// Line range:    1958 - 1966
char LYisRootPath(char * path) {
    // 0x8094a80
    if (strlen(path) == 1) {
        // 0x8094a96
        if (*path == 47) {
            // 0x8094ab0
            return 1;
        }
    }
    // 0x8094ab0
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8094ab6 - 0x8094c2d
// Line range:    1973 - 2003
char LYisLocalFile(char * filename) {
    // 0x8094ab6
    if (filename == NULL) {
        // 0x8094c27
        return 0;
    }
    char * str = HTParse(filename, (char *)&g25, 8); // 0x8094aef
    if (str == NULL) {
        // 0x8094c27
        return 0;
    }
    // 0x8094b06
    if (*str == 0) {
        // 0x8094b16
        free((int32_t *)str);
        // 0x8094c27
        return 0;
    }
    char * found_char_pos = strchr(str, 58); // 0x8094b3f
    if (found_char_pos != NULL) {
        // 0x8094b4d
        *found_char_pos = 0;
    }
    char * str2 = HTParse(filename, (char *)&g25, 16); // 0x8094b69
    if (str2 == NULL) {
        // 0x8094c0b
        free((int32_t *)str);
        // 0x8094c27
        return 0;
    }
    // 0x8094b77
    if (strcmp("file", str2) != 0) {
        // 0x8094c11
        free((int32_t *)str);
        free((int32_t *)str2);
        // 0x8094c27
        return 0;
    }
    // 0x8094b8e
    if (strcmp(str, "localhost") != 0) {
        // 0x8094ba5
        if (strcmp(str, HTHostName()) != 0) {
            // 0x8094c11
            free((int32_t *)str);
            free((int32_t *)str2);
            // 0x8094c27
            return 0;
        }
    }
    // 0x8094bdb
    free((int32_t *)str);
    free((int32_t *)str2);
    // 0x8094c27
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8094c2d - 0x8094d4a
// Line range:    2010 - 2035
char LYisLocalHost(char * filename) {
    // 0x8094c2d
    if (filename == NULL) {
        // 0x8094d44
        return 0;
    }
    char * str = HTParse(filename, (char *)&g25, 8); // 0x8094c5f
    if (str == NULL) {
        // 0x8094d44
        return 0;
    }
    // 0x8094c76
    if (*str == 0) {
        // 0x8094c86
        free((int32_t *)str);
        // 0x8094d44
        return 0;
    }
    char * found_char_pos = strchr(str, 58); // 0x8094caf
    if (found_char_pos != NULL) {
        // 0x8094cbd
        *found_char_pos = 0;
    }
    // 0x8094cc3
    if (strcmp(str, "localhost") == 0 || strcmp(str, (char *)LYHostName) == 0 || strcmp(str, HTHostName()) == 0) {
        // 0x8094d10
        free((int32_t *)str);
        // 0x8094d44
        return 1;
    }
    // 0x8094d2e
    free((int32_t *)str);
    // 0x8094d44
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8094d4a - 0x8094db5
// Line range:    2041 - 2051
void LYFreeStringList(int32_t * list) {
    if (list == NULL) {
        // 0x8094db3
        return;
    }
    int32_t v1 = *(int32_t *)((int32_t)list + 4); // 0x8094d7f
    int32_t v2 = v1; // 0x8094d89
    if (v1 == 0) {
        // 0x8094da8
        HTList_delete(list);
        // 0x8094db3
        return;
    }
    int32_t v3 = *(int32_t *)v2; // 0x8094d8e
    while (v3 != 0) {
        // 0x8094d64
        free((int32_t *)v3);
        v2 += 4;
        if (v2 == 0) {
            // break -> 0x8094da8
            break;
        }
        v3 = *(int32_t *)v2;
    }
    // 0x8094da8
    HTList_delete(list);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8094e2d - 0x8094f5b
// Line range:    2090 - 2117
char LYisLocalAlias(char * filename) {
    // 0x8094e2d
    if (filename != NULL != localhost_aliases != NULL) {
        // 0x8094f55
        return 0;
    }
    char * str = HTParse(filename, (char *)&g25, 8); // 0x8094e6d
    if (str == NULL) {
        // 0x8094f55
        return 0;
    }
    // 0x8094e84
    if (*str == 0) {
        // 0x8094e94
        free((int32_t *)str);
        // 0x8094f55
        return 0;
    }
    char * found_char_pos = strchr(str, 58); // 0x8094ebd
    if (found_char_pos != NULL) {
        // 0x8094ecb
        *found_char_pos = 0;
    }
    char * v1 = (char *)localhost_aliases; // 0x8094e2d
    char result; // 0x8094e2d
    while (v1 != NULL) {
        int32_t v2 = *(int32_t *)((int32_t)v1 + 4); // 0x8094f10
        if (v2 == 0) {
            // break -> 0x8094f3f
            break;
        }
        int32_t str2 = *(int32_t *)v2; // 0x8094f1f
        if (str2 == 0) {
            // break -> 0x8094f3f
            break;
        }
        // 0x8094ed3
        v1 = (char *)v2;
        if (strcmp(str, (char *)str2) == 0) {
            // 0x8094eef
            free((int32_t *)str);
            result = 1;
            return result;
        }
    }
    // 0x8094f3f
    free((int32_t *)str);
    result = 0;
  lab_0x8094f55:
    // 0x8094f55
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8094f5b - 0x8095118
// Line range:    2131 - 2180
int32_t LYCheckForProxyURL(char * filename) {
    char * cp = NULL; // bp-16, 0x8094f67
    if (filename == NULL || *filename == 0) {
        // 0x8095113
        return (int32_t)NULL;
    }
    char * v1 = LYSkipBlanks(filename); // 0x8094f90
    char * str = (char *)((int32_t)v1 + 1);
    char * found_char_pos = strchr(str, 58); // 0x8094fa9
    if (found_char_pos == NULL) {
        // 0x8095113
        return (int32_t)NULL;
    }
    char * found_char_pos2 = strchr(str, 47); // 0x8094fcc
    cp = found_char_pos2;
    if (found_char_pos2 != NULL && found_char_pos2 < found_char_pos) {
        // 0x8095113
        return (int32_t)NULL;
    }
    // 0x8094fef
    *found_char_pos = 0;
    cp = NULL;
    HTSACopy(&cp, v1);
    *found_char_pos = 58;
    HTSACat(&cp, "_proxy");
    char * v2 = cp;
    if (LYGetEnv(cp) != NULL) {
        // 0x8095036
        if (v2 != NULL) {
            // 0x809503d
            free((int32_t *)v2);
            cp = NULL;
        }
        // 0x8095113
        return (int32_t)(char *)44;
    }
    if (v2 != NULL) {
        // 0x8095062
        free((int32_t *)v2);
        cp = NULL;
    }
    // 0x8095074
    if (*v1 == 0) {
        // 0x8095113
        return (int32_t)NULL;
    }
    char * v3 = (char *)((int32_t)found_char_pos + 1); // 0x8095074
    int16_t * v4 = *__ctype_b_loc(); // 0x8095093
    unsigned char v5 = *v3; // 0x8095098
    if ((*(int16_t *)(2 * (int32_t)v5 + (int32_t)v4) & 2048) == 0) {
        // 0x8095113
        return (int32_t)(char *)1;
    }
    // 0x80950b8
    if (v5 == 0) {
        // 0x8095113
        return (int32_t)NULL;
    }
    char * v6 = v3; // 0x80950c0
    int16_t * v7 = *__ctype_b_loc(); // 0x80950c7
    unsigned char v8 = *v6; // 0x80950cc
    while ((*(int16_t *)(2 * (int32_t)v8 + (int32_t)v7) & 2048) != 0) {
        // 0x80950b4
        v6 = (char *)((int32_t)v6 + 1);
        if (*v6 == 0) {
            // 0x8095113
            return (int32_t)NULL;
        }
        v7 = *__ctype_b_loc();
        v8 = *v6;
    }
    // 0x80950e6
    switch (v8) {
        case 0: {
        }
        case 47: {
            // 0x8095113
            return (int32_t)NULL;
        }
    }
    // 0x8095113
    return (int32_t)(char *)1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8095118 - 0x8095193
// Line range:    2189 - 2200
char compare_type(char * tst, char * cmp, int32_t len) {
    // 0x8095118
    if (strncasecomp(tst, cmp, len) != 0) {
        // 0x809518d
        return 0;
    }
    // 0x809513b
    if (len == 0 | strncmp(tst, cmp, len) == 0) {
        // 0x809518d
        return 1;
    }
    int32_t v1 = 0; // 0x8095177
    char v2 = *(char *)(v1 + (int32_t)cmp); // 0x8095172
    *(char *)(v1 + (int32_t)tst) = v2;
    v1++;
    while (v1 != len) {
        // 0x8095161
        v2 = *(char *)(v1 + (int32_t)cmp);
        *(char *)(v1 + (int32_t)tst) = v2;
        v1++;
    }
    // 0x809518d
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8095193 - 0x8095ae4
// Line range:    2221 - 2558
int32_t is_url(char * filename) {
    // 0x8095193
    if (filename == NULL || *filename == 0 || strchr(filename, 58) == NULL) {
        // 0x8095adf
        return 0;
    }
    char * str = LYSkipBlanks(filename); // 0x80951e9
    char v1 = *str; // 0x80951f4
    if (v1 != 58 != v1 != 47) {
        // 0x8095adf
        return (int32_t)NULL;
    }
    int32_t len = strlen(str); // 0x8095217
    int32_t v2 = (int32_t)*str; // 0x8095225
    g382 = v2 - 66;
    int32_t v3; // 0x8095193
    int32_t v4; // 0x8095193
    char * v5; // 0x80957b5
    switch (v2) {
        case 66: {
            goto lab_0x809572c;
        }
        case 68: {
            goto lab_0x809575b;
        }
        case 70: {
            goto lab_0x8095614;
        }
        case 76: {
            goto lab_0x8095244;
        }
        case 77: {
            goto lab_0x80955e5;
        }
        case 78: {
            goto lab_0x80954b0;
        }
        case 83: {
            goto lab_0x8095560;
        }
        case 98: {
            goto lab_0x809572c;
        }
        case 100: {
            goto lab_0x809575b;
        }
        case 102: {
            goto lab_0x8095614;
        }
        case 108: {
            goto lab_0x8095244;
        }
        case 109: {
            goto lab_0x80955e5;
        }
        case 110: {
            goto lab_0x80954b0;
        }
        case 115: {
            goto lab_0x8095560;
        }
        default: {
            int32_t v6 = (int32_t)str;
            v3 = v6;
            if (len < 3) {
                goto lab_0x8095806;
            } else {
                char * found_char_pos = strchr((char *)(v6 + 3), 58); // 0x80957a1
                if (found_char_pos == NULL) {
                    return (int32_t)(char *)LYCheckForProxyURL(filename);
                } else {
                    // 0x80957af
                    v4 = (int32_t)found_char_pos;
                    v5 = (char *)(v4 + 1);
                    if (*v5 != 47) {
                        goto lab_0x80957d3;
                    } else {
                        // 0x80957bc
                        if (*(char *)(v4 + 2) == 47) {
                            // 0x80957bc
                            v3 = (int32_t)str;
                            goto lab_0x8095806;
                        } else {
                            goto lab_0x80957d3;
                        }
                    }
                }
            }
        }
    }
  lab_0x809572c:;
    char * v7 = compare_type(str, "bibp:", 5) == 0 ? NULL : (char *)17; // 0x8095193
    goto lab_0x8095ac5;
  lab_0x809575b:
    // 0x809575b
    v7 = compare_type(str, "data:", 5) == 0 ? NULL : (char *)24;
    goto lab_0x8095ac5;
  lab_0x8095614:
    // 0x8095614
    if (compare_type(str, "file:", 5) == 0) {
        if (len < 6) {
            goto lab_0x8095acb;
        } else {
            int32_t v19 = (int32_t)str;
            if (*(char *)(v19 + 4) == 47) {
                // 0x8095699
                if (*(char *)(v19 + 5) == 47) {
                    // 0x80956a6
                    if (compare_type(str, "ftp:", 4) != 0) {
                        // 0x8095adf
                        return (int32_t)(char *)4;
                    }
                }
            }
            if (len < 9) {
                goto lab_0x8095acb;
            } else {
                int32_t v20 = (int32_t)str;
                if (*(char *)(v20 + 7) != 47) {
                    goto lab_0x8095acb;
                } else {
                    // 0x80956ec
                    if (*(char *)(v20 + 8) != 47) {
                        goto lab_0x8095acb;
                    } else {
                        // 0x80956fd
                        v7 = compare_type(str, "finger:", 7) == 0 ? NULL : (char *)18;
                        goto lab_0x8095ac5;
                    }
                }
            }
        }
    } else {
        // 0x809563a
        if (LYisLocalFile(str) != 0) {
            // 0x8095adf
            return (int32_t)(char *)3;
        }
        int32_t v21 = (int32_t)str; // 0x8095658
        if (*(char *)(v21 + 5) != 47) {
            goto lab_0x8095acb;
        } else {
            // 0x8095666
            v7 = *(char *)(v21 + 6) != 47 ? NULL : (char *)4;
            goto lab_0x8095ac5;
        }
    }
  lab_0x8095244:
    // 0x8095244
    if (compare_type(str, "lynxexec:", 9) != 0) {
        // 0x8095adf
        return (int32_t)(char *)26;
    }
    // 0x809526f
    if (compare_type(str, "lynxprog:", 9) != 0) {
        // 0x8095adf
        return (int32_t)(char *)27;
    }
    // 0x809529a
    if (compare_type(str, "lynxcgi:", 8) != 0) {
        // 0x8095adf
        return (int32_t)(char *)25;
    }
    // 0x80952c5
    if (compare_type(str, "LYNXPRINT:", 10) != 0) {
        // 0x8095adf
        return (int32_t)(char *)43;
    }
    // 0x80952f0
    if (compare_type(str, "LYNXOPTIONS:", 12) != 0) {
        // 0x8095adf
        return (int32_t)(char *)42;
    }
    // 0x809531b
    if (compare_type(str, "LYNXCFG:", 8) != 0) {
        // 0x8095adf
        return (int32_t)(char *)33;
    }
    // 0x8095346
    if (compare_type(str, "LYNXMESSAGES:", 13) != 0) {
        // 0x8095adf
        return (int32_t)(char *)41;
    }
    // 0x8095371
    if (compare_type(str, "LYNXCOMPILEOPTS:", 16) != 0) {
        // 0x8095adf
        return (int32_t)(char *)34;
    }
    // 0x809539c
    if (compare_type(str, "LYNXDOWNLOAD:", 13) != 0) {
        // 0x8095adf
        return (int32_t)(char *)37;
    }
    // 0x80953c7
    if (compare_type(str, "LYNXDIRED:", 10) != 0) {
        // 0x8095adf
        return (int32_t)(char *)36;
    }
    // 0x80953f2
    if (compare_type(str, "LYNXHIST:", 9) != 0) {
        // 0x8095adf
        return (int32_t)(char *)38;
    }
    // 0x809541d
    if (compare_type(str, "LYNXKEYMAP:", 11) != 0) {
        // 0x8095adf
        return (int32_t)(char *)40;
    }
    // 0x8095448
    if (compare_type(str, "LYNXIMGMAP:", 11) != 0) {
        // 0x8095467
        is_url((char *)((int32_t)str + 11));
        // 0x8095adf
        return (int32_t)(char *)39;
    }
    // 0x8095481
    v7 = compare_type(str, "LYNXCOOKIE:", 11) == 0 ? NULL : (char *)35;
    goto lab_0x8095ac5;
  lab_0x80955e5:
    // 0x80955e5
    v7 = compare_type(str, "mailto:", 7) == 0 ? NULL : (char *)16;
    goto lab_0x8095ac5;
  lab_0x80954b0:
    // 0x80954b0
    if (compare_type(str, "news:", 5) != 0) {
        // 0x8095adf
        return (int32_t)(char *)7;
    }
    // 0x80954db
    if (compare_type(str, "nntp:", 5) != 0) {
        // 0x8095adf
        return (int32_t)(char *)8;
    }
    // 0x8095506
    if (compare_type(str, "newspost:", 9) != 0) {
        // 0x8095adf
        return (int32_t)(char *)28;
    }
    // 0x8095531
    v7 = compare_type(str, "newsreply:", 10) == 0 ? NULL : (char *)29;
    goto lab_0x8095ac5;
  lab_0x8095560:
    // 0x8095560
    if (compare_type(str, "snews:", 6) != 0) {
        // 0x8095adf
        return (int32_t)(char *)21;
    }
    // 0x809558b
    if (compare_type(str, "snewspost:", 10) != 0) {
        // 0x8095adf
        return (int32_t)(char *)28;
    }
    // 0x80955b6
    v7 = compare_type(str, "snewsreply:", 11) == 0 ? NULL : (char *)29;
    goto lab_0x8095ac5;
  lab_0x8095806:;
    int32_t v22 = (int32_t)*str; // 0x809580c
    g390 = v22 - 65;
    switch (v22) {
        case 65: {
            goto lab_0x8095a77;
        }
        case 67: {
            goto lab_0x8095a4f;
        }
        case 71: {
            goto lab_0x8095885;
        }
        case 72: {
            goto lab_0x809582b;
        }
        case 80: {
            goto lab_0x8095a9f;
        }
        case 82: {
            goto lab_0x8095a27;
        }
        case 84: {
            goto lab_0x80959cd;
        }
        case 87: {
            goto lab_0x809599e;
        }
        case 97: {
            goto lab_0x8095a77;
        }
        case 99: {
            goto lab_0x8095a4f;
        }
        case 103: {
            goto lab_0x8095885;
        }
        case 104: {
            goto lab_0x809582b;
        }
        case 112: {
            goto lab_0x8095a9f;
        }
        case 114: {
            goto lab_0x8095a27;
        }
        case 116: {
            goto lab_0x80959cd;
        }
        case 119: {
            goto lab_0x809599e;
        }
        default: {
            goto lab_0x8095acb;
        }
    }
  lab_0x8095ac5:
    // 0x8095ac5
    if (v7 != NULL) {
        // 0x8095adf
        return (int32_t)v7;
    }
    goto lab_0x8095acb;
  lab_0x8095a77:;
    char * v8 = compare_type((char *)v3, "afs:", 4) == 0 ? NULL : (char *)23;
    v7 = v8;
    goto lab_0x8095ac5;
  lab_0x8095a4f:;
    char * v9 = compare_type((char *)v3, "cso:", 4) == 0 ? NULL : (char *)19;
    v7 = v9;
    goto lab_0x8095ac5;
  lab_0x8095885:
    // 0x8095885
    if (compare_type((char *)v3, "gopher:", 7) != 0) {
        // 0x80958a8
        if (strlen(str) < 11) {
            // 0x8095adf
            return (int32_t)(char *)12;
        }
        char * found_char_pos2 = strchr((char *)((int32_t)str + 11), 47); // 0x80958cd
        if (found_char_pos2 == NULL) {
            // 0x8095adf
            return (int32_t)(char *)12;
        }
        int16_t * v10 = *__ctype_b_loc(); // 0x80958e4
        char * v11 = (char *)((int32_t)found_char_pos2 + 1); // 0x80958ec
        unsigned char v12 = *v11; // 0x80958ec
        int32_t c = v12; // 0x80958ec
        char v13; // 0x8095193
        if ((*(int16_t *)(2 * c + (int32_t)v10) & 512) == 0) {
            // 0x8095921
            v13 = v12;
            if (v12 == 72) {
                // 0x8095adf
                return (int32_t)(char *)13;
            }
        } else {
            // 0x8095906
            if (toupper(c) == 72) {
                // 0x8095adf
                return (int32_t)(char *)13;
            }
            // 0x8095906
            v13 = *v11;
        }
        char v14 = v13; // 0x8095934
        if (v14 == 119) {
            // 0x8095adf
            return (int32_t)(char *)13;
        }
        char * v15 = (char *)14; // 0x8095952
        if (v14 != 84 == (v14 != 56)) {
            // 0x809596d
            v15 = v14 != 55 ? (char *)12 : (char *)15;
        }
        // 0x8095adf
        return (int32_t)v15;
    }
    goto lab_0x8095acb;
  lab_0x809582b:
    // 0x809582b
    if (compare_type((char *)v3, "http:", 5) != 0) {
        // 0x8095adf
        return (int32_t)(char *)2;
    }
    // 0x8095856
    v7 = compare_type(str, "https:", 6) == 0 ? NULL : (char *)20;
    goto lab_0x8095ac5;
  lab_0x8095a9f:;
    char * v16 = compare_type((char *)v3, "prospero:", 9) == 0 ? NULL : (char *)22;
    v7 = v16;
    goto lab_0x8095ac5;
  lab_0x8095a27:;
    char * v17 = compare_type((char *)v3, "rlogin:", 7) == 0 ? NULL : (char *)11;
    v7 = v17;
    goto lab_0x8095ac5;
  lab_0x80959cd:
    // 0x80959cd
    if (compare_type((char *)v3, "telnet:", 7) != 0) {
        // 0x8095adf
        return (int32_t)(char *)9;
    }
    // 0x80959f8
    v7 = compare_type(str, "tn3270:", 7) == 0 ? NULL : (char *)10;
    goto lab_0x8095ac5;
  lab_0x809599e:;
    char * v18 = compare_type((char *)v3, "wais:", 5) == 0 ? NULL : (char *)6;
    v7 = v18;
    goto lab_0x8095ac5;
  lab_0x8095acb:
    // 0x8095adf
    return (int32_t)(char *)LYCheckForProxyURL(filename);
  lab_0x80957d3:
    // 0x80957d3
    if (v4 - (int32_t)str < 2) {
        goto lab_0x8095acb;
    } else {
        // 0x80957e4
        v7 = LYisAbsPath(v5) == 0 ? NULL : (char *)5;
        goto lab_0x8095ac5;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8095ae4 - 0x8095b36
// Line range:    2567 - 2574
void LYFixCursesOn(char * reason) {
    // 0x8095ae4
    if (dump_output_immediately != 0 || LYCursesON != 0) {
        // 0x8095b34
        return;
    }
    // 0x8095b00
    if (reason != NULL && WWW_TraceFlag != 0) {
        // 0x8095b11
        fprintf(TraceFP(), "Forcing curses on to %s\n", reason);
    }
    // 0x8095b2f
    start_curses();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8095b36 - 0x8095cc6
// Line range:    2589 - 2621
char LYFixCursesOnForAccess(char * addr, char * physical) {
    // 0x8095b36
    if (dump_output_immediately != 0 || physical == NULL || LYCursesON != 0 || strstr(addr, "://") == NULL) {
        // 0x8095cc0
        return 0;
    }
    // 0x8095b7f
    if (strncasecomp(addr, "telnet:", 7) != 0) {
        // 0x8095ba2
        if (strncasecomp(addr, "rlogin:", 7) != 0) {
            // 0x8095bc1
            if (strncasecomp(addr, "tn3270:", 7) != 0) {
                // 0x8095be0
                if (strncasecomp(addr, "gopher:", 7) == 0) {
                    // 0x8095cc0
                    return 0;
                }
                char * found_char_pos = strchr((char *)((int32_t)addr + 11), 47); // 0x8095c14
                if (found_char_pos == NULL) {
                    // 0x8095cc0
                    return 0;
                }
                char v1 = *(char *)((int32_t)found_char_pos + 1); // 0x8095c2c
                if (v1 != 84 == (v1 != 56)) {
                    // 0x8095cc0
                    return 0;
                }
            }
        }
    }
    // 0x8095c40
    if (strncasecomp(physical, "telnet:", 7) == 0 || strncasecomp(physical, "rlogin:", 7) == 0) {
        // 0x8095cc0
        return 0;
    }
    char result = 0; // 0x8095c9b
    if (strncasecomp(physical, "tn3270:", 7) != 0) {
        // 0x8095c9d
        start_curses();
        HTAlert(gettext("Unexpected access protocol for this URL scheme."));
        result = 1;
    }
    // 0x8095cc0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8095cc6 - 0x8096004
// Line range:    2627 - 2699
char LYCanDoHEAD(char * address) {
    int32_t v1 = 0; // bp-8, 0x8095ccc
    if (address == NULL || *address == 0) {
        // 0x8095ffe
        return 0;
    }
    // 0x8095cec
    if (strncmp(address, "http", 4) == 0) {
        // 0x8095ffe
        return 1;
    }
    // 0x8095d14
    HTSACopy((char **)&v1, address);
    int32_t v2 = is_url((char *)v1); // 0x8095d2c
    if (v2 == 0) {
        // 0x8095d3a
        if (v1 != 0) {
            // 0x8095d41
            free((int32_t *)v1);
            v1 = 0;
        }
        // 0x8095ffe
        return 0;
    }
    char * v3 = (char *)v2; // 0x8095d31
    if (v3 == (char *)25) {
        // 0x8095d62
        if (v1 != 0) {
            // 0x8095d69
            free((int32_t *)v1);
            v1 = 0;
        }
        // 0x8095ffe
        return 1;
    }
    if (v3 != (char *)7 != v3 != (char *)8) {
        char * str = HTParse(address, (char *)&g25, 4); // 0x8095daa
        char * found_char_pos = strrchr(str, 47); // 0x8095dc0
        int32_t v4 = (int32_t)found_char_pos; // 0x8095dc0
        if (strchr((char *)(found_char_pos == NULL ? (int32_t)str : v4), 64) != NULL) {
            // 0x8095df3
            if (v1 != 0) {
                // 0x8095dfa
                free((int32_t *)v1);
                v1 = 0;
            }
            // 0x8095e0c
            if (str != NULL) {
                // 0x8095e12
                free((int32_t *)str);
            }
            // 0x8095ffe
            return 1;
        }
        if (found_char_pos != NULL) {
            int16_t * v5 = *__ctype_b_loc(); // 0x8095e38
            unsigned char v6 = *(char *)(v4 + 1); // 0x8095e40
            if ((*(int16_t *)(2 * (int32_t)v6 + (int32_t)v5) & 2048) != 0) {
                // 0x8095e5a
                if (strchr(found_char_pos, 45) == NULL) {
                    // 0x8095e71
                    if (v1 != 0) {
                        // 0x8095e78
                        free((int32_t *)v1);
                        v1 = 0;
                    }
                    // 0x8095e8a
                    if (str != NULL) {
                        // 0x8095e90
                        free((int32_t *)str);
                    }
                    // 0x8095ffe
                    return 1;
                }
            }
        }
        if (str != NULL) {
            // 0x8095eb1
            free((int32_t *)str);
        }
    }
    char * v7; // 0x8095cc6
    char * v8; // bp-24, 0x8095cc6
    if (v3 == (char *)3) {
        goto lab_0x8095fe1;
    } else {
        char * v9 = HTParse((char *)v1, (char *)&g25, 16); // 0x8095ee3
        v8 = v9;
        if (v9 == NULL) {
            goto lab_0x8095fe1;
        } else {
            // 0x8095ef6
            v7 = v9;
            if (*v9 == 0) {
                goto lab_0x8095fcf;
            } else {
                // 0x8095f04
                HTSACat(&v8, "_proxy");
                char * v10 = LYGetEnv(v8); // 0x8095f1d
                if (v10 == NULL) {
                    goto lab_0x8095fc8;
                } else {
                    // 0x8095f2f
                    if (strncasecomp(v10, "http:", 5) == 0) {
                        goto lab_0x8095f81;
                    } else {
                        char v11 = *v10; // 0x8095f51
                        if (v11 != 108 == (v11 != 76)) {
                            goto lab_0x8095fc8;
                        } else {
                            // 0x8095f62
                            if (strncasecomp(v10, "lynxcgi:", 8) != 0) {
                                goto lab_0x8095fc8;
                            } else {
                                goto lab_0x8095f81;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x8095fe1:
    // 0x8095fe1
    if (v1 != 0) {
        // 0x8095fe8
        free((int32_t *)v1);
        v1 = 0;
    }
    // 0x8095ffe
    return 0;
  lab_0x8095fcf:
    // 0x8095fcf
    free((int32_t *)v7);
    v8 = NULL;
    goto lab_0x8095fe1;
  lab_0x8095fc8:
    // 0x8095fc8
    v7 = v8;
    if (v8 == NULL) {
        goto lab_0x8095fe1;
    } else {
        goto lab_0x8095fcf;
    }
  lab_0x8095f81:
    // 0x8095f81
    if (override_proxy((char *)v1) == 0) {
        // 0x8095f90
        if (v1 != 0) {
            // 0x8095f97
            free((int32_t *)v1);
            v1 = 0;
        }
        // 0x8095fa9
        if (v8 != NULL) {
            // 0x8095fb0
            free((int32_t *)v8);
            v8 = NULL;
        }
        // 0x8095ffe
        return 1;
    }
    goto lab_0x8095fc8;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8096004 - 0x809603f
// Line range:    2705 - 2715
char LYCloseInput(struct _IO_FILE * fp) {
    if (fp != NULL) {
        int32_t is_ferror = ferror(fp); // 0x8096016
        fclose(fp);
        if (is_ferror == 0) {
            // 0x8096039
            return 1;
        }
    }
    // 0x8096039
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809603f - 0x809608e
// Line range:    2721 - 2732
char LYCloseOutput(struct _IO_FILE * fp) {
    if (fp != NULL) {
        int32_t is_ferror = ferror(fp); // 0x8096051
        fclose(fp);
        if (is_ferror == 0) {
            // 0x8096088
            return 1;
        }
    }
    // 0x8096070
    HTAlert(gettext("Cannot write to file."));
    // 0x8096088
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809608e - 0x80960e9
// Line range:    2738 - 2746
char LYCanWriteFile(char * filename) {
    struct _IO_FILE * v1 = fopen64(filename, "w"); // 0x80960a2
    char result; // 0x809608e
    if (LYCloseOutput(v1) == 0) {
        // 0x80960c4
        mustshow = 1;
        statusline(gettext("Enter a new filename: "));
        result = 0;
    } else {
        // 0x80960b3
        remove(filename);
        result = 1;
    }
    // 0x80960e3
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80960e9 - 0x8096135
// Line range:    2752 - 2761
char LYCanReadFile(char * filename) {
    // 0x80960e9
    if (filename == NULL || *filename == 0) {
        // 0x809612f
        return 0;
    }
    struct _IO_FILE * v1 = fopen64(filename, "r"); // 0x809610d
    char result = 0; // 0x8096119
    if (v1 != NULL) {
        // 0x809611b
        result = LYCloseInput(v1);
    }
    // 0x809612f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8096135 - 0x809619a
// Line range:    2767 - 2783
void remove_backslashes(char * buf) {
    char v1 = *buf; // 0x809618b
    if (v1 == 0) {
        // 0x8096192
        *buf = 0;
        return;
    }
    char * v2; // 0x8096135
    char * v3; // 0x8096135
    char * v4; // 0x8096135
    if (v1 == 92) {
        // 0x8096168
        v4 = (char *)((int32_t)buf + 1);
        v2 = v4;
        v3 = buf;
        if (*v4 == 92) {
            // 0x8096175
            *buf = 92;
            v2 = v4;
            v3 = (char *)((int32_t)buf + 1);
        }
    } else {
        // 0x809614d
        *buf = v1;
        v2 = (char *)((int32_t)buf + 1);
        v3 = (char *)((int32_t)buf + 1);
    }
    char * v5 = v3;
    char * v6 = v2;
    char v7 = *v6; // 0x809618b
    while (v7 != 0) {
        char * v8 = v5;
        char * v9 = v6;
        char v10 = v7;
        if (v10 == 92) {
            // 0x8096168
            v4 = (char *)((int32_t)v9 + 1);
            v2 = v4;
            v3 = v8;
            if (*v4 == 92) {
                // 0x8096175
                *v8 = 92;
                v2 = v4;
                v3 = (char *)((int32_t)v8 + 1);
            }
        } else {
            // 0x809614d
            *v8 = v10;
            v2 = (char *)((int32_t)v9 + 1);
            v3 = (char *)((int32_t)v8 + 1);
        }
        // 0x8096184
        v5 = v3;
        v6 = v2;
        v7 = *v6;
    }
    // 0x8096192
    *v5 = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809619a - 0x80963ae
// Line range:    2790 - 2833
char inlocaldomain(void) {
    int32_t v1 = __readgsdword(20); // 0x80961a4
    char * v2 = ttyname(0); // 0x80961ca
    char v3; // 0x809619a
    if (v2 == NULL) {
        goto lab_0x8096339;
    } else {
        char * v4 = LYLastPathSep(v2); // 0x80961e7
        if (v4 == NULL) {
            goto lab_0x8096339;
        } else {
            struct _IO_FILE * stream = fopen64("/var/run/utmp", "r"); // 0x8096218
            if (stream == NULL) {
                goto lab_0x8096339;
            } else {
                // 0x8096230
                int32_t data; // bp-396, 0x809619a
                while (fread(&data, 384, 1, stream) >= 1) {
                    // 0x809626e
                    int32_t str; // bp-388, 0x809619a
                    if (strcmp((char *)&str, (char *)((int32_t)v4 + 1)) == 0) {
                        // 0x80962a8
                        LYCloseInput(stream);
                        int32_t str2; // bp-320, 0x809619a
                        if (strlen((char *)&str2) > strlen((char *)LYLocalDomain)) {
                            int32_t len = strlen((char *)&str2); // 0x80962d8
                            int32_t len2 = strlen((char *)LYLocalDomain); // 0x80962e7
                            int32_t strcmp_rc = strcmp((char *)LYLocalDomain, (char *)(len + (int32_t)&str2 - len2)); // 0x8096308
                            v3 = 1;
                            if (strcmp_rc != 0) {
                                // 0x809631d
                                v3 = (char)str2 == 0;
                                goto lab_0x809638e;
                            } else {
                                goto lab_0x809638e;
                            }
                        } else {
                            // 0x809631d
                            v3 = (char)str2 == 0;
                            goto lab_0x809638e;
                        }
                    }
                }
                // 0x809628d
                LYCloseInput(stream);
                v3 = 0;
                goto lab_0x809638e;
            }
        }
    }
  lab_0x8096339:
    // 0x8096339
    v3 = 0;
    if (WWW_TraceFlag != 0) {
        char * v5 = v2 == NULL ? "(null)" : v2;
        fprintf(TraceFP(), "Could not get ttyname (returned %s) or open UTMP file %s\n", v5, "/var/run/utmp");
        v3 = 0;
    }
    goto lab_0x809638e;
  lab_0x809638e:;
    char result = v3; // 0x809639e
    if (v1 != __readgsdword(20)) {
        // 0x80963a0
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80963a5
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80963ae - 0x809642d
// Line range:    2844 - 2861
void LYExtSignal(int32_t sig, void (*handler)(int32_t)) {
    // 0x80963ae
    if (sig != 28 || LYNonRestartingSIGWINCH == 0) {
        // 0x8096419
        signal(sig, handler);
    } else {
        // 0x80963c8
        void (*act)(int32_t); // bp-144, 0x80963ae
        *(int32_t *)&act = (int32_t)handler;
        int32_t set; // bp-140, 0x80963ae
        sigemptyset((struct _TYPEDEF_sigset_t *)&set);
        sigaction(sig, (struct sigaction *)&act, NULL);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809642d - 0x8096549
// Line range:    2884 - 2907
char LYToggleSigDfl(int32_t sig, struct sigaction * where, int32_t to_dfl) {
    int32_t v1; // 0x809642d
    if (to_dfl != 1) {
        // 0x80964cf
        v1 = sigaction(sig, where, NULL);
    } else {
        // 0x8096448
        int32_t oact; // bp-152, 0x809642d
        int32_t v2 = sigaction(sig, NULL, (struct sigaction *)&oact); // 0x8096460
        v1 = v2;
        if (v2 == 0) {
            // 0x809646e
            if (oact == 0) {
                // 0x80964a3
                v1 = v2;
                if (where != NULL) {
                    // 0x80964ec
                    memcpy((int32_t *)where, &oact, 140);
                    // 0x8096539
                    return 1;
                }
            } else {
                // 0x8096478
                oact = 0;
                v1 = sigaction(sig, (struct sigaction *)&oact, where);
            }
        }
    }
    // 0x80964ec
    if (v1 == 0) {
        // 0x8096539
        return 1;
    }
    // 0x80964f2
    if (WWW_TraceFlag != 0) {
        char * err_str = strerror(*__errno_location()); // 0x8096507
        fprintf(TraceFP(), "Error in LYToggleSigDfl: %s\n", err_str);
    }
    // 0x8096539
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8096549 - 0x809664c
// Line range:    2936 - 3029
void size_change(int32_t sig) {
    // 0x8096549
    int16_t v1; // 0x8096549
    uint16_t v2 = v1;
    int32_t v3 = LYlines; // 0x8096551
    int32_t v4 = LYcols; // 0x8096559
    if (ioctl(0, 0x5413) == 0) {
        int32_t v5; // 0x8096549
        if ((int16_t)v5 != 0) {
            // 0x8096589
            LYlines = v5 % 0x10000;
        }
        if (v2 != 0) {
            // 0x809659e
            LYcols = v2;
        }
    }
    int32_t v6 = LYlines; // 0x80965aa
    int32_t v7 = v6; // 0x80965b1
    if (v6 >= 0 != v6 != 0) {
        // 0x80965b3
        LYlines = 24;
        v7 = 24;
    }
    int32_t v8 = LYcols; // 0x80965bd
    int32_t v9 = v8; // 0x80965c4
    if (v8 >= 0 != v8 != 0) {
        // 0x80965c6
        LYcols = 80;
        v9 = 80;
    }
    // 0x80965d0
    if (v7 == v3 == v9 == v4) {
        // 0x8096631
        LYExtSignal(28, (void (*)(int32_t))0x8096549);
        return;
    }
    // 0x80965e4
    recent_sizechange = 1;
    if (WWW_TraceFlag != 0) {
        // 0x80965f6
        fprintf(TraceFP(), "Window size changed from (%d,%d) to (%d,%d)\n", v3, v4, v7, v9);
    }
    // 0x8096631
    LYExtSignal(28, (void (*)(int32_t))0x8096549);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809666b - 0x8096767
// Line range:    3045 - 3075
void HTAddSugFilename(char * fname) {
    char * str2 = NULL; // bp-8, 0x8096671
    if (fname == NULL || *fname == 0) {
        // 0x8096765
        return;
    }
    // 0x8096690
    HTSACopy(&str2, fname);
    if (sug_filenames == NULL) {
        int32_t * v1 = HTList_new(); // 0x80966ab
        *(int32_t *)&sug_filenames = (int32_t)v1;
        HTList_addObject(v1, str2);
        // 0x8096765
        return;
    }
    char * v2 = (char *)sug_filenames; // 0x80966d7
    while (v2 != NULL) {
        int32_t v3 = *(int32_t *)((int32_t)v2 + 4); // 0x8096727
        if (v3 == 0) {
            // break -> 0x8096750
            break;
        }
        int32_t v4 = *(int32_t *)v3; // 0x8096736
        if (v4 == 0) {
            // break -> 0x8096750
            break;
        }
        char * str = (char *)v4;
        v2 = (char *)v3;
        if (strcmp(str, str2) == 0) {
            // 0x809670a
            HTList_removeObject(sug_filenames, str);
            free((int32_t *)v4);
            goto lab_0x8096750;
        }
    }
  lab_0x8096750:
    // 0x8096750
    HTList_addObject(sug_filenames, str2);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8096767 - 0x8096a7d
// Line range:    3082 - 3363
void change_sug_filename(char * fname) {
    char * cp2_ = NULL; // bp-16, 0x809676e
    int32_t len = strlen(fname); // 0x809677b
    HTUnEscape(fname);
    char * v1 = wwwName((char *)lynx_temp_space); // 0x8096799
    int32_t pid = getpid();
    if (*v1 != 47) {
        // 0x80967d0
        HTSprintf0(&cp2_, "file://localhost/%s%u", v1, pid);
    } else {
        // 0x80967ab
        HTSprintf0(&cp2_, "file://localhost%s%u", v1, pid);
    }
    // 0x80967f3
    char * v2; // 0x8096767
    char * cp2; // bp-20, 0x8096767
    if (strncmp(fname, cp2_, strlen(cp2_)) != 0) {
        goto lab_0x80968a1;
    } else {
        char * found_char_pos = strrchr(fname, 46); // 0x809682a
        cp2 = found_char_pos;
        if (strlen(found_char_pos) > strlen(cp2_) - 4) {
            // 0x8096858
            cp2 = NULL;
            // 0x8096866
            v2 = (char *)&g25;
            goto lab_0x809686d;
        } else {
            // 0x8096858
            v2 = cp2;
            if (cp2 == NULL) {
                // 0x8096866
                v2 = (char *)&g25;
                goto lab_0x809686d;
            } else {
                goto lab_0x809686d;
            }
        }
    }
  lab_0x80968a1:
    // 0x80968a1
    if (cp2_ != NULL) {
        // 0x80968a8
        free((int32_t *)cp2_);
        cp2_ = NULL;
    }
    int32_t v3 = (int32_t)fname;
    int32_t len2 = strlen(fname); // 0x80968c0
    int32_t v4 = v3 - 1;
    int32_t v5 = v3; // 0x80968d0
    char * str = fname; // 0x80968d0
    if (*(char *)(v4 + len2) == 47) {
        // 0x80968d2
        *(char *)(v4 + strlen(fname)) = 0;
        v5 = (int32_t)fname;
        str = fname;
    }
    char * found_char_pos2 = strrchr(str, 47); // 0x80968f4
    cp2 = found_char_pos2;
    if (found_char_pos2 != NULL) {
        // 0x8096902
        if (strlen(found_char_pos2) >= 2) {
            char * v6 = (char *)((int32_t)cp2 + 1); // 0x8096918
            cp2 = v6;
            char v7 = *v6; // 0x8096934
            char * v8 = (char *)v5;
            char * v9 = v8; // 0x8096939
            char v10 = v7; // 0x8096939
            char * v11 = v8; // 0x8096939
            if (v7 != 0) {
                *v9 = v10;
                char * v12 = (char *)((int32_t)cp2 + 1); // 0x8096929
                cp2 = v12;
                char * v13 = (char *)((int32_t)v9 + 1);
                char v14 = *v12; // 0x8096934
                v9 = v13;
                v11 = v13;
                while (v14 != 0) {
                    // 0x809691e
                    *v9 = v14;
                    v12 = (char *)((int32_t)cp2 + 1);
                    cp2 = v12;
                    v13 = (char *)((int32_t)v9 + 1);
                    v14 = *v12;
                    v9 = v13;
                    v11 = v13;
                }
            }
            // 0x809693b
            *v11 = 0;
        }
    }
    int32_t v15 = len + v3; // 0x8096780
    if (*(char *)(v15 - 1) == 93) {
        char * found_char_pos3 = strrchr(fname, 91); // 0x809695c
        cp2 = found_char_pos3;
        if (found_char_pos3 > fname) {
            char * v16 = (char *)((int32_t)found_char_pos3 - 1); // 0x8096972
            cp2 = v16;
            char * v17 = v16; // 0x809697e
            if (*v16 == 32) {
                *v17 = 0;
                char * v18 = (char *)((int32_t)cp2 - 1); // 0x8096988
                cp2 = v18;
                while (*v18 == 32) {
                    // 0x8096982
                    *v18 = 0;
                    v18 = (char *)((int32_t)cp2 - 1);
                    cp2 = v18;
                }
            }
        }
    }
    char * found_char_pos4 = strchr(fname, 91); // 0x80969a4
    cp2 = found_char_pos4;
    int32_t v19 = (int32_t)fname;
    char * v20 = fname; // 0x80969b0
    int32_t v21 = v19; // 0x80969b0
    if (found_char_pos4 != NULL) {
        char * found_char_pos5 = strrchr(found_char_pos4, 93); // 0x80969c0
        v20 = fname;
        v21 = v19;
        if (found_char_pos5 != NULL) {
            // 0x80969ce
            v20 = fname;
            v21 = v19;
            if (strlen(found_char_pos5) >= 2) {
                char * v22 = (char *)((int32_t)found_char_pos5 + 1); // 0x80969de
                *(int32_t *)&cp2 = v19;
                char v23 = *v22; // 0x8096a00
                char * v24 = v22; // 0x8096a05
                char v25 = v23; // 0x8096a05
                char * v26 = fname; // 0x8096a05
                if (v23 != 0) {
                    *fname = v25;
                    char * v27 = (char *)((int32_t)cp2 + 1);
                    cp2 = v27;
                    char * v28 = (char *)((int32_t)v24 + 1); // 0x80969f9
                    char v29 = *v28; // 0x8096a00
                    v24 = v28;
                    v26 = v27;
                    while (v29 != 0) {
                        // 0x80969ea
                        *v27 = v29;
                        v27 = (char *)((int32_t)cp2 + 1);
                        cp2 = v27;
                        v28 = (char *)((int32_t)v24 + 1);
                        v29 = *v28;
                        v24 = v28;
                        v26 = v27;
                    }
                }
                // 0x8096a07
                *v26 = 0;
                v20 = fname;
                v21 = (int32_t)fname;
            }
        }
    }
    // 0x8096a0d
    *(int32_t *)&cp2 = v21;
    char * v30 = (char *)v21;
    char v31 = *v30; // 0x8096a4b
    char * v32 = v30; // 0x8096a50
    char v33 = v31; // 0x8096a50
    char * v34 = v20; // 0x8096a50
    if (v31 != 0) {
        char * v35 = v32;
        uint32_t v36 = (int32_t)v33 - 32; // 0x8096a1e
        char * v37 = v35; // 0x8096a28
        if (v33 == 47 || v36 < 15) {
            // 0x8096a2a
            v37 = v35;
            if ((1 << v36 % 32 & 0x8085) != 0) {
                // 0x8096a3e
                *v35 = 45;
                v37 = cp2;
            }
        }
        char * v38 = (char *)((int32_t)v37 + 1); // 0x8096a44
        cp2 = v38;
        char v39 = *v38; // 0x8096a4b
        v33 = v39;
        while (v39 != 0) {
            // 0x8096a15
            v35 = v38;
            v36 = (int32_t)v33 - 32;
            v37 = v35;
            if (v33 == 47 || v36 < 15) {
                // 0x8096a2a
                v37 = v35;
                if ((1 << v36 % 32 & 0x8085) != 0) {
                    // 0x8096a3e
                    *v35 = 45;
                    v37 = cp2;
                }
            }
            // 0x8096a44
            v38 = (char *)((int32_t)v37 + 1);
            cp2 = v38;
            v39 = *v38;
            v33 = v39;
        }
        // 0x8096a48
        v34 = fname;
    }
    char * v40 = (char *)v15; // 0x8096783
    char * str2 = v34;
    char * v41 = (char *)(strlen(str2) + (int32_t)str2);
    cp2 = v41;
    if (v40 <= v41) {
        // 0x8096a77
        return;
    }
    *v41 = 0;
    char * v42 = (char *)((int32_t)cp2 + 1);
    cp2 = v42;
    while (v40 > v42) {
        // 0x8096a65
        *v42 = 0;
        v42 = (char *)((int32_t)cp2 + 1);
        cp2 = v42;
    }
  lab_0x809686d:
    // 0x809686d
    HTSACopy(&cp2_, v2);
    sprintf(fname, "temp%.*s", 246, cp2_);
    goto lab_0x80968a1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8096a7d - 0x8096d73
// Line range:    3371 - 3462
int32_t fmt_tempname(char * result, char * prefix, char * suffix) {
    char leaf2[256]; // bp-276, 0x8096a7d
    char leaf[256]; // bp-280, 0x8096a7d
    char v1[256]; // 0x8096a7d
    char v2[256]; // 0x8096bbd
    int32_t v3 = __readgsdword(20); // 0x8096aa2
    if (g107 != 0) {
        // 0x8096ade
        srandom(time(NULL) + (int32_t)result);
        g107 = 0;
    }
    // 0x8096aff
    g283 = 0x2710;
    char * v4; // 0x8096c55
    if (g285 > 0x270f) {
        // 0x8096c4e
        v4 = gettext("Too many tempfiles");
        HTAlert(v4);
        goto lab_0x8096c62;
    } else {
        int64_t v5 = 0x100000000 * (int64_t)(4.65661287307739257813e-10L * 1.0e+4L * (float80_t)random() + 1.0L) >> 32; // 0x8096b6e
        uint32_t v6 = -0x2710 * (int32_t)(0xd1b71759 * (v5 & 0xffffffff) / 0x200000000000) + (int32_t)v5; // 0x8096ba2
        g283 = v6;
        v2[0] = v6 / 8;
        leaf = v2;
        int32_t v7 = 1 << v6 % 8;
        char * v8 = (char *)(*(int32_t *)&leaf + (int32_t)&g284);
        if ((v7 & (int32_t)*v8) == 0) {
            // 0x8096bf4
            g285++;
            *v8 = *v8 | (char)v7;
        }
        // 0x8096c42
        if (g285 < 0x2710) {
            goto lab_0x8096c62;
        } else {
            // 0x8096c4e
            v4 = gettext("Too many tempfiles");
            HTAlert(v4);
            goto lab_0x8096c62;
        }
    }
  lab_0x8096c62:;
    char * v9 = suffix != NULL ? suffix : (char *)&g25;
    int32_t pid = getpid(); // 0x8096c68
    int32_t str; // bp-272, 0x8096a7d
    sprintf((char *)&str, "L%u-%uTMP%s", pid, (int32_t)g283, v9);
    char * str2 = prefix != NULL ? prefix : (char *)&g25; // 0x8096c9d
    if (strlen((char *)&str) + strlen(str2) < 256) {
        // 0x8096cbf
        sprintf(result, "%s%s", str2, &str);
        v1 = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    } else {
        // 0x8096cf5
        sprintf(result, "%.*s", 255, &str);
        v1 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    }
    // 0x8096d27
    leaf2 = v1;
    if (WWW_TraceFlag != 0) {
        // 0x8096d32
        fprintf(TraceFP(), "-> '%s'\n", result);
    }
    int32_t result2 = *(int32_t *)&leaf2; // 0x8096d63
    if (v3 != __readgsdword(20)) {
        // 0x8096d65
        __stack_chk_fail();
        result2 = &g391;
    }
    // 0x8096d6a
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8096de8 - 0x8096e6b
// Line range:    3618 - 3639
char strn_dash_equ(char * p1, char * p2, int32_t len) {
    int32_t v1 = len; // 0x8096e5f
    char * v2 = p1; // 0x8096e5f
    if (len == 0) {
        // 0x8096e65
        return 1;
    }
    char * v3 = p2; // 0x8096e5f
    char v4 = *v3;
    char result = 0; // 0x8096df8
    while (v4 != 0) {
        char v5 = *v2; // 0x8096e03
        switch (v5) {
            case 95: {
            }
            case 45: {
                // 0x8096e24
                if (v4 != 95) {
                    // break -> 0x8096e65
                    break;
                }
                // break -> 0x8096e4a
                break;
            }
            default: {
                // 0x8096e18
                if (v5 == v4 != v5 != 0) {
                    // break -> 0x8096e65
                    break;
                }
                // break -> 0x8096e4a
                break;
            }
        }
        // 0x8096e4a
        v1--;
        v2 = (char *)((int32_t)v2 + 1);
        v3 = (char *)((int32_t)v3 + 1);
        result = 1;
        if (v1 == 0) {
            // break -> 0x8096e65
            break;
        }
        v4 = *v3;
        result = 0;
    }
    // 0x8096e65
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8096f26 - 0x809712b
// Line range:    3685 - 3742
void parse_restrictions(char * s) {
    char * v1 = s; // 0x80970f8
    int32_t v2; // 0x8096f26
    char * v3; // 0x8096f26
    char * v4; // 0x8096f3e
    int32_t v5; // 0x8096f26
    if (*s != 0) {
        while (true) {
          lab_0x8096f38:
            // 0x8096f38
            v4 = LYSkipCBlanks(v1);
            v5 = (int32_t)v4;
            int32_t v6 = v5; // 0x8096f26
            v3 = v4;
            v2 = v5;
            switch (*v4) {
                case 0: {
                    goto lab_0x80970fe_3;
                }
                case 44: {
                    goto lab_0x8096f74;
                }
                default: {
                    int32_t v7 = v6 + 1; // 0x8096f5c
                    char * v8 = (char *)v7;
                    char v9 = *v8; // 0x8096f63
                    v6 = v7;
                    v3 = v8;
                    v2 = v7;
                    while (v9 != 44 == (v9 != 0)) {
                        // 0x8096f5c
                        v7 = v6 + 1;
                        v8 = (char *)v7;
                        v9 = *v8;
                        v6 = v7;
                        v3 = v8;
                        v2 = v7;
                    }
                    goto lab_0x8096f74;
                }
            }
        }
    }
  lab_0x80970fe_3:
    // 0x80970fe
    if (no_shell != 0) {
        // 0x8097109
        no_goto_lynxexec = 1;
        no_goto_lynxprog = 1;
        no_goto_lynxcgi = 1;
        local_exec_on_local_files = 1;
    }
  lab_0x8096f74:;
    char * v10 = v3;
    if (strn_dash_equ(v4, "all", v2 - v5) == 0) {
        int32_t v11 = (int32_t)v10 - v5;
        if (strn_dash_equ(v4, "default", v11) == 0) {
            int32_t v12 = (int32_t)NULL; // 0x809704f
            int32_t v13 = 12 * v12; // 0x8097058
            int32_t v14 = *(int32_t *)(v13 + (int32_t)&restrictions); // 0x809705b
            while (strn_dash_equ(v4, (char *)v14, v11) == 0) {
                char * v15 = (char *)(v12 + 1); // 0x8097093
                if (v15 > (char *)57) {
                    // 0x80970a3
                    printf("%s: %.*s\n", gettext("unknown restriction"), v11, v4);
                    exit_immediately(1);
                    // UNREACHABLE
                }
                v12 = (int32_t)v15;
                v13 = 12 * v12;
                v14 = *(int32_t *)(v13 + (int32_t)&restrictions);
            }
            // 0x8097078
            *(char *)*(int32_t *)(v13 + (int32_t)&g27) = 1;
        } else {
            int32_t v16 = (int32_t)(char *)2; // 0x8097004
            int32_t v17 = 12 * v16; // 0x809700d
            int32_t v18 = *(int32_t *)(v17 + (int32_t)&g27); // 0x8097010
            char v19 = *(char *)(v17 + (int32_t)&g28); // 0x8097022
            *(char *)v18 = (char)(v19 == 0);
            char * v20 = (char *)(v16 + 1); // 0x8097030
            while (v20 <= (char *)57) {
                // 0x8097004
                v16 = (int32_t)v20;
                v17 = 12 * v16;
                v18 = *(int32_t *)(v17 + (int32_t)&g27);
                v19 = *(char *)(v17 + (int32_t)&g28);
                *(char *)v18 = (char)(v19 == 0);
                v20 = (char *)(v16 + 1);
            }
        }
    } else {
        int32_t v21 = (int32_t)(char *)2; // 0x8096fac
        *(char *)*(int32_t *)(12 * v21 + (int32_t)&g27) = 1;
        char * v22 = (char *)(v21 + 1); // 0x8096fc1
        while (v22 <= (char *)57) {
            // 0x8096fac
            v21 = (int32_t)v22;
            *(char *)*(int32_t *)(12 * v21 + (int32_t)&g27) = 1;
            v22 = (char *)(v21 + 1);
        }
    }
    // 0x80970e2
    if (*v10 == 0) {
        // break -> 0x80970fe
        goto lab_0x80970fe_3;
    }
    // 0x80970f0
    v1 = (char *)((int32_t)v10 + 1);
    if (*v1 == 0) {
        // break -> 0x80970fe
        goto lab_0x80970fe_3;
    }
    goto lab_0x8096f38;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809723d - 0x80973b3
// Line range:    3862 - 3901
void LYCheckMail(void) {
    // 0x809723d
    int32_t v1; // 0x809723d
    int32_t v2 = v1;
    if (g108 != 0) {
        // 0x8097251
        g289 = (int32_t)LYGetEnv("MAIL");
        g108 = 0;
        time(&g287);
    }
    // 0x8097275
    if (g289 == 0) {
        // 0x80973b1
        return;
    }
    // 0x8097282
    int32_t t; // bp-8, 0x809723d
    time(&t);
    if (t - g288 < 60) {
        // 0x80973b1
        return;
    }
    // 0x80972a4
    g288 = t;
    int32_t v3; // bp-104, 0x809723d
    if ((v1 & 0xf000) == 0x8000 != stat64(g289, &v3) > -1) {
        // 0x80972d4
        g289 = 0;
        // 0x80973b1
        return;
    }
    if (v1 < 0) {
        // 0x80973b1
        return;
    }
    if (v1 == 0 == v1 == 0) {
        // 0x80973b1
        return;
    }
    // 0x8097318
    char * v4; // 0x8097372
    if (v2 > v1 == (v2 != g287)) {
        // 0x809736b
        v4 = gettext("*** You have new mail. ***");
        HTUserMsg(v4);
        // 0x80973b1
        return;
    }
    // 0x809732e
    if (g286 == 0) {
        // 0x809738a
        HTUserMsg(gettext("*** You have mail. ***"));
        // 0x80973b1
        return;
    }
    int32_t v5 = g286 >> 31; // 0x809734d
    if (v1 < v5) {
        // 0x80973b1
        return;
    }
    if (v1 > g286 || v1 > v5) {
        // 0x809736b
        v4 = gettext("*** You have new mail. ***");
        HTUserMsg(v4);
        // 0x80973b1
        return;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80973b3 - 0x8097533
// Line range:    3919 - 3949
void LYEnsureAbsoluteURL(char ** href, char * name, int32_t fixit) {
    char * v1 = *href; // 0x80973c3
    if (v1 == NULL || *v1 == 0) {
        // 0x8097531
        return;
    }
    // 0x80973dd
    LYFillLocalFileURL(href, "file://localhost");
    if (strcasecomp(*href, "news:") != 0) {
        // 0x809741e
        if (strcasecomp(*href, "snews:") == 0) {
            // 0x8097437
            HTSACat(href, "/*");
        }
    } else {
        // 0x8097409
        HTSACat(href, "*");
    }
    // 0x809744a
    if (is_url(*href) == 0) {
        // 0x809745b
        if (WWW_TraceFlag != 0) {
            char * v2 = name == NULL ? (char *)&g25 : (char *)&g26;
            char * v3 = name == NULL ? (char *)&g25 : name;
            fprintf(TraceFP(), "%s%s'%s' is not a URL\n", v3, v2, *href);
        }
        // 0x80974c5
        LYConvertToURL(href, fixit);
    }
    char * v4 = HTParse(*href, (char *)&g25, 31); // 0x80974ef
    if (v4 == NULL) {
        // 0x8097531
        return;
    }
    // 0x80974fd
    if (*v4 != 0) {
        // 0x8097507
        HTSACopy(href, v4);
    }
    // 0x809751f
    free((int32_t *)v4);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8097533 - 0x8098073
// Line range:    3958 - 4432
void LYConvertToURL(char ** AllocatedString, int32_t fixit) {
    int32_t v1 = __readgsdword(20); // 0x8097547
    char * v2 = *AllocatedString;
    char * str; // bp-280, 0x8097533
    *(int32_t *)&str = (int32_t)v2;
    char * old_string = NULL; // bp-284, 0x8097560
    char * old_string2 = NULL; // bp-288, 0x809756a
    char * cp; // bp-296, 0x8097533
    int32_t str2; // bp-272, 0x8097533
    int32_t v3; // bp-300, 0x8097533
    if (v2 == NULL) {
        goto lab_0x8098058;
    } else {
        // 0x8097582
        if (*v2 == 0) {
            goto lab_0x8098058;
        } else {
            // 0x8097593
            *(int32_t *)AllocatedString = 0;
            HTSACopy(AllocatedString, "file://localhost");
            char * v4 = str; // 0x80975b5
            char v5 = *v4; // 0x80975bb
            int32_t v6; // bp-396, 0x8097533
            if (v5 == 47) {
                int32_t v7 = (int32_t)v4; // 0x8097d49
                if (*(char *)(v7 + 1) != 0) {
                    // 0x8097d74
                    if (stat64(v7, &v6) >= 0) {
                        goto lab_0x8097da6;
                    } else {
                        // 0x8097d90
                        if (LYCanReadFile(str) == 0) {
                            char * v8 = str; // 0x8097ebb
                            if (*(char *)((int32_t)v8 + 1) != 126) {
                                // 0x8097f7d
                                HTSACopy(&old_string, v8);
                                LYTrimRelFromAbsPath(old_string);
                                HTSACat(AllocatedString, old_string);
                                if (old_string != NULL) {
                                    // 0x8097fc5
                                    free((int32_t *)old_string);
                                    old_string = NULL;
                                }
                            } else {
                                char * v9 = Home_Dir(); // 0x8097ecf
                                HTSACat(AllocatedString, wwwName(v9));
                                char * found_char_pos = strchr((char *)((int32_t)str + 1), 47); // 0x8097f02
                                old_string2 = found_char_pos;
                                if (found_char_pos != NULL) {
                                    // 0x8097f1b
                                    HTSACopy(&old_string, found_char_pos);
                                    LYTrimRelFromAbsPath(old_string);
                                    HTSACat(AllocatedString, old_string);
                                    if (old_string != NULL) {
                                        // 0x8097f63
                                        free((int32_t *)old_string);
                                        old_string = NULL;
                                    }
                                }
                            }
                            goto lab_0x8097fdd;
                        } else {
                            goto lab_0x8097da6;
                        }
                    }
                } else {
                    // 0x8097d59
                    HTSACat(AllocatedString, "/");
                    goto lab_0x8097fdd;
                }
            } else {
                if (v5 != 126) {
                    // 0x80976c7
                    cp = NULL;
                    Current_Dir((char *)&str2);
                    HTSACopy(&old_string, (char *)&str2);
                    HTSACat(&old_string, "/");
                    HTSACat(&old_string, str);
                    LYTrimRelFromAbsPath(old_string);
                    if (WWW_TraceFlag != 0) {
                        // 0x8097745
                        fprintf(TraceFP(), "Converted '%s' to '%s'\n", str, old_string);
                    }
                    // 0x8097770
                    if (stat64((int32_t)old_string, &v6) >= 0) {
                        goto lab_0x80977a2;
                    } else {
                        // 0x809778c
                        if (LYCanReadFile(old_string) == 0) {
                            // 0x809783c
                            v3 = 0;
                        } else {
                            goto lab_0x80977a2;
                        }
                    }
                } else {
                    char * v10 = Home_Dir(); // 0x80975e1
                    HTSACat(AllocatedString, wwwName(v10));
                    char * found_char_pos2 = strchr(str, 47); // 0x8097611
                    old_string2 = found_char_pos2;
                    if (found_char_pos2 != NULL) {
                        // 0x8097626
                        HTSACopy(&old_string, found_char_pos2);
                        LYTrimRelFromAbsPath(old_string);
                        HTSACat(AllocatedString, old_string);
                        if (old_string != NULL) {
                            // 0x809766e
                            free((int32_t *)old_string);
                            old_string = NULL;
                        }
                    }
                    // 0x8097686
                    if (WWW_TraceFlag != 0) {
                        // 0x8097695
                        fprintf(TraceFP(), "Converted '%s' to '%s'\n", str, *AllocatedString);
                    }
                    goto lab_0x8098015;
                }
            }
        }
    }
  lab_0x8098058:
    // 0x8098058
    if (v1 != __readgsdword(20)) {
        // 0x8098064
        __stack_chk_fail();
    }
  lab_0x8097da6:
    // 0x8097da6
    HTSACopy(&old_string, str);
    LYTrimRelFromAbsPath(old_string);
    if (WWW_TraceFlag != 0) {
        // 0x8097dd7
        fprintf(TraceFP(), "Converted '%s' to '%s'\n", str, old_string);
    }
    char * v11 = HTEscape(old_string, 4); // 0x8097e13
    old_string2 = v11;
    HTSACat(AllocatedString, v11);
    if (old_string2 != NULL) {
        // 0x8097e40
        free((int32_t *)old_string2);
        old_string2 = NULL;
    }
    // 0x8097e58
    if (old_string != NULL) {
        // 0x8097e62
        free((int32_t *)old_string);
        old_string = NULL;
    }
    // 0x8097e7a
    if (WWW_TraceFlag == 0) {
        goto lab_0x8098015;
    } else {
        // 0x8097e89
        fprintf(TraceFP(), "Converted '%s' to '%s'\n", str, *AllocatedString);
        goto lab_0x8097fdd;
    }
  lab_0x8097fdd:
    // 0x8097fdd
    if (WWW_TraceFlag != 0) {
        // 0x8097fe8
        fprintf(TraceFP(), "Converted '%s' to '%s'\n", str, *AllocatedString);
    }
    goto lab_0x8098015;
  lab_0x80977a2:;
    char * v43 = HTEscape(old_string, 4); // 0x80977b3
    old_string2 = v43;
    HTSACat(AllocatedString, v43);
    if (old_string2 != NULL) {
        // 0x80977e0
        free((int32_t *)old_string2);
        old_string2 = NULL;
    }
    // 0x80977f8
    if (WWW_TraceFlag != 0) {
        // 0x8097803
        fprintf(TraceFP(), "Converted '%s' to '%s'\n", str, *AllocatedString);
    }
    goto lab_0x8097cfc;
  lab_0x8098015:
    // 0x8098015
    if (str != NULL) {
        // 0x809801f
        free((int32_t *)str);
        str = NULL;
    }
    // 0x8098037
    if (WWW_TraceFlag != 0) {
        // 0x8098042
        if (LYTraceLogFP == NULL) {
            // 0x809804b
            sleep(AlertSecs);
        }
    }
    goto lab_0x8098058;
  lab_0x8097cfc:
    // 0x8097cfc
    if (old_string != NULL) {
        // 0x8097d06
        free((int32_t *)old_string);
        old_string = NULL;
    }
    // 0x8097d1e
    if (cp != NULL) {
        // 0x8097d2c
        free((int32_t *)cp);
        cp = NULL;
    }
    goto lab_0x8098015;
    char * found_char_pos3 = strchr((char *)&str2, 35); // 0x8097a74
    char v12; // 0x8097533
    if (found_char_pos3 != NULL) {
        goto lab_0x8097a9b;
    } else {
        char * found_char_pos4 = strchr((char *)&str2, 37); // 0x8097a8e
        v12 = 0;
        if (found_char_pos4 == NULL) {
            goto lab_0x8097b6c;
        } else {
            goto lab_0x8097a9b;
        }
    }
  lab_0x8097a9b:;
    char * v13 = old_string; // 0x8097a9b
    if (v13 != NULL) {
        // 0x8097aa5
        free((int32_t *)v13);
        old_string = NULL;
    }
    char * str4 = cp; // 0x8097abd
    int32_t str3 = v3; // 0x8097ac3
    char * v14; // 0x809788d
    if (strcmp((char *)str3, str4) != 0) {
        char * v15 = cp; // 0x8097b1d
        old_string = HTEscape(v15, 4);
        v12 = 0;
        if (v14 != NULL) {
            // 0x8097b4b
            *v14 = 35;
            HTSACat(&old_string, v14);
            v12 = 0;
        }
    } else {
        char * v16 = HTEscape((char *)&str2, 4); // 0x8097aea
        old_string = v16;
        LYAddHtmlSep(&old_string);
        char * v17 = str; // 0x8097b03
        HTSACat(&old_string, v17);
        v12 = 0;
    }
    goto lab_0x8097b6c;
    char * v35 = old_string; // 0x8097936
    if (v35 != NULL) {
        // 0x8097940
        free((int32_t *)v35);
        old_string = NULL;
    }
    char * str6 = cp; // 0x8097958
    int32_t str5 = v3; // 0x809795e
    if (strcmp((char *)str5, str6) != 0) {
        char * v36 = cp; // 0x80979b8
        old_string = HTEscape(v36, 4);
        if (v14 != NULL) {
            // 0x80979e6
            *v14 = 35;
            HTSACat(&old_string, v14);
        }
    } else {
        char * v37 = HTEscape((char *)&str2, 4); // 0x8097985
        old_string = v37;
        LYAddHtmlSep(&old_string);
        char * v38 = str; // 0x809799e
        HTSACat(&old_string, v38);
    }
    char * v39 = old_string; // 0x8097a07
    HTSACat(AllocatedString, v39);
    char v40 = WWW_TraceFlag; // 0x8097a1f
    v12 = 1;
    if (v40 != 0) {
        char * v41 = *AllocatedString;
        char * v42 = str; // 0x8097a32
        fprintf(TraceFP(), "Converted '%s' to '%s'\n", v42, v41);
        v12 = 1;
    }
    goto lab_0x8097b6c;
  lab_0x8097b6c:;
    char v18 = v12;
    char * v19 = old_string2; // 0x8097b6c
    if (v19 != NULL) {
        // 0x8097b76
        free((int32_t *)v19);
        old_string2 = NULL;
    }
    int32_t v20 = v3; // 0x8097b8e
    if (v20 != 0) {
        // 0x8097b98
        free((int32_t *)v20);
        v3 = 0;
    }
    if (v18 == 0) {
        char v21 = WWW_TraceFlag; // 0x8097bbd
        if (v21 != 0) {
            char * v22 = cp;
            char * v23 = old_string;
            char * v24 = v22 == NULL ? v23 : v22;
            fprintf(TraceFP(), "Can't stat() or fopen() '%s'\n", v24);
        }
        int32_t v25 = URLDomainSuffixes; // 0x8097c0d
        int32_t v26 = URLDomainPrefixes; // 0x8097c12
        char v27 = LYExpandHostForURL(&str, (char *)v26, (char *)v25); // 0x8097c29
        if (v27 == 0) {
            if (fixit == 0) {
                char * v28 = old_string; // 0x8097cb6
                HTSACat(AllocatedString, v28);
            } else {
                char * v29 = str; // 0x8097c9c
                HTSACopy(AllocatedString, v29);
            }
        } else {
            char v30 = LYAddSchemeForURL(&str, "http://"); // 0x8097c43
            if (v30 != 0) {
                char * v31 = str; // 0x8097c7c
                HTSACopy(AllocatedString, v31);
            } else {
                // 0x8097c4c
                HTSACopy(AllocatedString, "http://");
                char * v32 = str; // 0x8097c62
                HTSACat(AllocatedString, v32);
            }
        }
        char v33 = WWW_TraceFlag; // 0x8097cce
        if (v33 != 0) {
            char * v34 = *AllocatedString;
            fprintf(TraceFP(), "Trying: '%s'\n", v34);
        }
    }
    goto lab_0x8097cfc;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8098073 - 0x8098bb3
// Line range:    4486 - 4772
char LYExpandHostForURL(char ** AllocatedString, char * prefix_list, char * suffix_list) {
    char * v1 = NULL; // bp-20, 0x809807e
    char * StartP = NULL; // bp-32, 0x8098085
    char * StartS = NULL; // bp-44, 0x809808c
    char * Str = NULL; // bp-52, 0x809809a
    char * StrColon = NULL; // bp-56, 0x80980a1
    char * Host = NULL; // bp-64, 0x80980af
    char * str = *AllocatedString; // 0x80980d8
    if (str == NULL) {
        // 0x8098ba2
        return 0;
    }
    char v2 = *str; // 0x80980e3
    switch (v2) {
        case 0: {
        }
        case 47: {
            // 0x8098ba2
            return 0;
        }
    }
    // 0x80980f6
    if (v2 == 35 || strncmp(str, "..", 2) == 0 || strncmp(*AllocatedString, "./", 2) == 0) {
        // 0x8098ba2
        return 0;
    }
    // 0x8098162
    HTSACopy(&StartS, *AllocatedString);
    char * found_char_pos = strchr(StartS, 47); // 0x8098184
    char * v3; // 0x8098073
    if (found_char_pos == NULL) {
        // 0x809819a
        v3 = trimPoundSelector(StartS);
    } else {
        // 0x8098192
        *found_char_pos = 0;
        v3 = NULL;
    }
    char * found_char_pos2 = strrchr(StartS, 58); // 0x80981b6
    char result; // 0x8098073
    if (found_char_pos2 == NULL) {
        goto lab_0x80981fd;
    } else {
        int16_t * v4 = *__ctype_b_loc(); // 0x80981c9
        unsigned char v5 = *(char *)((int32_t)found_char_pos2 + 1); // 0x80981d1
        if ((*(int16_t *)(2 * (int32_t)v5 + (int32_t)v4) & 2048) == 0) {
            goto lab_0x80981fd;
        } else {
            // 0x80981eb
            result = 0;
            if (found_char_pos2 == StartS) {
                goto lab_0x8098b02;
            } else {
                // 0x80981f7
                *found_char_pos2 = 0;
                goto lab_0x80981fd;
            }
        }
    }
  lab_0x8098611:;
    // 0x8098611
    int32_t v6; // 0x8098073
    char * v7 = (char *)v6;
    char v8 = *v7; // 0x8098623
    char * v9 = v7; // 0x8098628
    char v10 = v8; // 0x8098628
    char * v11 = v7; // 0x8098628
    int32_t v12 = v6; // 0x8098628
    if (v8 != 0) {
        unsigned char v13 = v10;
        int32_t v14 = (int32_t)v9;
        v11 = v9;
        v12 = v14;
        while (v13 < 33 || v13 == 44) {
            int32_t v15 = v14 + 1; // 0x809861c
            char * v16 = (char *)v15;
            char v17 = *v16; // 0x8098623
            v9 = v16;
            v10 = v17;
            v11 = v16;
            v12 = v15;
            if (v17 == 0) {
                // break -> 0x809863e
                break;
            }
            v13 = v10;
            v14 = (int32_t)v9;
            v11 = v9;
            v12 = v14;
        }
    }
    // 0x809863e
    char * DomainSuffix; // bp-40, 0x8098073
    *(int32_t *)&DomainSuffix = v12;
    unsigned char v18 = *v11; // 0x809864d
    char * v19 = v11; // 0x8098652
    char * v20 = v11; // 0x8098652
    if (v18 > 32 == (v18 != 44)) {
        char * v21 = (char *)((int32_t)v19 + 1);
        unsigned char v22 = *v21; // 0x809864d
        v19 = v21;
        while (v22 > 32 == (v22 != 44)) {
            // 0x8098646
            v21 = (char *)((int32_t)v19 + 1);
            v22 = *v21;
            v19 = v21;
        }
        // 0x809864a
        DomainSuffix = v21;
        v20 = v21;
    }
    // 0x8098668
    HTSACopy(&StartP, v11);
    *(char *)((int32_t)v20 - (int32_t)v11 + (int32_t)StartP) = 0;
    HTSACopy(&StrColon, v1);
    char * v23 = StartS; // 0x80986a1
    char * v24 = *v23 != 46 ? v23 : (char *)((int32_t)v23 + 1); // 0x80986c2
    HTSACat(&StrColon, v24);
    char * str2 = StrColon;
    char * str3; // 0x8098073
    if (*(char *)(strlen(str2) - 1 + (int32_t)str2) == 46) {
        // 0x80986f2
        str3 = StrColon;
        *(char *)(strlen(str3) - 1 + (int32_t)str3) = 0;
    }
    // 0x8098709
    HTSACat(&StrColon, StartP);
    char * found_char_pos3 = strrchr(StrColon, 58); // 0x8098729
    int16_t * v25; // 0x809873c
    unsigned char v26; // 0x8098744
    if (found_char_pos3 != NULL) {
        // 0x8098737
        v25 = *__ctype_b_loc();
        v26 = *(char *)((int32_t)found_char_pos3 + 1);
        if ((*(int16_t *)(2 * (int32_t)v26 + (int32_t)v25) & 2048) != 0) {
            // 0x809875e
            *found_char_pos3 = 0;
        }
    }
    // 0x8098764
    HTSACopy(&Host, StrColon);
    HTUnEscape(Host);
    char * v27; // 0x8098793
    char * v28; // 0x80987c0
    char * v29; // 0x80987f9
    if (LYCursesON == 0) {
        if (helpfilepath == 0) {
            // 0x80987e7
            if (dump_output_immediately == 0) {
                // 0x80987f2
                v29 = gettext(", guessing...");
                fprintf((struct _IO_FILE *)g164, "%s '%s'%s\n", gettext("Looking up "), Host, v29);
            }
        }
    } else {
        // 0x809878c
        v27 = gettext("Looking up ");
        HTSACopy(&Str, v27);
        HTSACat(&Str, Host);
        v28 = gettext(", guessing...");
        HTSACat(&Str, v28);
        HTProgress(Str);
    }
    struct hostent * v30 = LYGetHostByName(Host); // 0x8098837
    if (found_char_pos3 != NULL) {
        // 0x809884a
        *found_char_pos3 = 58;
    }
    if (v30 != NULL) {
        // break (via goto) -> 0x8098a0a
        goto lab_0x8098a0a;
    }
    // 0x809885a
    char v31; // 0x809883e
    if (LYCursesON != 0) {
        // 0x8098865
        if (lynx_nsl_status == -0x752e) {
            // 0x8098871
            v31 = v30 != NULL;
            result = v31;
            if (WWW_TraceFlag == 0) {
                goto lab_0x8098b02;
            } else {
                // 0x8098880
                fprintf(TraceFP(), "LYExpandHostForURL: Interrupted while '%s' failed to resolve.\n", Host);
                result = v31;
                goto lab_0x8098b02;
            }
        }
    }
    char * v32 = DomainSuffix; // 0x80988a3
    int32_t v33 = (int32_t)(*v32 != 0) + (int32_t)v32;
    char * v34 = (char *)v33;
    char v35 = *v34; // 0x80988d6
    char * v36 = v34; // 0x80988db
    char v37 = v35; // 0x80988db
    char * v38 = v34; // 0x80988db
    int32_t v39 = v33; // 0x80988db
    unsigned char v40; // 0x8098073
    int32_t v41; // 0x8098073
    int32_t v42; // 0x80988cf
    char * v43; // 0x8098073
    char v44; // 0x80988d6
    if (v35 != 0) {
        v40 = v37;
        v41 = (int32_t)v36;
        v38 = v36;
        v39 = v41;
        while (v40 < 33 || v40 == 44) {
            // 0x80988cf
            v42 = v41 + 1;
            v43 = (char *)v42;
            v44 = *v43;
            v36 = v43;
            v37 = v44;
            v38 = v43;
            v39 = v42;
            if (v44 == 0) {
                // break -> 0x80988f1
                break;
            }
            v40 = v37;
            v41 = (int32_t)v36;
            v38 = v36;
            v39 = v41;
        }
    }
    char * v45 = v38;
    *(int32_t *)&DomainSuffix = v39;
    unsigned char v46 = *v45; // 0x8098900
    int32_t v47 = v39; // 0x8098905
    int32_t v48 = v39; // 0x8098905
    int32_t v49; // 0x80988f9
    char * v50; // 0x8098073
    unsigned char v51; // 0x8098900
    if (v46 > 32 == (v46 != 44)) {
        v49 = v47 + 1;
        v50 = (char *)v49;
        v51 = *v50;
        v47 = v49;
        while (v51 > 32 == (v51 != 44)) {
            // 0x80988f9
            v49 = v47 + 1;
            v50 = (char *)v49;
            v51 = *v50;
            v47 = v49;
        }
        // 0x80988fd
        DomainSuffix = v50;
        v48 = v49;
    }
    // 0x8098943
    LYstrncpy(StartP, v45, v48 - (int32_t)v45);
    while (*StartP != 0) {
        // 0x809868f
        HTSACopy(&StrColon, v1);
        v23 = StartS;
        v24 = *v23 != 46 ? v23 : (char *)((int32_t)v23 + 1);
        HTSACat(&StrColon, v24);
        str2 = StrColon;
        if (*(char *)(strlen(str2) - 1 + (int32_t)str2) == 46) {
            // 0x80986f2
            str3 = StrColon;
            *(char *)(strlen(str3) - 1 + (int32_t)str3) = 0;
        }
        // 0x8098709
        HTSACat(&StrColon, StartP);
        found_char_pos3 = strrchr(StrColon, 58);
        if (found_char_pos3 != NULL) {
            // 0x8098737
            v25 = *__ctype_b_loc();
            v26 = *(char *)((int32_t)found_char_pos3 + 1);
            if ((*(int16_t *)(2 * (int32_t)v26 + (int32_t)v25) & 2048) != 0) {
                // 0x809875e
                *found_char_pos3 = 0;
            }
        }
        // 0x8098764
        HTSACopy(&Host, StrColon);
        HTUnEscape(Host);
        if (LYCursesON == 0) {
            if (helpfilepath == 0) {
                // 0x80987e7
                if (dump_output_immediately == 0) {
                    // 0x80987f2
                    v29 = gettext(", guessing...");
                    fprintf((struct _IO_FILE *)g164, "%s '%s'%s\n", gettext("Looking up "), Host, v29);
                }
            }
        } else {
            // 0x809878c
            v27 = gettext("Looking up ");
            HTSACopy(&Str, v27);
            HTSACat(&Str, Host);
            v28 = gettext(", guessing...");
            HTSACat(&Str, v28);
            HTProgress(Str);
        }
        // 0x8098831
        v30 = LYGetHostByName(Host);
        if (found_char_pos3 != NULL) {
            // 0x809884a
            *found_char_pos3 = 58;
        }
        if (v30 != NULL) {
            // break (via goto) -> 0x8098a0a
            goto lab_0x8098a0a;
        }
        // 0x809885a
        if (LYCursesON != 0) {
            // 0x8098865
            if (lynx_nsl_status == -0x752e) {
                // 0x8098871
                v31 = v30 != NULL;
                result = v31;
                if (WWW_TraceFlag == 0) {
                    goto lab_0x8098b02;
                } else {
                    // 0x8098880
                    fprintf(TraceFP(), "LYExpandHostForURL: Interrupted while '%s' failed to resolve.\n", Host);
                    result = v31;
                    goto lab_0x8098b02;
                }
            }
        }
        // 0x80988a3
        v32 = DomainSuffix;
        v33 = (int32_t)(*v32 != 0) + (int32_t)v32;
        v34 = (char *)v33;
        v35 = *v34;
        v36 = v34;
        v37 = v35;
        v38 = v34;
        v39 = v33;
        if (v35 != 0) {
            v40 = v37;
            v41 = (int32_t)v36;
            v38 = v36;
            v39 = v41;
            while (v40 < 33 || v40 == 44) {
                // 0x80988cf
                v42 = v41 + 1;
                v43 = (char *)v42;
                v44 = *v43;
                v36 = v43;
                v37 = v44;
                v38 = v43;
                v39 = v42;
                if (v44 == 0) {
                    // break -> 0x80988f1
                    break;
                }
                v40 = v37;
                v41 = (int32_t)v36;
                v38 = v36;
                v39 = v41;
            }
        }
        // 0x80988f1
        v45 = v38;
        *(int32_t *)&DomainSuffix = v39;
        v46 = *v45;
        v47 = v39;
        v48 = v39;
        if (v46 > 32 == (v46 != 44)) {
            v49 = v47 + 1;
            v50 = (char *)v49;
            v51 = *v50;
            v47 = v49;
            while (v51 > 32 == (v51 != 44)) {
                // 0x80988f9
                v49 = v47 + 1;
                v50 = (char *)v49;
                v51 = *v50;
                v47 = v49;
            }
            // 0x80988fd
            DomainSuffix = v50;
            v48 = v49;
        }
        // 0x8098943
        LYstrncpy(StartP, v45, v48 - (int32_t)v45);
    }
    // 0x809895b
    char * DomainPrefix; // bp-28, 0x8098073
    char * v52 = DomainPrefix; // 0x809895b
    int32_t v53 = (int32_t)(*v52 != 0) + (int32_t)v52;
    char * v54 = (char *)v53;
    char v55 = *v54; // 0x8098985
    char * v56 = v54; // 0x809898a
    char v57 = v55; // 0x809898a
    char * v58 = v54; // 0x809898a
    int32_t v59 = v53; // 0x809898a
    if (v55 != 0) {
        unsigned char v60 = v57;
        int32_t v61 = (int32_t)v56;
        v58 = v56;
        v59 = v61;
        while (v60 < 33 || v60 == 44) {
            int32_t v62 = v61 + 1; // 0x809897e
            char * v63 = (char *)v62;
            char v64 = *v63; // 0x8098985
            v56 = v63;
            v57 = v64;
            v58 = v63;
            v59 = v62;
            if (v64 == 0) {
                // break -> 0x80989a0
                break;
            }
            v60 = v57;
            v61 = (int32_t)v56;
            v58 = v56;
            v59 = v61;
        }
    }
    char * v65 = v58;
    *(int32_t *)&DomainPrefix = v59;
    unsigned char v66 = *v65; // 0x80989af
    int32_t v67 = v59; // 0x80989b4
    int32_t v68 = v59; // 0x80989b4
    if (v66 > 32 == (v66 != 44)) {
        int32_t v69 = v67 + 1; // 0x80989a8
        char * v70 = (char *)v69;
        unsigned char v71 = *v70; // 0x80989af
        v67 = v69;
        while (v71 > 32 == (v71 != 44)) {
            // 0x80989a8
            v69 = v67 + 1;
            v70 = (char *)v69;
            v71 = *v70;
            v67 = v69;
        }
        // 0x80989ac
        DomainPrefix = v70;
        v68 = v69;
    }
    // 0x80989f2
    LYstrncpy(v1, v65, v68 - (int32_t)v65);
    char * v72; // 0x8098073
    if (*v1 == 0) {
        // 0x8098aa8
        v72 = v30 == NULL ? "timed out" : "resolved";
        goto lab_0x8098aa8_2;
    }
    goto lab_0x80985ec;
  lab_0x80981fd:
    // 0x80981fd
    HTSACopy(&Host, StartS);
    HTUnEscape(Host);
    if (LYCursesON == 0) {
        if (helpfilepath == 0) {
            // 0x8098280
            if (dump_output_immediately == 0) {
                // 0x809828b
                fprintf((struct _IO_FILE *)g164, "%s '%s'%s\r\n", gettext("Looking up "), Host, gettext(" first"));
            }
        }
    } else {
        char * v73 = gettext("Looking up "); // 0x809822c
        HTSACopy(&Str, v73);
        HTSACat(&Str, Host);
        char * v74 = gettext(" first"); // 0x8098259
        HTSACat(&Str, v74);
        HTProgress(Str);
    }
    // 0x80982ca
    int32_t hints; // bp-112, 0x8098073
    memset(&hints, 0, 32);
    char * Path; // bp-76, 0x8098073
    int32_t v75 = getaddrinfo(Host, "80", (struct addrinfo *)&hints, (struct addrinfo **)&Path); // 0x809830f
    if (v75 != 0 || Path == NULL) {
        if (LYCursesON == 0) {
            goto lab_0x80983b3;
        } else {
            // 0x8098375
            if (lynx_nsl_status != -0x752e) {
                goto lab_0x80983b3;
            } else {
                // 0x8098381
                result = 0;
                if (WWW_TraceFlag != 0) {
                    // 0x8098390
                    fprintf(TraceFP(), "LYExpandHostForURL: Interrupted while '%s' failed to resolve.\n", Host);
                    result = 0;
                }
                goto lab_0x8098b02;
            }
        }
    } else {
        // 0x8098324
        result = 1;
        if (LYCursesON != 0) {
            // 0x809832f
            result = 1;
            if (HTCheckForInterrupt() != 0 && WWW_TraceFlag != 0) {
                // 0x8098343
                fprintf(TraceFP(), "LYExpandHostForURL: Ignoring interrupt because '%s' resolved.\n", Host);
                result = 1;
            }
        }
        goto lab_0x8098b02;
    }
  lab_0x80983b3:;
    char * v76; // 0x8098073
    if (prefix_list == NULL) {
        // 0x80983df
        v76 = (char *)&g25;
        goto lab_0x80983e9;
    } else {
        char * str4 = StartS;
        char v77 = *(char *)(strlen(str4) - 1 + (int32_t)str4); // 0x80983cd
        v76 = prefix_list;
        if (v77 == 46) {
            // 0x80983df
            v76 = (char *)&g25;
            goto lab_0x80983e9;
        } else {
            goto lab_0x80983e9;
        }
    }
  lab_0x8098b02:
    // 0x8098b02
    if (v1 != NULL) {
        // 0x8098b09
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x8098b1b
    if (StartP != NULL) {
        // 0x8098b22
        free((int32_t *)StartP);
        StartP = NULL;
    }
    // 0x8098b34
    if (StartS != NULL) {
        // 0x8098b3b
        free((int32_t *)StartS);
        StartS = NULL;
    }
    // 0x8098b4d
    if (Str != NULL) {
        // 0x8098b54
        free((int32_t *)Str);
        Str = NULL;
    }
    // 0x8098b66
    if (StrColon != NULL) {
        // 0x8098b6d
        free((int32_t *)StrColon);
        StrColon = NULL;
    }
    // 0x8098b7f
    if (Host != NULL) {
        // 0x8098b86
        free((int32_t *)Host);
        Host = NULL;
    }
    // 0x8098ba2
    return result;
  lab_0x80983e9:;
    char v78 = *v76;
    int32_t v79 = (int32_t)v76;
    char v80 = v78; // 0x8098073
    int32_t v81 = v79; // 0x8098073
    char * v82 = v76; // 0x8098073
    int32_t v83; // 0x8098073
    char * v84; // 0x8098073
    switch (v78) {
        case 0: {
            goto lab_0x809857d;
        }
        case 46: {
            goto lab_0x809857d;
        }
        default: {
            // 0x809840e
            if (strncasecomp(*AllocatedString, "www.", 4) == 0) {
                // 0x8098570
                v83 = (int32_t)&g25;
                v84 = (char *)&g25;
                goto lab_0x809857d_2;
            } else {
                // 0x8098433
                if (strncasecomp(*AllocatedString, "ftp.", 4) == 0) {
                    // 0x8098570
                    v83 = (int32_t)&g25;
                    v84 = (char *)&g25;
                    goto lab_0x809857d_2;
                } else {
                    // 0x8098458
                    if (strncasecomp(*AllocatedString, "gopher.", 7) == 0) {
                        // 0x8098570
                        v83 = (int32_t)&g25;
                        v84 = (char *)&g25;
                        goto lab_0x809857d_2;
                    } else {
                        // 0x809847d
                        if (strncasecomp(*AllocatedString, "wais.", 5) == 0) {
                            // 0x8098570
                            v83 = (int32_t)&g25;
                            v84 = (char *)&g25;
                            goto lab_0x809857d_2;
                        } else {
                            // 0x80984a2
                            if (strncasecomp(*AllocatedString, "cso.", 4) == 0) {
                                // 0x8098570
                                v83 = (int32_t)&g25;
                                v84 = (char *)&g25;
                                goto lab_0x809857d_2;
                            } else {
                                // 0x80984c7
                                if (strncasecomp(*AllocatedString, "ns.", 3) == 0) {
                                    // 0x8098570
                                    v83 = (int32_t)&g25;
                                    v84 = (char *)&g25;
                                    goto lab_0x809857d_2;
                                } else {
                                    // 0x80984ec
                                    if (strncasecomp(*AllocatedString, "ph.", 3) == 0) {
                                        // 0x8098570
                                        v83 = (int32_t)&g25;
                                        v84 = (char *)&g25;
                                        goto lab_0x809857d_2;
                                    } else {
                                        // 0x809850d
                                        if (strncasecomp(*AllocatedString, "finger.", 7) == 0) {
                                            // 0x8098570
                                            v83 = (int32_t)&g25;
                                            v84 = (char *)&g25;
                                            goto lab_0x809857d_2;
                                        } else {
                                            // 0x809852e
                                            if (strncasecomp(*AllocatedString, "news.", 5) == 0) {
                                                // 0x8098570
                                                v83 = (int32_t)&g25;
                                                v84 = (char *)&g25;
                                                goto lab_0x809857d_2;
                                            } else {
                                                // 0x809854f
                                                v83 = v79;
                                                v84 = v76;
                                                if (strncasecomp(*AllocatedString, "nntp.", 5) != 0) {
                                                    goto lab_0x809857d_2;
                                                } else {
                                                    // 0x8098570
                                                    v83 = (int32_t)&g25;
                                                    v84 = (char *)&g25;
                                                    goto lab_0x809857d_2;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x809857d:;
    char * v85 = v82; // 0x8098585
    int32_t v86 = v81; // 0x8098585
    if (v80 != 0) {
        char v87 = v80; // 0x8098580
        int32_t v88 = (int32_t)v82;
        v85 = v82;
        v86 = v88;
        while (v87 < 33 || v87 == 44) {
            int32_t v89 = v88 + 1; // 0x8098579
            char * v90 = (char *)v89;
            v87 = *v90;
            v85 = v90;
            v86 = v89;
            if (v87 == 0) {
                // break -> 0x809859b
                break;
            }
            v88 = (int32_t)v90;
            v85 = v90;
            v86 = v88;
        }
    }
    // 0x809859b
    *(int32_t *)&DomainPrefix = v86;
    char * v91 = (char *)v86;
    unsigned char v92 = *v91; // 0x80985aa
    char * v93 = v91; // 0x80985af
    if (v92 > 32 == (v92 != 44)) {
        char * v94 = (char *)((int32_t)v91 + 1);
        unsigned char v95 = *v94; // 0x80985aa
        char * v96 = v94; // 0x80985af
        while (v95 > 32 == (v95 != 44)) {
            // 0x80985a3
            v94 = (char *)((int32_t)v96 + 1);
            v95 = *v94;
            v96 = v94;
        }
        // 0x80985a7
        DomainPrefix = v94;
        v93 = v94;
    }
    // 0x80985c5
    HTSACopy(&v1, v85);
    *(char *)((int32_t)v93 - (int32_t)v85 + (int32_t)v1) = 0;
    while (true) {
      lab_0x80985ec:
        if (suffix_list == NULL) {
            // 0x8098607
            v6 = (int32_t)&g25;
            goto lab_0x8098611;
        } else {
            // 0x80985f2
            v6 = (int32_t)suffix_list;
            if (*StartS == 46) {
                // 0x8098607
                v6 = (int32_t)&g25;
                goto lab_0x8098611;
            } else {
                goto lab_0x8098611;
            }
        }
    }
  lab_0x8098a0a:
    if (found_char_pos2 != NULL) {
        // 0x8098a10
        if (strchr(StrColon, 58) == NULL) {
            // 0x8098a27
            *found_char_pos2 = 58;
            HTSACat(&StrColon, found_char_pos2);
        }
    }
    if (found_char_pos == NULL) {
        if (v3 != NULL) {
            // 0x8098a65
            HTSACat(&StrColon, "/");
            *v3 = 35;
            HTSACat(&StrColon, v3);
        }
    } else {
        // 0x8098a45
        *found_char_pos = 47;
        HTSACat(&StrColon, found_char_pos);
    }
    // 0x8098a96
    HTSACopy(AllocatedString, StrColon);
    v72 = "resolved";
    goto lab_0x8098aa8_2;
  lab_0x8098aa8_2:;
    char v97 = v30 != NULL;
    result = v97;
    if (LYCursesON != 0) {
        // 0x8098ab3
        result = v97;
        if (HTCheckForInterrupt() != 0 && WWW_TraceFlag != 0) {
            // 0x8098ac7
            fprintf(TraceFP(), "LYExpandHostForURL: Ignoring interrupt because '%s' %s.\n", Host, v72);
            result = v97;
        }
    }
    goto lab_0x8098b02;
  lab_0x809857d_2:
    // 0x809857d
    v80 = *v84;
    v81 = v83;
    v82 = v84;
    goto lab_0x809857d;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8098bb3 - 0x8098f49
// Line range:    4785 - 4875
char LYAddSchemeForURL(char ** AllocatedString, char * default_scheme) {
    char * v1 = NULL; // bp-12, 0x8098bb9
    char * v2 = *AllocatedString; // 0x8098bc7
    if (v2 == NULL || *v2 == 0) {
        // 0x8098f43
        return 0;
    }
    // 0x8098be5
    if (strncasecomp(v2, "www", 3) != 0) {
        // 0x8098c53
        if (strncasecomp(*AllocatedString, "ftp", 3) != 0) {
            // 0x8098c90
            if (strncasecomp(*AllocatedString, "gopher", 6) != 0) {
                // 0x8098ccd
                if (strncasecomp(*AllocatedString, "wais", 4) != 0) {
                    // 0x8098d0a
                    if (strncasecomp(*AllocatedString, "cso", 3) == 0) {
                        // 0x8098d6d
                        HTSACopy(&v1, "cso://");
                        goto lab_0x8098e86;
                    } else {
                        // 0x8098d2b
                        if (strncasecomp(*AllocatedString, "ns.", 3) == 0) {
                            // 0x8098d6d
                            HTSACopy(&v1, "cso://");
                            goto lab_0x8098e86;
                        } else {
                            // 0x8098d4c
                            if (strncasecomp(*AllocatedString, "ph.", 3) != 0) {
                                // 0x8098d89
                                if (strncasecomp(*AllocatedString, "finger", 6) != 0) {
                                    // 0x8098dc6
                                    if (strncasecomp(*AllocatedString, "news", 4) != 0) {
                                        // 0x8098e48
                                        if (strncasecomp(*AllocatedString, "nntp", 4) != 0) {
                                            // 0x8098ece
                                            if (default_scheme == NULL || *default_scheme == 0) {
                                                // 0x8098f43
                                                return 0;
                                            }
                                            // 0x8098ede
                                            HTSACopy(&v1, default_scheme);
                                            HTSACat(&v1, *AllocatedString);
                                            HTSACopy(AllocatedString, v1);
                                            if (v1 != NULL) {
                                                // 0x8098f21
                                                free((int32_t *)v1);
                                                v1 = NULL;
                                            }
                                            // 0x8098f43
                                            return 1;
                                        }
                                        // 0x8098e69
                                        HTSACopy(&v1, "nntp://");
                                        goto lab_0x8098e86;
                                    } else {
                                        if (default_scheme == NULL) {
                                            // 0x8098e2f
                                            HTSACopy(&v1, "news://");
                                            goto lab_0x8098e86;
                                        } else {
                                            // 0x8098ded
                                            if (strstr(default_scheme, "news") != NULL) {
                                                // 0x8098e1b
                                                HTSACopy(&v1, default_scheme);
                                                goto lab_0x8098e86;
                                            } else {
                                                // 0x8098e04
                                                if (strstr(default_scheme, "nntp") == NULL) {
                                                    // 0x8098e2f
                                                    HTSACopy(&v1, "news://");
                                                    goto lab_0x8098e86;
                                                } else {
                                                    // 0x8098e1b
                                                    HTSACopy(&v1, default_scheme);
                                                    goto lab_0x8098e86;
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    // 0x8098daa
                                    HTSACopy(&v1, "finger://");
                                    goto lab_0x8098e86;
                                }
                            } else {
                                // 0x8098d6d
                                HTSACopy(&v1, "cso://");
                                goto lab_0x8098e86;
                            }
                        }
                    }
                } else {
                    // 0x8098cee
                    HTSACopy(&v1, "wais://");
                    goto lab_0x8098e86;
                }
            } else {
                // 0x8098cb1
                HTSACopy(&v1, "gopher://");
                goto lab_0x8098e86;
            }
        } else {
            // 0x8098c74
            HTSACopy(&v1, "ftp://");
            goto lab_0x8098e86;
        }
    } else {
        if (default_scheme == NULL) {
            // 0x8098c37
            HTSACopy(&v1, "http://");
            goto lab_0x8098e86;
        } else {
            // 0x8098c0c
            if (strstr(default_scheme, "http") == NULL) {
                // 0x8098c37
                HTSACopy(&v1, "http://");
                goto lab_0x8098e86;
            } else {
                // 0x8098c23
                HTSACopy(&v1, default_scheme);
                goto lab_0x8098e86;
            }
        }
    }
  lab_0x8098e86:
    // 0x8098e86
    HTSACat(&v1, *AllocatedString);
    HTSACopy(AllocatedString, v1);
    if (v1 != NULL) {
        // 0x8098eb3
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x8098f43
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8098f49 - 0x8099062
// Line range:    4886 - 4948
void LYTrimRelFromAbsPath(char * path) {
    // 0x8098f49
    if (path == NULL || *path != 47) {
        // 0x8099060
        return;
    }
    int32_t v1 = (int32_t)path;
    char v2 = *(char *)(v1 - 1 + strlen(path)); // 0x8098f78
    HTSimplify(path);
    char * v3; // bp-12, 0x8098f49
    *(int32_t *)&v3 = v1;
    char * v4 = (char *)(v1 + 1); // 0x809900a
    char * v5 = path; // 0x809900f
    char * v6 = v4; // 0x809900f
    int32_t v7 = v1; // 0x809900f
    char * v8; // 0x8098f49
    char * v9; // 0x8098f49
    if (*v4 == 46) {
        while (true) {
          lab_0x8098f96:;
            int32_t v10 = v7;
            char * v11 = v6;
            char * v12 = (char *)(v10 + 2); // 0x8098f9c
            char v13 = *v12; // 0x8098f9c
            if (v13 != 0) {
                if (v13 != 47) {
                    // 0x8098fc1
                    v9 = v5;
                    if (v13 != 46) {
                        goto lab_0x8098fe6;
                    } else {
                        // 0x8098fce
                        if (*(char *)(v10 + 3) != 0) {
                            goto lab_0x8098fe6;
                        } else {
                            // 0x8098fdb
                            *v11 = 0;
                            goto lab_0x8099004;
                        }
                    }
                } else {
                    // 0x8098fbb
                    v3 = v12;
                    goto lab_0x8099004;
                }
            } else {
                // 0x8098fa3
                *v11 = 0;
                goto lab_0x8099004;
            }
        }
      lab_0x8099011_3:
        // 0x8099011
        if (v8 > path) {
            char v14 = *v8; // 0x809903f
            char v15 = v14; // 0x8099044
            char * v16 = path; // 0x8099044
            if (v14 != 0) {
                *path = v15;
                int32_t v17 = 1; // 0x8099035
                char v18 = *(char *)(v17 + (int32_t)v3); // 0x809903f
                char * v19 = (char *)(v17 + (int32_t)path);
                int32_t v20 = v17; // 0x8099044
                v16 = v19;
                while (v18 != 0) {
                    // 0x8099022
                    *v19 = v18;
                    v17 = v20 + 1;
                    v18 = *(char *)(v17 + (int32_t)v3);
                    v19 = (char *)(v17 + (int32_t)path);
                    v20 = v17;
                    v16 = v19;
                }
            }
            // 0x8099046
            *v16 = 0;
        }
    }
    if (v2 != 47) {
        // 0x8099055
        LYTrimPathSep(path);
    }
  lab_0x8099004:
    // 0x8099004
    v7 = (int32_t)v3;
    v6 = (char *)(v7 + 1);
    v5 = v3;
    v8 = v3;
    if (*v6 != 46) {
        // break -> 0x8099011
        goto lab_0x8099011_3;
    }
    goto lab_0x8098f96;
  lab_0x8098fe6:;
    int32_t v21 = (int32_t)v9; // 0x8098fe6
    v8 = v9;
    if (*(char *)(v21 + 2) != 46) {
        // break -> 0x8099011
        goto lab_0x8099011_3;
    }
    char * v22 = (char *)(v21 + 3); // 0x8098ff9
    v8 = v9;
    if (*v22 != 47) {
        // break -> 0x8099011
        goto lab_0x8099011_3;
    }
    // 0x8099000
    v3 = v22;
    goto lab_0x8099004;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80990f0 - 0x8099132
// Line range:    5018 - 5029
char * Current_Dir(char * pathname) {
    // 0x80990f0
    if (getcwd(pathname, 256) == NULL) {
        // 0x8099112
        memcpy((int32_t *)pathname, (int32_t *)".", 2);
    }
    // 0x809912d
    return pathname;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099132 - 0x8099178
// Line range:    5036 - 5045
char * CheckDir(char * path) {
    // 0x8099132
    if (LYisAbsPath(path) != 0) {
        // 0x8099147
        int32_t v1; // bp-100, 0x8099132
        int32_t v2; // 0x8099132
        if ((v2 & 0xf000) == 0x4000 == HTStat(path, &v1) > -1) {
            // 0x8099173
            return path;
        }
    }
    // 0x8099173
    return NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099178 - 0x809919a
// Line range:    5051 - 5091
char * HomeEnv(void) {
    // 0x8099178
    return CheckDir(LYGetEnv("HOME"));
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809919a - 0x8099259
// Line range:    5094 - 5139
char * Home_Dir(void) {
    char * result = g290; // 0x80991ae
    if (g290 != NULL) {
        goto lab_0x8099229;
    } else {
        char * v1 = HomeEnv(); // 0x80991b0
        if (v1 != NULL) {
            // 0x809920c
            HTSACopy((char **)&HomeDir, v1);
            goto lab_0x809921f;
        } else {
            struct passwd * v2 = getpwuid(geteuid()); // 0x80991c6
            if (v2 == NULL) {
                // 0x80991f6
                HTSACopy((char **)&HomeDir, "/tmp");
                goto lab_0x809921f;
            } else {
                int32_t v3 = *(int32_t *)((int32_t)v2 + 20); // 0x80991d7
                if (v3 == 0) {
                    // 0x80991f6
                    HTSACopy((char **)&HomeDir, "/tmp");
                    goto lab_0x809921f;
                } else {
                    // 0x80991de
                    HTSACopy((char **)&HomeDir, (char *)v3);
                    goto lab_0x809921f;
                }
            }
        }
    }
  lab_0x8099229:
    // 0x8099229
    if (result != NULL) {
        // 0x8099252
        return result;
    }
    // 0x8099232
    puts(gettext("Cannot find HOME directory"));
    exit_immediately(1);
    // UNREACHABLE
  lab_0x809921f:
    // 0x809921f
    result = (char *)HomeDir;
    g290 = result;
    goto lab_0x8099229;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099259 - 0x8099298
// Line range:    5147 - 5172
char * LYPathLeaf(char * pathname) {
    char * found_char_pos = strrchr(pathname, 47); // 0x809926d
    int32_t v1 = (int32_t)(found_char_pos != NULL) + (int32_t)found_char_pos;
    return v1 == 0 ? pathname : (char *)v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099298 - 0x80995fe
// Line range:    5185 - 5342
char LYPathOffHomeOK(char * fbuffer, uint32_t fbuffer_size) {
    char * v1 = NULL; // bp-8, 0x809929e
    if (fbuffer == NULL || fbuffer_size < 2 || *fbuffer == 0) {
        // 0x80995f8
        return 0;
    }
    // 0x80992c4
    HTSACopy(&v1, fbuffer);
    char * v2 = v1; // 0x80992d6
    char * file = v2; // bp-12, 0x80992d9
    int32_t v3 = (int32_t)v2;
    int32_t v4 = v3; // 0x80992e4
    char * v5 = v2; // 0x80992e4
    int32_t v6; // 0x8099298
    char * v7; // 0x8099298
    if (*v2 != 126) {
        goto lab_0x8099410;
    } else {
        char * str = (char *)(v3 + 1); // 0x80992f0
        char v8 = *str; // 0x80992f0
        if (v8 != 47) {
            // 0x8099359
            v6 = v3;
            v7 = v2;
            if (v8 == 0) {
                goto lab_0x80993ee;
            } else {
                char * found_char_pos = strchr(str, 47); // 0x809937b
                if (found_char_pos == NULL) {
                    // 0x809936a
                    v6 = (int32_t)v1;
                    v7 = v1;
                    goto lab_0x80993ee;
                } else {
                    int32_t v9 = (int32_t)found_char_pos; // 0x8099389
                    char * v10 = (char *)(v9 - 1); // 0x809938f
                    file = v10;
                    int32_t v11 = v9 + 1; // 0x8099395
                    char * str2 = (char *)v11; // 0x8099398
                    if (*str2 == 0) {
                        // 0x80993cc
                        if (v1 != NULL) {
                            // 0x80993d3
                            free((int32_t *)v1);
                            v1 = NULL;
                        }
                        // 0x80995f8
                        return 0;
                    }
                    // 0x809939f
                    if (strchr(str2, 47) == NULL) {
                        // 0x80993c6
                        file = str2;
                        v4 = v11;
                        v5 = str2;
                    } else {
                        // 0x80993be
                        *v10 = 46;
                        v4 = (int32_t)file;
                        v5 = file;
                    }
                    goto lab_0x8099410;
                }
            }
        } else {
            int32_t v12 = v3 + 2;
            char * str3 = (char *)v12;
            if (*str3 == 0) {
                // 0x8099337
                if (v2 != NULL) {
                    // 0x809933e
                    free((int32_t *)v2);
                    v1 = NULL;
                }
                // 0x80995f8
                return 0;
            }
            // 0x8099304
            if (strchr(str3, 47) == NULL) {
                // 0x809932e
                file = str3;
                v4 = v12;
                v5 = str3;
            } else {
                // 0x8099323
                *v2 = 46;
                v4 = v3;
                v5 = v2;
            }
            goto lab_0x8099410;
        }
    }
  lab_0x8099410:;
    // 0x8099410
    char * str6; // 0x8099298
    char * v13; // 0x8099298
    if (is_url((char *)v4) != 0) {
        goto lab_0x8099429;
    } else {
        // 0x809941f
        if (*v5 != 47) {
            char * str4 = (char *)v4;
            HTSimplify(str4);
            int32_t strncmp_rc = strncmp(str4, "./", 2); // 0x809946c
            v13 = str4;
            int32_t v14 = v4; // 0x8099473
            if (strncmp_rc == 0) {
                int32_t v15 = v4 + 2;
                char * str5 = (char *)v15;
                v13 = str4;
                v14 = v4;
                if (strchr(str5, 47) == NULL) {
                    // 0x8099494
                    file = str5;
                    v13 = str5;
                    v14 = v15;
                }
            }
            // 0x8099498
            char * v16; // 0x8099298
            switch (*v16) {
                case 0: {
                    goto lab_0x80994f2;
                }
                case 47: {
                    goto lab_0x80994f2;
                }
                default: {
                    // 0x80994ac
                    str6 = (char *)v14;
                    if (*(char *)(v14 - 1 + strlen(str6)) == 47) {
                        goto lab_0x80994f2;
                    } else {
                        // 0x80994c4
                        if (strstr(str6, "..") != NULL) {
                            goto lab_0x80994f2;
                        } else {
                            // 0x80994db
                            if (strcmp(str6, ".") != 0) {
                                if (fbuffer_size < 4) {
                                    goto lab_0x80995a6;
                                } else {
                                    // 0x809951e
                                    if (strncmp(str6, "./", 2) == 0) {
                                        goto lab_0x80995a6;
                                    } else {
                                        // 0x809953d
                                        if (strchr(str6, 47) == NULL) {
                                            goto lab_0x80995a6;
                                        } else {
                                            // 0x8099554
                                            memcpy((int32_t *)fbuffer, (int32_t *)"./", 3);
                                            uint32_t v17 = fbuffer_size - 3; // 0x809957f
                                            char * str7 = fbuffer; // 0x8099584
                                            char * str8 = v13; // 0x8099584
                                            if (strlen(str6) > v17) {
                                                // 0x8099586
                                                *(char *)(v17 + (int32_t)v13) = 0;
                                                str7 = fbuffer;
                                                str8 = file;
                                            }
                                            // 0x8099592
                                            strcat(str7, str8);
                                            goto lab_0x80995db;
                                        }
                                    }
                                }
                            } else {
                                goto lab_0x80994f2;
                            }
                        }
                    }
                }
            }
        } else {
            goto lab_0x8099429;
        }
    }
  lab_0x8099429:
    // 0x8099429
    if (v1 != NULL) {
        // 0x8099430
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x80995f8
    return 0;
  lab_0x80993ee:
    // 0x80993ee
    if (v7 != NULL) {
        // 0x80993f5
        free((int32_t *)v6);
        v1 = NULL;
    }
    // 0x80995f8
    return 0;
  lab_0x80994f2:
    // 0x80994f2
    if (v1 != NULL) {
        // 0x80994f9
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x80995f8
    return 0;
  lab_0x80995a6:;
    uint32_t v18 = fbuffer_size - 1; // 0x80995b6
    char * str9 = v13; // 0x80995bb
    if (strlen(str6) > v18) {
        // 0x80995bd
        *(char *)(v18 + (int32_t)v13) = 0;
        str9 = file;
    }
    // 0x80995c9
    strcpy(fbuffer, str9);
    goto lab_0x80995db;
  lab_0x80995db:
    // 0x80995db
    if (v1 != NULL) {
        // 0x80995e2
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x80995f8
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80995fe - 0x809965e
// Line range:    5349 - 5368
char * FindLeadingTilde(char * pathname, char embedded) {
    // 0x80995fe
    if (pathname == NULL) {
        // 0x8099659
        return NULL;
    }
    char v1 = *pathname;
    char v2 = v1; // 0x809961a
    int32_t v3 = (int32_t)pathname; // 0x809961a
    if (embedded != 0 == (v1 != 0)) {
        char v4 = v1;
        int32_t v5 = (int32_t)pathname + 1;
        char * v6 = (char *)v5;
        char v7 = *v6;
        v2 = v7;
        v3 = v5;
        while (v4 == 47 != (v7 == 126) == (v7 != 0)) {
            // 0x809961e
            v4 = v7;
            v5 = (int32_t)v6 + 1;
            v6 = (char *)v5;
            v7 = *v6;
            v2 = v7;
            v3 = v5;
        }
    }
    char * result = pathname; // 0x8099651
    if (v2 == 126) {
        // 0x8099653
        result = (char *)v3;
    }
    // 0x8099659
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809965e - 0x809970b
// Line range:    5375 - 5387
char * LYAbsOrHomePath(char ** fname) {
    int32_t v1 = __readgsdword(20); // 0x8099670
    if (LYisAbsPath(*fname) == 0) {
        char * v2 = *fname;
        if (*v2 != 126) {
            // 0x80996b6
            int32_t v3; // bp-264, 0x809965e
            LYAddPathToHome((char *)&v3, 256, v2);
            HTSACopy(fname, (char *)&v3);
        } else {
            // 0x809969e
            LYTildeExpand(fname, 0);
        }
    }
    int32_t v4 = (int32_t)*fname; // 0x8099702
    if (v1 != __readgsdword(20)) {
        // 0x8099704
        __stack_chk_fail();
        v4 = &g391;
    }
    // 0x8099709
    return (char *)v4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809970b - 0x80998a6
// Line range:    5395 - 5423
char * LYTildeExpand(char ** pathname, char embedded) {
    char * v1 = FindLeadingTilde(*pathname, embedded); // 0x8099728
    if (*v1 != 126) {
        // 0x809989b
        return *pathname;
    }
    // 0x809973e
    if (WWW_TraceFlag != 0) {
        // 0x8099749
        fprintf(TraceFP(), "LYTildeExpand %s\n", *pathname);
    }
    int32_t v2 = (int32_t)v1; // 0x8099728
    char v3 = *(char *)(v2 + 1); // 0x809976f
    if (v3 != 47) {
        // 0x8099847
        if (v3 == 0) {
            char * v4 = Home_Dir(); // 0x8099854
            HTSACopy(pathname, wwwName(v4));
        }
    } else {
        char * temp2 = NULL; // bp-16, 0x809977a
        char * temp = NULL; // bp-20, 0x8099781
        HTSACopy(&temp2, *pathname);
        *(char *)((int32_t)temp2 + v2 - (int32_t)*pathname) = 0;
        HTSACopy(&temp, (char *)(v2 + 2));
        HTSACopy(pathname, temp2);
        char * v5 = Home_Dir(); // 0x80997da
        HTSACat(pathname, wwwName(v5));
        LYAddPathSep(pathname);
        HTSACat(pathname, temp);
        if (temp2 != NULL) {
            // 0x809981a
            free((int32_t *)temp2);
            temp2 = NULL;
        }
        // 0x809982c
        if (temp != NULL) {
            // 0x8099833
            free((int32_t *)temp);
            temp = NULL;
        }
    }
    // 0x8099870
    if (WWW_TraceFlag != 0) {
        // 0x809987b
        fprintf(TraceFP(), "expanded path %s\n", *pathname);
    }
    // 0x809989b
    return *pathname;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80998a6 - 0x80999ec
// Line range:    5437 - 5525
void LYAddPathToHome(char * fbuffer, uint32_t fbuffer_size, char * fname) {
    char * v1 = NULL; // bp-8, 0x80998ac
    if (fbuffer == NULL) {
        // 0x80999ea
        return;
    }
    if (fbuffer_size < 2) {
        // 0x80998c9
        *fbuffer = 0;
        // 0x80999ea
        return;
    }
    int32_t v2 = fbuffer_size - 1; // 0x80998d7
    *(char *)(v2 + (int32_t)fbuffer) = 0;
    char * v3 = Home_Dir(); // 0x80998ed
    HTSACopy(&v1, v3);
    char * v4 = v1; // 0x8099901
    char * str; // 0x80998a6
    if (v4 == NULL) {
        goto lab_0x8099912;
    } else {
        // 0x8099908
        str = v4;
        if (*v4 != 0) {
            goto lab_0x8099925;
        } else {
            goto lab_0x8099912;
        }
    }
  lab_0x8099912:
    // 0x8099912
    HTSACopy(&v1, "/error");
    str = v1;
    goto lab_0x8099925;
  lab_0x8099925:;
    int32_t v5 = -1 - strlen(str) + fbuffer_size; // 0x8099932
    if (v5 >= 0 == (v5 != 0)) {
        int32_t str2 = fname != NULL ? (int32_t)fname : (int32_t)&g25;
        int32_t v6 = strncmp((char *)str2, "./", 2) != 0 ? str2 : str2 + 2;
        sprintf(fbuffer, "%s/%.*s", v1, v5, (char *)v6);
        if (v1 != NULL) {
            // 0x80999d8
            free((int32_t *)v1);
            v1 = NULL;
        }
    } else {
        // 0x809993e
        LYstrncpy(fbuffer, v1, v2);
        if (v1 != NULL) {
            // 0x8099965
            free((int32_t *)v1);
            v1 = NULL;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x80999ec - 0x8099ab2
// Line range:    5533 - 5549
char * LYAddPathToSave(char * fname) {
    int32_t v1 = __readgsdword(20); // 0x80999fe
    char * v2 = NULL; // bp-268, 0x8099a09
    if (LYisAbsPath(fname) == 0) {
        // 0x8099a3f
        if (lynx_save_space == 0) {
            // 0x8099a61
            int32_t v3; // bp-264, 0x80999ec
            LYAddPathToHome((char *)&v3, 256, fname);
            HTSACopy(&v2, (char *)&v3);
        } else {
            // 0x8099a48
            HTSACopy(&v2, (char *)lynx_save_space);
        }
    } else {
        // 0x8099a25
        HTSACopy(&v2, fname);
    }
    int32_t v4 = (int32_t)v2; // 0x8099aa9
    if (v1 != __readgsdword(20)) {
        // 0x8099aab
        __stack_chk_fail();
        v4 = &g391;
    }
    // 0x8099ab0
    return (char *)v4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099ab2 - 0x8099c3b
// Line range:    5653 - 5690
char IsOurSymlink(char * name) {
    int32_t * mem = malloc(256); // 0x8099ac9
    int32_t v1 = (int32_t)mem; // 0x8099ac9
    int32_t v2 = 256; // 0x8099ad5
    int32_t buf = v1; // 0x8099ad5
    int32_t v3 = v1; // 0x8099ad5
    if (mem != NULL) {
        int32_t buf_size = v2 - 1; // 0x8099afa
        int32_t v4 = readlink(name, (char *)buf, buf_size); // 0x8099b0e
        int32_t v5 = v4; // 0x8099b1f
        int32_t v6 = buf; // 0x8099b1f
        while (v4 == buf_size) {
            // 0x8099ad9
            v2 *= 2;
            int32_t * mem2 = realloc((int32_t *)buf, v2); // 0x8099ae9
            buf = (int32_t)mem2;
            v5 = buf_size;
            v6 = 0;
            if (mem2 == NULL) {
                // break -> 0x8099b21
                break;
            }
            buf_size = v2 - 1;
            v4 = readlink(name, (char *)buf, buf_size);
            v5 = v4;
            v6 = buf;
        }
        // 0x8099b21
        v3 = v6;
        if (v5 < 1) {
            // 0x8099b32
            if (v3 != 0) {
                // 0x8099b38
                free((int32_t *)v3);
            }
            // 0x8099c35
            return 0;
        }
        // 0x8099b27
        *(char *)(v3 + v5) = 0;
    }
    // 0x8099b4a
    if (v3 == 0) {
        // 0x8099c35
        return 0;
    }
    char * v7 = (char *)v3; // 0x8099b57
    int32_t v8 = v3; // 0x8099b61
    if (LYisAbsPath(v7) == 0) {
        char * v9 = name;
        char * v10 = LYLastPathSep(v9); // 0x8099b69
        char * buffer = NULL; // bp-28, 0x8099b71
        v8 = v3;
        if (v10 != NULL) {
            // 0x8099bcb
            HTSprintf0(&buffer, "%.*s%s%s", (int32_t)v10 - (int32_t)v9, v9, "/", v7);
            free((int32_t *)v3);
            v8 = (int32_t)buffer;
        }
    }
    // 0x8099bd1
    if (WWW_TraceFlag != 0) {
        // 0x8099bdc
        if ((WWW_TraceMask & 8) != 0) {
            // 0x8099be8
            fprintf(TraceFP(), "IsOurSymlink(%s -> %s)\n", name, (char *)v8);
        }
    }
    char result = IsOurFile((char *)v8); // 0x8099c15
    if (v8 != 0) {
        // 0x8099c23
        free((int32_t *)v8);
    }
    // 0x8099c35
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099c3b - 0x8099e02
// Line range:    5699 - 5764
char IsOurFile(char * name) {
    char result = 0; // 0x8099c51
    int32_t v1; // bp-120, 0x8099c3b
    int32_t v2; // 0x8099c3b
    int32_t v3; // 0x8099c74
    if (*name == 126) {
        goto lab_0x8099db6;
    } else {
        int32_t v4 = lstat64((int32_t)name, &v1); // 0x8099c64
        result = 0;
        if (v4 != 0) {
            goto lab_0x8099db6;
        } else {
            // 0x8099c71
            v3 = v2 & 0xf000;
            if (v3 != 0x8000) {
                goto lab_0x8099c9e;
            } else {
                if (v2 == 1 == (v2 & 18) == 0) {
                    // 0x8099c92
                    if (v2 == getuid()) {
                        goto lab_0x8099cc4;
                    } else {
                        goto lab_0x8099c9e;
                    }
                } else {
                    goto lab_0x8099c9e;
                }
            }
        }
    }
  lab_0x8099db6:
    // 0x8099db6
    if (WWW_TraceFlag == 0) {
        // 0x8099df5
        return result;
    }
    // 0x8099dc1
    if ((WWW_TraceMask & 8) != 0) {
        // 0x8099dcd
        fprintf(TraceFP(), "IsOurFile(%s) %d\n", name, (int32_t)result);
    }
    // 0x8099df5
    return result;
  lab_0x8099c9e:
    // 0x8099c9e
    result = 0;
    if (v3 != 0xa000) {
        goto lab_0x8099db6;
    } else {
        // 0x8099cb1
        result = 0;
        if (IsOurSymlink(name) == 0) {
            goto lab_0x8099db6;
        } else {
            goto lab_0x8099cc4;
        }
    }
  lab_0x8099cc4:;
    char * v5 = NULL; // bp-20, 0x8099ccb
    HTSACopy(&v5, name);
    int32_t v6 = 0;
    char * v7 = LYPathLeaf(v5); // 0x8099cea
    int32_t v8 = (int32_t)v7;
    int32_t v9 = v8; // 0x8099cf8
    char * v10 = v7; // 0x8099cf8
    int32_t v11 = v8; // 0x8099cf8
    if (v7 != v5) {
        // 0x8099cfa
        v11 = v8 - 1;
        *(char *)v11 = 0;
        v10 = v5;
        v9 = (int32_t)v10;
    }
    int32_t v12 = lstat64(*v10 == 0 ? (int32_t)"/" : v9, &v1); // 0x8099d2a
    int32_t v13 = v6; // 0x8099d31
    char * v14; // 0x8099c3b
    int32_t v15; // 0x8099c3b
    while (v12 == 0) {
        int32_t v16 = 1; // 0x8099d40
        if (v3 != 0xa000) {
            if (v3 != 0x4000) {
                // 0x8099d81
                v16 = v6;
                v13 = v6;
                if (v6 != 0) {
                    // break -> 0x8099d93
                    break;
                }
            } else {
                // 0x8099d5a
                v16 = 0;
                v13 = 1;
                if ((v2 & 2 || v2) != 0 && v6 != 0) {
                    // break -> 0x8099d93
                    break;
                }
            }
        }
        char * v17 = v5; // 0x8099d8d
        v14 = v5;
        v15 = v16;
        if (v11 == (int32_t)v5) {
            goto lab_0x8099d93;
        }
        v6 = v16;
        v7 = LYPathLeaf(v17);
        v8 = (int32_t)v7;
        v9 = v8;
        v10 = v7;
        v11 = v8;
        if (v7 != v5) {
            // 0x8099cfa
            v11 = v8 - 1;
            *(char *)v11 = 0;
            v10 = v5;
            v9 = (int32_t)v10;
        }
        // 0x8099d04
        v12 = lstat64(*v10 == 0 ? (int32_t)"/" : v9, &v1);
        v13 = v6;
    }
    // 0x8099d93
    v14 = v5;
    v15 = v13;
  lab_0x8099d93:
    // 0x8099d93
    if (v14 != NULL) {
        // 0x8099d9a
        free((int32_t *)v14);
        v5 = NULL;
    }
    // 0x8099dac
    result = v15 == 0;
    goto lab_0x8099db6;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099e02 - 0x8099fbd
// Line range:    5770 - 5822
struct _IO_FILE * OpenHiddenFile(char * name, char * mode) {
    char * found_char_pos = strchr(mode, 98); // 0x8099e20
    char v1 = *mode; // 0x8099e30
    struct _IO_FILE * result; // 0x8099e02
    if (v1 == 119) {
        int32_t v2 = open64(name, 193); // 0x8099e51
        int32_t * v3 = (int32_t *)v2; // 0x8099e56
        int32_t * fd = v3; // 0x8099e5d
        if (v2 < 0) {
            int32_t v4 = *__errno_location(); // 0x8099e64
            fd = v3;
            if (v4 == 17) {
                // 0x8099e6b
                fd = v3;
                if (IsOurFile(name) != 0) {
                    // 0x8099e7a
                    remove(name);
                    fd = (int32_t *)open64(name, 193);
                }
            }
        }
        // 0x8099ea3
        result = NULL;
        if (fd >= NULL) {
            // 0x8099ead
            result = fdopen((int32_t)fd, mode);
        }
        // 0x8099fb8
        return result;
    }
    if (v1 != 97) {
        int32_t cmask = umask(63); // 0x8099f6d
        if (chmod(name, 384) != 0) {
            // 0x8099f8c
            if (*__errno_location() != 2) {
                // 0x8099fad
                umask(cmask);
                // 0x8099fb8
                return NULL;
            }
        }
        struct _IO_FILE * result2 = fopen64(name, mode);
        umask(cmask);
        // 0x8099fb8
        return result2;
    }
    // 0x8099ed5
    if (IsOurFile(name) != 0) {
        // 0x8099ee4
        if (chmod(name, 384) == 0) {
            // 0x8099fb8
            return fopen64(name, mode);
        }
    }
    // 0x8099f15
    int32_t v5; // bp-116, 0x8099e02
    int32_t v6 = lstat64((int32_t)name, &v5); // 0x8099f22
    result = NULL;
    if (v6 != 0) {
        // 0x8099f2f
        result = OpenHiddenFile(name, found_char_pos == NULL ? "w" : "wb");
    }
    // 0x8099fb8
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099fbd - 0x8099fde
// Line range:    5828 - 5837
struct _IO_FILE * LYNewBinFile(char * name) {
    // 0x8099fbd
    return OpenHiddenFile(name, "wb");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099fde - 0x8099fff
// Line range:    5840 - 5855
struct _IO_FILE * LYNewTxtFile(char * name) {
    // 0x8099fde
    return OpenHiddenFile(name, "w");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x8099fff - 0x809a020
// Line range:    5858 - 5872
struct _IO_FILE * LYAppendToTxtFile(char * name) {
    // 0x8099fff
    return OpenHiddenFile(name, "a+");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809a020 - 0x809a0a4
// Line range:    5881 - 5899
void LYRelaxFilePermissions(char * name) {
    // 0x809a020
    int32_t v1; // 0x809a020
    uint32_t v2 = v1;
    int32_t v3; // bp-108, 0x809a020
    if (stat64((int32_t)name, &v3) != 0) {
        // 0x809a0a2
        return;
    }
    if ((v2 & 0xf000) != 0x8000) {
        // 0x809a0a2
        return;
    }
    if (v2 % 512 == 384) {
        int32_t cmask = umask(63); // 0x809a066
        umask(cmask);
        chmod(name, (v2 & 448 | 54) & -1 - cmask);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809a118 - 0x809a540
// Line range:    5932 - 6040
struct _IO_FILE * LYOpenTemp(char * result, char * suffix, char * mode) {
    // 0x809a118
    if (WWW_TraceFlag != 0) {
        // 0x809a13e
        fprintf(TraceFP(), "LYOpenTemp(,%s,%s)\n", suffix, mode);
    }
    // 0x809a165
    if (result == NULL) {
        // 0x809a52f
        return NULL;
    }
    char v1 = *mode; // 0x809a204
    char v2 = v1; // 0x809a209
    char v3 = 1; // 0x809a209
    char * v4 = mode; // 0x809a209
    char v5 = 114; // 0x809a209
    char v6 = 114; // 0x809a209
    char v7 = 1; // 0x809a209
    if (v1 != 0) {
        while (true) {
            char v8 = v5;
            char v9 = v2; // 0x809a118
            char v10 = v3; // 0x809a118
            char * v11 = v4; // 0x809a118
            char v12; // 0x809a118
            while (true) {
              lab_0x809a17e:
                // 0x809a17e
                v3 = v10;
                v4 = (char *)((int32_t)v11 + 1);
                v12 = 97;
                switch (v9) {
                    case 98: {
                        char v13 = *v4; // 0x809a204
                        v9 = v13;
                        v10 = 0;
                        v11 = v4;
                        v6 = v8;
                        v7 = 0;
                        if (v13 == 0) {
                            goto lab_0x809a20f_2;
                        }
                        goto lab_0x809a17e;
                    }
                    case 119: {
                        goto lab_0x809a201;
                    }
                    case 97: {
                        goto lab_0x809a201_2;
                    }
                    default: {
                        goto lab_0x809a1c0;
                    }
                }
            }
          lab_0x809a201:
            // 0x809a201
            v12 = 119;
          lab_0x809a201_2:
            // 0x809a201
            v5 = v12;
            v2 = *v4;
            v6 = v5;
            v7 = v3;
            if (v2 == 0) {
                goto lab_0x809a20f_2;
            }
        }
      lab_0x809a1c0:
        // 0x809a1c0
        if (WWW_TraceFlag != 0) {
            // 0x809a1cb
            fprintf(TraceFP(), "%s @%d: BUG\n", "./LYUtils.c", 0x1742);
        }
        // 0x809a52f
        return NULL;
    }
  lab_0x809a20f_2:
    // 0x809a20f
    if (lynx_temp_subspace != 0) {
        goto lab_0x809a3ab_2;
    } else {
        // 0x809a21c
        int32_t v14; // bp-128, 0x809a118
        if (lstat64(lynx_temp_space, &v14) != 0) {
            goto lab_0x809a2a7;
        } else {
            int32_t v15; // 0x809a118
            if ((v15 & 0xf000) != 0x4000) {
                goto lab_0x809a2a7;
            } else {
                // 0x809a247
                if ((v15 & 18) == 0 == v15 == getuid()) {
                    // 0x809a3a1
                    lynx_temp_subspace = -1;
                    goto lab_0x809a3ab_2;
                } else {
                    // 0x809a25d
                    if (WWW_TraceFlag != 0) {
                        // 0x809a26c
                        fprintf(TraceFP(), "lynx_temp_space is not our directory %s owner %d mode %03o\n", (char *)lynx_temp_space, v15, v15 % 512);
                    }
                    goto lab_0x809a2e1;
                }
            }
        }
    }
  lab_0x809a48c_2:;
    int32_t * mem = calloc(1, 16); // 0x809a49b
    if (mem == NULL) {
        // 0x809a4e9
        outofmem("./LYUtils.c", "LYOpenTemp");
        // UNREACHABLE
    }
    // 0x809a4a9
    *mem = (int32_t)ly_temp;
    int32_t v16 = (int32_t)mem; // 0x809a4b4
    HTSACopy((char **)(v16 + 4), result);
    int32_t v17; // 0x809a118
    *(int32_t *)(v16 + 12) = v17;
    *(char *)(v16 + 8) = (char)(v6 != 114);
    *(int32_t *)&ly_temp = v16;
    struct _IO_FILE * result2; // 0x809a118
    if (WWW_TraceFlag == 0) {
        // 0x809a526
        result2 = (struct _IO_FILE *)v17;
        return result2;
    } else {
        // 0x809a508
        fprintf(TraceFP(), "... LYOpenTemp(%s)\n", result);
        // 0x809a526
        result2 = (struct _IO_FILE *)v17;
        return result2;
    }
  lab_0x809a421:;
    // 0x809a421
    struct _IO_FILE * v18; // 0x809a118
    int32_t v19 = (int32_t)v18;
    bool v20 = true; // 0x809a425
    int32_t v21 = v19; // 0x809a425
    v17 = v19;
    if (v18 != NULL) {
        goto lab_0x809a48c_2;
    }
    goto lab_0x809a427;
  lab_0x809a427:
    // 0x809a427
    if (*__errno_location() != 17) {
        // 0x809a433
        result2 = NULL;
        if (WWW_TraceFlag == 0) {
            goto lab_0x809a52f;
        } else {
            char * err_str = strerror(*__errno_location()); // 0x809a448
            fprintf(TraceFP(), "... LYOpenTemp(%s) failed: %s\n", result, err_str);
            result2 = NULL;
            goto lab_0x809a52f;
        }
    }
    int32_t v22 = v21; // 0x809a486
    v17 = v21;
    if (!v20) {
        goto lab_0x809a48c_2;
    }
    goto lab_0x809a3ab;
  lab_0x809a3ab_2:
    // 0x809a3ab
    v22 = 0;
    while (true) {
      lab_0x809a3ab:
        // 0x809a3ab
        result2 = NULL;
        if (fmt_tempname(result, (char *)lynx_temp_space, suffix) == 0) {
            // break -> 0x809a52f
            break;
        }
        if (v7 == 0) {
            // 0x809a413
            v18 = LYNewBinFile(result);
            goto lab_0x809a421;
        } else {
            if (v6 == 97) {
                // 0x809a403
                v18 = LYAppendToTxtFile(result);
                goto lab_0x809a421;
            } else {
                if (v6 != 119) {
                    // 0x809a421
                    v20 = v22 == 0;
                    v21 = v22;
                    goto lab_0x809a427;
                } else {
                    // 0x809a3f3
                    v18 = LYNewTxtFile(result);
                    goto lab_0x809a421;
                }
            }
        }
    }
  lab_0x809a52f:
    // 0x809a52f
    return result2;
  lab_0x809a2a7:
    // 0x809a2a7
    if (WWW_TraceFlag != 0) {
        // 0x809a2b6
        fprintf(TraceFP(), "lynx_temp_space is not a directory %s\n", (char *)lynx_temp_space);
    }
    goto lab_0x809a2e1;
  lab_0x809a2e1:;
    int32_t cmask = umask(63); // 0x809a2e8
    HTSACat((char **)&lynx_temp_space, "lynxXXXXXXXXXX");
    if (mkdtemp((char *)lynx_temp_space) == NULL) {
        // 0x809a315
        printf("%s: %s\n", (char *)lynx_temp_space, strerror(*__errno_location()));
        exit_immediately(1);
        // UNREACHABLE
    }
    // 0x809a34a
    umask(cmask);
    lynx_temp_subspace = 1;
    HTSACat((char **)&lynx_temp_space, "/");
    if (WWW_TraceFlag != 0) {
        // 0x809a37e
        fprintf(TraceFP(), "made subdirectory %s\n", (char *)lynx_temp_space);
    }
    goto lab_0x809a3ab_2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809a540 - 0x809a58d
// Line range:    6046 - 6055
struct _IO_FILE * LYReopenTemp(char * name) {
    // 0x809a540
    LYCloseTemp(name);
    int32_t * v1 = FindTempfileByName(name); // 0x809a55e
    struct _IO_FILE * result = NULL; // 0x809a56a
    if (v1 != NULL) {
        // 0x809a56c
        result = LYAppendToTxtFile(name);
        *(int32_t *)((int32_t)v1 + 12) = (int32_t)result;
    }
    // 0x809a588
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809a58d - 0x809a9d7
// Line range:    6075 - 6215
struct _IO_FILE * LYOpenTempRewrite(char * fname, char * suffix, char * mode) {
    // 0x809a58d
    if (WWW_TraceFlag != 0) {
        // 0x809a5c1
        fprintf(TraceFP(), "LYOpenTempRewrite(%s,%s,%s)\n", fname, suffix, mode);
    }
    // 0x809a5ef
    if (*fname == 0) {
        // 0x809a9c8
        return LYOpenTemp(fname, suffix, mode);
    }
    int32_t * v1 = FindTempfileByName(fname); // 0x809a623
    if (v1 == NULL) {
        // 0x809a9c8
        return LYOpenTemp(fname, suffix, mode);
    }
    int32_t * v2 = (int32_t *)((int32_t)v1 + 12);
    int32_t v3 = *v2; // 0x809a638
    if (WWW_TraceFlag != 0) {
        // 0x809a64e
        fprintf(TraceFP(), "...used before%s\n", v3 == 0 ? "." : ", still open!");
    }
    char v4 = HTEditable(fname); // 0x809a69b
    char v5 = 0; // 0x809a6a7
    if (v4 != 0) {
        // 0x809a6a9
        v5 = IsOurFile(fname);
    }
    // 0x809a6b7
    if (WWW_TraceFlag != 0) {
        char * v6 = v4 == 0 ? (char *)&g25 : "exists and is writable, ";
        fprintf(TraceFP(), "...%s%s\n", v6, v5 == 0 ? "is NOT our file." : "is our file.");
    }
    if (v3 != 0) {
        // 0x809a9c8
        return LYOpenTemp(fname, suffix, mode);
    }
    if (v4 != 0 && v5 == 0) {
        // 0x809a9c8
        return LYOpenTemp(fname, suffix, mode);
    }
    if (v5 == 0) {
        // 0x809a7b3
        int32_t v7; // bp-120, 0x809a58d
        if (lstat64((int32_t)fname, &v7) == 0) {
            // 0x809a9c8
            return LYOpenTemp(fname, suffix, mode);
        }
    }
    char v8 = *mode; // 0x809a86a
    char v9 = v8; // 0x809a86f
    char * v10 = mode; // 0x809a86f
    char v11 = 114; // 0x809a86f
    char v12 = 1; // 0x809a86f
    char v13 = 1; // 0x809a86f
    char v14 = 114; // 0x809a86f
    char * v15 = mode; // 0x809a86f
    char v16; // 0x809a58d
    char * v17; // 0x809a58d
    char v18; // 0x809a58d
    char v19; // 0x809a58d
    char v20; // 0x809a58d
    if (v8 != 0) {
        while (true) {
            // 0x809a7f1
            v20 = v12;
            v16 = v9;
            v17 = v10;
            v18 = v11;
            while (true) {
              lab_0x809a7f1:
                // 0x809a7f1
                v10 = (char *)((int32_t)v17 + 1);
                v19 = 119;
                switch (v16) {
                    case 98: {
                        goto lab_0x809a821;
                    }
                    case 119: {
                        goto lab_0x809a867;
                    }
                    case 97: {
                        // 0x809a81b
                        v19 = 97;
                        goto lab_0x809a867;
                    }
                    default: {
                        goto lab_0x809a827;
                    }
                }
            }
          lab_0x809a821:
            // 0x809a821
            v11 = v18;
            v9 = *v10;
            v12 = 0;
            v13 = 0;
            v14 = v11;
            v15 = v10;
            if (v9 == 0) {
                goto lab_0x809a871_2;
            }
        }
      lab_0x809a827:
        // 0x809a827
        if (WWW_TraceFlag != 0) {
            // 0x809a832
            fprintf(TraceFP(), "%s @%d: BUG\n", "./LYUtils.c", 0x180d);
        }
        // 0x809a9c8
        return NULL;
    }
  lab_0x809a871_2:
    // 0x809a871
    if (v5 != 0) {
        if (v13 == 1) {
            // 0x809a885
            if (truncate64(fname, 0) == 0) {
                // 0x809a9c8
                return LYReopenTemp(fname);
            }
            // 0x809a8a4
            if (WWW_TraceFlag != 0) {
                char * err_str = strerror(*__errno_location()); // 0x809a8b9
                fprintf(TraceFP(), "... truncate(%s,0) failed: %s\n", fname, err_str);
            }
            // 0x809a9c8
            return LYOpenTemp(fname, suffix, v15);
        }
        // 0x809a91e
        remove(fname);
    }
    char v21; // 0x809a58d
    if (v13 == 0) {
        // 0x809a962
        v21 = (int32_t)LYNewBinFile(fname);
    } else {
        if (v14 == 97) {
            // 0x809a952
            v21 = (int32_t)LYAppendToTxtFile(fname);
        } else {
            // 0x809a93c
            v21 = 0;
            if (v14 == 119) {
                // 0x809a942
                v21 = (int32_t)LYNewTxtFile(fname);
            }
        }
    }
    int32_t v22 = v21; // 0x809a973
    *v2 = v22;
    if (WWW_TraceFlag != 0) {
        struct _IO_FILE * stream = TraceFP(); // 0x809a99a
        char * v23 = v21 == 0 ? "failed" : (char *)&g29; // 0x809a9b8
        fprintf(stream, "... LYOpenTempRewrite(%s), %s\n", fname, v23);
    }
    // 0x809a9c8
    return (struct _IO_FILE *)v22;
  lab_0x809a867:;
    char v24 = *v10; // 0x809a86a
    v16 = v24;
    v17 = v10;
    v18 = v19;
    v13 = v20;
    v14 = v19;
    v15 = v10;
    if (v24 == 0) {
        goto lab_0x809a871_2;
    }
    goto lab_0x809a7f1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809a9d7 - 0x809aab3
// Line range:    6223 - 6242
struct _IO_FILE * LYOpenScratch(char * result, char * prefix) {
    // 0x809a9d7
    if (fmt_tempname(result, prefix, ".html") == 0) {
        // 0x809aaae
        return NULL;
    }
    struct _IO_FILE * result2 = LYNewTxtFile(result); // 0x809aa0d
    if (result2 != NULL) {
        int32_t * mem = calloc(1, 16); // 0x809aa2a
        if (mem == NULL) {
            // 0x809aa6b
            outofmem("./LYUtils.c", "LYOpenScratch");
            // UNREACHABLE
        }
        // 0x809aa38
        *mem = (int32_t)ly_temp;
        int32_t v1 = (int32_t)mem; // 0x809aa43
        HTSACopy((char **)(v1 + 4), result);
        *(int32_t *)(v1 + 12) = (int32_t)result2;
        *(int32_t *)&ly_temp = v1;
    }
    // 0x809aa7f
    if (WWW_TraceFlag != 0) {
        // 0x809aa8a
        fprintf(TraceFP(), "LYOpenScratch(%s)\n", result);
    }
    // 0x809aaae
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809aab3 - 0x809aaf8
// Line range:    6245 - 6254
void LY_close_temp(int32_t * p) {
    int32_t v1 = (int32_t)p;
    int32_t * v2 = (int32_t *)(v1 + 12); // 0x809aabc
    int32_t v3 = *v2; // 0x809aabc
    if (v3 == 0) {
        // 0x809aaf6
        return;
    }
    struct _IO_FILE * v4 = (struct _IO_FILE *)v3;
    if (*(char *)(v1 + 8) == 0) {
        // 0x809aade
        LYCloseInput(v4);
    } else {
        // 0x809aace
        LYCloseOutput(v4);
    }
    // 0x809aaec
    *v2 = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809aaf8 - 0x809ab92
// Line range:    6260 - 6269
void LYCloseTemp(char * name) {
    // 0x809aaf8
    if (WWW_TraceFlag != 0) {
        // 0x809ab09
        fprintf(TraceFP(), "LYCloseTemp(%s)\n", name);
    }
    int32_t * v1 = FindTempfileByName(name); // 0x809ab2d
    if (v1 == NULL) {
        // 0x809ab90
        return;
    }
    // 0x809ab3b
    if (WWW_TraceFlag != 0) {
        int32_t v2 = *(int32_t *)((int32_t)v1 + 12); // 0x809ab49
        char * v3 = v2 == 0 ? (char *)&g25 : ", closed";
        fprintf(TraceFP(), "...LYCloseTemp(%s)%s\n", name, v3);
    }
    // 0x809ab85
    LY_close_temp(v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809ab92 - 0x809ac0c
// Line range:    6275 - 6283
void LYCloseTempFP(struct _IO_FILE * fp) {
    // 0x809ab92
    if (WWW_TraceFlag != 0) {
        // 0x809aba4
        fprintf(TraceFP(), "LYCloseTempFP\n");
    }
    int32_t * v1 = FindTempfileByFP(fp); // 0x809abc1
    if (v1 == NULL) {
        // 0x809ac06
        return;
    }
    // 0x809abcf
    LY_close_temp(v1);
    if (WWW_TraceFlag != 0) {
        int32_t v2 = *(int32_t *)((int32_t)v1 + 4); // 0x809abe8
        fprintf(TraceFP(), "...LYCloseTempFP(%s)\n", (char *)v2);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809ac0c - 0x809ad7b
// Line range:    6289 - 6314
int32_t LYRemoveTemp(char * name) {
    // 0x809ac0c
    if (name == NULL || *name == 0) {
        // 0x809ad76
        return (int32_t)(int32_t *)-1;
    }
    // 0x809ac31
    if (WWW_TraceFlag != 0) {
        // 0x809ac3c
        fprintf(TraceFP(), "LYRemoveTemp(%s)\n", name);
    }
    // 0x809ac5a
    if (ly_temp == NULL) {
        // 0x809ad76
        return (int32_t)(int32_t *)-1;
    }
    int32_t v1 = (int32_t)ly_temp; // 0x809ac5a
    int32_t * str = (int32_t *)(v1 + 4);
    int32_t * v2; // 0x809ac0c
    int32_t * v3; // 0x809ac0c
    int32_t v4; // 0x809ac0c
    int32_t * v5; // 0x809ac0c
    int32_t * str2; // 0x809ac0c
    int32_t v6; // 0x809ac0c
    int32_t v7; // 0x809ad67
    if (strcmp(name, (char *)*str) != 0) {
        int32_t * v8 = ly_temp;
        v7 = *v8;
        while (v7 != 0) {
            // 0x809ac6e
            v5 = (int32_t *)v7;
            str2 = (int32_t *)(v7 + 4);
            if (strcmp(name, (char *)*str2) == 0) {
                // 0x809ac8b
                v6 = *v5;
                if (v8 == NULL) {
                    goto lab_0x809ac9d;
                } else {
                    // 0x809ac91
                    *v8 = v6;
                    v2 = str2;
                    v4 = v7;
                    v3 = v5;
                    goto lab_0x809aca7;
                }
            }
            v8 = v5;
            v7 = *v8;
        }
        // 0x809ad76
        return (int32_t)(int32_t *)-1;
    }
    // 0x809ac8b
    v6 = *ly_temp;
    str2 = str;
    v7 = v1;
    v5 = ly_temp;
    goto lab_0x809ac9d;
  lab_0x809ac9d:
    // 0x809ac9d
    *(int32_t *)&ly_temp = v6;
    v2 = str2;
    v4 = v7;
    v3 = v5;
    goto lab_0x809aca7;
  lab_0x809aca7:
    // 0x809aca7
    LY_close_temp(v3);
    int32_t remove_rc = remove(name); // 0x809acb8
    if (WWW_TraceFlag != 0) {
        int32_t v9 = *(int32_t *)(v4 + 12); // 0x809acce
        int32_t v10 = v9 == 0 ? (int32_t)&g25 : (int32_t)", closed";
        fprintf(TraceFP(), "...LYRemoveTemp done(%d)%s\n", remove_rc, (char *)v10);
        if (WWW_TraceFlag != 0) {
            // 0x809ad15
            fflush(TraceFP());
        }
    }
    int32_t v11 = *v2; // 0x809ad25
    if (v11 != 0) {
        // 0x809ad2c
        free((int32_t *)v11);
        *v2 = 0;
    }
    // 0x809ad4a
    free(v3);
    // 0x809ad76
    return (int32_t)(int32_t *)remove_rc;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809ad7b - 0x809ae37
// Line range:    6321 - 6336
void LYCleanupTemp(void) {
    int32_t v1 = __readgsdword(20); // 0x809ad84
    if (ly_temp != NULL) {
        LYRemoveTemp((char *)(0x1000000 * *(int32_t *)&can_do_colors >> 24));
        while (ly_temp != NULL) {
            // 0x809ad91
            LYRemoveTemp((char *)(0x1000000 * *(int32_t *)&can_do_colors >> 24));
        }
    }
    // 0x809adaa
    if (lynx_temp_subspace >= 1) {
        // 0x809adb3
        int32_t v2; // bp-264, 0x809ad7b
        char * path = (char *)(0x1000000 * (int32_t)&v2 >> 24); // 0x809adcd
        LYstrncpy(path, (char *)lynx_temp_space, 255);
        LYTrimPathSep(path);
        if (WWW_TraceFlag != 0) {
            struct _IO_FILE * v3 = TraceFP(); // 0x809adeb
            fprintf((struct _IO_FILE *)(0x1000000 * (int32_t)v3 >> 24), "LYCleanupTemp removing %s\n", &v2);
        }
        // 0x809ae0c
        rmdir(path);
        lynx_temp_subspace = -1;
    }
    // 0x809ae24
    if (v1 != __readgsdword(20)) {
        // 0x809ae30
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809ae9a - 0x809af23
// Line range:    6357 - 6374
void LYCheckBibHost(void) {
    int32_t v1 = 0; // bp-28, 0x809aea0
    HTSACopy((char **)&v1, (char *)BibP_bibhost);
    HTSACat((char **)&v1, "bibp1.0/bibpicon.jpg");
    char v2 = traversal; // 0x809aeeb
    traversal = 1;
    BibP_bibhost_available = HTLoadAbsolute(&v1) == 1;
    traversal = v2;
    BibP_bibhost_checked = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809af23 - 0x809b164
// Line range:    6434 - 6465
char LYIsUIPage3(char * url, int32_t type, uint32_t flagparam) {
    // 0x809af23
    if (url == NULL) {
        // 0x809b15e
        return 0;
    }
    int32_t v1 = 0; // 0x809af2d
    int32_t v2 = 20 * v1; // 0x809af4e
    while (*(int32_t *)(v2 + (int32_t)&ly_uip) != type) {
        // 0x809b150
        v1++;
        if (v1 >= 13) {
            // 0x809b15e
            return 0;
        }
        v2 = 20 * v1;
    }
    int32_t * str2 = (int32_t *)(v2 + (int32_t)&g110); // 0x809af6d
    int32_t v3 = *str2; // 0x809af6d
    if (v3 == 0) {
        // 0x809b15e
        return 0;
    }
    char * str = (char *)v3;
    if (flagparam % 2 == 0) {
        // 0x809b010
        if (strcmp(str, url) == 0) {
            // 0x809b15e
            return 1;
        }
    } else {
        int32_t len = strlen(str); // 0x809afa4
        if (strncmp((char *)*str2, url, len) == 0) {
            char v4 = *(char *)(len + (int32_t)url); // 0x809afe1
            if (v4 != 0 != v4 != 35) {
                // 0x809b15e
                return 1;
            }
        }
    }
    // 0x809b047
    if (*(int32_t *)(v2 + (int32_t)&g109) % 2 == 0) {
        // 0x809b15e
        return 0;
    }
    int32_t v5 = *(int32_t *)(v2 + (int32_t)&g111); // 0x809b07b
    char result = 0; // 0x809b114
    while (v5 != 0) {
        // 0x809b116
        v5 += 4;
        result = 0;
        if (v5 == 0) {
            // break -> 0x809b15e
            break;
        }
        int32_t v6 = *(int32_t *)v5; // 0x809b128
        result = 0;
        if (v6 == 0) {
            // break -> 0x809b15e
            break;
        }
        char * str3 = (char *)v6;
        char v7; // 0x809af23
        if (flagparam % 2 == 0) {
            // 0x809b0ec
            v7 = strcmp(str3, url) == 0;
        } else {
            int32_t len2 = strlen(str3); // 0x809b090
            v7 = 0;
            if (strncmp(str3, url, len2) == 0) {
                char v8 = *(char *)(len2 + (int32_t)url); // 0x809b0bd
                v7 = 0;
                result = 1;
                if (v8 != 0 != v8 != 35) {
                    // break -> 0x809b15e
                    break;
                }
            }
        }
        // 0x809b104
        result = 1;
        if (v7 != 0) {
            // break -> 0x809b15e
            break;
        }
        result = 0;
    }
    // 0x809b15e
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809b164 - 0x809b3ef
// Line range:    6469 - 6508
void LYRegisterUIPage(char * url, int32_t type) {
    int32_t v1 = 0; // 0x809b3db
    int32_t v2 = 20 * v1; // 0x809b181
    while (*(int32_t *)(v2 + (int32_t)&ly_uip) != type) {
        // 0x809b3df
        v1++;
        if (v1 >= 13) {
            // 0x809b3e9
            return;
        }
        v2 = 20 * v1;
    }
    int32_t * str3 = (int32_t *)(v2 + (int32_t)&g110); // 0x809b1a0
    int32_t str = *str3; // 0x809b1a0
    int32_t v3 = str; // 0x809b1a8
    if (url != NULL && str != 0) {
        // 0x809b1b0
        if (strcmp((char *)str, url) == 0) {
            // 0x809b3e9
            return;
        }
        // 0x809b1b0
        v3 = *str3;
    }
    // 0x809b1da
    if (url == NULL || v3 == 0) {
        // 0x809b211
        HTSACopy((char **)(v2 + (int32_t)&ly_uip + 8), url);
        // 0x809b3e9
        return;
    }
    int32_t * v4 = (int32_t *)(v2 + (int32_t)&g109); // 0x809b204
    if (*v4 % 2 == 0) {
        // 0x809b211
        HTSACopy((char **)(v2 + (int32_t)&ly_uip + 8), url);
        // 0x809b3e9
        return;
    }
    int32_t * v5 = (int32_t *)(v2 + (int32_t)&g111); // 0x809b24e
    int32_t v6 = *v5; // 0x809b24e
    int32_t v7 = 0; // 0x809b2ca
    int32_t v8; // 0x809b164
    if (v6 == 0) {
        goto lab_0x809b313;
    } else {
        int32_t v9 = *(int32_t *)(v6 + 4); // 0x809b2cf
        int32_t v10 = v9; // 0x809b2d9
        int32_t v11 = 0; // 0x809b2d9
        v7 = 0;
        if (v9 != 0) {
            int32_t v12 = *(int32_t *)v10; // 0x809b2de
            v7 = v11;
            while (v12 != 0) {
                char * str2 = (char *)v12; // 0x809b266
                if (strcmp(str2, url) == 0) {
                    // 0x809b3e9
                    return;
                }
                // 0x809b273
                if (strcmp(str2, (char *)*str3) == 0) {
                    // 0x809b299
                    HTSACopy((char **)(v2 + (int32_t)&ly_uip + 8), url);
                    return;
                }
                int32_t v13 = v11 + 1; // 0x809b2c2
                int32_t v14 = *(int32_t *)(v10 + 4); // 0x809b2cf
                v10 = v14;
                v11 = v13;
                v7 = v13;
                if (v14 == 0) {
                    // break -> 0x809b2fc
                    break;
                }
                v12 = *(int32_t *)v10;
                v7 = v11;
            }
        }
        int32_t v15 = *v5;
        v8 = v15;
        if (v15 != 0) {
            goto lab_0x809b32d;
        } else {
            goto lab_0x809b313;
        }
    }
  lab_0x809b313:;
    int32_t v16 = (int32_t)HTList_new(); // 0x809b316
    *v5 = v16;
    v8 = v16;
    goto lab_0x809b32d;
  lab_0x809b32d:;
    int32_t v17 = v8; // 0x809b335
    if (v7 >= HTCacheSize) {
        // 0x809b337
        v17 = v8;
        if ((*v4 & 2) != 0) {
            // 0x809b351
            HTList_removeFirstObject((int32_t *)v8);
            v17 = *v5;
        }
    }
    // 0x809b36c
    HTList_addObject((int32_t *)v17, (char *)*str3);
    *str3 = 0;
    HTSACopy((char **)(v2 + (int32_t)&ly_uip + 8), url);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809b4d5 - 0x809b4ed
// Line range:    6527 - 6541
char * wwwName(char * pathname) {
    // 0x809b4d5
    return pathname;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809b4ed - 0x809b6de
// Line range:    6552 - 6634
char LYValidateFilename(char * result, char * given) {
    // 0x809b4ed
    if (strcmp(given, "/dev/null") == 0) {
        // 0x809b6d4
        return 0;
    }
    // 0x809b514
    char result2; // 0x809b4ed
    if (*given == 124) {
        // 0x809b51e
        if (no_shell == 0) {
            // 0x809b546
            LYstrncpy(result, given, 256);
            result2 = 1;
        } else {
            // 0x809b529
            HTUserMsg(gettext("Spawning is currently disabled."));
            result2 = 0;
        }
        // 0x809b6d4
        return result2;
    }
    char * v1 = FindLeadingTilde(given, 1); // 0x809b577
    if (v1 != given) {
        char * str = wwwName(Home_Dir()); // 0x809b593
        if (str != NULL) {
            // 0x809b5a1
            if (strlen(given) + strlen(str) < 256) {
                // 0x809b5c3
                *v1 = 0;
                strcpy(result, given);
                LYTrimPathSep(result);
                strcat(result, str);
                strcat(result, (char *)((int32_t)v1 + 1));
                strcpy(given, result);
            }
        }
    }
    // 0x809b620
    if (LYisAbsPath(given) != 0) {
        // 0x809b647
        *result = 0;
    } else {
        char * str2 = Current_Dir((char *)&g291); // 0x809b636
        *result = 0;
        if (str2 != NULL) {
            // 0x809b653
            LYTrimPathSep(str2);
            if (strlen(str2) >= 254) {
                // 0x809b6d4
                return 0;
            }
            // 0x809b676
            sprintf(result, "%s/", str2);
        }
    }
    int32_t len = strlen(result); // 0x809b69c
    result2 = 0;
    if (strlen(given) + len < 255) {
        // 0x809b6be
        strcat(result, given);
        result2 = 1;
    }
    // 0x809b6d4
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809b6de - 0x809b7a9
// Line range:    6646 - 6681
int32_t LYValidateOutput(char * filename) {
    // 0x809b6de
    if (*filename == 124) {
        // 0x809b7a4
        return 89;
    }
    // 0x809b6fa
    if (no_dotfiles != 0) {
        goto lab_0x809b710;
    } else {
        // 0x809b705
        if (show_dotfiles != 0) {
            goto lab_0x809b73f;
        } else {
            goto lab_0x809b710;
        }
    }
  lab_0x809b710:
    // 0x809b710
    if (*LYPathLeaf(filename) == 46) {
        // 0x809b722
        HTAlert(gettext("File name may not begin with a dot."));
        // 0x809b7a4
        return 78;
    }
    goto lab_0x809b73f;
  lab_0x809b73f:
    // 0x809b73f
    if (LYCanReadFile(filename) == 0) {
        // 0x809b7a4
        return 89;
    }
    char v1 = HTConfirm(gettext("File exists.  Overwrite?")); // 0x809b75d
    if (HTLastConfirmCancelled() != 0) {
        // 0x809b771
        HTInfoMsg(gettext("Save request cancelled!!!"));
        // 0x809b7a4
        return 3;
    }
    // 0x809b78e
    if (v1 != 0) {
        // 0x809b7a4
        return 89;
    }
    // 0x809b7a4
    return 78;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809b7a9 - 0x809b890
// Line range:    6688 - 6706
void LYLocalFileToURL(char ** target, char * source) {
    int32_t v1 = __readgsdword(20); // 0x809b7c4
    HTSACopy(target, "file://localhost");
    char * v2 = wwwName(source); // 0x809b7ee
    if (LYisAbsPath(source) == 0) {
        // 0x809b80b
        int32_t v3; // bp-264, 0x809b7a9
        Current_Dir((char *)&v3);
        if ((char)v3 != 47) {
            // 0x809b824
            LYAddHtmlSep(target);
        }
        // 0x809b832
        HTSACat(target, (char *)&v3);
    }
    // 0x809b84a
    if (*v2 != 47) {
        // 0x809b857
        LYAddHtmlSep(target);
    }
    // 0x809b865
    HTSACat(target, v2);
    if (v1 != __readgsdword(20)) {
        // 0x809b889
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809b890 - 0x809b90f
// Line range:    6714 - 6727
struct _IO_FILE * InternalPageFP(char * filename, int32_t reuse_flag) {
    // 0x809b890
    struct _IO_FILE * result; // 0x809b890
    if (reuse_flag == 0 || LYReuseTempfiles == 0) {
        // 0x809b8c7
        LYRemoveTemp(filename);
        result = LYOpenTemp(filename, ".html", "wb");
    } else {
        // 0x809b8a7
        result = LYOpenTempRewrite(filename, ".html", "wb");
    }
    // 0x809b8f0
    if (result == NULL) {
        // 0x809b8f6
        HTAlert(gettext("Can't open temporary file!"));
    }
    // 0x809b90a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809b90f - 0x809ba23
// Line range:    6733 - 6755
void WriteInternalTitle(struct _IO_FILE * fp0, char * Title) {
    // 0x809b90f
    fwrite((int32_t *)"<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\">\n", 1, 64, fp0);
    fwrite((int32_t *)"<html>\n<head>\n", 1, 14, fp0);
    LYAddMETAcharsetToFD(fp0, -1);
    if (strcmp(Title, gettext("List Page")) != 0 || strchr(HTLoadedDocumentURL(), 34) != NULL) {
        // 0x809ba07
        fprintf(fp0, "<title>%s</title>\n</head>\n<body>\n", Title);
        return;
    }
    char * v1 = NULL; // bp-8, 0x809b9a6
    char * v2 = HTLoadedDocumentURL(); // 0x809b9ad
    HTSACopy(&v1, v2);
    LYEntify(&v1, 0);
    fprintf(fp0, "<base href=\"%s\">\n", v1);
    if (v1 != NULL) {
        // 0x809b9f5
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x809ba07
    fprintf(fp0, "<title>%s</title>\n</head>\n<body>\n", Title);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809ba23 - 0x809baf1
// Line range:    6763 - 6776
void BeginInternalPage(struct _IO_FILE * fp0, char * Title, char * HelpURL) {
    // 0x809ba23
    WriteInternalTitle(fp0, Title);
    if (user_mode != 0 || HelpURL == NULL | LYwouldPush(Title, NULL) == 0) {
        // 0x809bab1
        fprintf(fp0, "<h1>%s (%s%s%s)</h1>\n", Title, "Lynx", gettext(" Version "), "2.8.7dev.11");
        // 0x809baeb
        return;
    }
    // 0x809ba62
    fprintf(fp0, "<h1>%s (%s%s%s), <a href=\"%s%s\">help</a></h1>\n", Title, "Lynx", gettext(" Version "), "2.8.7dev.11", (char *)helpfilepath, HelpURL);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809baf1 - 0x809bb1c
// Line range:    6779 - 6781
void EndInternalPage(struct _IO_FILE * fp0) {
    // 0x809baf1
    fwrite((int32_t *)"</body>\n</html>", 1, 15, fp0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809bb1c - 0x809bb49
// Line range:    6784 - 6790
char * trimPoundSelector(char * address) {
    char * found_char_pos = strchr(address, 35); // 0x809bb30
    if (found_char_pos != NULL) {
        // 0x809bb3e
        *found_char_pos = 0;
    }
    // 0x809bb44
    return found_char_pos;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809bb49 - 0x809bb87
// Line range:    6797 - 6804
void LYTrimPathSep(char * path) {
    if (path == NULL) {
        // 0x809bb85
        return;
    }
    int32_t len = strlen(path); // 0x809bb5b
    if (len == 0) {
        // 0x809bb85
        return;
    }
    char * v1 = (char *)((int32_t)path - 1 + len); // 0x809bb72
    if (*v1 == 47) {
        // 0x809bb79
        *v1 = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809bb87 - 0x809bbda
// Line range:    6811 - 6821
void LYAddPathSep(char ** path) {
    if (path == NULL) {
        // 0x809bbd8
        return;
    }
    char * str = *path;
    if (str == NULL) {
        // 0x809bbd8
        return;
    }
    int32_t len = strlen(str); // 0x809bba7
    if (len == 0) {
        // 0x809bbd8
        return;
    }
    // 0x809bbb5
    if (*(char *)((int32_t)str - 1 + len) != 47) {
        // 0x809bbc5
        HTSACat(path, "/");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809bc28 - 0x809bc49
// Line range:    6843 - 6853
char * LYLastPathSep(char * path) {
    // 0x809bc28
    return strrchr(path, 47);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809bc49 - 0x809bc87
// Line range:    6860 - 6867
void LYTrimHtmlSep(char * path) {
    if (path == NULL) {
        // 0x809bc85
        return;
    }
    int32_t len = strlen(path); // 0x809bc5b
    if (len == 0) {
        // 0x809bc85
        return;
    }
    char * v1 = (char *)((int32_t)path - 1 + len); // 0x809bc72
    if (*v1 == 47) {
        // 0x809bc79
        *v1 = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809bc87 - 0x809bcda
// Line range:    6874 - 6884
void LYAddHtmlSep(char ** path) {
    if (path == NULL) {
        // 0x809bcd8
        return;
    }
    char * str = *path;
    if (str == NULL) {
        // 0x809bcd8
        return;
    }
    int32_t len = strlen(str); // 0x809bca7
    if (len == 0) {
        // 0x809bcd8
        return;
    }
    // 0x809bcb5
    if (*(char *)((int32_t)str - 1 + len) != 47) {
        // 0x809bcc5
        HTSACat(path, "/");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809bd28 - 0x809bfc3
// Line range:    6907 - 6951
int32_t LYCopyFile(char * src, char * dst) {
    int32_t v1 = __readgsdword(20); // 0x809bd44
    char * v2 = HTGetProgramPath(4); // 0x809bd56
    int32_t v3; // 0x809bd28
    int32_t v4; // 0x809bd28
    if (v2 == NULL) {
        struct _IO_FILE * stream = fopen64(src, "rb"); // 0x809be9e
        v3 = -1;
        if (stream == NULL) {
            goto lab_0x809bf8f;
        } else {
            struct _IO_FILE * stream2 = fopen64(dst, "wb"); // 0x809bec7
            int32_t v5 = -1; // 0x809bed9
            if (stream2 != NULL) {
                int32_t data; // bp-8204, 0x809bd28
                int32_t items_read = fread(&data, 1, 0x2000, stream); // 0x809bf56
                int32_t v6 = 0; // 0x809bf68
                while (items_read >= 0 == (items_read != 0)) {
                    // 0x809beeb
                    fwrite(&data, 1, items_read, stream2);
                    v6 = -1;
                    if (ferror(stream2) != 0) {
                        // break -> 0x809bf6a
                        break;
                    }
                    items_read = fread(&data, 1, 0x2000, stream);
                    v6 = 0;
                }
                // 0x809bf6a
                LYCloseOutput(stream2);
                v5 = v6;
            }
            // 0x809bf78
            LYCloseInput(stream);
            v4 = v5;
            goto lab_0x809bf86;
        }
    } else {
        int32_t code = 0; // bp-8216, 0x809bd6e
        HTAddParam((char **)&code, "%s %s %s", 1, v2);
        HTAddParam((char **)&code, "%s %s %s", 2, src);
        HTAddParam((char **)&code, "%s %s %s", 3, dst);
        HTEndParam((char **)&code, "%s %s %s", 3);
        if (WWW_TraceFlag != 0) {
            // 0x809be19
            fprintf(TraceFP(), "command: %s\n", (char *)code);
        }
        // 0x809be3a
        stop_curses();
        int32_t v7 = LYSystem((char *)code); // 0x809be48
        start_curses();
        v4 = v7;
        if (code != 0) {
            // 0x809be66
            free((int32_t *)code);
            code = 0;
            v4 = v7;
        }
        goto lab_0x809bf86;
    }
  lab_0x809bf8f:
    // 0x809bf8f
    HTAlert(gettext("Cannot write to file."));
    int32_t v8 = v3; // 0x809bf9e
    goto lab_0x809bfa3;
  lab_0x809bf86:
    // 0x809bf86
    v3 = v4;
    v8 = 0;
    if (v4 == 0) {
        goto lab_0x809bfa3;
    } else {
        goto lab_0x809bf8f;
    }
  lab_0x809bfa3:;
    int32_t result = v8; // 0x809bfb3
    if (v1 != __readgsdword(20)) {
        // 0x809bfb5
        __stack_chk_fail();
        result = &g391;
    }
    // 0x809bfba
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809bfc3 - 0x809c13e
// Line range:    6985 - 7147
int32_t LYSystem(char * command) {
    // 0x809bfc3
    fflush((struct _IO_FILE *)g164);
    fflush((struct _IO_FILE *)g160);
    if (WWW_TraceFlag != 0) {
        // 0x809c021
        fprintf(TraceFP(), "LYSystem(%s)\n", command);
        if (WWW_TraceFlag != 0) {
            // 0x809c02c
            fflush(TraceFP());
        }
    }
    // 0x809c039
    if (restore_sigpipe_for_children != 0) {
        // 0x809c044
        signal(SIGPIPE, SIG_DFL);
    }
    bool v1 = true; // 0x809c061
    int32_t v2; // bp-160, 0x809bfc3
    if (dump_output_immediately == 0) {
        // 0x809c063
        v1 = true;
        if (LYCursesON == 0) {
            // 0x809c06e
            v1 = true;
            if (no_suspend == 0) {
                // 0x809c079
                v1 = LYToggleSigDfl(20, (struct sigaction *)&v2, 1) == 0;
            }
        }
    }
    int32_t system_rc = system(command); // 0x809c0a0
    int32_t * v3 = __errno_location(); // 0x809c0a8
    if (!v1) {
        // 0x809c0b8
        LYToggleSigDfl(20, (struct sigaction *)&v2, 0);
    }
    // 0x809c0d6
    if (restore_sigpipe_for_children != 0) {
        // 0x809c0e1
        signal(SIGPIPE, SIG_IGN);
    }
    // 0x809c0f5
    fflush((struct _IO_FILE *)g164);
    fflush((struct _IO_FILE *)g160);
    *__errno_location() = *v3;
    return system_rc;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c13e - 0x809c157
// Line range:    7195 - 7238
char * LYSysShell(void) {
    // 0x809c13e
    return "exec $SHELL";
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c157 - 0x809c16b
// Line range:    7250 - 7252
char * LYgetXDisplay(void) {
    // 0x809c157
    return LYGetEnv("DISPLAY");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c16b - 0x809c1c2
// Line range:    7259 - 7274
void LYsetXDisplay(char * new_display) {
    if (new_display == NULL) {
        // 0x809c1c0
        return;
    }
    // 0x809c177
    HTSprintf0((char **)&g292, "DISPLAY=%s", new_display);
    putenv((char *)g292);
    char * v1 = LYgetXDisplay(); // 0x809c19f
    if (v1 != NULL) {
        // 0x809c1ad
        HTSACopy((char **)&x_display, v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c1c2 - 0x809c209
// Line range:    7408 - 7413
void get_clip_release(void) {
    // 0x809c1c2
    if (paste_handle != NULL) {
        // 0x809c1d1
        pclose((struct _IO_FILE *)paste_handle);
    }
    // 0x809c1de
    if (paste_buf != 0) {
        // 0x809c1f0
        free((int32_t *)paste_buf);
        paste_buf = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c209 - 0x809c279
// Line range:    7416 - 7428
int32_t clip_grab(void) {
    char * command = LYGetEnv("RL_PASTE_CMD"); // 0x809c216
    if (paste_handle != NULL) {
        // 0x809c227
        pclose((struct _IO_FILE *)paste_handle);
    }
    int32_t result = 0; // 0x809c238
    if (command != NULL) {
        struct _IO_FILE * v1 = popen(command, "r"); // 0x809c251
        *(int32_t *)&paste_handle = (int32_t)v1;
        result = v1 != NULL;
    }
    // 0x809c274
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c279 - 0x809c3b8
// Line range:    7434 - 7459
char * get_clip_grab(void) {
    // 0x809c279
    if (clip_grab() == 0 || paste_handle == NULL) {
        // 0x809c3b3
        return NULL;
    }
    int32_t v1 = paste_buf; // 0x809c2b7
    if (v1 != 0) {
        // 0x809c2c9
        free((int32_t *)v1);
        paste_buf = 0;
    }
    int32_t * mem = malloc(1008); // 0x809c2e7
    paste_buf = (int32_t)mem;
    int32_t items_read = fread(mem, 1, 1007, (struct _IO_FILE *)paste_handle); // 0x809c31a
    *(char *)(paste_buf + items_read) = 0;
    int32_t v2 = items_read; // 0x809c33d
    int32_t v3 = 0; // 0x809c33d
    if (items_read < 1007) {
        // 0x809c3b3
        return (char *)paste_buf;
    }
    int32_t v4 = 1008; // 0x809c33d
    while (strchr((char *)(paste_buf + v3), 13) == NULL) {
        // 0x809c35f
        if (strchr((char *)(paste_buf + v3), 10) != NULL) {
            // break -> 0x809c3ab
            break;
        }
        // 0x809c37f
        v3 = v2;
        v4 += 1007;
        int32_t mem2 = (int32_t)realloc((int32_t *)paste_buf, v4);
        paste_buf = mem2;
        int32_t items_read2 = fread((int32_t *)(v3 + mem2), 1, 1007, (struct _IO_FILE *)paste_handle); // 0x809c31a
        v2 = items_read2 + v3;
        *(char *)(paste_buf + v2) = 0;
        if (items_read2 < 1007) {
            // break -> 0x809c3ab
            break;
        }
    }
    // 0x809c3b3
    return (char *)paste_buf;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c3b8 - 0x809c45f
// Line range:    7462 - 7477
int32_t put_clip(char * s) {
    char * command = LYGetEnv("RL_CLCOPY_CMD"); // 0x809c3c5
    int32_t len = strlen(s); // 0x809c3d3
    if (command == NULL) {
        // 0x809c45a
        return -1;
    }
    struct _IO_FILE * stream = popen(command, "w"); // 0x809c3f8
    if (stream == NULL) {
        // 0x809c45a
        return -1;
    }
    int32_t items_written = fwrite((int32_t *)s, 1, len, stream); // 0x809c42b
    if (pclose(stream) != 0) {
        // 0x809c45a
        return -1;
    }
    // 0x809c442
    return (int32_t *)items_written != (int32_t *)len;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c45f - 0x809c472
// Line range:    7487 - 7505
void LYmsec_delay(int32_t msec) {
    // 0x809c45f
    int32_t v1; // 0x809c45f
    function_804b3e4(msec, v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c472 - 0x809c51a
// Line range:    7678 - 7693
void LYOpenlog(char * banner) {
    // 0x809c472
    if (syslog_requested_urls == 0) {
        // 0x809c518
        return;
    }
    // 0x809c487
    if (WWW_TraceFlag != 0) {
        // 0x809c492
        fprintf(TraceFP(), "LYOpenlog(%s)\n", banner == NULL ? "(null)" : banner);
    }
    // 0x809c4c5
    openlog("lynx", LOG_PID, LOG_LOCAL5);
    if (banner == NULL) {
        // 0x809c504
        syslog(LOG_INFO, "Session start");
    } else {
        // 0x809c4e7
        syslog(LOG_INFO, "Session start:%s", banner);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c51a - 0x809c556
// Line range:    7697 - 7710
char looks_like_password(char * first, char * last) {
    // 0x809c51a
    if (first > last) {
        // 0x809c550
        return 0;
    }
    char * v1 = first; // 0x809c54e
    char v2 = *v1; // 0x809c529
    char result = 0; // 0x809c52e
    while (v2 != 47 == (v2 != 58)) {
        // 0x809c540
        v1 = (char *)((int32_t)v1 + 1);
        result = 1;
        if (v1 > last) {
            // break -> 0x809c550
            break;
        }
        v2 = *v1;
        result = 0;
    }
    // 0x809c550
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c556 - 0x809c745
// Line range:    7713 - 7744
void LYSyslog(char * arg) {
    // 0x809c556
    if (syslog_requested_urls == 0) {
        // 0x809c73f
        return;
    }
    // 0x809c56c
    if (WWW_TraceFlag != 0) {
        // 0x809c577
        fprintf(TraceFP(), "LYSyslog %s\n", arg);
    }
    // 0x809c595
    if (is_url(arg) == 0) {
        // 0x809c70f
        syslog(174, "%s", arg == NULL ? "(null)" : arg);
        // 0x809c73f
        return;
    }
    char * found_char_pos = strchr(arg, 58); // 0x809c5b6
    if (found_char_pos == NULL || strncmp(found_char_pos, "://", 3) != 0) {
        // 0x809c70f
        syslog(174, "%s", arg == NULL ? "(null)" : arg);
        // 0x809c73f
        return;
    }
    char * found_char_pos2 = strchr((char *)((int32_t)found_char_pos + 3), 58); // 0x809c5fc
    if (found_char_pos2 == NULL) {
        // 0x809c70f
        syslog(174, "%s", arg == NULL ? "(null)" : arg);
        // 0x809c73f
        return;
    }
    char * found_char_pos3 = strchr(found_char_pos, 64); // 0x809c61c
    if (found_char_pos3 == NULL || found_char_pos2 >= found_char_pos3) {
        // 0x809c70f
        syslog(174, "%s", arg == NULL ? "(null)" : arg);
        // 0x809c73f
        return;
    }
    int32_t v1 = (int32_t)found_char_pos2 + 1;
    if (looks_like_password((char *)v1, (char *)((int32_t)found_char_pos3 - 1)) == 0) {
        // 0x809c70f
        syslog(174, "%s", arg == NULL ? "(null)" : arg);
        // 0x809c73f
        return;
    }
    char * colon2 = NULL; // bp-24, 0x809c65a
    HTSACopy(&colon2, arg);
    *(char *)(v1 - (int32_t)arg + (int32_t)colon2) = 0;
    HTSACat(&colon2, "******");
    HTSACat(&colon2, found_char_pos3);
    syslog(174, "%s", colon2);
    if (WWW_TraceFlag != 0) {
        // 0x809c6d6
        fprintf(TraceFP(), "...alter %s\n", colon2);
    }
    // 0x809c6f4
    if (colon2 != NULL) {
        // 0x809c6fb
        free((int32_t *)colon2);
        colon2 = NULL;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUtils.c
// Address range: 0x809c745 - 0x809c771
// Line range:    7747 - 7752
void LYCloselog(void) {
    // 0x809c745
    if (syslog_requested_urls != 0) {
        // 0x809c756
        syslog(LOG_INFO, "Session over");
        closelog();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x809c774 - 0x809c803
// Line range:    48 - 58
char LYCheckUserAgent(void) {
    // 0x809c774
    if (LYUserAgent == 0) {
        // 0x809c7fd
        return 1;
    }
    char * str = (char *)LYUserAgent; // 0x809c788
    if (*str == 0 || strstr(str, "Lynx") != NULL || strstr((char *)LYUserAgent, "lynx") != NULL || strstr((char *)LYUserAgent, "L_y_n_x") != NULL) {
        // 0x809c7fd
        return 1;
    }
    // 0x809c7da
    if (strstr((char *)LYUserAgent, "l_y_n_x") == NULL) {
        // 0x809c7fd
        return 0;
    }
    // 0x809c7fd
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x809c803 - 0x809c84e
// Line range:    61 - 69
void validate_x_display(void) {
    char * v1 = LYgetXDisplay(); // 0x809c809
    if (v1 != NULL) {
        // 0x809c817
        HTSACopy((char **)&x_display, v1);
        // 0x809c84c
        return;
    }
    // 0x809c82c
    if (x_display != 0) {
        // 0x809c835
        free((int32_t *)x_display);
        x_display = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x809c84e - 0x809c957
// Line range:    72 - 89
void summarize_x_display(char * display_option) {
    // 0x809c84e
    char * v1; // 0x809c92b
    if (x_display != 0) {
        // 0x809c874
        if (strcmp((char *)x_display, display_option) != 0) {
            // 0x809c913
            mustshow = 1;
            if (*display_option == 0) {
                // 0x809c93a
                statusline(gettext("Failed to clear DISPLAY variable!"));
                // 0x809c955
                return;
            }
            // 0x809c91d
            v1 = gettext("Failed to set DISPLAY variable!");
            statusline(v1);
            // 0x809c955
            return;
        }
    } else {
        // 0x809c85d
        if (*display_option != 0) {
            // 0x809c913
            mustshow = 1;
            // 0x809c91d
            v1 = gettext("Failed to set DISPLAY variable!");
            statusline(v1);
            // 0x809c955
            return;
        }
    }
    // 0x809c891
    if (x_display != 0) {
        if (LYisConfiguredForX == 0) {
            // 0x809c8d9
            mustshow = 1;
            statusline(gettext("Value accepted! -- WARNING: Lynx is NOT configured for XWINDOWS!"));
            // 0x809c955
            return;
        }
    } else {
        if (LYisConfiguredForX == 1) {
            // 0x809c8a5
            mustshow = 1;
            statusline(gettext("Value accepted! -- WARNING: Lynx is configured for XWINDOWS!"));
            // 0x809c955
            return;
        }
    }
    // 0x809c8f6
    mustshow = 1;
    statusline(gettext("Value accepted!"));
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x809c957 - 0x809ca2f
// Line range:    92 - 125
void SetupChosenShowColor(void) {
    // 0x809c957
    can_do_colors = 1;
    char v1 = 1; // 0x809c96d
    if (LYCursesON != 0) {
        // 0x809c96f
        v1 = function_804b0e4();
        can_do_colors = v1;
    }
    // 0x809c979
    if (no_option_save != 0 || LYChosenShowColor != -1) {
        // 0x809ca2d
        return;
    }
    // 0x809c996
    switch (LYrcShowColor) {
        case 0: {
            // 0x809c9ac
            LYChosenShowColor = LYShowColor < 2 ? 0 : 2;
            // 0x809ca2d
            return;
        }
        case 3: {
            // 0x809c9d0
            if (v1 != 0) {
                // 0x809c9e7
                LYChosenShowColor = LYShowColor < 2 ? 1 : 3;
            } else {
                // 0x809c9db
                LYChosenShowColor = 3;
            }
            // 0x809ca2d
            return;
        }
    }
    // 0x809ca0b
    LYChosenShowColor = LYShowColor < 2 ? 1 : 2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x809ca2f - 0x809ca6f
// Line range:    217 - 223
int32_t add_it(char * text, int32_t len) {
    if (len != 0) {
        // 0x809ca3b
        *(char *)((int32_t)text + len) = 0;
        LYwaddnstr(LYwin, text, strlen(text));
    }
    // 0x809ca68
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x809ca6f - 0x809cb64
// Line range:    230 - 251
void addlbl(char * text) {
    char actual[80]; // bp-96, 0x809ca6f
    char v1[80]; // 0x809cb1f
    int32_t v2 = (int32_t)text;
    int32_t v3 = __readgsdword(20); // 0x809ca7b
    actual = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char v4 = *(char *)(*(int32_t *)&actual + v2); // 0x809cb29
    int32_t v5; // bp-88, 0x809ca6f
    if (v4 != 0) {
        // 0x809ca9c
        int32_t v6; // bp-4, 0x809ca6f
        int32_t v7 = (int32_t)&v6 - 84; // 0x809caa8
        int32_t v8 = 0;
        *(char *)(v8 + v7) = v4;
        int32_t v9 = *(int32_t *)&actual; // 0x809cab0
        char * v10 = (char *)(v9 + v2);
        char v11 = *v10; // 0x809cab6
        int32_t v12; // 0x809ca6f
        int32_t v13; // 0x809ca6f
        char v14; // 0x809ca6f
        int32_t v15; // 0x809caac
        int32_t v16; // 0x809cacd
        int32_t v17; // 0x809cb0e
        if (v11 != 40) {
            // 0x809caf4
            v15 = v8 + 1;
            v12 = v9;
            v14 = 0;
            v13 = v15;
            if (v11 == 41) {
                // 0x809cb01
                v17 = add_it((char *)&v5, v15);
                lynx_stop_bold();
                v12 = v9;
                v14 = 0;
                v13 = v17;
            }
        } else {
            // 0x809cabd
            v16 = add_it((char *)&v5, v8);
            lynx_start_bold();
            *(char *)(v16 + v7) = *v10;
            v12 = *(int32_t *)&actual;
            v14 = 1;
            v13 = v16 + 1;
        }
        int32_t v18 = v13;
        char v19 = v14;
        v1[0] = (char)v12 + 1;
        actual = v1;
        char v20 = *(char *)(*(int32_t *)&actual + v2); // 0x809cb29
        while (v20 != 0) {
            char v21 = v19;
            v8 = v18;
            *(char *)(v8 + v7) = v20;
            v9 = *(int32_t *)&actual;
            v10 = (char *)(v9 + v2);
            v11 = *v10;
            if (v11 != 40) {
                // 0x809caf4
                v15 = v8 + 1;
                v12 = v9;
                v14 = v21;
                v13 = v15;
                if (v11 == 41) {
                    // 0x809cb01
                    v17 = add_it((char *)&v5, v15);
                    lynx_stop_bold();
                    v12 = v9;
                    v14 = 0;
                    v13 = v17;
                }
            } else {
                // 0x809cabd
                v16 = add_it((char *)&v5, v8);
                lynx_start_bold();
                *(char *)(v16 + v7) = *v10;
                v12 = *(int32_t *)&actual;
                v14 = 1;
                v13 = v16 + 1;
            }
            // 0x809cb1f
            v18 = v13;
            v19 = v14;
            v1[0] = (char)v12 + 1;
            actual = v1;
            v20 = *(char *)(*(int32_t *)&actual + v2);
        }
        // 0x809cb34
        add_it((char *)&v5, v18);
        if (v19 != 0) {
            // 0x809cb4c
            lynx_stop_bold();
        }
    } else {
        // 0x809cb34
        add_it((char *)&v5, 0);
    }
    // 0x809cb51
    if (v3 != __readgsdword(20)) {
        // 0x809cb5d
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x809cb64 - 0x80a09f5
// Line range:    269 - 1579
void LYoptions(void) {
    int32_t v1 = __readgsdword(20); // 0x809cb6e
    int32_t v2; // 0x809cb64
    int32_t v3; // 0x809cb64
    int32_t v4; // 0x809cb64
    int32_t v5; // 0x809cb64
    int32_t v6; // 0x809cb64
    int32_t v7; // 0x809cb64
    int32_t v8; // 0x809cb64
    int32_t v9; // 0x809cb64
    char v10; // 0x809cb64
    int32_t v11; // 0x809cb64
    int32_t v12; // 0x809cb64
    int32_t v13; // 0x809cb64
    int32_t v14; // 0x809cb64
    char v15; // 0x809cb64
    char v16; // 0x809cb64
    char v17; // 0x809cb64
    char v18; // 0x809cb64
    char v19; // 0x809cb64
    char v20; // 0x809cb64
    char v21; // 0x809cb64
    char v22; // 0x809cb64
    char v23; // 0x809cb64
    char v24; // 0x809cb64
    char v25; // 0x809cb64
    char v26; // 0x809cb64
    int32_t v27; // 0x80a08ec
    if (LYlines > 22) {
        int32_t v28 = LYShowColor; // 0x809cb8f
        term_options = 0;
        LYStatusLine = LYlines - 1;
        signal(SIGINT, 0x80a0dfb);
        if (no_option_save == 0) {
            // 0x809cc39
            SetupChosenShowColor();
        } else {
            int32_t v29 = LYShowColor; // 0x809cc0e
            if (v29 != 0) {
                if (v29 == 3) {
                    // 0x809cc2d
                    LYShowColor = 2;
                }
            } else {
                // 0x809cc17
                LYShowColor = 1;
            }
        }
        // 0x809cc3e
        v12 = current_char_set;
        v3 = UCLYhndl_for_unspec;
        v7 = v28;
        v16 = LYRawMode;
        v20 = 0;
        v24 = user_mode == 2;
        while (true) {
          lab_0x809cc5c_2:
            // 0x809cc5c
            if (enable_scrollback == 0) {
                // 0x809cc7b
                LYerase();
            } else {
                // 0x809cc74
                LYclear();
            }
            // 0x809cc80
            LYmove(0, 5);
            lynx_start_h1_color();
            LYwaddnstr(LYwin, "         Options Menu (", 23);
            LYwaddnstr(LYwin, "Lynx", 4);
            LYwaddnstr(LYwin, " Version ", 9);
            LYwaddnstr(LYwin, "2.8.7dev.11", 11);
            function_804a8f4((int32_t)LYwin, 41);
            lynx_stop_h1_color();
            LYmove(2, 5);
            addlbl("(E)ditor                     : ");
            int32_t v30 = editor; // 0x809cd47
            int32_t str = (int32_t)"NONE"; // 0x809cd4e
            if (v30 != 0) {
                // 0x809cd50
                str = *(char *)v30 == 0 ? (int32_t)"NONE" : v30;
            }
            int32_t len = strlen((char *)str); // 0x809cd7d
            int32_t v31 = editor; // 0x809cd88
            int32_t v32 = (int32_t)"NONE"; // 0x809cd8f
            if (v31 != 0) {
                // 0x809cd91
                v32 = *(char *)v31 == 0 ? (int32_t)"NONE" : v31;
            }
            // 0x809cdb5
            LYwaddnstr(LYwin, (char *)v32, len);
            LYmove(3, 5);
            addlbl("(D)ISPLAY variable           : ");
            int32_t v33 = x_display; // 0x809cdf6
            int32_t str2 = (int32_t)"NONE"; // 0x809cdfd
            if (v33 != 0) {
                // 0x809cdff
                str2 = *(char *)v33 == 0 ? (int32_t)"NONE" : v33;
            }
            int32_t len2 = strlen((char *)str2); // 0x809ce2b
            int32_t v34 = x_display; // 0x809ce36
            int32_t v35 = (int32_t)"NONE"; // 0x809ce3d
            if (v34 != 0) {
                // 0x809ce3f
                v35 = *(char *)v34 == 0 ? (int32_t)"NONE" : v34;
            }
            // 0x809ce62
            LYwaddnstr(LYwin, (char *)v35, len2);
            LYmove(4, 5);
            addlbl("mu(L)ti-bookmarks: ");
            int32_t str3 = *(int32_t *)(4 * LYMultiBookmarks + (int32_t)&g113); // 0x809cea8
            int32_t len3 = strlen((char *)str3); // 0x809ceb2
            int32_t v36 = *(int32_t *)(4 * LYMultiBookmarks + (int32_t)&g113); // 0x809cebe
            LYwaddnstr(LYwin, (char *)v36, len3);
            LYmove(4, 34);
            if (LYMultiBookmarks == 0) {
                // 0x809cf09
                addlbl("(B)ookmark file: ");
                int32_t v37 = bookmark_page; // 0x809cf15
                int32_t str4 = (int32_t)"NONE"; // 0x809cf1c
                if (v37 != 0) {
                    // 0x809cf1e
                    str4 = *(char *)v37 == 0 ? (int32_t)"NONE" : v37;
                }
                int32_t len4 = strlen((char *)str4); // 0x809cf4a
                int32_t v38 = bookmark_page; // 0x809cf55
                int32_t v39 = (int32_t)"NONE"; // 0x809cf5c
                if (v38 != 0) {
                    // 0x809cf5e
                    v39 = *(char *)v38 == 0 ? (int32_t)"NONE" : v38;
                }
                // 0x809cf81
                LYwaddnstr(LYwin, (char *)v39, len4);
            } else {
                // 0x809cef8
                addlbl("review/edit (B)ookmarks files");
            }
            // 0x809cfa2
            LYmove(5, 5);
            addlbl("(F)TP sort criteria          : ");
            int32_t v40 = HTfileSortMethod; // 0x809cfc2
            int32_t v41 = (int32_t)"By Size    ";
            char * v42 = "By Filename"; // 0x809cb64
            int32_t str5; // 0x809cb64
            switch (v40) {
                default: {
                    // 0x809cfd5
                    v41 = v40 != 1 ? (int32_t)"By Date    " : (int32_t)"By Type    ";
                }
                case 2: {
                    // 0x809d00d
                    v42 = (char *)v41;
                }
                case 0: {
                    // 0x809d025
                    LYwaddnstr(LYwin, v42, 11);
                    LYmove(6, 5);
                    addlbl("(P)ersonal mail address      : ");
                    int32_t v43 = personal_mail_address; // 0x809d064
                    str5 = (int32_t)"NONE";
                    if (v43 != 0) {
                        // 0x809d06d
                        str5 = *(char *)v43 == 0 ? (int32_t)"NONE" : v43;
                    }
                    // break -> 0x809d090
                    break;
                }
            }
            int32_t len5 = strlen((char *)str5); // 0x809d099
            int32_t v44 = personal_mail_address; // 0x809d0a4
            int32_t v45 = (int32_t)"NONE"; // 0x809d0ab
            if (v44 != 0) {
                // 0x809d0ad
                v45 = *(char *)v44 == 0 ? (int32_t)"NONE" : v44;
            }
            // 0x809d0d0
            LYwaddnstr(LYwin, (char *)v45, len5);
            LYmove(7, 5);
            addlbl("(S)earching type             : ");
            LYwaddnstr(LYwin, case_sensitive == 0 ? "CASE INSENSITIVE" : "CASE SENSITIVE  ", 16);
            LYmove(v24 == 0 ? 10 : 11, 5);
            addlbl("display (C)haracter set      : ");
            int32_t str6 = *(int32_t *)(4 * current_char_set + (int32_t)&LYchar_set_names); // 0x809d197
            int32_t len6 = strlen((char *)str6); // 0x809d1a1
            int32_t v46 = *(int32_t *)(4 * current_char_set + (int32_t)&LYchar_set_names); // 0x809d1ad
            LYwaddnstr(LYwin, (char *)v46, len6);
            LYmove(8, 5);
            addlbl("preferred document lan(G)uage: ");
            int32_t v47 = language; // 0x809d1ea
            int32_t str7 = (int32_t)"NONE"; // 0x809d1f1
            if (v47 != 0) {
                // 0x809d1f3
                str7 = *(char *)v47 == 0 ? (int32_t)"NONE" : v47;
            }
            int32_t len7 = strlen((char *)str7); // 0x809d220
            int32_t v48 = language; // 0x809d22b
            int32_t v49 = (int32_t)"NONE"; // 0x809d232
            if (v48 != 0) {
                // 0x809d234
                v49 = *(char *)v48 == 0 ? (int32_t)"NONE" : v48;
            }
            // 0x809d258
            LYwaddnstr(LYwin, (char *)v49, len7);
            LYmove(9, 5);
            addlbl("preferred document c(H)arset : ");
            int32_t v50 = pref_charset; // 0x809d299
            int32_t str8 = (int32_t)"NONE"; // 0x809d2a0
            if (v50 != 0) {
                // 0x809d2a2
                str8 = *(char *)v50 == 0 ? (int32_t)"NONE" : v50;
            }
            int32_t len8 = strlen((char *)str8); // 0x809d2ce
            int32_t v51 = pref_charset; // 0x809d2d9
            int32_t v52 = (int32_t)"NONE"; // 0x809d2e0
            if (v51 != 0) {
                // 0x809d2e2
                v52 = *(char *)v51 == 0 ? (int32_t)"NONE" : v51;
            }
            // 0x809d305
            LYwaddnstr(LYwin, (char *)v52, len8);
            if (v24 != 0) {
                // 0x809d333
                LYmove(10, 5);
                addlbl("(^A)ssume charset if unknown : ");
                if (UCAssume_MIMEcharset == 0) {
                    uint32_t v53 = UCLYhndl_for_unspec; // 0x809d38a
                    char * str9 = "NONE"; // 0x809d391
                    if (v53 >= 0) {
                        int32_t v54 = *(int32_t *)(32 * v53 + (int32_t)&g143); // 0x809d39b
                        str9 = (char *)v54;
                    }
                    int32_t len9 = strlen(str9); // 0x809d3bc
                    uint32_t v55 = UCLYhndl_for_unspec; // 0x809d3c7
                    char * v56 = "NONE"; // 0x809d3ce
                    if (v55 >= 0) {
                        int32_t v57 = *(int32_t *)(32 * v55 + (int32_t)&g143); // 0x809d3d8
                        v56 = (char *)v57;
                    }
                    // 0x809d3f0
                    LYwaddnstr(LYwin, v56, len9);
                } else {
                    // 0x809d35c
                    LYwaddnstr(LYwin, (char *)UCAssume_MIMEcharset, strlen((char *)UCAssume_MIMEcharset));
                }
            }
            int32_t v58 = v24 == 0 ? 11 : 12;
            LYmove(v58, 5);
            addlbl("Raw 8-bit or CJK m(O)de      : ");
            LYwaddnstr(LYwin, LYRawMode == 0 ? "OFF" : "ON ", 3);
            LYmove(v58, 44);
            addlbl("show color (&)  : ");
            if (no_option_save == 0) {
                int32_t v59 = LYChosenShowColor; // 0x809d522
                if (v59 == 1) {
                    // 0x809d586
                    LYwaddnstr(LYwin, "OFF", 3);
                } else {
                    if (v59 > 1) {
                        switch (v59) {
                            case 2: {
                                // 0x809d5a5
                                LYwaddnstr(LYwin, "ON ", 3);
                                // break -> 0x809d60c
                                break;
                            }
                            case 3: {
                                // 0x809d5c4
                                if ((char)function_804b0e4() == 1) {
                                    // 0x809d5ef
                                    LYwaddnstr(LYwin, "ALWAYS    ", 10);
                                } else {
                                    // 0x809d5d0
                                    LYwaddnstr(LYwin, "Always try", 10);
                                }
                                // break -> 0x809d60c
                                break;
                            }
                        }
                    } else {
                        if (v59 == 0) {
                            // 0x809d564
                            LYwaddnstr(LYwin, "NEVER     ", 10);
                        }
                    }
                }
            } else {
                // 0x809d4de
                LYwaddnstr(LYwin, LYShowColor != 1 ? "OFF" : "ON ", 3);
            }
            int32_t v60 = v24 == 0 ? 12 : 13;
            LYmove(v60, 5);
            addlbl("(V)I keys: ");
            LYwaddnstr(LYwin, vi_keys == 0 ? "OFF" : "ON ", 3);
            LYmove(v60, 22);
            addlbl("e(M)acs keys: ");
            LYwaddnstr(LYwin, emacs_keys == 0 ? "OFF" : "ON ", 3);
            LYmove(v60, 44);
            addlbl("sho(W) dot files: ");
            LYwaddnstr(LYwin, no_dotfiles != 0 | show_dotfiles == 0 ? "OFF" : "ON ", 3);
            int32_t v61 = v24 == 0 ? 13 : 14;
            LYmove(v61, 5);
            addlbl("popups for selec(T) fields   : ");
            LYwaddnstr(LYwin, LYSelectPopups == 0 ? "OFF" : "ON ", 3);
            LYmove(v61, 44);
            addlbl("show cursor (@) : ");
            LYwaddnstr(LYwin, LYShowCursor == 0 ? "OFF" : "ON ", 3);
            LYmove(v24 == 0 ? 14 : 15, 5);
            addlbl("(K)eypad mode                : ");
            int32_t v62 = keypad_mode; // 0x809d8dd
            char * v63 = "Links and form fields are numbered"; // 0x809d8e5
            if ((v62 || 1) == 3 != v62 < 3) {
                int32_t v64 = v62 == 3 ? (int32_t)"Form fields are numbered          " : (int32_t)"Numbers act as arrows             ";
                int32_t v65 = v62 < 3 ? (int32_t)"Links are numbered                " : v64;
                v63 = (char *)v65;
            }
            // 0x809d973
            LYwaddnstr(LYwin, v63, 34);
            LYmove(v24 == 0 ? 15 : 16, 5);
            addlbl("li(N)e edit style            : ");
            int32_t str10 = *(int32_t *)(4 * current_lineedit + (int32_t)&LYLineeditNames); // 0x809d9d8
            int32_t len10 = strlen((char *)str10); // 0x809d9e2
            int32_t v66 = *(int32_t *)(4 * current_lineedit + (int32_t)&LYLineeditNames); // 0x809d9ee
            LYwaddnstr(LYwin, (char *)v66, len10);
            LYmove(v24 == 0 ? 17 : 18, 5);
            addlbl("l(I)st directory style       : ");
            int32_t v67 = dir_list_style; // 0x809da4c
            char * v68 = "Files first      "; // 0x809da54
            if (v67 != 1) {
                // 0x809da56
                v68 = v67 != 2 ? "Directories first" : "Mixed style      ";
            }
            // 0x809da8e
            LYwaddnstr(LYwin, v68, 17);
            LYmove(v24 == 0 ? 18 : 19, 5);
            addlbl("(U)ser mode                  : ");
            int32_t v69 = user_mode; // 0x809daee
            char * v70 = "Novice      "; // 0x809daf5
            if (v69 != 0) {
                // 0x809daf7
                v70 = v69 != 1 ? "Advanced    " : "Intermediate";
            }
            // 0x809db2f
            LYwaddnstr(LYwin, v70, 12);
            addlbl("  verbose images (!) : ");
            LYwaddnstr(LYwin, verbose_img == 0 ? "OFF" : "ON ", 3);
            LYmove(v24 == 0 ? 19 : 20, 5);
            addlbl("user (A)gent                 : ");
            int32_t v71 = LYUserAgent; // 0x809dbdb
            int32_t str11 = (int32_t)"NONE"; // 0x809dbe2
            if (v71 != 0) {
                // 0x809dbe4
                str11 = *(char *)v71 == 0 ? (int32_t)"NONE" : v71;
            }
            int32_t len11 = strlen((char *)str11); // 0x809dc11
            int32_t v72 = LYUserAgent; // 0x809dc1c
            int32_t v73 = (int32_t)"NONE"; // 0x809dc23
            if (v72 != 0) {
                // 0x809dc25
                v73 = *(char *)v72 == 0 ? (int32_t)"NONE" : v72;
            }
            // 0x809dc49
            LYwaddnstr(LYwin, (char *)v73, len11);
            LYmove(LYlines - 3, 2);
            int32_t len12 = strlen(gettext("Select ")); // 0x809dc91
            LYwaddnstr(LYwin, gettext("Select "), len12);
            lynx_start_bold();
            int32_t len13 = strlen(gettext("capital letter")); // 0x809dcce
            LYwaddnstr(LYwin, gettext("capital letter"), len13);
            lynx_stop_bold();
            int32_t len14 = strlen(gettext(" of option line,")); // 0x809dd0b
            LYwaddnstr(LYwin, gettext(" of option line,"), len14);
            if (no_option_save == 0) {
                // 0x809dd43
                LYwaddnstr(LYwin, " '", 2);
                lynx_start_bold();
                LYwaddnstr(LYwin, ">", 1);
                lynx_stop_bold();
                LYwaddnstr(LYwin, "'", 1);
                int32_t len15 = strlen(gettext(" to save,")); // 0x809ddb3
                LYwaddnstr(LYwin, gettext(" to save,"), len15);
            }
            int32_t len16 = strlen(gettext(" or ")); // 0x809ddeb
            LYwaddnstr(LYwin, gettext(" or "), len16);
            LYwaddnstr(LYwin, "'", 1);
            lynx_start_bold();
            LYwaddnstr(LYwin, "r", 1);
            lynx_stop_bold();
            LYwaddnstr(LYwin, "'", 1);
            int32_t len17 = strlen(gettext(" to return to Lynx.")); // 0x809de84
            LYwaddnstr(LYwin, gettext(" to return to Lynx."), len17);
            v10 = 0;
            v25 = v24;
            v22 = v20;
            v17 = v16;
            v8 = v7;
            v4 = v3;
            v13 = v12;
            while (true) {
              lab_0x80a08e4:;
                char v74 = v10;
                v27 = v74;
                if (v74 == 62 | LYisNonAlnumKeyname(v27, 37) != 0) {
                    // break (via goto) -> 0x80a09b6
                    goto lab_0x80a09b6_4;
                }
                // 0x80a090f
                if (term_options != 0) {
                    // break (via goto) -> 0x80a09b6
                    goto lab_0x80a09b6_4;
                }
                // 0x80a091e
                v14 = v13;
                v5 = v4;
                v9 = v8;
                v18 = v17;
                v26 = v25;
                if ((v74 || 4) == 7) {
                    goto lab_0x80a0991;
                } else {
                    if (v74 != -1) {
                        if ((v27 & 0x8800) == 0) {
                            // 0x80a0971
                            if (*(int16_t *)((2 * v27 & 4094) + 0x8197ea2) != 47) {
                                goto lab_0x809debc;
                            } else {
                                goto lab_0x80a0991;
                            }
                        } else {
                            if (v74 != 47) {
                                goto lab_0x809debc;
                            } else {
                                goto lab_0x80a0991;
                            }
                        }
                    } else {
                        // 0x80a0939
                        if (keymap[0] != 47) {
                            goto lab_0x809debc;
                        } else {
                            goto lab_0x80a0991;
                        }
                    }
                }
            }
          lab_0x809e00c:
            // 0x809e00c
            lynx_force_repaint();
            v11 = v14;
            v2 = v5;
            v6 = v9;
            v15 = v18;
            v19 = v21;
            v23 = v26;
            goto lab_0x809cc5c;
        }
      lab_0x80a09b6_4:
        // 0x80a09b6
        term_options = 0;
        LYStatusLine = -1;
        signal(SIGINT, 0x804b4e4);
    } else {
        // 0x809cbc2
        HTAlert(gettext("Screen height must be at least 23 lines for the Options menu!"));
    }
    // 0x80a09db
    if (v1 != __readgsdword(20)) {
        // 0x80a09e7
        __stack_chk_fail();
    }
  lab_0x80a0991:
    // 0x80a0991
    if ((*(int16_t *)(2 * v27 + (int32_t)*__ctype_b_loc()) & 0x4000) == 0) {
        // break (via goto) -> 0x80a09b6
        goto lab_0x80a09b6_4;
    }
    goto lab_0x809debc;
  lab_0x809debc:;
    char v75 = v22; // 0x809dec3
    if (v22 == 1) {
        // 0x809dec5
        mustshow = 1;
        statusline(gettext("Value accepted!"));
        v75 = 0;
    }
    // 0x809dee7
    v21 = v75;
    LYmove(LYlines - 2, 0);
    lynx_start_prompt_color();
    int32_t len18 = strlen(gettext("Command: ")); // 0x809df13
    LYwaddnstr(LYwin, gettext("Command: "), len18);
    lynx_stop_prompt_color();
    LYrefresh();
    int32_t v76 = LYgetch_single(); // 0x809df46
    char v77; // 0x809cb64
    char v78; // 0x809df4b
    if (term_options != 0) {
        // 0x809dfe8
        v77 = 82;
        goto lab_0x809dff2;
    } else {
        // 0x809df60
        v78 = v76;
        if ((v78 || 4) == 7) {
            goto lab_0x809dfc7;
        } else {
            if (v78 != -1) {
                int32_t v79 = 0x1000000 * v76;
                if ((v79 >> 24 & 0x8800) == 0) {
                    // 0x809dfab
                    if (*(int16_t *)((v79 >> 23 & 4094) + 0x8197ea2) != 47) {
                        goto lab_0x809dff2;
                    } else {
                        goto lab_0x809dfc7;
                    }
                } else {
                    // 0x809df99
                    v77 = v78;
                    if (v78 == 47) {
                        goto lab_0x809dfc7;
                    } else {
                        goto lab_0x809dff2;
                    }
                }
            } else {
                // 0x809df7b
                v77 = v78;
                if (keymap[0] == 47) {
                    goto lab_0x809dfc7;
                } else {
                    goto lab_0x809dff2;
                }
            }
        }
    }
  lab_0x809dff2:;
    char v80 = v77;
    int32_t v81 = v80; // 0x809dffa
    if (LYisNonAlnumKeyname(v81, 21) != 0) {
        // break -> 0x809e00c
        goto lab_0x809e00c;
    }
    // 0x809e023
    g387 = v81;
    int32_t v82 = v14; // 0x809e032
    int32_t v83 = v5; // 0x809e032
    int32_t v84 = v9; // 0x809e032
    char v85 = v18; // 0x809e032
    char v86 = v21; // 0x809e032
    char v87 = v26; // 0x809e032
    char v88 = v80; // 0x809e032
    int32_t v89; // 0x809cb64
    int32_t v90; // 0x809cb64
    int32_t v91; // 0x809cb64
    int32_t str13; // bp-1036, 0x809cb64
    char v92; // 0x809cb64
    char v93; // 0x809cb64
    char v94; // 0x809cb64
    int32_t * mem; // 0x809ef3a
    switch (v81) {
        case 1: {
            if (v26 == 0) {
                // 0x809f219
                mustshow = 1;
                statusline(gettext("That key requires Advanced User mode."));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = 0;
                v87 = 0;
                v88 = v80;
                goto lab_0x80a08d7;
            } else {
                // 0x809ef27
                mem = calloc(LYNumCharsets + 1, 4);
                if (mem == NULL) {
                    // 0x809ef4e
                    outofmem("./LYOptions.c", "options");
                    // UNREACHABLE
                }
                for (int32_t i = 0; i < LYNumCharsets; i++) {
                    int32_t v95 = *(int32_t *)(32 * i + (int32_t)&g143); // 0x809ef88
                    *(int32_t *)(4 * i + (int32_t)mem) = v95;
                }
                int32_t v96 = UCLYhndl_for_unspec; // 0x809efba
                if (UCLYhndl_for_unspec == current_char_set && UCAssume_MIMEcharset != 0) {
                    // 0x809efc5
                    v96 = UCGetLYhndl_byMIME((char *)UCAssume_MIMEcharset);
                }
                char * v97 = (char *)v96; // 0x809efdf
                if (v96 < 0) {
                    // 0x809efe1
                    v97 = LYRawMode == 0 ? NULL : (char *)current_char_set;
                }
                int32_t v98 = (int32_t)v97;
                int32_t v99; // 0x809cb64
                if (LYSelectPopups != 0) {
                    // 0x809f049
                    v99 = popup_choice(v98, 10, -1, (char **)mem, 0, 0, 0);
                } else {
                    // 0x809f01a
                    v99 = boolean_choice(v98, 10, -1, (char **)mem);
                }
                int32_t v100 = v99; // 0x809f0ac
                UCLYhndl_for_unspec = v100;
                if (v5 != v100) {
                    int32_t v101 = *(int32_t *)(32 * v100 + (int32_t)&g143); // 0x809f0c1
                    HTSACopy((char **)&UCAssume_MIMEcharset, (char *)v101);
                    goto lab_0x809f0d7;
                } else {
                    // 0x809f09b
                    v89 = v5;
                    v92 = v18;
                    if (v100 == v98) {
                        goto lab_0x809f1dd;
                    } else {
                        goto lab_0x809f0d7;
                    }
                }
            }
        }
        case 33: {
            int32_t v102 = verbose_img;
            int32_t v103; // 0x809cb64
            if (LYSelectPopups != 0) {
                // 0x80a0428
                v103 = popup_choice(v102, 18, 71, g118, 2, 0, 0);
            } else {
                // 0x80a03f7
                v103 = boolean_choice(v102, 18, 71, g118);
            }
            // 0x80a046f
            verbose_img = v103;
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
            if (LYSelectPopups != 0) {
                // 0x80a0488
                v11 = v14;
                v2 = v5;
                v6 = v9;
                v15 = v18;
                v19 = 1;
                v23 = v26;
                if (term_options == 0) {
                    goto lab_0x809cc5c;
                } else {
                    // 0x80a0493
                    term_options = 0;
                    v11 = v14;
                    v2 = v5;
                    v6 = v9;
                    v15 = v18;
                    v19 = v21;
                    v23 = v26;
                    goto lab_0x809cc5c;
                }
            }
            goto lab_0x80a08d7;
        }
        case 38: {
            // 0x809fb59
            if (no_option_save == 0) {
                int32_t v104 = 0; // bp-1132, 0x809fc49
                HTSACopy((char **)&v104, "NEVER     ");
                int32_t v105 = 0; // bp-1128, 0x809fc69
                HTSACopy((char **)&v105, "OFF       ");
                int32_t v106 = 0; // bp-1124, 0x809fc8c
                HTSACopy((char **)&v106, "ON        ");
                int32_t v107 = 0; // bp-1120, 0x809fcaf
                if ((char)function_804b0e4() == 1) {
                    // 0x809fce0
                    HTSACopy((char **)&v107, "ALWAYS    ");
                } else {
                    // 0x809fcc5
                    HTSACopy((char **)&v107, "Always try");
                }
                int32_t v108 = v26 == 0 ? 11 : 12;
                int32_t v109 = LYChosenShowColor;
                int32_t v110; // 0x809cb64
                if (LYSelectPopups != 0) {
                    // 0x809fd5e
                    v110 = popup_choice(v109, v108, 62, (char **)&v104, 4, 0, 0);
                } else {
                    // 0x809fd0e
                    v110 = boolean_choice(v109, v108, 62, (char **)&v104);
                }
                int32_t v111 = v110;
                while (v111 == 2) {
                    // 0x809fdcd
                    if ((char)function_804b0e4() != 0) {
                        // break -> 0x809fe66
                        break;
                    }
                    char * v112 = LYGetEnv("TERM"); // 0x809fe0f
                    if (v112 == NULL) {
                        // 0x809fe45
                        HTUserMsg(gettext("Terminal does not support color"));
                    } else {
                        // 0x809fe23
                        HTUserMsg2(gettext("Your '%s' terminal does not support color."), v112);
                    }
                    v109 = LYChosenShowColor;
                    if (LYSelectPopups != 0) {
                        // 0x809fd5e
                        v110 = popup_choice(v109, v108, 62, (char **)&v104, 4, 0, 0);
                    } else {
                        // 0x809fd0e
                        v110 = boolean_choice(v109, v108, 62, (char **)&v104);
                    }
                    // 0x809fdc4
                    v111 = v110;
                }
                // 0x809fe66
                LYChosenShowColor = v111;
                if ((char)function_804b0e4() != 0) {
                    // 0x809fe7a
                    LYShowColor = v111;
                }
                int32_t v113 = v104; // 0x809fe85
                if (v113 != 0) {
                    // 0x809fe8f
                    free((int32_t *)v113);
                    v104 = 0;
                }
                int32_t v114 = v105; // 0x809fea7
                if (v114 != 0) {
                    // 0x809feb1
                    free((int32_t *)v114);
                    v105 = 0;
                }
                int32_t v115 = v106; // 0x809fec9
                if (v115 != 0) {
                    // 0x809fed3
                    free((int32_t *)v115);
                    v106 = 0;
                }
                int32_t v116 = v107; // 0x809feeb
                if (v116 != 0) {
                    // 0x809fef5
                    free((int32_t *)v116);
                    v107 = 0;
                }
                goto lab_0x809ff0d;
            } else {
                // 0x809fb68
                if ((char)function_804b0e4() == 1) {
                    int32_t v117 = v26 == 0 ? 11 : 12;
                    int32_t v118 = boolean_choice(LYShowColor - 1, v117, 62, g118); // 0x809fc11
                    LYShowColor = v118;
                    if (v118 != 0) {
                        // 0x809fc33
                        LYShowColor = 2;
                    } else {
                        // 0x809fc24
                        LYShowColor = 1;
                    }
                    goto lab_0x809ff0d;
                } else {
                    char * v119 = LYGetEnv("TERM"); // 0x809fb7b
                    if (v119 == NULL) {
                        // 0x809fbb4
                        HTUserMsg(gettext("Terminal does not support color"));
                        v82 = v14;
                        v83 = v5;
                        v84 = v9;
                        v85 = v18;
                        v86 = v21;
                        v87 = v26;
                        v88 = v80;
                    } else {
                        // 0x809fb8f
                        HTUserMsg2(gettext("Your '%s' terminal does not support color."), v119);
                        v82 = v14;
                        v83 = v5;
                        v84 = v9;
                        v85 = v18;
                        v86 = v21;
                        v87 = v26;
                        v88 = v80;
                    }
                    goto lab_0x80a08d7;
                }
            }
        }
        case 62: {
            // 0x80a081d
            if (no_option_save != 0) {
                // 0x80a0882
                HTInfoMsg(gettext(" 'r' to return to Lynx "));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
            } else {
                // 0x80a0828
                HTInfoMsg(gettext("Saving Options..."));
                LYrcShowColor = LYChosenShowColor;
                if (save_rc(NULL) == 0) {
                    // 0x80a086c
                    HTAlert(gettext("Unable to save Options!"));
                    v82 = v14;
                    v83 = v5;
                    v84 = v9;
                    v85 = v18;
                    v86 = v21;
                    v87 = v26;
                    v88 = v80;
                } else {
                    // 0x80a0856
                    HTInfoMsg(gettext("Options saved!"));
                    v82 = v14;
                    v83 = v5;
                    v84 = v9;
                    v85 = v18;
                    v86 = v21;
                    v87 = v26;
                    v88 = v80;
                }
            }
            goto lab_0x80a08d7;
        }
        case 64: {
            int32_t v120 = v26 == 0 ? 13 : 14;
            LYShowCursor = boolean_choice((int32_t)LYShowCursor, v120, 62, g118);
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
            goto lab_0x80a08d7;
        }
        case 65: {
            // 0x80a04ab
            if (no_useragent != 0) {
                // 0x80a07f3
                mustshow = 1;
                statusline(gettext("Changing of the User-Agent string is disabled!"));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
                goto lab_0x80a08d7;
            } else {
                // 0x80a04ba
                if (LYUserAgent == 0) {
                    goto lab_0x80a04f0;
                } else {
                    char * v121 = (char *)LYUserAgent; // 0x80a04c8
                    if (*v121 == 0) {
                        goto lab_0x80a04f0;
                    } else {
                        // 0x80a04cf
                        LYstrncpy((char *)&str13, v121, 1023);
                        goto lab_0x80a0528;
                    }
                }
            }
        }
        case 66: {
            // 0x809e853
            if (no_bookmark != 0) {
                // 0x809eb88
                mustshow = 1;
                statusline(gettext("You are not allowed to change the bookmark file!"));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
                goto lab_0x80a08d7;
            } else {
                // 0x809e862
                if (LYMultiBookmarks != 0) {
                    // 0x809e86b
                    edit_bookmarks();
                    signal(SIGINT, 0x80a0dfb);
                    v11 = v14;
                    v2 = v5;
                    v6 = v9;
                    v15 = v18;
                    v19 = v21;
                    v23 = v26;
                    goto lab_0x809cc5c;
                }
                // 0x809e889
                if (bookmark_page == 0) {
                    goto lab_0x809e8bf;
                } else {
                    char * v122 = (char *)bookmark_page; // 0x809e897
                    if (*v122 == 0) {
                        goto lab_0x809e8bf;
                    } else {
                        // 0x809e89e
                        LYstrncpy((char *)&str13, v122, 1023);
                        goto lab_0x809e8df;
                    }
                }
            }
        }
        case 67: {
            int32_t v123 = v26 == 0 ? 10 : 11;
            int32_t v124 = current_char_set;
            int32_t v125; // 0x809cb64
            if (LYSelectPopups != 0) {
                // 0x809f298
                v125 = popup_choice(v124, v123, -1, LYchar_set_names, 0, 0, 0);
            } else {
                // 0x809f24b
                v125 = boolean_choice(v124, v123, -1, LYchar_set_names);
            }
            int32_t v126 = v125; // 0x809f313
            current_char_set = v126;
            v90 = v14;
            v93 = v18;
            if (v14 == v126) {
                goto lab_0x809f3bd;
            } else {
                // 0x809f30c
                LYUseDefaultRawMode = 1;
                HTMLUseCharacterSet(v126);
                int32_t v127 = current_char_set; // 0x809f320
                char v128 = LYRawMode; // 0x809f32b
                v91 = v127;
                v94 = v128;
                if (LYSelectPopups != 0) {
                    goto lab_0x809f3bd_2;
                } else {
                    // 0x809f343
                    LYmove(v26 == 0 ? 11 : 12, 36);
                    LYclrtoeol();
                    LYwaddnstr(LYwin, LYRawMode == 0 ? "OFF" : "ON ", 3);
                    v90 = v127;
                    v93 = v128;
                    goto lab_0x809f3bd;
                }
            }
        }
        case 68: {
            // 0x809e2ff
            if (x_display == 0) {
                goto lab_0x809e335;
            } else {
                char * v129 = (char *)x_display; // 0x809e30d
                if (*v129 == 0) {
                    goto lab_0x809e335;
                } else {
                    // 0x809e314
                    LYstrncpy((char *)&str13, v129, 1023);
                    goto lab_0x809e36d;
                }
            }
        }
        case 69: {
            // 0x809e034
            if (no_editor == 0) {
                // 0x809e05f
                if (system_editor == 0) {
                    int32_t v130 = editor; // 0x809e08a
                    if (v130 == 0) {
                        goto lab_0x809e0c0;
                    } else {
                        char * v131 = (char *)v130; // 0x809e098
                        if (*v131 == 0) {
                            goto lab_0x809e0c0;
                        } else {
                            // 0x809e09f
                            LYstrncpy((char *)&str13, v131, 1023);
                            goto lab_0x809e0f8;
                        }
                    }
                } else {
                    // 0x809e06a
                    mustshow = 1;
                    statusline(gettext("You are not allowed to change which editor to use!"));
                    v82 = v14;
                    v83 = v5;
                    v84 = v9;
                    v85 = v18;
                    v86 = v21;
                    v87 = v26;
                    v88 = 32;
                    goto lab_0x80a08d7;
                }
            } else {
                // 0x809e03f
                mustshow = 1;
                statusline(gettext("The 'e'dit command is currently disabled."));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
                goto lab_0x80a08d7;
            }
        }
        case 70: {
            int32_t v132 = HTfileSortMethod;
            int32_t v133; // 0x809cb64
            if (LYSelectPopups != 0) {
                // 0x809ebe9
                v133 = popup_choice(v132, 5, -1, g115, 4, 0, 0);
            } else {
                // 0x809ebbd
                v133 = boolean_choice(v132, 5, -1, g115);
            }
            // 0x809ec2b
            HTfileSortMethod = v133;
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
            if (LYSelectPopups != 0) {
                // 0x809ec44
                v11 = v14;
                v2 = v5;
                v6 = v9;
                v15 = v18;
                v19 = 1;
                v23 = v26;
                if (term_options == 0) {
                    goto lab_0x809cc5c;
                } else {
                    // 0x809ec4f
                    term_options = 0;
                    v11 = v14;
                    v2 = v5;
                    v6 = v9;
                    v15 = v18;
                    v19 = v21;
                    v23 = v26;
                    goto lab_0x809cc5c;
                }
            }
            goto lab_0x80a08d7;
        }
        case 71: {
            int32_t v134 = language; // 0x809f49d
            if (v134 == 0) {
                goto lab_0x809f4d3;
            } else {
                char * v135 = (char *)v134; // 0x809f4ab
                if (*v135 == 0) {
                    goto lab_0x809f4d3;
                } else {
                    // 0x809f4b2
                    LYstrncpy((char *)&str13, v135, 1023);
                    goto lab_0x809f50b;
                }
            }
        }
        case 72: {
            int32_t v136 = pref_charset; // 0x809f712
            if (v136 == 0) {
                goto lab_0x809f748;
            } else {
                char * v137 = (char *)v136; // 0x809f720
                if (*v137 == 0) {
                    goto lab_0x809f748;
                } else {
                    // 0x809f727
                    LYstrncpy((char *)&str13, v137, 1023);
                    goto lab_0x809f780;
                }
            }
        }
        case 73: {
            int32_t v138 = v26 == 0 ? 17 : 18;
            int32_t v139 = dir_list_style;
            int32_t v140; // 0x809cb64
            if (LYSelectPopups != 0) {
                // 0x80a022f
                v140 = popup_choice(v139, v138, -1, g116, 3, 0, 0);
            } else {
                // 0x80a01e2
                v140 = boolean_choice(v139, v138, -1, g116);
            }
            // 0x80a0292
            dir_list_style = v140;
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
            if (LYSelectPopups != 0) {
                // 0x80a02ab
                v11 = v14;
                v2 = v5;
                v6 = v9;
                v15 = v18;
                v19 = 1;
                v23 = v26;
                if (term_options == 0) {
                    goto lab_0x809cc5c;
                } else {
                    // 0x80a02b6
                    term_options = 0;
                    v11 = v14;
                    v2 = v5;
                    v6 = v9;
                    v15 = v18;
                    v19 = v21;
                    v23 = v26;
                    goto lab_0x809cc5c;
                }
            }
            goto lab_0x80a08d7;
        }
        case 75: {
            int32_t v141 = v26 == 0 ? 14 : 15;
            int32_t v142 = keypad_mode;
            int32_t v143; // 0x809cb64
            if (LYSelectPopups != 0) {
                // 0x80a002c
                v143 = popup_choice(v142, v141, -1, g114, 3, 0, 0);
            } else {
                // 0x809ffdf
                v143 = boolean_choice(v142, v141, -1, g114);
            }
            // 0x80a008f
            keypad_mode = v143;
            if (v143 != 0) {
                // 0x80a009f
                reset_numbers_as_arrows();
            } else {
                // 0x80a0098
                set_numbers_as_arrows();
            }
            // 0x80a00a4
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
            if (LYSelectPopups != 0) {
                // 0x80a00bd
                v11 = v14;
                v2 = v5;
                v6 = v9;
                v15 = v18;
                v19 = 1;
                v23 = v26;
                if (term_options == 0) {
                    goto lab_0x809cc5c;
                } else {
                    // 0x80a00c8
                    term_options = 0;
                    v11 = v14;
                    v2 = v5;
                    v6 = v9;
                    v15 = v18;
                    v19 = v21;
                    v23 = v26;
                    goto lab_0x809cc5c;
                }
            }
            goto lab_0x80a08d7;
        }
        case 76: {
            // 0x809e636
            if (LYMBMBlocked == 0) {
                int32_t v144 = LYMultiBookmarks;
                int32_t v145; // 0x809cb64
                if (LYSelectPopups != 0) {
                    // 0x809e6a2
                    v145 = popup_choice(v144, 4, 23, g113, 3, 0, 0);
                } else {
                    // 0x809e676
                    v145 = boolean_choice(v144, 4, 24, g113);
                }
                // 0x809e6e4
                LYMultiBookmarks = v145;
                if (LYSelectPopups == 0) {
                    // 0x809e6f3
                    LYmove(4, 34);
                    LYclrtoeol();
                    if (LYMultiBookmarks == 0) {
                        int32_t len19 = strlen(gettext("B)ookmark file: ")); // 0x809e761
                        LYwaddnstr(LYwin, gettext("B)ookmark file: "), len19);
                        int32_t v146 = bookmark_page; // 0x809e78a
                        int32_t str12 = (int32_t)"NONE"; // 0x809e791
                        if (v146 != 0) {
                            // 0x809e793
                            str12 = *(char *)v146 == 0 ? (int32_t)"NONE" : v146;
                        }
                        int32_t len20 = strlen((char *)str12); // 0x809e7bf
                        int32_t v147 = bookmark_page; // 0x809e7ca
                        int32_t v148 = (int32_t)"NONE"; // 0x809e7d1
                        if (v147 != 0) {
                            // 0x809e7d3
                            v148 = *(char *)v147 == 0 ? (int32_t)"NONE" : v147;
                        }
                        // 0x809e7f6
                        LYwaddnstr(LYwin, (char *)v148, len20);
                    } else {
                        int32_t len21 = strlen(gettext("review/edit B)ookmarks files")); // 0x809e724
                        LYwaddnstr(LYwin, gettext("review/edit B)ookmarks files"), len21);
                    }
                }
                // 0x809e817
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
                if (LYSelectPopups != 0) {
                    // 0x809e830
                    v11 = v14;
                    v2 = v5;
                    v6 = v9;
                    v15 = v18;
                    v19 = 1;
                    v23 = v26;
                    if (term_options == 0) {
                        goto lab_0x809cc5c;
                    } else {
                        // 0x809e83b
                        term_options = 0;
                        v11 = v14;
                        v2 = v5;
                        v6 = v9;
                        v15 = v18;
                        v19 = v21;
                        v23 = v26;
                        goto lab_0x809cc5c;
                    }
                }
            } else {
                // 0x809e641
                mustshow = 1;
                statusline(gettext("Multiple bookmark support is not available."));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
            }
            goto lab_0x80a08d7;
        }
        case 77: {
            int32_t v149 = v26 == 0 ? 12 : 13;
            char v150 = boolean_choice((int32_t)emacs_keys, v149, 36, g118); // 0x809fa48
            emacs_keys = v150;
            if (v150 == 0) {
                // 0x809fa5f
                reset_emacs_keys();
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
            } else {
                // 0x809fa58
                set_emacs_keys();
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
            }
            goto lab_0x80a08d7;
        }
        case 78: {
            int32_t v151 = v26 == 0 ? 15 : 16;
            int32_t v152 = current_lineedit;
            int32_t v153; // 0x809cb64
            if (LYSelectPopups != 0) {
                // 0x80a0138
                v153 = popup_choice(v152, v151, -1, LYLineeditNames, 0, 0, 0);
            } else {
                // 0x80a00eb
                v153 = boolean_choice(v152, v151, -1, LYLineeditNames);
            }
            // 0x80a019b
            current_lineedit = v153;
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
            if (LYSelectPopups != 0) {
                // 0x80a01b4
                v11 = v14;
                v2 = v5;
                v6 = v9;
                v15 = v18;
                v19 = 1;
                v23 = v26;
                if (term_options == 0) {
                    goto lab_0x809cc5c;
                } else {
                    // 0x80a01bf
                    term_options = 0;
                    v11 = v14;
                    v2 = v5;
                    v6 = v9;
                    v15 = v18;
                    v19 = v21;
                    v23 = v26;
                    goto lab_0x809cc5c;
                }
            }
            goto lab_0x80a08d7;
        }
        case 79: {
            int32_t v154 = v26 == 0 ? 11 : 12;
            char v155 = boolean_choice((int32_t)LYRawMode, v154, -1, g118); // 0x809f444
            LYRawMode = v155;
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
            if (v18 != v155) {
                // 0x809f458
                HTMLSetUseDefaultRawMode(current_char_set, v155);
                HTMLSetCharacterHandling(current_char_set);
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = LYRawMode;
                v86 = v21;
                v87 = v26;
                v88 = 32;
            }
            goto lab_0x80a08d7;
        }
        case 80: {
            int32_t v156 = personal_mail_address; // 0x809ec67
            if (v156 == 0) {
                goto lab_0x809ec9d;
            } else {
                char * v157 = (char *)v156; // 0x809ec75
                if (*v157 == 0) {
                    goto lab_0x809ec9d;
                } else {
                    // 0x809ec7c
                    LYstrncpy((char *)&str13, v157, 1023);
                    goto lab_0x809ecd5;
                }
            }
        }
        case 82: {
            goto lab_0x80a08d7;
        }
        case 83: {
            int32_t v158 = boolean_choice((int32_t)case_sensitive, 7, -1, g117); // 0x809ef01
            case_sensitive = v158;
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
            goto lab_0x80a08d7;
        }
        case 84: {
            int32_t v159 = v26 == 0 ? 13 : 14;
            int32_t v160 = boolean_choice((int32_t)LYSelectPopups, v159, 36, g118); // 0x809fb40
            LYSelectPopups = v160;
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
            goto lab_0x80a08d7;
        }
        case 85: {
            int32_t v161 = v26 == 0 ? 18 : 19;
            int32_t v162 = user_mode;
            bool v163; // 0x809cb64
            if (LYSelectPopups != 0) {
                int32_t v164 = popup_choice(v162, v161, -1, g112, 3, 0, 0); // 0x80a0390
                user_mode = v164;
                int32_t v165 = v164 - 1; // 0x80a039f
                v163 = v165 < 0 == (v164 & -v164) < 0 == (v165 != 0);
            } else {
                int32_t v166 = boolean_choice(v162, v161, -1, g112); // 0x80a031a
                user_mode = v166;
                int32_t v167 = v166 - 1; // 0x80a0329
                v163 = v167 < 0 == (v166 & -v166) < 0 == (v167 != 0);
            }
            char v168 = v163;
            LYSetDisplayLines();
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v168;
            v88 = 32;
            if (LYSelectPopups != 0) {
                // 0x80a03c9
                v11 = v14;
                v2 = v5;
                v6 = v9;
                v15 = v18;
                v19 = 1;
                v23 = v168;
                if (term_options == 0) {
                    goto lab_0x809cc5c;
                } else {
                    // 0x80a03d4
                    term_options = 0;
                    v11 = v14;
                    v2 = v5;
                    v6 = v9;
                    v15 = v18;
                    v19 = v21;
                    v23 = v168;
                    goto lab_0x809cc5c;
                }
            }
            goto lab_0x80a08d7;
        }
        case 86: {
            int32_t v169 = v26 == 0 ? 12 : 13;
            char v170 = boolean_choice((int32_t)vi_keys, v169, 15, g118); // 0x809f9d2
            vi_keys = v170;
            if (v170 == 0) {
                // 0x809f9e9
                reset_vi_keys();
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
            } else {
                // 0x809f9e2
                set_vi_keys();
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
            }
            goto lab_0x80a08d7;
        }
        case 87: {
            // 0x809fa73
            if (no_dotfiles == 0) {
                int32_t v171 = v26 == 0 ? 12 : 13;
                int32_t v172 = boolean_choice((int32_t)show_dotfiles, v171, 62, g118); // 0x809fae1
                show_dotfiles = v172;
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
            } else {
                // 0x809fa7e
                mustshow = 1;
                statusline(gettext("Access to dot files is disabled!"));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
            }
            goto lab_0x80a08d7;
        }
        default: {
            // 0x80a08a2
            if (no_option_save != 0) {
                // 0x80a08c3
                HTInfoMsg(gettext(" 'r' to return to Lynx "));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = v80;
            } else {
                // 0x80a08ad
                HTInfoMsg(gettext(" '>' to save, or 'r' to return to Lynx "));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = v80;
            }
            goto lab_0x80a08d7;
        }
    }
  lab_0x809dfc7:;
    int16_t v173 = *(int16_t *)((0x1000000 * v76 >> 23) + (int32_t)*__ctype_b_loc()); // 0x809dfd9
    v77 = v78;
    if ((v173 & 0x4000) != 0) {
        goto lab_0x809dff2;
    } else {
        // 0x809dfe8
        v77 = 82;
        goto lab_0x809dff2;
    }
  lab_0x80a08d7:
    // 0x80a08d7
    v10 = v88;
    v25 = v87;
    v22 = v86;
    v17 = v85;
    v8 = v84;
    v4 = v83;
    v13 = v82;
    if (v88 == 82) {
        // break (via goto) -> 0x80a09b6
        goto lab_0x80a09b6_4;
    }
    goto lab_0x80a08e4;
  lab_0x809f3bd:
    // 0x809f3bd
    v91 = v90;
    v94 = v93;
    goto lab_0x809f3bd_2;
  lab_0x809e335:
    // 0x809e335
    LYmove(3, 36);
    LYwaddnstr(LYwin, "    ", 4);
    str13 = 0;
    goto lab_0x809e36d;
  lab_0x809f4d3:
    // 0x809f4d3
    LYmove(8, 36);
    LYwaddnstr(LYwin, "    ", 4);
    str13 = 0;
    goto lab_0x809f50b;
  lab_0x809f748:
    // 0x809f748
    LYmove(9, 36);
    LYwaddnstr(LYwin, "    ", 4);
    str13 = 0;
    goto lab_0x809f780;
  lab_0x809ec9d:
    // 0x809ec9d
    LYmove(6, 36);
    LYwaddnstr(LYwin, "    ", 4);
    str13 = 0;
    goto lab_0x809ecd5;
  lab_0x809ff0d:;
    int32_t v222 = v9; // 0x809ff18
    if (v9 != LYShowColor) {
        // 0x809ff1a
        lynx_force_repaint();
        v222 = LYShowColor;
    }
    int32_t v223 = v222; // 0x809ff1f
    v82 = v14;
    v83 = v5;
    v84 = v223;
    v85 = v18;
    v86 = v21;
    v87 = v26;
    v88 = 32;
    if (LYSelectPopups != 0) {
        // 0x809ff43
        v82 = v14;
        v83 = v5;
        v84 = v223;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
        if (no_option_save == 0) {
            // 0x809ff52
            v11 = v14;
            v2 = v5;
            v6 = v223;
            v15 = v18;
            v19 = 1;
            v23 = v26;
            if (term_options == 0) {
                goto lab_0x809cc5c;
            } else {
                // 0x809ff5d
                term_options = 0;
                v11 = v14;
                v2 = v5;
                v6 = v223;
                v15 = v18;
                v19 = v21;
                v23 = v26;
                goto lab_0x809cc5c;
            }
        }
    }
    goto lab_0x80a08d7;
  lab_0x80a04f0:
    // 0x80a04f0
    LYmove(4, 36);
    LYwaddnstr(LYwin, "    ", 4);
    str13 = 0;
    goto lab_0x80a0528;
  lab_0x809e8bf:
    // 0x809e8bf
    LYmove(4, 50);
    LYclrtoeol();
    str13 = 0;
    goto lab_0x809e8df;
  lab_0x809f3bd_2:;
    char v174 = v94;
    int32_t v175 = v91;
    v82 = v175;
    v83 = v5;
    v84 = v9;
    v85 = v174;
    v86 = v21;
    v87 = v26;
    v88 = 32;
    if (LYSelectPopups != 0) {
        // 0x809f3d6
        v11 = v175;
        v2 = v5;
        v6 = v9;
        v15 = v174;
        v19 = 1;
        v23 = v26;
        if (term_options == 0) {
            goto lab_0x809cc5c;
        } else {
            // 0x809f3e1
            term_options = 0;
            v11 = v175;
            v2 = v5;
            v6 = v9;
            v15 = v174;
            v19 = v21;
            v23 = v26;
            goto lab_0x809cc5c;
        }
    }
    goto lab_0x80a08d7;
  lab_0x809e36d:
    // 0x809e36d
    mustshow = 1;
    statusline(gettext("Hit RETURN to accept entered data."));
    LYmove(3, 36);
    lynx_start_bold();
    int32_t v176 = LYgetstr((char *)&str13, 0, 1024, 0); // 0x809e3c2
    lynx_stop_bold();
    LYmove(3, 36);
    if (v176 == -1 || term_options != 0) {
        goto lab_0x809e426;
    } else {
        // 0x809e3fa
        if (x_display == 0) {
            goto lab_0x809e50d;
        } else {
            // 0x809e407
            if (strcmp((char *)x_display, (char *)&str13) != 0) {
                goto lab_0x809e50d;
            } else {
                goto lab_0x809e426;
            }
        }
    }
  lab_0x809f50b:
    // 0x809f50b
    mustshow = 1;
    statusline(gettext("Hit RETURN to accept entered data."));
    LYmove(8, 36);
    lynx_start_bold();
    int32_t v177 = LYgetstr((char *)&str13, 0, 1024, 0); // 0x809f560
    lynx_stop_bold();
    LYmove(8, 36);
    if (v177 != -1 == term_options == 0) {
        // 0x809f62e
        if ((char)str13 != 0) {
            // 0x809f678
            HTSACopy((char **)&language, (char *)&str13);
            int32_t len22 = strlen((char *)&str13); // 0x809f697
            LYwaddnstr(LYwin, (char *)&str13, len22);
        } else {
            // 0x809f639
            if (language != 0) {
                // 0x809f642
                free((int32_t *)language);
                language = 0;
            }
            // 0x809f659
            LYwaddnstr(LYwin, "NONE", 4);
        }
    } else {
        int32_t v178 = language; // 0x809f59c
        int32_t str14 = (int32_t)"NONE"; // 0x809f5a3
        if (v178 != 0) {
            // 0x809f5a5
            str14 = *(char *)v178 == 0 ? (int32_t)"NONE" : v178;
        }
        int32_t len23 = strlen((char *)str14); // 0x809f5d1
        int32_t v179 = language; // 0x809f5dc
        int32_t v180 = (int32_t)"NONE"; // 0x809f5e3
        if (v179 != 0) {
            // 0x809f5e5
            v180 = *(char *)v179 == 0 ? (int32_t)"NONE" : v179;
        }
        // 0x809f608
        LYwaddnstr(LYwin, (char *)v180, len23);
    }
    // 0x809f6b8
    LYclrtoeol();
    if (v177 != -1) {
        // 0x809f6e8
        mustshow = 1;
        statusline(gettext("Value accepted!"));
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    } else {
        // 0x809f6c6
        HTInfoMsg(gettext("Cancelled!!!"));
        HTInfoMsg((char *)&g30);
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    }
    goto lab_0x80a08d7;
  lab_0x809f780:
    // 0x809f780
    mustshow = 1;
    statusline(gettext("Hit RETURN to accept entered data."));
    LYmove(9, 36);
    lynx_start_bold();
    int32_t v181 = LYgetstr((char *)&str13, 0, 1024, 0); // 0x809f7d5
    lynx_stop_bold();
    LYmove(9, 36);
    if (v181 != -1 == term_options == 0) {
        // 0x809f8a3
        if ((char)str13 != 0) {
            // 0x809f8ed
            HTSACopy((char **)&pref_charset, (char *)&str13);
            int32_t len24 = strlen((char *)&str13); // 0x809f90c
            LYwaddnstr(LYwin, (char *)&str13, len24);
        } else {
            // 0x809f8ae
            if (pref_charset != 0) {
                // 0x809f8b7
                free((int32_t *)pref_charset);
                pref_charset = 0;
            }
            // 0x809f8ce
            LYwaddnstr(LYwin, "NONE", 4);
        }
    } else {
        int32_t v182 = pref_charset; // 0x809f811
        int32_t str15 = (int32_t)"NONE"; // 0x809f818
        if (v182 != 0) {
            // 0x809f81a
            str15 = *(char *)v182 == 0 ? (int32_t)"NONE" : v182;
        }
        int32_t len25 = strlen((char *)str15); // 0x809f846
        int32_t v183 = pref_charset; // 0x809f851
        int32_t v184 = (int32_t)"NONE"; // 0x809f858
        if (v183 != 0) {
            // 0x809f85a
            v184 = *(char *)v183 == 0 ? (int32_t)"NONE" : v183;
        }
        // 0x809f87d
        LYwaddnstr(LYwin, (char *)v184, len25);
    }
    // 0x809f92d
    LYclrtoeol();
    if (v181 != -1) {
        // 0x809f95d
        mustshow = 1;
        statusline(gettext("Value accepted!"));
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    } else {
        // 0x809f93b
        HTInfoMsg(gettext("Cancelled!!!"));
        HTInfoMsg((char *)&g30);
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    }
    goto lab_0x80a08d7;
  lab_0x809ecd5:
    // 0x809ecd5
    mustshow = 1;
    statusline(gettext("Hit RETURN to accept entered data."));
    LYmove(6, 36);
    lynx_start_bold();
    int32_t v185 = LYgetstr((char *)&str13, 0, 1024, 0); // 0x809ed2a
    lynx_stop_bold();
    LYmove(6, 36);
    if (v185 != -1 == term_options == 0) {
        // 0x809edf8
        if ((char)str13 != 0) {
            // 0x809ee42
            HTSACopy((char **)&personal_mail_address, (char *)&str13);
            int32_t len26 = strlen((char *)&str13); // 0x809ee61
            LYwaddnstr(LYwin, (char *)&str13, len26);
        } else {
            // 0x809ee03
            if (personal_mail_address != 0) {
                // 0x809ee0c
                free((int32_t *)personal_mail_address);
                personal_mail_address = 0;
            }
            // 0x809ee23
            LYwaddnstr(LYwin, "NONE", 4);
        }
    } else {
        int32_t v186 = personal_mail_address; // 0x809ed66
        int32_t str16 = (int32_t)"NONE"; // 0x809ed6d
        if (v186 != 0) {
            // 0x809ed6f
            str16 = *(char *)v186 == 0 ? (int32_t)"NONE" : v186;
        }
        int32_t len27 = strlen((char *)str16); // 0x809ed9b
        int32_t v187 = personal_mail_address; // 0x809eda6
        int32_t v188 = (int32_t)"NONE"; // 0x809edad
        if (v187 != 0) {
            // 0x809edaf
            v188 = *(char *)v187 == 0 ? (int32_t)"NONE" : v187;
        }
        // 0x809edd2
        LYwaddnstr(LYwin, (char *)v188, len27);
    }
    // 0x809ee82
    LYclrtoeol();
    if (v185 != -1) {
        // 0x809eeb2
        mustshow = 1;
        statusline(gettext("Value accepted!"));
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    } else {
        // 0x809ee90
        HTInfoMsg(gettext("Cancelled!!!"));
        HTInfoMsg((char *)&g30);
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    }
    goto lab_0x80a08d7;
  lab_0x809f0d7:;
    // 0x809f0d7
    int32_t v189; // 0x809cb64
    char v190; // 0x809cb64
    if (HTCJK == 1) {
        // 0x809f0d7
        v189 = current_char_set;
        v190 = LYRawMode;
    } else {
        char v191 = UCLYhndl_for_unspec == current_char_set; // 0x809f0ee
        LYRawMode = v191;
        v189 = current_char_set;
        v190 = v191;
    }
    // 0x809f0f6
    HTMLSetUseDefaultRawMode(v189, v190);
    HTMLSetCharacterHandling(current_char_set);
    int32_t v192 = UCLYhndl_for_unspec; // 0x809f11f
    char v193 = LYRawMode; // 0x809f12a
    v89 = v192;
    v92 = v193;
    if (LYSelectPopups == 0) {
        // 0x809f142
        LYmove(12, 36);
        LYclrtoeol();
        LYwaddnstr(LYwin, LYRawMode == 0 ? "OFF" : "ON ", 3);
        v89 = v192;
        v92 = v193;
    }
    goto lab_0x809f1dd;
  lab_0x809f1dd:;
    char v194 = v92;
    int32_t v195 = v89;
    free(mem);
    v82 = v14;
    v83 = v195;
    v84 = v9;
    v85 = v194;
    v86 = v21;
    v87 = v26;
    v88 = 32;
    if (LYSelectPopups != 0) {
        // 0x809f1f6
        v11 = v14;
        v2 = v195;
        v6 = v9;
        v15 = v194;
        v19 = 1;
        v23 = v26;
        if (term_options == 0) {
            goto lab_0x809cc5c;
        } else {
            // 0x809f201
            term_options = 0;
            v11 = v14;
            v2 = v195;
            v6 = v9;
            v15 = v194;
            v19 = v21;
            v23 = v26;
            goto lab_0x809cc5c;
        }
    }
    goto lab_0x80a08d7;
  lab_0x80a0528:
    // 0x80a0528
    mustshow = 1;
    statusline(gettext("Hit RETURN to accept entered data.  Delete data to invoke the default."));
    int32_t v196 = v26 == 0 ? 19 : 20;
    LYmove(v196, 36);
    lynx_start_bold();
    int32_t v197 = LYgetstr((char *)&str13, 0, 1024, 0); // 0x80a059e
    lynx_stop_bold();
    LYmove(v196, 36);
    if (v197 != -1 == term_options == 0) {
        // 0x80a068d
        if ((char)str13 != 0) {
            // 0x80a0740
            HTSACopy((char **)&LYUserAgent, (char *)&str13);
            int32_t len28 = strlen((char *)&str13); // 0x80a075f
            LYwaddnstr(LYwin, (char *)&str13, len28);
        } else {
            // 0x80a069c
            HTSACopy((char **)&LYUserAgent, (char *)LYUserAgentDefault);
            int32_t v198 = LYUserAgent; // 0x80a06b1
            int32_t str17 = (int32_t)"NONE"; // 0x80a06b8
            if (v198 != 0) {
                // 0x80a06ba
                str17 = *(char *)v198 == 0 ? (int32_t)"NONE" : v198;
            }
            int32_t len29 = strlen((char *)str17); // 0x80a06e6
            int32_t v199 = LYUserAgent; // 0x80a06f1
            int32_t v200 = (int32_t)"NONE"; // 0x80a06f8
            if (v199 != 0) {
                // 0x80a06fa
                v200 = *(char *)v199 == 0 ? (int32_t)"NONE" : v199;
            }
            // 0x80a071d
            LYwaddnstr(LYwin, (char *)v200, len29);
        }
    } else {
        int32_t v201 = LYUserAgent; // 0x80a05fb
        int32_t str18 = (int32_t)"NONE"; // 0x80a0602
        if (v201 != 0) {
            // 0x80a0604
            str18 = *(char *)v201 == 0 ? (int32_t)"NONE" : v201;
        }
        int32_t len30 = strlen((char *)str18); // 0x80a0630
        int32_t v202 = LYUserAgent; // 0x80a063b
        int32_t v203 = (int32_t)"NONE"; // 0x80a0642
        if (v202 != 0) {
            // 0x80a0644
            v203 = *(char *)v202 == 0 ? (int32_t)"NONE" : v202;
        }
        // 0x80a0667
        LYwaddnstr(LYwin, (char *)v203, len30);
    }
    // 0x80a0780
    LYclrtoeol();
    if (v197 != -1) {
        char v204 = LYCheckUserAgent(); // 0x80a07b0
        mustshow = 1;
        if (v204 != 0) {
            // 0x80a07d6
            statusline(gettext("Value accepted!"));
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
        } else {
            // 0x80a07b9
            statusline(gettext("Use \"L_y_n_x\" or \"Lynx\" in User-Agent, or it looks like intentional deception!"));
            v82 = v14;
            v83 = v5;
            v84 = v9;
            v85 = v18;
            v86 = v21;
            v87 = v26;
            v88 = 32;
        }
    } else {
        // 0x80a078e
        HTInfoMsg(gettext("Cancelled!!!"));
        HTInfoMsg((char *)&g30);
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    }
    goto lab_0x80a08d7;
  lab_0x809e8df:
    // 0x809e8df
    mustshow = 1;
    statusline(gettext("Hit RETURN to accept entered data."));
    LYmove(4, 50);
    lynx_start_bold();
    int32_t v205 = LYgetstr((char *)&str13, 0, 1024, 0); // 0x809e934
    lynx_stop_bold();
    LYmove(4, 50);
    if (v205 == -1 || term_options != 0) {
        goto lab_0x809e97b;
    } else {
        // 0x809e96c
        if ((char)str13 != 0) {
            // 0x809ea0d
            if (LYPathOffHomeOK((char *)&str13, 1024) != 0) {
                // 0x809eae7
                HTSACopy((char **)&bookmark_page, (char *)&str13);
                HTSACopy((char **)&MBM_A_subbookmark, (char *)bookmark_page);
                LYwaddnstr(LYwin, (char *)bookmark_page, strlen((char *)bookmark_page));
                goto lab_0x809eb3b;
            } else {
                int32_t v206 = bookmark_page; // 0x809ea2b
                int32_t str19 = (int32_t)"NONE"; // 0x809ea32
                if (v206 != 0) {
                    // 0x809ea34
                    str19 = *(char *)v206 == 0 ? (int32_t)"NONE" : v206;
                }
                int32_t len31 = strlen((char *)str19); // 0x809ea60
                int32_t v207 = bookmark_page; // 0x809ea6b
                int32_t v208 = (int32_t)"NONE"; // 0x809ea72
                if (v207 != 0) {
                    // 0x809ea74
                    v208 = *(char *)v207 == 0 ? (int32_t)"NONE" : v207;
                }
                // 0x809ea97
                LYwaddnstr(LYwin, (char *)v208, len31);
                LYclrtoeol();
                mustshow = 1;
                statusline(gettext("Use a filepath off your home directory!"));
                v82 = v14;
                v83 = v5;
                v84 = v9;
                v85 = v18;
                v86 = v21;
                v87 = v26;
                v88 = 32;
                goto lab_0x80a08d7;
            }
        } else {
            goto lab_0x809e97b;
        }
    }
  lab_0x809e426:;
    int32_t v209 = x_display; // 0x809e426
    int32_t str20 = (int32_t)"NONE"; // 0x809e42d
    if (v209 != 0) {
        // 0x809e42f
        str20 = *(char *)v209 == 0 ? (int32_t)"NONE" : v209;
    }
    int32_t len32 = strlen((char *)str20); // 0x809e45b
    int32_t v210 = x_display; // 0x809e466
    int32_t v211 = (int32_t)"NONE"; // 0x809e46d
    if (v210 != 0) {
        // 0x809e46f
        v211 = *(char *)v210 == 0 ? (int32_t)"NONE" : v210;
    }
    // 0x809e492
    LYwaddnstr(LYwin, (char *)v211, len32);
    LYclrtoeol();
    if (v176 != -1) {
        // 0x809e4e3
        mustshow = 1;
        statusline(gettext("Value accepted!"));
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    } else {
        // 0x809e4c1
        HTInfoMsg(gettext("Cancelled!!!"));
        HTInfoMsg((char *)&g30);
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    }
    goto lab_0x80a08d7;
  lab_0x809e0c0:
    // 0x809e0c0
    LYmove(2, 36);
    LYwaddnstr(LYwin, "    ", 4);
    str13 = 0;
    goto lab_0x809e0f8;
  lab_0x809e97b:;
    int32_t v219 = bookmark_page; // 0x809e97b
    int32_t str23 = (int32_t)"NONE"; // 0x809e982
    if (v219 != 0) {
        // 0x809e984
        str23 = *(char *)v219 == 0 ? (int32_t)"NONE" : v219;
    }
    int32_t len35 = strlen((char *)str23); // 0x809e9b0
    int32_t v220 = bookmark_page; // 0x809e9bb
    int32_t v221 = (int32_t)"NONE"; // 0x809e9c2
    if (v220 != 0) {
        // 0x809e9c4
        v221 = *(char *)v220 == 0 ? (int32_t)"NONE" : v220;
    }
    // 0x809e9e7
    LYwaddnstr(LYwin, (char *)v221, len35);
    goto lab_0x809eb3b;
  lab_0x809e50d:
    // 0x809e50d
    if ((char)str13 != 0) {
        goto lab_0x809e582;
    } else {
        // 0x809e518
        if (x_display == 0) {
            goto lab_0x809e536;
        } else {
            // 0x809e52a
            if (*(char *)x_display != 0) {
                goto lab_0x809e582;
            } else {
                goto lab_0x809e536;
            }
        }
    }
  lab_0x809e0f8:
    // 0x809e0f8
    mustshow = 1;
    statusline(gettext("Hit RETURN to accept entered data."));
    LYmove(2, 36);
    lynx_start_bold();
    int32_t v212 = LYgetstr((char *)&str13, 0, 1024, 0); // 0x809e14d
    lynx_stop_bold();
    LYmove(2, 36);
    if (v212 != -1 == term_options == 0) {
        // 0x809e21b
        if ((char)str13 != 0) {
            // 0x809e265
            HTSACopy((char **)&editor, (char *)&str13);
            int32_t len33 = strlen((char *)&str13); // 0x809e284
            LYwaddnstr(LYwin, (char *)&str13, len33);
        } else {
            // 0x809e226
            if (editor != 0) {
                // 0x809e22f
                free((int32_t *)editor);
                editor = 0;
            }
            // 0x809e246
            LYwaddnstr(LYwin, "NONE", 4);
        }
    } else {
        int32_t v213 = editor; // 0x809e189
        int32_t str21 = (int32_t)"NONE"; // 0x809e190
        if (v213 != 0) {
            // 0x809e192
            str21 = *(char *)v213 == 0 ? (int32_t)"NONE" : v213;
        }
        int32_t len34 = strlen((char *)str21); // 0x809e1be
        int32_t v214 = editor; // 0x809e1c9
        int32_t v215 = (int32_t)"NONE"; // 0x809e1d0
        if (v214 != 0) {
            // 0x809e1d2
            v215 = *(char *)v214 == 0 ? (int32_t)"NONE" : v214;
        }
        // 0x809e1f5
        LYwaddnstr(LYwin, (char *)v215, len34);
    }
    // 0x809e2a5
    LYclrtoeol();
    if (v212 != -1) {
        // 0x809e2d5
        mustshow = 1;
        statusline(gettext("Value accepted!"));
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    } else {
        // 0x809e2b3
        HTInfoMsg(gettext("Cancelled!!!"));
        HTInfoMsg((char *)&g30);
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    }
    goto lab_0x80a08d7;
  lab_0x809eb3b:
    // 0x809eb3b
    LYclrtoeol();
    if (v205 != -1) {
        // 0x809eb6b
        mustshow = 1;
        statusline(gettext("Value accepted!"));
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    } else {
        // 0x809eb49
        HTInfoMsg(gettext("Cancelled!!!"));
        HTInfoMsg((char *)&g30);
        v82 = v14;
        v83 = v5;
        v84 = v9;
        v85 = v18;
        v86 = v21;
        v87 = v26;
        v88 = 32;
    }
    goto lab_0x80a08d7;
  lab_0x809e582:
    // 0x809e582
    LYsetXDisplay((char *)&str13);
    validate_x_display();
    int32_t v216 = x_display; // 0x809e59f
    int32_t str22 = v216 == 0 ? (int32_t)"NONE" : v216;
    int32_t v217 = x_display; // 0x809e5d3
    int32_t v218 = v217 == 0 ? (int32_t)"NONE" : v217;
    LYwaddnstr(LYwin, (char *)v218, strlen((char *)str22));
    LYclrtoeol();
    summarize_x_display((char *)&str13);
    v82 = v14;
    v83 = v5;
    v84 = v9;
    v85 = v18;
    v86 = v21;
    v87 = v26;
    v88 = 32;
    goto lab_0x80a08d7;
  lab_0x809e536:
    // 0x809e536
    LYwaddnstr(LYwin, "NONE", 4);
    LYclrtoeol();
    mustshow = 1;
    statusline(gettext("Value accepted!"));
    v82 = v14;
    v83 = v5;
    v84 = v9;
    v85 = v18;
    v86 = v21;
    v87 = v26;
    v88 = 32;
    goto lab_0x80a08d7;
  lab_0x809cc5c:
    // 0x809cc5c
    v12 = v11;
    v3 = v2;
    v7 = v6;
    v16 = v15;
    v20 = v19;
    v24 = v23;
    goto lab_0x809cc5c_2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a09f5 - 0x80a0a47
// Line range:    1582 - 1592
int32_t widest_choice(char ** choices) {
    char * str = *choices;
    int32_t v1 = 0; // 0x80a0a40
    if (str == NULL) {
        // 0x80a0a42
        return 0;
    }
    int32_t v2 = 0;
    int32_t len = strlen((char *)(int32_t)str); // 0x80a0a19
    int32_t result = v2 < len ? len : v2;
    v1++;
    int32_t str2 = *(int32_t *)(4 * v1 + (int32_t)choices); // 0x80a0a3c
    while (str2 != 0) {
        // 0x80a0a0b
        v2 = result;
        len = strlen((char *)str2);
        result = v2 < len ? len : v2;
        v1++;
        str2 = *(int32_t *)(4 * v1 + (int32_t)choices);
    }
    // 0x80a0a42
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a0a47 - 0x80a0aa9
// Line range:    1596 - 1602
void show_choice(char * choice, int32_t width) {
    int32_t len = strlen(choice); // 0x80a0a53
    LYwaddnstr(LYwin, choice, strlen(choice));
    int32_t v1 = len - width; // 0x80a0a99
    if (v1 < 0 == ((v1 ^ len) & (len ^ width)) < 0) {
        // 0x80a0aa7
        return;
    }
    int32_t v2 = len; // 0x80a0aa5
    v2++;
    function_804a8f4((int32_t)LYwin, 32);
    while (v2 - width < 0 != ((v2 - width ^ v2) & (v2 ^ width)) < 0) {
        // 0x80a0a81
        v2++;
        function_804a8f4((int32_t)LYwin, 32);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a0aa9 - 0x80a0dfb
// Line range:    1611 - 1744
int32_t boolean_choice(int32_t cur_choice, int32_t line, int32_t column, char ** choices) {
    int32_t v1 = (int32_t)choices;
    int32_t v2 = widest_choice(choices); // 0x80a0aeb
    int32_t v3 = 0; // 0x80a0afa
    while (*(int32_t *)(4 * v3 + v1) != 0) {
        // 0x80a0b00
        v3++;
    }
    int32_t v4 = column < 0 ? 36 : column;
    mustshow = 1;
    statusline(gettext("Hit any key to change value; RETURN to accept."));
    LYmove(line, v4);
    lynx_start_reverse();
    int32_t * v5 = (int32_t *)(4 * cur_choice + v1);
    show_choice((char *)*v5, v2);
    int32_t v6 = v4 - 1;
    if (LYShowCursor != 0) {
        // 0x80a0b6a
        LYmove(line, v6);
    }
    int32_t v7 = v3 - 1; // 0x80a0b0f
    LYrefresh();
    term_options = 0;
    int32_t v8 = cur_choice; // 0x80a0b84
    uint32_t v9 = 0; // 0x80a0b84
    int32_t v10; // 0x80a0aa9
    while (true) {
      lab_0x80a0b8b:
        // 0x80a0b8b
        v10 = v8;
        LYmove(line, v4);
        int32_t v11 = v9; // 0x80a0ba6
        if (term_options == 0) {
            // 0x80a0ba8
            v11 = LYgetch_single();
        }
        // 0x80a0bb0
        if (term_options != 0) {
            // break -> 0x80a0c42
            break;
        }
        // 0x80a0bbb
        v9 = v11;
        if ((v9 || 4) == 7) {
            goto lab_0x80a0c10;
        } else {
            if (v9 != -1) {
                if ((v9 & 0x8800) == 0) {
                    int16_t v12 = *(int16_t *)((2 * v9 & 4094) + 0x8197ea2); // 0x80a0c02
                    if (v12 != 47) {
                        goto lab_0x80a0c42;
                    } else {
                        goto lab_0x80a0c10;
                    }
                } else {
                    if (v9 % 256 == 47) {
                        goto lab_0x80a0c10;
                    } else {
                        goto lab_0x80a0c42;
                    }
                }
            } else {
                // 0x80a0bcd
                if (keymap[0] == 47) {
                    goto lab_0x80a0c10;
                } else {
                    goto lab_0x80a0c42;
                }
            }
        }
    }
  lab_0x80a0c42_2:
    // 0x80a0c42
    term_options = 1;
    int32_t * v13 = v5; // 0x80a0aa9
    int32_t result = cur_choice; // 0x80a0aa9
    goto lab_0x80a0d76_2;
  lab_0x80a0c10:;
    int16_t v14 = *(int16_t *)(2 * v9 + (int32_t)*__ctype_b_loc()); // 0x80a0c1f
    if ((v14 & 0x4000) == 0) {
        // break -> 0x80a0c42
        goto lab_0x80a0c42_2;
    }
    goto lab_0x80a0c42;
  lab_0x80a0c42:;
    int32_t v15; // 0x80a0aa9
    int32_t v16; // 0x80a0aa9
    switch (v9) {
        case 13: {
            // 0x80a0d76
            v13 = (int32_t *)(4 * v10 + v1);
            result = v10;
            goto lab_0x80a0d76_2;
        }
        case 10: {
            // 0x80a0d76
            v13 = (int32_t *)(4 * v10 + v1);
            result = v10;
            goto lab_0x80a0d76_2;
        }
        default: {
            int32_t v17; // 0x80a0aa9
            if (v9 != -1) {
                if ((v9 & 0x8800) == 0) {
                    uint16_t v18 = *(int16_t *)((2 * v9 & 4094) + (int32_t)&keymap + 2); // 0x80a0c8f
                    v17 = v18;
                } else {
                    // 0x80a0c77
                    v17 = v9 % 256;
                }
            } else {
                // 0x80a0c5c
                v17 = keymap[0];
            }
            // 0x80a0ca3
            v16 = v17;
            if (v16 == 39) {
                // 0x80a0d76
                v13 = (int32_t *)(4 * v10 + v1);
                result = v10;
                goto lab_0x80a0d76_2;
            }
            // 0x80a0cb9
            g388 = v16;
            v15 = 0;
            switch ((int16_t)v16) {
                case 2: {
                    goto lab_0x80a0d07;
                }
                case 3: {
                    goto lab_0x80a0d07;
                }
                case 4: {
                    goto lab_0x80a0d07;
                }
                case 5: {
                    goto lab_0x80a0d07;
                }
                case 6: {
                    goto lab_0x80a0d07;
                }
                case 7: {
                    goto lab_0x80a0d07;
                }
                case 8: {
                    goto lab_0x80a0d07;
                }
                case 9: {
                    goto lab_0x80a0d07;
                }
                case 10: {
                    goto lab_0x80a0d07;
                }
                case 13: {
                    // 0x80a0ce4
                    term_options = 1;
                    v15 = cur_choice;
                    goto lab_0x80a0d32;
                }
                case 14: {
                    // 0x80a0ce4
                    term_options = 1;
                    v15 = cur_choice;
                    goto lab_0x80a0d32;
                }
                case 16: {
                    // 0x80a0cf3
                    v15 = v10 != 0 ? v10 - 1 : v7;
                    goto lab_0x80a0d32;
                }
                case 17: {
                    // 0x80a0cf3
                    v15 = v10 != 0 ? v10 - 1 : v7;
                    goto lab_0x80a0d32;
                }
                case 19: {
                    // 0x80a0cf3
                    v15 = v10 != 0 ? v10 - 1 : v7;
                    goto lab_0x80a0d32;
                }
                case 21: {
                    // 0x80a0cd8
                    lynx_force_repaint();
                    LYrefresh();
                    v15 = v10;
                    goto lab_0x80a0d32;
                }
                case 22: {
                    goto lab_0x80a0d32;
                }
                case 23: {
                    // 0x80a0cd0
                    v15 = v7;
                    goto lab_0x80a0d32;
                }
                case 26: {
                    // 0x80a0cf3
                    v15 = v10 != 0 ? v10 - 1 : v7;
                    goto lab_0x80a0d32;
                }
                case 28: {
                    // 0x80a0cf3
                    v15 = v10 != 0 ? v10 - 1 : v7;
                    goto lab_0x80a0d32;
                }
                case 30: {
                    // 0x80a0cf3
                    v15 = v10 != 0 ? v10 - 1 : v7;
                    goto lab_0x80a0d32;
                }
                case 32: {
                    // 0x80a0cf3
                    v15 = v10 != 0 ? v10 - 1 : v7;
                    goto lab_0x80a0d32;
                }
                case 35: {
                    // 0x80a0cf3
                    v15 = v10 != 0 ? v10 - 1 : v7;
                    goto lab_0x80a0d32;
                }
                case 37: {
                    // 0x80a0ce4
                    term_options = 1;
                    v15 = cur_choice;
                    goto lab_0x80a0d32;
                }
                default: {
                    // 0x80a0d1d
                    v15 = v10 != v7 ? v10 + 1 : 0;
                    goto lab_0x80a0d32;
                }
            }
        }
    }
  lab_0x80a0d07:;
    int32_t v19 = v16 - 1; // 0x80a0d0a
    v15 = v19;
    if (v19 > v7) {
        // 0x80a0d1d
        v15 = v10 != v7 ? v10 + 1 : 0;
        goto lab_0x80a0d32;
    } else {
        goto lab_0x80a0d32;
    }
  lab_0x80a0d32:
    // 0x80a0d32
    v8 = v15;
    show_choice((char *)*(int32_t *)(4 * v8 + v1), v2);
    if (LYShowCursor != 0) {
        // 0x80a0d57
        LYmove(line, v6);
    }
    // 0x80a0d6c
    LYrefresh();
    goto lab_0x80a0b8b;
  lab_0x80a0d76_2:
    // 0x80a0d76
    LYmove(line, v4);
    lynx_stop_reverse();
    show_choice((char *)*v13, v2);
    if (term_options == 0) {
        // 0x80a0ddb
        mustshow = 1;
        statusline(gettext("Value accepted!"));
    } else {
        // 0x80a0db2
        term_options = 0;
        HTInfoMsg(gettext("Cancelled!!!"));
        HTInfoMsg((char *)&g30);
    }
    // 0x80a0df6
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a0e1e - 0x80a1e83
// Line range:    1769 - 2054
void edit_bookmarks(void) {
    char MBM_tmp_line2[256]; // bp-272, 0x80a0e1e
    char MBM_tmp_line[256]; // bp-276, 0x80a0e1e
    char v1[256]; // 0x80a15ce
    char v2[256]; // 0x80a1841
    char v3[256]; // 0x80a186e
    int32_t v4 = __readgsdword(20); // 0x80a0e28
    MBM_tmp_line2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    MBM_tmp_line = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    term_options = 0;
    signal(SIGINT, 0x80a0dfb);
    int32_t v5 = 1; // 0x80a0e67
    int32_t v6; // 0x80a0e1e
    int32_t v7; // 0x80a0e1e
    uint32_t v8; // 0x80a1da3
    while (true) {
      lab_0x80a0e6c_2:
        // 0x80a0e6c
        v6 = v5;
        if (enable_scrollback == 0) {
            // 0x80a0e7e
            LYerase();
        } else {
            // 0x80a0e77
            LYclear();
        }
        // 0x80a0e83
        LYmove(0, 5);
        lynx_start_h1_color();
        if (LYlines > 32) {
            int32_t len = strlen(gettext("         Editing Bookmark DESCRIPTION and FILEPATH")); // 0x80a0f3b
            LYwaddnstr(LYwin, gettext("         Editing Bookmark DESCRIPTION and FILEPATH"), len);
        } else {
            int32_t MBM_current = 0; // bp-292, 0x80a0eaa
            char * v9 = gettext("Editing Bookmark DESCRIPTION and FILEPATH (%d of 2)"); // 0x80a0ebb
            HTSprintf0((char **)&MBM_current, v9);
            LYwaddnstr(LYwin, (char *)MBM_current, strlen((char *)MBM_current));
            int32_t v10 = MBM_current; // 0x80a0f08
            if (v10 != 0) {
                // 0x80a0f12
                free((int32_t *)v10);
                MBM_current = 0;
            }
        }
        // 0x80a0f64
        lynx_stop_h1_color();
        int32_t v11 = 0; // 0x80a0f71
        if (LYlines > 32) {
            int32_t v12 = v11 + 3; // 0x80a1126
            LYmove(v12, 5);
            uint32_t v13 = LYindex2MBM(v11); // 0x80a1142
            function_804a8f4((int32_t)LYwin, v13 % 256);
            LYwaddnstr(LYwin, " : ", 3);
            int32_t v14 = 4 * v11; // 0x80a117f
            int32_t * v15 = (int32_t *)(v14 + (int32_t)&MBM_A_subdescript); // 0x80a117f
            int32_t str = *v15; // 0x80a117f
            int32_t len2; // 0x80a119a
            if (str != 0) {
                // 0x80a118a
                len2 = strlen((char *)str);
                LYwaddnstr(LYwin, (char *)*v15, len2);
            }
            // 0x80a11c4
            LYmove(v12, 35);
            LYwaddnstr(LYwin, "| ", 2);
            int32_t * v16 = (int32_t *)(v14 + (int32_t)&MBM_A_subbookmark); // 0x80a1200
            int32_t str2 = *v16; // 0x80a1200
            int32_t len3; // 0x80a121b
            if (str2 != 0) {
                // 0x80a120b
                len3 = strlen((char *)str2);
                LYwaddnstr(LYwin, (char *)*v16, len3);
            }
            int32_t v17 = v11 + 1; // 0x80a1245
            v11 = v17;
            while (v17 != 26) {
                // 0x80a1120
                v12 = v11 + 3;
                LYmove(v12, 5);
                v13 = LYindex2MBM(v11);
                function_804a8f4((int32_t)LYwin, v13 % 256);
                LYwaddnstr(LYwin, " : ", 3);
                v14 = 4 * v11;
                v15 = (int32_t *)(v14 + (int32_t)&MBM_A_subdescript);
                str = *v15;
                if (str != 0) {
                    // 0x80a118a
                    len2 = strlen((char *)str);
                    LYwaddnstr(LYwin, (char *)*v15, len2);
                }
                // 0x80a11c4
                LYmove(v12, 35);
                LYwaddnstr(LYwin, "| ", 2);
                v16 = (int32_t *)(v14 + (int32_t)&MBM_A_subbookmark);
                str2 = *v16;
                if (str2 != 0) {
                    // 0x80a120b
                    len3 = strlen((char *)str2);
                    LYwaddnstr(LYwin, (char *)*v16, len3);
                }
                // 0x80a1245
                v17 = v11 + 1;
                v11 = v17;
            }
        } else {
            int32_t v18 = 13 * v6 - 13; // 0x80a0f88
            int32_t v19 = 25 * v6; // 0x80a10f4
            uint32_t v20 = v19 + (int32_t)(v19 < 0) >> 1; // 0x80a10fe
            if (v20 >= v18) {
                int32_t v21 = v18;
                int32_t v22 = -13 * v6 + 16 + v21; // 0x80a0fab
                LYmove(v22, 5);
                uint32_t v23 = LYindex2MBM(v21); // 0x80a0fc7
                function_804a8f4((int32_t)LYwin, v23 % 256);
                LYwaddnstr(LYwin, " : ", 3);
                int32_t v24 = 4 * v21; // 0x80a1004
                int32_t * v25 = (int32_t *)(v24 + (int32_t)&MBM_A_subdescript); // 0x80a1004
                int32_t str3 = *v25; // 0x80a1004
                int32_t len4; // 0x80a101f
                if (str3 != 0) {
                    // 0x80a100f
                    len4 = strlen((char *)str3);
                    LYwaddnstr(LYwin, (char *)*v25, len4);
                }
                // 0x80a1049
                LYmove(v22, 35);
                LYwaddnstr(LYwin, "| ", 2);
                int32_t * v26 = (int32_t *)(v24 + (int32_t)&MBM_A_subbookmark); // 0x80a1094
                int32_t str4 = *v26; // 0x80a1094
                int32_t len5; // 0x80a10af
                if (str4 != 0) {
                    // 0x80a109f
                    len5 = strlen((char *)str4);
                    LYwaddnstr(LYwin, (char *)*v26, len5);
                }
                int32_t v27 = v21 + 1; // 0x80a1106
                while (v21 != v20) {
                    // 0x80a0f96
                    v21 = v27;
                    v22 = -13 * v6 + 16 + v21;
                    LYmove(v22, 5);
                    v23 = LYindex2MBM(v21);
                    function_804a8f4((int32_t)LYwin, v23 % 256);
                    LYwaddnstr(LYwin, " : ", 3);
                    v24 = 4 * v21;
                    v25 = (int32_t *)(v24 + (int32_t)&MBM_A_subdescript);
                    str3 = *v25;
                    if (str3 != 0) {
                        // 0x80a100f
                        len4 = strlen((char *)str3);
                        LYwaddnstr(LYwin, (char *)*v25, len4);
                    }
                    // 0x80a1049
                    LYmove(v22, 35);
                    LYwaddnstr(LYwin, "| ", 2);
                    v26 = (int32_t *)(v24 + (int32_t)&MBM_A_subbookmark);
                    str4 = *v26;
                    if (str4 != 0) {
                        // 0x80a109f
                        len5 = strlen((char *)str4);
                        LYwaddnstr(LYwin, (char *)*v26, len5);
                    }
                    // 0x80a10d9
                    v27 = v21 + 1;
                }
            }
        }
        int32_t v28 = LYlines; // 0x80a1261
        if (LYlines <= 32) {
            // 0x80a1267
            LYmove(LYlines - 4, 0);
            LYwaddnstr(LYwin, "'", 1);
            lynx_start_bold();
            LYwaddnstr(LYwin, "[", 1);
            lynx_stop_bold();
            LYwaddnstr(LYwin, "' ", 2);
            int32_t len6 = strlen(gettext("previous")); // 0x80a12ef
            LYwaddnstr(LYwin, gettext("previous"), len6);
            LYwaddnstr(LYwin, ", '", 3);
            lynx_start_bold();
            LYwaddnstr(LYwin, "]", 1);
            lynx_stop_bold();
            LYwaddnstr(LYwin, "' ", 2);
            int32_t len7 = strlen(gettext("next screen")); // 0x80a1388
            LYwaddnstr(LYwin, gettext("next screen"), len7);
            v28 = LYlines;
        }
        // 0x80a13b1
        LYmove(v28 - 3, 0);
        if (no_option_save == 0) {
            // 0x80a13d8
            LYwaddnstr(LYwin, "'", 1);
            lynx_start_bold();
            LYwaddnstr(LYwin, ">", 1);
            lynx_stop_bold();
            LYwaddnstr(LYwin, "'", 1);
            int32_t len8 = strlen(gettext(" to save,")); // 0x80a1448
            LYwaddnstr(LYwin, gettext(" to save,"), len8);
        }
        int32_t len9 = strlen(gettext(" or ")); // 0x80a1480
        LYwaddnstr(LYwin, gettext(" or "), len9);
        LYwaddnstr(LYwin, "'", 1);
        lynx_start_bold();
        LYwaddnstr(LYwin, "^G", 2);
        lynx_stop_bold();
        LYwaddnstr(LYwin, "'", 1);
        int32_t len10 = strlen(gettext(" to return to Lynx.")); // 0x80a1519
        LYwaddnstr(LYwin, gettext(" to return to Lynx."), len10);
        if (term_options != 0) {
            // break -> 0x80a1e4e
            break;
        }
        // 0x80a1d9b
        v7 = -13 * v6 + 16;
        while (true) {
          lab_0x80a1d9b:
            // 0x80a1d9b
            v8 = *(int32_t *)&MBM_tmp_line2;
            if (LYisNonAlnumKeyname(v8, 37) != 0) {
                // break (via goto) -> 0x80a1e4e
                goto lab_0x80a1e4e_4;
            }
            switch (v8) {
                case 3: {
                    goto lab_0x80a1e20;
                }
                case 7: {
                    goto lab_0x80a1e20;
                }
                default: {
                    if (v8 != -1) {
                        if ((v8 & 0x8800) == 0) {
                            // 0x80a1e04
                            if (*(int16_t *)((2 * v8 & 4094) + 0x8197ea2) != 47) {
                                goto lab_0x80a1e41;
                            } else {
                                goto lab_0x80a1e20;
                            }
                        } else {
                            if (v8 % 256 != 47) {
                                goto lab_0x80a1e41;
                            } else {
                                goto lab_0x80a1e20;
                            }
                        }
                    } else {
                        // 0x80a1dd4
                        if (keymap[0] != 47) {
                            goto lab_0x80a1e41;
                        } else {
                            goto lab_0x80a1e20;
                        }
                    }
                }
            }
        }
      lab_0x80a1779:;
        int32_t v29 = v6 + 1; // 0x80a1779
        // 0x80a0e6c
        v5 = v29 < 3 ? v29 : 1;
        goto lab_0x80a0e6c_2;
    }
  lab_0x80a1e4e_4:
    // 0x80a1e4e
    term_options = 0;
    signal(SIGINT, 0x804b4e4);
    if (v4 != __readgsdword(20)) {
        // 0x80a1e75
        __stack_chk_fail();
    }
  lab_0x80a1d8c:
    // 0x80a1d8c
    if (term_options != 0) {
        // break (via goto) -> 0x80a1e4e
        goto lab_0x80a1e4e_4;
    }
    goto lab_0x80a1d9b;
  lab_0x80a1e20:
    // 0x80a1e20
    if ((*(int16_t *)(2 * v8 + (int32_t)*__ctype_b_loc()) & 0x4000) == 0) {
        // break (via goto) -> 0x80a1e4e
        goto lab_0x80a1e4e_4;
    }
    goto lab_0x80a1e41;
  lab_0x80a1e41:
    if (v8 == 62) {
        // break (via goto) -> 0x80a1e4e
        goto lab_0x80a1e4e_4;
    }
    // 0x80a1547
    LYmove(LYlines - 2, 0);
    lynx_start_prompt_color();
    int32_t len11 = strlen(gettext("Letter: ")); // 0x80a1573
    LYwaddnstr(LYwin, gettext("Letter: "), len11);
    lynx_stop_prompt_color();
    LYrefresh();
    int32_t v30 = *(int32_t *)&MBM_tmp_line; // 0x80a15a6
    int32_t v31 = v30; // 0x80a15ad
    if (v30 == 0) {
        // 0x80a15af
        v31 = LYgetch_single();
    }
    // 0x80a15c8
    v1[0] = v31;
    MBM_tmp_line2 = v1;
    MBM_tmp_line = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    uint32_t v32; // 0x80a15ed
    if (term_options != 0) {
        goto lab_0x80a1d8c;
    } else {
        // 0x80a15ed
        v32 = *(int32_t *)&MBM_tmp_line2;
        switch (v32) {
            case 3: {
                goto lab_0x80a1654;
            }
            case 7: {
                goto lab_0x80a1654;
            }
            default: {
                if (v32 != -1) {
                    if ((v32 & 0x8800) == 0) {
                        // 0x80a1638
                        if (*(int16_t *)((2 * v32 & 4094) + 0x8197ea2) != 47) {
                            goto lab_0x80a1679;
                        } else {
                            goto lab_0x80a1654;
                        }
                    } else {
                        if (v32 % 256 == 47) {
                            goto lab_0x80a1654;
                        } else {
                            goto lab_0x80a1679;
                        }
                    }
                } else {
                    // 0x80a1608
                    if (keymap[0] == 47) {
                        goto lab_0x80a1654;
                    } else {
                        goto lab_0x80a1679;
                    }
                }
            }
        }
    }
  lab_0x80a1654:
    // 0x80a1654
    if ((*(int16_t *)(2 * v32 + (int32_t)*__ctype_b_loc()) & 0x4000) == 0) {
        goto lab_0x80a1d8c;
    } else {
        goto lab_0x80a1679;
    }
  lab_0x80a1679:
    // 0x80a1679
    if (LYisNonAlnumKeyname(v32, 37) != 0) {
        goto lab_0x80a1d8c;
    } else {
        if (v32 != 62) {
            // 0x80a1728
            if (LYisNonAlnumKeyname(v32, 21) == 0) {
                if (v32 == 93) {
                    goto lab_0x80a176f;
                } else {
                    // 0x80a1755
                    if (LYisNonAlnumKeyname(v32, 15) == 0) {
                        goto lab_0x80a179c;
                    } else {
                        goto lab_0x80a176f;
                    }
                }
            } else {
                // 0x80a1742
                lynx_force_repaint();
                goto lab_0x80a1d8c;
            }
        } else {
            // 0x80a16a4
            if (no_option_save != 0) {
                // 0x80a1705
                HTInfoMsg(gettext(" 'r' to return to Lynx "));
                MBM_tmp_line2 = {32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
            } else {
                // 0x80a16af
                HTInfoMsg(gettext("Saving Options..."));
                if (save_rc(NULL) == 0) {
                    // 0x80a16ec
                    HTAlert(gettext("Unable to save Options!"));
                } else {
                    // 0x80a16d3
                    HTInfoMsg(gettext("Options saved!"));
                }
            }
            goto lab_0x80a1d8c;
        }
    }
  lab_0x80a176f:
    // 0x80a176f
    if (LYlines <= 32) {
        // break -> 0x80a1779
        goto lab_0x80a1779;
    }
    goto lab_0x80a179c;
  lab_0x80a179c:
    if (v32 == 91) {
        goto lab_0x80a17bf;
    } else {
        // 0x80a17a5
        if (LYisNonAlnumKeyname(v32, 16) == 0) {
            goto lab_0x80a17ec;
        } else {
            goto lab_0x80a17bf;
        }
    }
  lab_0x80a17bf:
    // 0x80a17bf
    if (LYlines <= 32) {
        int32_t v33 = v6 - 1; // 0x80a17c9
        // 0x80a0e6c
        v5 = v33 >= 0 == (v33 != 0) ? v33 : 2;
        goto lab_0x80a0e6c_2;
    }
    goto lab_0x80a17ec;
  lab_0x80a17ec:;
    uint32_t v34 = 0;
    while (LYMBM2index(v32) != v34) {
        int32_t v35 = v34 + 1; // 0x80a1d78
        int32_t v36 = v35; // 0x80a1d86
        if (v35 >= 26) {
            goto lab_0x80a1d8c;
        }
        v34 = v36;
    }
    // 0x80a1815
    if (LYlines <= 32) {
        if (v6 == 1 && v34 >= 13) {
            // 0x80a1831
            v2[0] = v32;
            MBM_tmp_line = v2;
            // 0x80a0e6c
            v5 = 2;
            goto lab_0x80a0e6c_2;
        }
        if (v6 == 2 && v34 <= 11) {
            // 0x80a185e
            v3[0] = v32;
            MBM_tmp_line = v3;
            // 0x80a0e6c
            v5 = 1;
            goto lab_0x80a0e6c_2;
        }
    }
    // 0x80a1879
    mustshow = 1;
    statusline(gettext("Hit RETURN to accept entered data."));
    int32_t v37; // bp-268, 0x80a0e1e
    if (v34 != 0) {
        // 0x80a18a1
        lynx_start_bold();
        if (LYlines > 32) {
            // 0x80a18da
            LYmove(v34 + 3, 9);
        } else {
            // 0x80a18b0
            LYmove(v7 + v34, 9);
        }
        int32_t v38 = 4 * v34 + (int32_t)&MBM_A_subdescript; // 0x80a18f9
        int32_t * v39 = (int32_t *)v38; // 0x80a18f9
        int32_t v40 = *v39; // 0x80a18f9
        int32_t v41 = v40 == 0 ? (int32_t)&g30 : v40;
        LYstrncpy((char *)&v37, (char *)v41, 255);
        LYgetstr((char *)&v37, 0, 256, 0);
        lynx_stop_bold();
        if ((char)v37 != 0) {
            // 0x80a19ba
            HTSACopy((char **)v38, (char *)&v37);
        } else {
            int32_t v42 = *v39; // 0x80a1987
            if (v42 != 0) {
                // 0x80a1992
                free((int32_t *)v42);
                *v39 = 0;
            }
        }
        // 0x80a19db
        if (LYlines > 32) {
            // 0x80a1a0f
            LYmove(v34 + 3, 5);
        } else {
            // 0x80a19e5
            LYmove(v7 + v34, 5);
        }
        uint32_t v43 = LYindex2MBM(v34); // 0x80a1a31
        function_804a8f4((int32_t)LYwin, v43 % 256);
        LYwaddnstr(LYwin, " : ", 3);
        int32_t str5 = *v39; // 0x80a1a6e
        if (str5 != 0) {
            int32_t len12 = strlen((char *)str5); // 0x80a1a89
            LYwaddnstr(LYwin, (char *)*v39, len12);
        }
        // 0x80a1ab3
        LYclrtoeol();
        LYrefresh();
    }
    // 0x80a1abd
    if (LYlines > 32) {
        // 0x80a1af1
        LYmove(v34 + 3, 35);
    } else {
        // 0x80a1ac7
        LYmove(v7 + v34, 35);
    }
    // 0x80a1b0a
    LYwaddnstr(LYwin, "| ", 2);
    lynx_start_bold();
    int32_t v44 = 4 * v34 + (int32_t)&MBM_A_subbookmark; // 0x80a1b32
    int32_t * v45 = (int32_t *)v44; // 0x80a1b32
    int32_t v46 = *v45; // 0x80a1b32
    int32_t v47 = v46 == 0 ? (int32_t)&g30 : v46;
    LYstrncpy((char *)&v37, (char *)v47, 255);
    LYgetstr((char *)&v37, 0, 256, 0);
    lynx_stop_bold();
    if ((char)v37 != 0) {
        // 0x80a1c23
        if (LYPathOffHomeOK((char *)&v37, 256) != 0) {
            // 0x80a1c58
            HTSACopy((char **)v44, (char *)&v37);
            if (v34 == 0) {
                // 0x80a1c82
                HTSACopy((char **)&bookmark_page, (char *)*v45);
            }
        } else {
            // 0x80a1c3d
            LYMBM_statusline(gettext("Use a filepath off your home directory!"));
            LYSleepAlert();
        }
    } else {
        if (v34 != 0) {
            int32_t v48 = *v45; // 0x80a1bec
            if (v48 != 0) {
                // 0x80a1bfb
                free((int32_t *)v48);
                *v45 = 0;
            }
        } else {
            // 0x80a1bc1
            HTSACopy((char **)v44, (char *)bookmark_page);
        }
    }
    // 0x80a1c9f
    if (LYlines > 32) {
        // 0x80a1cd3
        LYmove(v34 + 3, 35);
    } else {
        // 0x80a1ca9
        LYmove(v7 + v34, 35);
    }
    // 0x80a1cec
    LYwaddnstr(LYwin, "| ", 2);
    int32_t str6 = *v45; // 0x80a1d0f
    if (str6 != 0) {
        int32_t len13 = strlen((char *)str6); // 0x80a1d2a
        LYwaddnstr(LYwin, (char *)*v45, len13);
    }
    // 0x80a1d54
    LYclrtoeol();
    LYmove(LYlines - 1, 0);
    LYclrtoeol();
    goto lab_0x80a1d8c;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a1e83 - 0x80a1f74
// Line range:    2071 - 2101
int32_t popup_choice(int32_t cur_choice, int32_t line, int32_t column, char ** choices, int32_t i_length, int32_t disabled, char for_mouse) {
    int32_t v1 = column >= 0 ? column : 35;
    term_options = 0;
    int32_t result = LYhandlePopupList(cur_choice, line, v1, choices, -1, i_length, disabled, for_mouse); // 0x80a1edc
    uint32_t v2 = result - 13; // 0x80a1ee7
    if (v2 < 25) {
        uint32_t v3 = v2 % 32; // 0x80a1efc
        if (v3 == 0) {
            goto lab_0x80a1f07;
        } else {
            if ((1 << v3 & 0x1000003) == 0) {
                goto lab_0x80a1f28;
            } else {
                goto lab_0x80a1f07;
            }
        }
    } else {
        goto lab_0x80a1f28;
    }
  lab_0x80a1f28:
    // 0x80a1f28
    if (disabled == 0 != (term_options == 0)) {
        // 0x80a1f39
        mustshow = 1;
        statusline((char *)&g30);
        // 0x80a1f6f
        return result;
    }
    if (for_mouse == 0) {
        // 0x80a1f54
        mustshow = 1;
        statusline(gettext("Value accepted!"));
    }
    // 0x80a1f6f
    return result;
  lab_0x80a1f07:
    // 0x80a1f07
    term_options = 1;
    if (for_mouse == 0) {
        // 0x80a1f14
        HTUserMsg(gettext("Cancelled!!!"));
    }
    goto lab_0x80a1f28;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a1f74 - 0x80a1fec
// Line range:    2446 - 2456
void PutOptValues(struct _IO_FILE * fp, int32_t value, int32_t * table) {
    int32_t v1 = (int32_t)table;
    int32_t v2 = *(int32_t *)(v1 + 4); // 0x80a1fe3
    if (v2 == 0) {
        // 0x80a1fea
        return;
    }
    int32_t * v3 = (int32_t *)(v1 + 8); // 0x80a1f7f
    char * v4; // 0x80a1f8f
    char * v5; // 0x80a1fd7
    if (*v3 != 0) {
        // 0x80a1f86
        v4 = gettext((char *)v2);
        v5 = *(int32_t *)v1 != value ? (char *)&g30 : "selected";
        fprintf(fp, "<option value=\"%s\" %s>%s\n", (char *)*v3, v5, v4);
    }
    int32_t v6 = *(int32_t *)(v1 + 16); // 0x80a1fe3
    int32_t v7 = v6; // 0x80a1fe8
    int32_t v8 = v1 + 12; // 0x80a1fe8
    while (v6 != 0) {
        int32_t v9 = v8;
        v3 = (int32_t *)(v9 + 8);
        if (*v3 != 0) {
            // 0x80a1f86
            v4 = gettext((char *)v7);
            int32_t v10 = *(int32_t *)v9; // 0x80a1f9a
            v5 = v10 != value ? (char *)&g30 : "selected";
            fprintf(fp, "<option value=\"%s\" %s>%s\n", (char *)*v3, v5, v4);
        }
        // 0x80a1fdc
        v6 = *(int32_t *)(v9 + 16);
        v7 = v6;
        v8 = v9 + 12;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a1fec - 0x80a203f
// Line range:    2460 - 2469
char GetOptValues(int32_t * table, char * value, int32_t * result) {
    int32_t v1 = (int32_t)table;
    if (*(int32_t *)(v1 + 4) == 0) {
        // 0x80a2039
        return 0;
    }
    int32_t v2 = v1;
    int32_t str = *(int32_t *)(v2 + 8); // 0x80a1ff7
    char result2; // 0x80a1fec
    if (str != 0) {
        // 0x80a1ffe
        if (strcmp(value, (char *)str) == 0) {
            // 0x80a2017
            *result = *(int32_t *)v2;
            result2 = 1;
            return result2;
        }
    }
    int32_t v3 = v2 + 12; // 0x80a2033
    result2 = 0;
    while (*(int32_t *)(v2 + 16) != 0) {
        // 0x80a1ff4
        v2 = v3;
        str = *(int32_t *)(v2 + 8);
        if (str != 0) {
            // 0x80a1ffe
            if (strcmp(value, (char *)str) == 0) {
                // 0x80a2017
                *result = *(int32_t *)v2;
                result2 = 1;
                return result2;
            }
        }
        // 0x80a2027
        v3 = v2 + 12;
        result2 = 0;
    }
  lab_0x80a2039:
    // 0x80a2039
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a203f - 0x80a22e7
// Line range:    2481 - 2552
int32_t * break_data(int32_t * data) {
    // 0x80a203f
    if (data == NULL || *(int32_t *)((int32_t)data + 4) == 0) {
        // 0x80a22dd
        return NULL;
    }
    char * v1 = (char *)*data;
    char * v2 = v1; // bp-16, 0x80a2091
    if (WWW_TraceFlag != 0) {
        // 0x80a209f
        fprintf(TraceFP(), "break_data %s\n", v1);
    }
    int32_t * mem = calloc(1, 8); // 0x80a20cc
    char * v3 = NULL; // 0x80a20d8
    int32_t * mem2 = mem; // 0x80a20d8
    if (mem == NULL) {
        // 0x80a20da
        outofmem("./LYOptions.c", "break_data(calloc)");
        // UNREACHABLE
    }
    int32_t v4; // 0x80a203f
    char * v5; // 0x80a203f
    int32_t v6; // 0x80a203f
    int32_t v7; // 0x80a203f
    int32_t * v8; // 0x80a203f
    int32_t * v9; // 0x80a203f
    int32_t * v10; // 0x80a203f
    int32_t * str; // 0x80a210c
    uint32_t len; // 0x80a215a
    while (true) {
        int32_t v11 = (int32_t)v3; // 0x80a20ee
        int32_t v12 = 8 * v11; // 0x80a20f1
        int32_t v13 = v12 + (int32_t)mem2; // 0x80a20f6
        char * v14 = LYstrsep(&v2, "&"); // 0x80a2107
        int32_t v15 = v13 + 4; // 0x80a210c
        str = (int32_t *)v15;
        *str = (int32_t)v14;
        char * v16 = LYstrsep((char **)v15, "="); // 0x80a2131
        int32_t * v17 = (int32_t *)v13; // 0x80a2136
        *v17 = (int32_t)v16;
        HTUnEscape(v16);
        len = strlen((char *)*str);
        int32_t v18 = *str;
        v6 = v18;
        v7 = 0;
        v9 = NULL;
        v4 = v18;
        if (len != 0) {
            while (true) {
              lab_0x80a216e:
                // 0x80a216e
                v10 = v9;
                int32_t v19 = v7;
                int32_t v20 = v19 + v6;
                char * v21 = (char *)v20;
                v8 = v10;
                if (*v21 != 43) {
                    goto lab_0x80a220c;
                } else {
                    // 0x80a2188
                    v5 = v21;
                    if (v10 == NULL) {
                        goto lab_0x80a21fa;
                    } else {
                        // 0x80a218e
                        v5 = v21;
                        if (*(char *)(v20 + 1) != 43) {
                            goto lab_0x80a21fa;
                        } else {
                            int16_t * v22 = *__ctype_b_loc(); // 0x80a21af
                            int32_t v23 = *str; // 0x80a21ba
                            int32_t v24 = v19 + 2; // 0x80a21c0
                            unsigned char v25 = *(char *)(v23 + v24); // 0x80a21c6
                            char * v26 = (char *)(v23 + v19);
                            v5 = v26;
                            if ((*(int16_t *)(2 * (int32_t)v25 + (int32_t)v22) & 8) == 0) {
                                goto lab_0x80a21fa;
                            } else {
                                // 0x80a21de
                                *v26 = 32;
                                v8 = (int32_t *)v24;
                                goto lab_0x80a220c;
                            }
                        }
                    }
                }
            }
        }
      lab_0x80a221c:
        // 0x80a221c
        HTUnEscape((char *)v4);
        if (WWW_TraceFlag != 0) {
            int32_t v27 = *str; // 0x80a2244
            int32_t v28 = *v17; // 0x80a2250
            fprintf(TraceFP(), "...item[%d] tag=%s, value=%s\n", v11, (char *)v28, (char *)v27);
        }
        // 0x80a227a
        mem2 = realloc(mem2, v12 + 16);
        if (mem2 == NULL) {
            // break -> 0x80a229f
            break;
        }
        int32_t v29 = v11 + 1; // 0x80a227a
        *(int32_t *)(8 * v29 + (int32_t)mem2) = 0;
        int32_t * result = mem2; // 0x80a22c7
        if (v2 == NULL) {
            // 0x80a22dd
            return result;
        }
        // 0x80a22c9
        v3 = (char *)v29;
        result = mem2;
        if (*v2 == 0) {
            // 0x80a22dd
            return result;
        }
    }
    // 0x80a229f
    outofmem("./LYOptions.c", "break_data(realloc)");
    // UNREACHABLE
  lab_0x80a220c:;
    int32_t v30 = (int32_t)v8 + 1; // 0x80a220c
    int32_t v31 = *str;
    v6 = v31;
    v7 = v30;
    v9 = (int32_t *)v30;
    v4 = v31;
    if (len <= v30) {
        // break -> 0x80a221c
        goto lab_0x80a221c;
    }
    goto lab_0x80a216e;
  lab_0x80a21fa:
    // 0x80a21fa
    *v5 = 32;
    v8 = v10;
    goto lab_0x80a220c;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a22e7 - 0x80a2367
// Line range:    2555 - 2568
char isLynxOptionsPage(char * address, char * portion) {
    // 0x80a22e7
    if (strncasecomp(address, "LYNXOPTIONS:", 12) != 0) {
        // 0x80a2361
        return 0;
    }
    int32_t len = strlen(portion); // 0x80a2316
    int32_t v1 = (int32_t)address + 12; // 0x80a231e
    if (strncasecomp((char *)v1, portion, len) != 0) {
        // 0x80a2361
        return 0;
    }
    char v2 = *(char *)(len + v1); // 0x80a2347
    return v2 == 47 | v2 == 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a2367 - 0x80a3af0
// Line range:    2605 - 3276
int32_t postoptions(int32_t * newdoc2) {
    int32_t v1 = (int32_t)newdoc2;
    int32_t * data = NULL; // bp-28, 0x80a2375
    int32_t v2 = current_char_set; // 0x80a2380
    char v3 = LYRawMode; // 0x80a2390
    int32_t v4 = v1 + 4; // 0x80a23b1
    int32_t * str8 = (int32_t *)v4; // 0x80a23b1
    int32_t result; // 0x80a2367
    if (isLynxOptionsPage((char *)*str8, "//MBM_MENU") != 0) {
        int32_t * v5 = (int32_t *)(v1 + 8); // 0x80a23cb
        int32_t v6 = *v5; // 0x80a23cb
        if (v6 != 0) {
            // 0x80a23d2
            free((int32_t *)v6);
            *v5 = 0;
        }
        // 0x80a23ea
        if (no_bookmark != 0) {
            // 0x80a23f5
            HTAlert(gettext("You are not allowed to change the bookmark file!"));
            // 0x80a3ae7
            return 3;
        }
        // 0x80a2415
        result = 0;
        if (dump_output_immediately == 0) {
            // 0x80a242c
            edit_bookmarks();
            result = 3;
        }
        // 0x80a3ae7
        return result;
    }
    // 0x80a243d
    if (isLynxOptionsPage((char *)*str8, "/") == 0) {
        // 0x80a2457
        HTAlert(gettext("Random URL is disallowed!  Use a shortcut."));
        // 0x80a3ae7
        return 3;
    }
    int32_t v7 = v1 + 8; // 0x80a247a
    int32_t * v8 = (int32_t *)v7; // 0x80a247a
    uint32_t v9 = (int32_t)break_data((int32_t *)*v8); // 0x80a2480
    int32_t v10; // bp-88, 0x80a2367
    if (v9 % 256 == 0) {
        int32_t v11 = gen_options((char **)v4); // 0x80a249b
        int32_t v12 = *str8;
        if (v11 == 1) {
            // 0x80a24ec
            v10 = v12;
            char v13 = HTLoadAbsolute(&v10); // 0x80a252a
            result = 0;
            if (v13 != 0) {
                // 0x80a253f
                LYRegisterUIPage((char *)*str8, 7);
                lynx_edit_mode = 0;
                result = 1;
            }
        } else {
            // 0x80a24a9
            HTAlwaysAlert("Unexpected way of accessing", (char *)v12);
            int32_t v14 = *str8; // 0x80a24c2
            result = v11;
            if (v14 != 0) {
                // 0x80a24c9
                free((int32_t *)v14);
                *str8 = 0;
                result = v11;
            }
        }
        // 0x80a3ae7
        return result;
    }
    char v15 = v9; // 0x80a2485
    char * v16 = HTLoadedDocumentURL(); // 0x80a2568
    int32_t CurrentShowColor; // bp-48, 0x80a2367
    if (LYIsUIPage3(v16, 7, 0) == 0) {
        char * v17 = HTLoadedDocumentURL(); // 0x80a258d
        if (LYIsUIPage3(v17, 5, 0) == 0) {
            // 0x80a25b2
            CurrentShowColor = 0;
            key_for_func_ext(49, 0);
            char * v18 = gettext("Use %s to invoke the Options menu!"); // 0x80a25d6
            HTSprintf0((char **)&CurrentShowColor, v18);
            HTAlert((char *)CurrentShowColor);
            if (CurrentShowColor != 0) {
                // 0x80a2600
                free((int32_t *)CurrentShowColor);
                CurrentShowColor = 0;
            }
            // 0x80a2612
            if (v15 != 0) {
                // 0x80a2618
                free((int32_t *)(0x1000000 * v9 / 0x1000000));
            }
            // 0x80a3ae7
            return 0;
        }
    }
    int32_t v19 = 0x1000000 * v9 / 0x1000000; // 0x80a363a
    int32_t * v20 = (int32_t *)v19;
    int32_t v21 = *v20; // 0x80a363d
    char v22 = 0; // 0x80a3641
    char v23 = 0; // 0x80a3641
    char v24 = 0; // 0x80a3641
    char v25 = 0; // 0x80a3641
    int32_t str; // 0x80a2367
    int32_t * str2; // 0x80a2367
    int32_t v26; // 0x80a2367
    int32_t v27; // 0x80a2367
    int32_t v28; // 0x80a2367
    int32_t v29; // 0x80a2367
    int32_t v30; // 0x80a2367
    char v31; // 0x80a2367
    char v32; // 0x80a2367
    char v33; // 0x80a2367
    char v34; // 0x80a2367
    char v35; // 0x80a2367
    char v36; // 0x80a2367
    char v37; // 0x80a2367
    char v38; // 0x80a2367
    char v39; // 0x80a2367
    int32_t * str4; // 0x80a2e36
    if (v21 != 0) {
        // 0x80a2642
        str = v21;
        str2 = v20;
        v26 = v19;
        v27 = 0;
        v30 = LYShowColor;
        v31 = 0;
        v37 = 0;
        v33 = 0;
        v39 = 0;
        while (true) {
          lab_0x80a2642:;
            char v40 = v39;
            v34 = v33;
            char v41 = v37;
            v32 = v31;
            int32_t v42 = v30;
            v28 = v26;
            if (strcmp((char *)str, secure_string) == 0) {
                // 0x80a2667
                if (secure_value == 0) {
                    // break -> 0x80a2692
                    break;
                }
                // 0x80a2670
                if (strcmp((char *)*(int32_t *)(v28 + 4), (char *)secure_value) != 0) {
                    // break -> 0x80a2692
                    break;
                }
                // 0x80a26fd
                if (secure_value != 0) {
                    // 0x80a2706
                    free((int32_t *)secure_value);
                    secure_value = 0;
                }
            }
            // 0x80a271d
            v38 = v40;
            if (strcmp((char *)*str2, save_options_string) == 0) {
                // 0x80a273e
                v38 = no_option_save != 0 ? v40 : 1;
            }
            // 0x80a274d
            if (strcmp((char *)*str2, cookies_string) == 0) {
                int32_t * str3 = (int32_t *)(v28 + 4); // 0x80a2781
                if (strcmp((char *)*str3, cookies_ignore_all_string) != 0) {
                    // 0x80a279d
                    if (strcmp((char *)*str3, cookies_up_to_user_string) != 0) {
                        // 0x80a27cf
                        if (strcmp((char *)*str3, cookies_accept_all_string) == 0) {
                            // 0x80a27f1
                            LYSetCookies = 1;
                            LYAcceptAllCookies = 1;
                        }
                    } else {
                        // 0x80a27bf
                        LYSetCookies = 1;
                        LYAcceptAllCookies = 0;
                    }
                } else {
                    // 0x80a2794
                    LYSetCookies = 0;
                }
            }
            // 0x80a27ff
            if (strcmp((char *)*str2, x_display_string) == 0) {
                int32_t * v43 = (int32_t *)(v28 + 4); // 0x80a2829
                LYsetXDisplay((char *)*v43);
                validate_x_display();
                summarize_x_display((char *)*v43);
            }
            // 0x80a284d
            if (strcmp((char *)*str2, editor_string) == 0) {
                // 0x80a286e
                if (editor != 0) {
                    // 0x80a2877
                    free((int32_t *)editor);
                    editor = 0;
                }
                // 0x80a288e
                HTSACopy((char **)&editor, (char *)*(int32_t *)(v28 + 4));
            }
            // 0x80a28aa
            if (strcmp((char *)*str2, emacs_keys_string) == 0) {
                int32_t v44 = *(int32_t *)(v28 + 4); // 0x80a28d4
                if (GetOptValues(&bool_values, (char *)v44, (int32_t *)&data) != 0) {
                    char v45 = (int32_t)data; // 0x80a28f5
                    emacs_keys = v45;
                    if (v45 == 0) {
                        // 0x80a290c
                        reset_emacs_keys();
                    } else {
                        // 0x80a2905
                        set_emacs_keys();
                    }
                }
            }
            char v46 = v41; // 0x80a2930
            if (strcmp((char *)*str2, keypad_mode_string) == 0) {
                // 0x80a2932
                CurrentShowColor = 0;
                int32_t v47 = *(int32_t *)(v28 + 4); // 0x80a2942
                char v48 = GetOptValues(&keypad_mode_values, (char *)v47, &CurrentShowColor); // 0x80a2957
                v46 = v41;
                if (v48 != 0) {
                    int32_t v49 = CurrentShowColor; // 0x80a2966
                    v46 = v41;
                    if (keypad_mode != v49) {
                        // 0x80a296d
                        keypad_mode = v49;
                        if (v49 != 0) {
                            // 0x80a2989
                            reset_numbers_as_arrows();
                            v46 = 1;
                        } else {
                            // 0x80a2982
                            set_numbers_as_arrows();
                            v46 = 1;
                        }
                    }
                }
            }
            char v50 = v46;
            if (strcmp((char *)*str2, lineedit_mode_string) == 0) {
                int32_t str_as_i = atoi((char *)*(int32_t *)(v28 + 4)); // 0x80a29be
                int32_t v51 = 0; // 0x80a29ef
                if (*(int32_t *)&LYLineeditNames != 0) {
                    if (v51 == str_as_i) {
                        // 0x80a29d7
                        current_lineedit = str_as_i;
                    }
                    int32_t v52 = v51 + 1; // 0x80a29df
                    v51 = v52;
                    while (*(int32_t *)(4 * v52 + (int32_t)&LYLineeditNames) != 0) {
                        // 0x80a29cf
                        if (v51 == str_as_i) {
                            // 0x80a29d7
                            current_lineedit = str_as_i;
                        }
                        // 0x80a29df
                        v52 = v51 + 1;
                        v51 = v52;
                    }
                }
            }
            // 0x80a29f1
            if (strcmp((char *)*str2, mail_address_string) == 0) {
                // 0x80a2a12
                if (personal_mail_address != 0) {
                    // 0x80a2a1b
                    free((int32_t *)personal_mail_address);
                    personal_mail_address = 0;
                }
                // 0x80a2a32
                HTSACopy((char **)&personal_mail_address, (char *)*(int32_t *)(v28 + 4));
            }
            // 0x80a2a4e
            if (strcmp((char *)*str2, anonftp_password_string) == 0) {
                // 0x80a2a6f
                if (anonftp_password != 0) {
                    // 0x80a2a78
                    free((int32_t *)anonftp_password);
                    anonftp_password = 0;
                }
                // 0x80a2a8f
                HTSACopy((char **)&anonftp_password, (char *)*(int32_t *)(v28 + 4));
            }
            // 0x80a2aab
            if (strcmp((char *)*str2, search_type_string) == 0) {
                int32_t v53 = *(int32_t *)(v28 + 4); // 0x80a2ad5
                if (GetOptValues(&search_type_values, (char *)v53, (int32_t *)&data) != 0) {
                    // 0x80a2af3
                    case_sensitive = (int32_t)data;
                }
            }
            char v54 = v50; // 0x80a2b1a
            if (strcmp((char *)*str2, DTD_recovery_string) == 0) {
                int32_t v55 = *(int32_t *)(v28 + 4); // 0x80a2b25
                char v56 = GetOptValues(&DTD_type_values, (char *)v55, (int32_t *)&data); // 0x80a2b3a
                v54 = v50;
                if (v56 != 0) {
                    int32_t v57 = (int32_t)data; // 0x80a2b49
                    v54 = v50;
                    if (Old_DTD != v57) {
                        // 0x80a2b50
                        Old_DTD = v57;
                        HTSwitchDTD((int32_t)(data == NULL));
                        v54 = 1;
                    }
                }
            }
            char v58 = v54;
            if (strcmp((char *)*str2, select_popups_string) == 0) {
                int32_t v59 = *(int32_t *)(v28 + 4); // 0x80a2b9b
                if (GetOptValues(&bool_values, (char *)v59, (int32_t *)&data) != 0) {
                    // 0x80a2bb9
                    LYSelectPopups = (int32_t)data;
                }
            }
            // 0x80a2bc1
            v29 = v42;
            if (strcmp((char *)*str2, show_color_string) == 0) {
                int32_t v60 = *(int32_t *)(v28 + 4); // 0x80a2beb
                char v61 = GetOptValues(&show_color_values, (char *)v60, &LYChosenShowColor); // 0x80a2c01
                v29 = v42;
                if (v61 != 0) {
                    // 0x80a2c0a
                    int32_t v62; // 0x80a2367
                    if (can_do_colors == 0) {
                        // 0x80a2c0a
                        v62 = LYShowColor;
                    } else {
                        // 0x80a2c15
                        LYShowColor = LYChosenShowColor;
                        v62 = LYChosenShowColor;
                    }
                    // 0x80a2c1f
                    v29 = v42;
                    if (v42 != v62) {
                        // 0x80a2c29
                        lynx_force_repaint();
                        v29 = LYShowColor;
                    }
                }
            }
            // 0x80a2c36
            if (strcmp((char *)*str2, show_cursor_string) == 0) {
                int32_t v63 = *(int32_t *)(v28 + 4); // 0x80a2c60
                if (GetOptValues(&bool_values, (char *)v63, (int32_t *)&data) != 0) {
                    // 0x80a2c7e
                    LYShowCursor = (int32_t)data;
                }
            }
            // 0x80a2c86
            if (strcmp((char *)*str2, underline_links_string) == 0) {
                int32_t v64 = *(int32_t *)(v28 + 4); // 0x80a2cb0
                if (GetOptValues(&bool_values, (char *)v64, (int32_t *)&data) != 0) {
                    // 0x80a2cce
                    LYUnderlineLinks = (int32_t)data;
                }
            }
            char v65 = v58; // 0x80a2cf5
            if (strcmp((char *)*str2, show_scrollbar_string) == 0) {
                int32_t v66 = *(int32_t *)(v28 + 4); // 0x80a2d00
                char v67 = GetOptValues(&bool_values, (char *)v66, (int32_t *)&data); // 0x80a2d15
                v65 = v58;
                if (v67 != 0) {
                    // 0x80a2d1e
                    LYShowScrollbar = (int32_t)data;
                    v65 = 1;
                }
            }
            // 0x80a2d2a
            v35 = v65;
            if (strcmp((char *)*str2, cookie_prompt_string) == 0) {
                // 0x80a2d4b
                GetOptValues(&prompt_values, (char *)*(int32_t *)(v28 + 4), &cookie_noprompt);
            }
            // 0x80a2d6f
            if (strcmp((char *)*str2, user_mode_string) == 0) {
                int32_t v68 = *(int32_t *)(v28 + 4); // 0x80a2d99
                if (GetOptValues(&user_mode_values, (char *)v68, &user_mode) != 0) {
                    // 0x80a2db8
                    LYSetDisplayLines();
                }
            }
            // 0x80a2dbd
            if (strcmp((char *)*str2, visited_links_string) == 0) {
                int32_t v69 = *(int32_t *)(v28 + 4); // 0x80a2de7
                GetOptValues(&visited_links_values, (char *)v69, &Visited_Links_As);
            }
            // 0x80a2e02
            v36 = v35;
            if (strcmp((char *)*str2, images_string) != 0) {
                goto lab_0x80a2efa;
            } else {
                // 0x80a2e27
                str4 = (int32_t *)(v28 + 4);
                if (strcmp((char *)*str4, images_ignore_all_string) != 0) {
                    goto lab_0x80a2e76;
                } else {
                    // 0x80a2e49
                    if ((clickable_images || pseudo_inline_alts) == 0) {
                        goto lab_0x80a2e76;
                    } else {
                        // 0x80a2e5f
                        pseudo_inline_alts = 0;
                        clickable_images = 0;
                        v36 = 1;
                        goto lab_0x80a2efa;
                    }
                }
            }
        }
        // 0x80a2692
        CurrentShowColor = 0;
        key_for_func_ext(49, 0);
        char * v70 = gettext("Use %s to invoke the Options menu!"); // 0x80a26b6
        HTSprintf0((char **)&CurrentShowColor, v70);
        HTAlert((char *)CurrentShowColor);
        if (v15 != 0) {
            // 0x80a26df
            free(v20);
        }
        // 0x80a3ae7
        return 3;
    }
  lab_0x80a3647:;
    char v71 = v25;
    char v72 = v23;
    char v73 = v22;
    LYFindLocaleCharset();
    // 0x80a365b
    char v74; // 0x80a2367
    if (v2 != current_char_set) {
        // 0x80a3685
        LYUseDefaultRawMode = 1;
        HTMLUseCharacterSet(current_char_set);
        goto lab_0x80a3699;
    } else {
        // 0x80a3665
        v74 = v24;
        if (v72 == 0 == v3 == LYRawMode) {
            goto lab_0x80a36fd;
        } else {
            goto lab_0x80a3699;
        }
    }
  lab_0x80a2efa:;
    char v75 = v36;
    char v76 = v75; // 0x80a2f19
    if (strcmp((char *)*str2, verbose_images_string) == 0) {
        int32_t v77 = *(int32_t *)(v28 + 4); // 0x80a2f24
        char v78 = GetOptValues(&verbose_images_type_values, (char *)v77, (int32_t *)&data); // 0x80a2f39
        v76 = v75;
        if (v78 != 0) {
            int32_t v79 = (int32_t)data; // 0x80a2f4c
            v76 = v75;
            if ((int32_t)verbose_img != v79) {
                // 0x80a2f53
                verbose_img = v79;
                v76 = 1;
            }
        }
    }
    // 0x80a2f5f
    if (strcmp((char *)*str2, vi_keys_string) == 0) {
        int32_t v80 = *(int32_t *)(v28 + 4); // 0x80a2f89
        if (GetOptValues(&bool_values, (char *)v80, (int32_t *)&data) != 0) {
            char v81 = (int32_t)data; // 0x80a2faa
            vi_keys = v81;
            if (v81 == 0) {
                // 0x80a2fc1
                reset_vi_keys();
            } else {
                // 0x80a2fba
                set_vi_keys();
            }
        }
    }
    // 0x80a2fc6
    if (strcmp((char *)*str2, mbm_string) == 0) {
        // 0x80a2fe7
        if (LYMBMBlocked == 0) {
            // 0x80a2ff2
            GetOptValues(&mbm_values, (char *)*(int32_t *)(v28 + 4), &LYMultiBookmarks);
        }
    }
    // 0x80a3016
    if (strcmp((char *)*str2, single_bookmark_string) == 0) {
        // 0x80a3037
        if (no_bookmark == 0) {
            int32_t * v82 = (int32_t *)(v28 + 4); // 0x80a304b
            char * v83 = (char *)*v82;
            if (*v83 != 0) {
                char * v84 = v83; // 0x80a305c
                if (bookmark_page != 0) {
                    // 0x80a305e
                    free((int32_t *)bookmark_page);
                    bookmark_page = 0;
                    v84 = (char *)*v82;
                }
                // 0x80a3075
                HTSACopy((char **)&bookmark_page, v84);
            }
        }
    }
    char v85 = v34; // 0x80a30b0
    int32_t * v86; // 0x80a30bb
    int32_t v87; // 0x80a30c1
    if (strcmp((char *)*str2, assume_char_set_string) != 0) {
        goto lab_0x80a311f;
    } else {
        // 0x80a30b2
        v86 = (int32_t *)(v28 + 4);
        v87 = UCGetLYhndl_byMIME((char *)*v86);
        v85 = v34;
        if (v87 < 0) {
            goto lab_0x80a311f;
        } else {
            if (v3 == 0) {
                // 0x80a30e7
                v85 = v34;
                if (v87 == UCLYhndl_for_unspec) {
                    goto lab_0x80a311f;
                } else {
                    goto lab_0x80a30f7;
                }
            } else {
                // 0x80a30d5
                v85 = v34;
                if (safeUCGetLYhndl_byMIME((char *)UCAssume_MIMEcharset) != v87) {
                    goto lab_0x80a30f7;
                } else {
                    goto lab_0x80a311f;
                }
            }
        }
    }
  lab_0x80a311f:
    // 0x80a311f
    if (strcmp((char *)*str2, locale_charset_string) == 0) {
        int32_t v88 = *(int32_t *)(v28 + 4); // 0x80a3149
        if (GetOptValues(&bool_values, (char *)v88, (int32_t *)&data) != 0) {
            // 0x80a3167
            LYLocaleCharset = (int32_t)data;
        }
    }
    // 0x80a316f
    if (strcmp((char *)*str2, display_char_set_string) == 0) {
        int32_t str_as_i2 = atoi((char *)*(int32_t *)(v28 + 4)); // 0x80a319f
        int32_t v89 = 0; // 0x80a31d0
        if (*(int32_t *)&LYchar_set_names != 0) {
            if (v89 == str_as_i2) {
                // 0x80a31b8
                current_char_set = str_as_i2;
            }
            int32_t v90 = v89 + 1; // 0x80a31c0
            v89 = v90;
            while (*(int32_t *)(4 * v90 + (int32_t)&LYchar_set_names) != 0) {
                // 0x80a31b0
                if (v89 == str_as_i2) {
                    // 0x80a31b8
                    current_char_set = str_as_i2;
                }
                // 0x80a31c0
                v90 = v89 + 1;
                v89 = v90;
            }
        }
    }
    // 0x80a31d2
    if (strcmp((char *)*str2, raw_mode_string) == 0) {
        int32_t v91 = *(int32_t *)(v28 + 4); // 0x80a31fc
        if (GetOptValues(&bool_values, (char *)v91, (int32_t *)&data) != 0) {
            // 0x80a321a
            LYRawMode = (int32_t)data;
        }
    }
    // 0x80a3222
    if (strcmp((char *)*str2, passive_ftp_string) == 0) {
        // 0x80a3243
        ftp_passive = (int32_t)data;
    }
    // 0x80a324b
    if (strcmp((char *)*str2, ftp_sort_string) == 0) {
        // 0x80a326c
        GetOptValues(&ftp_sort_values, (char *)*(int32_t *)(v28 + 4), &HTfileSortMethod);
    }
    // 0x80a3290
    if (strcmp((char *)*str2, dired_list_string) == 0) {
        // 0x80a32b1
        GetOptValues(&dired_list_values, (char *)*(int32_t *)(v28 + 4), &dir_list_style);
    }
    // 0x80a32d5
    if (strcmp((char *)*str2, dired_sort_string) == 0) {
        // 0x80a32f6
        GetOptValues(&dired_sort_values, (char *)*(int32_t *)(v28 + 4), &dir_list_order);
    }
    // 0x80a331a
    if (strcmp((char *)*str2, show_dotfiles_string) == 0) {
        // 0x80a333b
        if (no_dotfiles == 0) {
            int32_t v92 = *(int32_t *)(v28 + 4); // 0x80a334f
            if (GetOptValues(&bool_values, (char *)v92, (int32_t *)&data) != 0) {
                // 0x80a336d
                show_dotfiles = (int32_t)data;
            }
        }
    }
    // 0x80a3375
    if (strcmp((char *)*str2, show_rate_string) == 0) {
        int32_t v93 = *(int32_t *)(v28 + 4); // 0x80a339f
        if (GetOptValues(&rate_values, (char *)v93, (int32_t *)&data) != 0) {
            // 0x80a33bd
            LYTransferRate = (int32_t)data;
        }
    }
    // 0x80a33c5
    if (strcmp((char *)*str2, preferred_media_string) == 0) {
        // 0x80a33e6
        GetOptValues(&media_values, (char *)*(int32_t *)(v28 + 4), &LYAcceptMedia);
    }
    // 0x80a340a
    if (strcmp((char *)*str2, preferred_encoding_string) == 0) {
        // 0x80a342b
        GetOptValues(&encoding_values, (char *)*(int32_t *)(v28 + 4), &LYAcceptEncoding);
    }
    char v94 = v32; // 0x80a346e
    if (strcmp((char *)*str2, preferred_doc_char_string) == 0) {
        int32_t * str5 = (int32_t *)(v28 + 4); // 0x80a3479
        v94 = v32;
        if (strcmp((char *)pref_charset, (char *)*str5) != 0) {
            // 0x80a3492
            if (pref_charset != 0) {
                // 0x80a349b
                free((int32_t *)pref_charset);
                pref_charset = 0;
            }
            // 0x80a34b2
            HTSACopy((char **)&pref_charset, (char *)*str5);
            v94 = 1;
        }
    }
    char v95 = v94;
    char v96 = v95; // 0x80a34f1
    if (strcmp((char *)*str2, preferred_doc_lang_string) == 0) {
        int32_t * str6 = (int32_t *)(v28 + 4); // 0x80a34fc
        v96 = v95;
        if (strcmp((char *)language, (char *)*str6) != 0) {
            // 0x80a3515
            if (language != 0) {
                // 0x80a351e
                free((int32_t *)language);
                language = 0;
            }
            // 0x80a3535
            HTSACopy((char **)&language, (char *)*str6);
            v96 = 1;
        }
    }
    char v97 = v96;
    char v98 = v97; // 0x80a3574
    if (strcmp((char *)*str2, user_agent_string) == 0) {
        // 0x80a357a
        v98 = v97;
        if (no_useragent == 0) {
            int32_t * str7 = (int32_t *)(v28 + 4); // 0x80a3592
            v98 = v97;
            if (strcmp((char *)LYUserAgent, (char *)*str7) != 0) {
                // 0x80a35af
                if (LYUserAgent != 0) {
                    // 0x80a35bc
                    free((int32_t *)LYUserAgent);
                    LYUserAgent = 0;
                }
                int32_t v99 = *str7;
                char v100 = *(char *)v99; // 0x80a35df
                HTSACopy((char **)&LYUserAgent, (char *)(v100 == 0 ? LYUserAgentDefault : v99));
                v98 = 1;
                if (LYCheckUserAgent() == 0) {
                    // 0x80a361c
                    HTAlert(gettext("Use \"L_y_n_x\" or \"Lynx\" in User-Agent, or it looks like intentional deception!"));
                    v98 = 1;
                }
            }
        }
    }
    int32_t v101 = v27 + 1; // 0x80a3630
    int32_t v102 = 8 * v101 + v19; // 0x80a363a
    int32_t * v103 = (int32_t *)v102; // 0x80a363d
    int32_t v104 = *v103; // 0x80a363d
    str = v104;
    str2 = v103;
    v26 = v102;
    v27 = v101;
    v30 = v29;
    v31 = v98;
    v37 = v76;
    v33 = v85;
    v39 = v38;
    v22 = v38;
    v23 = v85;
    v24 = v76;
    v25 = v98;
    if (v104 == 0) {
        goto lab_0x80a3647;
    }
    goto lab_0x80a2642;
  lab_0x80a2e76:
    // 0x80a2e76
    if (strcmp((char *)*str4, images_use_label_string) != 0) {
        goto lab_0x80a2ec2;
    } else {
        // 0x80a2e98
        if (pseudo_inline_alts == 1 == clickable_images == 0) {
            goto lab_0x80a2ec2;
        } else {
            // 0x80a2eae
            pseudo_inline_alts = 1;
            clickable_images = 0;
            v36 = 1;
            goto lab_0x80a2efa;
        }
    }
  lab_0x80a2ec2:
    // 0x80a2ec2
    v36 = v35;
    if (strcmp((char *)*str4, images_use_links_string) == 0 && clickable_images != 1) {
        // 0x80a2eef
        clickable_images = 1;
        v36 = 1;
    }
    goto lab_0x80a2efa;
  lab_0x80a30f7:
    // 0x80a30f7
    UCLYhndl_for_unspec = v87;
    HTSACopy((char **)&UCAssume_MIMEcharset, (char *)*v86);
    v85 = 1;
    goto lab_0x80a311f;
  lab_0x80a3699:;
    // 0x80a3699
    char v105; // 0x80a2367
    if (v72 == 0 || HTCJK == 1) {
        // 0x80a3699
        v105 = LYRawMode;
    } else {
        char v106 = UCLYhndl_for_unspec == current_char_set; // 0x80a36b6
        LYRawMode = v106;
        v105 = v106;
    }
    // 0x80a36be
    v74 = 1;
    if (v72 == 0 != (v3 == v105)) {
        // 0x80a36d0
        HTMLSetUseDefaultRawMode(current_char_set, v105);
        HTMLSetCharacterHandling(current_char_set);
        v74 = 1;
    }
    goto lab_0x80a36fd;
  lab_0x80a36fd:
    // 0x80a36fd
    HTSABFree((int32_t **)v7);
    if (v15 != 0) {
        // 0x80a3711
        free(v20);
    }
    if (v73 != 0) {
        // 0x80a3729
        HTInfoMsg(gettext("Saving Options..."));
        LYrcShowColor = LYChosenShowColor;
        if (save_rc(NULL) == 0) {
            // 0x80a376d
            HTAlert(gettext("Unable to save Options!"));
        } else {
            // 0x80a3757
            HTInfoMsg(gettext("Options saved!"));
        }
    }
    // 0x80a3781
    if (WWW_TraceFlag != 0) {
        // 0x80a37a3
        fprintf(TraceFP(), "\nLYOptions.c/postoptions(): exiting...\n");
        if (WWW_TraceFlag != 0) {
            struct _IO_FILE * stream = TraceFP(); // 0x80a37c4
            char * v107 = v74 == 0 ? "FALSE" : (char *)&g31; // 0x80a37db
            fprintf(stream, "                            need_reload = %s\n", v107);
            if (WWW_TraceFlag != 0) {
                struct _IO_FILE * stream2 = TraceFP(); // 0x80a3803
                char * v108 = v71 == 0 ? "FALSE" : (char *)&g31; // 0x80a381a
                fprintf(stream2, "                            need_end_reload = %s\n", v108);
            }
        }
    }
    // 0x80a3821
    LYpop(newdoc2);
    v10 = *str8;
    LYforce_no_cache = 0;
    LYoverride_no_cache = 1;
    if (HTLoadAbsolute(&v10) == 0) {
        // 0x80a3ae7
        return 0;
    }
    // 0x80a388d
    HTuncache_current_document();
    LYpop(newdoc2);
    v10 = *str8;
    LYforce_no_cache = 0;
    LYoverride_no_cache = 1;
    if (HTLoadAbsolute(&v10) == 0) {
        // 0x80a3ae7
        return 0;
    }
    // 0x80a38fe
    reloading = 0;
    if (v71 != 1) {
        goto lab_0x80a398a;
    } else {
        // 0x80a390b
        if (strncmp((char *)*str8, "http", 4) == 0) {
            // 0x80a398a
            reloading = 1;
            goto lab_0x80a39be;
        } else {
            char * v109 = (char *)*str8; // 0x80a3933
            char v110 = *v109; // 0x80a3933
            if (v110 != 108 == (v110 != 76)) {
                // 0x80a398a
                reloading = 1;
                goto lab_0x80a39be;
            } else {
                // 0x80a3947
                if (strncasecomp(v109, "lynxcgi:", 8) != 0) {
                    // 0x80a398a
                    reloading = 1;
                    goto lab_0x80a39be;
                } else {
                    goto lab_0x80a398a;
                }
            }
        }
    }
  lab_0x80a398a:
    if (v74 == 0) {
        // 0x80a3990
        if (WWW_TraceFlag != 0) {
            // 0x80a399b
            fprintf(TraceFP(), "LYOptions.c/postoptions(): now really exit.\n\n");
        }
        // 0x80a3ae7
        return 1;
    }
    goto lab_0x80a39be;
  lab_0x80a39be:
    // 0x80a39be
    if (HTisDocumentSource() != 0) {
        // 0x80a39c7
        srcmode_for_next_retrieval(1);
    }
    // 0x80a39d3
    if (reloading == 0) {
        // 0x80a39de
        if (HTcan_reparse_document() != 0) {
            // 0x80a39e7
            if (HTreparse_document() == 0) {
                // 0x80a39f0
                srcmode_for_next_retrieval(0);
            }
            // 0x80a39fc
            if (WWW_TraceFlag != 0) {
                // 0x80a3a07
                fprintf(TraceFP(), "LYOptions.c/postoptions(): now really exit.\n\n");
            }
            // 0x80a3ae7
            return 1;
        }
    }
    // 0x80a3a2a
    if (*v8 != 0) {
        // 0x80a3a34
        if (*(char *)(v1 + 21) == 0) {
            // 0x80a3a3f
            if (confirm_post_resub((char *)*str8, (char *)*newdoc2, 2, 1) == 0) {
                // 0x80a3a6a
                HTInfoMsg(gettext("Document will not be reloaded!"));
                result = 1;
                if (HTisDocumentSource() != 0) {
                    // 0x80a3a87
                    srcmode_for_next_retrieval(0);
                    result = 1;
                }
                // 0x80a3ae7
                return result;
            }
        }
    }
    // 0x80a3a9c
    HEAD_request = HTLoadedDocumentIsHEAD();
    HTuncache_current_document();
    LYpush(newdoc2, 0);
    if (WWW_TraceFlag != 0) {
        // 0x80a3ac9
        fprintf(TraceFP(), "LYOptions.c/postoptions(): now really exit.\n\n");
    }
    // 0x80a3ae7
    return 3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a3af0 - 0x80a3b6b
// Line range:    3279 - 3294
char * NewSecureValue(void) {
    int32_t v1 = secure_value; // 0x80a3af6
    if (v1 != 0) {
        // 0x80a3aff
        free((int32_t *)v1);
        secure_value = 0;
    }
    int32_t * mem = malloc(80); // 0x80a3b1d
    secure_value = (int32_t)mem;
    int32_t v2 = &g123; // 0x80a3b2e
    if (mem != NULL) {
        // 0x80a3b30
        sprintf((char *)secure_value, "%ld", random());
        v2 = secure_value;
    }
    // 0x80a3b66
    return (char *)v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a3b6b - 0x80a3ce4
// Line range:    3304 - 3326
void PutLabel(struct _IO_FILE * fp, char * name, char * value) {
    int32_t v1 = LYstrExtent(name, strlen(name), 33); // 0x80a3b9a
    fprintf(fp, "%s%s", no_margins == 0 ? "&nbsp;&nbsp;" : (char *)&g30, name);
    if (will_save_rc(value) != 0) {
        // 0x80a3bed
        if (no_option_save == 0) {
            // 0x80a3c1d
            if (v1 < 33 == (32 - v1 & v1) < 0) {
                // 0x80a3cbf
                fwrite((int32_t *)": ", 1, 2, fp);
                return;
            }
            int32_t v2 = v1;
            int32_t v3 = v2 + 1; // 0x80a3c26
            fwrite((int32_t *)"&nbsp;", 1, 6, fp);
            while (v2 < 32 != (31 - v2 & v3) < 0) {
                // 0x80a3bfa
                v2 = v3;
                v3 = v2 + 1;
                fwrite((int32_t *)"&nbsp;", 1, 6, fp);
            }
            // 0x80a3cbf
            fwrite((int32_t *)": ", 1, 2, fp);
            return;
        }
    }
    int32_t v4 = v1; // 0x80a3c3d
    if (v1 < 30) {
        // 0x80a3c3f
        fwrite((int32_t *)"&nbsp;", 1, 6, fp);
        v4 = v1 + 1;
    }
    int32_t v5 = v4;
    fwrite((int32_t *)"(!)", 1, 3, fp);
    if (v5 < 30 == (29 - v5 & v5) < 0) {
        // 0x80a3cbf
        fwrite((int32_t *)": ", 1, 2, fp);
        return;
    }
    int32_t v6 = v5;
    int32_t v7 = v6 + 1; // 0x80a3cb7
    fwrite((int32_t *)"&nbsp;", 1, 6, fp);
    while (v6 < 29 != (28 - v6 & v7) < 0) {
        // 0x80a3c8b
        v6 = v7;
        v7 = v6 + 1;
        fwrite((int32_t *)"&nbsp;", 1, 6, fp);
    }
    // 0x80a3cbf
    fwrite((int32_t *)": ", 1, 2, fp);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a3ce4 - 0x80a3d2f
// Line range:    3335 - 3345
char * check_if_write_lynxrc(char ** table) {
    char * v1 = *table;
    if (v1 == NULL) {
        // 0x80a3d2a
        return (char *)0;
    }
    int32_t v2 = 0; // 0x80a3d28
    int32_t v3 = (int32_t)v1;
    while (will_save_rc((char *)v3) != 0) {
        // 0x80a3d1b
        v2++;
        int32_t v4 = *(int32_t *)(4 * v2 + (int32_t)table); // 0x80a3d24
        if (v4 == 0) {
            // break -> 0x80a3d2a
            break;
        }
        v3 = v4;
    }
    // 0x80a3d2a
    return (char *)v3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a3d2f - 0x80a3d43
// Line range:    3353 - 3362
char * will_save_cookies(void) {
    // 0x80a3d2f
    return check_if_write_lynxrc(g124);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a3d43 - 0x80a3d57
// Line range:    3370 - 3379
char * will_save_images(void) {
    // 0x80a3d43
    return check_if_write_lynxrc(g125);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a3d57 - 0x80a3dd7
// Line range:    3386 - 3390
void LYMenuVisitedLinks(struct _IO_FILE * fp0, int32_t disable_all) {
    int32_t v1 = disable_all == 0 ? (int32_t)&g30 : (int32_t)"disabled";
    fprintf(fp0, "<select name=\"%s\" %s>\n", visited_links_string, (char *)v1);
    PutOptValues(fp0, Visited_Links_As, &visited_links_values);
    fwrite((int32_t *)"</select>\n", 1, 10, fp0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYOptions.c
// Address range: 0x80a3dd7 - 0x80a635d
// Line range:    3404 - 3942
int32_t gen_options(char ** newfile) {
    int32_t v1 = __readgsdword(20); // 0x80a3de7
    uint32_t v2 = LYcols - (int32_t)(LYShowScrollbar != 0); // 0x80a3e14
    int32_t v3 = 7; // 0x80a3e1b
    if (v2 >= 46) {
        // 0x80a3e1d
        v3 = v2 - (no_margins == 0 ? 37 : 35);
    }
    struct _IO_FILE * stream = InternalPageFP((char *)&g126, 1); // 0x80a3e93
    int32_t v4 = 0; // 0x80a3e9f
    int32_t v5; // 0x80a3dd7
    char * v6; // 0x80a4156
    char * v7; // 0x80a4439
    if (stream != NULL) {
        // 0x80a3eb0
        LYLocalFileToURL(newfile, (char *)&g126);
        LYforce_no_cache = 1;
        BeginInternalPage(stream, gettext("Options Menu"), NULL);
        fprintf(stream, "<form action=\"%s\" method=\"post\">\n", "LYNXOPTIONS:");
        char * v8 = NewSecureValue(); // 0x80a3f17
        fprintf(stream, "<input name=\"%s\" type=\"hidden\" value=\"%s\">\n", secure_string, v8);
        fwrite((int32_t *)"<p align=center>\n", 1, 17, stream);
        if (LYUseFormsOptions != 0) {
            // 0x80a3f66
            fprintf(stream, "<input type=\"submit\" value=\"%s\"> - \n", gettext("Accept Changes"));
            fprintf(stream, "<input type=\"reset\" value=\"%s\"> - \n", gettext("Reset Changes"));
            fprintf(stream, "%s - \n", gettext("Left Arrow cancels changes"));
        }
        // 0x80a3fcf
        fprintf(stream, "<a href=\"%s%s\">%s</a>\n", (char *)helpfilepath, "keystrokes/option_help.html.gz", gettext("HELP!"));
        if (no_option_save == 0) {
            if (LYUseFormsOptions != 0) {
                // 0x80a4015
                fprintf(stream, "<p align=center>%s: ", gettext("Save options to disk"));
                fprintf(stream, "<input type=\"checkbox\" name=\"%s\">\n", save_options_string);
            }
            // 0x80a4054
            fprintf(stream, "<br>%s\n", gettext("(options marked with (!) will not be saved)"));
        }
        // 0x80a4077
        fwrite((int32_t *)"<pre>\n", 1, 6, stream);
        char * v9 = gettext("General Preferences"); // 0x80a40a1
        char * v10 = no_margins == 0 ? "&nbsp;&nbsp;" : (char *)&g30; // 0x80a40ef
        fprintf(stream, "\n%s<em>%s</em>\n", v10, v9);
        PutLabel(stream, gettext("User mode"), user_mode_string);
        v6 = LYUseFormsOptions != 0 ? (char *)&g30 : "disabled";
        fprintf(stream, "<select name=\"%s\" %s>\n", user_mode_string, v6);
        PutOptValues(stream, user_mode, &user_mode_values);
        fwrite((int32_t *)"</select>\n", 1, 10, stream);
        PutLabel(stream, gettext("Editor"), editor_string);
        int32_t v11 = (int32_t)"disabled"; // 0x80a41c3
        if (LYUseFormsOptions != 0) {
            // 0x80a41c5
            v11 = (system_editor | no_editor) == 0 ? (int32_t)&g30 : (int32_t)"disabled";
        }
        int32_t v12 = editor; // 0x80a4209
        int32_t v13 = v12 == 0 ? (int32_t)&g30 : v12;
        fprintf(stream, "<input size=%d type=\"text\" name=\"%s\" value=\"%s\" %s>\n", v3, editor_string, (char *)v13, (char *)v11);
        PutLabel(stream, gettext("Type of Search"), search_type_string);
        fprintf(stream, "<select name=\"%s\" %s>\n", search_type_string, v6);
        PutOptValues(stream, (int32_t)case_sensitive, &search_type_values);
        fwrite((int32_t *)"</select>\n", 1, 10, stream);
        char * v14 = gettext("Security and Privacy"); // 0x80a4312
        char * v15 = no_margins == 0 ? "&nbsp;&nbsp;" : (char *)&g30; // 0x80a4360
        fprintf(stream, "\n%s<em>%s</em>\n", v15, v14);
        char * v16 = will_save_cookies(); // 0x80a4365
        PutLabel(stream, gettext("Cookies"), v16);
        fprintf(stream, "<select name=\"%s\" %s>\n", cookies_string, v6);
        char * v17 = gettext(cookies_ignore_all_string); // 0x80a43d5
        char * v18 = LYSetCookies != 0 ? (char *)&g30 : "selected"; // 0x80a442c
        fprintf(stream, "<option value=\"%s\" %s>%s\n", cookies_ignore_all_string, v18, v17);
        v7 = gettext(cookies_up_to_user_string);
        if (LYSetCookies == 0) {
            // 0x80a4466
            v5 = &g30;
            goto lab_0x80a4470;
        } else {
            // 0x80a444f
            v5 = (int32_t)"selected";
            if (LYAcceptAllCookies != 0) {
                // 0x80a4466
                v5 = &g30;
                goto lab_0x80a4470;
            } else {
                goto lab_0x80a4470;
            }
        }
    } else {
        goto lab_0x80a633d;
    }
  lab_0x80a633d:;
    int32_t result = v4; // 0x80a634d
    if (v1 != __readgsdword(20)) {
        // 0x80a634f
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80a6354
    return result;
  lab_0x80a4470:
    // 0x80a4470
    fprintf(stream, "<option value=\"%s\" %s>%s\n", cookies_up_to_user_string, (char *)v5, v7);
    char * v19 = gettext(cookies_accept_all_string); // 0x80a44a8
    char * v20 = LYSetCookies == 0 | LYAcceptAllCookies == 0 ? (char *)&g30 : "selected"; // 0x80a450a
    fprintf(stream, "<option value=\"%s\" %s>%s\n", cookies_accept_all_string, v20, v19);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Invalid-Cookie Prompting"), cookie_prompt_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", cookie_prompt_string, v6);
    PutOptValues(stream, cookie_noprompt, &prompt_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    char * v21 = gettext("Keyboard Input"); // 0x80a45df
    char * v22 = no_margins == 0 ? "&nbsp;&nbsp;" : (char *)&g30; // 0x80a462d
    fprintf(stream, "\n%s<em>%s</em>\n", v22, v21);
    PutLabel(stream, gettext("Keypad mode"), keypad_mode_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", keypad_mode_string, v6);
    PutOptValues(stream, keypad_mode, &keypad_mode_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Emacs keys"), emacs_keys_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", emacs_keys_string, v6);
    PutOptValues(stream, (int32_t)emacs_keys, &bool_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("VI keys"), vi_keys_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", vi_keys_string, v6);
    PutOptValues(stream, (int32_t)vi_keys, &bool_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    int32_t str; // bp-28, 0x80a3dd7
    if (*(int32_t *)&g142 != 0) {
        // 0x80a483b
        PutLabel(stream, gettext("Line edit style"), lineedit_mode_string);
        fprintf(stream, "<select name=\"%s\" %s>\n", lineedit_mode_string, v6);
        if (*(int32_t *)&LYLineeditNames != 0) {
            int32_t v23 = 0; // 0x80a492e
            sprintf((char *)&str, "%d", v23);
            char * v24 = gettext((char *)*(int32_t *)&LYLineeditNames); // 0x80a48d5
            char * v25 = v23 != current_lineedit ? (char *)&g30 : "selected"; // 0x80a4929
            fprintf(stream, "<option value=\"%s\" %s>%s\n", &str, v25, v24);
            v23++;
            int32_t * v26 = (int32_t *)(4 * v23 + (int32_t)&LYLineeditNames); // 0x80a4935
            while (*v26 != 0) {
                // 0x80a48ae
                sprintf((char *)&str, "%d", v23);
                v24 = gettext((char *)*v26);
                v25 = v23 != current_lineedit ? (char *)&g30 : "selected";
                fprintf(stream, "<option value=\"%s\" %s>%s\n", &str, v25, v24);
                v23++;
                v26 = (int32_t *)(4 * v23 + (int32_t)&LYLineeditNames);
            }
        }
        // 0x80a4944
        fwrite((int32_t *)"</select>\n", 1, 10, stream);
    }
    char * v27 = gettext("Display and Character Set"); // 0x80a496e
    char * v28 = no_margins == 0 ? "&nbsp;&nbsp;" : (char *)&g30; // 0x80a49bc
    fprintf(stream, "\n%s<em>%s</em>\n", v28, v27);
    PutLabel(stream, gettext("Use locale-based character set"), locale_charset_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", locale_charset_string, v6);
    PutOptValues(stream, (int32_t)LYLocaleCharset, &bool_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Display character set"), display_char_set_string);
    int32_t v29 = (int32_t)"disabled"; // 0x80a4a95
    if (LYUseFormsOptions != 0) {
        int32_t v30 = LYLocaleCharset == 0 ? (int32_t)&g30 : (int32_t)"disabled";
        v29 = v30;
    }
    // 0x80a4ad0
    fprintf(stream, "<select name=\"%s\" %s>\n", display_char_set_string, (char *)v29);
    int32_t str2 = *(int32_t *)&LYchar_set_names; // 0x80a4bac
    int32_t v31 = 2; // 0x80a4bb5
    if (str2 != 0) {
        int32_t v32 = 0; // 0x80a4ba5
        uint32_t v33 = 0;
        uint32_t len = strlen((char *)str2); // 0x80a4b0f
        int32_t v34 = len > v33 ? len : v33;
        sprintf((char *)&str, "%d", v32);
        char * v35 = gettext((char *)*(int32_t *)&LYchar_set_names); // 0x80a4b4c
        char * v36 = v32 != current_char_set ? (char *)&g30 : "selected"; // 0x80a4ba0
        fprintf(stream, "<option value=\"%s\" %s>%s\n", &str, v36, v35);
        v32++;
        int32_t * v37 = (int32_t *)(4 * v32 + (int32_t)&LYchar_set_names); // 0x80a4bac
        int32_t str3 = *v37; // 0x80a4bac
        while (str3 != 0) {
            // 0x80a4b02
            v33 = v34;
            len = strlen((char *)str3);
            v34 = len > v33 ? len : v33;
            sprintf((char *)&str, "%d", v32);
            v35 = gettext((char *)*v37);
            v36 = v32 != current_char_set ? (char *)&g30 : "selected";
            fprintf(stream, "<option value=\"%s\" %s>%s\n", &str, v36, v35);
            v32++;
            v37 = (int32_t *)(4 * v32 + (int32_t)&LYchar_set_names);
            str3 = *v37;
        }
        // 0x80a4ba9
        v31 = v34 + 2;
    }
    // 0x80a4bbb
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    int32_t v38 = UCLYhndl_for_unspec; // 0x80a4bee
    if (UCLYhndl_for_unspec == current_char_set) {
        // 0x80a4bf0
        v38 = safeUCGetLYhndl_byMIME((char *)UCAssume_MIMEcharset);
    }
    // 0x80a4c00
    PutLabel(stream, gettext("Assumed document character set"), assume_char_set_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", assume_char_set_string, v6);
    int32_t v39 = 0; // 0x80a4ceb
    if (LYNumCharsets > 0) {
        int32_t * v40 = (int32_t *)(32 * v39 + (int32_t)&g143); // 0x80a4c76
        char * v41 = gettext((char *)*v40); // 0x80a4c7f
        char * v42 = v39 != v38 ? (char *)&g30 : "selected"; // 0x80a4cda
        fprintf(stream, "<option value=\"%s\" %s>%s\n", (char *)*v40, v42, v41);
        int32_t v43 = v39 + 1; // 0x80a4cdf
        v39 = v43;
        while (v43 < LYNumCharsets) {
            // 0x80a4c70
            v40 = (int32_t *)(32 * v39 + (int32_t)&g143);
            v41 = gettext((char *)*v40);
            v42 = v39 != v38 ? (char *)&g30 : "selected";
            fprintf(stream, "<option value=\"%s\" %s>%s\n", (char *)*v40, v42, v41);
            v43 = v39 + 1;
            v39 = v43;
        }
    }
    // 0x80a4ced
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    if (LYHaveCJKCharacterSet == 0) {
        // 0x80a4d42
        PutLabel(stream, gettext("Raw 8-bit"), raw_mode_string);
    } else {
        // 0x80a4d1b
        PutLabel(stream, gettext("CJK mode"), raw_mode_string);
    }
    // 0x80a4d67
    fprintf(stream, "<select name=\"%s\" %s>\n", raw_mode_string, v6);
    PutOptValues(stream, (int32_t)LYRawMode, &bool_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("X Display"), x_display_string);
    int32_t v44 = x_display; // 0x80a4e2e
    int32_t v45 = v44 == 0 ? (int32_t)&g30 : v44;
    fprintf(stream, "<input size=%d type=\"text\" name=\"%s\" value=\"%s\" %s>\n", v3, x_display_string, (char *)v45, v6);
    char * v46 = gettext("Document Appearance"); // 0x80a4e8c
    char * v47 = no_margins == 0 ? "&nbsp;&nbsp;" : (char *)&g30; // 0x80a4eda
    fprintf(stream, "\n%s<em>%s</em>\n", v47, v46);
    SetupChosenShowColor();
    PutLabel(stream, gettext("Show color"), show_color_string);
    if (no_option_save == 0) {
        // 0x80a4fca
        fprintf(stream, "<select name=\"%s\" %s>\n", show_color_string, v6);
        int32_t v48 = can_do_colors == 0 ? (int32_t)"Always try" : (int32_t)"ALWAYS";
        *(int32_t *)&g119 = can_do_colors == 0 ? 0 : (int32_t)"ON";
        *(int32_t *)&g120 = v48;
        PutOptValues(stream, LYChosenShowColor, &show_color_values);
    } else {
        int32_t v49 = (int32_t)"disabled"; // 0x80a4f1c
        if (LYUseFormsOptions != 0) {
            // 0x80a4f1e
            v49 = can_do_colors != 0 ? (int32_t)&g30 : (int32_t)"disabled";
        }
        // 0x80a4f57
        fprintf(stream, "<select name=\"%s\" %s>\n", show_color_string, (char *)v49);
        int32_t v50 = LYShowColor; // 0x80a4f7d
        int32_t v51; // 0x80a3dd7
        if (v50 != 0) {
            // 0x80a4f92
            v51 = v50;
            if (v50 == 3) {
                // 0x80a4f9c
                LYShowColor = 2;
                v51 = 2;
            }
        } else {
            // 0x80a4f86
            LYShowColor = 1;
            v51 = 1;
        }
        // 0x80a4fa6
        PutOptValues(stream, v51 - 1, &bool_values);
    }
    // 0x80a505d
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Show cursor"), show_cursor_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", show_cursor_string, v6);
    PutOptValues(stream, (int32_t)LYShowCursor, &bool_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Underline links"), underline_links_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", underline_links_string, v6);
    PutOptValues(stream, (int32_t)LYUnderlineLinks, &bool_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Show scrollbar"), show_scrollbar_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", show_scrollbar_string, v6);
    PutOptValues(stream, (int32_t)LYShowScrollbar, &bool_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Popups for select fields"), select_popups_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", select_popups_string, v6);
    PutOptValues(stream, (int32_t)LYSelectPopups, &bool_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("HTML error recovery"), DTD_recovery_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", DTD_recovery_string, v6);
    PutOptValues(stream, Old_DTD, &DTD_type_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    char * v52 = will_save_images(); // 0x80a53d2
    PutLabel(stream, gettext("Show images"), v52);
    fprintf(stream, "<select name=\"%s\" %s>\n", images_string, v6);
    char * v53 = gettext(images_ignore_all_string); // 0x80a5442
    int32_t v54; // 0x80a3dd7
    if (pseudo_inline_alts != 0) {
        // 0x80a546f
        v54 = &g30;
        goto lab_0x80a5479;
    } else {
        // 0x80a5458
        v54 = (int32_t)"selected";
        if (clickable_images != 0) {
            // 0x80a546f
            v54 = &g30;
            goto lab_0x80a5479;
        } else {
            goto lab_0x80a5479;
        }
    }
  lab_0x80a5479:
    // 0x80a5479
    fprintf(stream, "<option value=\"%s\" %s>%s\n", images_ignore_all_string, (char *)v54, v53);
    char * v55 = gettext(images_use_label_string); // 0x80a54b1
    int32_t v56; // 0x80a3dd7
    if (pseudo_inline_alts == 0) {
        // 0x80a54de
        v56 = &g30;
        goto lab_0x80a54e8;
    } else {
        // 0x80a54c7
        v56 = (int32_t)"selected";
        if (clickable_images != 0) {
            // 0x80a54de
            v56 = &g30;
            goto lab_0x80a54e8;
        } else {
            goto lab_0x80a54e8;
        }
    }
  lab_0x80a54e8:
    // 0x80a54e8
    fprintf(stream, "<option value=\"%s\" %s>%s\n", images_use_label_string, (char *)v56, v55);
    char * v57 = gettext(images_use_links_string); // 0x80a5520
    char * v58 = clickable_images == 0 ? (char *)&g30 : "selected"; // 0x80a5577
    fprintf(stream, "<option value=\"%s\" %s>%s\n", images_use_links_string, v58, v57);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Verbose images"), verbose_images_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", verbose_images_string, v6);
    PutOptValues(stream, (int32_t)verbose_img, &verbose_images_type_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    char * v59 = gettext("Headers Transferred to Remote Servers"); // 0x80a5651
    char * v60 = no_margins == 0 ? "&nbsp;&nbsp;" : (char *)&g30; // 0x80a569f
    fprintf(stream, "\n%s<em>%s</em>\n", v60, v59);
    PutLabel(stream, gettext("Personal mail address"), mail_address_string);
    int32_t v61 = personal_mail_address; // 0x80a56e5
    int32_t v62 = v61 == 0 ? (int32_t)&g30 : v61;
    fprintf(stream, "<input size=%d type=\"text\" name=\"%s\" value=\"%s\" %s>\n", v3, mail_address_string, (char *)v62, v6);
    PutLabel(stream, gettext("Password for anonymous ftp"), mail_address_string);
    int32_t v63 = anonftp_password; // 0x80a577e
    int32_t v64 = v63 == 0 ? (int32_t)&g30 : v63;
    fprintf(stream, "<input size=%d type=\"text\" name=\"%s\" value=\"%s\" %s>\n", v3, anonftp_password_string, (char *)v64, v6);
    PutLabel(stream, gettext("Preferred media type"), preferred_media_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", preferred_media_string, v6);
    PutOptValues(stream, LYAcceptMedia, &media_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Preferred encoding"), preferred_encoding_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", preferred_encoding_string, v6);
    PutOptValues(stream, LYAcceptEncoding, &encoding_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Preferred document character set"), preferred_doc_char_string);
    int32_t v65 = pref_charset; // 0x80a5962
    int32_t v66 = v65 == 0 ? (int32_t)&g30 : v65;
    fprintf(stream, "<input size=%d type=\"text\" name=\"%s\" value=\"%s\" %s>\n", v31, preferred_doc_char_string, (char *)v66, v6);
    PutLabel(stream, gettext("Preferred document language"), preferred_doc_lang_string);
    int32_t v67 = language; // 0x80a59fe
    int32_t v68 = v67 == 0 ? (int32_t)&g30 : v67;
    fprintf(stream, "<input size=%d type=\"text\" name=\"%s\" value=\"%s\" %s>\n", v31, preferred_doc_lang_string, (char *)v68, v6);
    if (no_useragent == 0) {
        // 0x80a5a68
        PutLabel(stream, gettext("User-Agent header"), user_agent_string);
        int32_t v69 = LYUserAgent; // 0x80a5aa9
        int32_t v70 = v69 == 0 ? (int32_t)&g30 : v69;
        fprintf(stream, "<input size=%d type=\"text\" name=\"%s\" value=\"%s\" %s>\n", v3, user_agent_string, (char *)v70, v6);
    }
    char * v71 = gettext("Listing and Accessing Files"); // 0x80a5b07
    char * v72 = no_margins == 0 ? "&nbsp;&nbsp;" : (char *)&g30; // 0x80a5b4c
    fprintf(stream, "\n%s<em>%s</em>\n", v72, v71);
    PutLabel(stream, gettext("Use Passive FTP"), passive_ftp_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", passive_ftp_string, v6);
    PutOptValues(stream, (int32_t)ftp_passive, &bool_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("FTP sort criteria"), ftp_sort_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", ftp_sort_string, v6);
    PutOptValues(stream, HTfileSortMethod, &ftp_sort_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Local directory sort criteria"), dired_list_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", dired_list_string, v6);
    PutOptValues(stream, dir_list_style, &dired_list_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    PutLabel(stream, gettext("Local directory sort order"), dired_sort_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", dired_sort_string, v6);
    PutOptValues(stream, dir_list_order, &dired_sort_values);
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    if (no_dotfiles == 0) {
        // 0x80a5dd9
        PutLabel(stream, gettext("Show dot files"), show_dotfiles_string);
        fprintf(stream, "<select name=\"%s\" %s>\n", show_dotfiles_string, v6);
        PutOptValues(stream, (int32_t)show_dotfiles, &bool_values);
        fwrite((int32_t *)"</select>\n", 1, 10, stream);
    }
    // 0x80a5e7b
    PutLabel(stream, gettext("Show transfer rate"), show_rate_string);
    fprintf(stream, "<select name=\"%s\" %s>\n", show_rate_string, v6);
    if (*(int32_t *)&g121 != 0) {
        int32_t v73 = 0; // 0x80a5fc3
        int32_t v74 = 0; // 0x80a5fb6
        int32_t v75 = 0; // bp-60, 0x80a5ee5
        int32_t * v76 = (int32_t *)(v73 + (int32_t)&rate_values); // 0x80a5ef8
        HTProgressUnits(*v76);
        HTSprintf0((char **)&v75, (char *)*(int32_t *)&g121);
        char * v77 = gettext((char *)v75); // 0x80a5f33
        int32_t v78 = *(int32_t *)(v73 + (int32_t)&g122); // 0x80a5f72
        char * v79 = *v76 != LYTransferRate ? (char *)&g30 : "selected"; // 0x80a5f98
        fprintf(stream, "<option value=\"%s\" %s>%s\n", (char *)v78, v79, v77);
        int32_t v80 = v75; // 0x80a5f9d
        if (v80 != 0) {
            // 0x80a5fa4
            free((int32_t *)v80);
            v75 = 0;
        }
        // 0x80a5fb6
        v74++;
        v73 = 12 * v74;
        int32_t * v81 = (int32_t *)(v73 + (int32_t)&g121); // 0x80a5fc6
        while (*v81 != 0) {
            // 0x80a5ee5
            v75 = 0;
            v76 = (int32_t *)(v73 + (int32_t)&rate_values);
            HTProgressUnits(*v76);
            HTSprintf0((char **)&v75, (char *)*v81);
            v77 = gettext((char *)v75);
            v78 = *(int32_t *)(v73 + (int32_t)&g122);
            v79 = *v76 != LYTransferRate ? (char *)&g30 : "selected";
            fprintf(stream, "<option value=\"%s\" %s>%s\n", (char *)v78, v79, v77);
            v80 = v75;
            if (v80 != 0) {
                // 0x80a5fa4
                free((int32_t *)v80);
                v75 = 0;
            }
            // 0x80a5fb6
            v74++;
            v73 = 12 * v74;
            v81 = (int32_t *)(v73 + (int32_t)&g121);
        }
    }
    // 0x80a5fd4
    fwrite((int32_t *)"</select>\n", 1, 10, stream);
    char * v82 = gettext("Special Files and Screens"); // 0x80a5ffe
    char * v83 = no_margins == 0 ? "&nbsp;&nbsp;" : (char *)&g30; // 0x80a603d
    fprintf(stream, "\n%s<em>%s</em>\n", v83, v82);
    if (LYMBMBlocked == 0) {
        // 0x80a6051
        PutLabel(stream, gettext("Multi-bookmarks"), mbm_string);
        fprintf(stream, "<select name=\"%s\" %s>\n", mbm_string, v6);
        PutOptValues(stream, LYMultiBookmarks, &mbm_values);
        fwrite((int32_t *)"</select>\n", 1, 10, stream);
    }
    // 0x80a60ee
    if (LYMultiBookmarks == 0) {
        // 0x80a614c
        PutLabel(stream, gettext("Bookmarks file"), single_bookmark_string);
        int32_t v84 = bookmark_page; // 0x80a6187
        int32_t v85 = v84 == 0 ? (int32_t)&g30 : v84;
        fprintf(stream, "<input size=%d type=\"text\" name=\"%s\" value=\"%s\" %s>\n", v3, single_bookmark_string, (char *)v85, v6);
    } else {
        // 0x80a60f7
        PutLabel(stream, gettext("Review/edit Bookmarks files"), mbm_string);
        fprintf(stream, "<a href=\"%s\">%s</a>\n", "LYNXOPTIONS://MBM_MENU", gettext("Goto multi-bookmark menu"));
    }
    // 0x80a61d3
    PutLabel(stream, gettext("Visited Pages"), visited_links_string);
    LYMenuVisitedLinks(stream, (int32_t)(LYUseFormsOptions == 0));
    if (no_lynxcfg_info == 0) {
        // 0x80a6216
        fprintf(stream, "\n  %s<a href=\"%s\">lynx.cfg</a>.\n", gettext("View the file "), "LYNXCFG:");
    }
    // 0x80a6241
    fwrite((int32_t *)"\n</pre>\n", 1, 8, stream);
    if (LYUseFormsOptions != 0) {
        // 0x80a626e
        fwrite((int32_t *)"<p align=center>\n", 1, 17, stream);
        fprintf(stream, "<input type=\"submit\" value=\"%s\"> - \n", gettext("Accept Changes"));
        fprintf(stream, "<input type=\"reset\" value=\"%s\"> - \n", gettext("Reset Changes"));
        fprintf(stream, "%s\n", gettext("Left Arrow cancels changes"));
    }
    // 0x80a62fa
    fwrite((int32_t *)"</form>\n", 1, 8, stream);
    EndInternalPage(stream);
    LYCloseTempFP(stream);
    v4 = 1;
    goto lab_0x80a633d;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a6360 - 0x80a63a4
// Line range:    52 - 57
char is_true(char * string) {
    // 0x80a6360
    if (strcasecomp(string, "TRUE") == 0) {
        // 0x80a639e
        return 1;
    }
    // 0x80a637d
    return strcasecomp(string, "ON") == 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a63a4 - 0x80a6400
// Line range:    63 - 80
char * find_colon(char * buffer) {
    // 0x80a63a4
    if (buffer == NULL) {
        // 0x80a63fb
        return NULL;
    }
    char v1 = *buffer; // 0x80a63e8
    if (v1 == 0) {
        // 0x80a63fb
        return NULL;
    }
    // 0x80a63bf
    if (v1 == 58) {
        // 0x80a63fb
        return buffer;
    }
    char * v2 = buffer; // 0x80a63d1
    if (v1 == 92) {
        // 0x80a63d3
        v2 = (char *)((int32_t)buffer + 1);
        if (*v2 == 0) {
            // break -> 0x80a63fb
            break;
        }
    }
    char * v3 = (char *)((int32_t)v2 + 1);
    char v4 = *v3; // 0x80a63e8
    char * result = NULL; // 0x80a63f2
    while (v4 != 0) {
        // 0x80a63bf
        result = v3;
        if (v4 == 58) {
            // break -> 0x80a63fb
            break;
        }
        char * v5 = v3;
        v2 = v5;
        if (v4 == 92) {
            // 0x80a63d3
            v2 = (char *)((int32_t)v5 + 1);
            result = NULL;
            if (*v2 == 0) {
                // break -> 0x80a63fb
                break;
            }
        }
        // 0x80a63e1
        v3 = (char *)((int32_t)v2 + 1);
        v4 = *v3;
        result = NULL;
    }
    // 0x80a63fb
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a6400 - 0x80a648b
// Line range:    83 - 95
void free_item_list(int32_t ** ptr) {
    int32_t * v1 = *ptr; // 0x80a6409
    if (v1 == NULL) {
        // 0x80a6480
        *(int32_t *)ptr = 0;
        return;
    }
    int32_t v2 = (int32_t)v1;
    int32_t v3 = *v1; // 0x80a6413
    int32_t * v4 = (int32_t *)(v2 + 4); // 0x80a641b
    int32_t v5 = *v4; // 0x80a641b
    if (v5 != 0) {
        // 0x80a6422
        free((int32_t *)v5);
        *v4 = 0;
    }
    int32_t * v6 = (int32_t *)(v2 + 8); // 0x80a643d
    int32_t v7 = *v6; // 0x80a643d
    if (v7 != 0) {
        // 0x80a6444
        free((int32_t *)v7);
        *v6 = 0;
    }
    // 0x80a6474
    free(v1);
    int32_t * v8 = (int32_t *)v3; // 0x80a647e
    while (v3 != 0) {
        // 0x80a6410
        v2 = (int32_t)v8;
        v3 = *v8;
        v4 = (int32_t *)(v2 + 4);
        v5 = *v4;
        if (v5 != 0) {
            // 0x80a6422
            free((int32_t *)v5);
            *v4 = 0;
        }
        // 0x80a643a
        v6 = (int32_t *)(v2 + 8);
        v7 = *v6;
        if (v7 != 0) {
            // 0x80a6444
            free((int32_t *)v7);
            *v6 = 0;
        }
        // 0x80a6474
        free(v8);
        v8 = (int32_t *)v3;
    }
    // 0x80a6480
    *(int32_t *)ptr = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a648b - 0x80a64c3
// Line range:    101 - 113
void free_all_item_lists(void) {
    // 0x80a648b
    free_item_list(&printers);
    free_item_list(&downloaders);
    free_item_list(&uploaders);
    free_item_list(&externals);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a64c3 - 0x80a67df
// Line range:    122 - 234
void add_item_to_list(char * buffer, int32_t ** list_ptr, int32_t special) {
    char * found_char_pos = strrchr(buffer, 58); // 0x80a64d7
    if (found_char_pos != NULL) {
        int32_t v1 = (int32_t)found_char_pos; // 0x80a64e5
        if (*(char *)(v1 - 1) != 92) {
            // 0x80a64f2
            *found_char_pos = 0;
            char * v2 = (char *)(v1 + 1); // 0x80a64f8
            if (strcasecomp(v2, "XWINDOWS") != 0) {
                // 0x80a6522
                if (strcasecomp(v2, "NON_XWINDOWS") == 0) {
                    // 0x80a6539
                    if (LYgetXDisplay() != NULL) {
                        // 0x80a67dd
                        return;
                    }
                }
            } else {
                // 0x80a6513
                if (LYgetXDisplay() == NULL) {
                    // 0x80a67dd
                    return;
                }
            }
        }
    }
    int32_t * v3 = *list_ptr;
    int32_t v4; // 0x80a64c3
    int32_t * v5; // 0x80a64c3
    if (v3 != NULL) {
        int32_t v6 = *v3; // 0x80a659f
        int32_t * v7 = v3; // 0x80a65a3
        if (v6 != 0) {
            int32_t * v8 = (int32_t *)v6;
            int32_t v9 = *v8; // 0x80a659f
            v7 = v8;
            while (v9 != 0) {
                // 0x80a6594
                v8 = (int32_t *)v9;
                v9 = *v8;
                v7 = v8;
            }
        }
        int32_t * mem = calloc(1, 24); // 0x80a65b4
        if (mem == NULL) {
            // 0x80a65c2
            outofmem("./LYReadCFG.c", "read_cfg");
            // UNREACHABLE
        }
        int32_t v10 = (int32_t)mem;
        *v7 = v10;
        v4 = v10;
        v5 = mem;
    } else {
        int32_t * mem2 = calloc(1, 24); // 0x80a655e
        if (mem2 == NULL) {
            // 0x80a656c
            outofmem("./LYReadCFG.c", "read_cfg");
            // UNREACHABLE
        }
        int32_t v11 = (int32_t)mem2;
        *(int32_t *)list_ptr = v11;
        v4 = v11;
        v5 = mem2;
    }
    // 0x80a65e0
    *v5 = 0;
    int32_t * v12 = (int32_t *)(v4 + 4); // 0x80a65ec
    *v12 = 0;
    int32_t * v13 = (int32_t *)(v4 + 8); // 0x80a65f6
    *v13 = 0;
    int32_t * v14 = (int32_t *)(v4 + 12); // 0x80a6600
    *v14 = 0;
    char * v15 = (char *)(v4 + 16); // 0x80a660a
    *v15 = 0;
    int32_t * v16 = (int32_t *)(v4 + 20); // 0x80a6611
    *v16 = 66;
    char * v17 = find_colon(buffer); // 0x80a661e
    char * str = v17; // bp-8, 0x80a6623
    if (v17 == NULL) {
        // 0x80a67dd
        return;
    }
    int32_t * mem3 = calloc(1 - (int32_t)buffer + (int32_t)v17, 1); // 0x80a664a
    *v12 = (int32_t)mem3;
    if (mem3 == NULL) {
        // 0x80a6661
        outofmem("./LYReadCFG.c", "read_cfg");
        // UNREACHABLE
    }
    int32_t v18 = (int32_t)str;
    char * v19 = buffer; // 0x80a6678
    LYstrncpy((char *)mem3, v19, v18 - (int32_t)v19);
    remove_backslashes((char *)*v12);
    char * v20 = find_colon((char *)(v18 + 1)); // 0x80a66ad
    char * v21 = v20; // 0x80a66b9
    if (v20 == NULL) {
        // 0x80a66bb
        v21 = (char *)(strlen(str) + v18);
    }
    int32_t v22 = (int32_t)v21;
    if (v22 + -1 - v18 >= 1) {
        int32_t * mem4 = calloc(v22 - v18, 1); // 0x80a66f6
        *v13 = (int32_t)mem4;
        if (mem4 == NULL) {
            // 0x80a670d
            outofmem("./LYReadCFG.c", "read_cfg");
            // UNREACHABLE
        }
        int32_t v23 = (int32_t)str; // 0x80a6724
        LYstrncpy((char *)mem4, (char *)(v23 + 1), -1 - v23 + v22);
        remove_backslashes((char *)*v13);
    }
    // 0x80a6756
    if (*v21 == 0) {
        // 0x80a67dd
        return;
    }
    int32_t v24 = v22 + 1; // 0x80a6761
    char * str2 = (char *)v24; // 0x80a6761
    *(int32_t *)&str = v24;
    char * found_char_pos2 = strchr(str2, 58); // 0x80a677d
    char * str3 = NULL; // 0x80a6789
    if (found_char_pos2 != NULL) {
        // 0x80a678b
        *found_char_pos2 = 0;
        str3 = (char *)((int32_t)found_char_pos2 + 1);
    }
    // 0x80a6795
    *v14 = (int32_t)is_true(str2);
    if (str3 == NULL) {
        // 0x80a67dd
        return;
    }
    if (special == 0) {
        // 0x80a67ca
        *v15 = is_true(str3);
    } else {
        // 0x80a67b5
        *v16 = atoi(str3);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a681b - 0x80a6884
// Line range:    249 - 254
int32_t match_item_by_name(int32_t * ptr, char * name, char only_overriders) {
    int32_t v1 = (int32_t)ptr;
    if (*(int32_t *)(v1 + 8) == 0) {
        // 0x80a687f
        return 0;
    }
    int32_t * str = (int32_t *)(v1 + 4); // 0x80a6834
    int32_t len = strlen((char *)*str); // 0x80a683a
    if (strncasecomp((char *)*str, name, len) != 0) {
        // 0x80a687f
        return 0;
    }
    // 0x80a685e
    if (only_overriders == 0 || *(char *)(v1 + 16) != 0) {
        // 0x80a687f
        return 1;
    }
    // 0x80a687f
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a6884 - 0x80a6a0c
// Line range:    323 - 348
int32_t check_color(char * color, int32_t the_default) {
    // 0x80a6884
    if (WWW_TraceFlag != 0) {
        // 0x80a6895
        if ((WWW_TraceMask & 2) != 0) {
            // 0x80a68a1
            fprintf(TraceFP(), "check_color(%s,%d)\n", color, the_default);
        }
    }
    // 0x80a68c8
    int32_t result2; // 0x80a6884
    if (strcasecomp(color, "default") == 0) {
        int32_t result = the_default; // 0x80a68e8
        if (LYuse_default_colors != 0) {
            // 0x80a68ea
            result = default_color_reset != 0 ? the_default : -1;
        }
        // 0x80a68fc
        if (WWW_TraceFlag == 0) {
            // 0x80a6a07
            return result;
        }
        // 0x80a6907
        result2 = result;
        if ((WWW_TraceMask & 2) != 0) {
            // 0x80a6913
            fprintf(TraceFP(), "=> default %d\n", result);
            result2 = result;
        }
      lab_0x80a6a07:
        // 0x80a6a07
        return result2;
    }
    // 0x80a693c
    if (strcasecomp(color, "nocolor") == 0) {
        // 0x80a6a07
        return -2;
    }
    int32_t result3 = 0;
    int32_t v1 = *(int32_t *)(4 * result3 + (int32_t)&Color_Strings); // 0x80a696b
    while (strcasecomp(color, (char *)v1) != 0) {
        int32_t v2 = result3 + 1; // 0x80a69c8
        if (v2 >= 16) {
            // 0x80a69d2
            result2 = -3;
            if (WWW_TraceFlag == 0) {
                return result2;
            } else {
                // 0x80a69dd
                result2 = -3;
                if ((WWW_TraceMask & 2) == 0) {
                    return result2;
                } else {
                    // 0x80a69e9
                    fprintf(TraceFP(), "=> ERR_COLOR\n");
                    result2 = -3;
                    return result2;
                }
            }
        }
        result3 = v2;
        v1 = *(int32_t *)(4 * result3 + (int32_t)&Color_Strings);
    }
    // 0x80a6985
    if (WWW_TraceFlag == 0) {
        // 0x80a6a07
        return result3;
    }
    // 0x80a6996
    if ((WWW_TraceMask & 2) != 0) {
        // 0x80a69a2
        fprintf(TraceFP(), "=> %d\n", result3);
    }
    // 0x80a6a07
    return result3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a6a0c - 0x80a6a48
// Line range:    351 - 359
char * lookup_color(int32_t code) {
    int32_t v1 = 0;
    while (v1 != code) {
        int32_t v2 = v1 + 1; // 0x80a6a32
        char * result = "default"; // 0x80a6a3a
        if (v2 >= 16) {
            // 0x80a6a43
            return result;
        }
        v1 = v2;
    }
    int32_t v3 = *(int32_t *)(4 * v1 + (int32_t)&Color_Strings); // 0x80a6a26
    // 0x80a6a43
    return (char *)v3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a818f - 0x80a829a
// Line range:    1625 - 1669
void free_lynx_cfg(void) {
    // 0x80a818f
    if (g127 != NULL) {
        int32_t v1 = (int32_t)&g127;
        int32_t v2; // 0x80a818f
        int32_t v3; // 0x80a8221
        char * str; // 0x80a81da
        char * found_char_pos; // 0x80a81da
        int32_t v4; // 0x80a818f
        int32_t v5; // 0x80a81fe
        int32_t * v6; // 0x80a81a7
        int32_t v7; // 0x80a81bc
        if (*(int32_t *)(v1 + 4) == 8) {
            // 0x80a81b9
            v6 = (int32_t *)(v1 + 8);
            v7 = *v6;
            if (v7 != 0) {
                // 0x80a81c2
                str = (char *)*(int32_t *)v7;
                found_char_pos = strchr(str, 61);
                if (found_char_pos != NULL) {
                    // 0x80a81e8
                    *found_char_pos = 0;
                    unsetenv(str);
                }
                // 0x80a81f9
                v4 = *v6;
                v5 = *(int32_t *)v4;
                v2 = v4;
                if (v5 != 0) {
                    // 0x80a8204
                    free((int32_t *)v5);
                    *(int32_t *)*v6 = 0;
                    v2 = *v6;
                }
                // 0x80a821e
                v3 = v2;
                if (v3 != 0) {
                    // 0x80a8227
                    free((int32_t *)v3);
                    *v6 = 0;
                }
            }
        }
        int32_t v8 = v1 + 16; // 0x80a823d
        while (*(int32_t *)v8 != 0) {
            // 0x80a81a1
            v1 = v8;
            if (*(int32_t *)(v1 + 4) == 8) {
                // 0x80a81b9
                v6 = (int32_t *)(v1 + 8);
                v7 = *v6;
                if (v7 != 0) {
                    // 0x80a81c2
                    str = (char *)*(int32_t *)v7;
                    found_char_pos = strchr(str, 61);
                    if (found_char_pos != NULL) {
                        // 0x80a81e8
                        *found_char_pos = 0;
                        unsetenv(str);
                    }
                    // 0x80a81f9
                    v4 = *v6;
                    v5 = *(int32_t *)v4;
                    v2 = v4;
                    if (v5 != 0) {
                        // 0x80a8204
                        free((int32_t *)v5);
                        *(int32_t *)*v6 = 0;
                        v2 = *v6;
                    }
                    // 0x80a821e
                    v3 = v2;
                    if (v3 != 0) {
                        // 0x80a8227
                        free((int32_t *)v3);
                        *v6 = 0;
                    }
                }
            }
            // 0x80a823d
            v8 = v1 + 16;
        }
    }
    // 0x80a824e
    free_all_item_lists();
    reset_dired_menu();
    if (lynxcfginfo_url != 0) {
        // 0x80a8261
        free((int32_t *)lynxcfginfo_url);
        lynxcfginfo_url = 0;
    }
    // 0x80a8278
    if (configinfo_url != 0) {
        // 0x80a8281
        free((int32_t *)configinfo_url);
        configinfo_url = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a829a - 0x80a8377
// Line range:    1672 - 1686
int32_t * lookup_config(char * name) {
    int16_t * v1 = *__ctype_b_loc(); // 0x80a82ac
    unsigned char v2 = *name;
    int32_t c = v2;
    char v3 = v2; // 0x80a82c9
    if ((*(int16_t *)(2 * c + (int32_t)v1) & 512) != 0) {
        // 0x80a82cb
        v3 = toupper(c);
    }
    // 0x80a82ea
    if (g127 == NULL) {
        // 0x80a8372
        return (int32_t *)&g127;
    }
    int32_t v4 = (int32_t)&g127; // 0x80a8365
    int32_t c2 = (int32_t)*(char *)(int32_t)g127; // 0x80a82f8
    int16_t * v5 = *__ctype_b_loc(); // 0x80a830a
    int32_t v6 = c2; // 0x80a8325
    if ((*(int16_t *)(2 * c2 + (int32_t)v5) & 512) != 0) {
        // 0x80a8327
        v6 = toupper(c2);
    }
    // 0x80a8345
    if (v6 == (int32_t)v3) {
        // 0x80a834d
        if (strcasecomp(name, (char *)*(int32_t *)&g127) == 0) {
            // break -> 0x80a8372
            break;
        }
    }
    // 0x80a8365
    v4 += 16;
    int32_t * v7 = (int32_t *)v4;
    int32_t v8 = *v7; // 0x80a836c
    int32_t * result = v7; // 0x80a8370
    while (v8 != 0) {
        int32_t * v9 = v7;
        c2 = (int32_t)*(char *)v8;
        v5 = *__ctype_b_loc();
        v6 = c2;
        if ((*(int16_t *)(2 * c2 + (int32_t)v5) & 512) != 0) {
            // 0x80a8327
            v6 = toupper(c2);
        }
        // 0x80a8345
        if (v6 == (int32_t)v3) {
            // 0x80a834d
            result = v9;
            if (strcasecomp(name, (char *)*v9) == 0) {
                // break -> 0x80a8372
                break;
            }
        }
        // 0x80a8365
        v4 += 16;
        v7 = (int32_t *)v4;
        v8 = *v7;
        result = v7;
    }
    // 0x80a8372
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a8377 - 0x80a84b1
// Line range:    1699 - 1725
char * actual_filename(char * cfg_filename, char * parent_filename, char * dft_filename) {
    char * result = NULL; // bp-12, 0x80a837e
    if (LYisAbsPath(cfg_filename) != 0) {
        // 0x80a8496
        HTSACopy(&result, cfg_filename);
        // 0x80a84a8
        return result;
    }
    if (parent_filename == NULL) {
        // 0x80a839e
        if (LYCanReadFile(cfg_filename) != 0) {
            // 0x80a8496
            HTSACopy(&result, cfg_filename);
            // 0x80a84a8
            return result;
        }
    }
    // 0x80a83b1
    if (*cfg_filename == 126) {
        char * v1 = (char *)((int32_t)cfg_filename + 1); // 0x80a83c1
        if (*v1 == 47) {
            char * v2 = Home_Dir(); // 0x80a83ce
            HTSprintf0(&result, "%s%s", v2, v1);
            // 0x80a84a8
            return result;
        }
    }
    if (parent_filename != NULL) {
        // 0x80a83f9
        HTSACopy(&result, parent_filename);
        *LYPathLeaf(result) = 0;
        HTSACat(&result, cfg_filename);
    }
    // 0x80a842b
    if (result != NULL) {
        // 0x80a8432
        if (LYCanReadFile(result) != 0) {
            // 0x80a84a8
            return result;
        }
    }
    // 0x80a8441
    HTSACopy(&result, dft_filename);
    *LYPathLeaf(result) = 0;
    HTSACat(&result, cfg_filename);
    if (LYCanReadFile(result) == 0) {
        // 0x80a8482
        HTSACopy(&result, cfg_filename);
    }
    // 0x80a84a8
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a84b1 - 0x80a852f
// Line range:    1730 - 1739
struct _IO_FILE * LYOpenCFG(char * cfg_filename, char * parent_filename, char * dft_filename) {
    char * v1 = actual_filename(cfg_filename, parent_filename, dft_filename); // 0x80a84cb
    if (WWW_TraceFlag != 0) {
        // 0x80a84de
        fprintf(TraceFP(), "opening config file %s\n", v1);
    }
    struct _IO_FILE * result = fopen64(v1, "r"); // 0x80a850a
    if (v1 != NULL) {
        // 0x80a8518
        free((int32_t *)v1);
    }
    // 0x80a852a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a852f - 0x80a880e
// Line range:    1759 - 1855
void LYSetConfigValue(char * name, char * value) {
    int32_t v1 = (int32_t)lookup_config(name); // 0x80a853c
    int32_t * str = (int32_t *)(v1 + 8); // 0x80a854a
    int32_t * tbl = NULL; // bp-20, 0x80a854d
    int32_t * v2 = (int32_t *)(v1 + 4); // 0x80a8557
    int32_t v3 = *v2; // 0x80a8557
    g363 = v3;
    int32_t * q; // bp-24, 0x80a852f
    switch (v3) {
        case 1: {
            int32_t v4 = *str; // 0x80a8576
            if (v4 != 0) {
                // 0x80a8580
                *(char *)v4 = is_true(value);
            }
            // 0x80a8597
            return;
        }
        case 13: {
            // 0x80a87c8
            add_trusted(value, *str);
            // 0x80a8597
            return;
        }
        case 3: {
            // 0x80a85b6
            if (*str == 0) {
                // 0x80a8597
                return;
            }
            // 0x80a85c3
            if (sscanf(value, "%f", &q) == 1) {
                int32_t v5 = *str; // 0x80a85e9
                *(int32_t *)v5 = (int32_t)(1000.0L * (float80_t)(float32_t)(int32_t)q);
            }
            // 0x80a8597
            return;
        }
        case 4: {
            int32_t v6 = *(int32_t *)(v1 + 12); // 0x80a8619
            if (v6 != 0) {
                // 0x80a8624
                LYgetEnum((int32_t *)v6, value, (int32_t *)*str);
            }
            // 0x80a8597
            return;
        }
        case 5: {
            // 0x80a8647
            if (*str == 0) {
                // 0x80a8597
                return;
            }
            // 0x80a8654
            if (sscanf(value, "%d", &q) == 1) {
                // 0x80a8677
                *(int32_t *)*str = (int32_t)q;
            }
            // 0x80a8597
            return;
        }
        case 6: {
            int32_t v7 = *str; // 0x80a8689
            if (v7 != 0) {
                // 0x80a8693
                HTSACopy((char **)v7, value);
            }
            // 0x80a8597
            return;
        }
        case 7: {
            // 0x80a87de
            if (HTSACopy((char **)&tbl, value) != NULL) {
                // 0x80a87f4
                HTSetProgramPath(*str, (char *)tbl);
            }
            // 0x80a8597
            return;
        }
        case 8: {
        }
        case 9: {
            // 0x80a86ac
            if (*v2 != 8) {
                // 0x80a86c4
                LYUpperCase(name);
            } else {
                // 0x80a86b7
                LYLowerCase(name);
            }
            // 0x80a86cf
            if (LYGetEnv(name) != NULL) {
                // 0x80a8597
                return;
            }
            int32_t v8 = *str; // 0x80a86e5
            int32_t mem = v8; // 0x80a86e9
            if (v8 == 0) {
                // 0x80a86eb
                mem = (int32_t)calloc(1, 4);
                *str = mem;
            }
            // 0x80a8706
            HTSprintf0((char **)mem, "%s=%s", name, value);
            putenv((char *)*(int32_t *)*str);
            // 0x80a8597
            return;
        }
        case 11: {
            int32_t v9 = *str; // 0x80a8740
            if (v9 != 0) {
                // 0x80a874a
                add_item_to_list(value, (int32_t **)v9, (int32_t)(v9 == (int32_t)&printers));
            }
            // 0x80a8597
            return;
        }
        case 12: {
            int32_t v10 = *str;
            int32_t * v11 = (int32_t *)v10; // 0x80a877c
            int32_t v12 = v10; // 0x80a8780
            if (*v11 == 0) {
                // 0x80a8782
                *v11 = (int32_t)HTList_new();
                v12 = *str;
            }
            // 0x80a878e
            if (v12 != 0) {
                // 0x80a8797
                q = NULL;
                HTSACopy((char **)&q, value);
                HTList_appendObject((int32_t *)*(int32_t *)*str, (char *)q);
            }
            // 0x80a8597
            return;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a880e - 0x80a93f3
// Line range:    1869 - 2156
void do_read_cfg(char * cfg_filename, char * parent_filename, uint32_t nesting_level, struct _IO_FILE * fp0, char (*allowed)[207]) {
    int32_t v1 = __readgsdword(20); // 0x80a883c
    int32_t * fp = NULL; // bp-436, 0x80a8847
    if (WWW_TraceFlag != 0) {
        // 0x80a885c
        fprintf(TraceFP(), "Loading cfg file '%s'.\n", cfg_filename);
    }
    if (nesting_level >= 11) {
        // 0x80a8887
        fprintf((struct _IO_FILE *)g160, gettext("More than %d nested lynx.cfg includes -- perhaps there is a loop?!?\n"));
        fprintf((struct _IO_FILE *)g160, gettext("Last attempted include was '%s',\n"));
        fprintf((struct _IO_FILE *)g160, gettext("included from '%s'.\n"));
        exit_immediately(1);
        // UNREACHABLE
    }
    struct _IO_FILE * v2; // 0x80a896b
    int32_t v3; // 0x80a880f
    int32_t v4; // 0x80a880e
    int32_t v5; // 0x80a880e
    int32_t v6; // 0x80a880e
    char * str; // 0x80a89c9
    char * str2; // 0x80a880e
    int32_t v7; // 0x80a8b60
    if (cfg_filename == NULL) {
        goto lab_0x80a8925;
    } else {
        // 0x80a8918
        if (*cfg_filename != 0) {
            // 0x80a8950
            v2 = LYOpenCFG(cfg_filename, parent_filename, "/etc/lynx-cur/lynx.cfg");
            if (v2 != NULL) {
                // 0x80a89b4
                have_read_cfg = 1;
                if (LYSafeGets((char **)&fp, v2) != NULL) {
                    // 0x80a89c0
                    int32_t v8; // bp-4, 0x80a880e
                    v3 = &v8;
                    v4 = v3 - 215;
                    v5 = nesting_level + 1;
                    v6 = (int32_t)allowed;
                    while (true) {
                      lab_0x80a89c0:
                        // 0x80a89c0
                        str = LYSkipBlanks((char *)fp);
                        int16_t v9 = *(int16_t *)(2 * (int32_t)*str + (int32_t)*__ctype_b_loc()); // 0x80a89ec
                        if ((v9 & 4) != 0) {
                            goto lab_0x80a9363;
                        } else {
                            // 0x80a89fd
                            LYTrimTrailing(str);
                            if (*str == 0) {
                                goto lab_0x80a9363;
                            } else {
                                char * found_char_pos = strchr(str, 58); // 0x80a8a2d
                                if (found_char_pos != NULL) {
                                    // 0x80a8a76
                                    *found_char_pos = 0;
                                    str2 = (char *)((int32_t)found_char_pos + 1);
                                    char * found_char_pos2 = strrchr(str2, 58); // 0x80a8a97
                                    char * found_char_pos3 = strchr(found_char_pos2 != NULL ? found_char_pos2 : str2, 35); // 0x80a8ac8
                                    if (found_char_pos3 != NULL) {
                                        char * v10 = (char *)((int32_t)found_char_pos3 - 1); // 0x80a8adc
                                        int16_t v11 = *(int16_t *)(2 * (int32_t)*v10 + (int32_t)*__ctype_b_loc()); // 0x80a8afb
                                        if ((v11 & 0x2000) != 0) {
                                            // 0x80a8b0a
                                            *v10 = 0;
                                        }
                                    }
                                    // 0x80a8b13
                                    if (WWW_TraceFlag != 0) {
                                        // 0x80a8b1e
                                        if ((WWW_TraceMask & 8) != 0) {
                                            // 0x80a8b2a
                                            fprintf(TraceFP(), "LYReadCFG %s:%s\n", str, str2);
                                        }
                                    }
                                    int32_t * v12 = lookup_config(str); // 0x80a8b60
                                    if (*v12 != 0) {
                                        // 0x80a8bb8
                                        v7 = (int32_t)v12;
                                        if (allowed == NULL) {
                                            goto lab_0x80a8c20;
                                        } else {
                                            // 0x80a8bc1
                                            if (*(char *)((v7 - (int32_t)&g127 >> 4) + v6) == 0) {
                                                goto lab_0x80a8c20;
                                            } else {
                                                if (fp0 == NULL) {
                                                    // 0x80a8bf2
                                                    fprintf((struct _IO_FILE *)g160, "%s is not allowed in the %s\n", str, cfg_filename);
                                                }
                                                goto lab_0x80a9363;
                                            }
                                        }
                                    } else {
                                        // 0x80a8b77
                                        if (WWW_TraceFlag != 0) {
                                            // 0x80a8b86
                                            fprintf(TraceFP(), "LYReadCFG: ignored %s:%s\n", str, str2);
                                        }
                                        goto lab_0x80a9363;
                                    }
                                } else {
                                    // 0x80a8a41
                                    if (WWW_TraceFlag != 0) {
                                        // 0x80a8a50
                                        fprintf(TraceFP(), "LYReadCFG: missing ':' %s\n", str);
                                    }
                                    goto lab_0x80a9363;
                                }
                            }
                        }
                    }
                }
              lab_0x80a9383:
                // 0x80a9383
                LYCloseInput(v2);
                if (downloaders != NULL) {
                    char * v13 = (char *)downloaders; // 0x80a880e
                    while (*(int32_t *)((int32_t)v13 + 12) == 0) {
                        int32_t v14 = *(int32_t *)v13; // 0x80a93c3
                        v13 = (char *)v14;
                        if (v14 == 0) {
                            goto lab_0x80a93d4;
                        }
                    }
                    // 0x80a93b4
                    override_no_download = 1;
                }
              lab_0x80a93d4:
                // 0x80a93d4
                LYConfigCookies();
            } else {
                // 0x80a897f
                if (WWW_TraceFlag != 0) {
                    // 0x80a898e
                    fprintf(TraceFP(), "lynx.cfg file not found as '%s'\n", cfg_filename);
                }
            }
            goto lab_0x80a93d9;
        } else {
            goto lab_0x80a8925;
        }
    }
  lab_0x80a9363:
    // 0x80a9363
    if (LYSafeGets((char **)&fp, v2) == NULL) {
        // break -> 0x80a9383
        goto lab_0x80a9383;
    }
    goto lab_0x80a89c0;
  lab_0x80a8c20:;
    uint32_t v15 = *(int32_t *)(v7 + 4);
    int32_t v16 = 0; // 0x80a8c36
    if (v15 != 10 == (fp0 != NULL)) {
        goto lab_0x80a8c6e;
    } else {
        // 0x80a8c61
        v16 = v15;
        if (v15 < 14) {
            goto lab_0x80a8c6e;
        } else {
            goto lab_0x80a926e;
        }
    }
  lab_0x80a8c6e:;
    uint32_t v17 = v16 % 32; // 0x80a8c7c
    char * v18; // 0x80a880e
    char * v19; // 0x80a880e
    char * v20; // bp-472, 0x80a880e
    char * v21; // bp-476, 0x80a880e
    char * str3; // 0x80a880e
    if ((1 << v17 & 0x3bfe) != 0) {
        // 0x80a8ca7
        LYSetConfigValue(str, str2);
        goto lab_0x80a9363;
    } else {
        if (v17 == 10) {
            // 0x80a8cc4
            v20 = NULL;
            v21 = NULL;
            char * substr_pos = strstr(str2, " for "); // 0x80a8d10
            str3 = " for ";
            v18 = substr_pos;
            if (substr_pos != NULL) {
                goto lab_0x80a8d55;
            } else {
                char * substr_pos2 = strstr(str2, ":"); // 0x80a8d41
                str3 = ":";
                v18 = substr_pos2;
                v19 = NULL;
                if (substr_pos2 == NULL) {
                    goto lab_0x80a8d72;
                } else {
                    goto lab_0x80a8d55;
                }
            }
        } else {
            goto lab_0x80a926e;
        }
    }
  lab_0x80a926e:
    if (fp0 == NULL) {
        goto lab_0x80a9363;
    } else {
        // 0x80a927b
        if (strchr(str2, 38) != NULL) {
            goto lab_0x80a92b3;
        } else {
            // 0x80a9295
            if (strchr(str2, 60) == NULL) {
                // 0x80a9339
                fprintf(fp0, "%s:%s\n", str, str2);
                goto lab_0x80a9363;
            } else {
                goto lab_0x80a92b3;
            }
        }
    }
  lab_0x80a8d55:
    // 0x80a8d55
    *v18 = 0;
    v19 = (char *)(strlen(str3) + (int32_t)v18);
    goto lab_0x80a8d72;
  lab_0x80a92b3:;
    char * v44 = NULL; // bp-504, 0x80a92b3
    HTSACopy(&v44, str2);
    LYEntify(&v44, 1);
    fprintf(fp0, "%s:%s\n", str, v44);
    char * v51 = v44; // 0x80a9315
    if (v51 != NULL) {
        // 0x80a931f
        free((int32_t *)v51);
        v44 = NULL;
    }
    goto lab_0x80a9363;
  lab_0x80a8d72:
    // 0x80a8d72
    if (fp0 == NULL) {
        goto lab_0x80a8ea3;
    } else {
        // 0x80a8d7f
        if (no_lynxcfg_xinfo != 0) {
            goto lab_0x80a8ea3;
        } else {
            char * v22 = actual_filename(str2, cfg_filename, "/etc/lynx-cur/lynx.cfg"); // 0x80a8da9
            LYLocalFileToURL(&v20, v22);
            if (v22 != NULL) {
                // 0x80a8dd5
                free((int32_t *)v22);
            }
            // 0x80a8ded
            HTSACopy(&v21, str2);
            if (strchr(str2, 38) != NULL) {
                // 0x80a8e39
                LYEntify(&v21, 1);
                goto lab_0x80a8e4f;
            } else {
                // 0x80a8e1f
                if (strchr(str2, 60) == NULL) {
                    goto lab_0x80a8e4f;
                } else {
                    // 0x80a8e39
                    LYEntify(&v21, 1);
                    goto lab_0x80a8e4f;
                }
            }
        }
    }
  lab_0x80a8ea3:;
    char * v23 = v19; // 0x80a8eaa
    char v24 = 0; // 0x80a8eaa
    if (v19 != NULL) {
        char v25 = 0;
        char * v26 = LYSkipBlanks(v23); // 0x80a8fc3
        v24 = v25;
        while (*v26 != 0) {
            char * v27 = LYSkipNonBlanks(v26); // 0x80a8ebe
            *v27 = 0;
            int32_t * v28 = lookup_config(v26); // 0x80a8eea
            char v29; // 0x80a880e
            if (*v28 != 0) {
                int32_t v30 = 0; // 0x80a8f40
                char v31 = v25; // 0x80a8f40
                if (v25 == 0) {
                    *(char *)(v30 + v4) = 1;
                    int32_t v32 = v30 + 1; // 0x80a8f63
                    v30 = v32;
                    v31 = 1;
                    while (v32 != 207) {
                        // 0x80a8f55
                        *(char *)(v30 + v4) = 1;
                        v32 = v30 + 1;
                        v30 = v32;
                        v31 = 1;
                    }
                }
                // 0x80a8f76
                *(char *)(((int32_t)v28 - (int32_t)&g127 >> 4) + v4) = 0;
                v29 = v31;
            } else {
                // 0x80a8f01
                v29 = v25;
                if (fp0 == NULL) {
                    // 0x80a8f0e
                    fprintf((struct _IO_FILE *)g160, "unknown option name %s in %s\n", v26, cfg_filename);
                    v29 = v25;
                }
            }
            char v33 = v29;
            v24 = v33;
            if (*v27 == 0) {
                // break -> 0x80a8fdf
                break;
            }
            char * v34 = (char *)((int32_t)v27 + 1); // 0x80a8fa4
            char v35 = v33; // 0x80a8fa9
            v23 = v34;
            v24 = v33;
            if (*v34 == 0) {
                // break -> 0x80a8fdf
                break;
            }
            v25 = v35;
            v26 = LYSkipBlanks(v23);
            v24 = v25;
        }
    }
    char v36 = v24;
    char (*v37)[207]; // 0x80a880e
    if (allowed != NULL) {
        // 0x80a9011
        v37 = allowed;
        if (v36 != 0) {
            int32_t v38 = 0;
            char v39 = 1; // 0x80a9055
            if (*(char *)(v38 + v6) == 0) {
                // 0x80a9057
                v39 = *(char *)(v38 + v4) != 0;
            }
            // 0x80a907f
            *(char *)(v3 - 422 + v38) = v39;
            int32_t v40 = v38 + 1; // 0x80a9093
            int32_t v41; // bp-426, 0x80a880e
            v37 = (char (*)[207])&v41;
            while (v40 != 207) {
                // 0x80a9037
                v38 = v40;
                v39 = 1;
                if (*(char *)(v38 + v6) == 0) {
                    // 0x80a9057
                    v39 = *(char *)(v38 + v4) != 0;
                }
                // 0x80a907f
                *(char *)(v3 - 422 + v38) = v39;
                v40 = v38 + 1;
                v37 = (char (*)[207])&v41;
            }
        }
    } else {
        // 0x80a8fe8
        int32_t v42; // bp-219, 0x80a880e
        v37 = v36 != 0 ? (char (*)[207])&v42 : NULL;
    }
    char (*v43)[207] = v37; // 0x80a91b5
    if (fp0 == NULL) {
        // 0x80a9363
        do_read_cfg(str2, cfg_filename, v5, NULL, v43);
    } else {
        // 0x80a90bf
        if (v43 != NULL && no_lynxcfg_xinfo == 0) {
            // 0x80a90db
            v44 = NULL;
            fwrite((int32_t *)"     Options allowed in this file:\n", 1, 35, fp0);
            int32_t v45 = 0;
            int32_t v46; // 0x80a9134
            if (*(char *)(v45 + (int32_t)v43) == 0) {
                // 0x80a912b
                v46 = *(int32_t *)(16 * v45 + (int32_t)&g127);
                HTSACopy(&v44, (char *)v46);
                LYUpperCase(v44);
                fprintf(fp0, "         * %s\n", v44);
            }
            int32_t v47 = v45 + 1; // 0x80a917a
            while (v47 != 207) {
                // 0x80a9117
                v45 = v47;
                if (*(char *)(v45 + (int32_t)v43) == 0) {
                    // 0x80a912b
                    v46 = *(int32_t *)(16 * v45 + (int32_t)&g127);
                    HTSACopy(&v44, (char *)v46);
                    LYUpperCase(v44);
                    fprintf(fp0, "         * %s\n", v44);
                }
                // 0x80a917a
                v47 = v45 + 1;
            }
            char * v48 = v44; // 0x80a918d
            if (v48 != NULL) {
                // 0x80a9197
                free((int32_t *)v48);
                v44 = NULL;
            }
        }
        // 0x80a91f2
        do_read_cfg(str2, cfg_filename, v5, fp0, v43);
        if (no_lynxcfg_xinfo == 0) {
            // 0x80a9201
            fprintf(fp0, "    #&lt;end of %s&gt;\n\n", v21);
            char * v49 = v20; // 0x80a9221
            if (v49 != NULL) {
                // 0x80a922b
                free((int32_t *)v49);
                v20 = NULL;
            }
            char * v50 = v21; // 0x80a9243
            if (v50 != NULL) {
                // 0x80a9251
                free((int32_t *)v50);
                v21 = NULL;
            }
        }
    }
    goto lab_0x80a9363;
  lab_0x80a8e4f:
    // 0x80a8e4f
    fprintf(fp0, "%s:<a href=\"%s\">%s</a>\n\n", str, v20, v21);
    fprintf(fp0, "    #&lt;begin  %s&gt;\n", v21);
    goto lab_0x80a8ea3;
  lab_0x80a8925:
    // 0x80a8925
    if (WWW_TraceFlag != 0) {
        // 0x80a8934
        fprintf(TraceFP(), "No filename following -cfg switch!\n");
    }
    goto lab_0x80a93d9;
  lab_0x80a93d9:
    // 0x80a93d9
    if (v1 != __readgsdword(20)) {
        // 0x80a93e5
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a93f3 - 0x80a9428
// Line range:    2163 - 2166
void read_cfg(char * cfg_filename, char * parent_filename, int32_t nesting_level, struct _IO_FILE * fp0) {
    // 0x80a93f3
    HTInitProgramPaths();
    do_read_cfg(cfg_filename, parent_filename, nesting_level, fp0, NULL);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a9428 - 0x80a9451
// Line range:    2171 - 2174
void extra_cfg_link(struct _IO_FILE * fp, char * href, char * name) {
    // 0x80a9428
    fprintf(fp, "<a href=\"%s\">%s</a>", href, name);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a9451 - 0x80a9c14
// Line range:    2183 - 2391
int32_t lynx_cfg_infopage(int32_t * newdoc2) {
    int32_t v1 = (int32_t)newdoc2;
    char * v2 = NULL; // bp-16, 0x80a9459
    char * temp = NULL; // bp-20, 0x80a9460
    int32_t v3; // 0x80a9451
    int32_t * str; // 0x80a9479
    if (no_lynxcfg_xinfo != 0) {
        // 0x80a960e
        v3 = lynxcfginfo_url;
        goto lab_0x80a960e_2;
    } else {
        // 0x80a9476
        str = (int32_t *)(v1 + 4);
        if (strstr((char *)*str, "LYNXCFG://reload") == NULL) {
            // 0x80a960e
            v3 = lynxcfginfo_url;
            goto lab_0x80a960e_2;
        } else {
            // 0x80a9494
            reload_read_cfg();
            if (HTMainText == NULL || nhist < 1) {
                goto lab_0x80a95ee;
            } else {
                char * str2 = gettext("Lynx.cfg Information"); // 0x80a94ba
                if (strcmp(HTLoadedDocumentTitle(), str2) != 0) {
                    goto lab_0x80a95ee;
                } else {
                    int32_t str3 = *(int32_t *)((int32_t)history - 40 + 44 * nhist); // 0x80a94ee
                    if (strcmp(HTLoadedDocumentURL(), (char *)str3) != 0) {
                        goto lab_0x80a95ee;
                    } else {
                        int32_t v4 = *(int32_t *)((int32_t)history - 40 + 44 * nhist); // 0x80a951e
                        if (LYIsUIPage3((char *)v4, 6, 1) == 0) {
                            goto lab_0x80a95ee;
                        } else {
                            int32_t str4 = lynxcfginfo_url; // 0x80a9541
                            if (str4 == 0) {
                                goto lab_0x80a9569;
                            } else {
                                // 0x80a954a
                                if (strcmp(HTLoadedDocumentURL(), (char *)str4) == 0) {
                                    goto lab_0x80a95ee;
                                } else {
                                    goto lab_0x80a9569;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x80a960e_2:;
    // 0x80a960e
    int32_t v5; // 0x80a9451
    if (LYforce_no_cache == 0 || reloading == 0) {
        if (v3 == 0) {
            goto lab_0x80a968c;
        } else {
            char v6 = LYCanReadFile((char *)&g128); // 0x80a9656
            int32_t v7 = lynxcfginfo_url; // 0x80a965f
            if (v6 != 0 || v7 == 0) {
                // 0x80a967f
                v5 = v7;
                if (v7 != 0) {
                    goto lab_0x80a9b94;
                } else {
                    goto lab_0x80a968c;
                }
            } else {
                // 0x80a9668
                free((int32_t *)v7);
                lynxcfginfo_url = 0;
                goto lab_0x80a968c;
            }
        }
    } else {
        if (v3 != 0) {
            // 0x80a962d
            free((int32_t *)v3);
            lynxcfginfo_url = 0;
        }
        goto lab_0x80a968c;
    }
  lab_0x80a95ee:;
    int32_t v8 = lynxcfginfo_url;
    v3 = 0;
    if (v8 != 0) {
        // 0x80a95f7
        free((int32_t *)v8);
        lynxcfginfo_url = 0;
        v3 = 0;
    }
    goto lab_0x80a960e_2;
  lab_0x80a968c:;
    struct _IO_FILE * stream = InternalPageFP((char *)&g128, 1); // 0x80a969b
    if (stream == NULL) {
        // 0x80a9c0a
        return 0;
    }
    // 0x80a96b5
    LYLocalFileToURL((char **)&lynxcfginfo_url, (char *)&g128);
    LYforce_no_cache = 1;
    BeginInternalPage(stream, gettext("Lynx.cfg Information"), NULL);
    fwrite((int32_t *)"<pre>\n", 1, 6, stream);
    if (no_lynxcfg_xinfo != 0) {
        // 0x80a9afe
        fprintf(stream, "<em>%s</em>\n\n", gettext("The following is read from your lynx.cfg file."));
        goto lab_0x80a9b21;
    } else {
        int32_t strcmp_rc = strcmp((char *)lynx_cfg_file, "/etc/lynx-cur/lynx.cfg"); // 0x80a9735
        char * v9 = gettext("Please read the distribution");
        fprintf(stream, "<em>%s\n%s", gettext("The following is read from your lynx.cfg file."), v9);
        if (strcmp_rc == 0) {
            // 0x80a97e2
            fwrite((int32_t *)" </em>lynx.cfg<em> ", 1, 19, stream);
            fprintf(stream, "%s</em>\n", gettext("for more comments."));
        } else {
            // 0x80a9742
            LYLocalFileToURL(&v2, "/etc/lynx-cur/lynx.cfg");
            fprintf(stream, " <a href=\"%s\">lynx.cfg</a> ", v2);
            char * v10 = v2; // 0x80a97a4
            if (v10 != NULL) {
                // 0x80a97ab
                free((int32_t *)v10);
                v2 = NULL;
            }
            // 0x80a97bd
            fprintf(stream, "%s</em>\n\n", gettext("for more comments."));
        }
        // 0x80a985d
        if (no_compileopts_info != 0) {
            goto lab_0x80a9942;
        } else {
            // 0x80a986c
            if (no_lynxcfg_xinfo != 0) {
                goto lab_0x80a9942;
            } else {
                // 0x80a987b
                fprintf(stream, "%s</pre><ul><li>", gettext("See also"));
                extra_cfg_link(stream, "LYNXCOMPILEOPTS:", gettext("compile time options"));
                fwrite((int32_t *)"<li>", 1, 4, stream);
                LYLocalFileToURL(&v2, (char *)lynx_lss_file);
                extra_cfg_link(stream, v2, gettext("color-style configuration"));
                fwrite((int32_t *)"</ul><pre>\n", 1, 11, stream);
                goto lab_0x80a99f7;
            }
        }
    }
  lab_0x80a9b21:
    // 0x80a9b21
    read_cfg((char *)lynx_cfg_file, "main program", 1, stream);
    fwrite((int32_t *)"</pre>\n", 1, 7, stream);
    EndInternalPage(stream);
    LYCloseTempFP(stream);
    LYRegisterUIPage((char *)lynxcfginfo_url, 6);
    v5 = lynxcfginfo_url;
    goto lab_0x80a9b94;
  lab_0x80a9942:
    // 0x80a9942
    fprintf(stream, "%s ", gettext("See also"));
    if (no_compileopts_info == 0) {
        // 0x80a9970
        extra_cfg_link(stream, "LYNXCOMPILEOPTS:", gettext("compile time options"));
    }
    // 0x80a9993
    if (no_lynxcfg_xinfo == 0) {
        // 0x80a999e
        LYLocalFileToURL(&v2, (char *)lynx_lss_file);
        extra_cfg_link(stream, v2, gettext("color-style configuration"));
    }
    // 0x80a99d4
    fwrite((int32_t *)"\n\n", 1, 2, stream);
    goto lab_0x80a99f7;
  lab_0x80a9b94:;
    int32_t v11 = v1 + 4; // 0x80a9b9d
    HTSACopy((char **)v11, (char *)v5);
    int32_t v12 = *(int32_t *)v11; // bp-44, 0x80a9bb2
    char v13 = HTLoadAbsolute(&v12); // 0x80a9bea
    int32_t result = 0; // 0x80a9bf1
    if (v13 != 0) {
        // 0x80a9bfc
        lynx_edit_mode = 0;
        result = 1;
    }
    // 0x80a9c0a
    return result;
  lab_0x80a99f7:
    // 0x80a99f7
    if (user_mode == 2) {
        // 0x80a9a01
        fprintf(stream, "  <a href=\"%s//reload\">%s</a>\n", "LYNXCFG:", gettext("RELOAD THE CHANGES"));
    }
    // 0x80a9a2c
    LYLocalFileToURL(&v2, (char *)lynx_cfg_file);
    HTSACopy(&temp, (char *)lynx_cfg_file);
    if (strchr((char *)lynx_cfg_file, 38) != NULL) {
        // 0x80a9a86
        LYEntify(&temp, 1);
        goto lab_0x80a9a99;
    } else {
        // 0x80a9a6d
        if (strchr((char *)lynx_cfg_file, 60) == NULL) {
            goto lab_0x80a9a99;
        } else {
            // 0x80a9a86
            LYEntify(&temp, 1);
            goto lab_0x80a9a99;
        }
    }
  lab_0x80a9569:
    // 0x80a9569
    LYpop(newdoc2);
    v12 = *str;
    LYforce_no_cache = 0;
    LYoverride_no_cache = 1;
    if (HTLoadAbsolute(&v12) == 0) {
        // 0x80a9c0a
        return 0;
    }
    // 0x80a95d5
    HTuncache_current_document();
    LYRegisterUIPage(NULL, 6);
    goto lab_0x80a95ee;
  lab_0x80a9a99:
    // 0x80a9a99
    fprintf(stream, "\n    #<em>%s <a href=\"%s\">%s</a></em>\n", gettext("Your primary configuration"), v2, temp);
    if (v2 != NULL) {
        // 0x80a9ad1
        free((int32_t *)v2);
        v2 = NULL;
    }
    // 0x80a9ae3
    if (temp != NULL) {
        // 0x80a9aea
        free((int32_t *)temp);
        temp = NULL;
    }
    goto lab_0x80a9b21;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYReadCFG.c
// Address range: 0x80a9c14 - 0x80a9eb4
// Line range:    2399 - 2472
int32_t lynx_compile_opts(int32_t * newdoc2) {
    int32_t v1 = configinfo_url;
    int32_t v2; // 0x80a9c14
    if (LYforce_no_cache == 0 || reloading == 0) {
        if (v1 == 0) {
            goto lab_0x80a9c98;
        } else {
            char v3 = LYCanReadFile((char *)&g129); // 0x80a9c62
            int32_t v4 = configinfo_url; // 0x80a9c6b
            if (v3 != 0 || v4 == 0) {
                // 0x80a9c8b
                v2 = v4;
                if (v4 != 0) {
                    goto lab_0x80a9e39;
                } else {
                    goto lab_0x80a9c98;
                }
            } else {
                // 0x80a9c74
                free((int32_t *)v4);
                configinfo_url = 0;
                goto lab_0x80a9c98;
            }
        }
    } else {
        if (v1 != 0) {
            // 0x80a9c39
            free((int32_t *)v1);
            configinfo_url = 0;
        }
        goto lab_0x80a9c98;
    }
  lab_0x80a9c98:;
    struct _IO_FILE * stream = InternalPageFP((char *)&g129, 1); // 0x80a9ca7
    if (stream == NULL) {
        // 0x80a9eaf
        return 0;
    }
    // 0x80a9cc1
    LYLocalFileToURL((char **)&configinfo_url, (char *)&g129);
    BeginInternalPage(stream, gettext("Configuration Definitions"), NULL);
    fwrite((int32_t *)"<pre>\n", 1, 6, stream);
    fprintf(stream, "\n%s<br>\n<em>config.cache</em>\n", gettext("The following data were derived during the automatic configuration/build\nprocess of this copy of Lynx.  When reporting a bug, please include a copy\nof this page."));
    int32_t v5 = 0; // 0x80a9c14
    int32_t v6 = 8 * v5; // 0x80a9d4a
    int32_t v7 = *(int32_t *)(v6 + (int32_t)&g40); // 0x80a9d4a
    int32_t v8 = *(int32_t *)(v6 + (int32_t)&g39); // 0x80a9d54
    fprintf(stream, "%-35s %s\n", (char *)v8, (char *)v7);
    int32_t v9 = v5 + 1; // 0x80a9d76
    v5 = v9;
    while (v9 != 282) {
        // 0x80a9d47
        v6 = 8 * v5;
        v7 = *(int32_t *)(v6 + (int32_t)&g40);
        v8 = *(int32_t *)(v6 + (int32_t)&g39);
        fprintf(stream, "%-35s %s\n", (char *)v8, (char *)v7);
        v9 = v5 + 1;
        v5 = v9;
    }
    // 0x80a9d83
    fprintf(stream, "\n%s<br>\n<em>lynx_cfg.h</em>\n", gettext("The following data were used as automatically-configured compile-time\ndefinitions when this copy of Lynx was built."));
    int32_t v10 = 0; // 0x80a9c14
    int32_t v11 = 8 * v10; // 0x80a9db2
    int32_t v12 = *(int32_t *)(v11 + (int32_t)&g38); // 0x80a9db2
    int32_t v13 = *(int32_t *)(v11 + (int32_t)&g37); // 0x80a9dbc
    fprintf(stream, "%-35s %s\n", (char *)v13, (char *)v12);
    int32_t v14 = v10 + 1; // 0x80a9dde
    v10 = v14;
    while (v14 != 184) {
        // 0x80a9daf
        v11 = 8 * v10;
        v12 = *(int32_t *)(v11 + (int32_t)&g38);
        v13 = *(int32_t *)(v11 + (int32_t)&g37);
        fprintf(stream, "%-35s %s\n", (char *)v13, (char *)v12);
        v14 = v10 + 1;
        v10 = v14;
    }
    // 0x80a9deb
    fwrite((int32_t *)"</pre>\n", 1, 7, stream);
    EndInternalPage(stream);
    LYCloseTempFP(stream);
    LYRegisterUIPage((char *)configinfo_url, 12);
    v2 = configinfo_url;
    goto lab_0x80a9e39;
  lab_0x80a9e39:;
    int32_t v15 = (int32_t)newdoc2 + 4; // 0x80a9e42
    HTSACopy((char **)v15, (char *)v2);
    int32_t v16 = *(int32_t *)v15; // bp-32, 0x80a9e57
    char v17 = HTLoadAbsolute(&v16); // 0x80a9e8f
    int32_t result = 0; // 0x80a9e96
    if (v17 != 0) {
        // 0x80a9ea1
        lynx_edit_mode = 0;
        result = 1;
    }
    // 0x80a9eaf
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYSearch.c
// Address range: 0x80a9eb4 - 0x80aa27d
// Line range:    13 - 102
char link_has_target(int32_t cur, char * target) {
    int32_t * a = NULL; // bp-16, 0x80a9ed4
    char * v1 = LYGetHiliteStr(cur, 0); // 0x80a9eef
    int32_t v2 = 0; // 0x80a9efb
    if (v1 != NULL) {
        char * v3; // 0x80a9eb4
        if (case_sensitive == 0) {
            // 0x80a9f22
            v3 = LYno_attr_char_case_strstr(v1, target);
        } else {
            // 0x80a9f08
            v3 = LYno_attr_char_strstr(v1, target);
        }
        while (v3 == NULL) {
            // 0x80a9f49
            v2++;
            char * v4 = LYGetHiliteStr(cur, v2); // 0x80a9eef
            if (v4 == NULL) {
                goto lab_0x80a9f4f;
            }
            char * v5 = v4;
            if (case_sensitive == 0) {
                // 0x80a9f22
                v3 = LYno_attr_char_case_strstr(v5, target);
            } else {
                // 0x80a9f08
                v3 = LYno_attr_char_strstr(v5, target);
            }
        }
        // 0x80aa277
        return 1;
    }
  lab_0x80a9f4f:;
    int32_t * v6 = (int32_t *)(68 * cur + (int32_t)&links + 64); // 0x80a9f52
    int32_t v7 = *v6; // 0x80a9f52
    if (v7 == 0) {
        // 0x80aa277
        return 0;
    }
    int32_t v8 = *(int32_t *)(v7 + 12); // 0x80a9f63
    if (v8 == 0) {
        // 0x80aa277
        return 0;
    }
    int32_t v9 = *(int32_t *)(v7 + 8); // 0x80a9f74
    if (v9 == 8) {
        // 0x80aa277
        return 0;
    }
    if (v9 == 2) {
        char * v10 = (char *)v8;
        char * v11; // 0x80a9eb4
        if (case_sensitive == 0) {
            // 0x80a9fbd
            v11 = LYno_attr_char_case_strstr(v10, target);
        } else {
            // 0x80a9f9d
            v11 = LYno_attr_char_strstr(v10, target);
        }
        // 0x80a9fdb
        if (v11 != NULL) {
            // 0x80aa277
            return 1;
        }
        // 0x80a9fea
        HTSACopy((char **)&a, (char *)*(int32_t *)(*v6 + 12));
        memset(a, 42, strlen((char *)a));
        int32_t * v12 = a;
        char * v13; // 0x80a9eb4
        if (case_sensitive == 0) {
            // 0x80aa049
            v13 = LYno_attr_char_case_strstr((char *)v12, target);
        } else {
            // 0x80aa02f
            v13 = LYno_attr_char_strstr((char *)v12, target);
        }
        int32_t * v14 = a;
        if (v13 == NULL) {
            if (v14 != NULL) {
                // 0x80aa094
                free(v14);
                a = NULL;
            }
            // 0x80aa277
            return 0;
        }
        // 0x80aa067
        if (v14 != NULL) {
            // 0x80aa06e
            free(v14);
            a = NULL;
        }
        // 0x80aa277
        return 1;
    }
    if (v9 == 7) {
        int32_t v15 = *(int32_t *)(v7 + 44);
        if (v15 == 0) {
            // 0x80aa277
            return 0;
        }
        int32_t v16 = v15; // 0x80aa124
        char * v17 = (char *)*(int32_t *)v16;
        char * v18; // 0x80a9eb4
        if (case_sensitive == 0) {
            // 0x80aa0ee
            v18 = LYno_attr_char_case_strstr(v17, target);
        } else {
            // 0x80aa0d2
            v18 = LYno_attr_char_strstr(v17, target);
        }
        while (v18 == NULL) {
            // 0x80aa120
            v16 += 12;
            if (v16 == 0) {
                // 0x80aa277
                return 0;
            }
            v17 = (char *)*(int32_t *)v16;
            if (case_sensitive == 0) {
                // 0x80aa0ee
                v18 = LYno_attr_char_case_strstr(v17, target);
            } else {
                // 0x80aa0d2
                v18 = LYno_attr_char_strstr(v17, target);
            }
        }
        // 0x80aa277
        return 1;
    }
    if (v9 == 4) {
        char * v19 = *(int32_t *)(v7 + 32) == 0 ? unchecked_radio : checked_radio;
        char * v20; // 0x80a9eb4
        if (case_sensitive == 0) {
            // 0x80aa17d
            v20 = LYno_attr_char_case_strstr(v19, target);
        } else {
            // 0x80aa163
            v20 = LYno_attr_char_strstr(v19, target);
        }
        // 0x80aa195
        if (v20 == NULL) {
            // 0x80aa277
            return 0;
        }
        // 0x80aa277
        return 1;
    }
    if (v9 != 3) {
        char * v21 = (char *)v8;
        char * v22; // 0x80a9eb4
        if (case_sensitive == 0) {
            // 0x80aa249
            v22 = LYno_attr_char_case_strstr(v21, target);
        } else {
            // 0x80aa229
            v22 = LYno_attr_char_strstr(v21, target);
        }
        // 0x80aa267
        if (v22 == NULL) {
            // 0x80aa277
            return 0;
        }
    } else {
        char * v23 = *(int32_t *)(v7 + 32) == 0 ? unchecked_box : checked_box;
        char * v24; // 0x80a9eb4
        if (case_sensitive == 0) {
            // 0x80aa1fa
            v24 = LYno_attr_char_case_strstr(v23, target);
        } else {
            // 0x80aa1e0
            v24 = LYno_attr_char_strstr(v23, target);
        }
        // 0x80aa212
        if (v24 == NULL) {
            // 0x80aa277
            return 0;
        }
    }
    // 0x80aa277
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYSearch.c
// Address range: 0x80aa27d - 0x80aa2da
// Line range:    113 - 125
int32_t check_next_target_in_links(int32_t * cur, char * target) {
    uint32_t v1 = nlinks; // 0x80aa283
    if (v1 == 0) {
        // 0x80aa2d5
        return 0;
    }
    int32_t v2 = *cur + 1;
    if (v2 >= v1) {
        // 0x80aa2d5
        return 0;
    }
    int32_t v3 = v2;
    while (link_has_target(v3, target) == 0) {
        int32_t v4 = v3 + 1;
        if (v4 >= nlinks) {
            // 0x80aa2d5
            return 0;
        }
        v3 = v4;
    }
    // 0x80aa2af
    *cur = v3;
    // 0x80aa2d5
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYSearch.c
// Address range: 0x80aa2da - 0x80aa333
// Line range:    129 - 141
int32_t check_prev_target_in_links(int32_t * cur, char * target) {
    // 0x80aa2da
    if (nlinks == 0) {
        // 0x80aa32e
        return 0;
    }
    int32_t v1 = *cur; // 0x80aa2f4
    v1--;
    int32_t result = 0; // 0x80aa325
    while (v1 >= 0) {
        // 0x80aa2f6
        if (link_has_target(v1, target) != 0) {
            // 0x80aa30c
            *cur = v1;
            result = 1;
            return result;
        }
        v1--;
        result = 0;
    }
  lab_0x80aa32e:
    // 0x80aa32e
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYSearch.c
// Address range: 0x80aa333 - 0x80aa967
// Line range:    155 - 370
char textsearch(int32_t * cur_doc, char * prev_target2, int32_t target_size, int32_t direction) {
    int32_t v1 = (int32_t)cur_doc;
    int32_t * v2 = (int32_t *)(v1 + 24); // 0x80aa33c
    int32_t v3 = *v2; // 0x80aa33c
    if (g130 != 0) {
        // 0x80aa358
        *(char *)&g293 = 0;
        g130 = 0;
    }
    int32_t v4 = 0; // 0x80aa36d
    if (search_queries != NULL) {
        // 0x80aa36f
        v4 = HTList_count(search_queries);
    }
    int32_t v5 = v4;
    if (direction != 0) {
        // 0x80aa3a7
        LYstrncpy(prev_target2, (char *)&g293, target_size);
    }
    int32_t v6 = v5 >= 0 == (v5 != 0); // 0x80aa392
    int32_t v7 = 0; // 0x80aa3c9
    char result; // 0x80aa333
    if (*prev_target2 == 0) {
        // 0x80aa3cb
        mustshow = 1;
        statusline(gettext("Enter a whereis query: "));
        v7 = LYgetstr(prev_target2, 0, target_size, v6);
        if (v7 < 0) {
            // 0x80aa410
            LYstrncpy(prev_target2, (char *)&g293, target_size);
            HTInfoMsg(gettext("Cancelled!!!"));
            result = 0;
          lab_0x80aa961:
            // 0x80aa961
            return result;
        }
    }
    int32_t v8 = v5 - 1;
    char v9 = 1; // 0x80aa333
    int32_t v10 = v5; // 0x80aa333
    int32_t v11 = v7; // 0x80aa333
    char v12; // 0x80aa333
    char v13; // 0x80aa333
    int32_t v14; // 0x80aa333
    int32_t v15; // 0x80aa333
    while (true) {
      lab_0x80aa447_2:;
        int32_t v16 = v11;
        int32_t v17 = v10;
        char v18 = v9;
        if (*prev_target2 == 0) {
            if (v5 >= 0 == (v5 != 0) != ((v16 || 1) == 257)) {
                // break -> 0x80aa469
                break;
            }
        }
        if (v5 >= 0 == (v5 != 0) == v16 == 256) {
            int32_t v19; // 0x80aa333
            if (v18 == 0) {
                // 0x80aa506
                v19 = v17 + 1;
            } else {
                char v20 = *(char *)&g293; // 0x80aa4a7
                v19 = v20 == 0 ? 0 : v8;
                if (v8 >= 0 == (v8 != 0) && v20 != 0) {
                    char * str = HTList_objectAt(search_queries, v8); // 0x80aa4cc
                    if (str != NULL) {
                        // 0x80aa4da
                        if (strcmp((char *)&g293, str) == 0) {
                            // break -> 0x80aa50a
                            break;
                        }
                    }
                    int32_t v21 = v8 - 1;
                    v19 = v21;
                    while (v21 >= 0 == (v21 != 0)) {
                        int32_t v22 = v21;
                        str = HTList_objectAt(search_queries, v22);
                        if (str != NULL) {
                            int32_t strcmp_rc = strcmp((char *)&g293, str); // 0x80aa4e8
                            v19 = v22;
                            if (strcmp_rc == 0) {
                                // break -> 0x80aa50a
                                break;
                            }
                        }
                        // 0x80aa4f1
                        v21 = v22 - 1;
                        v19 = v21;
                    }
                }
            }
            int32_t v23 = v19;
            v14 = v23 < v5 ? v23 : 0;
            char * v24 = HTList_objectAt(search_queries, v14); // 0x80aa528
            if (v24 == NULL) {
                goto lab_0x80aa821_3;
            }
            // 0x80aa53a
            LYstrncpy(prev_target2, v24, target_size);
            v12 = 0;
            if (*(char *)&g293 == 0) {
                goto lab_0x80aa5a3;
            } else {
                // 0x80aa55e
                if (strcmp((char *)&g293, prev_target2) != 0) {
                    char v25 = *(char *)&g293;
                    v12 = v25;
                    if (v5 == 2 == (v25 != 0)) {
                        goto lab_0x80aa5b4;
                    } else {
                        goto lab_0x80aa5a3;
                    }
                } else {
                    // 0x80aa575
                    mustshow = 1;
                    statusline(gettext("Edit the current query: "));
                    goto lab_0x80aa5ec;
                }
            }
        } else {
            if (v5 >= 0 == (v5 != 0) != (v16 == 257)) {
                goto lab_0x80aa821_3;
            }
            int32_t v26; // 0x80aa333
            if (v18 == 0) {
                // 0x80aa6d6
                v26 = v17 - 1;
            } else {
                char v27 = *(char *)&g293; // 0x80aa672
                v26 = v27 == 0 ? v8 : 0;
                if (v8 >= 1 && v27 != 0) {
                    int32_t v28 = 0;
                    char * str2 = HTList_objectAt(search_queries, v28); // 0x80aa695
                    if (str2 != NULL) {
                        // 0x80aa6a3
                        if (strcmp((char *)&g293, str2) == 0) {
                            // break -> 0x80aa6da
                            break;
                        }
                    }
                    int32_t v29 = v28 + 1; // 0x80aa6ba
                    v26 = v29;
                    while (v8 > v29) {
                        // 0x80aa686
                        v28 = v29;
                        str2 = HTList_objectAt(search_queries, v28);
                        if (str2 != NULL) {
                            int32_t strcmp_rc2 = strcmp((char *)&g293, str2); // 0x80aa6b1
                            v26 = v28;
                            if (strcmp_rc2 == 0) {
                                // break -> 0x80aa6da
                                break;
                            }
                        }
                        // 0x80aa6ba
                        v29 = v28 + 1;
                        v26 = v29;
                    }
                }
            }
            int32_t v30 = v26;
            v15 = v30 >= 0 ? v30 : v8;
            char * v31 = HTList_objectAt(search_queries, v15); // 0x80aa6f8
            if (v31 == NULL) {
                goto lab_0x80aa821_3;
            }
            // 0x80aa70a
            LYstrncpy(prev_target2, v31, target_size);
            v13 = 0;
            if (*(char *)&g293 == 0) {
                goto lab_0x80aa773;
            } else {
                // 0x80aa72e
                if (strcmp((char *)&g293, prev_target2) != 0) {
                    char v32 = *(char *)&g293;
                    v13 = v32;
                    if (v5 == 2 == (v32 != 0)) {
                        goto lab_0x80aa784;
                    } else {
                        goto lab_0x80aa773;
                    }
                } else {
                    // 0x80aa745
                    mustshow = 1;
                    statusline(gettext("Edit the current query: "));
                    goto lab_0x80aa7bc;
                }
            }
        }
    }
    // 0x80aa469
    HTInfoMsg(gettext("Cancelled!!!"));
    // 0x80aa961
    return 0;
  lab_0x80aa821_3:
    // 0x80aa821
    LYstrncpy((char *)&g293, prev_target2, 511);
    HTAddSearchQuery((char *)&g293);
    int32_t v33; // 0x80aa333
    if (direction >= 0) {
        // 0x80aa895
        if (check_next_target_in_links(v2, prev_target2) == 0) {
            // 0x80aa8d1
            if (nlinks != 0) {
                int32_t v34 = *(int32_t *)(68 * *v2 + (int32_t)&g346); // 0x80aa8f7
                v33 = v34 - 1;
                goto lab_0x80aa903;
            } else {
                // 0x80aa8da
                v33 = display_lines - 1;
                goto lab_0x80aa903;
            }
        } else {
            // 0x80aa8ae
            LYhighlight(0, v3, prev_target2);
            result = 1;
            return result;
        }
    } else {
        // 0x80aa84e
        v33 = 0;
        if (check_prev_target_in_links(v2, prev_target2) == 0) {
            goto lab_0x80aa903;
        } else {
            // 0x80aa872
            LYhighlight(0, v3, prev_target2);
            result = 1;
            return result;
        }
    }
  lab_0x80aa5a3:
    // 0x80aa5a3
    if (v5 == 1 == v12 == 0) {
        goto lab_0x80aa5b4;
    } else {
        // 0x80aa5d1
        mustshow = 1;
        statusline(gettext("Edit a previous query: "));
        goto lab_0x80aa5ec;
    }
  lab_0x80aa773:
    // 0x80aa773
    if (v5 == 1 == v13 == 0) {
        goto lab_0x80aa784;
    } else {
        // 0x80aa7a1
        mustshow = 1;
        statusline(gettext("Edit a previous query: "));
        goto lab_0x80aa7bc;
    }
  lab_0x80aa5b4:
    // 0x80aa5b4
    mustshow = 1;
    statusline(gettext("Edit the previous query: "));
    goto lab_0x80aa5ec;
  lab_0x80aa784:
    // 0x80aa784
    mustshow = 1;
    statusline(gettext("Edit the previous query: "));
    goto lab_0x80aa7bc;
  lab_0x80aa5ec:;
    int32_t v35 = LYgetstr(prev_target2, 0, target_size, v6); // 0x80aa608
    v10 = v14;
    v11 = v35;
    if (v35 < 0) {
        // 0x80aa61a
        LYstrncpy(prev_target2, (char *)&g293, target_size);
        HTInfoMsg(gettext("Cancelled!!!"));
        result = 0;
        goto lab_0x80aa961;
    }
    goto lab_0x80aa447;
  lab_0x80aa7bc:;
    int32_t v37 = LYgetstr(prev_target2, 0, target_size, v6); // 0x80aa7d8
    v10 = v15;
    v11 = v37;
    if (v37 < 0) {
        // 0x80aa7ea
        LYstrncpy(prev_target2, (char *)&g293, target_size);
        HTInfoMsg(gettext("Cancelled!!!"));
        result = 0;
        goto lab_0x80aa961;
    }
    goto lab_0x80aa447;
  lab_0x80aa447:
    // 0x80aa447
    v9 = 0;
    goto lab_0x80aa447_2;
  lab_0x80aa903:
    // 0x80aa903
    www_user_search(*(int32_t *)(v1 + 28) + v33, cur_doc, prev_target2, direction);
    if (*v2 == v3) {
        int32_t v36 = www_search_result; // 0x80aa956
        result = v36 >= 0 == (v36 != 0);
        goto lab_0x80aa961;
    } else {
        // 0x80aa936
        LYhighlight(0, v3, prev_target2);
        result = 1;
        goto lab_0x80aa961;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80aa968 - 0x80aa9e5
// Line range:    83 - 89
void trace_history(char * tag) {
    // 0x80aa968
    if (WWW_TraceFlag == 0) {
        // 0x80aa9dd
        return;
    }
    // 0x80aa987
    fprintf(TraceFP(), "HISTORY %s %d/%d (%d extra)\n", tag, nhist, size_history, nhist_extra);
    if (WWW_TraceFlag != 0) {
        // 0x80aa9d0
        fflush(TraceFP());
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80aa9e5 - 0x80aaffc
// Line range:    99 - 224
void LYAddVisitedLink(int32_t * doc) {
    int32_t v1 = *doc; // 0x80aa9ee
    int32_t v2 = v1; // 0x80aa9f2
    if (v1 == 0) {
        // 0x80aa9fe
        v2 = (int32_t)gettext("(No title.)");
    }
    int32_t v3 = (int32_t)doc;
    int32_t * str2 = (int32_t *)(v3 + 4); // 0x80aaa16
    int32_t v4 = *str2; // 0x80aaa16
    if (v4 == 0) {
        // 0x80aaa2a
        *(int32_t *)&PrevVisitedLink = 0;
        // 0x80aaffa
        return;
    }
    char * str = (char *)v4; // 0x80aaa23
    if (*str == 0) {
        // 0x80aaa2a
        *(int32_t *)&PrevVisitedLink = 0;
        // 0x80aaffa
        return;
    }
    // 0x80aaa39
    if (*(int32_t *)(v3 + 8) != 0) {
        goto lab_0x80aaaa0;
    } else {
        // 0x80aaa43
        if (*(char *)(v3 + 20) != 0) {
            goto lab_0x80aaaa0;
        } else {
            // 0x80aaa4e
            if (*(int32_t *)(v3 + 16) != 0) {
                goto lab_0x80aaaa0;
            } else {
                // 0x80aaa58
                if (strncmp(str, "LYNX", 4) == 0) {
                    goto lab_0x80aaaa0;
                } else {
                    // 0x80aaa7a
                    if (strncmp((char *)*str2, "file://localhost/", 17) != 0) {
                        goto lab_0x80aad21;
                    } else {
                        goto lab_0x80aaaa0;
                    }
                }
            }
        }
    }
  lab_0x80aaaa0:
    // 0x80aaaa0
    if (LYIsUIPage3((char *)*str2, 0, 1) != 0 || LYIsUIPage3((char *)*str2, 5, 1) != 0 || LYIsUIPage3((char *)*str2, 3, 1) != 0 || strncasecomp((char *)*str2, "LYNXMESSAGES:", 13) == 0) {
        // 0x80aaffa
        return;
    }
    // 0x80aab3f
    if (LYIsUIPage3((char *)*str2, 8, 1) != 0 || LYIsUIPage3((char *)*str2, 10, 1) != 0 || LYIsUIPage3((char *)*str2, 9, 1) != 0 || LYIsUIPage3((char *)*str2, 2, 1) != 0 || LYIsUIPage3((char *)*str2, 1, 1) != 0 || LYIsUIPage3((char *)*str2, 7, 1) != 0 || strncasecomp((char *)*str2, "LYNXKEYMAP:", 11) == 0 || LYIsUIPage3((char *)*str2, 4, 1) != 0 || LYIsUIPage3((char *)*str2, 12, 1) != 0 || LYIsUIPage3((char *)*str2, 6, 1) != 0 || strncasecomp((char *)*str2, "LYNXCOOKIE:", 11) == 0 || LYIsUIPage3((char *)*str2, 13, 1) != 0) {
        // 0x80aad12
        *(int32_t *)&PrevVisitedLink = 0;
        // 0x80aaffa
        return;
    }
    goto lab_0x80aad21;
  lab_0x80aad21:;
    int32_t v5 = (int32_t)Visited_Links; // 0x80aad28
    if (Visited_Links == NULL) {
        int32_t v6 = (int32_t)HTList_new(); // 0x80aad2a
        *(int32_t *)&Visited_Links = v6;
        g297 = &Latest_first;
        g296 = &Latest_last;
        g298 = 0;
        g295 = 0;
        *(int32_t *)&First_tree = 0;
        *(int32_t *)&Latest_tree = 0;
        *(int32_t *)&Last_by_first = 0;
        v5 = v6;
    }
    // 0x80aad7a
    if (v5 != 0) {
        int32_t v7 = *(int32_t *)((int32_t)(int32_t *)v5 + 4); // 0x80aae4e
        while (v7 != 0) {
            int32_t * v8 = (int32_t *)v7; // 0x80aae51
            int32_t v9 = *v8; // 0x80aae5d
            if (v9 == 0) {
                // break -> 0x80aae7b
                break;
            }
            int32_t v10 = *str2; // 0x80aad8a
            int32_t str4 = v10 == 0 ? (int32_t)&g41 : v10;
            int32_t v11 = *(int32_t *)(v9 + 4); // 0x80aada6
            int32_t str3 = v11 == 0 ? (int32_t)&g41 : v11;
            if (strcmp((char *)str3, (char *)str4) == 0) {
                // 0x80aadd5
                *(int32_t *)&PrevActiveVisitedLink = v9;
                *(int32_t *)&PrevVisitedLink = v9;
                int32_t * v12 = (int32_t *)(v9 + 20); // 0x80aadea
                int32_t v13 = *v12; // 0x80aadea
                if (v13 == (int32_t)&Latest_last) {
                    goto lab_0x80aaffa;
                } else {
                    int32_t * v14 = (int32_t *)(v9 + 16); // 0x80aadfb
                    *(int32_t *)(*v14 + 20) = v13;
                    *(int32_t *)(*v12 + 16) = *v14;
                    *(int32_t *)(g297 + 20) = v9;
                    *v14 = g297;
                    *v12 = (int32_t)&Latest_last;
                    g297 = v9;
                    goto lab_0x80aaffa;
                }
            }
            v7 = *(int32_t *)((int32_t)v8 + 4);
        }
    }
    int32_t * mem = calloc(1, 28); // 0x80aae8a
    if (mem == NULL) {
        // 0x80aae98
        outofmem("./LYHistory.c", "LYAddVisitedLink");
        // UNREACHABLE
    }
    int32_t v15 = (int32_t)mem; // 0x80aaeb2
    HTSACopy((char **)(v15 + 4), (char *)*str2);
    LYformTitle((char **)mem, (char *)v2);
    HTList_appendObject(Visited_Links, (char *)mem);
    *(int32_t *)(v15 + 24) = (int32_t)Last_by_first;
    *(int32_t *)&Last_by_first = v15;
    char * v16; // 0x80aa9e5
    char * v17; // 0x80aa9e5
    if (PrevVisitedLink == NULL) {
        // 0x80aaf7c
        if (Latest_tree != NULL) {
            // 0x80aaf85
            g299 = v15;
        }
        // 0x80aaf91
        *(int32_t *)(v15 + 8) = 0;
        *(int32_t *)(v15 + 12) = 0;
        *(int32_t *)&Latest_tree = v15;
        goto lab_0x80aafad;
    } else {
        // 0x80aaf08
        v17 = (char *)PrevVisitedLink;
        if (Latest_first == 0) {
            goto lab_0x80aaffa;
        } else {
            int32_t v18 = (int32_t)g294;
            v16 = (char *)PrevVisitedLink;
            if (*(int32_t *)(Latest_first + 8) > v18) {
                int32_t v19 = Latest_first;
                int32_t v20 = *(int32_t *)(v19 + 12); // 0x80aaf2f
                while (v20 != 0) {
                    // 0x80aaf3b
                    if (*(int32_t *)(v20 + 8) <= v18) {
                        // 0x80aaf3b
                        v16 = (char *)v19;
                        goto lab_0x80aaf54;
                    }
                    v19 = v20;
                    v20 = *(int32_t *)(v19 + 12);
                }
                // 0x80aaf4c
                v17 = (char *)v19;
                goto lab_0x80aaffa;
            } else {
                goto lab_0x80aaf54;
            }
        }
    }
  lab_0x80aafad:
    // 0x80aafad
    *(int32_t *)&PrevActiveVisitedLink = v15;
    *(int32_t *)&PrevVisitedLink = v15;
    if (First_tree == NULL) {
        // 0x80aafc8
        *(int32_t *)&First_tree = v15;
    }
    // 0x80aafd0
    *(int32_t *)(g297 + 20) = v15;
    *(int32_t *)(v15 + 16) = g297;
    *(int32_t *)(v15 + 20) = (int32_t)&Latest_last;
    g297 = v15;
  lab_0x80aaffa:
    // 0x80aaf4c
    *(int32_t *)&Latest_tree = v15;
    v16 = v17;
    goto lab_0x80aaf54;
  lab_0x80aaf54:;
    int32_t * v21 = (int32_t *)((int32_t)v16 + 12); // 0x80aaf57
    *(int32_t *)(v15 + 12) = *v21;
    *v21 = v15;
    *(int32_t *)(v15 + 8) = (int32_t)g294 + 1;
    goto lab_0x80aafad;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80aaffc - 0x80ab1ed
// Line range:    233 - 276
char LYwouldPush(char * title, char * docurl) {
    if (docurl == NULL) {
        // 0x80ab12a
        if (strcmp(title, gettext("History Page")) == 0 || strcmp(title, gettext("Printing Options")) == 0 || strcmp(title, gettext("File Management Options")) == 0 || strcmp(title, gettext("Upload Options")) == 0 || strcmp(title, gettext("File Permission Options")) == 0) {
            // 0x80ab1e7
            return 0;
        }
        // 0x80ab1e7
        return 1;
    }
    // 0x80ab00c
    if (strncmp(docurl, "file://localhost/", 17) != 0) {
        // 0x80ab1e7
        return 1;
    }
    uint32_t len = strlen(docurl); // 0x80ab031
    if (len < 6 || strcmp((char *)((int32_t)docurl - 5 + len), ".html") != 0) {
        // 0x80ab1e7
        return 1;
    }
    // 0x80ab06f
    if (LYIsUIPage3(docurl, 0, 1) != 0 || LYIsUIPage3(docurl, 2, 1) != 0 || LYIsUIPage3(docurl, 8, 1) != 0 || LYIsUIPage3(docurl, 10, 1) != 0 || LYIsUIPage3(docurl, 9, 1) != 0) {
        // 0x80ab1e7
        return 0;
    }
    // 0x80ab1e7
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ab1ed - 0x80ab225
// Line range:    282 - 285
void LYFreePostData(int32_t * doc) {
    int32_t v1 = (int32_t)doc;
    HTSABFree((int32_t **)(v1 + 8));
    int32_t * v2 = (int32_t *)(v1 + 12); // 0x80ab204
    int32_t v3 = *v2; // 0x80ab204
    if (v3 != 0) {
        // 0x80ab20b
        free((int32_t *)v3);
        *v2 = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ab225 - 0x80ab29b
// Line range:    291 - 296
void LYFreeDocInfo(int32_t * doc) {
    int32_t v1 = *doc; // 0x80ab22e
    if (v1 != 0) {
        // 0x80ab234
        free((int32_t *)v1);
        *doc = 0;
    }
    int32_t v2 = (int32_t)doc;
    int32_t * v3 = (int32_t *)(v2 + 4); // 0x80ab24d
    int32_t v4 = *v3; // 0x80ab24d
    if (v4 != 0) {
        // 0x80ab254
        free((int32_t *)v4);
        *v3 = 0;
    }
    int32_t * v5 = (int32_t *)(v2 + 16); // 0x80ab26f
    int32_t v6 = *v5; // 0x80ab26f
    if (v6 != 0) {
        // 0x80ab276
        free((int32_t *)v6);
        *v5 = 0;
    }
    // 0x80ab28e
    LYFreePostData(doc);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ab29b - 0x80ab30b
// Line range:    302 - 311
void clean_extra_history(void) {
    // 0x80ab29b
    trace_history("clean_extra_history");
    int32_t v1 = nhist_extra;
    int32_t v2 = v1 + nhist; // 0x80ab2b8
    nhist = v2;
    if (v1 >= 0 != v1 != 0) {
        // 0x80ab2fd
        trace_history("...clean_extra_history");
        return;
    }
    int32_t v3 = v2 - 1; // 0x80ab2c6
    nhist = v3;
    LYFreeDocInfo((int32_t *)(44 * v3 + (int32_t)history));
    int32_t v4 = nhist_extra - 1; // 0x80ab2ec
    nhist_extra = v4;
    if (v4 >= 0 != v4 != 0) {
        // 0x80ab2fd
        trace_history("...clean_extra_history");
        return;
    }
    int32_t v5 = nhist - 1; // 0x80ab2c6
    nhist = v5;
    LYFreeDocInfo((int32_t *)(44 * v5 + (int32_t)history));
    int32_t v6 = nhist_extra - 1; // 0x80ab2ec
    nhist_extra = v6;
    while (v6 >= 0 == (v6 != 0)) {
        // 0x80ab2c1
        v5 = nhist - 1;
        nhist = v5;
        LYFreeDocInfo((int32_t *)(44 * v5 + (int32_t)history));
        v6 = nhist_extra - 1;
        nhist_extra = v6;
    }
    // 0x80ab2fd
    trace_history("...clean_extra_history");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ab30b - 0x80ab3c2
// Line range:    331 - 337
int32_t are_identical(int32_t * doc, int32_t * doc1) {
    int32_t v1 = (int32_t)doc1;
    int32_t v2 = (int32_t)doc;
    int32_t str = *(int32_t *)(v1 + 4); // 0x80ab31a
    if (strcmp((char *)str, (char *)*(int32_t *)(v2 + 4)) != 0) {
        // 0x80ab3bd
        return 0;
    }
    int32_t v3 = *(int32_t *)(v1 + 8); // 0x80ab33a
    if (HTSABEql((int32_t *)v3, (int32_t *)*(int32_t *)(v2 + 8)) == 0) {
        // 0x80ab3bd
        return 0;
    }
    int32_t v4 = *(int32_t *)(v2 + 16); // 0x80ab350
    int32_t str3 = v4 == 0 ? (int32_t)&g41 : v4;
    int32_t v5 = *(int32_t *)(v1 + 16); // 0x80ab36c
    int32_t str2 = v5 == 0 ? (int32_t)&g41 : v5;
    if (strcmp((char *)str2, (char *)str3) != 0) {
        // 0x80ab3bd
        return 0;
    }
    // 0x80ab39b
    if (*(char *)(v1 + 20) == *(char *)(v2 + 20)) {
        // 0x80ab3bd
        return 1;
    }
    // 0x80ab3bd
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ab3c2 - 0x80ab4f5
// Line range:    340 - 360
void LYAllocHistory(int32_t entries) {
    // 0x80ab3c2
    if (WWW_TraceFlag != 0) {
        // 0x80ab3d4
        fprintf(TraceFP(), "LYAllocHistory %d vs %d\n", entries, size_history);
    }
    int32_t v1 = size_history; // 0x80ab404
    int32_t v2 = v1; // 0x80ab40b
    if (entries + 1 >= v1) {
        int32_t v3 = 2 * entries + 4; // 0x80ab41f
        size_history = v3;
        int32_t size = 44 * v3; // 0x80ab42b
        int32_t * mem; // 0x80ab3c2
        if (history != NULL) {
            // 0x80ab44c
            mem = realloc(history, size);
        } else {
            // 0x80ab43a
            mem = malloc(size);
        }
        int32_t v4 = (int32_t)mem;
        *(int32_t *)&history = v4;
        if (mem == NULL) {
            // 0x80ab46f
            outofmem("./LYHistory.c", "LYAllocHistory");
            // UNREACHABLE
        }
        // 0x80ab4b0
        v2 = size_history;
        if (v1 < size_history) {
            int32_t v5 = v1 + 1; // 0x80ab494
            memset((int32_t *)(44 * v1 + v4), 0, 44);
            v2 = size_history;
            if (v5 < size_history) {
                int32_t v6 = v5 + 1; // 0x80ab494
                memset((int32_t *)(44 * v5 + (int32_t)history), 0, 44);
                int32_t v7 = v6; // 0x80ab4b8
                v2 = size_history;
                while (v6 < size_history) {
                    // 0x80ab485
                    v6 = v7 + 1;
                    memset((int32_t *)(44 * v7 + (int32_t)history), 0, 44);
                    v7 = v6;
                    v2 = size_history;
                }
            }
        }
    }
    // 0x80ab4ba
    if (WWW_TraceFlag != 0) {
        // 0x80ab4c5
        fprintf(TraceFP(), "...LYAllocHistory %d vs %d\n", entries, v2);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ab4f5 - 0x80abccf
// Line range:    366 - 540
int32_t LYpush(int32_t * doc, char force_push) {
    int32_t v1 = (int32_t)doc;
    int32_t * v2 = (int32_t *)(v1 + 4); // 0x80ab507
    char * v3 = (char *)*v2; // 0x80ab50a
    if (*v3 == 0) {
        // 0x80abcc4
        return 0;
    }
    if (force_push == 0) {
        // 0x80ab523
        if (LYwouldPush((char *)*doc, v3) == 0) {
            // 0x80ab53e
            if (LYforce_no_cache == 0) {
                // 0x80ab549
                LYoverride_no_cache = 1;
            }
            // 0x80abcc4
            return 0;
        }
    }
    uint32_t v4 = nhist; // 0x80ab55c
    if (v4 >= 1) {
        // 0x80ab569
        if (are_identical((int32_t *)(44 * v4 - 44 + (int32_t)history), doc) != 0) {
            int32_t v5 = (int32_t)history - 44 + 44 * nhist; // 0x80ab5a0
            if (*(char *)(v5 + 32) == *(char *)(v1 + 32)) {
                // 0x80ab5b2
                *(int32_t *)(v5 + 24) = *(int32_t *)(v1 + 24);
                int32_t v6 = *(int32_t *)(v1 + 28); // 0x80ab5e4
                *(int32_t *)((int32_t)history - 16 + 44 * nhist) = v6;
                // 0x80abcc4
                return 0;
            }
        }
    }
    // 0x80ab5f6
    if (nhist_extra >= 1) {
        // 0x80ab603
        if (are_identical((int32_t *)(44 * nhist + (int32_t)history), doc) != 0) {
            int32_t v7 = *(int32_t *)(v1 + 24); // 0x80ab639
            *(int32_t *)((int32_t)history + 24 + 44 * nhist) = v7;
            int32_t v8 = *(int32_t *)(v1 + 28); // 0x80ab652
            *(int32_t *)((int32_t)history + 28 + 44 * nhist) = v8;
            nhist_extra--;
            LYAllocHistory(nhist);
            nhist++;
            trace_history("LYpush: just move the cursor");
            // 0x80abcc4
            return 1;
        }
    }
    // 0x80ab697
    clean_extra_history();
    LYAllocHistory(nhist);
    int32_t v9 = *(int32_t *)(v1 + 24); // 0x80ab6bc
    *(int32_t *)((int32_t)history + 24 + 44 * nhist) = v9;
    int32_t v10 = *(int32_t *)(v1 + 28); // 0x80ab6d5
    *(int32_t *)((int32_t)history + 28 + 44 * nhist) = v10;
    *(int32_t *)(44 * nhist + (int32_t)history) = 0;
    LYformTitle((char **)(44 * nhist + (int32_t)history), (char *)*doc);
    *(int32_t *)((int32_t)history + 4 + 44 * nhist) = 0;
    HTSACopy((char **)((int32_t)history + 4 + 44 * nhist), (char *)*v2);
    *(int32_t *)((int32_t)history + 8 + 44 * nhist) = 0;
    int32_t v11 = *(int32_t *)(v1 + 8);
    int32_t v12 = 0; // 0x80ab772
    char * v13 = NULL; // 0x80ab772
    if (v11 != 0) {
        // 0x80ab793
        v12 = *(int32_t *)(v11 + 4);
        v13 = (char *)*(int32_t *)v11;
    }
    // 0x80ab7a7
    HTSABCopy((int32_t **)((int32_t)history + 8 + 44 * nhist), v13, v12);
    *(int32_t *)((int32_t)history + 12 + 44 * nhist) = 0;
    int32_t v14 = *(int32_t *)(v1 + 12); // 0x80ab7ec
    HTSACopy((char **)((int32_t)history + 12 + 44 * nhist), (char *)v14);
    *(int32_t *)((int32_t)history + 16 + 44 * nhist) = 0;
    int32_t v15 = *(int32_t *)(v1 + 16); // 0x80ab82a
    HTSACopy((char **)((int32_t)history + 16 + 44 * nhist), (char *)v15);
    char v16 = *(char *)(v1 + 20); // 0x80ab860
    *(char *)((int32_t)history + 20 + 44 * nhist) = v16;
    char v17 = *(char *)(v1 + 21); // 0x80ab87a
    *(char *)((int32_t)history + 21 + 44 * nhist) = v17;
    *(char *)((int32_t)history + 32 + 44 * nhist) = 0;
    *(int32_t *)((int32_t)history + 40 + 44 * nhist) = -1;
    int32_t * v18; // 0x80ab4f5
    int32_t v19; // bp-48, 0x80ab4f5
    int32_t * v20; // 0x80ab90f
    if (*(char *)(v1 + 32) == 0) {
        // 0x80abc71
        goto lab_0x80abc71_2;
    } else {
        // 0x80ab8bd
        if (nhist < 1) {
            goto lab_0x80abc2e;
        } else {
            // 0x80ab8ca
            v19 = *v2;
            v20 = HTAnchor_findAddress(&v19);
            if (v20 == NULL) {
                goto lab_0x80abc2e;
            } else {
                int32_t v21 = *(int32_t *)((int32_t)history - 40 + 44 * nhist); // 0x80ab935
                if (strncasecomp((char *)v21, "LYNXIMGMAP:", 11) != 0) {
                    goto lab_0x80ab998;
                } else {
                    // 0x80ab954
                    if (strncasecomp((char *)*v2, "LYNXIMGMAP:", 11) == 0) {
                        goto lab_0x80ab998;
                    } else {
                        // 0x80ab976
                        v19 = *(int32_t *)((int32_t)history - 40 + 44 * nhist) + 11;
                        // 0x80abae4
                        v18 = HTAnchor_findAddress(&v19);
                        goto lab_0x80abb76;
                    }
                }
            }
        }
    }
  lab_0x80abc71_2:
    // 0x80abc71
    if (WWW_TraceFlag != 0) {
        int32_t v22 = *doc; // 0x80abc7f
        int32_t v23 = *v2; // 0x80abc84
        fprintf(TraceFP(), "\nLYpush[%d]: address:%s\n        title:%s\n", nhist, (char *)v23, (char *)v22);
    }
    // 0x80abcb0
    nhist++;
    // 0x80abcc4
    return 1;
  lab_0x80abc2e:;
    char v24 = *(char *)((int32_t)history + 32 + 44 * nhist); // 0x80abc3f
    if (v24 != 0 || WWW_TraceFlag == 0) {
        goto lab_0x80abc71_2;
    } else {
        // 0x80abc52
        fprintf(TraceFP(), "\nLYpush: push as internal link requested, %s\n", "but didn't check out!");
        // 0x80abc71
        goto lab_0x80abc71_2;
    }
  lab_0x80ab998:
    // 0x80ab998
    if (strncasecomp((char *)*v2, "LYNXIMGMAP:", 11) != 0) {
        goto lab_0x80abac0;
    } else {
        int32_t v25 = *(int32_t *)((int32_t)history - 40 + 44 * nhist); // 0x80ab9d2
        if (strncasecomp((char *)v25, "LYNXIMGMAP:", 11) == 0) {
            goto lab_0x80abac0;
        } else {
            int32_t v26 = 0; // bp-28, 0x80ab9f5
            HTSACopy((char **)&v26, "LYNXIMGMAP:");
            HTSACat((char **)&v26, (char *)(*v2 + 11));
            v19 = v26;
            int32_t * v27 = HTAnchor_findAddress(&v19); // 0x80aba9d
            if (v26 != 0) {
                // 0x80abaac
                free((int32_t *)v26);
                v26 = 0;
            }
            // 0x80abada
            v18 = v27;
            if (v27 != NULL) {
                goto lab_0x80abb76;
            } else {
                // 0x80abae4
                v18 = HTAnchor_findAddress(&v19);
                goto lab_0x80abb76;
            }
        }
    }
  lab_0x80abac0:
    // 0x80abac0
    v19 = *(int32_t *)((int32_t)history - 40 + 44 * nhist);
    // 0x80abae4
    v18 = HTAnchor_findAddress(&v19);
    goto lab_0x80abb76;
  lab_0x80abb76:
    // 0x80abb76
    if (v18 != v20) {
        goto lab_0x80abc2e;
    } else {
        // 0x80abb82
        if (HTMainText == NULL) {
            goto lab_0x80abb99;
        } else {
            // 0x80abb8b
            if (v20 != HTMainAnchor) {
                goto lab_0x80abc2e;
            } else {
                goto lab_0x80abb99;
            }
        }
    }
  lab_0x80abb99:
    // 0x80abb99
    *(char *)((int32_t)history + 32 + 44 * nhist) = 1;
    int32_t v28 = 44 * nhist + (int32_t)history;
    int32_t v29 = *(int32_t *)(v28 - 4); // 0x80abbd5
    *(int32_t *)(v28 + 40) = v29 < 0 ? nhist - 1 : v29;
    if (WWW_TraceFlag != 0) {
        // 0x80abc17
        fprintf(TraceFP(), "\nLYpush: pushed as internal link, OK\n");
    }
    goto lab_0x80abc2e;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80abccf - 0x80abda4
// Line range:    546 - 562
void LYpop(int32_t * doc) {
    // 0x80abccf
    if (nhist < 1) {
        // 0x80abd9c
        return;
    }
    int32_t v1 = (int32_t)doc;
    clean_extra_history();
    nhist--;
    LYFreeDocInfo(doc);
    int32_t v2 = 44 * nhist + (int32_t)history; // 0x80abd10
    *doc = *(int32_t *)v2;
    int32_t * v3 = (int32_t *)(v1 + 4); // 0x80abd1c
    *v3 = *(int32_t *)(v2 + 4);
    *(int32_t *)(v1 + 8) = *(int32_t *)(v2 + 8);
    *(int32_t *)(v1 + 12) = *(int32_t *)(v2 + 12);
    *(int32_t *)(v1 + 16) = *(int32_t *)(v2 + 16);
    *(int32_t *)(v1 + 20) = *(int32_t *)(v2 + 20);
    *(int32_t *)(v1 + 24) = *(int32_t *)(v2 + 24);
    int32_t * v4 = (int32_t *)(v1 + 28); // 0x80abd40
    *v4 = *(int32_t *)(v2 + 28);
    *(int32_t *)(v1 + 32) = *(int32_t *)(v2 + 32);
    *(int32_t *)(v1 + 36) = *(int32_t *)(v2 + 36);
    LYSetNewline(*v4);
    if (WWW_TraceFlag != 0) {
        int32_t v5 = *doc; // 0x80abd6b
        int32_t v6 = *v3; // 0x80abd70
        fprintf(TraceFP(), "LYpop[%d]: address:%s\n     title:%s\n", nhist, (char *)v6, (char *)v5);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80abda4 - 0x80abe14
// Line range:    568 - 576
void LYhist_prev(int32_t * doc) {
    // 0x80abda4
    trace_history("LYhist_prev");
    if (nhist < 1) {
        // 0x80abe12
        return;
    }
    // 0x80abdbf
    if (nhist_extra != 0 || nhist < size_history) {
        int32_t v1 = nhist - 1; // 0x80abddc
        nhist = v1;
        nhist_extra++;
        LYpop_num(v1, doc);
        trace_history("...LYhist_prev");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80abe14 - 0x80abeac
// Line range:    582 - 595
void LYhist_prev_register(int32_t * doc) {
    // 0x80abe14
    trace_history("LYhist_prev_register");
    int32_t v1 = nhist; // 0x80abe26
    if (v1 < 2) {
        // 0x80abeaa
        return;
    }
    // 0x80abe30
    if (nhist_extra == 0) {
        // 0x80abe6d
        if (LYpush(doc, 0) != 0) {
            // 0x80abe84
            nhist--;
            nhist_extra++;
        }
        // 0x80abe9e
        trace_history("...LYhist_prev_register");
        // 0x80abeaa
        return;
    }
    int32_t v2 = (int32_t)doc;
    int32_t v3 = *(int32_t *)(v2 + 24); // 0x80abe4c
    *(int32_t *)(44 * v1 + 24 + (int32_t)history) = v3;
    int32_t v4 = *(int32_t *)(v2 + 28); // 0x80abe65
    *(int32_t *)((int32_t)history + 28 + 44 * nhist) = v4;
    // 0x80abe9e
    trace_history("...LYhist_prev_register");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80abeac - 0x80abf3f
// Line range:    601 - 612
int32_t LYhist_next(int32_t * doc, int32_t * newdoc2) {
    int32_t result = 0; // 0x80abeba
    if (nhist_extra > 1) {
        int32_t v1 = (int32_t)doc;
        int32_t v2 = *(int32_t *)(v1 + 24); // 0x80abed8
        *(int32_t *)((int32_t)history + 24 + 44 * nhist) = v2;
        int32_t v3 = *(int32_t *)(v1 + 28); // 0x80abef1
        *(int32_t *)((int32_t)history + 28 + 44 * nhist) = v3;
        LYAllocHistory(nhist);
        int32_t v4 = nhist + 1; // 0x80abf09
        nhist = v4;
        nhist_extra--;
        LYpop_num(v4, newdoc2);
        result = 1;
    }
    // 0x80abf3a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80abf3f - 0x80ac222
// Line range:    621 - 645
void LYpop_num(uint32_t number, int32_t * doc) {
    if ((int32_t)number < 0 || nhist_extra + nhist <= number) {
        // 0x80ac21c
        return;
    }
    int32_t v1 = (int32_t)doc;
    int32_t v2 = 44 * number; // 0x80abf6f
    int32_t * v3 = (int32_t *)(v1 + 24); // 0x80abf7b
    *v3 = *(int32_t *)(v2 + 24 + (int32_t)history);
    int32_t * v4 = (int32_t *)(v1 + 28); // 0x80abf93
    *v4 = *(int32_t *)(v2 + 28 + (int32_t)history);
    int32_t v5 = *(int32_t *)(v2 + (int32_t)history); // 0x80abfa5
    HTSACopy((char **)doc, (char *)v5);
    int32_t v6 = *(int32_t *)(v2 + 4 + (int32_t)history); // 0x80abfc5
    int32_t v7 = v1 + 4; // 0x80abfcb
    HTSACopy((char **)v7, (char *)v6);
    int32_t v8 = *(int32_t *)(v2 + 8 + (int32_t)history); // 0x80abfe9
    int32_t v9 = 0; // 0x80abfee
    char * v10 = NULL; // 0x80abfee
    if (v8 != 0) {
        // 0x80ac027
        v9 = *(int32_t *)(v8 + 4);
        v10 = (char *)*(int32_t *)v8;
    }
    // 0x80ac047
    HTSABCopy((int32_t **)(v1 + 8), v10, v9);
    int32_t v11 = *(int32_t *)(v2 + 12 + (int32_t)history); // 0x80ac072
    HTSACopy((char **)(v1 + 12), (char *)v11);
    int32_t v12 = *(int32_t *)(v2 + 16 + (int32_t)history); // 0x80ac096
    HTSACopy((char **)(v1 + 16), (char *)v12);
    *(char *)(v1 + 20) = *(char *)(v2 + 20 + (int32_t)history);
    *(char *)(v1 + 21) = *(char *)(v2 + 21 + (int32_t)history);
    *(char *)(v1 + 32) = *(char *)(v2 + 32 + (int32_t)history);
    LYSetNewline(*v4);
    if (WWW_TraceFlag == 0) {
        // 0x80ac21c
        return;
    }
    // 0x80ac11e
    fprintf(TraceFP(), "LYpop_num(%d)\n", number);
    if (WWW_TraceFlag == 0) {
        // 0x80ac21c
        return;
    }
    // 0x80ac168
    fprintf(TraceFP(), "  link    %d\n", *v3);
    if (WWW_TraceFlag == 0) {
        // 0x80ac21c
        return;
    }
    // 0x80ac194
    fprintf(TraceFP(), "  line    %d\n", *v4);
    if (WWW_TraceFlag == 0) {
        // 0x80ac21c
        return;
    }
    int32_t v13 = *doc; // 0x80ac1a2
    int32_t v14 = v13 == 0 ? (int32_t)&g41 : v13;
    fprintf(TraceFP(), "  title   %s\n", (char *)v14);
    if (WWW_TraceFlag != 0) {
        int32_t v15 = *(int32_t *)v7; // 0x80ac1e5
        int32_t v16 = v15 == 0 ? (int32_t)&g41 : v15;
        fprintf(TraceFP(), "  address %s\n", (char *)v16);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ac222 - 0x80ac5ac
// Line range:    651 - 712
int32_t showhistory(char ** newfile) {
    char * v1 = NULL; // bp-8, 0x80ac228
    struct _IO_FILE * stream = InternalPageFP((char *)&g131, 1); // 0x80ac245
    if (stream == NULL) {
        // 0x80ac5a7
        return -1;
    }
    // 0x80ac25f
    LYLocalFileToURL(newfile, (char *)&g131);
    LYforce_HTML_mode = 1;
    LYforce_no_cache = 1;
    BeginInternalPage(stream, gettext("History Page"), "keystrokes/history_help.html.gz");
    fprintf(stream, "<p align=right> <a href=\"%s\">[%s]</a>\n", "LYNXMESSAGES:", gettext("Your recent statusline messages"));
    fwrite((int32_t *)"<pre>\n", 1, 6, stream);
    fprintf(stream, "<em>%s</em>\n", gettext("You selected:"));
    int32_t v2 = nhist - 1 + nhist_extra;
    if (v2 >= 0) {
        int32_t v3 = v2;
        int32_t v4 = 44 * v3; // 0x80ac336
        int32_t v5 = *(int32_t *)(v4 + (int32_t)history); // 0x80ac33c
        char * v6; // 0x80ac3b9
        char * v7; // 0x80ac39c
        if (v5 == 0) {
            // 0x80ac3b2
            v6 = gettext("(No title.)");
            HTSACopy(&v1, v6);
        } else {
            // 0x80ac342
            HTSACopy(&v1, (char *)v5);
            LYEntify(&v1, 1);
            LYTrimLeading(v1);
            LYTrimTrailing(v1);
            if (*v1 == 0) {
                // 0x80ac395
                v7 = gettext("(No title.)");
                HTSACopy(&v1, v7);
            }
        }
        char * v8 = (char *)v3;
        char * v9 = v8 > (char *)9 ? (char *)&g42 : "  ";
        char * v10 = v8 > (char *)99 ? (char *)&g41 : v9; // 0x80ac437
        fprintf(stream, "%s<em>%d</em>. <tab id=t%d><a href=\"%s%d\">%s</a>\n", v10, v3, v3, "LYNXHIST:", v3, v1);
        int32_t v11 = *(int32_t *)(v4 + 4 + (int32_t)history); // 0x80ac44b
        char * v12; // 0x80ac48f
        if (v11 == 0) {
            // 0x80ac488
            v12 = gettext("(no address)");
            HTSACopy(&v1, v12);
        } else {
            // 0x80ac452
            HTSACopy(&v1, (char *)v11);
            LYEntify(&v1, 1);
        }
        int32_t v13 = (int32_t)history; // 0x80ac4a3
        int32_t v14 = v4 + v13; // 0x80ac4af
        char * v15; // 0x80ac50b
        char * v16; // 0x80ac4ee
        if (*(char *)(v14 + 32) != 0) {
            // 0x80ac4ba
            if (*(int32_t *)(v14 + 40) != *(int32_t *)(v13 - 4 + 44 * nhist)) {
                // 0x80ac504
                v15 = gettext(" (was internal)");
                HTSACat(&v1, v15);
            } else {
                // 0x80ac4e7
                v16 = gettext(" (internal)");
                HTSACat(&v1, v16);
            }
        }
        // 0x80ac51f
        fprintf(stream, "<tab to=t%d>%s\n", v3, v1);
        int32_t v17 = v3 - 1;
        while (v17 >= 0) {
            // 0x80ac32d
            v3 = v17;
            v4 = 44 * v3;
            v5 = *(int32_t *)(v4 + (int32_t)history);
            if (v5 == 0) {
                // 0x80ac3b2
                v6 = gettext("(No title.)");
                HTSACopy(&v1, v6);
            } else {
                // 0x80ac342
                HTSACopy(&v1, (char *)v5);
                LYEntify(&v1, 1);
                LYTrimLeading(v1);
                LYTrimTrailing(v1);
                if (*v1 == 0) {
                    // 0x80ac395
                    v7 = gettext("(No title.)");
                    HTSACopy(&v1, v7);
                }
            }
            // 0x80ac3cd
            v8 = (char *)v3;
            v9 = v8 > (char *)9 ? (char *)&g42 : "  ";
            v10 = v8 > (char *)99 ? (char *)&g41 : v9;
            fprintf(stream, "%s<em>%d</em>. <tab id=t%d><a href=\"%s%d\">%s</a>\n", v10, v3, v3, "LYNXHIST:", v3, v1);
            v11 = *(int32_t *)(v4 + 4 + (int32_t)history);
            if (v11 == 0) {
                // 0x80ac488
                v12 = gettext("(no address)");
                HTSACopy(&v1, v12);
            } else {
                // 0x80ac452
                HTSACopy(&v1, (char *)v11);
                LYEntify(&v1, 1);
            }
            // 0x80ac4a3
            v13 = (int32_t)history;
            v14 = v4 + v13;
            if (*(char *)(v14 + 32) != 0) {
                // 0x80ac4ba
                if (*(int32_t *)(v14 + 40) != *(int32_t *)(v13 - 4 + 44 * nhist)) {
                    // 0x80ac504
                    v15 = gettext(" (was internal)");
                    HTSACat(&v1, v15);
                } else {
                    // 0x80ac4e7
                    v16 = gettext(" (internal)");
                    HTSACat(&v1, v16);
                }
            }
            // 0x80ac51f
            fprintf(stream, "<tab to=t%d>%s\n", v3, v1);
            v17 = v3 - 1;
        }
    }
    // 0x80ac54e
    fwrite((int32_t *)"</pre>\n", 1, 7, stream);
    EndInternalPage(stream);
    LYCloseTempFP(stream);
    if (v1 != NULL) {
        // 0x80ac58e
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x80ac5a7
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ac5ac - 0x80ac8b9
// Line range:    722 - 802
char historytarget(int32_t * newdoc2) {
    // 0x80ac5ac
    if (newdoc2 == NULL) {
        // 0x80ac8af
        return 0;
    }
    int32_t v1 = (int32_t)newdoc2;
    int32_t * v2 = (int32_t *)(v1 + 4); // 0x80ac5c0
    int32_t str = *v2; // 0x80ac5c0
    if (str == 0 || strlen((char *)str) < 10) {
        // 0x80ac8af
        return 0;
    }
    int16_t * v3 = *__ctype_b_loc(); // 0x80ac5df
    char * str2 = (char *)(*v2 + 9); // 0x80ac5ea
    if ((*(int16_t *)(2 * (int32_t)*str2 + (int32_t)v3) & 2048) == 0) {
        // 0x80ac8af
        return 0;
    }
    int32_t str_as_i = atoi(str2); // 0x80ac619
    if (str_as_i >= 0 != str_as_i <= nhist_extra + nhist) {
        // 0x80ac8af
        return 0;
    }
    // 0x80ac643
    if (nhist >= 1 && HTMainText != NULL) {
        char * str3 = gettext("History Page"); // 0x80ac65c
        if (strcmp(HTLoadedDocumentTitle(), str3) == 0) {
            char * v4 = HTLoadedDocumentURL(); // 0x80ac678
            if (LYIsUIPage3(v4, 0, 0) != 0) {
                int32_t str4 = *(int32_t *)((int32_t)history - 40 + 44 * nhist); // 0x80ac6ad
                if (strcmp(HTLoadedDocumentURL(), (char *)str4) != 0) {
                    // 0x80ac6c5
                    HTuncache_current_document();
                }
            }
        }
    }
    // 0x80ac6ca
    LYpop_num(str_as_i, newdoc2);
    char * v5 = (char *)(v1 + 32); // 0x80ac6df
    if (*v5 == 0) {
        // 0x80ac6ca
        goto lab_0x80ac714;
    } else {
        int32_t v6 = (int32_t)history; // 0x80ac6e7
        int32_t v7 = *(int32_t *)(v6 - 4 + 44 * nhist); // 0x80ac70d
        if (*(int32_t *)(44 * str_as_i + 40 + v6) == v7) {
            goto lab_0x80ac759;
        } else {
            goto lab_0x80ac714;
        }
    }
  lab_0x80ac714:
    // 0x80ac714
    if (nhist - 1 > str_as_i) {
        int32_t v8 = 44 * nhist - 44 + (int32_t)history; // 0x80ac732
        if (*(char *)(v8 + 32) == 0) {
            // 0x80ac76f
            *v5 = 0;
            goto lab_0x80ac776;
        } else {
            // 0x80ac73d
            if (*(int32_t *)(v8 + 40) != str_as_i) {
                // 0x80ac76f
                *v5 = 0;
                goto lab_0x80ac776;
            } else {
                goto lab_0x80ac759;
            }
        }
    } else {
        // 0x80ac76f
        *v5 = 0;
        goto lab_0x80ac776;
    }
  lab_0x80ac759:
    // 0x80ac759
    if (LYforce_no_cache != 1) {
        goto lab_0x80ac776;
    } else {
        // 0x80ac764
        if (LYoverride_no_cache != 0) {
            goto lab_0x80ac776;
        } else {
            // 0x80ac76f
            *v5 = 0;
            goto lab_0x80ac776;
        }
    }
  lab_0x80ac776:;
    // 0x80ac776
    int32_t * v9; // 0x80ac7d0
    if (*(int32_t *)(v1 + 8) == 0) {
        goto lab_0x80ac88a;
    } else {
        int32_t v10 = *v2; // bp-44, 0x80ac78a
        int32_t * v11 = HTAnchor_findAddress(&v10); // 0x80ac7c2
        v9 = HTAnchor_document(v11);
        if (LYresubmit_posts == 1) {
            goto lab_0x80ac810;
        } else {
            // 0x80ac7e3
            if (LYforce_no_cache != 1) {
                goto lab_0x80ac80a;
            } else {
                // 0x80ac7ee
                if (LYoverride_no_cache != 0) {
                    goto lab_0x80ac80a;
                } else {
                    goto lab_0x80ac810;
                }
            }
        }
    }
  lab_0x80ac88a:
    // 0x80ac88a
    if (str_as_i != 0) {
        // 0x80ac890
        HTSACat((char **)newdoc2, gettext(" (From History)"));
    }
    // 0x80ac8af
    return 1;
  lab_0x80ac810:
    // 0x80ac810
    if (strncasecomp((char *)*v2, "LYNXIMGMAP:", 11) == 0) {
        // 0x80ac84a
        LYforce_no_cache = 1;
        LYoverride_no_cache = 0;
        goto lab_0x80ac88a;
    } else {
        char * v12 = gettext("Document from Form with POST content.  Resubmit?"); // 0x80ac839
        if (HTConfirm(v12) != 1) {
            goto lab_0x80ac85a;
        } else {
            // 0x80ac84a
            LYforce_no_cache = 1;
            LYoverride_no_cache = 0;
            goto lab_0x80ac88a;
        }
    }
  lab_0x80ac80a:
    if (v9 != NULL) {
        goto lab_0x80ac85a;
    } else {
        goto lab_0x80ac810;
    }
  lab_0x80ac85a:
    if (v9 == NULL) {
        // 0x80ac870
        HTInfoMsg(gettext("Cancelled!!!"));
        // 0x80ac8af
        return 0;
    }
    // 0x80ac860
    LYforce_no_cache = 0;
    LYoverride_no_cache = 1;
    goto lab_0x80ac88a;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ac8b9 - 0x80acf58
// Line range:    809 - 949
int32_t LYShowVisitedLinks(char ** newfile) {
    char * v1 = NULL; // bp-8, 0x80ac8bf
    char * Title = NULL; // bp-12, 0x80ac8c6
    if (Visited_Links == NULL) {
        // 0x80acf53
        return -1;
    }
    struct _IO_FILE * stream = InternalPageFP((char *)&g132, 1); // 0x80ac8fd
    if (stream == NULL) {
        // 0x80acf53
        return -1;
    }
    // 0x80ac917
    LYLocalFileToURL(newfile, (char *)&g132);
    LYRegisterUIPage(*newfile, 5);
    LYforce_HTML_mode = 1;
    LYforce_no_cache = 1;
    BeginInternalPage(stream, gettext("Visited Links Page"), "keystrokes/visited_help.html.gz");
    fprintf(stream, "<form action=\"%s\" method=\"post\">\n", "LYNXOPTIONS:");
    LYMenuVisitedLinks(stream, 0);
    fwrite((int32_t *)"<input type=\"submit\" value=\"Accept Changes\">\n", 1, 45, stream);
    fwrite((int32_t *)"</form>\n", 1, 8, stream);
    fwrite((int32_t *)"<P>\n", 1, 4, stream);
    fwrite((int32_t *)"<pre>\n", 1, 6, stream);
    fprintf(stream, "<em>%s</em>\n", gettext("You visited (POSTs, bookmark, menu and list files excluded):"));
    char * v2 = (char *)-1; // 0x80aca57
    if ((Visited_Links_As & 4) != 0) {
        // 0x80aca59
        v2 = (char *)HTList_count(Visited_Links);
    }
    // 0x80aca7e
    int32_t * v3; // 0x80ac8b9
    int32_t v4; // 0x80ac8b9
    if (Visited_Links_As % 2 == 0) {
        if ((Visited_Links_As & 2) == 0) {
            if ((Visited_Links_As & 4) == 0) {
                // 0x80acb02
                v3 = PrevVisitedLink;
                v4 = (int32_t)PrevVisitedLink;
            } else {
                // 0x80acaef
                v3 = Visited_Links;
                v4 = (int32_t)Last_by_first;
            }
        } else {
            int32_t v5 = (Visited_Links_As & 4) == 0 ? g296 : g297;
            v3 = Visited_Links;
            v4 = v5 != 0x81afccc == (v5 != 0x81afcb0) ? v5 : 0;
        }
    } else {
        // 0x80aca8a
        v3 = Visited_Links;
        v4 = (int32_t)First_tree;
    }
    int32_t * v6 = NULL; // 0x80acedc
    int32_t * v7; // 0x80ac8b9
    int32_t * v8; // 0x80ac8b9
    int32_t * v9; // 0x80ac8b9
    int32_t v10; // 0x80ac8b9
    int32_t v11; // 0x80ac8b9
    char * v12; // 0x80ac8b9
    char * v13; // 0x80ac8b9
    int32_t v14; // 0x80ac8b9
    char * v15; // 0x80ac8b9
    int32_t v16; // 0x80ac8b9
    int32_t v17; // 0x80ac8b9
    int32_t v18; // 0x80ac8b9
    if (v4 != 0) {
        // 0x80acb2d
        v18 = (int32_t)v2 + 2;
        int32_t v19 = v4; // 0x80acec4
        char * v20 = v2; // 0x80ac8b9
        int32_t * v21 = NULL; // 0x80ac8b9
        int32_t * v22 = v3; // 0x80aceb8
        while (true) {
            // 0x80acb2d
            v16 = v19;
            v15 = v20;
            v9 = v21;
            while (true) {
              lab_0x80acb2d:
                // 0x80acb2d
                v17 = v16;
                v14 = ((Visited_Links_As & 4) == 0 ? 1 : -1) + (int32_t)v15;
                v7 = v9;
                v10 = &g41;
                v11 = &g41;
                if (v17 != (int32_t)PrevActiveVisitedLink) {
                    goto lab_0x80acbd2;
                } else {
                    // 0x80acb5a
                    if (*(int32_t *)(v17 + 8) == 0) {
                        // 0x80acbb2
                        v12 = "=>";
                        goto lab_0x80acbb9;
                    } else {
                        // 0x80acb9a
                        v12 = "==>";
                        if (Visited_Links_As % 2 == 0) {
                            // 0x80acbb2
                            v12 = "=>";
                            goto lab_0x80acbb9;
                        } else {
                            goto lab_0x80acbb9;
                        }
                    }
                }
            }
          lab_0x80aceac:
            // 0x80aceac
            v6 = v8;
            if (v22 == NULL) {
                // break -> 0x80acee2
                break;
            }
            int32_t v23 = *(int32_t *)((int32_t)v22 + 4); // 0x80aceb5
            v6 = v8;
            if (v23 == 0) {
                // break -> 0x80acee2
                break;
            }
            // 0x80aced2
            v22 = (int32_t *)v23;
            v19 = *v22;
            v20 = v13;
            v21 = v8;
            v6 = v8;
            if (v19 == 0) {
                // break -> 0x80acee2
                break;
            }
        }
    }
  lab_0x80acee2:
    // 0x80acee2
    fwrite((int32_t *)"</pre>\n", 1, 7, stream);
    EndInternalPage(stream);
    LYCloseTempFP(stream);
    if (v1 != NULL) {
        // 0x80acf22
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x80acf34
    if (Title == NULL) {
        // 0x80acf53
        return (int32_t)v6;
    }
    // 0x80acf3b
    free((int32_t *)Title);
    Title = NULL;
    // 0x80acf53
    return (int32_t)v6;
  lab_0x80acbd2:
    // 0x80acbd2
    v13 = (char *)v14;
    int32_t v24 = v11;
    int32_t v25 = v10;
    v8 = v7;
    int32_t v26; // 0x80ac8b9
    if (Visited_Links_As % 2 == 0) {
        int32_t v27 = v13 > (char *)9 ? 1 : 2;
        v26 = v13 > (char *)99 ? 0 : v27;
    } else {
        int32_t v28 = 2 * *(int32_t *)(v17 + 8); // 0x80acbe4
        int32_t v29 = v28 < 25 ? v28 : v28 + 24 >> 1;
        int32_t v30 = 3 * LYcols; // 0x80acc0b
        int32_t v31 = ((v30 >> 31) / 0x40000000 + v30) / 4; // 0x80acc18
        v26 = v31 < v29 ? v31 : v29;
    }
    int32_t v32 = v26;
    int32_t v33 = *(int32_t *)v17; // 0x80acc73
    char * v34; // 0x80accf0
    if (v33 == 0) {
        // 0x80acce9
        v34 = gettext("(No title.)");
        HTSACopy(&v1, v34);
        goto lab_0x80acd04;
    } else {
        char * v35 = (char *)v33; // 0x80acc7e
        if (*v35 == 0) {
            // 0x80acce9
            v34 = gettext("(No title.)");
            HTSACopy(&v1, v34);
            goto lab_0x80acd04;
        } else {
            // 0x80acc85
            HTSACopy(&v1, v35);
            LYEntify(&v1, 1);
            LYTrimLeading(v1);
            LYTrimTrailing(v1);
            if (*v1 == 0) {
                char * v36 = gettext("(No title.)"); // 0x80accd3
                HTSACopy(&v1, v36);
            }
            goto lab_0x80acd04;
        }
    }
  lab_0x80acd04:;
    int32_t * v37 = (int32_t *)(v17 + 4); // 0x80acd07
    int32_t v38 = *v37; // 0x80acd07
    if (v38 == 0) {
        // 0x80acd89
        fprintf(stream, "%-*s%s<em>%d</em>. <tab id=t%d><em>%s</em>\n", v32, (char *)v25, (char *)v24, v14, v14, v1);
        goto lab_0x80acdc6;
    } else {
        char * v39 = (char *)v38; // 0x80acd14
        if (*v39 == 0) {
            // 0x80acd89
            fprintf(stream, "%-*s%s<em>%d</em>. <tab id=t%d><em>%s</em>\n", v32, (char *)v25, (char *)v24, v14, v14, v1);
            goto lab_0x80acdc6;
        } else {
            // 0x80acd1b
            HTSACopy(&Title, v39);
            LYEntify(&Title, 0);
            fprintf(stream, "%-*s%s<em>%d</em>. <tab id=t%d><a href=\"%s\">%s</a>\n", v32, (char *)v25, (char *)v24, v14, v14, Title, v1);
            goto lab_0x80acdc6;
        }
    }
  lab_0x80acbb9:;
    int32_t v40 = (Visited_Links_As & 4) == 0 ? v14 + 3 : v18 - v14;
    HTSACat(newfile, "#current");
    v7 = (int32_t *)v40;
    v10 = (int32_t)v12;
    v11 = (int32_t)"<A NAME=current></A>";
    goto lab_0x80acbd2;
  lab_0x80acdc6:;
    // 0x80acdc6
    char * v41; // 0x80ac8b9
    if (Title == NULL) {
        // 0x80acdfc
        v41 = gettext("(no address)");
        goto lab_0x80ace13;
    } else {
        // 0x80acdf5
        HTSACopy(&Title, (char *)*v37);
        LYEntify(&Title, 1);
        v41 = Title;
        if (Title != NULL) {
            goto lab_0x80ace13;
        } else {
            // 0x80acdfc
            v41 = gettext("(no address)");
            goto lab_0x80ace13;
        }
    }
  lab_0x80ace13:
    // 0x80ace13
    fprintf(stream, "<tab to=t%d>%s\n", v14, v41);
    int32_t v42; // 0x80ac8b9
    if (Visited_Links_As % 2 == 0) {
        int32_t v43 = Visited_Links_As & 4;
        if ((Visited_Links_As & 2) == 0) {
            if (v43 == 0) {
                // break -> 0x80aceac
                goto lab_0x80aceac;
            }
            // 0x80acea1
            v42 = *(int32_t *)(v17 + 24);
        } else {
            int32_t v44 = *(int32_t *)((v43 ^ 20) + v17);
            int32_t v45 = v44 != (int32_t)&Latest_last == (v44 != (int32_t)&Latest_first) ? v44 : 0;
            v42 = v45;
        }
    } else {
        // 0x80ace40
        v42 = *(int32_t *)(v17 + 12);
    }
    // 0x80aced8
    v16 = v42;
    v15 = v13;
    v9 = v8;
    v6 = v8;
    if (v42 == 0) {
        // break (via goto) -> 0x80acee2
        goto lab_0x80acee2;
    }
    goto lab_0x80acb2d;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80acf58 - 0x80acfd9
// Line range:    973 - 996
void to_stack(char * str) {
    char * v1 = g294; // 0x80acf66
    if (g294 >= (char *)40) {
        // 0x80acf68
        g294 = NULL;
        v1 = NULL;
    }
    int32_t * v2 = (int32_t *)(4 * (int32_t)v1 + (int32_t)&buffstack);
    int32_t v3 = *v2; // 0x80acf77
    int32_t * v4 = v2; // 0x80acf80
    if (v3 != 0) {
        // 0x80acf82
        free((int32_t *)v3);
        *(int32_t *)(4 * (int32_t)g294 + (int32_t)&buffstack) = 0;
        v4 = (int32_t *)(4 * (int32_t)g294 + (int32_t)&buffstack);
    }
    // 0x80acfa6
    *v4 = (int32_t)str;
    int32_t v5 = (int32_t)g294 + 1; // 0x80acfbb
    g294 = v5 < 40 ? (char *)v5 : NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80acfd9 - 0x80ad096
// Line range:    1006 - 1027
void LYstatusline_messages_on_exit(char ** buf) {
    // 0x80acfd9
    HTSACat(buf, "\n");
    char * v1 = g294; // 0x80ad041
    if (g294 < (char *)40) {
        for (int32_t i = (int32_t)g294; i < 40; i++) {
            int32_t v2 = *(int32_t *)(4 * i + (int32_t)&buffstack); // 0x80ad002
            if (v2 != 0) {
                // 0x80ad00d
                HTSACat(buf, (char *)v2);
                HTSACat(buf, "\n");
            }
        }
        // 0x80ad039
        v1 = g294;
    }
    char * v3 = v1; // 0x80ad092
    if (v1 <= NULL) {
        // 0x80ad094
        return;
    }
    for (int32_t i = 0; i < (int32_t)v3; i++) {
        int32_t v4 = *(int32_t *)(4 * i + (int32_t)&buffstack); // 0x80ad04f
        if (v4 != 0) {
            // 0x80ad05a
            HTSACat(buf, (char *)v4);
            HTSACat(buf, "\n");
            v3 = g294;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ad096 - 0x80ad0e4
// Line range:    1031 - 1039
void LYstore_message2(char * message, char * argument) {
    if (message != NULL) {
        char * v1 = NULL; // bp-8, 0x80ad0a2
        HTSprintf0(&v1, message);
        to_stack(v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHistory.c
// Address range: 0x80ad0e4 - 0x80ad116
// Line range:    1042 - 1049
void LYstore_message(char * message) {
    if (message != NULL) {
        char * v1 = NULL; // bp-8, 0x80ad0f0
        HTSACopy(&v1, message);
        to_stack(v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYForms.c
// Address range: 0x80ad510 - 0x80ad5a0
// Line range:    37 - 58
char ** options_list(int32_t * opt_ptr) {
    char ** v1 = NULL;
    char ** v2 = NULL;
    char ** v3 = NULL; // 0x80ad55e
    int32_t v4; // 0x80ad510
    int32_t v5; // 0x80ad510
    int32_t v6; // 0x80ad510
    char ** v7; // 0x80ad510
    int32_t v8; // 0x80ad554
    if (opt_ptr != NULL) {
        // 0x80ad535
        v6 = (int32_t)v1;
        v5 = (int32_t)opt_ptr;
        v4 = (int32_t)NULL;
        if (v2 != NULL) {
            // 0x80ad53b
            *(int32_t *)(4 * v4 + v6) = *(int32_t *)v5;
        }
        // 0x80ad54d
        v7 = (char **)(v4 + 1);
        v8 = *(int32_t *)(v5 + 12);
        v3 = v7;
        while (v8 != 0) {
            // 0x80ad535
            v5 = v8;
            v4 = (int32_t)v7;
            if (v2 != NULL) {
                // 0x80ad53b
                *(int32_t *)(4 * v4 + v6) = *(int32_t *)v5;
            }
            // 0x80ad54d
            v7 = (char **)(v4 + 1);
            v8 = *(int32_t *)(v5 + 12);
            v3 = v7;
        }
    }
    int32_t v9 = (int32_t)v3;
    char ** mem; // 0x80ad510
    if (v2 != NULL) {
        // 0x80ad582
        *(int32_t *)(4 * v9 + (int32_t)v1) = 0;
        mem = v1;
    } else {
        // 0x80ad566
        mem = (char **)calloc(v9 + 1, 4);
    }
    char ** result = mem;
    char ** v10 = (char **)((int32_t)v2 + 1); // 0x80ad591
    while (v10 < (char **)2) {
        // 0x80ad55a
        v1 = result;
        v2 = v10;
        v3 = NULL;
        if (opt_ptr != NULL) {
            // 0x80ad535
            v6 = (int32_t)v1;
            v5 = (int32_t)opt_ptr;
            v4 = (int32_t)NULL;
            if (v2 != NULL) {
                // 0x80ad53b
                *(int32_t *)(4 * v4 + v6) = *(int32_t *)v5;
            }
            // 0x80ad54d
            v7 = (char **)(v4 + 1);
            v8 = *(int32_t *)(v5 + 12);
            v3 = v7;
            while (v8 != 0) {
                // 0x80ad535
                v5 = v8;
                v4 = (int32_t)v7;
                if (v2 != NULL) {
                    // 0x80ad53b
                    *(int32_t *)(4 * v4 + v6) = *(int32_t *)v5;
                }
                // 0x80ad54d
                v7 = (char **)(v4 + 1);
                v8 = *(int32_t *)(v5 + 12);
                v3 = v7;
            }
        }
        // 0x80ad560
        v9 = (int32_t)v3;
        if (v2 != NULL) {
            // 0x80ad582
            *(int32_t *)(4 * v9 + (int32_t)v1) = 0;
            mem = v1;
        } else {
            // 0x80ad566
            mem = (char **)calloc(v9 + 1, 4);
        }
        // 0x80ad591
        result = mem;
        v10 = (char **)((int32_t)v2 + 1);
    }
    // 0x80ad59b
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYForms.c
// Address range: 0x80ad5a0 - 0x80addf9
// Line range:    66 - 343
int32_t change_form_link_ex(int32_t cur, int32_t * newdoc2, char * refresh_screen, char use_last_tfpos, char immediate_submit, char redraw_only) {
    int32_t v1 = 68 * cur; // 0x80ad5c6
    int32_t v2 = *(int32_t *)(v1 + (int32_t)&g354); // 0x80ad5c8
    int32_t * str2 = (int32_t *)v2; // 0x80ad5d4
    int32_t v3 = *str2; // 0x80ad5d4
    int32_t * v4 = (int32_t *)(v2 + 12); // 0x80ad5dc
    int32_t v5 = *v4; // 0x80ad5dc
    if (v2 == 0) {
        // 0x80addee
        return (int32_t)(char *)270;
    }
    int32_t v6 = (int32_t)newdoc2;
    int32_t * v7 = (int32_t *)(v2 + 44);
    char ** v8 = options_list((int32_t *)*v7); // 0x80ad632
    int32_t * v9 = (int32_t *)(v1 + (int32_t)&g345); // 0x80ad647
    int32_t * v10 = (int32_t *)(v1 + (int32_t)&g346); // 0x80ad65a
    LYmove(*v10 + (int32_t)(no_title != 0), *v9);
    int32_t * v11 = (int32_t *)(v2 + 8); // 0x80ad672
    int32_t v12 = *v11; // 0x80ad672
    g389 = v12;
    char * v13 = (char *)270; // 0x80ad68c
    char * v14; // 0x80ad5a0
    char * v15; // 0x80ad5a0
    switch (v12) {
        case 1: {
            goto lab_0x80ada44;
        }
        case 2: {
            goto lab_0x80ada44;
        }
        case 3: {
            // 0x80ad68e
            v13 = (char *)270;
            if (*(int32_t *)(v2 + 80) != 1) {
                int32_t * v16 = (int32_t *)(v2 + 32); // 0x80ad6a0
                LYSetHilite(cur, *v16 == 0 ? checked_box : unchecked_box);
                *v16 = (int32_t)(*v16 == 0);
                v13 = (char *)270;
            }
            goto lab_0x80addc2;
        }
        case 4: {
            // 0x80ad8a3
            v13 = (char *)270;
            if (*(int32_t *)(v2 + 80) != 1) {
                // 0x80ad8b2
                if (*(int32_t *)(v2 + 32) == 0) {
                    // 0x80ad8e2
                    lynx_start_radio_color();
                    if (nlinks > 0) {
                        int32_t v17 = 0;
                        int32_t v18 = 68 * v17; // 0x80ad8fe
                        int32_t * v19; // 0x80ad91c
                        int32_t str; // 0x80ad91c
                        int32_t v20; // 0x80ad9ba
                        if (*(int32_t *)(v18 + (int32_t)&g347) == 1) {
                            // 0x80ad90f
                            v19 = (int32_t *)(v18 + (int32_t)&g354);
                            str = *v19;
                            if (*(int32_t *)(str + 8) == 4) {
                                // 0x80ad92e
                                if (*(int32_t *)(str + 4) == *(int32_t *)(v2 + 4)) {
                                    // 0x80ad952
                                    if (strcmp((char *)*(int32_t *)str, (char *)*str2) == 0) {
                                        // 0x80ad980
                                        if (*(int32_t *)(*v19 + 32) != 0) {
                                            // 0x80ad99a
                                            v20 = *(int32_t *)(v18 + (int32_t)&g346);
                                            LYmove(v20, *(int32_t *)(v18 + (int32_t)&g345));
                                            LYwaddnstr(LYwin, unchecked_radio, strlen(unchecked_radio));
                                            LYSetHilite(v17, unchecked_radio);
                                        }
                                    }
                                }
                            }
                        }
                        int32_t v21 = v17 + 1; // 0x80ada09
                        while (v21 < nlinks) {
                            // 0x80ad8f3
                            v17 = v21;
                            v18 = 68 * v17;
                            if (*(int32_t *)(v18 + (int32_t)&g347) == 1) {
                                // 0x80ad90f
                                v19 = (int32_t *)(v18 + (int32_t)&g354);
                                str = *v19;
                                if (*(int32_t *)(str + 8) == 4) {
                                    // 0x80ad92e
                                    if (*(int32_t *)(str + 4) == *(int32_t *)(v2 + 4)) {
                                        // 0x80ad952
                                        if (strcmp((char *)*(int32_t *)str, (char *)*str2) == 0) {
                                            // 0x80ad980
                                            if (*(int32_t *)(*v19 + 32) != 0) {
                                                // 0x80ad99a
                                                v20 = *(int32_t *)(v18 + (int32_t)&g346);
                                                LYmove(v20, *(int32_t *)(v18 + (int32_t)&g345));
                                                LYwaddnstr(LYwin, unchecked_radio, strlen(unchecked_radio));
                                                LYSetHilite(v17, unchecked_radio);
                                            }
                                        }
                                    }
                                }
                            }
                            // 0x80ada09
                            v21 = v17 + 1;
                        }
                    }
                    // 0x80ada1b
                    lynx_stop_radio_color();
                    HText_activateRadioButton(str2);
                    LYSetHilite(cur, checked_radio);
                    v13 = (char *)270;
                } else {
                    // 0x80ad8bc
                    v13 = (char *)270;
                    if (user_mode == 0) {
                        // 0x80ad8c9
                        HTUserMsg(gettext("One radio button must be checked at all times!"));
                        v13 = (char *)270;
                    }
                }
            }
            goto lab_0x80addc2;
        }
        case 5: {
            goto lab_0x80add3d;
        }
        case 6: {
            // 0x80adad2
            v13 = (char *)270;
            if (*(int32_t *)(v2 + 80) != 1) {
                // 0x80adae1
                HText_ResetForm(str2);
                *refresh_screen = 1;
                v13 = (char *)270;
            }
            goto lab_0x80addc2;
        }
        case 7: {
            // 0x80ad6e5
            if (*v7 != 0) {
                int32_t v22 = *(int32_t *)(v2 + 80); // 0x80ad712
                int32_t v23 = *(int32_t *)(v2 + 20);
                int32_t * v24 = (int32_t *)(v2 + 32);
                int32_t v25 = LYhandlePopupList(*v24, *v10, *v9, v8, v23, *(int32_t *)(v2 + 76), v22, 0);
                if (v22 != 1) {
                    // 0x80ad7b3
                    *v24 = v25;
                    int32_t v26 = *v7;
                    int32_t v27 = v26; // 0x80ad85b
                    if (v25 > 0) {
                        int32_t v28 = 1; // 0x80ad845
                        int32_t v29 = *(int32_t *)(v26 + 12);
                        int32_t v30 = v29; // 0x80ad85b
                        int32_t v31 = v28; // 0x80ad85b
                        v27 = v29;
                        while (v28 != v25) {
                            // 0x80ad845
                            v28 = v31 + 1;
                            v29 = *(int32_t *)(v30 + 12);
                            v30 = v29;
                            v31 = v28;
                            v27 = v29;
                        }
                    }
                    // 0x80ad85d
                    *v4 = (int32_t)*(char **)v27;
                    *(int32_t *)(v2 + 68) = *(int32_t *)(v27 + 4);
                    *(int32_t *)(v2 + 88) = *(int32_t *)(v27 + 8);
                    v13 = enable_scrollback != 0 ? (char *)12 : (char *)23;
                } else {
                    // 0x80ad71e
                    v13 = enable_scrollback != 0 ? (char *)12 : (char *)23;
                }
            } else {
                // 0x80ad6ef
                HTAlert(gettext("Bad HTML!!  Unable to create popup window!"));
                v13 = (char *)270;
            }
            goto lab_0x80addc2;
        }
        case 9: {
            goto lab_0x80ada44;
        }
        case 11: {
            goto lab_0x80ada44;
        }
        case 12: {
            if (redraw_only == 0) {
                // 0x80adb20
                v14 = (char *)270;
                if (immediate_submit == 0) {
                    // 0x80adb26
                    v14 = (char *)form_getstr(cur, use_last_tfpos, 0);
                }
                // 0x80adb44
                if (*(int32_t *)(v2 + 80) != 1) {
                    goto lab_0x80adb82;
                } else {
                    if (immediate_submit == 0) {
                        switch ((int32_t)v15) {
                            case 13: {
                                goto lab_0x80adb61;
                            }
                            case 10: {
                                goto lab_0x80adb61;
                            }
                            default: {
                                goto lab_0x80adb82;
                            }
                        }
                    } else {
                        goto lab_0x80adb61;
                    }
                }
            } else {
                // 0x80adafd
                v13 = (char *)form_getstr(cur, use_last_tfpos, 1);
                goto lab_0x80addc2;
            }
        }
        case 13: {
            goto lab_0x80add3d;
        }
        default: {
            goto lab_0x80addc2;
        }
    }
  lab_0x80ada44:;
    int32_t v32 = form_getstr(cur, use_last_tfpos, redraw_only); // 0x80ada5a
    char * v33 = (char *)*v4;
    char * v34 = v33; // 0x80ada6b
    if (*v11 == 2) {
        uint32_t v35 = LYstrCells(v33); // 0x80ada76
        v34 = &star_string[0];
        if (v35 <= 1023) {
            int32_t v36 = LYstrCells((char *)*v4); // 0x80ada8b
            v34 = (char *)((int32_t)&star_string + 1023 - v36);
        }
    }
    // 0x80adabb
    LYSetHilite(cur, v34);
    v13 = (char *)v32;
    goto lab_0x80addc2;
  lab_0x80add3d:
    // 0x80add3d
    v13 = (char *)270;
    char * v38; // 0x80ad5a0
    if (*(int32_t *)(v2 + 80) == 1) {
        goto lab_0x80addc2;
    } else {
        int32_t * v47 = (int32_t *)(v2 + 52);
        if (*(char *)(v2 + 64) != 0) {
            // 0x80add53
            if (*v47 != 3) {
                // 0x80add5e
                LYforce_no_cache = 1;
                reloading = 1;
            }
        }
        char * v48 = (char *)HText_SubmitForm(str2, newdoc2, (char *)v3, (char *)v5); // 0x80add8c
        if (*v47 != 3) {
            // 0x80adda2
            *(int32_t *)(v6 + 24) = 0;
            *(char *)(v6 + 32) = 0;
            v38 = v48;
        } else {
            // 0x80add9a
            *refresh_screen = 1;
            v38 = v48;
        }
        goto lab_0x80addb3;
    }
  lab_0x80addc2:
    // 0x80addc2
    LYforce_no_cache = 0;
    reloading = 0;
    char * v37 = v13; // 0x80addc9
    goto lab_0x80addd0;
  lab_0x80addd0:
    // 0x80addd0
    if (v8 != NULL) {
        // 0x80addd6
        free((int32_t *)v8);
    }
    // 0x80addee
    return (int32_t)v37;
  lab_0x80addb3:
    // 0x80addb3
    v13 = (char *)270;
    v37 = (char *)2046;
    if (v38 == NULL) {
        goto lab_0x80addc2;
    } else {
        goto lab_0x80addd0;
    }
  lab_0x80adb82:
    if (immediate_submit != 0) {
        goto lab_0x80adbaf;
    } else {
        switch ((int32_t)v15) {
            case 13: {
                goto lab_0x80adba1;
            }
            case 10: {
                goto lab_0x80adba1;
            }
            default: {
                if (v14 != (char *)2088) {
                    goto lab_0x80add26;
                } else {
                    goto lab_0x80adba1;
                }
            }
        }
    }
  lab_0x80adbaf:
    // 0x80adbaf
    LYSetHilite(cur, (char *)*v4);
    int32_t * v39 = (int32_t *)(v2 + 48); // 0x80adbc7
    int32_t v40 = *v39; // 0x80adbc7
    char * v41; // 0x80ad5a0
    int32_t * v42; // 0x80adbfe
    if (v40 == 0) {
        goto lab_0x80adbdb;
    } else {
        char * v43 = (char *)v40;
        char v44 = *v43; // 0x80adbd4
        if (v44 != 0) {
            // 0x80adbfb
            v42 = (int32_t *)(v2 + 52);
            if (*v42 != 3 || no_mail == 0) {
                if (immediate_submit != 0) {
                    goto lab_0x80adcac;
                } else {
                    // 0x80adc37
                    v41 = v43;
                    if (no_file_url == 0) {
                        goto lab_0x80adc7e;
                    } else {
                        // 0x80adc42
                        v41 = v43;
                        if (v44 != 102 == (v44 != 70)) {
                            goto lab_0x80adc7e;
                        } else {
                            // 0x80adc5c
                            v13 = (char *)2088;
                            if (strncasecomp(v43, "file:", 5) == 0) {
                                goto lab_0x80addc2;
                            } else {
                                // 0x80adc5c
                                v41 = (char *)*v39;
                                goto lab_0x80adc7e;
                            }
                        }
                    }
                }
            } else {
                // 0x80adc11
                HTAlert(gettext("Mail disallowed!  Cannot submit."));
                v13 = (char *)270;
                goto lab_0x80addc2;
            }
        } else {
            goto lab_0x80adbdb;
        }
    }
  lab_0x80adb61:
    // 0x80adb61
    v13 = peek_mouse_link() < 0 ? (char *)9 : (char *)2087;
    goto lab_0x80addc2;
  lab_0x80adbdb:
    // 0x80adbdb
    HTUserMsg(gettext("** Bad HTML!!  No form action defined. **"));
    v13 = (char *)270;
    goto lab_0x80addc2;
  lab_0x80adba1:
    // 0x80adba1
    if (peek_mouse_link() != -1) {
        goto lab_0x80add26;
    } else {
        goto lab_0x80adbaf;
    }
  lab_0x80add26:
    // 0x80add26
    LYSetHilite(cur, (char *)*v4);
    v13 = v14;
    goto lab_0x80addc2;
  lab_0x80adcac:
    // 0x80adcac
    if (*(char *)(v2 + 64) != 0) {
        // 0x80adcb7
        if (*v42 != 3) {
            // 0x80adcc2
            LYforce_no_cache = 1;
            reloading = 1;
        }
    }
    int32_t v45 = *v4; // 0x80adcd3
    char * v46 = (char *)HText_SubmitForm(str2, newdoc2, (char *)v3, (char *)v45); // 0x80adcf3
    if (*v42 != 3) {
        // 0x80add09
        *(int32_t *)(v6 + 24) = 0;
        *(char *)(v6 + 32) = 0;
        v38 = v46;
    } else {
        // 0x80add01
        *refresh_screen = 1;
        v38 = v46;
    }
    goto lab_0x80addb3;
  lab_0x80adc7e:
    // 0x80adc7e
    v13 = (char *)2088;
    if (strncasecomp(v41, "lynx", 4) != 0) {
        goto lab_0x80adcac;
    } else {
        goto lab_0x80addc2;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYForms.c
// Address range: 0x80addf9 - 0x80ade3e
// Line range:    350 - 358
int32_t change_form_link(int32_t cur, int32_t * newdoc2, char * refresh_screen, char use_last_tfpos, char immediate_submit) {
    // 0x80addf9
    return change_form_link_ex(cur, newdoc2, refresh_screen, use_last_tfpos, immediate_submit, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYForms.c
// Address range: 0x80ade3e - 0x80ade4b
// Line range:    363 - 365
void LYSetLastTFPos(int32_t pos) {
    // 0x80ade3e
    LastTFPos = pos;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYForms.c
// Address range: 0x80ade4b - 0x80aecd1
// Line range:    370 - 850
int32_t form_getstr(int32_t cur, char use_last_tfpos, char redraw_only) {
    int32_t v1 = __readgsdword(20); // 0x80ade67
    int32_t v2 = *(int32_t *)(68 * cur + (int32_t)&g354); // 0x80ade7f
    int32_t v3 = v2 + 12; // 0x80ade91
    int32_t * str2 = (int32_t *)v3; // 0x80ade91
    int32_t str = *str2; // 0x80ade91
    int32_t * v4 = LYwin;
    int32_t v5 = v4 == NULL ? -1 : (int32_t)*(int16_t *)&g255;
    int32_t v6 = *(int32_t *)(v2 + 24); // 0x80adf88
    int32_t v7 = v6 < 1024 ? v6 : 1023;
    uint32_t len = strlen((char *)str); // 0x80adfd2
    int32_t * str4 = (int32_t *)str; // 0x80adfe1
    int32_t * v8; // 0x80ae006
    if (len > v7) {
        // 0x80adfe7
        v8 = (int32_t *)(str - v7 + strlen((char *)*str2));
        str4 = v8;
        if (*(int32_t *)(v2 + 80) != 0) {
            goto lab_0x80ae095;
        } else {
            // 0x80ae019
            if (*(int32_t *)(v2 + 52) != 3) {
                goto lab_0x80ae032;
            } else {
                // 0x80ae027
                str4 = v8;
                if (no_mail != 0) {
                    goto lab_0x80ae095;
                } else {
                    goto lab_0x80ae032;
                }
            }
        }
    } else {
        goto lab_0x80ae095;
    }
  lab_0x80aeb6f_9:;
    // 0x80aeb6f
    int32_t str5; // bp-17420, 0x80ade4b
    char v9; // 0x80ade4b
    if (v9 != 0) {
        int32_t str3 = *str2; // 0x80aeb82
        if (str3 != (int32_t)str4) {
            int32_t len2 = strlen((char *)str3); // 0x80aebbc
            int32_t len3 = strlen((char *)str4); // 0x80aebd0
            *(char *)((len2 > len3 ? len2 - len3 : 0) + *str2) = 0;
            HTSACat((char **)v3, (char *)&str5);
            HTUserMsg(gettext("Modified tail combined with head of form field value."));
        } else {
            // 0x80aeb8d
            HTSACopy((char **)v3, (char *)&str5);
        }
        // 0x80aec5d
        if (LYtrimInputFields != 0) {
            // 0x80aec68
            LYTrimTrailing((char *)*str2);
        }
        int32_t v10 = *str2; // 0x80aec7f
        if (v10 != 0) {
            // 0x80aec86
            if (*(char *)v10 != 0) {
                // 0x80aec96
                *(int32_t *)(v2 + 88) = current_char_set;
            }
        }
    }
    // 0x80aeca5
    int32_t * v11; // 0x80ade4b
    int32_t v12 = (int32_t)v11; // 0x80aecab
    goto lab_0x80aecb1;
  lab_0x80aecb1:;
    int32_t result = v12; // 0x80aecc1
    if (v1 != __readgsdword(20)) {
        // 0x80aecc3
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80aecc8
    return result;
  lab_0x80aea45:;
    // 0x80aea45
    int32_t v13; // 0x80ade4b
    int32_t v14 = v13 - 1;
    int32_t * v15; // 0x80ade4b
    int32_t * v16 = v15;
    int32_t v17; // 0x80ae988
    if (v17 == 0) {
        // break -> 0x80aea4e
        goto lab_0x80aea4e;
    }
    int32_t v18; // bp-17464, 0x80ade4b
    char v19; // 0x80ade4b
    if (v19 == 0) {
        // 0x80aea90
        LYEdit1(&v18, 0, 9, 1);
    }
    int32_t v20 = v14; // 0x80aeac9
    int32_t * v21 = v16; // 0x80aeac9
    if (v14 == 0) {
        // break (via goto) -> 0x80aeacf
        goto lab_0x80aeacf;
    }
    goto lab_0x80ae961;
  lab_0x80ae9f2:;
    // 0x80ae9f2
    int32_t * v28; // 0x80ade4b
    int32_t v29 = *v28; // 0x80aea24
    int32_t * v30; // 0x80ade4b
    int32_t v31 = *v30; // 0x80aea37
    int32_t * v24; // 0x80ade4b
    v15 = v24;
    char v25; // 0x80ade4b
    v9 = v25;
    v11 = v24;
    if (v29 == v31) {
        // break (via goto) -> 0x80aeb6f
        goto lab_0x80aeb6f_9;
    }
    goto lab_0x80aea45;
  lab_0x80ae709:;
    // 0x80ae709
    char v32; // 0x80ade4b
    v25 = v32;
    char v33; // 0x80ade4b
    char v34 = v33;
    int32_t * v35; // 0x80ade4b
    uint32_t v26; // 0x80ade4b
    if (v26 == 24) {
        // 0x80ae712
        if (HTCJK == 0) {
            // 0x80ae71b
            v9 = v25;
            v11 = v35;
            if (*(int32_t *)(4 * current_char_set + (int32_t)&LYlowest_eightbit) > 151) {
                // break (via goto) -> 0x80aeb6f
                goto lab_0x80aeb6f_9;
            }
        }
    }
    // 0x80ae732
    v9 = v25;
    v11 = (int32_t *)9;
    if (v26 == 3) {
        // break (via goto) -> 0x80aeb6f
        goto lab_0x80aeb6f_9;
    }
    // 0x80ae74a
    v12 = 270;
    if (v26 == 5) {
        goto lab_0x80aecb1;
    }
    if (v26 == 4) {
        // 0x80ae76b
        textfields_need_activation = 1;
        v9 = v25;
        v11 = v35;
        goto lab_0x80aeb6f_9;
    }
    if (v26 == 0) {
        bool v36; // 0x80ade4b
        if (v35 != (int32_t *)-1) {
            uint32_t v37 = (int32_t)v35; // 0x80ae79d
            if ((v37 & 0x8800) == 0) {
                // 0x80ae7c3
                v36 = *(int16_t *)((2 * v37 & 4094) + 0x8197ea2) == 21;
            } else {
                // 0x80ae7ac
                v36 = v37 % 256 == 21;
            }
        } else {
            // 0x80ae789
            v36 = keymap[0] == 21;
        }
        // 0x80ae7f1
        v9 = v25;
        v11 = v35;
        if (v36) {
            // break (via goto) -> 0x80aeb6f
            goto lab_0x80aeb6f_9;
        }
    }
    int32_t v38; // 0x80ade4b
    int32_t v39; // 0x80ade4b
    int32_t * v40; // 0x80ade4b
    if (v39 == -1 == v38 == 0 == v26 == 17) {
        // 0x80ae826
        int32_t v41; // 0x80ade4b
        if (textfield_prompt_at_left_edge == 0) {
            // 0x80ae85f
            if (strcmp((char *)&str5, (char *)str4) == 0) {
                // 0x80ae8a9
                v12 = (int32_t)v35;
                goto lab_0x80aecb1;
            }
            // 0x80ae87e
            v41 = HTConfirmDefault(gettext("Do you want to go back to the previous document?"), 0);
        } else {
            // 0x80ae83b
            v41 = HTConfirmDefault(gettext("Do you want to go back to the previous document?"), 0);
        }
        // 0x80ae8a0
        if (v41 == 1) {
            // 0x80ae8a9
            v12 = (int32_t)v35;
            goto lab_0x80aecb1;
        }
        // 0x80ae8ba
        mustshow = 1;
        if (*v40 != 1) {
            // 0x80ae8e5
            statusline(gettext("Enter text.  Use arrows or tab to move off of field."));
        } else {
            // 0x80ae8c8
            statusline(gettext("Use arrows or tab to move off of field."));
        }
    }
    // 0x80ae900
    if (*v40 != 1) {
        // break -> 0x80ae945
        goto lab_0x80ae945_2;
    }
    uint32_t v42 = v26 - 13; // 0x80ae914
    if (v42 < 22) {
        if ((1 << v42 % 32 & 0x3000ff) != 0) {
            // break -> 0x80ae945
            goto lab_0x80ae945_2;
        }
    }
    char v43 = v34; // 0x80ade4b
    int32_t v44; // 0x80ade4b
    int32_t v45 = v44; // 0x80ade4b
    char v46 = v25; // 0x80ade4b
    int32_t v47; // 0x80ade4b
    int32_t v48 = v47; // 0x80ade4b
    goto lab_0x80ae16b;
  lab_0x80ae095:;
    int32_t v81 = v5 + *(int32_t *)(v2 + 20); // 0x80adf25
    int32_t v82 = LYcols - (int32_t)(LYShowScrollbar != 0); // 0x80adf42
    int32_t v83 = v81 > v82 ? v82 : v81;
    LYSetupEdit(&v18, (char *)str4, v7, v83 - v5);
    int32_t v84 = LastTFPos; // 0x80ae0ee
    int32_t v85 = peek_mouse_levent(); // 0x80ae129
    LYRefreshEdit(&v18);
    v12 = 0;
    int32_t v79; // 0x80ade4b
    char * v76; // 0x80ade4b
    char * v77; // 0x80ade4b
    int32_t v78; // 0x80ade4b
    char * v80; // 0x80ade4b
    char v50; // 0x80ade4b
    char v49; // 0x80ade4b
    int32_t v73; // bp-17528, 0x80ade4b
    int32_t v66; // 0x80ade4b
    uint32_t v75; // 0x80ae476
    if (redraw_only == 0) {
        int32_t v86 = v66 > v84 == !((use_last_tfpos == 0 | v84 < 0)) ? v84 : v66;
        v38 = use_last_tfpos != 0 | v85 == 0 ? v86 : 0;
        v40 = (int32_t *)(v2 + 80);
        char v87 = 0;
        int32_t v88 = -1; // 0x80ade4b
        char v89 = 1;
        char v90 = 0; // 0x80ade4b
        while (true) {
            char v56 = v89;
            v43 = v87;
            v45 = v88;
            v46 = v90;
            int32_t v91; // 0x80ade4b
            v48 = v91;
            while (true) {
              lab_0x80ae16b:
                // 0x80ae16b
                v49 = v46;
                v50 = v43;
                int32_t v51 = v45; // 0x80ade4b
                int32_t v52 = v48; // 0x80ade4b
                while (true) {
                    int32_t v53 = v52;
                    int32_t v54 = v51;
                    get_mouse_link();
                    int32_t v55 = LYgetch_input(); // 0x80ae17a
                    while (v56 == 0) {
                        // 0x80ae18e
                        if (EditBinding(v55) == 1) {
                            // break -> 0x80ae1b4
                            break;
                        }
                        // 0x80ae1a1
                        if (EditBinding(v55) == 24) {
                            // break -> 0x80ae1b4
                            break;
                        }
                        get_mouse_link();
                        v55 = LYgetch_input();
                    }
                    int32_t * v57 = (int32_t *)v55;
                    v9 = v49;
                    v11 = v57;
                    if ((int16_t)v55 > -1 == (v55 & 2048) != 0 == (v57 != (int32_t *)-1)) {
                        // break (via goto) -> 0x80aeb6f
                        goto lab_0x80aeb6f_9;
                    }
                    int32_t * v58; // 0x80ade4b
                    int32_t v59; // 0x80ade4b
                    int32_t v60; // 0x80ade4b
                    int32_t v61; // 0x80ade4b
                    if (v57 != (int32_t *)285) {
                        int32_t * v62 = (int16_t)v55 <= -1 ? v57 : (int32_t *)(v55 | v53);
                        v61 = -1;
                        v58 = v62;
                        v60 = 0;
                        v59 = 0;
                        if (v54 != -1) {
                            int32_t v63 = (int32_t)v62; // 0x80ae2f0
                            v61 = -1;
                            v58 = v62;
                            v60 = 0;
                            v59 = 0;
                            if (v54 == v63) {
                                // 0x80ae2fe
                                v61 = -1;
                                v58 = (int32_t *)(v63 | 0x1000);
                                v60 = 0;
                                v59 = 0;
                            }
                        }
                    } else {
                        // 0x80ae1f9
                        int32_t v64; // bp-17572, 0x80ade4b
                        function_804acb4(&v64);
                        int32_t * v65 = LYwin;
                        v61 = -1;
                        v58 = v57;
                        v60 = 0;
                        v59 = v53;
                        if (v66 == (v65 == NULL ? -1 : 0x10000 * (int32_t)v65 >> 16)) {
                            int32_t v67 = v66 - (v65 == NULL ? -1 : (int32_t)*(int16_t *)&g255); // 0x80ae27c
                            v61 = v67 >= 0 ? v67 : -v67;
                            v58 = v57;
                            v60 = v67 >= 0 ? 15 : 17;
                            v59 = v53;
                        }
                    }
                    // 0x80ae312
                    v35 = v58;
                    v9 = v49;
                    v11 = v35;
                    if (peek_mouse_link() != -1) {
                        // break (via goto) -> 0x80aeb6f
                        goto lab_0x80aeb6f_9;
                    }
                    // 0x80ae320
                    v47 = v59;
                    v39 = v61;
                    int32_t v68 = v60; // 0x80ae327
                    if (v60 == 0) {
                        // 0x80ae329
                        v68 = EditBinding((int32_t)v35);
                    }
                    int32_t v69 = v68;
                    int32_t v70 = -1; // 0x80ae34a
                    int32_t v71 = v69; // 0x80ae34a
                    if ((char)v69 <= 255) {
                        // 0x80ae34c
                        v70 = -1;
                        v71 = v69;
                        if ((v69 & 0x1000) == 0) {
                            // 0x80ae35b
                            v70 = (int32_t)v35;
                            v71 = v69 & -129;
                        }
                    }
                    // 0x80ae37d
                    v26 = v71;
                    v44 = v70;
                    int32_t v72; // 0x80ade4b
                    if (v26 != 29) {
                        if (v26 != 30) {
                            // 0x80ae3b7
                            v9 = v49;
                            v11 = v35;
                            if ((v26 || 4) == 6) {
                                // break (via goto) -> 0x80aeb6f
                                goto lab_0x80aeb6f_9;
                            }
                            if ((v26 & 0x1000) != 0) {
                                // 0x80ae3e0
                                v9 = v49;
                                v11 = (int32_t *)(v26 % 256 | 2048);
                                goto lab_0x80aeb6f_9;
                            }
                            if (v26 == 23) {
                                // 0x80ae402
                                mustshow = 1;
                                statusline(gettext("Enter Lynx keystroke command: "));
                                v9 = v49;
                                v11 = (int32_t *)LYgetch();
                                goto lab_0x80aeb6f_9;
                            }
                            // 0x80ae42d
                            v33 = v50;
                            v32 = v49;
                            if (v26 != 37) {
                                // break -> 0x80ae709
                                break;
                            }
                            char * str6 = get_clip_grab(); // 0x80ae43a
                            v73 = 0;
                            v9 = v49;
                            v11 = v35;
                            if (str6 == NULL) {
                                // break (via goto) -> 0x80aeb6f
                                goto lab_0x80aeb6f_9;
                            }
                            uint32_t len4 = strlen(str6); // 0x80ae465
                            if (len4 >= 1) {
                                int32_t v74 = (int32_t)str6;
                                v75 = len4 + v74;
                                v76 = str6;
                                v77 = str6;
                                v78 = v74;
                                v79 = v74;
                                v80 = str6;
                                if (v75 > v74) {
                                    goto lab_0x80ae4a0;
                                } else {
                                    goto lab_0x80ae5c8;
                                }
                            }
                            // 0x80ae6f0
                            HTInfoMsg(gettext("Clipboard empty or Not text data."));
                            v72 = v47;
                        } else {
                            // 0x80ae3a3
                            v72 = v47 | 0x2000;
                        }
                    } else {
                        // 0x80ae386
                        v72 = v47 | 0x4000;
                    }
                    // 0x80ae16b
                    v51 = v44;
                    v52 = v72;
                }
                goto lab_0x80ae709;
            }
          lab_0x80ae945_2:
            // 0x80ae945
            if ((v39 >= 0 ? v39 : 1) != 0) {
                // 0x80ae961
                while (true) {
                    // 0x80ae961
                    char v92; // 0x80ade4b
                    v19 = v92;
                    int32_t * v93; // 0x80ade4b
                    int32_t * v94 = v93;
                    int32_t v95; // 0x80ade4b
                    int32_t v96 = v95;
                    v20 = v96;
                    v21 = v94;
                    while (true) {
                      lab_0x80ae961:;
                        int32_t * v22 = v21;
                        v13 = v20;
                        int32_t v23; // 0x80ae967
                        v17 = LYEdit1(&v18, (int32_t)v22, v23, 1);
                        v15 = v22;
                        if (v17 >= 0) {
                            goto lab_0x80aea45;
                        } else {
                            // 0x80ae9a0
                            v24 = (int32_t *)-v17;
                            v9 = v25;
                            v11 = v24;
                            if (v26 != 18 == (v26 != 16)) {
                                // break (via goto) -> 0x80aeb6f
                                goto lab_0x80aeb6f_9;
                            }
                            int32_t v27 = nlinks; // 0x80ae9ca
                            v15 = v24;
                            if (cur > -1 == v27 > cur) {
                                if (v26 != 16) {
                                    // 0x80ae9ec
                                    v15 = v24;
                                    if (cur < 1) {
                                        goto lab_0x80aea45;
                                    } else {
                                        goto lab_0x80ae9f2;
                                    }
                                } else {
                                    // 0x80ae9dd
                                    v15 = v24;
                                    if (v27 - 1 > cur) {
                                        goto lab_0x80ae9f2;
                                    } else {
                                        goto lab_0x80aea45;
                                    }
                                }
                            } else {
                                goto lab_0x80aea45;
                            }
                        }
                    }
                  lab_0x80aea4e:;
                    int32_t v97 = HTCJK; // 0x80aea4e
                    char v98 = v19 == 0 | v16 > (int32_t *)254 | v16 < (int32_t *)128 | v97 == 0;
                    v95 = v14;
                    v93 = v16;
                    v92 = v98;
                    if (v14 == 0) {
                        // break -> 0x80aeacf
                        break;
                    }
                }
            }
          lab_0x80aeacf:
            // 0x80aeacf
            v89 = v56;
            char v99 = 1; // 0x80aeadb
            if (v66 < v7) {
                // 0x80aeae6
                v99 = 0;
                if (v34 != 0) {
                    // 0x80aeafd
                    mustshow = 1;
                    statusline(gettext("Enter text.  Use arrows or tab to move off of field."));
                    v99 = 0;
                }
            }
            // 0x80aeb1f
            v87 = v99;
            int32_t strcmp_rc = strcmp((char *)str4, (char *)&str5); // 0x80aeb35
            if (v89 != 0) {
                // 0x80aeb4e
                LYRefreshEdit(&v18);
            }
            // 0x80aeb5c
            LYSetLastTFPos(v38);
            v88 = v44;
            v90 = strcmp_rc == 0 ? v25 : 1;
            v91 = v47;
        }
        goto lab_0x80aeb6f_9;
    } else {
        goto lab_0x80aecb1;
    }
  lab_0x80ae032:
    // 0x80ae032
    HTUserMsg(gettext("Form field value exceeds buffer length!  Trim the tail."));
    show_formlink_statusline((int32_t *)v2, redraw_only == 0 ? 2 : 0);
    LYmove(v4 == NULL ? -1 : 0x10000 * (int32_t)v4 >> 16, v5);
    str4 = v8;
    goto lab_0x80ae095;
  lab_0x80ae4a0:;
    int32_t v100 = v78;
    char * v101 = v77; // 0x80ae4b7
    char * v102 = v76;
    unsigned char v103 = *v102; // 0x80ae4a6
    char v104; // 0x80ade4b
    char * v105; // 0x80ade4b
    char * v106; // 0x80ade4b
    if (v103 < 32) {
        // 0x80ae4b1
        v104 = v103;
        if (v102 > v101) {
            // 0x80ae4bf
            LYEditInsert(&v18, v101, v100 - (int32_t)v101, -1, 1);
            v104 = *v102;
            goto lab_0x80ae4fd;
        } else {
            goto lab_0x80ae4fd;
        }
    } else {
        // 0x80ae55a
        v105 = (char *)(v100 + 1);
        v106 = v101;
        goto lab_0x80ae561;
    }
  lab_0x80ae5c8:;
    char * v107 = v80; // 0x80ae5d4
    int32_t v108 = v79; // 0x80ae5d4
    int32_t v109 = v79; // 0x80ae5d4
    char * v110 = v80; // 0x80ae5d4
    if (v75 <= v79) {
        goto lab_0x80ae5e3;
    } else {
        goto lab_0x80ae5d6;
    }
  lab_0x80ae5e3:;
    uint32_t v111 = v109 + 1; // 0x80ae5e9
    if (v111 >= v75) {
        goto lab_0x80ae61c;
    } else {
        // 0x80ae5f4
        if (*v110 != 10) {
            goto lab_0x80ae61c;
        } else {
            // 0x80ae601
            HTSACopy((char **)&v73, (char *)v111);
            goto lab_0x80ae61c;
        }
    }
  lab_0x80ae5d6:;
    char * v112 = v107; // 0x80ae5e1
    if (*v107 == 13) {
        int32_t v113 = v108 + 1; // 0x80ae5c1
        char * v114 = (char *)v113;
        v107 = v114;
        v108 = v113;
        v112 = v114;
        if (v75 <= v113) {
            goto lab_0x80ae5e3_2;
        } else {
            goto lab_0x80ae5d6;
        }
    } else {
        goto lab_0x80ae5e3_2;
    }
  lab_0x80ae4fd:
    // 0x80ae4fd
    if (v104 != 9) {
        // 0x80ae5c8
        v79 = (int32_t)v102;
        v80 = v102;
        goto lab_0x80ae5c8;
    } else {
        // 0x80ae516
        LYEditInsert(&v18, " ", 1, -1, 1);
        char * v115 = (char *)((int32_t)v102 + 1); // 0x80ae545
        v105 = v115;
        v106 = v115;
        goto lab_0x80ae561;
    }
  lab_0x80ae561:;
    char * v116 = v106;
    char * v117 = v105; // 0x80ae561
    int32_t v118 = (int32_t)v117;
    v76 = v117;
    v77 = v116;
    v78 = v118;
    if (v75 > v118) {
        goto lab_0x80ae4a0;
    } else {
        // 0x80ae573
        v79 = v118;
        v80 = v117;
        if (v117 > v116) {
            // 0x80ae581
            LYEditInsert(&v18, v116, v118 - (int32_t)v116, -1, 1);
            v79 = v118;
            v80 = v117;
            goto lab_0x80ae5c8;
        } else {
            goto lab_0x80ae5c8;
        }
    }
  lab_0x80ae61c:
    // 0x80ae61c
    get_clip_release();
    char v119 = 1; // 0x80ae62d
    if (v66 < v7) {
        // 0x80ae638
        v119 = 0;
        if (v50 == 0) {
            goto lab_0x80ae671;
        } else {
            // 0x80ae64f
            mustshow = 1;
            statusline(gettext("Enter text.  Use arrows or tab to move off of field."));
            v119 = 0;
            goto lab_0x80ae671;
        }
    } else {
        goto lab_0x80ae671;
    }
  lab_0x80ae5e3_2:
    // 0x80ae5e3
    v109 = (int32_t)v112;
    v110 = v112;
    goto lab_0x80ae5e3;
  lab_0x80ae671:;
    int32_t strcmp_rc2 = strcmp((char *)str4, (char *)&str5); // 0x80ae687
    char v120 = strcmp_rc2 == 0 ? v49 : 1;
    int32_t v121 = v73; // 0x80ae697
    if (v121 == 0) {
        // 0x80ae6e0
        LYRefreshEdit(&v18);
        v33 = v119;
        v32 = v120;
        goto lab_0x80ae709;
    } else {
        // 0x80ae6a1
        put_clip((char *)v121);
        v9 = v120;
        v11 = (int32_t *)10;
        if (v73 == 0) {
            goto lab_0x80aeb6f_9;
        } else {
            // 0x80ae6b9
            free((int32_t *)v73);
            v73 = 0;
            v9 = v120;
            v11 = (int32_t *)10;
            goto lab_0x80aeb6f_9;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYForms.c
// Address range: 0x80aecd1 - 0x80af3e5
// Line range:    857 - 1039
void show_formlink_statusline(int32_t * form, int32_t for_what) {
    int32_t v1 = (int32_t)form;
    int32_t v2 = *(int32_t *)(v1 + 8); // 0x80aecda
    g364 = v2;
    int32_t v3; // bp-12, 0x80aecd1
    switch (v2) {
        case 1: {
            // 0x80af23c
            if (*(int32_t *)(v1 + 80) == 1) {
                // 0x80af247
                statusline(gettext("UNMODIFIABLE form text field.  Use UP or DOWN arrows or tab to move off."));
                // 0x80af3e3
                return;
            }
            if (for_what != 0) {
                // 0x80af27f
                statusline(gettext("(Text entry field) Enter text.  Use UP or DOWN arrows or tab to move off."));
            } else {
                // 0x80af266
                statusline(gettext("(Text entry field) Inactive.  Press <return> to activate."));
            }
            // 0x80af3e3
            return;
        }
        case 2: {
            // 0x80aecf6
            if (*(int32_t *)(v1 + 80) == 1) {
                // 0x80aed01
                statusline(gettext("UNMODIFIABLE form password.  Use UP or DOWN arrows or tab to move off."));
                // 0x80af3e3
                return;
            }
            if (for_what != 0) {
                // 0x80aed39
                statusline(gettext("(Password entry field) Enter text.  Use UP or DOWN arrows or tab to move off."));
            } else {
                // 0x80aed20
                statusline(gettext("(Password entry field) Inactive.  Press <return> to activate."));
            }
            // 0x80af3e3
            return;
        }
        case 3: {
            // 0x80aed8f
            if (*(int32_t *)(v1 + 80) != 1) {
                // 0x80aedb3
                statusline(gettext("(Checkbox Field)   Use right-arrow or <return> to toggle."));
            } else {
                // 0x80aed9a
                statusline(gettext("UNMODIFIABLE form checkbox.  Use UP or DOWN arrows or tab to move off."));
            }
            // 0x80af3e3
            return;
        }
        case 4: {
            // 0x80aedcc
            if (*(int32_t *)(v1 + 80) != 1) {
                // 0x80aedf0
                statusline(gettext("(Radio Button)   Use right-arrow or <return> to toggle."));
            } else {
                // 0x80aedd7
                statusline(gettext("UNMODIFIABLE form radio button.  Use UP or DOWN arrows or tab to move off."));
            }
            // 0x80af3e3
            return;
        }
        case 5: {
        }
        case 13: {
            // 0x80aefc7
            if (*(int32_t *)(v1 + 80) == 1) {
                // 0x80aefd2
                statusline(gettext("DISABLED form submit button.  Use UP or DOWN arrows or tab to move off."));
                // 0x80af3e3
                return;
            }
            // 0x80aefeb
            if (*(int32_t *)(v1 + 52) == 3) {
                // 0x80aeffa
                if (no_mail != 0) {
                    // 0x80af005
                    statusline(gettext("(mailto form submit button) Mail is disallowed so you cannot submit."));
                    // 0x80af3e3
                    return;
                }
                // 0x80af01e
                if (user_mode != 2) {
                    // 0x80af08c
                    statusline(gettext("(mailto form submit button) Use right-arrow or <return> to submit."));
                    // 0x80af3e3
                    return;
                }
                // 0x80af028
                v3 = 0;
                char * v4 = gettext("Submit mailto form to "); // 0x80af036
                HTSACopy((char **)&v3, v4);
                HTSACat((char **)&v3, (char *)*(int32_t *)(v1 + 48));
                statusline((char *)v3);
                if (v3 != 0) {
                    // 0x80af075
                    free((int32_t *)v3);
                    v3 = 0;
                }
                // 0x80af3e3
                return;
            }
            // 0x80af0a5
            if (*(char *)(v1 + 64) == 0) {
                if (user_mode != 2) {
                    // 0x80af1a9
                    statusline(gettext("(Form submit button) Use right-arrow or <return> to submit ('x' for no cache)."));
                    // 0x80af3e3
                    return;
                }
                // 0x80af145
                v3 = 0;
                char * v5 = gettext("Submit ('x' for no cache) to "); // 0x80af153
                HTSACopy((char **)&v3, v5);
                HTSACat((char **)&v3, (char *)*(int32_t *)(v1 + 48));
                statusline((char *)v3);
                if (v3 != 0) {
                    // 0x80af192
                    free((int32_t *)v3);
                    v3 = 0;
                }
                // 0x80af3e3
                return;
            }
            if (user_mode != 2) {
                // 0x80af122
                statusline(gettext("(Form submit button) Use right-arrow or <return> to submit."));
                // 0x80af3e3
                return;
            }
            // 0x80af0be
            v3 = 0;
            char * v6 = gettext("Submit to "); // 0x80af0cc
            HTSACopy((char **)&v3, v6);
            HTSACat((char **)&v3, (char *)*(int32_t *)(v1 + 48));
            statusline((char *)v3);
            if (v3 != 0) {
                // 0x80af10b
                free((int32_t *)v3);
                v3 = 0;
            }
            // 0x80af3e3
            return;
        }
        case 6: {
            // 0x80af1c2
            if (*(int32_t *)(v1 + 80) != 1) {
                // 0x80af1e6
                statusline(gettext("(Form reset button)   Use right-arrow or <return> to reset form to defaults."));
            } else {
                // 0x80af1cd
                statusline(gettext("DISABLED form reset button.  Use UP or DOWN arrows or tab to move off."));
            }
            // 0x80af3e3
            return;
        }
        case 7: {
            // 0x80aed52
            if (*(int32_t *)(v1 + 80) != 1) {
                // 0x80aed76
                statusline(gettext("(Option list) Hit return and use arrow keys and return to select option."));
            } else {
                // 0x80aed5d
                statusline(gettext("UNMODIFIABLE option list.  Use return or arrow keys to review or leave."));
            }
            // 0x80af3e3
            return;
        }
        case 9: {
            // 0x80af298
            if (*(int32_t *)(v1 + 80) == 1) {
                // 0x80af2a3
                statusline(gettext("UNMODIFIABLE form text field.  Use UP or DOWN arrows or tab to move off."));
                // 0x80af3e3
                return;
            }
            // 0x80af2bc
            v3 = 0;
            bool v7 = true; // 0x80af2d3
            char * v8 = NULL; // 0x80af2d3
            if (no_editor == 0 && editor != 0) {
                char * v9 = key_for_func_ext(86, for_what); // 0x80af2f5
                char * v10 = v9; // 0x80af301
                if (v9 == NULL) {
                    // 0x80af303
                    v10 = key_for_func_ext(85, for_what);
                }
                // 0x80af319
                v7 = true;
                v8 = NULL;
                if (v10 != NULL) {
                    // 0x80af31f
                    v7 = false;
                    v8 = v10;
                    if (*v10 != 0) {
                        if (for_what != 0) {
                            char * v11 = gettext("(Textarea) Enter text. Use UP/DOWN arrows or TAB to move off (%s for editor)."); // 0x80af35a
                            HTSprintf0((char **)&v3, v11);
                        } else {
                            char * v12 = gettext("(Textarea) Inactive.  Press <return> to activate (%s for editor)."); // 0x80af336
                            HTSprintf0((char **)&v3, v12);
                        }
                        // 0x80af375
                        statusline((char *)v3);
                        if (v3 != 0) {
                            // 0x80af387
                            free((int32_t *)v3);
                            v3 = 0;
                        }
                        // 0x80af3d1
                        free((int32_t *)v10);
                        // 0x80af3e3
                        return;
                    }
                }
            }
            // 0x80af39b
            if (for_what != 0) {
                // 0x80af3b7
                statusline(gettext("(Textarea) Enter text. Use UP/DOWN arrows or TAB to move off."));
                if (v7) {
                    // 0x80af3e3
                    return;
                }
            } else {
                // 0x80af3cb
                statusline(gettext("(Textarea) Inactive.  Press <return> to activate."));
                if (v7) {
                    // 0x80af3e3
                    return;
                }
            }
            // 0x80af3d1
            free((int32_t *)v8);
            // 0x80af3e3
            return;
        }
        case 11: {
            // 0x80af1ff
            if (*(int32_t *)(v1 + 80) != 1) {
                // 0x80af223
                statusline(gettext("(File entry field) Enter filename.  Use UP or DOWN arrows or tab to move off."));
            } else {
                // 0x80af20a
                statusline(gettext("UNMODIFIABLE file entry field.  Use UP or DOWN arrows or tab to move off."));
            }
            // 0x80af3e3
            return;
        }
        case 12: {
            // 0x80aee09
            if (*(int32_t *)(v1 + 80) == 1) {
                // 0x80aee14
                statusline(gettext("UNMODIFIABLE form field.  Use UP or DOWN arrows or tab to move off."));
                // 0x80af3e3
                return;
            }
            // 0x80aee2d
            if (*(int32_t *)(v1 + 52) == 3) {
                // 0x80aee38
                if (no_mail != 0) {
                    // 0x80aee43
                    statusline(gettext("(mailto form field) Mail is disallowed so you cannot submit."));
                    // 0x80af3e3
                    return;
                }
                if (for_what != 0) {
                    // 0x80aee7b
                    statusline(gettext("(mailto form field) Enter text.  Use <return> to submit, arrows to move off."));
                } else {
                    // 0x80aee62
                    statusline(gettext("(mailto form field) Inactive.  Press <return> to change."));
                }
                // 0x80af3e3
                return;
            }
            // 0x80aee94
            if (*(char *)(v1 + 64) != 0) {
                if (for_what != 0) {
                    // 0x80aeebe
                    statusline(gettext("(Form field) Enter text.  Use <return> to submit, arrows or tab to move off."));
                } else {
                    // 0x80aeea5
                    statusline(gettext("(Form field) Inactive. Press <return> to edit, press <return> twice to submit."));
                }
                // 0x80af3e3
                return;
            }
            // 0x80aeed7
            v3 = 0;
            char * v13 = key_for_func_ext(46, for_what); // 0x80aeeec
            if (v13 != NULL) {
                // 0x80aeefa
                if (*v13 != 0) {
                    if (for_what != 0) {
                        char * v14 = gettext("(Form field) Enter text.  Use <return> to submit (%s for no cache)."); // 0x80aef35
                        HTSprintf0((char **)&v3, v14);
                    } else {
                        char * v15 = gettext("(Form field) Inactive.  Use <return> to edit (%s to submit with no cache)."); // 0x80aef11
                        HTSprintf0((char **)&v3, v15);
                    }
                    // 0x80aef50
                    statusline((char *)v3);
                    if (v3 != 0) {
                        // 0x80aef62
                        free((int32_t *)v3);
                        v3 = 0;
                    }
                    // 0x80aefb0
                    free((int32_t *)v13);
                    // 0x80af3e3
                    return;
                }
            }
            if (for_what != 0) {
                // 0x80aef92
                statusline(gettext("(Form field) Enter text.  Use <return> to submit."));
            } else {
                // 0x80aef7c
                statusline(gettext("(Form field) Inactive.  Use <return> to edit."));
            }
            if (v13 == NULL) {
                // 0x80af3e3
                return;
            }
            // 0x80aefb0
            free((int32_t *)v13);
            // 0x80af3e3
            return;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80af3e8 - 0x80af48f
// Line range:    76 - 109
void set_environ(int32_t name, char * value, char * no_value) {
    char ** str = NULL; // bp-8, 0x80af3ee
    int32_t v1 = 4 * name; // 0x80af3f8
    int32_t v2 = *(int32_t *)(v1 + (int32_t)&g133); // 0x80af3f8
    HTSACopy((char **)&str, (char *)v2);
    HTSACat((char **)&str, "=");
    HTSACat((char **)&str, value == NULL ? no_value : value);
    putenv((char *)str);
    int32_t * v3 = (int32_t *)(v1 + (int32_t)&g300); // 0x80af455
    int32_t v4 = *v3; // 0x80af455
    if (v4 != 0) {
        // 0x80af460
        free((int32_t *)v4);
        *v3 = 0;
    }
    // 0x80af480
    *v3 = (int32_t)str;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80af48f - 0x80af52d
// Line range:    112 - 131
char * suggested_filename(int32_t * newdoc2) {
    char * result = NULL; // bp-12, 0x80af496
    if (HText_getSugFname() == NULL) {
        // 0x80af4bc
        HTSACopy(&result, (char *)*(int32_t *)((int32_t)newdoc2 + 4));
    } else {
        char * v1 = HText_getSugFname(); // 0x80af4a6
        HTSACopy(&result, v1);
    }
    // 0x80af4d1
    char * sug_filename; // bp-16, 0x80af48f
    if (HTCompressFileType(result, ".", (int32_t *)&sug_filename) != 0) {
        // 0x80af4ef
        *(char *)((int32_t)sug_filename + (int32_t)result) = 0;
    }
    // 0x80af4fb
    if (WWW_TraceFlag != 0) {
        // 0x80af506
        fprintf(TraceFP(), "suggest %s\n", result);
    }
    // 0x80af524
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80af52d - 0x80af6a1
// Line range:    135 - 154
void SetupFilename(char * filename, char * sug_filename) {
    // 0x80af52d
    LYstrncpy(filename, sug_filename, 255);
    change_sug_filename(filename);
    if (HTisDocumentSource() != 0) {
        goto lab_0x80af672;
    } else {
        char * found_char_pos = strrchr(filename, 46); // 0x80af574
        if (found_char_pos == NULL) {
            goto lab_0x80af672;
        } else {
            if ((int32_t)found_char_pos - (int32_t)filename > 249) {
                goto lab_0x80af672;
            } else {
                // 0x80af599
                int32_t * format2; // bp-16, 0x80af52d
                int32_t * v1 = (int32_t *)((int32_t)HTFileFormat(filename, &format2, NULL) + 4);
                if (WWW_TraceFlag != 0) {
                    // 0x80af5c1
                    fprintf(TraceFP(), "... format %s\n", (char *)*v1);
                }
                // 0x80af5e2
                if (strcasecomp((char *)*v1, "text/html") == 0) {
                    // 0x80af657
                    memcpy((int32_t *)found_char_pos, (int32_t *)".txt", 5);
                    goto lab_0x80af672;
                } else {
                    // 0x80af5fc
                    if (format2 == NULL) {
                        goto lab_0x80af672;
                    } else {
                        // 0x80af603
                        if (HTAtom_for("identity") == format2) {
                            goto lab_0x80af672;
                        } else {
                            // 0x80af618
                            if (HTAtom_for("8bit") == format2) {
                                goto lab_0x80af672;
                            } else {
                                // 0x80af62d
                                if (HTAtom_for("binary") == format2) {
                                    goto lab_0x80af672;
                                } else {
                                    // 0x80af642
                                    if (HTAtom_for("7bit") == format2) {
                                        goto lab_0x80af672;
                                    } else {
                                        // 0x80af657
                                        memcpy((int32_t *)found_char_pos, (int32_t *)".txt", 5);
                                        goto lab_0x80af672;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x80af672:
    // 0x80af672
    if (WWW_TraceFlag != 0) {
        // 0x80af67d
        fprintf(TraceFP(), "... result %s\n", filename);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80af6a1 - 0x80af997
// Line range:    169 - 261
int32_t RecallFilename(char * filename, char * first, int32_t * now, int32_t * total, int32_t flag) {
    // 0x80af6a1
    if (*now < 0) {
        int32_t v1 = 0; // 0x80af6b7
        if (sug_filenames != NULL) {
            // 0x80af6b9
            v1 = HTList_count(sug_filenames);
        }
        // 0x80af6d2
        *total = v1;
        *now = v1;
    }
    int32_t v2 = *total; // 0x80af6e7
    uint32_t v3 = LYgetstr(filename, 0, 256, (int32_t)(v2 >= 0 == (v2 != 0))); // 0x80af711
    if (v3 >= 0) {
        // 0x80af71f
        if (v3 != 257 == v3 != 256 == (*filename != 0)) {
            // 0x80af973
            return 2;
        }
        if (v3 == 256 == v2 >= 0 == (v2 != 0)) {
            // 0x80af756
            int32_t v4; // 0x80af6a1
            if (*first == 0) {
                // 0x80af771
                v4 = *now + 1;
            } else {
                // 0x80af760
                *first = 0;
                v4 = 0;
            }
            // 0x80af77e
            *now = v4;
            if (v4 >= *total) {
                // 0x80af78c
                *first = 1;
                *now = *total;
                mustshow = 1;
                statusline(gettext("Enter a filename: "));
                // 0x80af973
                return 0;
            }
            char * v5 = HTList_objectAt(sug_filenames, v4); // 0x80af7d5
            if (v5 != NULL) {
                // 0x80af7e7
                LYstrncpy(filename, v5, 255);
                mustshow = 1;
                if (*total != 1) {
                    // 0x80af828
                    statusline(gettext("Edit a previous filename: "));
                } else {
                    // 0x80af80b
                    statusline(gettext("Edit the previous filename: "));
                }
                // 0x80af973
                return 1;
            }
        } else {
            if (v3 == 257 == v2 >= 0 == (v2 != 0)) {
                int32_t * v6 = now; // 0x80af86e
                if (*first != 0) {
                    // 0x80af870
                    *first = 0;
                    v6 = total;
                }
                int32_t v7 = *v6 - 1;
                *now = v7;
                if (v7 < 0) {
                    // 0x80af89b
                    *first = 1;
                    *now = *total;
                    mustshow = 1;
                    statusline(gettext("Enter a filename: "));
                    // 0x80af973
                    return 0;
                }
                char * v8 = HTList_objectAt(sug_filenames, v7); // 0x80af8e4
                if (v8 != NULL) {
                    // 0x80af8f2
                    LYstrncpy(filename, v8, 255);
                    mustshow = 1;
                    if (*total != 1) {
                        // 0x80af933
                        statusline(gettext("Edit a previous filename: "));
                    } else {
                        // 0x80af916
                        statusline(gettext("Edit the previous filename: "));
                    }
                    // 0x80af973
                    return 1;
                }
            }
        }
    }
    // 0x80af957
    if (flag == 0) {
        // 0x80af95d
        HTInfoMsg(gettext("Save request cancelled!!!"));
    }
    // 0x80af973
    return 3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80af997 - 0x80afa7a
// Line range:    266 - 289
char confirm_by_pages(char * prompt, uint32_t lines_in_file, int32_t lines_per_page) {
    int64_t v1 = 0x100000000 * (int64_t)((int32_t)lines_in_file >> 31) | (int64_t)lines_in_file; // 0x80af9b3
    if ((int32_t)((int32_t)(v1 % (int64_t)(LYlines + 1)) > 0) + (int32_t)(v1 / (int64_t)(lines_per_page + 1)) < 5) {
        // 0x80afa74
        return 1;
    }
    int32_t pages = 0; // bp-16, 0x80af9e2
    HTSprintf0((char **)&pages, prompt);
    int32_t v2 = HTConfirmDefault((char *)pages, 1); // 0x80afa10
    if (pages != 0) {
        // 0x80afa1f
        free((int32_t *)pages);
        pages = 0;
    }
    char result; // 0x80af997
    if (v2 != 1) {
        // 0x80afa56
        HTInfoMsg(gettext("Print request cancelled!!!"));
        result = 0;
    } else {
        // 0x80afa37
        LYwaddnstr(LYwin, "   Ok...", 8);
        result = 1;
    }
    // 0x80afa74
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80afa7a - 0x80b0085
// Line range:    293 - 459
void send_file_to_file(int32_t * newdoc2, char * content_base, char * sug_filename) {
    char filename[256]; // bp-532, 0x80afa7a
    char v1[256]; // 0x80aff9b
    int32_t v2 = __readgsdword(20); // 0x80afa9f
    char v3 = 1; // bp-525, 0x80afaaa
    char * disp_charset = (char *)-1; // bp-540, 0x80afab1
    mustshow = 1;
    statusline(gettext("Enter a filename: "));
    struct _IO_FILE * stream; // 0x80afa7a
    int32_t * outfile_fp; // bp-544, 0x80afa7a
    int32_t str2; // bp-268, 0x80afa7a
    struct _IO_FILE * v4; // 0x80afa7a
    while (true) {
      lab_0x80afae0_2:;
        // 0x80afae0
        int32_t str; // bp-524, 0x80afa7a
        SetupFilename((char *)&str, sug_filename);
        if (lynx_save_space != 0) {
            // 0x80afb01
            if (strlen((char *)&str) + strlen((char *)lynx_save_space) < 256) {
                // 0x80afb28
                strcpy((char *)&str2, (char *)lynx_save_space);
                strcat((char *)&str2, (char *)&str);
                strcpy((char *)&str, (char *)&str2);
            }
        }
        while (true) {
          lab_0x80afb6f:;
            int32_t v5 = RecallFilename((char *)&str, &v3, (int32_t *)&disp_charset, (int32_t *)&outfile_fp, 0); // 0x80afb9e
            switch (v5) {
                case 1: {
                    goto lab_0x80afb6f;
                }
                case 3: {
                    goto lab_0x80b006b;
                }
                case 0: {
                    goto lab_0x80afae0_2;
                }
                default: {
                    goto lab_0x80afbcc;
                }
            }
        }
      lab_0x80afbcc:
        // 0x80afbcc
        if (LYValidateFilename((char *)&str2, (char *)&str) == 0) {
            // 0x80afbe8
            HTInfoMsg(gettext("Save request cancelled!!!"));
            goto lab_0x80b006b;
        }
        int32_t v6 = LYValidateOutput((char *)&str2); // 0x80afc0a
        if (v6 == 78) {
            // 0x80afc38
            mustshow = 1;
            statusline(gettext("Enter a new filename: "));
            v3 = 1;
            disp_charset = (char *)outfile_fp;
            goto lab_0x80afae0_2;
        } else {
            if (v6 != 89) {
                // break -> 0x80b006b
                break;
            }
            // 0x80afc2b
            if (WWW_TraceFlag != 0) {
                // 0x80afc6b
                fprintf(TraceFP(), "LYPrint: filename is %s, action is `%c'\n", &str2, 0);
            }
            // 0x80afc98
            if ((char)str2 != 124) {
                // 0x80afd7e
                if ((**__ctype_b_loc() & 512) == 0) {
                    // 0x80afded
                    v4 = LYNewTxtFile((char *)&str2);
                    goto lab_0x80afe01;
                } else {
                    // 0x80afdce
                    if (toupper(0) != 65) {
                        // 0x80afded
                        v4 = LYNewTxtFile((char *)&str2);
                        goto lab_0x80afe01;
                    } else {
                        // 0x80afdd7
                        v4 = LYAppendToTxtFile((char *)&str2);
                        goto lab_0x80afe01;
                    }
                }
            } else {
                // 0x80afca7
                if (no_shell == 0) {
                    // 0x80afcde
                    int32_t command; // bp-267, 0x80afa7a
                    struct _IO_FILE * v7 = popen((char *)&command, "w"); // 0x80afcf2
                    stream = v7;
                    if (v7 != NULL) {
                        goto lab_0x80afe8a_2;
                    }
                    // 0x80afd0a
                    if (WWW_TraceFlag != 0) {
                        int32_t v8 = *__errno_location(); // 0x80afd1a
                        fprintf(TraceFP(), "LYPrint: errno is %d\n", v8);
                    }
                    // 0x80afd37
                    HTAlert(gettext("Cannot write to file."));
                    mustshow = 1;
                    statusline(gettext("Enter a new filename: "));
                    v3 = 1;
                    disp_charset = (char *)outfile_fp;
                } else {
                    // 0x80afcb2
                    HTUserMsg(gettext("Spawning is currently disabled."));
                    v3 = 1;
                    disp_charset = (char *)outfile_fp;
                }
                goto lab_0x80afae0_2;
            }
        }
    }
    goto lab_0x80b006b;
  lab_0x80afe8a_2:
    // 0x80afe8a
    if (LYPrependBaseToSource == 0) {
        goto lab_0x80aff6e;
    } else {
        // 0x80afe99
        if (HTisDocumentSource() == 0) {
            goto lab_0x80aff6e;
        } else {
            int32_t v13 = *(int32_t *)((int32_t)newdoc2 + 4); // 0x80afeac
            fprintf(stream, "<!-- X-URL: %s -->\n", (char *)v13);
            if (HText_getDate() == NULL) {
                // 0x80aff4e
                fprintf(stream, "<BASE HREF=\"%s\">\n", content_base);
                goto lab_0x80aff6e;
            } else {
                // 0x80afed2
                fprintf(stream, "<!-- Date: %s -->\n", HText_getDate());
                if (HText_getLastModified() == NULL) {
                    // 0x80aff4e
                    fprintf(stream, "<BASE HREF=\"%s\">\n", content_base);
                    goto lab_0x80aff6e;
                } else {
                    char * str3 = HText_getDate(); // 0x80afefa
                    if (strcmp(HText_getLastModified(), str3) == 0) {
                        // 0x80aff4e
                        fprintf(stream, "<BASE HREF=\"%s\">\n", content_base);
                        goto lab_0x80aff6e;
                    } else {
                        // 0x80aff16
                        if (strcmp(HText_getLastModified(), "Thu, 01 Jan 1970 00:00:01 GMT") == 0) {
                            // 0x80aff4e
                            fprintf(stream, "<BASE HREF=\"%s\">\n", content_base);
                            goto lab_0x80aff6e;
                        } else {
                            // 0x80aff2f
                            fprintf(stream, "<!-- Last-Modified: %s -->\n", HText_getLastModified());
                            // 0x80aff4e
                            fprintf(stream, "<BASE HREF=\"%s\">\n", content_base);
                            goto lab_0x80aff6e;
                        }
                    }
                }
            }
        }
    }
  lab_0x80b006b:
    // 0x80b006b
    if (v2 != __readgsdword(20)) {
        // 0x80b0077
        __stack_chk_fail();
    }
  lab_0x80afe01:
    // 0x80afe01
    stream = v4;
    if (v4 != NULL) {
        goto lab_0x80afe8a_2;
    }
    // 0x80afe16
    if (WWW_TraceFlag != 0) {
        int32_t v9 = *__errno_location(); // 0x80afe26
        fprintf(TraceFP(), "LYPrint: errno is %d\n", v9);
    }
    // 0x80afe43
    HTAlert(gettext("Cannot write to file."));
    mustshow = 1;
    statusline(gettext("Enter a new filename: "));
    v3 = 1;
    disp_charset = (char *)outfile_fp;
    goto lab_0x80afae0_2;
  lab_0x80aff6e:
    // 0x80aff6e
    if (LYPrependCharsetToSource == 0) {
        goto lab_0x80afff7;
    } else {
        // 0x80aff79
        if (HTisDocumentSource() == 0) {
            goto lab_0x80afff7;
        } else {
            char v10 = HTLoadedDocumentEightbit(); // 0x80aff82
            int32_t v11 = *(int32_t *)(32 * current_char_set + (int32_t)&g143); // 0x80aff95
            v1[0] = v11;
            filename = v1;
            if (v10 == 0) {
                goto lab_0x80afff7;
            } else {
                // 0x80affaa
                if (LYHaveCJKCharacterSet != 0) {
                    goto lab_0x80afff7;
                } else {
                    char * v12 = (char *)*(int32_t *)&filename;
                    if (strncasecomp(v12, "x-", 2) == 0) {
                        goto lab_0x80afff7;
                    } else {
                        // 0x80affd7
                        fprintf(stream, "<META HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html; charset=%s\">\n\n", v12);
                        goto lab_0x80afff7;
                    }
                }
            }
        }
    }
  lab_0x80afff7:
    // 0x80afff7
    print_wwwfile_to_fd(stream, 0, 0);
    if (keypad_mode == 0) {
        goto lab_0x80b0034;
    } else {
        // 0x80b001e
        printlist(stream, 0);
        goto lab_0x80b0034;
    }
  lab_0x80b0034:
    // 0x80b0034
    if ((char)str2 != 124) {
        // 0x80b004f
        LYCloseOutput(stream);
        // 0x80b005d
        HTAddSugFilename((char *)&str2);
        goto lab_0x80b006b;
    } else {
        // 0x80b003f
        pclose(stream);
        // 0x80b005d
        HTAddSugFilename((char *)&str2);
        goto lab_0x80b006b;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80b0085 - 0x80b065c
// Line range:    463 - 784
void send_file_to_mail(int32_t * newdoc2, char * content_base, char * content_location) {
    char user_response[1024]; // bp-1040, 0x80b0085
    char v1[1024]; // 0x80b01ea
    char v2[1024]; // 0x80b0329
    int32_t v3 = __readgsdword(20); // 0x80b00a9
    int32_t * outfile_fp = NULL; // bp-1052, 0x80b00be
    if (LYSystemMail() == 0) {
        goto lab_0x80b0649;
    } else {
        // 0x80b00d5
        if (LYPreparsedSource == 0 || g134 == 0) {
            goto lab_0x80b0154;
        } else {
            // 0x80b00eb
            if (HTisDocumentSource() == 0) {
                goto lab_0x80b0154;
            } else {
                char * v4 = gettext("Viewing preparsed source.  Are you sure you want to mail it?"); // 0x80b00fb
                if (HTConfirmDefault(v4, 0) != 1) {
                    // 0x80b013b
                    HTInfoMsg(gettext("Mail request cancelled!!!"));
                    goto lab_0x80b0627;
                } else {
                    // 0x80b0115
                    LYwaddnstr(LYwin, "   Ok...", 8);
                    g134 = 0;
                    goto lab_0x80b0154;
                }
            }
        }
    }
  lab_0x80b0649:
    // 0x80b0649
    if (v3 != __readgsdword(20)) {
        // 0x80b0655
        __stack_chk_fail();
    }
  lab_0x80b0154:
    // 0x80b0154
    mustshow = 1;
    statusline(gettext("Please enter a valid internet mail address: "));
    int32_t v5; // bp-1032, 0x80b0085
    LYstrncpy((char *)&v5, (char *)personal_mail_address, 1023);
    int32_t v6; // 0x80b0085
    char * v7; // 0x80b01ca
    if (LYgetstr((char *)&v5, 0, 1024, 3) < 0) {
        // 0x80b01c3
        v7 = gettext("Mail request cancelled!!!");
        HTInfoMsg(v7);
        goto lab_0x80b0627;
    } else {
        // 0x80b01b8
        if ((char)v5 != 0) {
            int32_t v8 = *(int32_t *)(32 * current_char_set + (int32_t)&g143); // 0x80b01e4
            v1[0] = v8;
            user_response = v1;
            if (HTLoadedDocumentEightbit() == 0) {
                goto lab_0x80b0226;
            } else {
                int32_t v9 = *(int32_t *)&user_response; // 0x80b0214
                int32_t v10 = strncasecomp((char *)v9, "x-", 2); // 0x80b021d
                v6 = v9;
                if (v10 != 0) {
                    goto lab_0x80b0237;
                } else {
                    goto lab_0x80b0226;
                }
            }
        } else {
            // 0x80b01c3
            v7 = gettext("Mail request cancelled!!!");
            HTInfoMsg(v7);
            goto lab_0x80b0627;
        }
    }
  lab_0x80b0627:
    // 0x80b0627
    if (outfile_fp != NULL) {
        // 0x80b0631
        free(outfile_fp);
        outfile_fp = NULL;
    }
    goto lab_0x80b0649;
  lab_0x80b0226:
    // 0x80b0226
    user_response = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    v6 = *(int32_t *)&user_response;
    goto lab_0x80b0237;
  lab_0x80b0237:
    // 0x80b0237
    if (v6 == 0) {
        // 0x80b0240
        HTisDocumentSource();
    }
    int32_t v11 = (int32_t)newdoc2;
    char * v12 = subject_translate8bit((char *)*newdoc2); // 0x80b0277
    outfile_fp = (int32_t *)v12;
    if (*(char *)(v11 + 20) != 0) {
        if (v12 != NULL) {
            // 0x80b029a
            free((int32_t *)v12);
            outfile_fp = NULL;
        }
        // 0x80b02b2
        HTSACopy((char **)&outfile_fp, "HEAD  ");
        HTSACat((char **)&outfile_fp, (char *)*(int32_t *)(v11 + 4));
    }
    struct _IO_FILE * stream = LYPipeToMailer(); // 0x80b02e3
    int32_t v13; // 0x80b0085
    char v14; // 0x80b0310
    if (stream != NULL) {
        // 0x80b0310
        v14 = HTLoadedDocumentEightbit();
        int32_t v15 = *(int32_t *)(32 * current_char_set + (int32_t)&g143); // 0x80b0323
        v2[0] = v15;
        user_response = v2;
        if (v14 == 0) {
            goto lab_0x80b0365;
        } else {
            // 0x80b0338
            if (LYHaveCJKCharacterSet != 0) {
                goto lab_0x80b0365;
            } else {
                int32_t v16 = *(int32_t *)&user_response; // 0x80b0353
                int32_t v17 = strncasecomp((char *)v16, "x-", 2); // 0x80b035c
                v13 = v16;
                if (v17 != 0) {
                    goto lab_0x80b036f;
                } else {
                    goto lab_0x80b0365;
                }
            }
        }
    } else {
        // 0x80b02f7
        HTAlert(gettext("ERROR - Unable to mail file"));
        goto lab_0x80b0627;
    }
  lab_0x80b0365:
    // 0x80b0365
    user_response = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    v13 = *(int32_t *)&user_response;
    goto lab_0x80b036f;
  lab_0x80b036f:;
    // 0x80b036f
    bool v18; // 0x80b0085
    if (v13 != 0) {
        goto lab_0x80b03e2;
    } else {
        // 0x80b0397
        v18 = true;
        if (v14 == 0 == HTisDocumentSource() == 0) {
            goto lab_0x80b0437;
        } else {
            goto lab_0x80b03e2;
        }
    }
  lab_0x80b03e2:
    // 0x80b03e2
    fwrite((int32_t *)"Mime-Version: 1.0\n", 1, 18, stream);
    v18 = false;
    if (v14 != 0) {
        // 0x80b0411
        fwrite((int32_t *)"Content-Transfer-Encoding: 8bit\n", 1, 32, stream);
        v18 = false;
    }
    goto lab_0x80b0437;
  lab_0x80b0437:
    // 0x80b0437
    if (HTisDocumentSource() == 0) {
        if (v13 != 0) {
            // 0x80b04b2
            fprintf(stream, "Content-Type: text/plain; charset=%s\n", (char *)v13);
        }
    } else {
        // 0x80b0440
        fwrite((int32_t *)"Content-Type: text/html", 1, 23, stream);
        if (v13 == 0) {
            // 0x80b0491
            fputc(10, stream);
        } else {
            // 0x80b046f
            fprintf(stream, "; charset=%s\n", (char *)v13);
        }
    }
    if (!v18) {
        if (content_base != NULL) {
            // 0x80b04e4
            fprintf(stream, "Content-Base: %s\n", content_base);
        }
        if (content_location != NULL) {
            // 0x80b050d
            fprintf(stream, "Content-Location: %s\n", content_location);
        }
    }
    // 0x80b052d
    fprintf(stream, "To: %s\nSubject: %s\n", &v5, outfile_fp);
    int32_t * v19 = (int32_t *)(v11 + 4); // 0x80b055d
    fprintf(stream, "X-URL: %s\n\n", (char *)*v19);
    if (LYPrependBaseToSource != 0) {
        // 0x80b0585
        if (HTisDocumentSource() != 0) {
            // 0x80b058e
            fprintf(stream, "<!-- X-URL: %s -->\n<BASE HREF=\"%s\">\n\n", (char *)*v19, content_base);
        }
    }
    // 0x80b05bb
    print_wwwfile_to_fd(stream, 1, 0);
    if (keypad_mode != 0) {
        // 0x80b05e2
        printlist(stream, 0);
    }
    // 0x80b05f8
    pclose(stream);
    goto lab_0x80b0627;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80b065c - 0x80b0b91
// Line range:    789 - 946
void send_file_to_printer(int32_t * newdoc2, char * content_base, char * sug_filename, int32_t printer_number) {
    char my_temp[256]; // bp-532, 0x80b065c
    char v1[256]; // 0x80b06e6
    int32_t v2 = __readgsdword(20); // 0x80b0681
    char v3 = 1; // bp-525, 0x80b068c
    int32_t * outfile_fp2 = NULL; // bp-536, 0x80b0693
    char * the_command = (char *)-1; // bp-544, 0x80b069d
    char * v4 = HTisDocumentSource() == 0 ? ".txt" : ".html";
    int32_t v5; // bp-524, 0x80b065c
    struct _IO_FILE * v6 = LYOpenTemp((char *)&v5, v4, "w"); // 0x80b06e1
    v1[0] = (int32_t)v6;
    my_temp = v1;
    int32_t stream = *(int32_t *)&my_temp; // 0x80b06ec
    int32_t str; // bp-268, 0x80b065c
    int32_t * v7; // 0x80b07d7
    if (stream != 0) {
        // 0x80b070e
        if (LYPrependBaseToSource != 0) {
            // 0x80b0719
            if (HTisDocumentSource() != 0) {
                int32_t v8 = *(int32_t *)((int32_t)newdoc2 + 4); // 0x80b0728
                fprintf((struct _IO_FILE *)stream, "<!-- X-URL: %s -->\n<BASE HREF=\"%s\">\n\n", (char *)v8, content_base);
            }
        }
        struct _IO_FILE * v9 = (struct _IO_FILE *)stream;
        print_wwwfile_to_fd(v9, 0, 0);
        if (keypad_mode != 0) {
            // 0x80b0776
            printlist(v9, 0);
        }
        // 0x80b078c
        LYCloseTempFP(v9);
        int32_t v10 = (int32_t)printers; // 0x80b07a4
        int32_t v11 = v10; // 0x80b07cf
        if (printer_number > 0) {
            int32_t v12 = 1; // 0x80b07b1
            int32_t v13 = *(int32_t *)v10; // 0x80b07be
            int32_t v14 = v13; // 0x80b07cf
            int32_t v15 = v12; // 0x80b07cf
            v11 = v13;
            while (v12 != printer_number) {
                // 0x80b07b1
                v12 = v15 + 1;
                v13 = *(int32_t *)v14;
                v14 = v13;
                v15 = v12;
                v11 = v13;
            }
        }
        // 0x80b07d1
        v7 = (int32_t *)(v11 + 8);
        int32_t v16 = *v7; // 0x80b07d7
        if (v16 != 0) {
            // 0x80b07f7
            if (HTCountCommandArgs((char *)v16) < 2) {
                // 0x80b07f7
                goto lab_0x80b0950;
            } else {
                // 0x80b0811
                mustshow = 1;
                statusline(gettext("Enter a filename: "));
                while (true) {
                    // 0x80b082c
                    SetupFilename((char *)&str, sug_filename);
                    int32_t * outfile_fp; // bp-540, 0x80b065c
                    while (true) {
                      lab_0x80b0844:;
                        int32_t v17 = RecallFilename((char *)&str, &v3, (int32_t *)&the_command, (int32_t *)&outfile_fp, 0); // 0x80b0873
                        switch (v17) {
                            case 1: {
                                goto lab_0x80b0844;
                            }
                            case 3: {
                                goto lab_0x80b0b77;
                            }
                            case 0: {
                                goto lab_0x80b082c;
                            }
                            default: {
                                goto lab_0x80b089d;
                            }
                        }
                    }
                  lab_0x80b089d:
                    // 0x80b089d
                    if (no_dotfiles == 0) {
                        // 0x80b08a8
                        if (show_dotfiles != 0) {
                            goto lab_0x80b090f_2;
                        }
                    }
                    // 0x80b08b3
                    if (*LYPathLeaf((char *)&str) != 46) {
                        goto lab_0x80b090f_2;
                    }
                    // 0x80b08c8
                    HTAlert(gettext("File name may not begin with a dot."));
                    mustshow = 1;
                    statusline(gettext("Enter a new filename: "));
                    v3 = 1;
                    the_command = (char *)outfile_fp;
                  lab_0x80b082c:;
                }
            }
        } else {
            // 0x80b07de
            HTAlert(gettext("ERROR! - printer is misconfigured!"));
            goto lab_0x80b0b77;
        }
    } else {
        // 0x80b06f5
        HTAlert(gettext("ERROR - Unable to allocate file space!!!"));
        goto lab_0x80b0b77;
    }
  lab_0x80b090f_2:
    // 0x80b090f
    if (strcmp((char *)&str, "/dev/null") != 0) {
        // 0x80b0942
        HTAddSugFilename((char *)&str);
        goto lab_0x80b0950;
    } else {
        // 0x80b0929
        HTInfoMsg(gettext("Print request cancelled!!!"));
        goto lab_0x80b0b77;
    }
  lab_0x80b0b77:
    // 0x80b0b77
    if (v2 != __readgsdword(20)) {
        // 0x80b0b83
        __stack_chk_fail();
    }
  lab_0x80b0950:;
    char * v18 = (char *)&str;
    int32_t v19 = *v7; // 0x80b0956
    HTAddParam((char **)&outfile_fp2, (char *)v19, 1, (char *)&v5);
    HTAddParam((char **)&outfile_fp2, (char *)*v7, 2, v18);
    HTEndParam((char **)&outfile_fp2, (char *)*v7, 2);
    LYmove(1, 1);
    stop_curses();
    if (WWW_TraceFlag != 0) {
        // 0x80b09f1
        fprintf(TraceFP(), "command: %s\n", outfile_fp2);
    }
    // 0x80b0a12
    printf(gettext("Printing file.  Please wait..."));
    char * v20 = HText_getTitle(); // 0x80b0a26
    set_environ(0, v20, (char *)&g43);
    int32_t v21 = *(int32_t *)((int32_t)newdoc2 + 4); // 0x80b0a49
    set_environ(1, (char *)v21, (char *)&g43);
    char * v22 = HText_getDate(); // 0x80b0a64
    set_environ(2, v22, (char *)&g43);
    char * v23 = HText_getLastModified(); // 0x80b0a81
    set_environ(3, v23, (char *)&g43);
    LYSystem((char *)outfile_fp2);
    if (outfile_fp2 != NULL) {
        // 0x80b0ab6
        free(outfile_fp2);
        outfile_fp2 = NULL;
    }
    // 0x80b0ace
    LYRemoveTemp((char *)&v5);
    set_environ(0, (char *)&g43, (char *)&g43);
    set_environ(1, (char *)&g43, (char *)&g43);
    set_environ(2, (char *)&g43, (char *)&g43);
    set_environ(3, (char *)&g43, (char *)&g43);
    fflush((struct _IO_FILE *)g164);
    signal(SIGINT, 0x804b4e4);
    LYSleepMsg();
    start_curses();
    goto lab_0x80b0b77;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80b0b91 - 0x80b0d5c
// Line range:    950 - 1019
void send_file_to_screen(int32_t * newdoc2, char * content_base, char Lpansi) {
    char prompt[80]; // bp-92, 0x80b0b91
    char v1[80]; // 0x80b0c3e
    int32_t v2 = __readgsdword(20); // 0x80b0bac
    mustshow = 1;
    if (Lpansi == 0) {
        // 0x80b0bda
        statusline(gettext("Press <return> to begin: "));
    } else {
        // 0x80b0bbd
        statusline(gettext("Be sure your printer is on-line.  Press <return> to start printing:"));
    }
    char v3 = 0; // bp-88, 0x80b0bf5
    if (LYgetstr(&v3, 0, 80, 0) >= 0) {
        // 0x80b0c39
        v1[0] = (int32_t)g164;
        prompt = v1;
        stop_curses();
        signal(SIGINT, SIG_IGN);
        if (LYPrependBaseToSource != 0) {
            // 0x80b0c65
            if (HTisDocumentSource() != 0) {
                int32_t v4 = *(int32_t *)((int32_t)newdoc2 + 4); // 0x80b0c71
                int32_t stream = *(int32_t *)&prompt; // 0x80b0c87
                fprintf((struct _IO_FILE *)stream, "<!-- X-URL: %s -->\n<BASE HREF=\"%s\">\n\n", (char *)v4, content_base);
            }
        }
        if (Lpansi != 0) {
            // 0x80b0c98
            printf((char *)&g44);
        }
        struct _IO_FILE * v5 = (struct _IO_FILE *)*(int32_t *)&prompt;
        print_wwwfile_to_fd(v5, 0, 0);
        if (keypad_mode != 0) {
            // 0x80b0cc8
            printlist(v5, 0);
        }
        if (Lpansi == 0) {
            // 0x80b0d0c
            fprintf((struct _IO_FILE *)g164, "\n\n%s", gettext("Press <return> to finish: "));
            fflush((struct _IO_FILE *)g164);
            LYgetch();
        } else {
            // 0x80b0ce1
            printf("\n\f");
            printf((char *)&g45);
            fflush((struct _IO_FILE *)g164);
        }
        // 0x80b0d44
        start_curses();
    } else {
        // 0x80b0c20
        HTInfoMsg(gettext("Print request cancelled!!!"));
    }
    // 0x80b0d49
    if (v2 != __readgsdword(20)) {
        // 0x80b0d55
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80b0d5c - 0x80b11f4
// Line range:    1022 - 1166
int32_t printfile(int32_t * newdoc2) {
    char * v1 = NULL; // bp-16, 0x80b0d67
    char * content_base = NULL; // bp-20, 0x80b0d6e
    char * content_location = NULL; // bp-28, 0x80b0d7c
    int32_t * v2 = (int32_t *)((int32_t)newdoc2 + 4); // 0x80b0da9
    HTSACopy(&content_location, (char *)(*v2 + 12));
    LYpop(newdoc2);
    int32_t v3 = *v2; // bp-68, 0x80b0dcf
    if (HTLoadAbsolute(&v3) == 0) {
        // 0x80b11eb
        return 0;
    }
    // 0x80b0e1c
    if (HText_getContentBase() != NULL) {
        char * v4 = HText_getContentBase(); // 0x80b0e25
        HTSACopy(&v1, v4);
        LYRemoveBlanks(v1);
        char * v5 = v1;
        if (v5 != NULL) {
            // 0x80b0e4b
            if (*v5 == 0) {
                // 0x80b0e5c
                free((int32_t *)v5);
                v1 = NULL;
            }
        }
    }
    // 0x80b0e6e
    if (HTisDocumentSource() == 0) {
        goto lab_0x80b0f2f;
    } else {
        // 0x80b0e7b
        if (HText_getContentLocation() != NULL) {
            char * v6 = HText_getContentLocation(); // 0x80b0e84
            HTSACopy(&content_base, v6);
            LYRemoveBlanks(content_base);
            char * v7 = content_base;
            if (v7 != NULL) {
                // 0x80b0eaa
                if (*v7 == 0) {
                    // 0x80b0ebb
                    free((int32_t *)v7);
                    content_base = NULL;
                }
            }
        }
        // 0x80b0ecd
        if (v1 != NULL) {
            goto lab_0x80b0f13;
        } else {
            char * v8 = content_base; // 0x80b0ed4
            if (v8 == NULL) {
                // 0x80b0efe
                HTSACopy(&v1, (char *)*v2);
                goto lab_0x80b0f13;
            } else {
                // 0x80b0edb
                if (is_url(v8) == 0) {
                    // 0x80b0efe
                    HTSACopy(&v1, (char *)*v2);
                    goto lab_0x80b0f13;
                } else {
                    // 0x80b0eea
                    HTSACopy(&v1, content_base);
                    goto lab_0x80b0f13;
                }
            }
        }
    }
  lab_0x80b0f2f:;
    char * v9 = suggested_filename(newdoc2); // 0x80b0f35
    char * substr_pos = strstr(content_location, "lines="); // 0x80b0f4b
    int32_t str_as_i = 0; // 0x80b0f57
    if (substr_pos != NULL) {
        // 0x80b0f59
        *substr_pos = 0;
        str_as_i = atoi((char *)((int32_t)substr_pos + 6));
    }
    // 0x80b0f71
    char v10; // 0x80b0d5c
    if (strstr(content_location, "LOCAL_FILE") == NULL) {
        // 0x80b0f94
        v10 = 0;
        if (strstr(content_location, "TO_SCREEN") == NULL) {
            // 0x80b0fb7
            v10 = 1;
            if (strstr(content_location, "LPANSI") == NULL) {
                // 0x80b0fde
                if (strstr(content_location, "MAIL_FILE") == NULL) {
                    // 0x80b1001
                    if (strstr(content_location, "PRINTER") != NULL) {
                        char * substr_pos2 = strstr(content_location, "number="); // 0x80b102d
                        int32_t str_as_i2 = 0; // 0x80b1039
                        if (substr_pos2 != NULL) {
                            // 0x80b103b
                            str_as_i2 = atoi((char *)((int32_t)substr_pos2 + 7));
                        }
                        char * substr_pos3 = strstr(content_location, "pagelen="); // 0x80b105b
                        char * str_as_i3 = (char *)66; // 0x80b1067
                        if (substr_pos3 != NULL) {
                            // 0x80b1069
                            str_as_i3 = (char *)atoi((char *)((int32_t)substr_pos3 + 8));
                        }
                        char * v11 = gettext("File is %d pages long.  Are you sure you want to print?"); // 0x80b1140
                        if (confirm_by_pages(v11, str_as_i, (int32_t)str_as_i3) != 0) {
                            // 0x80b1161
                            send_file_to_printer(newdoc2, v1, v9, str_as_i2);
                        }
                    }
                } else {
                    // 0x80b10d4
                    send_file_to_mail(newdoc2, v1, content_base);
                }
                goto lab_0x80b1181;
            } else {
                goto lab_0x80b10f2;
            }
        } else {
            goto lab_0x80b10f2;
        }
    } else {
        // 0x80b10b6
        send_file_to_file(newdoc2, v1, v9);
        goto lab_0x80b1181;
    }
  lab_0x80b0f13:
    // 0x80b0f13
    if (content_base == NULL) {
        // 0x80b0f1a
        HTSACopy(&content_base, (char *)*v2);
    }
    goto lab_0x80b0f2f;
  lab_0x80b10f2:;
    char * v12 = gettext("File is %d screens long.  Are you sure you want to print?"); // 0x80b10ff
    if (confirm_by_pages(v12, str_as_i, LYlines) != 0) {
        // 0x80b111d
        send_file_to_screen(newdoc2, v1, v10);
    }
    goto lab_0x80b1181;
  lab_0x80b1181:
    // 0x80b1181
    if (content_location != NULL) {
        // 0x80b1188
        char * v13; // 0x80b1181
        free((int32_t *)v13);
        content_location = NULL;
    }
    if (v9 != NULL) {
        // 0x80b11a0
        free((int32_t *)v9);
    }
    // 0x80b11b2
    if (v1 != NULL) {
        // 0x80b11b9
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x80b11cb
    if (content_base != NULL) {
        // 0x80b11d2
        free((int32_t *)content_base);
        content_base = NULL;
    }
    // 0x80b11eb
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80b11f4 - 0x80b1291
// Line range:    1203 - 1224
char * subject_translate8bit(char * source) {
    int32_t v1 = 0; // bp-8, 0x80b11fa
    HTSACopy((char **)&v1, source);
    if (outgoing_mail_charset < 0 || outgoing_mail_charset == current_char_set || *(int32_t *)(32 * current_char_set + (int32_t)&g144) == 5) {
        // 0x80b128c
        return (char *)v1;
    }
    // 0x80b123e
    if (*(int32_t *)(32 * outgoing_mail_charset + (int32_t)&g144) != 5) {
        // 0x80b1257
        LYUCTranslateBackFormData((char **)&v1, current_char_set, outgoing_mail_charset, 1);
    }
    // 0x80b128c
    return (char *)v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80b1291 - 0x80b16f5
// Line range:    1241 - 1329
int32_t print_options(char ** newfile, char * printed_url, int32_t lines_in_file) {
    int32_t str = 0; // bp-16, 0x80b1299
    struct _IO_FILE * stream = InternalPageFP((char *)&g135, 1); // 0x80b12af
    if (stream == NULL) {
        // 0x80b16eb
        return -1;
    }
    // 0x80b12c9
    LYLocalFileToURL(newfile, (char *)&g135);
    BeginInternalPage(stream, gettext("Printing Options"), "keystrokes/print_help.html.gz");
    fwrite((int32_t *)"<pre>\n", 1, 6, stream);
    int32_t v1 = lines_in_file + 65; // 0x80b1325
    char * v2 = gettext("(approximately)"); // 0x80b134c
    char * v3; // 0x80b1291
    if (v1 < 132) {
        // 0x80b136b
        v3 = gettext("page");
    } else {
        // 0x80b135a
        v3 = gettext("pages");
    }
    char * v4 = gettext("Number of pages:"); // 0x80b1381
    char * v5 = gettext("Number of lines:"); // 0x80b138f
    char * v6 = gettext("Document:"); // 0x80b139d
    HTSprintf0((char **)&str, "   <em>%s</em> %s\n   <em>%s</em> %d\n   <em>%s</em> %d %s %s\n", v6, printed_url, v5, lines_in_file, v4, v1 / 66, v3, v2);
    fputs((char *)str, stream);
    if (str != 0) {
        // 0x80b13ff
        free((int32_t *)str);
        str = 0;
    }
    // 0x80b1411
    if (no_print != 0) {
        // 0x80b1432
        fprintf(stream, "   <em>%s</em>\n", gettext("Some print functions have been disabled!"));
        goto lab_0x80b1455;
    } else {
        // 0x80b141c
        if ((no_mail || no_disk_save) == 0) {
            goto lab_0x80b1455;
        } else {
            // 0x80b1432
            fprintf(stream, "   <em>%s</em>\n", gettext("Some print functions have been disabled!"));
            goto lab_0x80b1455;
        }
    }
  lab_0x80b160a:;
    // 0x80b160a
    int32_t v7; // 0x80b1291
    int32_t v8 = *(int32_t *)(v7 + 20); // 0x80b160d
    char * v9; // 0x80b1291
    int32_t v10 = (int32_t)v9;
    fprintf(stream, "   <a href=\"%s//PRINTER/number=%d/pagelen=%d/lines=%d\">", "LYNXPRINT:", v10, v8, lines_in_file);
    int32_t v11 = *(int32_t *)(v7 + 4); // 0x80b1640
    fputs(v11 == 0 ? "No Name Given" : (char *)v11, stream);
    fwrite((int32_t *)"</a>\n", 1, 5, stream);
    int32_t v12 = v10; // 0x80b1689
    goto lab_0x80b168e;
  lab_0x80b168e:;
    int32_t v13 = *(int32_t *)v7; // 0x80b1691
    int32_t v14 = v13; // 0x80b169e
    char * v15 = (char *)(v12 + 1); // 0x80b169e
    if (v13 == 0) {
        // break -> 0x80b16a4
        goto lab_0x80b16a4;
    }
    goto lab_0x80b15f1;
  lab_0x80b1455:;
    // 0x80b1455
    char * v16; // 0x80b1291
    if (user_mode != 0) {
        // 0x80b146f
        v16 = gettext("Print options:");
    } else {
        // 0x80b145e
        v16 = gettext("Standard print options:");
    }
    // 0x80b147e
    fprintf(stream, "\n%s\n", v16);
    if (no_disk_save != 0) {
        // 0x80b14e2
        fprintf(stream, "   <em>%s</em>\n", gettext("Save to disk disabled"));
        goto lab_0x80b1505;
    } else {
        // 0x80b14a3
        if (no_print != 0) {
            // 0x80b14e2
            fprintf(stream, "   <em>%s</em>\n", gettext("Save to disk disabled"));
            goto lab_0x80b1505;
        } else {
            // 0x80b14ae
            fprintf(stream, "   <a href=\"%s//LOCAL_FILE/lines=%d\">%s</a>\n", "LYNXPRINT:", lines_in_file, gettext("Save to a local file"));
            goto lab_0x80b1505;
        }
    }
  lab_0x80b1505:
    // 0x80b1505
    if (no_mail == 0) {
        // 0x80b1510
        if (local_host_only == 0) {
            // 0x80b151b
            fprintf(stream, "   <a href=\"%s//MAIL_FILE/lines=%d\">%s</a>\n", "LYNXPRINT:", lines_in_file, gettext("Mail the file"));
        }
    }
    // 0x80b154d
    fprintf(stream, "   <a href=\"%s//TO_SCREEN/lines=%d\">%s</a>\n", "LYNXPRINT:", lines_in_file, gettext("Print to the screen"));
    fprintf(stream, "   <a href=\"%s//LPANSI/lines=%d\">%s</a>\n", "LYNXPRINT:", lines_in_file, gettext("Print out on a printer attached to your vt100 terminal"));
    if (user_mode == 0) {
        // 0x80b15ba
        fprintf(stream, "\n%s\n", gettext("Local additions:"));
    }
    // 0x80b15dd
    if (printers != NULL) {
        // 0x80b15f1
        v14 = (int32_t)printers;
        v15 = NULL;
        while (true) {
          lab_0x80b15f1:
            // 0x80b15f1
            v9 = v15;
            v7 = v14;
            if (no_print == 0) {
                goto lab_0x80b160a;
            } else {
                // 0x80b15fc
                if (*(int32_t *)(v7 + 12) == 0) {
                    // 0x80b15fc
                    v12 = (int32_t)v9;
                    goto lab_0x80b168e;
                } else {
                    goto lab_0x80b160a;
                }
            }
        }
    }
  lab_0x80b16a4:
    // 0x80b16a4
    fwrite((int32_t *)"</pre>\n", 1, 7, stream);
    EndInternalPage(stream);
    LYCloseTempFP(stream);
    LYforce_no_cache = 1;
    // 0x80b16eb
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrint.c
// Address range: 0x80b16f5 - 0x80b1939
// Line range:    1344 - 1447
char * GetFileName(void) {
    char tbuf[256]; // bp-528, 0x80b16f5
    char v1[256]; // 0x80b18d3
    int32_t v2 = __readgsdword(20); // 0x80b16fe
    char v3 = 1; // bp-521, 0x80b1709
    char * fn2 = (char *)-1; // bp-532, 0x80b1710
    mustshow = 1;
    statusline(gettext("Enter a filename: "));
    char * fn; // bp-536, 0x80b16f5
    int32_t str; // bp-520, 0x80b16f5
    int32_t v4; // 0x80b16f5
    while (true) {
      lab_0x80b1735_2:;
        // 0x80b1735
        int32_t v5; // bp-264, 0x80b16f5
        SetupFilename((char *)&v5, (char *)&g43);
        while (true) {
          lab_0x80b174b:;
            int32_t v6 = RecallFilename((char *)&v5, &v3, (int32_t *)&fn2, (int32_t *)&fn, 1); // 0x80b177a
            v4 = 0;
            switch (v6) {
                case 1: {
                    goto lab_0x80b174b;
                }
                case 3: {
                    goto lab_0x80b1920;
                }
                case 0: {
                    goto lab_0x80b1735_2;
                }
                default: {
                    goto lab_0x80b17a4;
                }
            }
        }
      lab_0x80b17a4:
        // 0x80b17a4
        HTAddSugFilename((char *)&v5);
        char v7 = LYValidateFilename((char *)&str, (char *)&v5); // 0x80b17c5
        v4 = 0;
        if (v7 == 0) {
            // break -> 0x80b1920
            break;
        }
        // 0x80b17d2
        int32_t v8; // bp-632, 0x80b16f5
        if (stat64((int32_t)&str, &v8) < 0) {
            goto lab_0x80b1812;
        } else {
            int32_t v9; // 0x80b16f5
            switch ((int16_t)v9 & -0x1000) {
                case -0x8000: {
                    goto lab_0x80b1859;
                }
                case -0x6000: {
                    goto lab_0x80b1859;
                }
                default: {
                    goto lab_0x80b1812;
                }
            }
        }
    }
    goto lab_0x80b1920;
  lab_0x80b1920:;
    int32_t v10 = v4; // 0x80b1930
    if (v2 != __readgsdword(20)) {
        // 0x80b1932
        __stack_chk_fail();
        v10 = &g391;
    }
    // 0x80b1937
    return (char *)v10;
  lab_0x80b1812:
    // 0x80b1812
    HTInfoMsg(gettext("File does not exist."));
    mustshow = 1;
    statusline(gettext("File does not exist - reenter or cancel:"));
    v3 = 1;
    *(int32_t *)&fn2 = (int32_t)fn;
    goto lab_0x80b1735_2;
  lab_0x80b1859:
    // 0x80b1859
    if (LYCanReadFile((char *)&str) != 0) {
        int32_t * mem = calloc(strlen((char *)&str) + 1, 1); // 0x80b18ce
        v1[0] = (int32_t)mem;
        tbuf = v1;
        int32_t str2 = *(int32_t *)&tbuf; // 0x80b18d9
        if (str2 == 0) {
            // 0x80b18e2
            outofmem("./LYPrint.c", "GetFileName");
            // UNREACHABLE
        }
        char * dest_str = strcpy((char *)str2, (char *)&str); // 0x80b1909
        v4 = (int32_t)dest_str;
        goto lab_0x80b1920;
    }
    // 0x80b186b
    HTInfoMsg(gettext("File is not readable."));
    mustshow = 1;
    statusline(gettext("File is not readable - reenter or cancel:"));
    v3 = 1;
    *(int32_t *)&fn2 = (int32_t)fn;
    goto lab_0x80b1735_2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYrcFile.c
// Address range: 0x80b193c - 0x80b1996
// Line range:    158 - 160
char getBool(char * src) {
    // 0x80b193c
    if (strncasecomp(src, "on", 2) == 0) {
        // 0x80b1990
        return 1;
    }
    // 0x80b1961
    return strncasecomp(src, "true", 4) == 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYrcFile.c
// Address range: 0x80b1996 - 0x80b19cc
// Line range:    163 - 171
char * LYputEnum(int32_t * table, int32_t value) {
    int32_t v1 = *table; // 0x80b19ba
    if (v1 == 0) {
        // 0x80b19c7
        return (char *)&g46;
    }
    int32_t v2 = (int32_t)table;
    int32_t v3 = v1; // 0x80b19a7
    if (*(int32_t *)(v2 + 4) == value) {
      lab_0x80b19a9:
        // 0x80b19c7
        return (char *)v3;
    }
    int32_t v4 = v2;
    int32_t v5 = v4 + 8;
    int32_t v6 = *(int32_t *)v5; // 0x80b19ba
    while (v6 != 0) {
        // 0x80b199e
        v3 = v6;
        if (*(int32_t *)(v4 + 12) == value) {
            return (char *)v3;
        }
        v4 = v5;
        v5 = v4 + 8;
        v6 = *(int32_t *)v5;
    }
    // 0x80b19c7
    return (char *)&g46;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYrcFile.c
// Address range: 0x80b19cc - 0x80b1a6e
// Line range:    175 - 198
char LYgetEnum(int32_t * table, char * name, int32_t * result) {
    int32_t len = strlen(name); // 0x80b19df
    if (len == 0) {
        // 0x80b1a68
        return 0;
    }
    int32_t v1 = *table; // 0x80b1a47
    if (v1 == 0) {
        // 0x80b1a68
        return 0;
    }
    int32_t * v2 = NULL;
    int32_t * v3 = v2; // 0x80b1a13
    int32_t v4 = 0; // 0x80b1a13
    int32_t v5; // 0x80b19cc
    if (strncasecomp((char *)v1, name, len) == 0) {
        // 0x80b1a15
        v5 = v4;
        if (strcasecomp((char *)*table, name) == 0) {
            goto lab_0x80b1a53;
        }
        // 0x80b1a3c
        v3 = (int32_t *)((int32_t)v2 + 1);
    }
    int32_t v6 = v4;
    int32_t * v7 = v3;
    int32_t v8 = v4 + 8; // 0x80b1a40
    int32_t * v9 = (int32_t *)v8; // 0x80b1a47
    int32_t v10 = *v9; // 0x80b1a47
    int32_t * v11 = v9; // 0x80b1a4b
    while (v10 != 0) {
        // 0x80b19f6
        v2 = v7;
        v4 = v8;
        v3 = v2;
        int32_t v12 = v6; // 0x80b1a13
        if (strncasecomp((char *)v10, name, len) == 0) {
            // 0x80b1a15
            v5 = v4;
            if (strcasecomp((char *)*v11, name) == 0) {
                goto lab_0x80b1a53;
            }
            // 0x80b1a3c
            v3 = (int32_t *)((int32_t)v2 + 1);
            v12 = v4;
        }
        // 0x80b1a40
        v6 = v12;
        v7 = v3;
        v8 = v4 + 8;
        v9 = (int32_t *)v8;
        v10 = *v9;
        v11 = v9;
    }
    // 0x80b1a4d
    v5 = v6;
    char result2 = 0; // 0x80b1a51
    if (v7 == (int32_t *)1) {
      lab_0x80b1a53:
        // 0x80b1a53
        *result = *(int32_t *)(v5 + 4);
        result2 = 1;
    }
    // 0x80b1a68
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYrcFile.c
// Address range: 0x80b1cd7 - 0x80b1dc5
// Line range:    612 - 628
int32_t * lookup_config2(char * name) {
    int16_t * v1 = *__ctype_b_loc(); // 0x80b1ce9
    unsigned char v2 = *name;
    int32_t c = v2;
    char v3 = v2; // 0x80b1d06
    if ((*(int16_t *)(2 * c + (int32_t)v1) & 512) != 0) {
        // 0x80b1d08
        v3 = toupper(c);
    }
    // 0x80b1d27
    if (Config_Table == 0) {
        // 0x80b1dc0
        return &Config_Table;
    }
    int32_t v4 = &Config_Table; // 0x80b1daf
    int32_t v5; // 0x80b1cd7
    int32_t c2; // 0x80b1d42
    int16_t * v6; // 0x80b1d54
    if (*(int32_t *)(v4 + 4) != 0) {
        // 0x80b1d3d
        c2 = (int32_t)*(char *)Config_Table;
        v6 = *__ctype_b_loc();
        v5 = c2;
        if ((*(int16_t *)(2 * c2 + (int32_t)v6) & 512) != 0) {
            // 0x80b1d71
            v5 = toupper(c2);
        }
        // 0x80b1d8f
        if (v5 == (int32_t)v3) {
            // 0x80b1d97
            if (strcasecomp(name, (char *)*&Config_Table) == 0) {
                // break -> 0x80b1dc0
                break;
            }
        }
    }
    // 0x80b1daf
    v4 += 32;
    int32_t * v7 = (int32_t *)v4;
    int32_t v8 = *v7; // 0x80b1db6
    int32_t * result = v7; // 0x80b1dba
    while (v8 != 0) {
        // 0x80b1d33
        if (*(int32_t *)(v4 + 4) != 0) {
            int32_t * v9 = v7;
            c2 = (int32_t)*(char *)v8;
            v6 = *__ctype_b_loc();
            v5 = c2;
            if ((*(int16_t *)(2 * c2 + (int32_t)v6) & 512) != 0) {
                // 0x80b1d71
                v5 = toupper(c2);
            }
            // 0x80b1d8f
            if (v5 == (int32_t)v3) {
                // 0x80b1d97
                result = v9;
                if (strcasecomp(name, (char *)*v9) == 0) {
                    // break -> 0x80b1dc0
                    break;
                }
            }
        }
        // 0x80b1daf
        v4 += 32;
        v7 = (int32_t *)v4;
        v8 = *v7;
        result = v7;
    }
    // 0x80b1dc0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYrcFile.c
// Address range: 0x80b1e0e - 0x80b249d
// Line range:    648 - 803
void read_rc(struct _IO_FILE * fp) {
    char MBM_line2[256]; // bp-528, 0x80b1e0e
    char MBM_line[256]; // bp-532, 0x80b1e0e
    char v1[256]; // 0x80b21ac
    char v2[256]; // 0x80b23c1
    int32_t v3 = __readgsdword(20); // 0x80b1e21
    MBM_line2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    struct _IO_FILE * v4; // 0x80b1e0e
    if (fp != NULL) {
        // 0x80b1ebb
        v4 = fp;
        if (WWW_TraceFlag != 0) {
            // 0x80b1eca
            fprintf(TraceFP(), "read_rc used passed-in stream\n");
            v4 = fp;
        }
        goto lab_0x80b23fd_3;
    } else {
        // 0x80b1e3f
        int32_t v5; // bp-268, 0x80b1e0e
        LYAddPathToHome((char *)&v5, 256, ".lynxrc");
        struct _IO_FILE * v6 = fopen64((char *)&v5, "r"); // 0x80b1e6e
        if (v6 == NULL) {
            goto lab_0x80b2483;
        } else {
            // 0x80b1e86
            v4 = v6;
            if (WWW_TraceFlag != 0) {
                // 0x80b1e95
                fprintf(TraceFP(), "read_rc opened %s\n", &v5);
                v4 = v6;
            }
            goto lab_0x80b23fd_3;
        }
    }
  lab_0x80b23fd_2:
    // 0x80b23fd
    if (LYSafeGets((char **)&MBM_line2, v4) == NULL) {
        // break -> 0x80b241d
        goto lab_0x80b241d;
    }
    goto lab_0x80b1ee6;
  lab_0x80b20cf:;
    // 0x80b20cf
    int32_t v11; // 0x80b201b
    int32_t v13 = v11;
    int32_t v14 = v13 + 12; // 0x80b20d5
    int32_t v15 = *(int32_t *)(v13 + 8); // 0x80b20e4
    g379 = v15;
    char * str; // 0x80b1efd
    char * str2; // 0x80b1fc3
    switch (v15) {
        case 1: {
            // 0x80b21b3
            MBM_line = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
            int32_t * v16 = (int32_t *)(v13 + 16); // 0x80b21b9
            int32_t v17 = *(int32_t *)&MBM_line; // 0x80b21bc
            int32_t v18 = *(int32_t *)(4 * v17 + *v16); // 0x80b21c8
            int32_t v19 = v17; // 0x80b21cc
            int32_t v20 = v18; // 0x80b21cc
            if (v18 != 0) {
                int32_t v21 = v19; // 0x80b21ac
                while (strcasecomp(str2, (char *)v20) != 0) {
                    // 0x80b21ac
                    v1[0] = (char)v21 + 1;
                    MBM_line = v1;
                    int32_t v22 = *(int32_t *)&MBM_line; // 0x80b21bc
                    int32_t v23 = *(int32_t *)(4 * v22 + *v16); // 0x80b21c8
                    v19 = v22;
                    v20 = v23;
                    if (v23 == 0) {
                        goto lab_0x80b23fd_2;
                    }
                    v21 = v19;
                }
                // 0x80b2197
                *(int32_t *)*(int32_t *)v14 = v21;
            }
            // break -> 0x80b23fd
            break;
        }
        case 2: {
            int32_t v24 = *(int32_t *)v14; // 0x80b210f
            if (v24 != 0) {
                // 0x80b2119
                *(char *)v24 = getBool(str2);
            }
            // break -> 0x80b23fd
            break;
        }
        case 8: {
            int32_t v25 = *(int32_t *)v14; // 0x80b23dd
            if (v25 != 0) {
                // 0x80b23e3
                HTSACopy((char **)v25, str2);
            }
            // break -> 0x80b23fd
            break;
        }
        case 4: {
            int32_t * v26 = (int32_t *)v14; // 0x80b2216
            if (*v26 != 0) {
                // 0x80b2220
                int32_t v27; // bp-560, 0x80b1e0e
                if (sscanf(str2, "%d", &v27) == 1) {
                    // 0x80b2249
                    *(int32_t *)*v26 = v27;
                }
            }
            // break -> 0x80b23fd
            break;
        }
        case 5: {
            int32_t v28 = *(int32_t *)(v13 + 20); // 0x80b21d9
            if (v28 != 0) {
                // 0x80b21e4
                LYgetEnum((int32_t *)v28, str2, (int32_t *)*(int32_t *)v14);
            }
            // break -> 0x80b23fd
            break;
        }
        case 6: {
            int32_t * v29 = (int32_t *)v14; // 0x80b2264
            int32_t v30 = *v29; // 0x80b2264
            if (v30 != 0) {
                int32_t v31 = v30; // 0x80b227a
                if (*(int32_t *)v30 != 0) {
                    // 0x80b227c
                    HTSACat((char **)v30, ",");
                    v31 = *v29;
                }
                // 0x80b2294
                HTSACat((char **)v31, str2);
            }
            // break -> 0x80b23fd
            break;
        }
        case 7: {
            int32_t v32 = (int32_t)str2; // 0x80b1fc3
            MBM_line = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
            int32_t v33 = *(int32_t *)&MBM_line; // 0x80b23c8
            int32_t v34 = v33; // 0x80b23cf
            if (v33 < 26) {
                int32_t v35 = v34; // 0x80b23c1
                int32_t str3; // bp-524, 0x80b1e0e
                sprintf((char *)&str3, "multi_bookmark%c", (char)LYindex2MBM(v35));
                while (strcasecomp(str, (char *)&str3) != 0) {
                    // 0x80b23c1
                    v2[0] = (char)v35 + 1;
                    MBM_line = v2;
                    uint32_t v36 = *(int32_t *)&MBM_line; // 0x80b23c8
                    v34 = v36;
                    if (v36 >= 26) {
                        goto lab_0x80b23fd_2;
                    }
                    v35 = v34;
                    sprintf((char *)&str3, "multi_bookmark%c", (char)LYindex2MBM(v35));
                }
                char * found_char_pos2 = strchr(str2, 44); // 0x80b231b
                char * v37; // 0x80b1e0e
                if (found_char_pos2 == NULL) {
                    // 0x80b2363
                    v37 = (char *)(strlen(str2) + v32);
                } else {
                    // 0x80b232f
                    *found_char_pos2 = 0;
                    LYTrimTrailing(str2);
                    v37 = LYSkipBlanks((char *)((int32_t)found_char_pos2 + 1));
                }
                int32_t v38 = 4 * v35; // 0x80b2383
                HTSACopy((char **)(v38 + (int32_t)&MBM_A_subbookmark), str2);
                HTSACopy((char **)(v38 + (int32_t)&MBM_A_subdescript), v37);
            }
            // break -> 0x80b23fd
            break;
        }
    }
    goto lab_0x80b23fd_2;
  lab_0x80b23fd_3:
    // 0x80b23fd
    if (LYSafeGets((char **)&MBM_line2, v4) != NULL) {
        while (true) {
          lab_0x80b1ee6:
            // 0x80b1ee6
            LYTrimTrailing((char *)*(int32_t *)&MBM_line2);
            str = LYSkipBlanks((char *)*(int32_t *)&MBM_line2);
            int16_t * v7 = *__ctype_b_loc(); // 0x80b1f0d
            unsigned char v8 = *str; // 0x80b1f15
            int16_t v9 = *(int16_t *)(2 * (int32_t)v8 + (int32_t)v7); // 0x80b1f20
            if (v8 == 0 || (v9 & 4) != 0) {
                goto lab_0x80b23fd_2;
            } else {
                char * found_char_pos = strchr(str, 61); // 0x80b1f53
                if (found_char_pos != NULL) {
                    // 0x80b1f9c
                    *found_char_pos = 0;
                    LYTrimTrailing(str);
                    str2 = LYSkipBlanks((char *)((int32_t)found_char_pos + 1));
                    if (WWW_TraceFlag != 0) {
                        // 0x80b1fd9
                        if ((WWW_TraceMask & 8) != 0) {
                            // 0x80b1fe5
                            fprintf(TraceFP(), "LYrcFile %s:%s\n", str, str2);
                        }
                    }
                    int32_t * v10 = lookup_config2(str); // 0x80b201b
                    v11 = (int32_t)v10;
                    if (*v10 != 0) {
                        goto lab_0x80b20cf;
                    } else {
                        int32_t len = strlen("multi_bookmark"); // 0x80b2049
                        if (strncasecomp(str, "multi_bookmark", len) == 0) {
                            int32_t v12 = (int32_t)lookup_config2("multi_bookmark"); // 0x80b207c
                        }
                        // 0x80b2082
                        if (*(int32_t *)v11 != 0) {
                            goto lab_0x80b20cf;
                        } else {
                            // 0x80b208e
                            if (WWW_TraceFlag != 0) {
                                // 0x80b209d
                                fprintf(TraceFP(), "LYrcFile: ignored %s=%s\n", str, str2);
                            }
                            goto lab_0x80b23fd_2;
                        }
                    }
                } else {
                    // 0x80b1f67
                    if (WWW_TraceFlag != 0) {
                        // 0x80b1f76
                        fprintf(TraceFP(), "LYrcFile: missing '=' %s\n", str);
                    }
                    goto lab_0x80b23fd_2;
                }
            }
        }
    }
  lab_0x80b241d:
    // 0x80b241d
    LYCloseInput(v4);
    LYConfigCookies();
    if (LYrcShowColor == 0) {
        // 0x80b2462
        if (LYShowColor == 2) {
            // 0x80b246c
            LYShowColor = 1;
        }
    } else {
        // 0x80b2444
        if (LYrcShowColor == 3 && LYShowColor != 0) {
            // 0x80b2456
            LYShowColor = 3;
        }
    }
    // 0x80b2476
    set_default_bookmark_page((char *)bookmark_page);
    goto lab_0x80b2483;
  lab_0x80b2483:
    // 0x80b2483
    if (v3 != __readgsdword(20)) {
        // 0x80b248f
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYrcFile.c
// Address range: 0x80b249d - 0x80b2517
// Line range:    810 - 825
void write_list(struct _IO_FILE * fp, char * list) {
    char c = *list; // 0x80b250e
    char * v1 = list; // 0x80b2513
    if (c == 0) {
        // 0x80b2515
        return;
    }
    // 0x80b24c2
    fwrite((int32_t *)"# ", 1, 2, fp);
    // 0x80b24ec
    v1 = (char *)((int32_t)v1 + 1);
    fputc((int32_t)c, fp);
    char v2 = *v1; // 0x80b250e
    int32_t v3 = c == 10; // 0x80b2513
    while (v2 != 0) {
        char c2 = v2;
        if (v3 != 0) {
            // 0x80b24c2
            fwrite((int32_t *)"# ", 1, 2, fp);
        }
        // 0x80b24ec
        v1 = (char *)((int32_t)v1 + 1);
        fputc((int32_t)c2, fp);
        v2 = *v1;
        v3 = c2 == 10;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYrcFile.c
// Address range: 0x80b2517 - 0x80b258b
// Line range:    831 - 859
void explain_keypad_mode(struct _IO_FILE * fp) {
    // 0x80b2517
    write_list(fp, gettext("If keypad_mode is set to \"NUMBERS_AS_ARROWS\", then the numbers on\nyour keypad when the numlock is on will act as arrow keys:\n            8 = Up Arrow\n  4 = Left Arrow    6 = Right Arrow\n            2 = Down Arrow\nand the corresponding keyboard numbers will act as arrow keys,\nregardless of whether numlock is on.\n"));
    write_list(fp, gettext("If keypad_mode is set to \"LINKS_ARE_NUMBERED\", then numbers will\nappear next to each link and numbers are used to select links.\n"));
    write_list(fp, gettext("If keypad_mode is set to \"LINKS_AND_FORM_FIELDS_ARE_NUMBERED\", then\nnumbers will appear next to each link and visible form input field.\nNumbers are used to select links, or to move the \"current link\" to a\nform input field or button.  In addition, options in popup menus are\nindexed so that the user may type an option number to select an option in\na popup menu, even if the option isn't visible on the screen.  Reference\nlists and output from the list command also enumerate form inputs.\n"));
    write_list(fp, gettext("NOTE: Some fixed format documents may look disfigured when\n\"LINKS_ARE_NUMBERED\" or \"LINKS_AND_FORM_FIELDS_ARE_NUMBERED\" are\nenabled.\n"));
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYrcFile.c
// Address range: 0x80b258b - 0x80b2b81
// Line range:    866 - 1013
int32_t save_rc(struct _IO_FILE * fp) {
    char rcfile[256]; // bp-272, 0x80b258b
    char v1[256]; // 0x80b258b
    char v2[256]; // 0x80b277a
    char v3[256]; // 0x80b2b20
    int32_t v4 = __readgsdword(20); // 0x80b259d
    rcfile = {(char)&Config_Table, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    struct _IO_FILE * stream = fp; // 0x80b25c9
    int32_t v5; // 0x80b258b
    if (fp != NULL) {
        goto lab_0x80b2615;
    } else {
        // 0x80b25cb
        int32_t v6; // bp-264, 0x80b258b
        LYAddPathToHome((char *)&v6, 256, ".lynxrc");
        stream = LYNewTxtFile((char *)&v6);
        v5 = 0;
        if (stream != NULL) {
            goto lab_0x80b2615;
        } else {
            goto lab_0x80b2b68;
        }
    }
  lab_0x80b2615:;
    int32_t stream2 = (int32_t)stream;
    write_list(stream, gettext("Lynx User Defaults File\n\n"));
    write_list(stream, gettext("This file contains options saved from the Lynx Options Screen (normally\nwith the 'o' key).  To save options with that screen, you must select the\ncheckbox:\n"));
    fprintf(stream, "#\t%s\n", gettext("Save options to disk"));
    fwrite((int32_t *)"#\n", 1, 2, stream);
    write_list(stream, gettext("You must then save the settings using the link on the line above the\ncheckbox:\n"));
    fprintf(stream, "#\t%s\n", gettext("Accept Changes"));
    fwrite((int32_t *)"#\n", 1, 2, stream);
    write_list(stream, gettext("You may also use the command-line option \"-forms_options\", which displays\nthe simpler Options Menu instead.  Save options with that using the '>' key.\n\n"));
    write_list(stream, gettext("There is normally no need to edit this file manually, since the defaults\nhere can be controlled from the Options Screen, and the next time options\nare saved from the Options Screen this file will be completely rewritten.\nYou have been warned...\n\nIf you are looking for the general configuration file - it is normally\ncalled \"lynx.cfg\".  It has different content and a different format.\nIt is not this file.\n"));
    fputc(10, stream);
    int32_t v7 = *(int32_t *)&rcfile; // 0x80b2b27
    if (*(int32_t *)v7 != 0) {
        int32_t v8; // 0x80b258b
        struct _IO_FILE * v9; // 0x80b258b
        struct _IO_FILE * v10; // 0x80b258b
        int32_t v11; // 0x80b258b
        struct _IO_FILE * v12; // 0x80b258b
        int32_t v13; // 0x80b258b
        int32_t v14; // 0x80b258b
        int32_t v15; // 0x80b258b
        int32_t v16; // 0x80b258b
        int32_t v17; // 0x80b258b
        int32_t stream5; // 0x80b258b
        struct _IO_FILE * stream4; // 0x80b258b
        int32_t stream3; // 0x80b258b
        int32_t v18; // 0x80b258b
        int32_t v19; // 0x80b258b
        int32_t v20; // 0x80b258b
        int32_t v21; // 0x80b258b
        struct _IO_FILE * v22; // 0x80b258b
        int32_t v23; // 0x80b278c
        int32_t * v24; // 0x80b2767
        int32_t v25; // 0x80b27dc
        int32_t * v26; // 0x80b258b
        int32_t v27; // 0x80b28d5
        int32_t v28; // 0x80b28e4
        char v29; // 0x80b2809
        int32_t v30; // 0x80b2ac4
        int32_t v31; // 0x80b2938
        char * v32; // 0x80b294a
        int32_t v33; // 0x80b258b
        int32_t v34; // 0x80b28c8
        int32_t v35; // 0x80b28d5
        int32_t v36; // 0x80b28e4
        int32_t v37; // 0x80b2903
        int32_t v38; // 0x80b2ad2
        int32_t v39; // 0x80b29c9
        int32_t v40; // 0x80b29ee
        int32_t v41; // 0x80b29ee
        int32_t v42; // 0x80b2a36
        int32_t * v43; // 0x80b2a92
        char * v44; // 0x80b2a4e
        int32_t v45; // 0x80b258b
        if (*(int32_t *)(v7 + 4) != 0) {
            // 0x80b2786
            v23 = *(int32_t *)(v7 + 28);
            if (v23 == 0) {
                // 0x80b27b8
                if (*(int32_t *)(v7 + 20) == (int32_t)&tbl_keypad_mode) {
                    // 0x80b27c8
                    explain_keypad_mode((struct _IO_FILE *)stream2);
                }
            } else {
                // 0x80b2793
                write_list((struct _IO_FILE *)stream2, gettext((char *)v23));
            }
            // 0x80b27d6
            v24 = (int32_t *)(v7 + 12);
            v25 = *(int32_t *)(v7 + 8);
            g380 = v25;
            v18 = stream2;
            v19 = stream2;
            v20 = stream2;
            v21 = stream2;
            switch (v25) {
                case 1: {
                    // 0x80b28cf
                    v26 = (int32_t *)(v7 + 16);
                    v27 = *v26;
                    v28 = *(int32_t *)v27;
                    v16 = v28;
                    v8 = v27;
                    if (v28 != 0) {
                        fprintf(stream, "#    %s\n", (char *)v16);
                        v34 = 1;
                        v35 = *v26;
                        v36 = *(int32_t *)(v35 + 4 * v34);
                        v16 = v36;
                        v17 = v34;
                        v8 = v35;
                        while (v36 != 0) {
                            // 0x80b2897
                            fprintf(stream, "#    %s\n", (char *)v16);
                            v34 = v17 + 1;
                            v35 = *v26;
                            v36 = *(int32_t *)(v35 + 4 * v34);
                            v16 = v36;
                            v17 = v34;
                            v8 = v35;
                        }
                    }
                    // 0x80b28ea
                    v37 = *(int32_t *)(4 * *(int32_t *)*v24 + v8);
                    fprintf(stream, "%s=%s\n\n", (char *)*(int32_t *)v7, (char *)v37);
                    v18 = stream2;
                    v19 = stream2;
                    v20 = stream2;
                    v21 = stream2;
                    // break -> 0x80b2b20
                    break;
                }
                case 2: {
                    // 0x80b2801
                    v29 = *(char *)*v24;
                    fprintf(stream, "%s=%s\n\n", (char *)*(int32_t *)v7, v29 == 0 ? "off" : "on");
                    v18 = stream2;
                    v19 = stream2;
                    v20 = stream2;
                    v21 = stream2;
                    // break -> 0x80b2b20
                    break;
                }
                case 8: {
                }
                case 6: {
                    // 0x80b2abe
                    v30 = *v24;
                    v22 = (struct _IO_FILE *)&g47;
                    if (v30 != 0) {
                        // 0x80b2aca
                        v38 = *(int32_t *)v30;
                        v22 = (struct _IO_FILE *)&g47;
                        if (v38 != 0) {
                            // 0x80b2ad8
                            v22 = (struct _IO_FILE *)v38;
                        }
                    }
                    // 0x80b2af4
                    fprintf(stream, "%s=%s\n\n", (char *)*(int32_t *)v7, v22);
                    v18 = stream2;
                    v19 = stream2;
                    v20 = stream2;
                    v21 = stream2;
                    // break -> 0x80b2b20
                    break;
                }
                case 4: {
                    // 0x80b297c
                    fprintf(stream, "%s=%d\n\n", (char *)*(int32_t *)v7, *(int32_t *)*v24);
                    v18 = stream2;
                    v19 = stream2;
                    v20 = stream2;
                    v21 = stream2;
                    // break -> 0x80b2b20
                    break;
                }
                case 5: {
                    // 0x80b2930
                    v31 = *(int32_t *)*v24;
                    v32 = LYputEnum(&((struct _IO_FILE *)*(int32_t *)(v7 + 20))->e0, v31);
                    fprintf(stream, "%s=%s\n\n", (char *)*(int32_t *)v7, v32);
                    v18 = stream2;
                    v19 = stream2;
                    v20 = stream2;
                    v21 = stream2;
                    // break -> 0x80b2b20
                    break;
                }
                case 7: {
                    // 0x80b29c0
                    v33 = (int32_t)stream;
                    v39 = (int32_t)(int32_t *)1;
                    fprintf((struct _IO_FILE *)stream2, "multi_bookmark%c=", (char)LYindex2MBM(v39));
                    v40 = 4 * v39;
                    v41 = *(int32_t *)(v40 + (int32_t)&MBM_A_subbookmark);
                    fputs(v41 == 0 ? (char *)&g47 : (char *)v41, stream);
                    v42 = *(int32_t *)(v40 + (int32_t)&MBM_A_subdescript);
                    if (v42 != 0) {
                        // 0x80b2a41
                        v44 = (char *)v42;
                        if (*v44 != 0) {
                            // 0x80b2a55
                            fprintf((struct _IO_FILE *)stream2, ",%s", v44);
                        }
                    }
                    // 0x80b2a7c
                    fputc(10, stream);
                    v43 = (int32_t *)(v39 + 1);
                    stream5 = v33;
                    stream4 = stream;
                    stream3 = v33;
                    while (v43 < (int32_t *)26) {
                        // 0x80b29c0
                        v39 = (int32_t)v43;
                        fprintf((struct _IO_FILE *)stream3, "multi_bookmark%c=", (char)LYindex2MBM(v39));
                        v40 = 4 * v39;
                        v41 = *(int32_t *)(v40 + (int32_t)&MBM_A_subbookmark);
                        fputs(v41 == 0 ? (char *)&g47 : (char *)v41, stream4);
                        v42 = *(int32_t *)(v40 + (int32_t)&MBM_A_subdescript);
                        if (v42 != 0) {
                            // 0x80b2a41
                            v44 = (char *)v42;
                            if (*v44 != 0) {
                                // 0x80b2a55
                                fprintf((struct _IO_FILE *)stream5, ",%s", v44);
                            }
                        }
                        // 0x80b2a7c
                        fputc(10, stream);
                        v43 = (int32_t *)(v39 + 1);
                        stream5 = v33;
                        stream4 = stream;
                        stream3 = v33;
                    }
                    // 0x80b2aa6
                    fputc(10, stream);
                    v45 = (int32_t)stream;
                    v18 = v45;
                    v19 = v45;
                    v20 = v45;
                    v21 = v45;
                    // break -> 0x80b2b20
                    break;
                }
            }
            // 0x80b2b20
            v3[0] = (char)v7 + 32;
            v9 = stream;
            v10 = stream;
            v11 = v18;
            v12 = stream;
            v13 = v19;
            v14 = v20;
            v15 = v21;
            v1 = v3;
        } else {
            // 0x80b277a
            v2[0] = (char)v7 + 32;
            v9 = stream;
            v10 = stream;
            v11 = stream2;
            v12 = stream;
            v13 = stream2;
            v14 = stream2;
            v15 = stream2;
            v1 = v2;
        }
        // 0x80b2b27
        rcfile = v1;
        int32_t v46 = *(int32_t *)&rcfile; // 0x80b2b27
        while (*(int32_t *)v46 != 0) {
            int32_t v47 = v46; // 0x80b2b20
            int32_t v48 = v15;
            int32_t v49 = v14;
            int32_t stream6 = v13;
            struct _IO_FILE * stream7 = v12;
            int32_t v50 = v11;
            struct _IO_FILE * stream8 = v10; // 0x80b2a7c
            struct _IO_FILE * stream9 = v9; // 0x80b2aa6
            if (*(int32_t *)(v47 + 4) != 0) {
                // 0x80b2786
                v23 = *(int32_t *)(v47 + 28);
                int32_t v51; // 0x80b258b
                if (v23 == 0) {
                    // 0x80b27b8
                    v51 = v48;
                    if (*(int32_t *)(v47 + 20) == (int32_t)&tbl_keypad_mode) {
                        // 0x80b27c8
                        explain_keypad_mode((struct _IO_FILE *)v49);
                        v51 = v49;
                    }
                } else {
                    // 0x80b2793
                    write_list((struct _IO_FILE *)v48, gettext((char *)v23));
                    v51 = v48;
                }
                // 0x80b27d6
                v24 = (int32_t *)(v47 + 12);
                v25 = *(int32_t *)(v47 + 8);
                g380 = v25;
                struct _IO_FILE * v52 = stream9; // 0x80b27ff
                struct _IO_FILE * v53 = stream8; // 0x80b27ff
                v18 = v50;
                struct _IO_FILE * v54 = stream7; // 0x80b27ff
                v19 = stream6;
                v20 = v49;
                v21 = v51;
                switch (v25) {
                    case 1: {
                        // 0x80b28cf
                        v26 = (int32_t *)(v47 + 16);
                        v27 = *v26;
                        v28 = *(int32_t *)v27;
                        v16 = v28;
                        v8 = v27;
                        if (v28 != 0) {
                            fprintf(stream, "#    %s\n", (char *)v16);
                            v34 = 1;
                            v35 = *v26;
                            v36 = *(int32_t *)(v35 + 4 * v34);
                            v16 = v36;
                            v17 = v34;
                            v8 = v35;
                            while (v36 != 0) {
                                // 0x80b2897
                                fprintf(stream, "#    %s\n", (char *)v16);
                                v34 = v17 + 1;
                                v35 = *v26;
                                v36 = *(int32_t *)(v35 + 4 * v34);
                                v16 = v36;
                                v17 = v34;
                                v8 = v35;
                            }
                        }
                        // 0x80b28ea
                        v37 = *(int32_t *)(4 * *(int32_t *)*v24 + v8);
                        fprintf(stream, "%s=%s\n\n", (char *)*(int32_t *)v47, (char *)v37);
                        v52 = stream;
                        v53 = stream;
                        v18 = stream2;
                        v54 = stream;
                        v19 = stream2;
                        v20 = stream2;
                        v21 = stream2;
                        // break -> 0x80b2b20
                        break;
                    }
                    case 2: {
                        // 0x80b2801
                        v29 = *(char *)*v24;
                        int32_t v55 = *(int32_t *)v47; // 0x80b282c
                        fprintf(stream, "%s=%s\n\n", (char *)v55, v29 == 0 ? "off" : "on");
                        v52 = stream;
                        v53 = stream;
                        v18 = stream2;
                        v54 = stream;
                        v19 = stream2;
                        v20 = stream2;
                        v21 = stream2;
                        // break -> 0x80b2b20
                        break;
                    }
                    case 8: {
                    }
                    case 6: {
                        // 0x80b2abe
                        v30 = *v24;
                        v22 = (struct _IO_FILE *)&g47;
                        if (v30 != 0) {
                            // 0x80b2aca
                            v38 = *(int32_t *)v30;
                            v22 = (struct _IO_FILE *)&g47;
                            if (v38 != 0) {
                                // 0x80b2ad8
                                v22 = (struct _IO_FILE *)v38;
                            }
                        }
                        // 0x80b2af4
                        fprintf(stream, "%s=%s\n\n", (char *)*(int32_t *)v47, v22);
                        v52 = stream;
                        v53 = stream;
                        v18 = stream2;
                        v54 = stream;
                        v19 = stream2;
                        v20 = stream2;
                        v21 = stream2;
                        // break -> 0x80b2b20
                        break;
                    }
                    case 4: {
                        int32_t v56 = *(int32_t *)*v24; // 0x80b2984
                        fprintf(stream, "%s=%d\n\n", (char *)*(int32_t *)v47, v56);
                        v52 = stream;
                        v53 = stream;
                        v18 = stream2;
                        v54 = stream;
                        v19 = stream2;
                        v20 = stream2;
                        v21 = stream2;
                        // break -> 0x80b2b20
                        break;
                    }
                    case 5: {
                        // 0x80b2930
                        v31 = *(int32_t *)*v24;
                        v32 = LYputEnum(&((struct _IO_FILE *)*(int32_t *)(v47 + 20))->e0, v31);
                        fprintf(stream, "%s=%s\n\n", (char *)*(int32_t *)v47, v32);
                        v52 = stream;
                        v53 = stream;
                        v18 = stream2;
                        v54 = stream;
                        v19 = stream2;
                        v20 = stream2;
                        v21 = stream2;
                        // break -> 0x80b2b20
                        break;
                    }
                    case 7: {
                        // 0x80b29c0
                        v33 = (int32_t)stream8;
                        stream5 = v50;
                        v39 = (int32_t)(int32_t *)1;
                        fprintf((struct _IO_FILE *)stream6, "multi_bookmark%c=", (char)LYindex2MBM(v39));
                        v40 = 4 * v39;
                        v41 = *(int32_t *)(v40 + (int32_t)&MBM_A_subbookmark);
                        fputs(v41 == 0 ? (char *)&g47 : (char *)v41, stream7);
                        v42 = *(int32_t *)(v40 + (int32_t)&MBM_A_subdescript);
                        if (v42 != 0) {
                            // 0x80b2a41
                            v44 = (char *)v42;
                            if (*v44 != 0) {
                                // 0x80b2a55
                                fprintf((struct _IO_FILE *)stream5, ",%s", v44);
                            }
                        }
                        // 0x80b2a7c
                        fputc(10, stream8);
                        v43 = (int32_t *)(v39 + 1);
                        stream5 = v33;
                        stream4 = stream8;
                        stream3 = v33;
                        while (v43 < (int32_t *)26) {
                            // 0x80b29c0
                            v39 = (int32_t)v43;
                            fprintf((struct _IO_FILE *)stream3, "multi_bookmark%c=", (char)LYindex2MBM(v39));
                            v40 = 4 * v39;
                            v41 = *(int32_t *)(v40 + (int32_t)&MBM_A_subbookmark);
                            fputs(v41 == 0 ? (char *)&g47 : (char *)v41, stream4);
                            v42 = *(int32_t *)(v40 + (int32_t)&MBM_A_subdescript);
                            if (v42 != 0) {
                                // 0x80b2a41
                                v44 = (char *)v42;
                                if (*v44 != 0) {
                                    // 0x80b2a55
                                    fprintf((struct _IO_FILE *)stream5, ",%s", v44);
                                }
                            }
                            // 0x80b2a7c
                            fputc(10, stream8);
                            v43 = (int32_t *)(v39 + 1);
                            stream5 = v33;
                            stream4 = stream8;
                            stream3 = v33;
                        }
                        // 0x80b2aa6
                        fputc(10, stream9);
                        v45 = (int32_t)stream9;
                        v52 = stream9;
                        v53 = stream9;
                        v18 = v45;
                        v54 = stream9;
                        v19 = v45;
                        v20 = v45;
                        v21 = v45;
                        // break -> 0x80b2b20
                        break;
                    }
                }
                // 0x80b2b20
                v3[0] = (char)v47 + 32;
                v9 = v52;
                v10 = v53;
                v11 = v18;
                v12 = v54;
                v13 = v19;
                v14 = v20;
                v15 = v21;
                v1 = v3;
            } else {
                // 0x80b277a
                v2[0] = (char)v47 + 32;
                v9 = stream9;
                v10 = stream8;
                v11 = v50;
                v12 = stream7;
                v13 = stream6;
                v14 = v49;
                v15 = v48;
                v1 = v2;
            }
            // 0x80b2b27
            rcfile = v1;
            v46 = *(int32_t *)&rcfile;
        }
    }
    if (fp == NULL) {
        // 0x80b2b50
        LYCloseOutput(stream);
        v5 = 1;
    } else {
        // 0x80b2b40
        LYCloseTempFP(stream);
        v5 = 1;
    }
    goto lab_0x80b2b68;
  lab_0x80b2b68:;
    int32_t result = v5; // 0x80b2b78
    if (v4 != __readgsdword(20)) {
        // 0x80b2b7a
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80b2b7f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYrcFile.c
// Address range: 0x80b2b81 - 0x80b2ba1
// Line range:    1019 - 1023
char will_save_rc(char * name) {
    // 0x80b2b81
    return *lookup_config2(name) != 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYDownload.c
// Address range: 0x80b2c30 - 0x80b38a2
// Line range:    29 - 456
void LYDownload(char * line) {
    char command[256]; // bp-532, 0x80b2c30
    int32_t v1 = __readgsdword(20); // 0x80b2c43
    command = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    int32_t method_number = 0; // bp-556, 0x80b2c62
    char * v2; // 0x80b2c30
    int32_t * v3; // 0x80b2c30
    int32_t v4; // 0x80b2c30
    int32_t v5; // 0x80b2c30
    int32_t str2; // bp-268, 0x80b2c30
    char v6; // 0x80b2c30
    char v7; // 0x80b2c30
    char v8; // 0x80b2c30
    int32_t * v9; // 0x80b3334
    if (LYValidDownloadFile[0] == 0) {
        // 0x80b2c30
        v3 = (int32_t *)&command;
        goto lab_0x80b381a;
    } else {
        // 0x80b2c93
        HTSACopy((char **)&command, line);
        char * substr_pos = strstr((char *)*(int32_t *)&command, "/File="); // 0x80b2cbc
        if (substr_pos == NULL) {
            goto lab_0x80b381a;
        } else {
            // 0x80b2cd4
            *substr_pos = 0;
            int32_t v10 = (int32_t)substr_pos; // 0x80b2cdd
            char * substr_pos2 = strstr((char *)(v10 + 7), "/SugFile="); // 0x80b2cf8
            char * str3 = NULL; // 0x80b2d0a
            if (substr_pos2 != NULL) {
                // 0x80b2d0c
                *substr_pos2 = 0;
                str3 = (char *)((int32_t)substr_pos2 + 9);
                HTUnEscape(str3);
            }
            char * str = (char *)(v10 + 6);
            int32_t strcmp_rc = strcmp(str, LYValidDownloadFile); // 0x80b2d3b
            v3 = (int32_t *)&command;
            if (strcmp_rc != 0) {
                goto lab_0x80b381a;
            } else {
                // 0x80b2d48
                if (strncmp(str, "file://localhost", 16) != 0) {
                    char v11 = *str; // 0x80b2d79
                    v2 = str;
                    if (v11 != 102 != v11 != 70) {
                        int32_t v12 = strncasecomp(str, "file:", 5); // 0x80b2da6
                        v2 = str;
                        if (v12 == 0) {
                            // 0x80b2daf
                            v2 = (char *)(v10 + 11);
                        }
                    }
                } else {
                    // 0x80b2d6a
                    v2 = (char *)(v10 + 22);
                }
                // 0x80b2db6
                HTUnEscape(v2);
                char * substr_pos3 = strstr((char *)*(int32_t *)&command, "Method="); // 0x80b2dd5
                v3 = (int32_t *)&command;
                if (substr_pos3 == NULL) {
                    goto lab_0x80b381a;
                } else {
                    int32_t str_as_i = atoi((char *)((int32_t)substr_pos3 + 7)); // 0x80b2dfd
                    int32_t v13 = 0; // 0x80b2e0f
                    if (sug_filenames != NULL) {
                        // 0x80b2e11
                        v13 = HTList_count(sug_filenames);
                    }
                    int32_t v14 = v13;
                    int32_t v15 = v14 >= 0 == (v14 != 0); // 0x80b2e43
                    if (str_as_i >= 0) {
                        // 0x80b32ed
                        str2 = 0;
                        char * v16 = (char *)downloaders; // 0x80b332c
                        if (str_as_i > 0) {
                            char * v17 = (char *)((int32_t)NULL + 1); // 0x80b330b
                            char * v18 = (char *)*(int32_t *)(char *)downloaders;
                            char * v19 = v18; // 0x80b332c
                            char * v20 = v17; // 0x80b332c
                            v16 = v18;
                            while (v17 < (char *)str_as_i) {
                                // 0x80b330b
                                v17 = (char *)((int32_t)v20 + 1);
                                v18 = (char *)*(int32_t *)v19;
                                v19 = v18;
                                v20 = v17;
                                v16 = v18;
                            }
                        }
                        // 0x80b332e
                        v9 = (int32_t *)((int32_t)v16 + 8);
                        int32_t v21 = *v9; // 0x80b3334
                        if (v21 == 0) {
                            // 0x80b3767
                            HTAlert(gettext("ERROR! - download command is misconfigured."));
                            v3 = (int32_t *)&command;
                            goto lab_0x80b381a;
                        } else {
                            // 0x80b333f
                            v8 = 0;
                            if (HTCountCommandArgs((char *)v21) < 2) {
                                goto lab_0x80b36b0;
                            } else {
                                // 0x80b3359
                                mustshow = 1;
                                statusline(gettext("Enter a filename: "));
                                v7 = 1;
                                v5 = v14;
                                while (true) {
                                  lab_0x80b3374_2:
                                    // 0x80b3374
                                    if (str3 == NULL) {
                                        // 0x80b339f
                                        str2 = 0;
                                    } else {
                                        // 0x80b337d
                                        strncpy((char *)&str2, str3, 127);
                                    }
                                    char v22 = v7; // 0x80b2c30
                                    int32_t v23 = v5; // 0x80b2c30
                                    int32_t v24; // 0x80b2c30
                                    char v25; // 0x80b2c30
                                    while (true) {
                                        // 0x80b33a6
                                        v24 = v23;
                                        v25 = v22;
                                        uint32_t v26 = LYgetstr((char *)&str2, 0, 256, v15); // 0x80b33c9
                                        char * v27 = (char *)v26; // 0x80b33ce
                                        if (v26 >= 0) {
                                            // 0x80b33dd
                                            if (v27 != (char *)257 == v27 != (char *)256 == ((char)str2 != 0)) {
                                                // break -> 0x80b362c
                                                break;
                                            }
                                        }
                                        int32_t v28; // 0x80b2c30
                                        if (v14 >= 0 == (v14 != 0) == v27 == (char *)256) {
                                            int32_t v29 = v25 == 0 ? v24 + 1 : 0;
                                            if (v29 >= v14) {
                                                // 0x80b3452
                                                mustshow = 1;
                                                statusline(gettext("Enter a filename: "));
                                                v6 = 1;
                                                v4 = v14;
                                                goto lab_0x80b3374;
                                            }
                                            char * v30 = HTList_objectAt(sug_filenames, v29); // 0x80b3497
                                            if (v30 == NULL) {
                                                // break (via goto) -> 0x80b3852
                                                goto lab_0x80b3852_6;
                                            }
                                            // 0x80b34af
                                            LYstrncpy((char *)&str2, v30, 255);
                                            mustshow = 1;
                                            if (v14 != 1) {
                                                // 0x80b34f8
                                                statusline(gettext("Edit a previous filename: "));
                                                v28 = v29;
                                            } else {
                                                // 0x80b34d8
                                                statusline(gettext("Edit the previous filename: "));
                                                v28 = v29;
                                            }
                                        } else {
                                            if (v14 >= 0 == (v14 != 0) != (v27 == (char *)257)) {
                                                // break (via goto) -> 0x80b3852
                                                goto lab_0x80b3852_6;
                                            }
                                            int32_t v31 = (v25 == 0 ? v24 : v14) - 1;
                                            if (v31 < 0) {
                                                // 0x80b3566
                                                mustshow = 1;
                                                statusline(gettext("Enter a filename: "));
                                                v6 = 1;
                                                v4 = v14;
                                                goto lab_0x80b3374;
                                            }
                                            char * v32 = HTList_objectAt(sug_filenames, v31); // 0x80b35ab
                                            if (v32 == NULL) {
                                                // break (via goto) -> 0x80b3852
                                                goto lab_0x80b3852_6;
                                            }
                                            // 0x80b35c3
                                            LYstrncpy((char *)&str2, v32, 255);
                                            mustshow = 1;
                                            if (v14 != 1) {
                                                // 0x80b360c
                                                statusline(gettext("Edit a previous filename: "));
                                                v28 = v31;
                                            } else {
                                                // 0x80b35ec
                                                statusline(gettext("Edit the previous filename: "));
                                                v28 = v31;
                                            }
                                        }
                                        // 0x80b33a6
                                        v22 = 0;
                                        v23 = v28;
                                    }
                                    // 0x80b362c
                                    if (no_dotfiles == 0) {
                                        // 0x80b3637
                                        if (show_dotfiles != 0) {
                                            goto lab_0x80b368b_2;
                                        }
                                    }
                                    // 0x80b3642
                                    if (*LYPathLeaf((char *)&str2) != 46) {
                                        goto lab_0x80b368b_2;
                                    }
                                    // 0x80b3657
                                    HTAlert(gettext("File name may not begin with a dot."));
                                    mustshow = 1;
                                    statusline(gettext("Enter a new filename: "));
                                    v6 = v25;
                                    v4 = v24;
                                    goto lab_0x80b3374;
                                }
                            }
                        }
                    } else {
                        // 0x80b2e68
                        mustshow = 1;
                        statusline(gettext("Enter a filename: "));
                        while (true) {
                          lab_0x80b2e83_2:
                            if (str3 == NULL) {
                                // 0x80b2eae
                                str2 = 0;
                            } else {
                                // 0x80b2e8c
                                LYstrncpy((char *)&str2, str3, 127);
                            }
                            char v33 = 1; // 0x80b2c30
                            int32_t v34 = v14; // 0x80b2c30
                            while (true) {
                                int32_t v35 = v34;
                                char v36 = v33;
                                uint32_t v37 = LYgetstr((char *)&str2, 0, 128, v15); // 0x80b2ed8
                                char * v38 = (char *)v37; // 0x80b2edd
                                if (v37 >= 0) {
                                    // 0x80b2eec
                                    if (v38 != (char *)257 == v38 != (char *)256 == ((char)str2 != 0)) {
                                        // break -> 0x80b313b
                                        break;
                                    }
                                }
                                int32_t v39; // 0x80b2c30
                                if (v14 >= 0 == (v14 != 0) == v38 == (char *)256) {
                                    int32_t v40 = v36 == 0 ? v35 + 1 : 0;
                                    if (v40 >= v14) {
                                        // 0x80b2f61
                                        mustshow = 1;
                                        statusline(gettext("Enter a filename: "));
                                        goto lab_0x80b2e83_2;
                                    }
                                    char * v41 = HTList_objectAt(sug_filenames, v40); // 0x80b2fa6
                                    if (v41 == NULL) {
                                        // break (via goto) -> 0x80b3852
                                        goto lab_0x80b3852_6;
                                    }
                                    // 0x80b2fbe
                                    LYstrncpy((char *)&str2, v41, 255);
                                    mustshow = 1;
                                    if (v14 != 1) {
                                        // 0x80b3007
                                        statusline(gettext("Edit a previous filename: "));
                                        v39 = v40;
                                    } else {
                                        // 0x80b2fe7
                                        statusline(gettext("Edit the previous filename: "));
                                        v39 = v40;
                                    }
                                } else {
                                    if (v14 >= 0 == (v14 != 0) != (v38 == (char *)257)) {
                                        // break (via goto) -> 0x80b3852
                                        goto lab_0x80b3852_6;
                                    }
                                    int32_t v42 = (v36 == 0 ? v35 : v14) - 1;
                                    if (v42 < 0) {
                                        // 0x80b3075
                                        mustshow = 1;
                                        statusline(gettext("Enter a filename: "));
                                        goto lab_0x80b2e83_2;
                                    }
                                    char * v43 = HTList_objectAt(sug_filenames, v42); // 0x80b30ba
                                    if (v43 == NULL) {
                                        // break (via goto) -> 0x80b3852
                                        goto lab_0x80b3852_6;
                                    }
                                    // 0x80b30d2
                                    LYstrncpy((char *)&str2, v43, 255);
                                    mustshow = 1;
                                    if (v14 != 1) {
                                        // 0x80b311b
                                        statusline(gettext("Edit a previous filename: "));
                                        v39 = v42;
                                    } else {
                                        // 0x80b30fb
                                        statusline(gettext("Edit the previous filename: "));
                                        v39 = v42;
                                    }
                                }
                                // 0x80b2eb5
                                v33 = 0;
                                v34 = v39;
                            }
                            // 0x80b313b
                            int32_t str4; // bp-524, 0x80b2c30
                            strcpy((char *)&str4, (char *)&str2);
                            char v44 = LYValidateFilename((char *)&str2, (char *)&str4); // 0x80b3166
                            if (v44 == 0) {
                                // break -> 0x80b3852
                                break;
                            }
                            int32_t v45 = str2; // 0x80b3173
                            if ((char)v45 != 124) {
                                int32_t v46 = LYValidateOutput((char *)&str2); // 0x80b31ce
                                if (v46 == 78) {
                                    // 0x80b31fc
                                    mustshow = 1;
                                    statusline(gettext("Enter a new filename: "));
                                } else {
                                    if (v46 != 89) {
                                        int32_t v47 = *(int32_t *)&command; // 0x80b322f
                                        if (v47 == 0) {
                                            goto lab_0x80b3888;
                                        } else {
                                            // 0x80b323d
                                            free((int32_t *)v47);
                                            command = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                                            goto lab_0x80b3888;
                                        }
                                    }
                                    char v48 = WWW_TraceFlag; // 0x80b31eb
                                    if (v48 != 0) {
                                        struct _IO_FILE * stream = TraceFP(); // 0x80b325a
                                        fprintf(stream, "LYDownload: filename is %s\n", &str2);
                                    }
                                    char v49 = LYCanWriteFile((char *)&str2); // 0x80b3286
                                    if (v49 != 0) {
                                        // 0x80b37db
                                        HTInfoMsg(gettext("Saving..."));
                                        int32_t v50; // 0x80b2c30
                                        LYCopyFile((char *)v50, (char *)&str2);
                                        LYRelaxFilePermissions((char *)&str2);
                                        char * v51 = (char *)&str2; // 0x80b2c30
                                        char * v52 = v51;
                                        HTAddSugFilename(v52);
                                        goto lab_0x80b37f2;
                                    }
                                }
                            } else {
                                // 0x80b317e
                                HTAlert(gettext("Cannot write to file."));
                                mustshow = 1;
                                statusline(gettext("Enter a new filename: "));
                            }
                            goto lab_0x80b2e83_2;
                        }
                    }
                }
            }
        }
    }
  lab_0x80b3852_6:
    // 0x80b3852
    HTInfoMsg(gettext("Cancelling!"));
    int32_t v53 = *(int32_t *)&command; // 0x80b3866
    if (v53 != 0) {
        // 0x80b3870
        free((int32_t *)v53);
        command = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    }
    goto lab_0x80b3888;
  lab_0x80b368b_2:;
    int32_t strcmp_rc2 = strcmp((char *)&str2, "/dev/null"); // 0x80b369c
    v8 = 1;
    if (strcmp_rc2 == 0) {
        goto lab_0x80b3852_6;
    } else {
        goto lab_0x80b36b0;
    }
  lab_0x80b3374:
    // 0x80b3374
    v7 = v6;
    v5 = v4;
    goto lab_0x80b3374_2;
  lab_0x80b381a:
    // 0x80b381a
    HTAlert(gettext("Unable to download file."));
    int32_t v58 = *v3; // 0x80b382e
    if (v58 != 0) {
        // 0x80b3838
        free((int32_t *)v58);
        command = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    }
    goto lab_0x80b3888;
  lab_0x80b3888:
    // 0x80b3888
    if (v1 != __readgsdword(20)) {
        // 0x80b3894
        __stack_chk_fail();
    }
    // 0x80b3899
    return;
  lab_0x80b36b0:
    // 0x80b36b0
    HTAddParam((char **)&method_number, (char *)*v9, 1, v2);
    char * v54 = (char *)1; // 0x80b36fd
    if (HTCountCommandArgs((char *)*v9) >= 2) {
        int32_t v55 = *v9; // 0x80b370c
        HTAddParam((char **)&method_number, (char *)v55, 2, (char *)&str2);
        v54 = (char *)2;
    }
    int32_t v56 = *v9; // 0x80b373b
    HTEndParam((char **)&method_number, (char *)v56, (int32_t)v54);
    if (WWW_TraceFlag != 0) {
        // 0x80b3780
        fprintf(TraceFP(), "command: %s\n", (char *)method_number);
    }
    // 0x80b37a1
    stop_curses();
    LYSystem((char *)method_number);
    if (method_number != 0) {
        // 0x80b37be
        free((int32_t *)method_number);
        method_number = 0;
    }
    // 0x80b37db
    start_curses();
    if (v8 != 1) {
        goto lab_0x80b37f2;
    } else {
        // 0x80b37e4
        HTAddSugFilename((char *)&str2);
        goto lab_0x80b37f2;
    }
  lab_0x80b37f2:;
    int32_t v57 = *(int32_t *)&command; // 0x80b37f2
    if (v57 != 0) {
        // 0x80b3800
        free((int32_t *)v57);
        command = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    }
    goto lab_0x80b3888;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYDownload.c
// Address range: 0x80b38a2 - 0x80b3901
// Line range:    463 - 468
int32_t SuffixIs(char * filename, char * suffix) {
    uint32_t len = strlen(filename); // 0x80b38ae
    uint32_t len2 = strlen(suffix); // 0x80b38bc
    if (len > len2) {
        // 0x80b38cc
        if (strcmp((char *)(len + (int32_t)filename - len2), suffix) == 0) {
            // 0x80b38fc
            return 1;
        }
    }
    // 0x80b38fc
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYDownload.c
// Address range: 0x80b3901 - 0x80b3d76
// Line range:    477 - 586
int32_t LYdownload_options(char ** newfile, char * data_file) {
    char * v1 = NULL; // bp-12, 0x80b3908
    char * downloaded_url = NULL; // bp-16, 0x80b390f
    HTSACopy(&downloaded_url, *newfile);
    change_sug_filename(downloaded_url);
    struct _IO_FILE * stream = InternalPageFP((char *)&g136, 1); // 0x80b3944
    if (stream == NULL) {
        // 0x80b3d6d
        return -1;
    }
    // 0x80b395e
    HTSACopy(&v1, *newfile);
    LYLocalFileToURL(newfile, (char *)&g136);
    LYstrncpy(LYValidDownloadFile, data_file, 255);
    LYforce_no_cache = 1;
    BeginInternalPage(stream, gettext("Download Options"), "Lynx_users_guide.html.gz#RemoteSource");
    fwrite((int32_t *)"<pre>\n", 1, 6, stream);
    fprintf(stream, "<em>%s</em> %s\n", gettext("Downloaded link:"), v1);
    if (v1 != NULL) {
        // 0x80b3a1e
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x80b3a30
    fprintf(stream, "<em>%s</em> %s\n", gettext("Suggested file name:"), downloaded_url);
    char * v2; // 0x80b3901
    if (user_mode != 0) {
        // 0x80b3a74
        v2 = gettext("Download options:");
    } else {
        // 0x80b3a63
        v2 = gettext("Standard download options:");
    }
    // 0x80b3a83
    fprintf(stream, "\n%s\n", v2);
    if (no_disk_save != 0) {
        // 0x80b3bd7
        fprintf(stream, "   <em>%s</em>\n", gettext("Save to disk disabled."));
        goto lab_0x80b3bfa;
    } else {
        // 0x80b3aac
        if (lynx_edit_mode != 0) {
            goto lab_0x80b3bfa;
        } else {
            char * v3 = gettext("Save to disk"); // 0x80b3ac2
            int32_t v4 = lynx_save_space; // 0x80b3ad0
            int32_t v5 = v4 == 0 ? (int32_t)&g48 : v4;
            fprintf(stream, "   <a href=\"%s//Method=-1/File=%s/SugFile=%s%s\">%s</a>\n", "LYNXDOWNLOAD:", data_file, (char *)v5, downloaded_url, v3);
            if (SuffixIs(data_file, ".html") != 0) {
                goto lab_0x80b3b53;
            } else {
                // 0x80b3b38
                if (SuffixIs(data_file, ".txt") == 0) {
                    goto lab_0x80b3bfa;
                } else {
                    goto lab_0x80b3b53;
                }
            }
        }
    }
  lab_0x80b3c60:;
    // 0x80b3c60
    int32_t * v6; // 0x80b3901
    int32_t v7 = (int32_t)v6;
    fprintf(stream, "   <a href=\"%s//Method=%d/File=%s/SugFile=%s\">", "LYNXDOWNLOAD:", v7, data_file, downloaded_url);
    int32_t v8; // 0x80b3901
    int32_t v9 = *(int32_t *)(v8 + 4); // 0x80b3c93
    int32_t str = v9; // 0x80b3c98
    if (v9 == 0) {
        // 0x80b3ca5
        str = (int32_t)gettext("No Name Given");
    }
    // 0x80b3cb4
    fputs((char *)str, stream);
    fwrite((int32_t *)"</a>\n", 1, 5, stream);
    int32_t v10 = v7; // 0x80b3ce4
    goto lab_0x80b3ce9;
  lab_0x80b3ce9:;
    // 0x80b3ce9
    char * v11; // 0x80b3901
    int32_t v12 = *(int32_t *)v11; // 0x80b3cec
    v11 = (char *)v12;
    int32_t * v13 = (int32_t *)(v10 + 1); // 0x80b3cf9
    if (v12 == 0) {
        // break -> 0x80b3cff
        goto lab_0x80b3cff;
    }
    goto lab_0x80b3c47;
  lab_0x80b3bfa:
    // 0x80b3bfa
    if (user_mode == 0) {
        // 0x80b3c03
        fprintf(stream, "\n%s\n", gettext("Local additions:"));
    }
    // 0x80b3c26
    if (downloaders != NULL) {
        // 0x80b3c47
        v11 = (char *)downloaders;
        v13 = NULL;
        while (true) {
          lab_0x80b3c47:
            // 0x80b3c47
            v6 = v13;
            v8 = (int32_t)v11;
            if (no_download == 0) {
                goto lab_0x80b3c60;
            } else {
                // 0x80b3c52
                if (*(int32_t *)(v8 + 12) == 0) {
                    // 0x80b3c52
                    v10 = (int32_t)v6;
                    goto lab_0x80b3ce9;
                } else {
                    goto lab_0x80b3c60;
                }
            }
        }
    }
  lab_0x80b3cff:
    // 0x80b3cff
    fwrite((int32_t *)"</pre>\n", 1, 7, stream);
    EndInternalPage(stream);
    LYCloseTempFP(stream);
    LYRegisterUIPage(*newfile, 1);
    if (downloaded_url != NULL) {
        // 0x80b3d54
        free((int32_t *)downloaded_url);
        downloaded_url = NULL;
    }
    // 0x80b3d6d
    return 0;
  lab_0x80b3b53:;
    int32_t * cur_download = NULL; // bp-32, 0x80b3b53
    char * v14 = LYAddPathToSave(data_file); // 0x80b3b60
    LYLocalFileToURL((char **)&cur_download, v14);
    fprintf(stream, "   <a href=\"%s\">%s</a>\n", cur_download, gettext("View temporary file"));
    if (v14 != NULL) {
        // 0x80b3baa
        free((int32_t *)v14);
    }
    // 0x80b3bbc
    if (cur_download != NULL) {
        // 0x80b3bc3
        free(cur_download);
        cur_download = NULL;
    }
    goto lab_0x80b3bfa;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b5164 - 0x80b51fe
// Line range:    1087 - 1104
int32_t * LYcommandList(void) {
    int32_t v1 = g301; // 0x80b516a
    if (v1 != 0) {
        // 0x80b51f7
        return (int32_t *)v1;
    }
    int32_t v2 = (int32_t)HTList_new(); // 0x80b5177
    g301 = v2;
    if (g139 == NULL) {
        // 0x80b51f7
        return (int32_t *)v2;
    }
    int32_t v3 = 0; // 0x80b51f5
    char * v4; // bp-12, 0x80b5164
    if (*(int32_t *)(int32_t)&g140 != 0) {
        // 0x80b51a0
        v4 = NULL;
        HTSACopy(&v4, (char *)*(int32_t *)&g139);
        HTList_addObject((int32_t *)g301, v4);
    }
    // 0x80b51dd
    v3++;
    int32_t v5 = 12 * v3; // 0x80b51ea
    int32_t * v6 = (int32_t *)(v5 + (int32_t)&g139); // 0x80b51ed
    int32_t * v7 = v6; // 0x80b51f5
    while (*v6 != 0) {
        // 0x80b518a
        if (*(int32_t *)(v5 + (int32_t)&g140) != 0) {
            // 0x80b51a0
            v4 = NULL;
            HTSACopy(&v4, (char *)*v7);
            HTList_addObject((int32_t *)g301, v4);
        }
        // 0x80b51dd
        v3++;
        v5 = 12 * v3;
        v6 = (int32_t *)(v5 + (int32_t)&g139);
        v7 = v6;
    }
    // 0x80b51f7
    return (int32_t *)g301;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b5266 - 0x80b53aa
// Line range:    1129 - 1156
int32_t * LYStringToKcmd(char * name) {
    int32_t len = strlen(name); // 0x80b5272
    if (name == NULL || *name == 0) {
        // 0x80b5391
        return (int32_t *)0;
    }
    int32_t v1 = (int32_t)g139; // 0x80b538b
    int32_t * v2 = (int32_t *)&g139; // 0x80b538b
    int32_t v3 = 0; // 0x80b538b
    if (g139 == NULL) {
        // 0x80b5391
        return (int32_t *)0;
    }
    char v4 = 0; // 0x80b538b
    int32_t v5 = 0;
    int32_t v6 = 0;
    while (strcasecomp((char *)v1, name) != 0) {
        char v7 = v4;
        v4 = v7;
        int32_t v8 = v5; // 0x80b52f2
        if (v7 == 0) {
            int32_t * v9 = v2;
            v4 = v7;
            v8 = v5;
            if (strncasecomp((char *)*v9, name, len) == 0) {
                if (v5 != 0) {
                    // 0x80b533c
                    v4 = v7;
                    v8 = v5;
                    if (*(char *)(*v9 + len) != 0) {
                        char v10 = *(char *)(*(int32_t *)(v5 + 4) + len); // 0x80b5361
                        v4 = v10 == 0 ? v7 : 1;
                        v8 = v10 == 0 ? v5 : 0;
                    }
                } else {
                    // 0x80b5326
                    v4 = v7;
                    v8 = v6 + (int32_t)&revmap;
                }
            }
        }
        // 0x80b5373
        v3++;
        int32_t v11 = 12 * v3; // 0x80b5380
        int32_t * v12 = (int32_t *)(v11 + (int32_t)&g139); // 0x80b5383
        v1 = *v12;
        v2 = v12;
        int32_t v13 = v8; // 0x80b538b
        if (v1 == 0) {
            // 0x80b5391
            return (int32_t *)v13;
        }
        v5 = v8;
        v6 = v11;
    }
    int32_t v14 = v6 + (int32_t)&revmap; // 0x80b52e1
    if (v14 != 0) {
        return (int32_t *)v14;
    }
    // 0x80b5391
    return (int32_t *)v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b53aa - 0x80b54e3
// Line range:    1160 - 1190
char * LYKeycodeToString(int32_t c, char upper8) {
    int32_t v1 = 0; // 0x80b53f2
    int32_t v2 = 8 * v1; // 0x80b53c6
    while (*(int32_t *)(v2 + (int32_t)&named_keys) != c) {
        // 0x80b53f6
        v1++;
        if (v1 >= 24) {
            uint32_t v3 = c - 33;
            if (v3 <= 93) {
                // 0x80b5412
                sprintf((char *)&g302, "%c", (char)c);
                return (char *)&g302;
            }
            if (v3 > 222 || upper8 == 0) {
                if (c <= 31) {
                    // 0x80b547b
                    sprintf((char *)&g302, "^%c", (char)c | 64);
                    return (char *)&g302;
                }
                if (c < 256) {
                    // 0x80b54c1
                    sprintf((char *)&g302, "0x%x", c);
                    return (char *)&g302;
                }
                // 0x80b54a4
                sprintf((char *)&g302, "key-0x%x", c);
                return (char *)&g302;
            }
            // 0x80b5447
            if (*(int32_t *)(4 * current_char_set + (int32_t)&LYlowest_eightbit) < c) {
                // 0x80b54c1
                sprintf((char *)&g302, "0x%x", c);
                return (char *)&g302;
            }
            // 0x80b5458
            sprintf((char *)&g302, "%c", (char)c);
            return (char *)&g302;
        }
        v2 = 8 * v1;
    }
    int32_t str = *(int32_t *)(v2 + (int32_t)&g50); // 0x80b53d9
    strcpy((char *)&g302, (char *)str);
  lab_0x80b54dc:
    // 0x80b54dc
    return (char *)&g302;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b54e3 - 0x80b564d
// Line range:    1193 - 1224
int32_t LYStringToKeycode(char * src) {
    int32_t len = strlen(src); // 0x80b54f6
    int32_t result; // 0x80b54e3
    int32_t result2; // 0x80b54e3
    if (len != 1) {
        int32_t v1 = (int32_t)src;
        if (len == 2) {
            // 0x80b551b
            if (*src == 94) {
                // 0x80b5648
                return (int32_t)(*(char *)(v1 + 1) % 32);
            }
        }
        // 0x80b553c
        result = -1;
        if (len < 3) {
            goto lab_0x80b5642;
        } else {
            // 0x80b5542
            int32_t key; // bp-20, 0x80b54e3
            if (strncasecomp(src, "0x", 2) != 0) {
                // 0x80b559f
                result = -1;
                if (len < 7) {
                    goto lab_0x80b5642;
                } else {
                    // 0x80b55a5
                    result = -1;
                    if (strncasecomp(src, "key-", 4) != 0) {
                        goto lab_0x80b5642;
                    } else {
                        // 0x80b55c4
                        key = 0;
                        int32_t str_as_l = strtol((char *)(v1 + 4), (char **)&key, 0); // 0x80b55e3
                        result = -1;
                        if (key == 0) {
                            goto lab_0x80b5642;
                        } else {
                            // 0x80b55f2
                            result2 = str_as_l;
                            result = -1;
                            if (*(char *)key != 0) {
                                goto lab_0x80b5603;
                            } else {
                                goto lab_0x80b5642;
                            }
                        }
                    }
                }
            } else {
                // 0x80b5561
                key = 0;
                int32_t str_as_l2 = strtol(src, (char **)&key, 0); // 0x80b557d
                result2 = str_as_l2;
                if (key != 0) {
                    // 0x80b558c
                    result2 = *(char *)key == 0 ? str_as_l2 : -1;
                }
                goto lab_0x80b5603;
            }
        }
    } else {
        // 0x80b5504
        result2 = (int32_t)*src;
        goto lab_0x80b5603;
    }
  lab_0x80b5642:;
    int32_t v2 = 0; // 0x80b54e3
    int32_t v3 = 8 * v2; // 0x80b5615
    int32_t v4 = *(int32_t *)(v3 + (int32_t)&g50); // 0x80b5615
    while (strcasecomp((char *)v4, src) != 0) {
        int32_t v5 = v2 + 1; // 0x80b563e
        v2 = v5;
        if (v5 >= 24) {
            // 0x80b5648
            return result;
        }
        v3 = 8 * v2;
        v4 = *(int32_t *)(v3 + (int32_t)&g50);
    }
    // 0x80b5648
    return *(int32_t *)(v3 + (int32_t)&named_keys);
  lab_0x80b5603:
    // 0x80b5603
    result = result2;
    if (result2 >= 0) {
        // 0x80b5648
        return result2;
    }
    goto lab_0x80b5642;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b5f57 - 0x80b5fb7
// Line range:    1524 - 1532
void set_any_keys(int32_t * table, uint32_t size) {
    // 0x80b5f57
    if (size <= 0) {
        // 0x80b5fb5
        return;
    }
    int32_t v1 = 0; // 0x80b5fb3
    int32_t v2 = 8 * v1 + (int32_t)table; // 0x80b5f6c
    int16_t * v3 = (int16_t *)(2 * *(int32_t *)v2 + 0x8197ea2); // 0x80b5f85
    *(int16_t *)(v2 + 6) = *v3;
    *v3 = *(int16_t *)(v2 + 4);
    v1++;
    while (v1 != size) {
        // 0x80b5f66
        v2 = 8 * v1 + (int32_t)table;
        v3 = (int16_t *)(2 * *(int32_t *)v2 + 0x8197ea2);
        *(int16_t *)(v2 + 6) = *v3;
        *v3 = *(int16_t *)(v2 + 4);
        v1++;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b5fb7 - 0x80b5ffd
// Line range:    1538 - 1545
void reset_any_keys(int32_t * table, uint32_t size) {
    // 0x80b5fb7
    if (size <= 0) {
        // 0x80b5ffb
        return;
    }
    int32_t v1 = 0; // 0x80b5ff9
    int32_t v2 = 8 * v1 + (int32_t)table; // 0x80b5fcc
    *(int16_t *)(2 * *(int32_t *)v2 + 0x8197ea2) = *(int16_t *)(v2 + 6);
    v1++;
    while (v1 != size) {
        // 0x80b5fc6
        v2 = 8 * v1 + (int32_t)table;
        *(int16_t *)(2 * *(int32_t *)v2 + 0x8197ea2) = *(int16_t *)(v2 + 6);
        v1++;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b6019 - 0x80b603c
// Line range:    1569 - 1572
void set_vi_keys(void) {
    // 0x80b6019
    set_any_keys(&vi_keys_table, 4);
    did_vi_keys = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b603c - 0x80b606a
// Line range:    1575 - 1580
void reset_vi_keys(void) {
    // 0x80b603c
    if (did_vi_keys != 0) {
        // 0x80b604d
        reset_any_keys(&vi_keys_table, 4);
        did_vi_keys = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b606a - 0x80b608d
// Line range:    1593 - 1596
void set_emacs_keys(void) {
    // 0x80b606a
    set_any_keys(&emacs_keys_table, 4);
    did_emacs_keys = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b608d - 0x80b60bb
// Line range:    1599 - 1604
void reset_emacs_keys(void) {
    // 0x80b608d
    if (did_emacs_keys != 0) {
        // 0x80b609e
        reset_any_keys(&emacs_keys_table, 4);
        did_emacs_keys = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b60bb - 0x80b60de
// Line range:    1626 - 1629
void set_numbers_as_arrows(void) {
    // 0x80b60bb
    set_any_keys(&number_keys_table, 9);
    did_number_keys = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b60de - 0x80b610c
// Line range:    1632 - 1637
void reset_numbers_as_arrows(void) {
    // 0x80b60de
    if (did_number_keys != 0) {
        // 0x80b60ef
        reset_any_keys(&number_keys_table, 9);
        did_number_keys = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b610c - 0x80b618a
// Line range:    1640 - 1652
char * key_for_func(int32_t func) {
    uint32_t v1 = LYReverseKeymap(func); // 0x80b6118
    if (v1 >= 0) {
        char * v2 = LYKeycodeToString(v1, 1); // 0x80b6134
        HTSACopy(&g303, v2 == NULL ? (char *)&g51 : v2);
        // 0x80b6183
        return g303;
    }
    // 0x80b6166
    if (g303 == NULL) {
        // 0x80b616f
        HTSACopy(&g303, (char *)&g49);
    }
    // 0x80b6183
    return g303;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b618a - 0x80b6334
// Line range:    1662 - 1698
char * fmt_keys(int32_t lkc_first, int32_t lkc_second) {
    int32_t str3 = 0; // bp-16, 0x80b6191
    if (lkc_first < 0) {
        // 0x80b632b
        return NULL;
    }
    char * str = LYKeycodeToString(lkc_first, 1); // 0x80b61bc
    char * v1; // 0x80b618a
    if (str == NULL) {
        // 0x80b6235
        HTSACopy((char **)&str3, str);
        v1 = (char *)&g49;
        goto lab_0x80b6247;
    } else {
        // 0x80b61ca
        if (strlen(str) != 1) {
            // 0x80b6235
            HTSACopy((char **)&str3, str);
            v1 = (char *)&g49;
            goto lab_0x80b6247;
        } else {
            // 0x80b61e8
            if (*str == 39) {
                // 0x80b6235
                HTSACopy((char **)&str3, str);
                v1 = (char *)&g49;
                goto lab_0x80b6247;
            } else {
                if (lkc_second < 0) {
                    // 0x80b61f4
                    HTSprintf0((char **)&str3, "'%s'", str);
                    // 0x80b632b
                    return (char *)str3;
                }
                // 0x80b6219
                HTSprintf0((char **)&str3, "'%s", str);
                v1 = (char *)&g52;
                goto lab_0x80b6247;
            }
        }
    }
  lab_0x80b6247:
    if (lkc_second < 0) {
        // 0x80b632b
        return (char *)str3;
    }
    char * str2 = LYKeycodeToString(lkc_second, 1); // 0x80b625f
    if (str2 == NULL) {
        // 0x80b626d
        if (str3 != 0) {
            // 0x80b6274
            free((int32_t *)str3);
            str3 = 0;
        }
        // 0x80b632b
        return NULL;
    }
    // 0x80b6292
    char * v2; // 0x80b618a
    if (strlen(str2) < 3) {
        goto lab_0x80b62c2;
    } else {
        // 0x80b62b8
        v2 = (char *)&g53;
        if (*str2 != 60) {
            goto lab_0x80b62fd;
        } else {
            goto lab_0x80b62c2;
        }
    }
  lab_0x80b62c2:
    // 0x80b62c2
    if (strlen((char *)str3) < 3) {
        // 0x80b62f6
        v2 = (char *)&g49;
        goto lab_0x80b62fd;
    } else {
        int32_t str4 = str3;
        char v3 = *(char *)(str4 - 1 + strlen((char *)str4)); // 0x80b62e6
        v2 = (char *)&g53;
        if (v3 == 62) {
            // 0x80b62f6
            v2 = (char *)&g49;
            goto lab_0x80b62fd;
        } else {
            goto lab_0x80b62fd;
        }
    }
  lab_0x80b62fd:
    // 0x80b62fd
    HTSprintf((char **)&str3, "%s%s%s", v2, str2, v1);
    // 0x80b632b
    return (char *)str3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b6334 - 0x80b64cb
// Line range:    1714 - 1735
int32_t best_reverse_keymap(int32_t lac) {
    int32_t v1 = 97;
    int32_t result; // 0x80b6334
    int32_t v2; // 0x80b6334
    while (true) {
      lab_0x80b6346:;
        int32_t v3 = v1;
        if (lynx_edit_mode != 0 && lac != 0 && no_dired_support == 0) {
            int32_t v4 = key_override[0]; // 0x80b636c
            if (v3 != -1) {
                if ((v3 & 0x8800) == 0) {
                    uint16_t v5 = *(int16_t *)((2 * v3 & 4094) + (int32_t)&key_override + 2); // 0x80b63a1
                    v4 = v5;
                } else {
                    // 0x80b6389
                    v4 = v3 % 256;
                }
            }
            // 0x80b63b5
            result = v3;
            if (v4 == lac) {
                // break -> 0x80b64c6
                break;
            }
        }
        int32_t v6 = keymap[0]; // 0x80b63cc
        if (v3 != -1) {
            if ((v3 & 0x8800) == 0) {
                uint16_t v7 = *(int16_t *)((2 * v3 & 4094) + (int32_t)&keymap + 2); // 0x80b6401
                v6 = v7;
            } else {
                // 0x80b63e9
                v6 = v3 % 256;
            }
        }
        // 0x80b6415
        result = v3;
        if (v6 == lac) {
            // break -> 0x80b64c6
            break;
        }
        // 0x80b6428
        v2 = 32;
        switch (v3) {
            case 122: {
                goto lab_0x80b64af;
            }
            case 96: {
                // 0x80b64af
                v2 = 123;
                goto lab_0x80b64af;
            }
            case 126: {
                // 0x80b64af
                v2 = 0;
                goto lab_0x80b64af;
            }
            case 31: {
                // 0x80b64af
                v2 = 256;
                goto lab_0x80b64af;
            }
            case 659: {
                // 0x80b64af
                v2 = 127;
                goto lab_0x80b64af;
            }
            default: {
                // 0x80b6449
                v2 = v3 == 255 ? -1 : v3 + 1;
                goto lab_0x80b64af;
            }
        }
    }
    // 0x80b64c6
    return result;
  lab_0x80b64af:
    // 0x80b64af
    v1 = v2;
    result = -1;
    if (v1 < 0) {
        return result;
    }
    goto lab_0x80b6346;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b64cb - 0x80b65ae
// Line range:    1745 - 1769
char * key_for_func_ext(int32_t lac, int32_t context_code) {
    int32_t lkc = -1; // bp-12, 0x80b64d1
    char * result; // 0x80b64cb
    if (context_code == 2) {
        uint32_t v1 = LYEditKeyForAction(lac, &lkc); // 0x80b64eb
        if (v1 >= 0) {
            if ((v1 & 0x7000) == 0) {
                // 0x80b6522
                result = fmt_keys(v1, -1);
            } else {
                // 0x80b6505
                result = fmt_keys(lkc, v1 & -0x7001);
            }
            // 0x80b65a9
            return result;
        }
    }
    int32_t v2 = best_reverse_keymap(lac); // 0x80b6540
    if (v2 < 0) {
        // 0x80b65a9
        return NULL;
    }
    if (context_code != 2) {
        // 0x80b65a9
        return fmt_keys(v2, -1);
    }
    int32_t v3 = LYKeyForEditAction(23); // 0x80b6564
    lkc = v3;
    result = NULL;
    if (v3 >= 0) {
        // 0x80b657c
        result = fmt_keys(v3, v2);
    }
    // 0x80b65a9
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b65ae - 0x80b660a
// Line range:    1777 - 1787
char LYisNonAlnumKeyname(uint32_t ch, int32_t KeyName) {
    // 0x80b65ae
    if (ch >= 661) {
        // 0x80b6604
        return 0;
    }
    uint16_t v1; // 0x80b65f2
    if (ch == 0) {
        // 0x80b65ec
        v1 = *(int16_t *)(2 * ch + (int32_t)&keymap + 2);
        // 0x80b6604
        return (int32_t)v1 == KeyName;
    }
    // 0x80b65cf
    if (strchr("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz", ch) != NULL) {
        // 0x80b6604
        return 0;
    }
    // 0x80b65ec
    v1 = *(int16_t *)(2 * ch + (int32_t)&keymap + 2);
    // 0x80b6604
    return (int32_t)v1 == KeyName;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYKeymap.c
// Address range: 0x80b660a - 0x80b6650
// Line range:    1794 - 1804
int32_t LYReverseKeymap(int32_t KeyName) {
    int32_t v1 = 1;
    uint16_t v2 = *(int16_t *)(2 * v1 + (int32_t)&keymap); // 0x80b661c
    while ((int32_t)v2 != KeyName) {
        int32_t v3 = v1 + 1; // 0x80b6637
        if (v3 >= 661) {
            // 0x80b664b
            return -1;
        }
        v1 = v3;
        v2 = *(int16_t *)(2 * v1 + (int32_t)&keymap);
    }
    // 0x80b664b
    return v1 - 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTML.c
// Address range: 0x80b6650 - 0x80b66ba
// Line range:    161 - 168
void strtolower(char * i) {
    if (i == NULL) {
        // 0x80b66b8
        return;
    }
    // 0x80b66ae
    if (*i == 0) {
        // 0x80b66b8
        return;
    }
    char * v1 = i; // 0x80b66b6
    int16_t * v2 = *__ctype_b_loc(); // 0x80b6663
    unsigned char v3 = *v1; // 0x80b6668
    int32_t c = v3; // 0x80b6668
    char v4 = v3; // 0x80b6680
    if ((*(int16_t *)(2 * c + (int32_t)v2) & 256) != 0) {
        // 0x80b6682
        v4 = tolower(c);
    }
    // 0x80b66a1
    *v1 = v4;
    v1 = (char *)((int32_t)v1 + 1);
    while (*v1 != 0) {
        // 0x80b665e
        v2 = *__ctype_b_loc();
        v3 = *v1;
        c = v3;
        v4 = v3;
        if ((*(int16_t *)(2 * c + (int32_t)v2) & 256) != 0) {
            // 0x80b6682
            v4 = tolower(c);
        }
        // 0x80b66a1
        *v1 = v4;
        v1 = (char *)((int32_t)v1 + 1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTML.c
// Address range: 0x80cfbec - 0x80cfc04
// Line range:    8223 - 8226
int32_t HTLoadError(int32_t * sink, int32_t number, char * message) {
    // 0x80cfbec
    HTAlert((char *)number);
    return -(int32_t)sink;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d2478 - 0x80d3425
// Line range:    55 - 187
void HTFormatInit(void) {
    // 0x80d2478
    if (WWW_TraceFlag != 0) {
        // 0x80d2491
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d249d
            fprintf(TraceFP(), "HTFormatInit\n");
        }
    }
    // 0x80d24b4
    if (LYgetXDisplay() != NULL) {
        // 0x80d24c1
        HTSetPresentation("application/postscript", "ghostview %s&", NULL, 1.0, 3.0, 0.0, 0, 2);
        if (XLoadImageCommand != 0) {
            char * v1 = (char *)XLoadImageCommand; // 0x80d2514
            if (*v1 != 0) {
                // 0x80d251f
                HTSetPresentation("image/gif", v1, NULL, 1.0, 3.0, 0.0, 0, 2);
                HTSetPresentation("image/x-xbm", (char *)XLoadImageCommand, NULL, 1.0, 3.0, 0.0, 0, 2);
                HTSetPresentation("image/x-xbitmap", (char *)XLoadImageCommand, NULL, 1.0, 3.0, 0.0, 0, 2);
                HTSetPresentation("image/x-png", (char *)XLoadImageCommand, NULL, 2.0, 3.0, 0.0, 0, 2);
                HTSetPresentation("image/png", (char *)XLoadImageCommand, NULL, 1.0, 3.0, 0.0, 0, 2);
                HTSetPresentation("image/x-rgb", (char *)XLoadImageCommand, NULL, 1.0, 3.0, 0.0, 0, 2);
                HTSetPresentation("image/x-tiff", (char *)XLoadImageCommand, NULL, 2.0, 3.0, 0.0, 0, 2);
                HTSetPresentation("image/tiff", (char *)XLoadImageCommand, NULL, 1.0, 3.0, 0.0, 0, 2);
                HTSetPresentation("image/jpeg", (char *)XLoadImageCommand, NULL, 1.0, 3.0, 0.0, 0, 2);
            }
        }
        // 0x80d2782
        HTSetPresentation("video/mpeg", "mpeg_play %s &", NULL, 1.0, 3.0, 0.0, 0, 2);
    }
    // 0x80d27c3
    HTSetPresentation("application/x-csh", "csh %s", NULL, 999.0, 3.0, 0.0, 0, 2);
    HTSetPresentation("application/x-sh", "sh %s", NULL, 999.0, 3.0, 0.0, 0, 2);
    HTSetPresentation("application/x-ksh", "ksh %s", NULL, 999.0, 3.0, 0.0, 0, 2);
    HTSetConversion("message/x-http-redirection", "*", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8132a73, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("message/x-http-redirection", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8132a73, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("message/x-http-redirection", "www/debug", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8132a73, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("www/mime", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8132561, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("www/mime", "www/download", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8132561, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("www/mime", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8132561, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("www/mime", "www/dump", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8132561, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("www/compressed", "www/download", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80d199d, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("www/compressed", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80d199d, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("www/compressed", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80d199d, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("www/compressed", "www/dump", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80d199d, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/html", "text/x-c", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cfaa9, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/html", "text/plain", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cf871, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/css", "text/plain", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cf871, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/html", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cfb79, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/xhtml+xml", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cfb79, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/xml", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cfb79, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/html", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8123875, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/x-wais-source", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8123875, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/x-wais-source", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8144937, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/x-wais-source", "www/download", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8144937, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("application/x-wais-source", "www/dump", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8144937, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("www/source", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80d0f0b, 0.0f, 3.0f, 0.0f, 0, 0);
    HTSetConversion("www/source", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80d0f0b, 0.0f, 3.0f, 0.0f, 0, 0);
    HTSetConversion("www/source", "www/download", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80d0f0b, 0.0f, 3.0f, 0.0f, 0, 0);
    HTSetConversion("www/source", "*", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80d0f0b, 0.0f, 3.0f, 0.0f, 0, 0);
    HTSetConversion("www/source", "www/dump", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80d2408, 0.0f, 3.0f, 0.0f, 0, 0);
    HTSetConversion("text/x-sgml", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8123875, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/x-sgml", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cfb79, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/sgml", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8123875, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/sgml", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cfb79, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/css", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8123875, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/plain", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8123875, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/plain", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8123875, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/html", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x8123875, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/html", "text/x-c", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cfaa9, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/html", "text/plain", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cf871, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/html", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cfb79, 0.0f, 0.0f, 0.0f, 0, 0);
    HTSetConversion("text/xml", "www/present", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cfb79, 0.0f, 0.0f, 0.0f, 0, 0);
    if (LYisAbsPath((char *)global_type_map) != 0) {
        // 0x80d337b
        HTLoadTypesConfigFile((char *)global_type_map, 16);
    }
    char * v2 = LYAbsOrHomePath((char **)&personal_type_map); // 0x80d3397
    if (IsOurFile(v2) != 0) {
        // 0x80d33a8
        if (LYCanReadFile((char *)personal_type_map) != 0) {
            // 0x80d33b9
            HTLoadTypesConfigFile((char *)personal_type_map, 8);
        }
    }
    int32_t * v3 = HTAtom_for("www/present"); // 0x80d33d5
    HTReorderPresentation(HTAtom_for("text/plain"), v3);
    int32_t * v4 = HTAtom_for("www/present"); // 0x80d33fb
    HTReorderPresentation(HTAtom_for("text/html"), v4);
    HTFilterPresentations();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d3425 - 0x80d34f8
// Line range:    190 - 196
void HTPreparsedFormatInit(void) {
    // 0x80d3425
    if (WWW_TraceFlag != 0) {
        // 0x80d3436
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d3442
            fprintf(TraceFP(), "HTPreparsedFormatInit\n");
        }
    }
    // 0x80d3459
    if (LYPreparsedSource != 0) {
        // 0x80d3468
        HTSetConversion("text/html", "www/source", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cf8dd, 1.0f, 0.0f, 0.0f, 0, 1);
        HTSetConversion("text/html", "www/dump", (int32_t * (*)(int32_t, int32_t *, int32_t *))0x80cf8dd, 1.0f, 0.0f, 0.0f, 0, 1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d34f8 - 0x80d35f4
// Line range:    240 - 274
char * GetCommand(char * s, char ** t) {
    char * str = LYSkipBlanks(s); // 0x80d350b
    int32_t * mem = malloc(2 * strlen(str) | 1); // 0x80d3526
    if (mem == NULL) {
        // 0x80d3534
        ExitWithError(gettext("Memory exhausted!  Program aborted!"));
        // UNREACHABLE
    }
    // 0x80d3548
    *(int32_t *)t = (int32_t)mem;
    char * v1 = (char *)mem; // 0x80d35d2
    char * v2 = str; // 0x80d35d2
    char * v3 = (char *)mem; // 0x80d35d2
    char * result; // 0x80d34f8
    if (str == NULL) {
      lab_0x80d35e2_3:
        // 0x80d35e2
        *v3 = 0;
        result = NULL;
      lab_0x80d35ef:
        // 0x80d35ef
        return result;
    }
    char * v4; // 0x80d34f8
    char * v5; // 0x80d34f8
    char * v6; // 0x80d34f8
    while (true) {
      lab_0x80d35d4:
        // 0x80d35d4
        v5 = v1;
        char * v7 = NULL; // 0x80d34f8
        v4 = v2;
        char v8 = *v4; // 0x80d35d7
        if (v8 == 0) {
            // break (via goto) -> 0x80d35e2
            goto lab_0x80d35e2_3;
        }
        while (v7 == NULL) {
            if (v8 == 59) {
                // 0x80d3592
                *v5 = 0;
                result = (char *)((int32_t)v4 + 1);
                return result;
            }
            if (v8 != 92) {
                // 0x80d35bb
                *v5 = v8;
                v6 = v5;
                goto lab_0x80d35ce;
            }
            int32_t v9 = (int32_t)v4 + 1; // 0x80d35b5
            v7 = (char *)1;
            if (v9 == 0) {
                // break (via goto) -> 0x80d35e2
                goto lab_0x80d35e2_3;
            }
            v4 = (char *)v9;
            v8 = *v4;
            if (v8 == 0) {
                // break (via goto) -> 0x80d35e2
                goto lab_0x80d35e2_3;
            }
        }
        char v10 = v8; // 0x80d3560
        char * v11 = v5; // 0x80d3560
        if (v8 == 37) {
            // 0x80d3562
            *v5 = 37;
            v10 = *v4;
            v11 = (char *)((int32_t)v5 + 1);
        }
        // 0x80d356c
        *v11 = v10;
        v6 = v11;
        goto lab_0x80d35ce;
    }
  lab_0x80d35e2_3:
    // 0x80d35e2
    *v5 = 0;
    // 0x80d35ef
    return NULL;
  lab_0x80d35ce:;
    int32_t v12 = (int32_t)v4 + 1;
    v1 = (char *)((int32_t)v6 + 1);
    v2 = (char *)v12;
    v3 = v1;
    if (v12 == 0) {
        // break -> 0x80d35e2
        goto lab_0x80d35e2_3;
    }
    goto lab_0x80d35d4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d35f4 - 0x80d3620
// Line range:    278 - 283
char * Cleanse(char * s) {
    // 0x80d35f4
    LYTrimLeading(s);
    LYTrimTrailing(s);
    LYLowerCase(s);
    return s;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d3620 - 0x80d3719
// Line range:    287 - 336
void TrimCommand(char * command) {
    // 0x80d3620
    LYTrimTrailing(command);
    char * v1 = command; // 0x80d3650
    char * v2 = command; // 0x80d3650
    char v3 = 32; // 0x80d3650
    char v4 = 0; // 0x80d3650
    char v5 = 0; // 0x80d3650
    char * v6; // 0x80d3620
    char * v7; // 0x80d3620
    char v8; // 0x80d3620
    char v9; // 0x80d3620
    char v10; // 0x80d3620
    char v11; // 0x80d3620
    char v12; // 0x80d3620
    char v13; // 0x80d36f5
    while (true) {
        // 0x80d36f2
        v7 = v2;
        v6 = v1;
        v9 = v3;
        while (true) {
          lab_0x80d36f2:
            // 0x80d36f2
            v13 = *v6;
            if (v13 == 0) {
                // break (via goto) -> 0x80d3711
                goto lab_0x80d3711;
            }
            char v14 = v5;
            char v15 = v4;
            v10 = v9;
            if (v14 == 0) {
                if (v15 == 0) {
                    // 0x80d3685
                    v11 = 0;
                    v12 = 1;
                    switch (v13) {
                        case 39: {
                            goto lab_0x80d36b3;
                        }
                        case 92: {
                            // 0x80d36a9
                            v11 = 0;
                            v12 = 0;
                            goto lab_0x80d36b3;
                        }
                        default: {
                            // 0x80d3697
                            v11 = v13 == 34;
                            v12 = 0;
                            goto lab_0x80d36b3;
                        }
                    }
                } else {
                    // 0x80d3679
                    v11 = v13 != 34 ? v15 : 0;
                    v12 = 0;
                    goto lab_0x80d36b3;
                }
            } else {
                // 0x80d3667
                v11 = v15;
                v12 = v13 != 39 ? v14 : 0;
                goto lab_0x80d36b3;
            }
        }
      lab_0x80d36de_2:
        // 0x80d36de
        v3 = v8;
        *v7 = v3;
        v2 = (char *)((int32_t)v7 + 1);
    }
  lab_0x80d3711:
    // 0x80d3711
    *v7 = 0;
  lab_0x80d36b3:
    // 0x80d36b3
    v1 = (char *)((int32_t)v6 + 1);
    v5 = v12;
    v4 = v11;
    v8 = v13;
    if ((v5 || v4) != 0) {
        // break -> 0x80d36de
        goto lab_0x80d36de_2;
    }
    char v16 = v13 != 9 ? v13 : 32;
    v8 = v16;
    v6 = v1;
    v9 = 32;
    if (v10 == 32 != (v16 == 32)) {
        // break -> 0x80d36de
        goto lab_0x80d36de_2;
    }
    goto lab_0x80d36f2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d3719 - 0x80d3ee5
// Line range:    339 - 481
int32_t ProcessMailcapEntry(struct _IO_FILE * fp, int32_t * mc, int32_t media) {
    char * s = NULL; // bp-40, 0x80d3728
    int32_t * mem = malloc(2000); // 0x80d3735
    if (mem == NULL) {
        // 0x80d3743
        ExitWithError(gettext("Memory exhausted!  Program aborted!"));
        // UNREACHABLE
    }
    int32_t v1 = (int32_t)mem; // 0x80d3735
    *(char *)mem = 0;
    char * v2 = LYSafeGets(&s, fp); // 0x80d384f
    int32_t v3 = 2000; // 0x80d3856
    int32_t str3 = v1; // 0x80d3856
    int32_t v4 = v1; // 0x80d3856
    int32_t str2; // 0x80d3719
    if (v2 != NULL) {
        while (true) {
            // 0x80d3762
            str2 = str3;
            int32_t v5 = v3;
            char * str; // 0x80d376d
            while (true) {
              lab_0x80d3762:
                // 0x80d3762
                LYTrimNewline(s);
                str = s;
                switch (*str) {
                    case 35: {
                        goto lab_0x80d3842;
                    }
                    case 0: {
                        goto lab_0x80d3842;
                    }
                    default: {
                        goto lab_0x80d3789;
                    }
                }
            }
          lab_0x80d3789:;
            int32_t len = strlen(str); // 0x80d378f
            uint32_t v6 = len + 1 + strlen((char *)str2); // 0x80d37a5
            int32_t v7 = str2; // 0x80d37b1
            v3 = v5;
            if (v6 > v5) {
                // 0x80d37b3
                v3 = v5 + 2000 + v6;
                int32_t * mem2 = realloc((int32_t *)str2, v3); // 0x80d37d0
                v7 = (int32_t)mem2;
                if (mem2 == NULL) {
                    // 0x80d37de
                    ExitWithError(gettext("Memory exhausted!  Program aborted!"));
                    // UNREACHABLE
                }
            }
            // 0x80d37f2
            str3 = v7;
            char * str4 = s;
            if (len == 0) {
                // 0x80d382e
                strcat((char *)str3, str4);
                v4 = str3;
                goto lab_0x80d385c;
            }
            char * v8 = (char *)(len - 1 + (int32_t)str4); // 0x80d3804
            if (*v8 != 92) {
                // 0x80d382e
                strcat((char *)str3, str4);
                v4 = str3;
                goto lab_0x80d385c;
            }
            // 0x80d380b
            *v8 = 0;
            strcat((char *)str3, s);
            char * v9 = LYSafeGets(&s, fp); // 0x80d384f
            v4 = str3;
            if (v9 == NULL) {
                // break -> 0x80d385c
                break;
            }
        }
    }
    goto lab_0x80d385c;
  lab_0x80d385c:
    // 0x80d385c
    if (s != NULL) {
        // 0x80d3863
        free((int32_t *)s);
        s = NULL;
    }
    char * str5 = (char *)v4;
    char * v10 = LYSkipBlanks(str5); // 0x80d387b
    if (*v10 == 0) {
        // 0x80d3893
        if (v4 != 0) {
            // 0x80d3899
            free((int32_t *)v4);
        }
        // 0x80d3edb
        return 0;
    }
    char * found_char_pos = strchr(str5, 59); // 0x80d38c5
    if (found_char_pos == NULL) {
        // 0x80d38d3
        if (WWW_TraceFlag != 0) {
            // 0x80d38de
            if ((WWW_TraceMask & 8) != 0) {
                // 0x80d38ea
                fprintf(TraceFP(), "ProcessMailcapEntry: Ignoring invalid mailcap entry: %s\n", str5);
            }
        }
        // 0x80d3908
        if (v4 != 0) {
            // 0x80d390e
            free((int32_t *)v4);
        }
        // 0x80d3edb
        return 0;
    }
    // 0x80d392c
    *found_char_pos = 0;
    int3_t v11; // 0x80d3719
    int3_t v12; // 0x80d3719
    int3_t v13; // 0x80d3719
    int3_t v14; // 0x80d3719
    char * v15; // bp-52, 0x80d3719
    char * v16; // 0x80d3719
    char * v17; // 0x80d3a9b
    char * str7; // 0x80d3afb
    if (strncasecomp(v10, "text/html", 9) != 0) {
        // 0x80d3955
        if (strncasecomp(v10, "text/plain", 10) != 0) {
            int32_t v18 = (int32_t)mc;
            LYRemoveBlanks(str5);
            LYLowerCase(str5);
            int32_t * v19 = (int32_t *)(v18 + 12); // 0x80d39f0
            *v19 = 0;
            int32_t * v20 = (int32_t *)(v18 + 16); // 0x80d39fa
            *v20 = 0;
            *(int32_t *)(v18 + 20) = 1;
            int32_t v21 = v18 + 8; // 0x80d3a0e
            int32_t * v22 = (int32_t *)v21; // 0x80d3a0e
            *v22 = 0;
            int32_t * v23 = (int32_t *)(v18 + 24); // 0x80d3a18
            *v23 = 0;
            int32_t * v24 = (int32_t *)(v18 + 28); // 0x80d3a22
            *v24 = 0;
            *mc = 0;
            HTSACopy((char **)mc, str5);
            int32_t v25 = v18 + 36; // 0x80d3a4c
            int32_t * v26 = (int32_t *)v25; // 0x80d3a4c
            *v26 = 0x3f800000;
            int32_t * v27 = (int32_t *)(v18 + 40); // 0x80d3a52
            *v27 = 0;
            int32_t v28 = v18 + 4; // 0x80d3a5c
            char * v29 = GetCommand((char *)((int32_t)found_char_pos + 1), (char **)v28); // 0x80d3a69
            if (v29 != NULL) {
                char * v30 = LYSkipBlanks(v29); // 0x80d3a81
                if (v30 != NULL) {
                    float32_t * v31 = (float32_t *)v25;
                    v16 = v30;
                    while (true) {
                      lab_0x80d3a8e:
                        // 0x80d3a8e
                        v13 = v12;
                        v17 = GetCommand(v16, &v15);
                        char * str6 = v15; // 0x80d3aa3
                        char * found_char_pos2 = strchr(str6, 61); // 0x80d3ab7
                        char * v32 = NULL; // 0x80d3ac3
                        if (found_char_pos2 != NULL) {
                            // 0x80d3ac5
                            *found_char_pos2 = 0;
                            v32 = LYSkipBlanks((char *)((int32_t)found_char_pos2 + 1));
                        }
                        // 0x80d3add
                        v11 = v13;
                        if (str6 == NULL) {
                            goto lab_0x80d3d90;
                        } else {
                            // 0x80d3ae7
                            v11 = v13;
                            if (*str6 == 0) {
                                goto lab_0x80d3d90;
                            } else {
                                // 0x80d3af5
                                str7 = Cleanse(str6);
                                if (strcmp(str7, "needsterminal") != 0) {
                                    // 0x80d3b29
                                    if (strcmp(str7, "copiousoutput") != 0) {
                                        char * str8 = v32;
                                        if (str8 == NULL) {
                                            goto lab_0x80d3d3a;
                                        } else {
                                            // 0x80d3b59
                                            if (strcmp(str7, "test") != 0) {
                                                int32_t v33 = (int32_t)str8;
                                                if (strcmp(str7, "description") != 0) {
                                                    // 0x80d3c13
                                                    if (strcmp(str7, "label") != 0) {
                                                        // 0x80d3c3e
                                                        if (strcmp(str7, "print") != 0) {
                                                            // 0x80d3c69
                                                            v11 = v13;
                                                            if (strcmp(str7, "textualnewlines") == 0) {
                                                                goto lab_0x80d3d90;
                                                            } else {
                                                                // 0x80d3c8a
                                                                if (strcmp(str7, "q") != 0) {
                                                                    // 0x80d3cfa
                                                                    if (strcmp(str7, "mxb") != 0) {
                                                                        goto lab_0x80d3d3a;
                                                                    } else {
                                                                        int32_t str_as_l = atol(str8); // 0x80d3d17
                                                                        *v27 = str_as_l >= 0 ? str_as_l : 0;
                                                                        v11 = v13;
                                                                        goto lab_0x80d3d90;
                                                                    }
                                                                } else {
                                                                    // 0x80d3ca1
                                                                    atof(str8);
                                                                    __frontend_reg_store_fpr(v13, __frontend_reg_load_fpr(v13));
                                                                    float80_t v34 = __frontend_reg_load_fpr(v13); // 0x80d3cb5
                                                                    *v31 = (float32_t)v34;
                                                                    __frontend_reg_store_fpr(v13, v34);
                                                                    int3_t v35 = v13 - 1; // 0x80d3cbe
                                                                    __frontend_reg_store_fpr(v35, 0.0L);
                                                                    float80_t v36 = __frontend_reg_load_fpr(v35); // 0x80d3cc0
                                                                    __frontend_reg_store_fpr(v35, __frontend_reg_load_fpr(v13));
                                                                    __frontend_reg_store_fpr(v13, v36);
                                                                    __frontend_reg_load_fpr(v35);
                                                                    __frontend_reg_load_fpr(v13);
                                                                    int3_t v37 = v13 + 1; // 0x80d3cc2
                                                                    v11 = v37;
                                                                    int32_t v38; // 0x80d3719
                                                                    if ((v38 & 0x4100) == 0) {
                                                                        // 0x80d3ce4
                                                                        __frontend_reg_store_fpr(v13, (float80_t)*v31);
                                                                        __frontend_reg_store_fpr(v35, 0.001L);
                                                                        __frontend_reg_load_fpr(v35);
                                                                        __frontend_reg_load_fpr(v13);
                                                                        *v26 = 0x3a83126f;
                                                                        v11 = v37;
                                                                    }
                                                                    goto lab_0x80d3d90;
                                                                }
                                                            }
                                                        } else {
                                                            // 0x80d3c55
                                                            *v24 = v33;
                                                            v11 = v13;
                                                            goto lab_0x80d3d90;
                                                        }
                                                    } else {
                                                        // 0x80d3c2a
                                                        *v23 = v33;
                                                        v11 = v13;
                                                        goto lab_0x80d3d90;
                                                    }
                                                } else {
                                                    // 0x80d3bff
                                                    *v23 = v33;
                                                    v11 = v13;
                                                    goto lab_0x80d3d90;
                                                }
                                            } else {
                                                // 0x80d3b70
                                                *v22 = 0;
                                                HTSACopy((char **)v21, str8);
                                                TrimCommand((char *)*v22);
                                                v11 = v13;
                                                if (WWW_TraceFlag != 0) {
                                                    // 0x80d3bac
                                                    v11 = v13;
                                                    if ((WWW_TraceMask & 8) != 0) {
                                                        // 0x80d3bbc
                                                        fprintf(TraceFP(), "ProcessMailcapEntry: Found testcommand:%s\n", (char *)*v22);
                                                        v11 = v13;
                                                    }
                                                }
                                                goto lab_0x80d3d90;
                                            }
                                        }
                                    } else {
                                        // 0x80d3b40
                                        *v20 = 1;
                                        v11 = v13;
                                        goto lab_0x80d3d90;
                                    }
                                } else {
                                    // 0x80d3b1a
                                    *v19 = 1;
                                    v11 = v13;
                                    goto lab_0x80d3d90;
                                }
                            }
                        }
                    }
                }
            }
          lab_0x80d3db9:
            // 0x80d3db9
            if (v4 != 0) {
                // 0x80d3dbf
                free((int32_t *)v4);
            }
            // 0x80d3dd1
            int32_t * v39; // 0x80d3719
            if (PassesTest(mc) == 0) {
                // 0x80d3dd1
                v39 = (int32_t *)v28;
            } else {
                // 0x80d3de4
                if (WWW_TraceFlag != 0) {
                    // 0x80d3def
                    if ((WWW_TraceMask & 8) != 0) {
                        int32_t v40 = *(int32_t *)v28; // 0x80d3dfe
                        int32_t v41 = *mc; // 0x80d3e04
                        fprintf(TraceFP(), "ProcessMailcapEntry Setting up conversion %s : %s\n", (char *)v41, (char *)v40);
                    }
                }
                int3_t v42 = v14 - 1; // 0x80d3e2e
                __frontend_reg_store_fpr(v42, (float80_t)*(float32_t *)v25);
                int32_t v43 = *v22; // 0x80d3e34
                int32_t * v44 = (int32_t *)v28;
                int32_t v45 = *v44; // 0x80d3e3a
                int32_t v46 = *mc; // 0x80d3e40
                int3_t v47 = v14 - 2; // 0x80d3e4d
                __frontend_reg_store_fpr(v47, 0.0L);
                __frontend_reg_load_fpr(v47);
                __frontend_reg_store_fpr(v47, 3.0L);
                __frontend_reg_load_fpr(v47);
                float80_t v48 = __frontend_reg_load_fpr(v42); // 0x80d3e5d
                HTSetPresentation((char *)v46, (char *)v45, (char *)v43, (float64_t)v48, (float64_t)(int64_t)&g391, (float64_t)(int64_t)&g391, (int32_t)&g391, (int32_t)&g391);
                v39 = v44;
            }
            int32_t v49 = *v39; // 0x80d3e74
            if (v49 != 0) {
                // 0x80d3e7b
                free((int32_t *)v49);
                *v39 = 0;
            }
            int32_t v50 = *v22; // 0x80d3e96
            if (v50 != 0) {
                // 0x80d3e9d
                free((int32_t *)v50);
                *v22 = 0;
            }
            int32_t v51 = *mc; // 0x80d3eb8
            if (v51 != 0) {
                // 0x80d3ebe
                free((int32_t *)v51);
                *mc = 0;
            }
            // 0x80d3edb
            return 1;
        }
    }
    // 0x80d3974
    *found_char_pos = 59;
    if (WWW_TraceFlag != 0) {
        // 0x80d3989
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d3995
            fprintf(TraceFP(), "ProcessMailcapEntry: Ignoring mailcap entry: %s\n", str5);
        }
    }
    // 0x80d39b3
    if (v4 != 0) {
        // 0x80d39b9
        free((int32_t *)v4);
    }
    // 0x80d3edb
    return 0;
  lab_0x80d3842:;
    char * v52 = LYSafeGets(&s, fp); // 0x80d384f
    v4 = str2;
    if (v52 == NULL) {
        // break (via goto) -> 0x80d385c
        goto lab_0x80d385c;
    }
    goto lab_0x80d3762;
  lab_0x80d3d90:
    // 0x80d3d90
    if (v15 != NULL) {
        // 0x80d3d97
        free((int32_t *)v15);
        v15 = NULL;
    }
    // 0x80d3da9
    v16 = v17;
    v12 = v11;
    v14 = v11;
    if (v17 == NULL) {
        // break -> 0x80d3db9
        goto lab_0x80d3db9;
    }
    goto lab_0x80d3a8e;
  lab_0x80d3d3a:
    // 0x80d3d3a
    v11 = v13;
    if (strcmp(str7, "notes") != 0) {
        // 0x80d3d51
        v11 = v13;
        if (*str7 != 0 && WWW_TraceFlag != 0) {
            // 0x80d3d66
            v11 = v13;
            if ((WWW_TraceMask & 8) != 0) {
                // 0x80d3d72
                fprintf(TraceFP(), "ProcessMailcapEntry: Ignoring mailcap flag '%s'.\n", str7);
                v11 = v13;
            }
        }
    }
    goto lab_0x80d3d90;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d3ee5 - 0x80d3f3d
// Line range:    487 - 503
char * LYSkipQuoted(char * s) {
    int32_t v1 = (int32_t)s;
    char * result = (char *)(v1 + 1);
    char v2 = *result; // 0x80d3f31
    if (v2 == 0) {
        // 0x80d3f38
        return result;
    }
    int32_t v3 = 0; // 0x80d3efc
    char * result2; // 0x80d3ee5
    // 0x80d3f07
    v3 = 1;
    if (v2 != 92) {
        // 0x80d3f1a
        v3 = 0;
        if (v2 == 34) {
            // 0x80d3f24
            result2 = (char *)(v1 + 2);
            return result2;
        }
    }
    int32_t v4 = (int32_t)result;
    char * v5 = (char *)(v4 + 1);
    char v6 = *v5; // 0x80d3f31
    int32_t v7 = v3; // 0x80d3f36
    result2 = v5;
    while (v6 != 0) {
        // 0x80d3ef8
        v3 = 0;
        if (v7 == 0) {
            char v8 = v6;
            v3 = 1;
            if (v8 != 92) {
                // 0x80d3f1a
                v3 = 0;
                if (v8 == 34) {
                    // 0x80d3f24
                    result2 = (char *)(v4 + 2);
                    return result2;
                }
            }
        }
        // 0x80d3f2a
        v4 = (int32_t)v5;
        v5 = (char *)(v4 + 1);
        v6 = *v5;
        v7 = v3;
        result2 = v5;
    }
  lab_0x80d3f38:
    // 0x80d3f38
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d3f3d - 0x80d3f7f
// Line range:    510 - 517
char * LYSkipToken(char * s) {
    unsigned char v1 = *s; // 0x80d3f4c
    unsigned char c = v1; // 0x80d3f51
    if (v1 < 33) {
        // 0x80d3f7a
        return s;
    }
    char * v2 = s; // 0x80d3f51
    char * result = v2; // 0x80d3f78
    while (strchr("\"()<>@,;:\\/[]?.=", (int32_t)c) == NULL) {
        // 0x80d3f45
        v2 = (char *)((int32_t)v2 + 1);
        c = *v2;
        result = v2;
        if (c < 33) {
            // break -> 0x80d3f7a
            break;
        }
        result = v2;
    }
    // 0x80d3f7a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d3f7f - 0x80d3fb2
// Line range:    520 - 526
char * LYSkipValue(char * s) {
    // 0x80d3f7f
    char * result; // 0x80d3f7f
    if (*s != 34) {
        // 0x80d3f9f
        result = LYSkipToken(s);
    } else {
        // 0x80d3f8f
        result = LYSkipQuoted(s);
    }
    // 0x80d3fad
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d3fb2 - 0x80d4090
// Line range:    532 - 554
char * LYCopyValue(char * s) {
    char * t = NULL; // bp-16, 0x80d3fb9
    int32_t v1 = (int32_t)s;
    if (*s != 34) {
        char * v2 = LYSkipToken(s); // 0x80d4058
        HTSACopy(&t, s);
        *(char *)((int32_t)v2 - v1 + (int32_t)t) = 0;
        // 0x80d4087
        return t;
    }
    char * v3 = LYSkipQuoted(s); // 0x80d3fd4
    HTSACopy(&t, (char *)(v1 + 1));
    *(char *)(-2 - v1 + (int32_t)v3 + (int32_t)t) = 0;
    int32_t v4 = *t == 92; // 0x80d4036
    char v5 = *(char *)(v4 + (int32_t)t); // 0x80d403c
    *t = v5;
    int32_t v6 = v4; // 0x80d4046
    if (v5 == 0) {
        // 0x80d4087
        return t;
    }
    int32_t v7 = 0; // 0x80d4046
    int32_t v8 = v6 + 1; // 0x80d4048
    v7++;
    int32_t v9 = (int32_t)t; // 0x80d4016
    v6 += 2;
    char v10 = *(char *)(v6 + v9); // 0x80d403c
    *(char *)(v7 + v9) = v10;
    while (v10 != 0) {
        // 0x80d4048
        v8 = v6 + 1;
        v7++;
        v9 = (int32_t)t;
        v6 += 2;
        v10 = *(char *)(v6 + v9);
        *(char *)(v7 + v9) = v10;
    }
    // 0x80d4087
    return t;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d4090 - 0x80d41c5
// Line range:    562 - 603
char * LYGetContentType(char * name, char * params) {
    char * result = NULL; // bp-12, 0x80d4096
    if (params == NULL) {
        // 0x80d41c0
        return result;
    }
    if (name == NULL) {
        // 0x80d41a0
        HTSACopy(&result, params);
        *LYSkipNonBlanks(result) = 0;
        // 0x80d41c0
        return result;
    }
    int32_t len = strlen(name); // 0x80d40b7
    char * found_char_pos = strchr(params, 59); // 0x80d40d5
    while (found_char_pos != NULL) {
        char * str = LYSkipCBlanks((char *)((int32_t)found_char_pos + 1)); // 0x80d40e8
        char * v1 = LYSkipToken(str); // 0x80d40f6
        char v2 = 0; // 0x80d410b
        if ((int32_t)v1 - (int32_t)str == len) {
            // 0x80d410d
            v2 = strncmp(str, name, len) == 0;
        }
        char * v3 = LYSkipCBlanks(v1); // 0x80d4134
        char v4 = *v3; // 0x80d413f
        char v5 = v4; // 0x80d4144
        found_char_pos = v3;
        if (v4 == 61) {
            char * v6 = LYSkipCBlanks((char *)((int32_t)v3 + 1)); // 0x80d4150
            if (v2 != 0) {
                // 0x80d415e
                result = LYCopyValue(v6);
                return result;
            }
            // 0x80d416e
            found_char_pos = LYSkipCBlanks(LYSkipValue(v6));
            v5 = *found_char_pos;
        }
        // 0x80d418a
        if (v5 != 59) {
            // break -> 0x80d41c0
            break;
        }
    }
  lab_0x80d41c0:
    // 0x80d41c0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d41c5 - 0x80d42ab
// Line range:    610 - 648
char LYMailcapUsesPctS(char * controlstring) {
    char v1 = *controlstring; // 0x80d429b
    if (v1 == 0) {
        // 0x80d42a6
        return 0;
    }
    char v2 = 0;
    char * v3 = NULL;
    int32_t v4 = (int32_t)controlstring;
    char v5 = v2; // 0x80d41ef
    char * v6 = v3; // 0x80d41ef
    char * v7 = NULL; // 0x80d41ef
    int32_t v8 = v4; // 0x80d41ef
    char v9; // 0x80d41c5
    char * found_char_pos; // 0x80d426d
    if (NULL == NULL) {
        // 0x80d41fd
        v9 = v1;
        v5 = v2;
        v6 = v3;
        v7 = (char *)1;
        v8 = v4;
        if (v9 != 92) {
            if (v3 == NULL) {
                // 0x80d4283
                v5 = v2;
                v6 = v9 != 37 ? NULL : (char *)1;
                v7 = NULL;
                v8 = v4;
            } else {
                // 0x80d4219
                v5 = v2;
                v6 = NULL;
                v7 = NULL;
                v8 = v4;
                if (v9 != 110) {
                    // 0x80d4232
                    v5 = v2;
                    v6 = NULL;
                    v7 = NULL;
                    v8 = v4;
                    if (v9 >= 111 && v9 != 116) {
                        if (v9 == 123) {
                            // 0x80d425f
                            found_char_pos = strchr(controlstring, 125);
                            v5 = v2;
                            v6 = NULL;
                            v7 = NULL;
                            v8 = found_char_pos == NULL ? v4 : (int32_t)found_char_pos;
                        } else {
                            // 0x80d4250
                            v5 = v9 != 115 ? v2 : 1;
                            v6 = NULL;
                            v7 = NULL;
                            v8 = v4;
                        }
                    }
                }
            }
        }
    }
    char result = v5;
    int32_t v10 = v8 + 1; // 0x80d4294
    char * v11 = (char *)v10; // 0x80d429b
    char v12 = *v11; // 0x80d429b
    char * str = v11; // 0x80d42a0
    char * v13 = v7; // 0x80d42a0
    while (v12 != 0) {
        // 0x80d41eb
        v2 = result;
        v3 = v6;
        v4 = v10;
        v5 = v2;
        v6 = v3;
        v7 = NULL;
        v8 = v4;
        if (v13 == NULL) {
            // 0x80d41fd
            v9 = v12;
            v5 = v2;
            v6 = v3;
            v7 = (char *)1;
            v8 = v4;
            if (v9 != 92) {
                if (v3 == NULL) {
                    // 0x80d4283
                    v5 = v2;
                    v6 = v9 != 37 ? NULL : (char *)1;
                    v7 = NULL;
                    v8 = v4;
                } else {
                    // 0x80d4219
                    v5 = v2;
                    v6 = NULL;
                    v7 = NULL;
                    v8 = v4;
                    if (v9 != 110) {
                        // 0x80d4232
                        v5 = v2;
                        v6 = NULL;
                        v7 = NULL;
                        v8 = v4;
                        if (v9 >= 111 && v9 != 116) {
                            if (v9 == 123) {
                                // 0x80d425f
                                found_char_pos = strchr(str, 125);
                                v5 = v2;
                                v6 = NULL;
                                v7 = NULL;
                                v8 = found_char_pos == NULL ? v4 : (int32_t)found_char_pos;
                            } else {
                                // 0x80d4250
                                v5 = v9 != 115 ? v2 : 1;
                                v6 = NULL;
                                v7 = NULL;
                                v8 = v4;
                            }
                        }
                    }
                }
            }
        }
        // 0x80d4294
        result = v5;
        v10 = v8 + 1;
        v11 = (char *)v10;
        v12 = *v11;
        str = v11;
        v13 = v7;
    }
    // 0x80d42a6
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d42ab - 0x80d4611
// Line range:    661 - 738
int32_t BuildCommand(int32_t * cmd, char * controlstring, char * TmpFileName, char * params) {
    int32_t len = strlen(TmpFileName); // 0x80d42bf
    char v1 = *controlstring; // 0x80d45f2
    if (v1 == 0) {
        // 0x80d45fd
        HTChunkTerminate(cmd);
        return 0;
    }
    char v2 = v1; // 0x80d45f2
    char * v3 = controlstring; // 0x80d42ab
    int32_t v4 = (int32_t)controlstring; // 0x80d45eb
    int32_t v5 = 0;
    char * v6 = NULL; // 0x80d42ab
    char * v7 = NULL; // 0x80d42ab
    char * str; // 0x80d42ab
    int32_t v8; // 0x80d42ab
    int32_t v9; // 0x80d42ab
    int32_t v10; // 0x80d42ab
    int32_t v11; // 0x80d42ab
    while (true) {
      lab_0x80d42e0:;
        char * v12 = v7;
        v10 = v5;
        v11 = v4;
        char v13 = v2;
        if (v6 == NULL) {
            // 0x80d430a
            v7 = v12;
            v6 = (char *)1;
            v8 = v11;
            v9 = v10;
            if (v13 != 92) {
                if (v12 == NULL) {
                    // 0x80d45c0
                    v7 = (char *)1;
                    v6 = NULL;
                    v8 = v11;
                    v9 = v10;
                    if (v13 != 37) {
                        // 0x80d45d3
                        HTChunkPutc(cmd, v13);
                        v7 = NULL;
                        v6 = NULL;
                        v8 = v11;
                        v9 = v10;
                    }
                    goto lab_0x80d45eb;
                } else {
                    if (v13 == 110) {
                        goto lab_0x80d4396;
                    } else {
                        // 0x80d4343
                        str = v3;
                        if (v13 > 110) {
                            switch (v13) {
                                case 116: {
                                    char * v14 = LYGetContentType(NULL, params); // 0x80d43e6
                                    v7 = NULL;
                                    v6 = NULL;
                                    v8 = v11;
                                    v9 = v10;
                                    if (v14 != NULL) {
                                        // 0x80d43f8
                                        HTChunkPuts(cmd, v14);
                                        free((int32_t *)v14);
                                        v7 = NULL;
                                        v6 = NULL;
                                        v8 = v11;
                                        v9 = v10;
                                    }
                                    goto lab_0x80d45eb;
                                }
                                case 123: {
                                    char * found_char_pos = strchr(str, 125); // 0x80d4464
                                    if (found_char_pos == NULL) {
                                        goto lab_0x80d4583;
                                    } else {
                                        int32_t v15 = (int32_t)found_char_pos; // 0x80d4464
                                        v7 = NULL;
                                        v6 = NULL;
                                        v8 = v15;
                                        v9 = -1;
                                        if (params != NULL) {
                                            int32_t v16 = v11 + 1; // 0x80d4480
                                            char * from = NULL; // bp-28, 0x80d4484
                                            HTSprintf0(&from, "%.*s", v15 - v16, (char *)v16);
                                            char * v17 = LYGetContentType(from, params); // 0x80d44be
                                            if (v17 == NULL) {
                                                // 0x80d44f8
                                                if (strcmp(from, "charset") != 0) {
                                                    // 0x80d4524
                                                    if (WWW_TraceFlag != 0) {
                                                        // 0x80d452f
                                                        if ((WWW_TraceMask & 8) != 0) {
                                                            // 0x80d453b
                                                            fprintf(TraceFP(), "BuildCommand no value for %s\n", from);
                                                        }
                                                    }
                                                } else {
                                                    // 0x80d450f
                                                    HTChunkPuts(cmd, "ISO-8859-1");
                                                }
                                            } else {
                                                // 0x80d44cc
                                                HTChunkPuts(cmd, v17);
                                                free((int32_t *)v17);
                                            }
                                            char * v18 = from; // 0x80d4559
                                            v7 = NULL;
                                            v6 = NULL;
                                            v8 = v15;
                                            v9 = v10;
                                            if (v18 != NULL) {
                                                // 0x80d4560
                                                free((int32_t *)v18);
                                                from = NULL;
                                                v7 = NULL;
                                                v6 = NULL;
                                                v8 = v15;
                                                v9 = v10;
                                            }
                                        }
                                        goto lab_0x80d45eb;
                                    }
                                }
                                case 115: {
                                    // 0x80d442b
                                    v7 = NULL;
                                    v6 = NULL;
                                    v8 = v11;
                                    v9 = v10;
                                    if (TmpFileName != NULL && len != 0) {
                                        // 0x80d443f
                                        HTChunkPuts(cmd, TmpFileName);
                                        v7 = NULL;
                                        v6 = NULL;
                                        v8 = v11;
                                        v9 = v10;
                                    }
                                    goto lab_0x80d45eb;
                                }
                                default: {
                                    goto lab_0x80d4583;
                                }
                            }
                        } else {
                            switch (v13) {
                                case 37: {
                                    // 0x80d4379
                                    HTChunkPutc(cmd, 37);
                                    v7 = NULL;
                                    v6 = NULL;
                                    v8 = v11;
                                    v9 = v10;
                                    goto lab_0x80d45eb;
                                }
                                case 70: {
                                    goto lab_0x80d4396;
                                }
                                default: {
                                    goto lab_0x80d4583;
                                }
                            }
                        }
                    }
                }
            } else {
                goto lab_0x80d45eb;
            }
        } else {
            // 0x80d42e6
            HTChunkPutc(cmd, v13);
            v7 = v12;
            v6 = NULL;
            v8 = v11;
            v9 = v10;
            goto lab_0x80d45eb;
        }
    }
  lab_0x80d45fd:
    // 0x80d45fd
    HTChunkTerminate(cmd);
    int32_t result; // 0x80d42ab
    return result;
  lab_0x80d45eb:
    // 0x80d45eb
    v5 = v9;
    v4 = v8 + 1;
    char * v19 = (char *)v4; // 0x80d45f2
    v2 = *v19;
    v3 = v19;
    result = v5;
    if (v2 == 0) {
        // break -> 0x80d45fd
        goto lab_0x80d45fd;
    }
    goto lab_0x80d42e0;
  lab_0x80d4396:
    // 0x80d4396
    v7 = NULL;
    v6 = NULL;
    v8 = v11;
    v9 = v10;
    if (WWW_TraceFlag != 0) {
        // 0x80d43a5
        v7 = NULL;
        v6 = NULL;
        v8 = v11;
        v9 = v10;
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d43b5
            fprintf(TraceFP(), "BuildCommand: Bad mailcap \"test\" clause: %s\n", controlstring);
            v7 = NULL;
            v6 = NULL;
            v8 = v11;
            v9 = v10;
        }
    }
    goto lab_0x80d45eb;
  lab_0x80d4583:
    // 0x80d4583
    v7 = NULL;
    v6 = NULL;
    v8 = v11;
    v9 = v10;
    if (WWW_TraceFlag != 0) {
        // 0x80d458e
        v7 = NULL;
        v6 = NULL;
        v8 = v11;
        v9 = v10;
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d459a
            fprintf(TraceFP(), "BuildCommand: Ignoring unrecognized format code in mailcap file '%%%c'.\n", *str);
            v7 = NULL;
            v6 = NULL;
            v8 = v11;
            v9 = v10;
        }
    }
    goto lab_0x80d45eb;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d4611 - 0x80d483f
// Line range:    748 - 779
int32_t LYTestMailcapCommand(char * testcommand, char * params) {
    char TmpFileName[256]; // bp-272, 0x80d4611
    char TmpFileName2[256]; // bp-276, 0x80d4611
    char v1[256]; // 0x80d478c
    char v2[256]; // 0x80d46ad
    char v3[256]; // 0x80d46df
    int32_t v4 = __readgsdword(20); // 0x80d462d
    TmpFileName2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    int32_t v5; // bp-268, 0x80d4611
    if (LYMailcapUsesPctS(testcommand) == 0) {
        // 0x80d469a
        v5 = 0;
    } else {
        // 0x80d4654
        if (LYOpenTemp((char *)&v5, ".html", "w") == NULL) {
            // 0x80d4676
            ExitWithError(gettext("Can't open temporary file!"));
            // UNREACHABLE
        }
        // 0x80d468a
        LYCloseTemp((char *)&v5);
    }
    char * v6 = (char *)&v5;
    int32_t * v7 = HTChunkCreate(1024); // 0x80d46a8
    v2[0] = (int32_t)v7;
    TmpFileName2 = v2;
    int32_t v8 = *(int32_t *)&TmpFileName2; // 0x80d46d1
    int32_t v9 = BuildCommand(&((struct _IO_FILE *)v8)->e0, testcommand, v6, params); // 0x80d46da
    v3[0] = v9;
    TmpFileName = v3;
    if (*(int32_t *)&TmpFileName == 0) {
        // 0x80d4740
        if (WWW_TraceFlag != 0) {
            // 0x80d474b
            if ((WWW_TraceMask & 8) != 0) {
                int32_t v10 = *(int32_t *)(v8 + 12); // 0x80d475d
                fprintf(TraceFP(), "PassesTest: Executing test command: %s\n", (char *)v10);
            }
        }
        int32_t v11 = LYSystem((char *)*(int32_t *)(v8 + 12)); // 0x80d4787
        v1[0] = v11;
        TmpFileName = v1;
        if (*(int32_t *)&TmpFileName == 0) {
            // 0x80d47d5
            if (WWW_TraceFlag != 0) {
                // 0x80d47e0
                if ((WWW_TraceMask & 8) != 0) {
                    // 0x80d47ec
                    fprintf(TraceFP(), "PassesTest: Test passed!\n");
                }
            }
        } else {
            // 0x80d479b
            TmpFileName = {-1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
            if (WWW_TraceFlag != 0) {
                // 0x80d47b0
                if ((WWW_TraceMask & 8) != 0) {
                    // 0x80d47bc
                    fprintf(TraceFP(), "PassesTest: Test failed!\n");
                }
            }
        }
    } else {
        // 0x80d46ee
        TmpFileName = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        if (WWW_TraceFlag != 0) {
            // 0x80d4707
            if ((WWW_TraceMask & 8) != 0) {
                int32_t v12 = *(int32_t *)(v8 + 12); // 0x80d471d
                fprintf(TraceFP(), "PassesTest: Deferring test command: %s\n", (char *)v12);
            }
        }
    }
    // 0x80d4803
    HTChunkFree(&((struct _IO_FILE *)v8)->e0);
    LYRemoveTemp(v6);
    int32_t result = *(int32_t *)&TmpFileName; // 0x80d482f
    if (v4 != __readgsdword(20)) {
        // 0x80d4831
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80d4836
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d48a7 - 0x80d49e5
// Line range:    800 - 835
int32_t RememberTestResult(int32_t mode, char * cmd, int32_t result) {
    // 0x80d48a7
    char * v1; // bp-8, 0x80d48a7
    switch (mode) {
        case 1: {
            // 0x80d4934
            *(int32_t *)&v1 = (int32_t)g304;
            if (g304 == NULL) {
                // 0x80d49e0
                return -1;
            }
            char * str = g304; // 0x80d4967
            int32_t v2 = (int32_t)str;
            while (strcmp(cmd, (char *)*(int32_t *)str) != 0) {
                int32_t v3 = *(int32_t *)(v2 + 8); // 0x80d4964
                str = (char *)v3;
                v1 = str;
                if (v3 == 0) {
                    // 0x80d49e0
                    return -1;
                }
                v2 = (int32_t)str;
            }
            // 0x80d49e0
            return *(int32_t *)(v2 + 4);
        }
        case 2: {
            int32_t * mem = calloc(1, 12); // 0x80d4988
            v1 = (char *)mem;
            if (mem == NULL) {
                // 0x80d4996
                outofmem("./HTInit.c", "RememberTestResult");
                // UNREACHABLE
            }
            // 0x80d49aa
            *(int32_t *)((int32_t)mem + 8) = (int32_t)g304;
            HTSACopy((char **)v1, cmd);
            *(int32_t *)((int32_t)v1 + 4) = result;
            *(int32_t *)&g304 = (int32_t)v1;
            // 0x80d49e0
            return 0;
        }
        case 0: {
            // 0x80d4926
            if (g304 == NULL) {
                // 0x80d49e0
                return 0;
            }
            int32_t v4 = *(int32_t *)((int32_t)g304 + 8); // 0x80d48d3
            char * v5 = (char *)v4; // 0x80d48d6
            v1 = v5;
            int32_t v6 = *(int32_t *)g304; // 0x80d48de
            int32_t v7 = (int32_t)g304; // 0x80d48e2
            if (v6 != 0) {
                // 0x80d48e4
                free((int32_t *)v6);
                *(int32_t *)g304 = 0;
                v7 = (int32_t)g304;
            }
            // 0x80d48fe
            if (g304 != NULL) {
                // 0x80d4907
                free((int32_t *)v7);
                g304 = NULL;
            }
            // 0x80d491e
            *(int32_t *)&g304 = v4;
            while (v4 != 0) {
                char * v8 = v5;
                int32_t v9 = v4;
                v4 = *(int32_t *)((int32_t)v8 + 8);
                v5 = (char *)v4;
                v1 = v5;
                v6 = *(int32_t *)v8;
                v7 = v9;
                char * v10 = v8; // 0x80d48e2
                if (v6 != 0) {
                    // 0x80d48e4
                    free((int32_t *)v6);
                    *(int32_t *)g304 = 0;
                    v10 = g304;
                    v7 = (int32_t)v10;
                }
                // 0x80d48fe
                if (v10 != NULL) {
                    // 0x80d4907
                    free((int32_t *)v7);
                    g304 = NULL;
                }
                // 0x80d491e
                *(int32_t *)&g304 = v4;
            }
            // 0x80d49e0
            return 0;
        }
    }
    // 0x80d49e0
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d49e5 - 0x80d4e63
// Line range:    841 - 917
int32_t PassesTest(int32_t * mc) {
    int32_t * str2 = (int32_t *)((int32_t)mc + 8); // 0x80d49ee
    int32_t str = *str2; // 0x80d49ee
    if (str == 0) {
        // 0x80d4e5e
        return 1;
    }
    // 0x80d4a01
    int32_t result; // 0x80d49e5
    if (strcmp((char *)str, "test \"$DISPLAY\"") != 0) {
        // 0x80d4a1b
        if (strcmp((char *)*str2, "test \"$DISPLAY\" != \"\"") != 0) {
            // 0x80d4a35
            if (strcmp((char *)*str2, "test -n \"$DISPLAY\"") != 0) {
                int32_t strcmp_rc = strcmp((char *)*str2, "test -z \"$DISPLAY\""); // 0x80d4b31
                int32_t str3 = *str2;
                if (strcmp_rc == 0) {
                    if (str3 != 0) {
                        // 0x80d4b48
                        free(&((struct _IO_FILE *)str3)->e0);
                        *str2 = 0;
                    }
                    // 0x80d4b60
                    if (WWW_TraceFlag != 0) {
                        // 0x80d4b6b
                        if ((WWW_TraceMask & 8) != 0) {
                            // 0x80d4b77
                            fprintf(TraceFP(), "PassesTest: Testing for NON_XWINDOWS environment.\n");
                        }
                    }
                    // 0x80d4b8e
                    if (LYgetXDisplay() != NULL) {
                        // 0x80d4bd1
                        if (WWW_TraceFlag == 0) {
                            // 0x80d4e5e
                            return 0;
                        }
                        // 0x80d4bdc
                        result = 0;
                        if ((WWW_TraceMask & 8) != 0) {
                            // 0x80d4be8
                            fprintf(TraceFP(), "PassesTest: Test failed!\n");
                            result = 0;
                        }
                    } else {
                        // 0x80d4b97
                        if (WWW_TraceFlag == 0) {
                            // 0x80d4e5e
                            return 1;
                        }
                        // 0x80d4ba2
                        result = 1;
                        if ((WWW_TraceMask & 8) != 0) {
                            // 0x80d4bae
                            fprintf(TraceFP(), "PassesTest: Test passed!\n");
                            result = 1;
                        }
                    }
                    // 0x80d4e5e
                    return result;
                }
                int32_t strcmp_rc2 = strcmp((char *)str3, "test -n \"$LYNX_VERSION\""); // 0x80d4c1c
                int32_t str4 = *str2;
                if (strcmp_rc2 == 0) {
                    if (str4 != 0) {
                        // 0x80d4c33
                        free(&((struct _IO_FILE *)str4)->e0);
                        *str2 = 0;
                    }
                    // 0x80d4c4b
                    if (WWW_TraceFlag == 0 || (WWW_TraceMask & 8) == 0) {
                        // 0x80d4e5e
                        return 1;
                    }
                    // 0x80d4c79
                    fprintf(TraceFP(), "PassesTest: Testing for LYNX environment.\n");
                    if (WWW_TraceFlag == 0) {
                        // 0x80d4e5e
                        return 1;
                    }
                    // 0x80d4c84
                    if ((WWW_TraceMask & 8) != 0) {
                        // 0x80d4c90
                        fprintf(TraceFP(), "PassesTest: Test passed!\n");
                    }
                    // 0x80d4e5e
                    return 1;
                }
                int32_t strcmp_rc3 = strcmp((char *)str4, "test -z \"$LYNX_VERSION\""); // 0x80d4cc4
                int32_t v1 = *str2;
                if (strcmp_rc3 == 0) {
                    if (v1 != 0) {
                        // 0x80d4cdb
                        free(&((struct _IO_FILE *)v1)->e0);
                        *str2 = 0;
                    }
                    // 0x80d4cf3
                    if (WWW_TraceFlag == 0 || (WWW_TraceMask & 8) == 0) {
                        // 0x80d4e5e
                        return 0;
                    }
                    // 0x80d4d21
                    fprintf(TraceFP(), "PassesTest: Testing for non-LYNX environment.\n");
                    if (WWW_TraceFlag == 0) {
                        // 0x80d4e5e
                        return 0;
                    }
                    // 0x80d4d2c
                    if ((WWW_TraceMask & 8) != 0) {
                        // 0x80d4d38
                        fprintf(TraceFP(), "PassesTest: Test failed!\n");
                    }
                    // 0x80d4e5e
                    return 0;
                }
                int32_t v2 = RememberTestResult(1, (char *)v1, 0); // 0x80d4d74
                int32_t v3 = v2; // 0x80d4d80
                if (v2 == -1) {
                    // 0x80d4d82
                    v3 = LYTestMailcapCommand((char *)*str2, NULL);
                    RememberTestResult(2, (char *)*str2, (int32_t)(v3 != 0));
                }
                // 0x80d4dbf
                if (v3 == 1) {
                    // 0x80d4e5e
                    return v3 > 0xffffffff;
                }
                int32_t v4 = *str2; // 0x80d4dc8
                if (v4 != 0) {
                    // 0x80d4dcf
                    free(&((struct _IO_FILE *)v4)->e0);
                    *str2 = 0;
                }
                if (v3 >= 0) {
                    // 0x80d4e1d
                    if (v3 != 0 || WWW_TraceFlag == 0) {
                        // 0x80d4e5e
                        return v3 > 0xffffffff;
                    }
                    // 0x80d4e2e
                    if ((WWW_TraceMask & 8) != 0) {
                        // 0x80d4e3a
                        fprintf(TraceFP(), "PassesTest: Test passed!\n");
                    }
                } else {
                    // 0x80d4ded
                    if (WWW_TraceFlag == 0) {
                        // 0x80d4e5e
                        return v3 > 0xffffffff;
                    }
                    // 0x80d4df8
                    if ((WWW_TraceMask & 8) != 0) {
                        // 0x80d4e04
                        fprintf(TraceFP(), "PassesTest: Test failed!\n");
                    }
                }
                // 0x80d4e5e
                return v3 > -1;
            }
        }
    }
    int32_t v5 = *str2; // 0x80d4a56
    if (v5 != 0) {
        // 0x80d4a5d
        free(&((struct _IO_FILE *)v5)->e0);
        *str2 = 0;
    }
    // 0x80d4a75
    if (WWW_TraceFlag != 0) {
        // 0x80d4a80
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d4a8c
            fprintf(TraceFP(), "PassesTest: Testing for XWINDOWS environment.\n");
        }
    }
    // 0x80d4aa3
    if (LYgetXDisplay() == NULL) {
        // 0x80d4ae6
        if (WWW_TraceFlag == 0) {
            // 0x80d4e5e
            return 0;
        }
        // 0x80d4af1
        result = 0;
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d4afd
            fprintf(TraceFP(), "PassesTest: Test failed!\n");
            result = 0;
        }
    } else {
        // 0x80d4aac
        if (WWW_TraceFlag == 0) {
            // 0x80d4e5e
            return 1;
        }
        // 0x80d4ab7
        result = 1;
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d4ac3
            fprintf(TraceFP(), "PassesTest: Test passed!\n");
            result = 1;
        }
    }
    // 0x80d4e5e
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d4e63 - 0x80d4f59
// Line range:    920 - 938
int32_t ProcessMailcapFile(char * file, int32_t media) {
    // 0x80d4e63
    if (WWW_TraceFlag != 0) {
        // 0x80d4e74
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d4e80
            fprintf(TraceFP(), "ProcessMailcapFile: Loading file '%s'.\n", file);
        }
    }
    struct _IO_FILE * stream = fopen64(file, "r"); // 0x80d4eac
    if (stream == NULL) {
        // 0x80d4eba
        if (WWW_TraceFlag == 0) {
            // 0x80d4f54
            return 0;
        }
        // 0x80d4ec5
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d4ed1
            fprintf(TraceFP(), "ProcessMailcapFile: Could not open '%s'.\n", file);
        }
        // 0x80d4f54
        return 0;
    }
    // 0x80d4f17
    if (feof(stream) == 0) {
        int32_t v1; // bp-52, 0x80d4e63
        ProcessMailcapEntry(stream, &v1, media);
        while (feof(stream) == 0) {
            // 0x80d4ef8
            ProcessMailcapEntry(stream, &v1, media);
        }
    }
    // 0x80d4f26
    LYCloseInput(stream);
    RememberTestResult(0, NULL, 0);
    // 0x80d4f54
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d4f59 - 0x80d4f96
// Line range:    941 - 946
int32_t ExitWithError(char * txt) {
    if (txt != NULL) {
        // 0x80d4f65
        fprintf(TraceFP(), "Lynx: %s\n", txt);
    }
    // 0x80d4f83
    exit_immediately(1);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d4f96 - 0x80d5034
// Line range:    954 - 974
int32_t HTLoadTypesConfigFile(char * fn, int32_t media) {
    // 0x80d4f96
    if (reverse_mailcap != 0) {
        // 0x80d4fb4
        *(int32_t *)&HTPresentations = 0;
    }
    int32_t result = ProcessMailcapFile(fn, media); // 0x80d4fcb
    if (reverse_mailcap == 0) {
        // 0x80d502f
        return result;
    }
    // 0x80d4fdc
    if (result == 0 || HTPresentations == NULL) {
        // 0x80d5027
        *(int32_t *)&HTPresentations = (int32_t)HTPresentations;
        // 0x80d502f
        return result;
    }
    // 0x80d4feb
    HTList_reverse(HTPresentations);
    HTList_appendList(HTPresentations, HTPresentations);
    if (HTPresentations != NULL) {
        // 0x80d5013
        free(HTPresentations);
    }
    // 0x80d502f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d5034 - 0x80d688f
// Line range:    1018 - 1351
void HTFileInit(void) {
    // 0x80d5034
    if (LYUseBuiltinSuffixes == 0) {
        if (WWW_TraceFlag != 0) {
            // 0x80d6816
            if ((WWW_TraceMask & 8) != 0) {
                // 0x80d6822
                fprintf(TraceFP(), "HTFileInit: Skipping all default (HTInit) extension maps!\n");
            }
        }
    } else {
        if (WWW_TraceFlag != 0) {
            // 0x80d5054
            if ((WWW_TraceMask & 8) != 0) {
                // 0x80d5060
                fprintf(TraceFP(), "HTFileInit: Loading default (HTInit) extension maps.\n");
            }
        }
        // 0x80d5077
        HTSetSuffix5("*", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5("*.*", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5(".csh", "application/x-csh", "8bit", NULL, 0.8);
        HTSetSuffix5(".sh", "application/x-sh", "8bit", NULL, 0.8);
        HTSetSuffix5(".ksh", "application/x-ksh", "8bit", NULL, 0.8);
        HTSetSuffix5(".saveme", "application/x-Binary", "binary", NULL, 1.0);
        HTSetSuffix5(".dump", "application/x-Binary", "binary", NULL, 1.0);
        HTSetSuffix5(".bin", "application/x-Binary", "binary", NULL, 1.0);
        HTSetSuffix5(".arc", "application/x-Compressed", "binary", NULL, 1.0);
        HTSetSuffix5(".alpha-exe", "application/x-Executable", "binary", NULL, 1.0);
        HTSetSuffix5(".alpha_exe", "application/x-Executable", "binary", NULL, 1.0);
        HTSetSuffix5(".AXP-exe", "application/x-Executable", "binary", NULL, 1.0);
        HTSetSuffix5(".AXP_exe", "application/x-Executable", "binary", NULL, 1.0);
        HTSetSuffix5(".VAX-exe", "application/x-Executable", "binary", NULL, 1.0);
        HTSetSuffix5(".VAX_exe", "application/x-Executable", "binary", NULL, 1.0);
        HTSetSuffix5(".exe", "application/octet-stream", "binary", "Executable", 1.0);
        HTSetSuffix5(".Z", "application/x-compress", "binary", "UNIX Compressed", 1.0);
        HTSetSuffix5(".Z", NULL, "compress", "UNIX Compressed", 1.0);
        HTSetSuffix5(".exe.Z", "application/octet-stream", "compress", "Executable", 1.0);
        HTSetSuffix5(".tar_Z", "application/x-tar", "compress", "UNIX Compr. Tar", 1.0);
        HTSetSuffix5(".tar.Z", "application/x-tar", "compress", "UNIX Compr. Tar", 1.0);
        HTSetSuffix5("-gz", "application/x-gzip", "binary", "GNU Compressed", 1.0);
        HTSetSuffix5("_gz", "application/x-gzip", "binary", "GNU Compressed", 1.0);
        HTSetSuffix5(".gz", "application/x-gzip", "binary", "GNU Compressed", 1.0);
        HTSetSuffix5("-gz", NULL, "gzip", "GNU Compressed", 1.0);
        HTSetSuffix5("_gz", NULL, "gzip", "GNU Compressed", 1.0);
        HTSetSuffix5(".gz", NULL, "gzip", "GNU Compressed", 1.0);
        HTSetSuffix5(".tar.gz", "application/x-tar", "gzip", "GNU Compr. Tar", 1.0);
        HTSetSuffix5(".tgz", "application/x-tar", "gzip", "GNU Compr. Tar", 1.0);
        HTSetSuffix5(".wsrc", "application/x-wais-source", "8bit", "WAIS-source", 1.0);
        HTSetSuffix5(".zip", "application/zip", "binary", "Zip File", 1.0);
        HTSetSuffix5(".zz", "application/x-deflate", "binary", NULL, 1.0);
        HTSetSuffix5(".zz", "application/deflate", "binary", NULL, 1.0);
        HTSetSuffix5(".bz2", "application/x-bzip2", "binary", NULL, 1.0);
        HTSetSuffix5(".bz2", "application/bzip2", "binary", NULL, 1.0);
        HTSetSuffix5(".uu", "application/x-uuencoded", "7bit", "UUencoded", 1.0);
        HTSetSuffix5(".hqx", "application/mac-binhex40", "8bit", "Mac BinHex", 1.0);
        HTSetSuffix5(".o", "application/octet-stream", "binary", "Prog. Object", 0.5);
        HTSetSuffix5(".a", "application/octet-stream", "binary", "Prog. Library", 0.5);
        HTSetSuffix5(".so", "application/octet-stream", "binary", "Shared Lib", 0.5);
        HTSetSuffix5(".oda", "application/oda", "binary", "ODA", 1.0);
        HTSetSuffix5(".pdf", "application/pdf", "binary", "PDF", 1.0);
        HTSetSuffix5(".eps", "application/postscript", "8bit", "Postscript", 1.0);
        HTSetSuffix5(".ai", "application/postscript", "8bit", "Postscript", 1.0);
        HTSetSuffix5(".ps", "application/postscript", "8bit", "Postscript", 1.0);
        HTSetSuffix5(".rtf", "application/rtf", "8bit", "RTF", 1.0);
        HTSetSuffix5(".dvi", "application/x-dvi", "8bit", "DVI", 1.0);
        HTSetSuffix5(".hdf", "application/x-hdf", "8bit", "HDF", 1.0);
        HTSetSuffix5(".cdf", "application/x-netcdf", "8bit", NULL, 1.0);
        HTSetSuffix5(".nc", "application/x-netcdf", "8bit", NULL, 1.0);
        HTSetSuffix5(".latex", "application/x-latex", "8bit", "LaTeX", 1.0);
        HTSetSuffix5(".tex", "text/x-tex", "8bit", "TeX", 1.0);
        HTSetSuffix5(".texinfo", "application/x-texinfo", "8bit", "Texinfo", 1.0);
        HTSetSuffix5(".texi", "application/x-texinfo", "8bit", "Texinfo", 1.0);
        HTSetSuffix5(".t", "application/x-troff", "8bit", "Troff", 1.0);
        HTSetSuffix5(".tr", "application/x-troff", "8bit", "Troff", 1.0);
        HTSetSuffix5(".roff", "application/x-troff", "8bit", "Troff", 1.0);
        HTSetSuffix5(".man", "application/x-troff-man", "8bit", "Man Page", 1.0);
        HTSetSuffix5(".me", "application/x-troff-me", "8bit", "Troff me", 1.0);
        HTSetSuffix5(".ms", "application/x-troff-ms", "8bit", "Troff ms", 1.0);
        HTSetSuffix5(".zoo", "application/x-Zoo File", "binary", NULL, 1.0);
        HTSetSuffix5(".bak", NULL, "binary", "Backup", 0.5);
        HTSetSuffix5(".bkp", "application/octet-stream", "binary", "VMS BAK File", 1.0);
        HTSetSuffix5(".bck", "application/octet-stream", "binary", "VMS BAK File", 1.0);
        HTSetSuffix5(".hlb", "application/octet-stream", "binary", "VMS Help Libr.", 1.0);
        HTSetSuffix5(".olb", "application/octet-stream", "binary", "VMS Obj. Libr.", 1.0);
        HTSetSuffix5(".tlb", "application/octet-stream", "binary", "VMS Text Libr.", 1.0);
        HTSetSuffix5(".obj", "application/octet-stream", "binary", "Prog. Object", 1.0);
        HTSetSuffix5(".decw$book", "application/octet-stream", "binary", "DEC BookReader", 1.0);
        HTSetSuffix5(".mem", "text/x-runoff-manual", "8bit", "RUNOFF-MANUAL", 1.0);
        HTSetSuffix5(".vsd", "application/visio", "binary", NULL, 1.0);
        HTSetSuffix5(".lha", "application/x-lha", "binary", "lha File", 1.0);
        HTSetSuffix5(".lzh", "application/x-lzh", "binary", "lzh File", 1.0);
        HTSetSuffix5(".sea", "application/x-sea", "binary", "sea File", 1.0);
        HTSetSuffix5(".sit", "application/x-stuffit", "binary", "StuffIt", 1.0);
        HTSetSuffix5(".dms", "application/x-dms", "binary", "dms File", 1.0);
        HTSetSuffix5(".iff", "application/x-iff", "binary", "iff File", 1.0);
        HTSetSuffix5(".bcpio", "application/x-bcpio", "binary", NULL, 1.0);
        HTSetSuffix5(".cpio", "application/x-cpio", "binary", NULL, 1.0);
        HTSetSuffix5(".shar", "application/x-shar", "8bit", NULL, 1.0);
        HTSetSuffix5(".share", "application/x-share", "8bit", NULL, 1.0);
        HTSetSuffix5(".sv4cpio", "application/x-sv4cpio", "binary", NULL, 1.0);
        HTSetSuffix5(".sv4crc", "application/x-sv4crc", "binary", NULL, 1.0);
        HTSetSuffix5(".tar", "application/x-tar", "binary", "Tar File", 1.0);
        HTSetSuffix5(".ustar", "application/x-ustar", "binary", NULL, 1.0);
        HTSetSuffix5(".snd", "audio/basic", "binary", NULL, 1.0);
        HTSetSuffix5(".au", "audio/basic", "binary", NULL, 1.0);
        HTSetSuffix5(".aifc", "audio/x-aiff", "binary", NULL, 1.0);
        HTSetSuffix5(".aif", "audio/x-aiff", "binary", NULL, 1.0);
        HTSetSuffix5(".aiff", "audio/x-aiff", "binary", NULL, 1.0);
        HTSetSuffix5(".wav", "audio/x-wav", "binary", NULL, 1.0);
        HTSetSuffix5(".midi", "audio/midi", "binary", NULL, 1.0);
        HTSetSuffix5(".mod", "audio/mod", "binary", NULL, 1.0);
        HTSetSuffix5(".gif", "image/gif", "binary", NULL, 1.0);
        HTSetSuffix5(".ief", "image/ief", "binary", NULL, 1.0);
        HTSetSuffix5(".jfif", "image/jpeg", "binary", NULL, 1.0);
        HTSetSuffix5(".jfif-tbnl", "image/jpeg", "binary", NULL, 1.0);
        HTSetSuffix5(".jpe", "image/jpeg", "binary", NULL, 1.0);
        HTSetSuffix5(".jpg", "image/jpeg", "binary", NULL, 1.0);
        HTSetSuffix5(".jpeg", "image/jpeg", "binary", NULL, 1.0);
        HTSetSuffix5(".tif", "image/tiff", "binary", NULL, 1.0);
        HTSetSuffix5(".tiff", "image/tiff", "binary", NULL, 1.0);
        HTSetSuffix5(".ham", "image/ham", "binary", NULL, 1.0);
        HTSetSuffix5(".ras", "image/x-cmu-rast", "binary", NULL, 1.0);
        HTSetSuffix5(".pnm", "image/x-portable-anymap", "binary", NULL, 1.0);
        HTSetSuffix5(".pbm", "image/x-portable-bitmap", "binary", NULL, 1.0);
        HTSetSuffix5(".pgm", "image/x-portable-graymap", "binary", NULL, 1.0);
        HTSetSuffix5(".ppm", "image/x-portable-pixmap", "binary", NULL, 1.0);
        HTSetSuffix5(".png", "image/png", "binary", NULL, 1.0);
        HTSetSuffix5(".rgb", "image/x-rgb", "binary", NULL, 1.0);
        HTSetSuffix5(".xbm", "image/x-xbitmap", "binary", NULL, 1.0);
        HTSetSuffix5(".xpm", "image/x-xpixmap", "binary", NULL, 1.0);
        HTSetSuffix5(".xwd", "image/x-xwindowdump", "binary", NULL, 1.0);
        HTSetSuffix5(".rtx", "text/richtext", "8bit", NULL, 1.0);
        HTSetSuffix5(".tsv", "text/tab-separated-values", "8bit", NULL, 1.0);
        HTSetSuffix5(".etx", "text/x-setext", "8bit", NULL, 1.0);
        HTSetSuffix5(".mpg", "video/mpeg", "binary", NULL, 1.0);
        HTSetSuffix5(".mpe", "video/mpeg", "binary", NULL, 1.0);
        HTSetSuffix5(".mpeg", "video/mpeg", "binary", NULL, 1.0);
        HTSetSuffix5(".mov", "video/quicktime", "binary", NULL, 1.0);
        HTSetSuffix5(".qt", "video/quicktime", "binary", NULL, 1.0);
        HTSetSuffix5(".avi", "video/x-msvideo", "binary", NULL, 1.0);
        HTSetSuffix5(".movie", "video/x-sgi-movie", "binary", NULL, 1.0);
        HTSetSuffix5(".mv", "video/x-sgi-movie", "binary", NULL, 1.0);
        HTSetSuffix5(".mime", "message/rfc822", "8bit", NULL, 1.0);
        HTSetSuffix5(".c", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5(".cc", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5(".c++", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5(".css", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5(".h", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5(".pl", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5(".text", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5(".txt", "text/plain", "8bit", NULL, 1.0);
        HTSetSuffix5(".php", "text/html", "8bit", NULL, 1.0);
        HTSetSuffix5(".php3", "text/html", "8bit", NULL, 1.0);
        HTSetSuffix5(".html3", "text/html", "8bit", NULL, 1.0);
        HTSetSuffix5(".ht3", "text/html", "8bit", NULL, 1.0);
        HTSetSuffix5(".phtml", "text/html", "8bit", NULL, 1.0);
        HTSetSuffix5(".shtml", "text/html", "8bit", NULL, 1.0);
        HTSetSuffix5(".sht", "text/html", "8bit", NULL, 1.0);
        HTSetSuffix5(".htmlx", "text/html", "8bit", NULL, 1.0);
        HTSetSuffix5(".htm", "text/html", "8bit", NULL, 1.0);
        HTSetSuffix5(".html", "text/html", "8bit", NULL, 1.0);
    }
    // 0x80d6839
    if (LYisAbsPath((char *)global_extension_map) != 0) {
        // 0x80d684a
        HTLoadExtensionsConfigFile((char *)global_extension_map);
    }
    char * v1 = LYAbsOrHomePath((char **)&personal_extension_map); // 0x80d685e
    if (IsOurFile(v1) == 0) {
        // 0x80d688d
        return;
    }
    // 0x80d686f
    if (LYCanReadFile((char *)personal_extension_map) != 0) {
        // 0x80d6880
        HTLoadExtensionsConfigFile((char *)personal_extension_map);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d688f - 0x80d696d
// Line range:    1365 - 1389
int32_t HTGetLine(char * s, int32_t n, struct _IO_FILE * f) {
    // 0x80d688f
    if (f == NULL) {
        // 0x80d6968
        return 1;
    }
    struct _IO_FILE * stream = f;
    int32_t v1 = 0; // 0x80d6939
    char v2; // 0x80d688f
    char v3; // 0x80d688f
    int32_t v4; // 0x80d688f
    char * v5; // 0x80d688f
    while (true) {
      lab_0x80d68ae:;
        int32_t c = fgetc(stream); // 0x80d68b4
        char v6 = c; // 0x80d68c8
        v5 = (char *)(v1 + (int32_t)s);
        *v5 = v6;
        v2 = v6;
        v4 = c;
        if (v6 != 13) {
            goto lab_0x80d6913;
        } else {
            int32_t c2 = fgetc(f); // 0x80d68dd
            if (c2 != 10) {
                if (c2 == -1) {
                    // break -> 0x80d693e
                    break;
                }
                // 0x80d6913
                ungetc(c2, f);
                v3 = *v5;
                goto lab_0x80d6919;
            } else {
                char v7 = c2; // 0x80d68f7
                *v5 = v7;
                v2 = v7;
                v4 = c2;
                goto lab_0x80d6913;
            }
        }
    }
  lab_0x80d693e_2:
    // 0x80d693e
    *v5 = 0;
    // 0x80d6968
    return feof(f) != 0;
  lab_0x80d6913:
    // 0x80d6913
    v3 = v2;
    if (v4 == -1) {
        // break -> 0x80d693e
        goto lab_0x80d693e_2;
    }
    goto lab_0x80d6919;
  lab_0x80d6919:
    // 0x80d6919
    switch (v3) {
        case 10: {
            goto lab_0x80d693e_2;
        }
        case 13: {
            goto lab_0x80d693e_2;
        }
        default: {
            // 0x80d6933
            v1++;
            if (v1 == n) {
                // break -> 0x80d693e
                break;
            }
            // 0x80d6933
            stream = f;
            goto lab_0x80d68ae;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d696d - 0x80d6a19
// Line range:    1392 - 1407
void HTGetWord(char * word, char * line, char stop, char stop2) {
    int32_t v1 = (int32_t)line; // 0x80d69a9
    char v2 = *line; // 0x80d69ac
    int32_t v3 = 0; // 0x80d69b1
    int32_t v4 = 0; // 0x80d69b1
    char * v5 = line; // 0x80d69b1
    char * v6 = word; // 0x80d69b1
    if (v2 != stop == (v2 != 0) == (v2 != stop2)) {
        *word = v2;
        v3++;
        char * v7 = (char *)(v3 + v1);
        char v8 = *v7; // 0x80d69ac
        char * v9 = (char *)(v3 + (int32_t)word);
        v4 = v3;
        v5 = v7;
        v6 = v9;
        while (v8 != stop == (v8 != 0) == (v8 != stop2)) {
            // 0x80d698f
            *v9 = v8;
            v3++;
            v7 = (char *)(v3 + v1);
            v8 = *v7;
            v9 = (char *)(v3 + (int32_t)word);
            v4 = v3;
            v5 = v7;
            v6 = v9;
        }
    }
    // 0x80d69cf
    *v6 = 0;
    int32_t v10 = v4 + (int32_t)(*v5 != 0); // 0x80d69e9
    int32_t v11 = 0; // 0x80d69e9
    char v12 = *(char *)(v10 + v1); // 0x80d69fe
    *(char *)(v11 + v1) = v12;
    v10++;
    v11++;
    while (v12 != 0) {
        // 0x80d69f0
        v12 = *(char *)(v10 + v1);
        *(char *)(v11 + v1) = v12;
        v10++;
        v11++;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./HTInit.c
// Address range: 0x80d6a19 - 0x80d6dc4
// Line range:    1410 - 1460
int32_t HTLoadExtensionsConfigFile(char * fn) {
    char v1[256]; // 0x80d6a90
    char word2[256]; // bp-532, 0x80d6a19
    char word[256]; // bp-536, 0x80d6a19
    int32_t v2 = __readgsdword(20); // 0x80d6a2d
    if (WWW_TraceFlag != 0) {
        // 0x80d6a4d
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80d6a59
            fprintf(TraceFP(), "HTLoadExtensionsConfigFile: Loading file '%s'.\n", fn);
        }
    }
    struct _IO_FILE * v3 = fopen64(fn, "r"); // 0x80d6a8b
    v1[0] = (int32_t)v3;
    word = v1;
    int32_t v4 = *(int32_t *)&word; // 0x80d6a96
    char * v5; // 0x80d6a19
    char * v6; // 0x80d6a19
    char * v7; // 0x80d6a19
    int32_t * f; // bp-544, 0x80d6a19
    int32_t v8; // bp-272, 0x80d6a19
    char * v9; // 0x80d6a19
    if (v4 != 0) {
        struct _IO_FILE * v10 = (struct _IO_FILE *)v4;
        int32_t v11 = HTGetLine((char *)&v8, 256, v10); // 0x80d6d7c
        char * v12 = NULL; // 0x80d6d83
        if (v11 == 0) {
            char * v13 = NULL;
            while (true) {
                char * v14 = v13;
                int32_t v15; // bp-528, 0x80d6a19
                while (true) {
                    // 0x80d6aec
                    HTGetWord((char *)&v15, (char *)&v8, 32, 9);
                    if ((char)v8 != 0) {
                        // 0x80d6b23
                        if ((char)v15 != 35) {
                            // break -> 0x80d6b32
                            break;
                        }
                    }
                    int32_t v16 = HTGetLine((char *)&v8, 256, v10); // 0x80d6d7c
                    v12 = v14;
                    if (v16 != 0) {
                        // break (via goto) -> 0x80d6d89
                        goto lab_0x80d6d89;
                    }
                }
                // 0x80d6b32
                word2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                HTSACopy((char **)&word2, (char *)&v15);
                LYLowerCase((char *)*(int32_t *)&word2);
                v5 = v14;
                v7 = v14;
                if ((char)v8 != 0) {
                    while (true) {
                      lab_0x80d6b67_2:
                        // 0x80d6b67
                        v6 = v5;
                        while (true) {
                          lab_0x80d6b67:
                            // 0x80d6b67
                            HTGetWord((char *)&v15, (char *)&v8, 32, 9);
                            int32_t v17; // 0x80d6b8f
                            switch ((char)v17) {
                                case 0: {
                                    goto lab_0x80d6d30;
                                }
                                case 32: {
                                    goto lab_0x80d6d30;
                                }
                                default: {
                                    goto lab_0x80d6bad;
                                }
                            }
                        }
                      lab_0x80d6bad:
                        // 0x80d6bad
                        f = NULL;
                        HTSprintf0((char **)&f, ".%s", &v15);
                        LYLowerCase((char *)f);
                        if (WWW_TraceFlag != 0) {
                            // 0x80d6bf0
                            if ((WWW_TraceMask & 8) != 0) {
                                // 0x80d6bfc
                                fprintf(TraceFP(), "setting suffix '%s' to '%s'.\n", f, (char *)*(int32_t *)&word2);
                            }
                        }
                        // 0x80d6c27
                        if (strstr((char *)*(int32_t *)&word2, "tex") != NULL) {
                            goto lab_0x80d6ca9;
                        } else {
                            // 0x80d6c41
                            if (strstr((char *)*(int32_t *)&word2, "postscript") != NULL) {
                                goto lab_0x80d6ca9;
                            } else {
                                // 0x80d6c5b
                                if (strstr((char *)*(int32_t *)&word2, "sh") != NULL) {
                                    goto lab_0x80d6ca9;
                                } else {
                                    // 0x80d6c75
                                    if (strstr((char *)*(int32_t *)&word2, "troff") != NULL) {
                                        goto lab_0x80d6ca9;
                                    } else {
                                        // 0x80d6c8f
                                        if (strstr((char *)*(int32_t *)&word2, "rtf") == NULL) {
                                            int32_t v18 = *(int32_t *)&word2; // 0x80d6cd9
                                            HTSetSuffix5((char *)f, (char *)v18, "binary", NULL, 1.0);
                                            goto lab_0x80d6d07;
                                        } else {
                                            goto lab_0x80d6ca9;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
              lab_0x80d6d3f_2:
                // 0x80d6d3f
                v13 = v7;
                int32_t v19 = *(int32_t *)&word2; // 0x80d6d3f
                if (v19 != 0) {
                    // 0x80d6d49
                    free((int32_t *)v19);
                    word2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                }
                int32_t v20 = HTGetLine((char *)&v8, 256, v10); // 0x80d6d7c
                v12 = v13;
                if (v20 != 0) {
                    // break -> 0x80d6d89
                    break;
                }
            }
        }
      lab_0x80d6d89:
        // 0x80d6d89
        LYCloseInput(v10);
        v9 = v12;
    } else {
        // 0x80d6aa3
        v9 = NULL;
        if (WWW_TraceFlag != 0) {
            // 0x80d6aae
            v9 = NULL;
            if ((WWW_TraceMask & 8) != 0) {
                // 0x80d6aba
                fprintf(TraceFP(), "HTLoadExtensionsConfigFile: Could not open '%s'.\n", fn);
                v9 = NULL;
            }
        }
    }
    int32_t result = (int32_t)v9; // 0x80d6db3
    if (v2 != __readgsdword(20)) {
        // 0x80d6db5
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80d6dba
    return result;
  lab_0x80d6d30:
    // 0x80d6d30
    v7 = v6;
    if ((char)v8 == 0) {
        // break (via goto) -> 0x80d6d3f
        goto lab_0x80d6d3f_2;
    }
    goto lab_0x80d6b67;
  lab_0x80d6ca9:
    // 0x80d6ca9
    HTSetSuffix5((char *)f, (char *)*(int32_t *)&word2, "8bit", NULL, 1.0);
    goto lab_0x80d6d07;
  lab_0x80d6d07:;
    int32_t * v21 = f; // 0x80d6d0e
    if (v21 != NULL) {
        // 0x80d6d18
        free(v21);
        f = NULL;
    }
    char * v22 = (char *)((int32_t)v6 + 1);
    v5 = v22;
    v7 = v22;
    if ((char)v8 == 0) {
        // break -> 0x80d6d3f
        goto lab_0x80d6d3f_2;
    }
    goto lab_0x80d6b67_2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUpload.c
// Address range: 0x80d6f54 - 0x80d7456
// Line range:    41 - 165
int32_t LYUpload(char * line) {
    char tmpbuf2[256]; // bp-272, 0x80d6f54
    char tmpbuf[256]; // bp-276, 0x80d6f54
    char v1[256]; // 0x80d6fff
    char v2[256]; // 0x80d6fb0
    char v3[256]; // 0x80d6fcf
    char v4[256]; // 0x80d6fec
    int32_t v5 = __readgsdword(20); // 0x80d6f67
    int32_t method_number = 0; // bp-288, 0x80d6f72
    int32_t count = 0; // bp-292, 0x80d6f7c
    char * filename = NULL; // bp-300, 0x80d6f90
    char * substr_pos = strstr(line, "TO="); // 0x80d6fab
    v2[0] = (int32_t)substr_pos;
    tmpbuf = v2;
    int32_t v6 = *(int32_t *)&tmpbuf; // 0x80d6fb6
    char * v7; // 0x80d6f54
    if (v6 == 0) {
        goto lab_0x80d73f8;
    } else {
        // 0x80d6fc3
        *(char *)(v6 - 1) = 0;
        v3[0] = (char)*(int32_t *)&tmpbuf + 3;
        tmpbuf = v3;
        char * substr_pos2 = strstr(line, "UPLOAD="); // 0x80d6fe7
        v4[0] = (int32_t)substr_pos2;
        tmpbuf2 = v4;
        int32_t v8 = *(int32_t *)&tmpbuf2; // 0x80d6ff2
        if (v8 == 0) {
            goto lab_0x80d73f8;
        } else {
            // 0x80d6fff
            v1[0] = (char)v8 + 7;
            tmpbuf2 = v1;
            int32_t str_as_i = atoi((char *)*(int32_t *)&tmpbuf2); // 0x80d700f
            char * v9 = (char *)uploaders; // 0x80d7052
            if (str_as_i > 0) {
                char * v10 = (char *)((int32_t)NULL + 1); // 0x80d7031
                char * v11 = (char *)*(int32_t *)(char *)uploaders;
                char * v12 = v11; // 0x80d7052
                char * v13 = v10; // 0x80d7052
                v9 = v11;
                while (v10 < (char *)str_as_i) {
                    // 0x80d7031
                    v10 = (char *)((int32_t)v13 + 1);
                    v11 = (char *)*(int32_t *)v12;
                    v12 = v11;
                    v13 = v10;
                    v9 = v11;
                }
            }
            int32_t * v14 = (int32_t *)((int32_t)v9 + 8); // 0x80d705a
            int32_t v15 = *v14; // 0x80d705a
            if (v15 != 0) {
                // 0x80d707a
                if (HTCountCommandArgs((char *)v15) == 0) {
                    // 0x80d72a9
                    HTSACopy((char **)&method_number, (char *)*v14);
                    v7 = (char *)*(int32_t *)&tmpbuf;
                    goto lab_0x80d72c4;
                } else {
                    // 0x80d7093
                    mustshow = 1;
                    statusline(gettext("Enter a filename: "));
                    char str = 0; // bp-268, 0x80d70ae
                    if (LYgetstr(&str, 0, 256, 0) >= 0 && str != 0) {
                        while (strstr(&str, "../") == NULL) {
                            // 0x80d7125
                            if (strchr(&str, 47) != NULL) {
                                // 0x80d713f
                                HTAlert(gettext("Illegal character \"/\" found! Request ignored."));
                                goto lab_0x80d7418_2;
                            }
                            // 0x80d7158
                            if (str == 126) {
                                // 0x80d7163
                                HTAlert(gettext("Illegal redirection using \"~\" found! Request ignored."));
                                goto lab_0x80d7418_2;
                            }
                            char * v16 = (char *)*(int32_t *)&tmpbuf;
                            HTSprintf0((char **)&count, "%s/%s", v16, &str);
                            char * v17 = (char *)count; // 0x80d71ac
                            if (*v17 != 124) {
                                int32_t v18 = LYValidateOutput(v17); // 0x80d71f0
                                if (v18 != 78) {
                                    if (v18 != 89) {
                                        goto lab_0x80d7418_2;
                                    }
                                    // 0x80d7215
                                    if (WWW_TraceFlag != 0) {
                                        // 0x80d7220
                                        fprintf(TraceFP(), "LYUpload: filename is %s", (char *)count);
                                    }
                                    // 0x80d7241
                                    if (LYCanWriteFile((char *)count) != 0) {
                                        int32_t v19 = *v14; // 0x80d7263
                                        HTAddParam((char **)&method_number, (char *)v19, 1, (char *)count);
                                        HTEndParam((char **)&method_number, (char *)*v14, 1);
                                        v7 = v16;
                                        goto lab_0x80d72c4;
                                    }
                                }
                            } else {
                                // 0x80d71b3
                                HTAlert(gettext("Cannot write to file."));
                                mustshow = 1;
                                statusline(gettext("Enter a new filename: "));
                            }
                            // 0x80d70ae
                            str = 0;
                            if (LYgetstr(&str, 0, 256, 0) < 0 || str == 0) {
                                goto lab_0x80d7418_2;
                            }
                        }
                        // 0x80d710c
                        HTAlert(gettext("Illegal redirection \"../\" found! Request ignored."));
                    }
                    goto lab_0x80d7418_2;
                }
            } else {
                // 0x80d7061
                HTAlert(gettext("ERROR! - upload command is misconfigured"));
                goto lab_0x80d73f8;
            }
        }
    }
  lab_0x80d7418_2:
    // 0x80d7418
    HTInfoMsg(gettext("Cancelling!"));
    int32_t v20 = 0; // 0x80d742c
    goto lab_0x80d7436;
  lab_0x80d73f8:
    // 0x80d73f8
    HTAlert(gettext("Unable to upload file."));
    v20 = 0;
    goto lab_0x80d7436;
  lab_0x80d7436:;
    int32_t result = v20; // 0x80d7446
    if (v5 != __readgsdword(20)) {
        // 0x80d7448
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80d744d
    return result;
  lab_0x80d72c4:
    // 0x80d72c4
    HTAddParam(&filename, "cd %s ; ", 1, v7);
    HTEndParam(&filename, "cd %s ; ", 1);
    HTSACat(&filename, (char *)method_number);
    if (WWW_TraceFlag != 0) {
        // 0x80d732d
        fprintf(TraceFP(), "command: %s\n", filename);
    }
    // 0x80d734e
    stop_curses();
    LYSystem(filename);
    start_curses();
    if (filename != NULL) {
        // 0x80d7370
        free((int32_t *)filename);
        filename = NULL;
    }
    // 0x80d7388
    if (method_number != 0) {
        // 0x80d7392
        free((int32_t *)method_number);
        method_number = 0;
    }
    // 0x80d73aa
    v20 = 1;
    if (count != 0) {
        // 0x80d73ca
        chmod((char *)count, 384);
        v20 = 1;
        if (count != 0) {
            // 0x80d73d4
            free((int32_t *)count);
            count = 0;
            v20 = 1;
        }
    }
    goto lab_0x80d7436;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYUpload.c
// Address range: 0x80d7456 - 0x80d76b9
// Line range:    175 - 225
int32_t LYUpload_options(char ** newfile, char * directory) {
    struct _IO_FILE * stream = InternalPageFP((char *)&g306, 1); // 0x80d746b
    if (stream == NULL) {
        // 0x80d76b4
        return -1;
    }
    char * str = HTnameOfFile_WWW(directory, 0, 1); // 0x80d749b
    strcpy((char *)&g305, str);
    LYTrimPathSep((char *)&g305);
    if (str != NULL) {
        // 0x80d74c8
        free((int32_t *)str);
    }
    // 0x80d74da
    LYLocalFileToURL(newfile, (char *)&g306);
    LYRegisterUIPage(*newfile, 10);
    BeginInternalPage(stream, gettext("Upload Options"), "Lynx_users_guide.html.gz#DirEd");
    fwrite((int32_t *)"<pre>\n", 1, 6, stream);
    fprintf(stream, "   <em>%s</em> %s\n", gettext("Upload To:"), (char *)&g305);
    fprintf(stream, "\n%s\n", gettext("Upload options:"));
    if (uploaders == NULL) {
        // 0x80d764a
        fwrite((int32_t *)"   &lt;NONE&gt;\n", 1, 16, stream);
    } else {
        int32_t v1 = (int32_t)NULL; // 0x80d75bf
        fprintf(stream, "   <a href=\"LYNXDIRED://UPLOAD=%d/TO=%s\">", v1, (char *)&g305);
        int32_t v2 = *(int32_t *)((int32_t)uploaders + 4); // 0x80d75dc
        int32_t str2 = v2; // 0x80d75e1
        if (v2 == 0) {
            // 0x80d75ee
            str2 = (int32_t)gettext("No Name Given");
        }
        // 0x80d75fd
        fputs((char *)str2, stream);
        fwrite((int32_t *)"</a>\n", 1, 5, stream);
        int32_t v3 = *uploaders; // 0x80d7635
        int32_t * v4 = (int32_t *)v3; // 0x80d7642
        int32_t * v5 = (int32_t *)(v1 + 1); // 0x80d7642
        while (v3 != 0) {
            // 0x80d75b7
            v1 = (int32_t)v5;
            fprintf(stream, "   <a href=\"LYNXDIRED://UPLOAD=%d/TO=%s\">", v1, (char *)&g305);
            v2 = *(int32_t *)((int32_t)v4 + 4);
            str2 = v2;
            if (v2 == 0) {
                // 0x80d75ee
                str2 = (int32_t)gettext("No Name Given");
            }
            // 0x80d75fd
            fputs((char *)str2, stream);
            fwrite((int32_t *)"</a>\n", 1, 5, stream);
            v3 = *v4;
            v4 = (int32_t *)v3;
            v5 = (int32_t *)(v1 + 1);
        }
    }
    // 0x80d766d
    fwrite((int32_t *)"</pre>\n", 1, 7, stream);
    EndInternalPage(stream);
    LYCloseTempFP(stream);
    LYforce_no_cache = 1;
    // 0x80d76b4
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYexit.c
// Address range: 0x80d7728 - 0x80d7756
// Line range:    67 - 75
void LYCompleteExit(void) {
    for (int32_t i = topOfStack; i >= 0; i--) {
        // continue -> 0x80d773e
    }
    // 0x80d7754
    topOfStack = i;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYexit.c
// Address range: 0x80d7756 - 0x80d7899
// Line range:    87 - 179
void LYexit(int32_t status) {
    // 0x80d7756
    if (LYOutOfMemory == 1) {
        // 0x80d776b
        signal(SIGHUP, SIG_IGN);
        signal(SIGTERM, SIG_IGN);
        signal(SIGINT, SIG_IGN);
        signal(SIGSEGV, SIG_IGN);
        signal(SIGILL, SIG_IGN);
        fflush((struct _IO_FILE *)g160);
        fflush((struct _IO_FILE *)g164);
        if (LYCursesON != 0) {
            // 0x80d77f4
            LYSleepAlert();
        }
        // 0x80d77f9
        cleanup_sig(0);
        signal(SIGSEGV, SIG_DFL);
        signal(SIGILL, SIG_DFL);
    }
    // 0x80d782d
    LYCloselog();
    LYCompleteExit();
    LYCloseCmdLogfile();
    cleanup_files();
    fflush((struct _IO_FILE *)g160);
    if (LYOutOfMemory == 1) {
        // 0x80d7859
        LYOutOfMemory = 0;
        printf("\r\n%s\r\n\r\n", gettext("Memory exhausted!  Program aborted!"));
        fflush((struct _IO_FILE *)g164);
    }
    // 0x80d7889
    LYCloseTracelog();
    exit(status);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYexit.c
// Address range: 0x80d7899 - 0x80d78e8
// Line range:    184 - 188
void outofmem(char * fname, char * func) {
    // 0x80d7899
    fprintf((struct _IO_FILE *)g160, "\n\n\n%s %s: %s\n", fname, func, gettext("Memory exhausted!  Aborting..."));
    LYOutOfMemory = 1;
    LYexit(-1);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYJump.c
// Address range: 0x80d7a04 - 0x80d7ad5
// Line range:    56 - 76
void LYAddJumpShortcut(int32_t * historyp, char * shortcut) {
    char * str2 = NULL; // bp-8, 0x80d7a0a
    if (historyp == NULL || shortcut == NULL || *shortcut == 0) {
        // 0x80d7ad3
        return;
    }
    // 0x80d7a39
    HTSACopy(&str2, shortcut);
    char * v1 = (char *)historyp; // 0x80d7a4b
    while (v1 != NULL) {
        int32_t v2 = *(int32_t *)((int32_t)v1 + 4); // 0x80d7a98
        if (v2 == 0) {
            // break -> 0x80d7ac1
            break;
        }
        int32_t v3 = *(int32_t *)v2; // 0x80d7aa7
        if (v3 == 0) {
            // break -> 0x80d7ac1
            break;
        }
        char * str = (char *)v3;
        v1 = (char *)v2;
        if (strcmp(str, str2) == 0) {
            // 0x80d7a7b
            HTList_removeObject(historyp, str);
            free((int32_t *)v3);
            goto lab_0x80d7ac1;
        }
    }
  lab_0x80d7ac1:
    // 0x80d7ac1
    HTList_addObject(historyp, str2);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYJump.c
// Address range: 0x80d7ded - 0x80d8478
// Line range:    178 - 359
char * LYJump(uint32_t key) {
    // 0x80d7ded
    if (JThead == NULL) {
        // 0x80d8473
        return NULL;
    }
    int32_t v1 = *JThead; // 0x80d7e28
    char * v2 = (char *)JThead; // 0x80d7e2c
    int32_t v3 = (int32_t)JThead; // 0x80d7e2c
    if (v1 != 0 == (v1 != key)) {
        int32_t v4 = *(int32_t *)((int32_t)(char *)JThead + 28); // 0x80d7e19
        while (v4 != 0) {
            char * v5 = (char *)v4; // 0x80d7e1c
            int32_t v6 = *(int32_t *)v4; // 0x80d7e28
            v2 = v5;
            v3 = v4;
            if (v6 != 0 != v6 != key) {
                goto lab_0x80d7e38;
            }
            v4 = *(int32_t *)((int32_t)v5 + 28);
        }
    } else {
        goto lab_0x80d7e38;
    }
  lab_0x80d7e38:;
    // 0x80d7e38
    int32_t * base; // 0x80d7ded
    int32_t * nmemb; // 0x80d7ded
    int32_t v7; // 0x80d7ded
    if (v2 != NULL) {
        // 0x80d7e99
        v7 = (int32_t)v2;
        base = (int32_t *)(v7 + 24);
        if (*base == 0) {
            int32_t v8 = v3;
            *(int32_t *)(v8 + 4) = LYRead_Jumpfile((int32_t *)v8);
        }
        // 0x80d7eb6
        nmemb = (int32_t *)(v7 + 4);
        if (*nmemb == 0) {
            // 0x80d8473
            return NULL;
        }
        // 0x80d7ecc
        if (jump_buffer == 0) {
            // 0x80d7eee
            *(char *)&g307 = 0;
            goto lab_0x80d7f43;
        } else {
            int32_t * str2 = (int32_t *)(v7 + 16);
            int32_t v9 = *str2; // 0x80d7eda
            if (v9 == 0) {
                // 0x80d7eee
                *(char *)&g307 = 0;
                goto lab_0x80d7f43;
            } else {
                char * str = (char *)v9; // 0x80d7ee7
                if (*str != 0) {
                    // 0x80d7f0e
                    if (strlen(str) >= 120) {
                        // 0x80d7f21
                        *(char *)(*str2 + 119) = 0;
                    }
                    // 0x80d7f2d
                    strcpy((char *)&g307, (char *)*str2);
                    goto lab_0x80d7f43;
                } else {
                    // 0x80d7eee
                    *(char *)&g307 = 0;
                    goto lab_0x80d7f43;
                }
            }
        }
    } else {
        goto lab_0x80d7e3e;
    }
  lab_0x80d83cf_3:;
    // 0x80d83cf
    char * v10; // 0x80d8086
    int32_t key2 = (int32_t)v10; // bp-52, 0x80d83d2
    int32_t * found_elem = bsearch(&key2, (int32_t *)*base, *nmemb, 8, (int32_t (*)(int32_t *, int32_t *))0x80d88e6); // 0x80d8401
    if (found_elem != NULL) {
        goto lab_0x80d8428;
    } else {
        // 0x80d840f
        user_message("Unknown target '%s'", (char *)&g307);
        LYSleepAlert();
        goto lab_0x80d8428;
    }
  lab_0x80d81c4:;
    // 0x80d81c4
    char * v11; // 0x80d7ded
    char * v12 = v11;
    char * v13 = v12; // 0x80d81cd
    char v14; // 0x80d7ded
    char * v15; // 0x80d7ded
    int32_t v16; // 0x80d7ded
    if (v16 == 1 == v14 == 0) {
        goto lab_0x80d81d5;
    } else {
        // 0x80d81f2
        mustshow = 1;
        statusline(gettext("Edit a previous shortcut: "));
        v15 = v12;
        goto lab_0x80d820d;
    }
  lab_0x80d8336:;
    // 0x80d8336
    char * v17; // 0x80d7ded
    char * v18 = v17;
    char * v19 = v18; // 0x80d833f
    char * v20; // 0x80d7ded
    char v21; // 0x80d7ded
    if (v16 == 1 == v21 == 0) {
        goto lab_0x80d8347;
    } else {
        // 0x80d8364
        mustshow = 1;
        statusline(gettext("Edit a previous shortcut: "));
        v20 = v18;
        goto lab_0x80d837f;
    }
  lab_0x80d81d5:
    // 0x80d81d5
    mustshow = 1;
    statusline(gettext("Edit the previous shortcut: "));
    v15 = v13;
    goto lab_0x80d820d;
  lab_0x80d81b3:
    // 0x80d81b3
    v11 = v2;
    char v51; // 0x80d7ded
    v14 = v51;
    v13 = v2;
    if (v16 == 2 == (v51 != 0)) {
        goto lab_0x80d81d5;
    } else {
        goto lab_0x80d81c4;
    }
  lab_0x80d8347:
    // 0x80d8347
    mustshow = 1;
    statusline(gettext("Edit the previous shortcut: "));
    v20 = v19;
    goto lab_0x80d837f;
  lab_0x80d8325:;
    // 0x80d8325
    char * v40; // 0x80d82e4
    v17 = v40;
    char v56; // 0x80d7ded
    v21 = v56;
    v19 = v40;
    if (v16 == 2 == (v56 != 0)) {
        goto lab_0x80d8347;
    } else {
        goto lab_0x80d8336;
    }
  lab_0x80d820d:;
    // 0x80d820d
    int32_t v22; // 0x80d7ded
    int32_t v23 = LYgetstr((char *)&g307, 0, 124, v22); // 0x80d822b
    char * v24 = v15; // 0x80d8237
    char * v25 = v15; // 0x80d8237
    char * v26 = v15; // 0x80d8237
    int32_t v27; // 0x80d7ded
    int32_t v28 = v27; // 0x80d8237
    int32_t v29 = v23; // 0x80d8237
    char * result; // 0x80d7ded
    if (v23 < 0) {
        // 0x80d823d
        HTInfoMsg(gettext("Cancelled!!!"));
        result = NULL;
        goto lab_0x80d8473;
    }
    goto lab_0x80d800e;
  lab_0x80d837f:;
    int32_t v66 = LYgetstr((char *)&g307, 0, 124, v22); // 0x80d839d
    char * v41; // 0x80d812a
    v24 = v41;
    v25 = v40;
    v26 = v20;
    int32_t v53; // 0x80d7ded
    v28 = v53;
    v29 = v66;
    if (v66 < 0) {
        // 0x80d83af
        HTInfoMsg(gettext("Cancelled!!!"));
        result = NULL;
        goto lab_0x80d8473;
    }
    goto lab_0x80d800e;
  lab_0x80d800e:;
    char * v30 = v24; // 0x80d7ded
    char * v31 = v25; // 0x80d7ded
    char * v32 = v26; // 0x80d7ded
    char v33 = 0; // 0x80d7ded
    int32_t v34 = v28; // 0x80d7ded
    int32_t v35 = v29; // 0x80d7ded
    goto lab_0x80d800e_2;
  lab_0x80d7e3e:;
    int32_t ShortcutTotal = 0; // bp-44, 0x80d7e3e
    char * v57 = gettext("Key '%c' is not mapped to a jump file!"); // 0x80d7e4c
    HTSprintf0((char **)&ShortcutTotal, v57);
    HTAlert((char *)ShortcutTotal);
    if (ShortcutTotal != 0) {
        // 0x80d7e7b
        free((int32_t *)ShortcutTotal);
        ShortcutTotal = 0;
    }
    // 0x80d8473
    return NULL;
  lab_0x80d7f43:;
    int32_t * v58 = (int32_t *)(v7 + 20);
    int32_t v59 = *v58; // 0x80d7f46
    int32_t v60 = 0; // 0x80d7f4b
    if (v59 != 0) {
        // 0x80d7f4d
        v60 = HTList_count((int32_t *)v59);
    }
    // 0x80d7f67
    v16 = v60;
    bool v45; // 0x80d7ded
    char v61; // 0x80d7ded
    int32_t v62; // 0x80d7ded
    if (jump_buffer == 0 | *(char *)&g307 == 0) {
        // 0x80d7f9d
        v45 = v16 >= 0 == (v16 != 0);
        v62 = v16;
        v61 = 1;
    } else {
        int32_t v63 = v16 - 1; // 0x80d7f83
        v45 = v63 < 0 == (v16 & -v16) < 0 == (v63 != 0);
        v62 = 0;
        v61 = 0;
    }
    // 0x80d7fb4
    v22 = v45;
    statusline((char *)*(int32_t *)(v7 + 8));
    int32_t v64 = LYgetstr((char *)&g307, 0, 120, v22); // 0x80d7fe0
    if (v64 < 0) {
        // 0x80d7fee
        HTInfoMsg(gettext("Cancelled!!!"));
        // 0x80d8473
        return NULL;
    }
    int32_t v65 = v7 + 16;
    int32_t * v50 = (int32_t *)v65;
    v30 = v2;
    v31 = v2;
    v32 = v2;
    v33 = v61;
    v34 = v62;
    v35 = v64;
    char * v39; // 0x80d829c
    while (true) {
      lab_0x80d800e_2:;
        int32_t v36 = v35;
        int32_t v37 = v34;
        char v38 = v33;
        v39 = v32;
        v40 = v31;
        v41 = v30;
        int16_t v42 = *(int16_t *)((2 * key & 510) + (int32_t)*__ctype_b_loc()); // 0x80d8027
        bool v43 = (char)key == 71; // 0x80d8034
        if ((v42 & 512) != 0) {
            // 0x80d8036
            v43 = toupper(key % 256) == 71;
        }
        char * v44 = (char *)&g307; // 0x80d805a
        if (v43) {
            int32_t strncmp_rc = strncmp((char *)&g307, "o ", 2); // 0x80d8073
            v44 = strncmp_rc != 0 ? (char *)&g307 : (char *)&g308;
        }
        // 0x80d8080
        v10 = LYSkipBlanks(v44);
        if (*v10 == 0) {
            if (v45 != ((v36 & -2) == 256)) {
                // break -> 0x80d80b0
                break;
            }
        }
        char * v46 = (char *)v36;
        if (v45 == v46 == (char *)256) {
            int32_t v47 = v38 == 0 ? v37 + 1 : 0;
            v27 = v47 < v16 ? v47 : 0;
            int32_t v48 = *(int32_t *)((int32_t)v41 + 20); // 0x80d812d
            char * v49 = HTList_objectAt((int32_t *)v48, v27); // 0x80d813a
            if (v49 == NULL) {
                goto lab_0x80d83cf_3;
            }
            // 0x80d814c
            LYstrncpy((char *)&g307, v49, 123);
            v11 = v41;
            v14 = 0;
            if (jump_buffer == 0) {
                goto lab_0x80d81c4;
            } else {
                int32_t str3 = *v50; // 0x80d8175
                v51 = jump_buffer;
                if (str3 == 0) {
                    goto lab_0x80d81b3;
                } else {
                    // 0x80d817c
                    if (strcmp((char *)&g307, (char *)str3) != 0) {
                        // 0x80d817c
                        v51 = jump_buffer;
                        goto lab_0x80d81b3;
                    } else {
                        // 0x80d8196
                        mustshow = 1;
                        statusline(gettext("Edit the current shortcut: "));
                        v15 = v2;
                        goto lab_0x80d820d;
                    }
                }
            }
        } else {
            if (v45 != (v46 == (char *)257)) {
                goto lab_0x80d83cf_3;
            }
            int32_t v52 = (v38 == 0 ? v37 : v16) - 1;
            v53 = v52 >= 0 ? v52 : v16 - 1;
            int32_t v54 = *(int32_t *)((int32_t)v39 + 20); // 0x80d829f
            char * v55 = HTList_objectAt((int32_t *)v54, v53); // 0x80d82ac
            if (v55 == NULL) {
                goto lab_0x80d83cf_3;
            }
            // 0x80d82be
            LYstrncpy((char *)&g307, v55, 123);
            v17 = v39;
            v21 = 0;
            if (jump_buffer == 0) {
                goto lab_0x80d8336;
            } else {
                int32_t str4 = *(int32_t *)((int32_t)v40 + 16); // 0x80d82e7
                v56 = jump_buffer;
                if (str4 == 0) {
                    goto lab_0x80d8325;
                } else {
                    // 0x80d82ee
                    if (strcmp((char *)&g307, (char *)str4) != 0) {
                        // 0x80d82ee
                        v56 = jump_buffer;
                        goto lab_0x80d8325;
                    } else {
                        // 0x80d8308
                        mustshow = 1;
                        statusline(gettext("Edit the current shortcut: "));
                        v20 = v40;
                        goto lab_0x80d837f;
                    }
                }
            }
        }
    }
    // 0x80d80b0
    *(char *)&g307 = 0;
    HTSACopy((char **)((int32_t)v39 + 16), (char *)&g307);
    HTInfoMsg(gettext("Cancelled!!!"));
    result = NULL;
  lab_0x80d8473:
    // 0x80d8473
    return result;
  lab_0x80d8428:
    // 0x80d8428
    HTSACopy((char **)v65, v10);
    LYAddJumpShortcut((int32_t *)*v58, (char *)*v50);
    result = NULL;
    if (found_elem == NULL) {
        goto lab_0x80d8473;
    } else {
        // 0x80d845b
        result = (char *)*(int32_t *)((int32_t)found_elem + 4);
        goto lab_0x80d8473;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYJump.c
// Address range: 0x80d8478 - 0x80d88e6
// Line range:    362 - 490
int32_t LYRead_Jumpfile(int32_t * jtp) {
    int32_t v1 = (int32_t)jtp;
    int32_t * v2 = (int32_t *)(v1 + 12); // 0x80d8486
    int32_t v3 = *v2; // 0x80d8486
    if (v3 == 0) {
        // 0x80d88d6
        return 0;
    }
    char * v4 = (char *)v3; // 0x80d8493
    if (*v4 == 0) {
        // 0x80d88d6
        return 0;
    }
    int32_t v5 = v3; // 0x80d84b2
    if (WWW_TraceFlag != 0) {
        // 0x80d84b4
        fprintf(TraceFP(), "Read Jumpfile %s\n", v4);
        v5 = *v2;
    }
    // 0x80d84d5
    int32_t v6; // bp-128, 0x80d8478
    if (stat64(v5, &v6) < 0) {
        // 0x80d84ee
        HTAlert(gettext("Cannot locate jump file!"));
        // 0x80d88d6
        return 0;
    }
    // 0x80d8511
    int32_t nbyte; // 0x80d8478
    int32_t * mem = calloc(nbyte + 1, 1); // 0x80d8525
    if (mem == NULL) {
        // 0x80d8533
        HTAlert(gettext("Out of memory reading jump file!"));
        // 0x80d88d6
        return 0;
    }
    int32_t fd = open64((char *)*v2, 0); // 0x80d8567
    if (fd < 0) {
        // 0x80d858f
        HTAlert(gettext("Cannot open jump file!"));
        free(mem);
        // 0x80d88d6
        return 0;
    }
    int32_t v7 = read(fd, mem, nbyte); // 0x80d85c7
    int32_t v8 = v7 >> 31; // 0x80d85d4
    int32_t result; // 0x80d8478
    if (v8 <= nbyte) {
        if (v8 >= nbyte != v7 >= nbyte) {
            // 0x80d8633
            HTAlert(gettext("Error reading jump file!"));
            free(mem);
            result = 0;
          lab_0x80d88d6:
            // 0x80d88d6
            return result;
        }
    }
    int32_t v9 = (int32_t)mem; // 0x80d8525
    *(char *)(nbyte + v9) = 0;
    close(fd);
    char * found_char_pos = strchr((char *)mem, 10); // 0x80d8690
    char * found_char_pos2 = found_char_pos; // 0x80d869c
    int32_t v10 = 0; // 0x80d869c
    int32_t v11 = 0; // 0x80d869c
    if (found_char_pos != NULL) {
        v10++;
        found_char_pos2 = strchr((char *)((int32_t)found_char_pos2 + 1), 10);
        v11 = v10;
        while (found_char_pos2 != NULL) {
            // 0x80d867a
            v10++;
            found_char_pos2 = strchr((char *)((int32_t)found_char_pos2 + 1), 10);
            v11 = v10;
        }
    }
    int32_t * mem2 = malloc(8 * v11); // 0x80d86a7
    int32_t * v12 = (int32_t *)(v1 + 24); // 0x80d86b1
    *v12 = (int32_t)mem2;
    if (mem2 == NULL) {
        // 0x80d86d8
        HTAlert(gettext("Out of memory reading jump table!"));
        free(mem);
        // 0x80d88d6
        return 0;
    }
    // 0x80d86f9
    *(int32_t *)(v1 + 32) = v9;
    int32_t v13 = 0;
    int32_t v14 = v9; // 0x80d88c7
    result = v13;
    while (v13 < v11) {
        // 0x80d88c1
        char * str; // 0x80d8478
        while (true) {
            // 0x80d8717
            str = (char *)v14;
            if (strncmp(str, "<!--", 4) != 0) {
                // 0x80d8736
                if (strncmp(str, "<dl>", 4) != 0) {
                    // break -> 0x80d877e
                    break;
                }
            }
            char * found_char_pos3 = strchr(str, 10); // 0x80d8763
            result = v13;
            if (found_char_pos3 == NULL) {
                return result;
            }
            // 0x80d8775
            v14 = (int32_t)found_char_pos3 + 1;
        }
        char * v15 = LYstrstr(str, "<dt>"); // 0x80d878c
        result = v13;
        if (v15 == NULL) {
            // break -> 0x80d88d6
            break;
        }
        int32_t v16 = (int32_t)v15 + 4; // 0x80d879e
        int32_t v17 = 8 * v13; // 0x80d87ab
        *(int32_t *)(*v12 + v17) = v16;
        char * v18 = LYstrstr((char *)v16, "<dd>"); // 0x80d87c3
        result = v13;
        if (v18 == NULL) {
            // break -> 0x80d88d6
            break;
        }
        // 0x80d87d5
        *v18 = 0;
        char * v19 = LYstrstr((char *)((int32_t)v18 + 4), "href=\""); // 0x80d87ed
        result = v13;
        if (v19 == NULL) {
            // break -> 0x80d88d6
            break;
        }
        int32_t str2 = (int32_t)v19 + 6; // 0x80d87ff
        *(int32_t *)(*v12 + (v17 | 4)) = str2;
        char * found_char_pos4 = strchr((char *)str2, 34); // 0x80d8825
        result = v13;
        if (found_char_pos4 == NULL) {
            // break -> 0x80d88d6
            break;
        }
        // 0x80d8837
        *found_char_pos4 = 0;
        char * found_char_pos5 = strchr((char *)((int32_t)found_char_pos4 + 1), 10); // 0x80d884f
        result = v13;
        if (found_char_pos5 == NULL) {
            // break -> 0x80d88d6
            break;
        }
        // 0x80d885d
        if (WWW_TraceFlag != 0) {
            int32_t v20 = *v12 + v17; // 0x80d8878
            int32_t v21 = *(int32_t *)(v20 + 4); // 0x80d887b
            int32_t v22 = *(int32_t *)v20; // 0x80d888d
            fprintf(TraceFP(), "Read jumpfile[%u] key='%s', url='%s'\n", v13, (char *)v22, (char *)v21);
        }
        int32_t v23 = (int32_t)found_char_pos5 + 1; // 0x80d885d
        int32_t v24 = v13 + 1; // 0x80d88b7
        result = v24;
        if (v23 == 0) {
            // break -> 0x80d88d6
            break;
        }
        v13 = v24;
        v14 = v23;
        result = v13;
    }
    // 0x80d88d6
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYList.c
// Address range: 0x80d8904 - 0x80d9132
// Line range:    40 - 233
int32_t showlist(int32_t * newdoc2, char titles) {
    int32_t hidden_links = 0; // bp-28, 0x80d8913
    int32_t * fp0 = NULL; // bp-32, 0x80d891a
    char * Title = NULL; // bp-40, 0x80d8928
    char * cp = "unknown field or link"; // bp-44, 0x80d8933
    int32_t v1 = HText_sourceAnchors(HTMainText); // 0x80d8942
    int32_t v2 = HText_HiddenLinkCount(HTMainText); // 0x80d8952
    if (v1 >= 0 != v1 != 0 && v2 >= 1 && LYHiddenLinks != 1) {
        // 0x80d8970
        HTUserMsg(gettext("There are only hidden links from this document."));
        // 0x80d912a
        return -1;
    }
    if (v1 >= 0 != v1 != 0) {
        if (v2 >= 0 != v2 != 0) {
            // 0x80d899f
            HTUserMsg(gettext("There are no references from this document."));
            // 0x80d912a
            return -1;
        }
    }
    struct _IO_FILE * stream = InternalPageFP((char *)&g309, (int32_t)(g141 == titles)); // 0x80d89dd
    if (stream == NULL) {
        // 0x80d912a
        return -1;
    }
    int32_t v3 = (int32_t)newdoc2;
    int32_t v4 = v3 + 4; // 0x80d89fd
    LYLocalFileToURL((char **)v4, (char *)&g309);
    LYRegisterUIPage((char *)*(int32_t *)v4, titles == 0 ? 11 : 4);
    g141 = titles;
    LYforce_HTML_mode = 1;
    LYforce_no_cache = 1;
    BeginInternalPage(stream, gettext("List Page"), "keystrokes/follow_help.html.gz");
    char * v5 = HTLoadedDocumentURL(); // 0x80d8a7e
    HTSACopy((char **)&hidden_links, v5);
    LYEntify((char **)&hidden_links, 0);
    int32_t v6 = hidden_links; // 0x80d8aa5
    char * v7; // 0x80d8904
    if (v6 == 0) {
        // 0x80d8ab6
        v7 = gettext("this document:");
        goto lab_0x80d8ad3;
    } else {
        char * v8 = (char *)v6; // 0x80d8aaf
        v7 = v8;
        if (*v8 != 0) {
            goto lab_0x80d8ad3;
        } else {
            // 0x80d8ab6
            v7 = gettext("this document:");
            goto lab_0x80d8ad3;
        }
    }
  lab_0x80d8d55:;
    // 0x80d8d55
    int32_t v9; // 0x80d8904
    int32_t v10 = v9;
    char * v11; // 0x80d8904
    char * v12 = v11;
    char * v13 = Title; // 0x80d8d55
    char * v14 = v12; // 0x80d8d5a
    int32_t v15 = v10; // 0x80d8d5a
    if (v13 != NULL) {
        // 0x80d8d5c
        free((int32_t *)v13);
        Title = NULL;
        v14 = v12;
        v15 = v10;
    }
    goto lab_0x80d8d6e;
  lab_0x80d8f2d:;
    // 0x80d8f2d
    int32_t v35; // 0x80d8904
    int32_t v36 = v35 + 1; // 0x80d8f2d
    int32_t v37 = v36; // 0x80d8f37
    char * v34; // 0x80d8904
    char * v38 = v34; // 0x80d8f37
    int32_t v39; // 0x80d8904
    int32_t v40 = v39; // 0x80d8f37
    if (v36 > v1) {
        // break -> 0x80d8f3d
        goto lab_0x80d8f3d;
    }
    goto lab_0x80d8bae;
  lab_0x80d8d6e:;
    char * v16 = v14;
    char * v17; // 0x80d8caa
    HTSACopy((char **)&hidden_links, v17);
    if (v17 != NULL) {
        // 0x80d8d86
        free((int32_t *)v17);
    }
    // 0x80d8d98
    LYEntify((char **)&hidden_links, 1);
    char * v18; // 0x80d8904
    char * found_char_pos = v18; // 0x80d8daf
    if (v15 != 0) {
        // 0x80d8db1
        found_char_pos = v18;
        if (*v16 != 0) {
            // 0x80d8dbb
            LYformTitle((char **)&fp0, v16);
            LYEntify((char **)&fp0, 1);
            int32_t * v19 = fp0; // 0x80d8de0
            if (*(char *)v19 == 0) {
                // 0x80d8e02
                found_char_pos = v18;
                if (v19 != NULL) {
                    // 0x80d8e09
                    free(v19);
                    fp0 = NULL;
                    found_char_pos = v18;
                }
            } else {
                // 0x80d8dea
                found_char_pos = strchr((char *)hidden_links, 35);
            }
        }
    }
    char * v20 = found_char_pos;
    int32_t * v21 = fp0; // 0x80d8e1b
    bool v22 = v20 == NULL | v21 == NULL;
    char * v23 = v22 ? (char *)&g54 : (char *)((int32_t)v20 + 1);
    char * v24 = v22 ? (char *)&g54 : " - ";
    char * v25 = (char *)hidden_links;
    char * v26 = v21 == NULL ? v25 : (char *)v21;
    int32_t * v27; // 0x80d8c33
    int32_t * v28; // 0x80d8c4f
    char * v29 = v28 == v27 | v21 == NULL ? (char *)&g54 : "in ";
    char * v30 = Title; // 0x80d8e8b
    char * v31 = v30 == NULL ? (char *)&g54 : v30;
    fprintf(stream, "<li><a href=\"%s\"%s>%s%s%s%s%s</a>\n", v25, (char *)&g54, v31, v29, v26, v24, v23);
    int32_t v32 = hidden_links; // 0x80d8efb
    if (v32 != 0) {
        // 0x80d8f02
        free((int32_t *)v32);
        hidden_links = 0;
    }
    int32_t * v33 = fp0; // 0x80d8f14
    v34 = v20;
    if (v33 != NULL) {
        // 0x80d8f1b
        free(v33);
        fp0 = NULL;
        v34 = v20;
    }
    goto lab_0x80d8f2d;
  lab_0x80d8ad3:
    // 0x80d8ad3
    fprintf(stream, "%s%s<p>\n", gettext("References in "), v7);
    if (hidden_links != 0) {
        // 0x80d8b07
        int32_t v48; // 0x80d8b00
        free((int32_t *)v48);
        hidden_links = 0;
    }
    char * LinkTitle; // bp-48, 0x80d8904
    if (v1 < 1) {
        if (v2 < 1) {
            // 0x80d8b9b
            LinkTitle = NULL;
            v40 = v2;
        } else {
            // 0x80d8b9b
            LinkTitle = NULL;
            v40 = LYHiddenLinks != 2 ? v2 : 0;
        }
    } else {
        // 0x80d8b1f
        fprintf(stream, "<%s compact>\n", keypad_mode != 0 ? "ul" : "ol");
        v39 = v2;
        if (v2 >= 1) {
            // 0x80d8b9b
            fprintf(stream, "<lh><em>%s</em>\n", gettext("Visible links:"));
            v39 = LYHiddenLinks != 2 ? v2 : 0;
        }
        // 0x80d8bae
        LinkTitle = NULL;
        v37 = 1;
        v38 = NULL;
        while (true) {
          lab_0x80d8bae:
            // 0x80d8bae
            v18 = v38;
            v35 = v37;
            int32_t * v41 = HText_childNextNumber(v35, &LinkTitle); // 0x80d8bbb
            if (v41 != NULL) {
                // 0x80d8c2d
                v27 = HTAnchor_followLink(v41);
                v28 = HTAnchor_parent(v27);
                v17 = HTAnchor_address(v27);
                v11 = NULL;
                v9 = 0;
                if (titles == 0) {
                    goto lab_0x80d8d55;
                } else {
                    char * v42 = HTAnchor_title(v28); // 0x80d8cbe
                    int32_t v43 = (int32_t)v42; // 0x80d8cbe
                    int32_t v44 = (int32_t)v41; // 0x80d8cf6
                    int32_t * v45 = (int32_t *)(v44 + 12); // 0x80d8cf9
                    int32_t v46 = *v45; // 0x80d8cf9
                    v11 = v42;
                    v9 = v43;
                    if (v46 == 0) {
                        goto lab_0x80d8d55;
                    } else {
                        // 0x80d8d00
                        v11 = v42;
                        v9 = v43;
                        if (*(int32_t *)(v44 + 8) != (int32_t)v27) {
                            goto lab_0x80d8d55;
                        } else {
                            // 0x80d8d0b
                            v11 = v42;
                            v9 = v43;
                            if (strncmp((char *)*(int32_t *)(v46 + 4), "RelTitle: ", 10) != 0) {
                                goto lab_0x80d8d55;
                            } else {
                                // 0x80d8d30
                                HTSprintf0(&Title, "(%s)", (char *)(*(int32_t *)(*v45 + 4) + 10));
                                v14 = v42;
                                v15 = v43;
                                goto lab_0x80d8d6e;
                            }
                        }
                    }
                }
            } else {
                int32_t v47 = keypad_mode; // 0x80d8bd0
                v34 = v18;
                if (v47 != 3 != v47 != 2) {
                    // 0x80d8be8
                    HText_FormDescNumber(v35, &cp);
                    fprintf(stream, "<li><a id=%d href=\"#%d\">form field</a> = <em>%s</em>\n", v35, v35, cp);
                    v34 = v18;
                }
                goto lab_0x80d8f2d;
            }
        }
    }
  lab_0x80d8f3d:
    // 0x80d8f3d
    if (Title != NULL) {
        // 0x80d8f44
        free((int32_t *)Title);
        Title = NULL;
    }
    if (v40 >= 1) {
        if (v1 >= 1) {
            // 0x80d8f66
            fprintf(stream, "\n</%s>\n\n<p>\n", keypad_mode != 0 ? "ul" : "ol");
        }
        // 0x80d8ffb
        fprintf(stream, "<%s compact>\n", keypad_mode != 0 ? "ul" : "ol continue");
        fprintf(stream, "<lh><em>%s</em>\n", gettext("Hidden links:"));
        int32_t v49 = 0; // 0x80d9098
        char * v50 = HText_HiddenLinkAt(HTMainText, v49); // 0x80d900b
        HTSACopy((char **)&hidden_links, v50);
        LYEntify((char **)&hidden_links, 0);
        int32_t v51 = hidden_links;
        char * v52; // 0x80d903c
        int32_t v53; // 0x80d907f
        if (v51 != 0) {
            // 0x80d9039
            v52 = (char *)v51;
            if (*v52 != 0) {
                // 0x80d905e
                fprintf(stream, "<li><a href=\"%s\">%s</a>\n", v52, v52);
                v53 = hidden_links;
                if (v53 != 0) {
                    // 0x80d9086
                    free((int32_t *)v53);
                    hidden_links = 0;
                }
            } else {
                // 0x80d904a
                free((int32_t *)v51);
                hidden_links = 0;
            }
        }
        // 0x80d9098
        v49++;
        while (v49 != v40) {
            // 0x80d8ffb
            v50 = HText_HiddenLinkAt(HTMainText, v49);
            HTSACopy((char **)&hidden_links, v50);
            LYEntify((char **)&hidden_links, 0);
            v51 = hidden_links;
            if (v51 != 0) {
                // 0x80d9039
                v52 = (char *)v51;
                if (*v52 != 0) {
                    // 0x80d905e
                    fprintf(stream, "<li><a href=\"%s\">%s</a>\n", v52, v52);
                    v53 = hidden_links;
                    if (v53 != 0) {
                        // 0x80d9086
                        free((int32_t *)v53);
                        hidden_links = 0;
                    }
                } else {
                    // 0x80d904a
                    free((int32_t *)v51);
                    hidden_links = 0;
                }
            }
            // 0x80d9098
            v49++;
        }
    }
    // 0x80d9112
    fprintf(stream, "\n</%s>\n", keypad_mode != 0 ? "ul" : "ol");
    EndInternalPage(stream);
    LYCloseTempFP(stream);
    LYFreePostData(newdoc2);
    *(char *)(v3 + 32) = 0;
    *(char *)(v3 + 20) = 0;
    *(char *)(v3 + 21) = 0;
    // 0x80d912a
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYList.c
// Address range: 0x80d9132 - 0x80d92d6
// Line range:    236 - 287
void print_refs(struct _IO_FILE * fp, char titles, int32_t refs) {
    int32_t cnt = (int32_t)gettext("unknown field or link"); // bp-16, 0x80d9151
    char * address = NULL; // bp-20, 0x80d9154
    if (refs < 1) {
        // 0x80d92d4
        return;
    }
    int32_t v1 = 1;
    int32_t * v2 = HText_childNextNumber(v1, &address); // 0x80d9174
    char * v3; // 0x80d9132
    int32_t v4; // 0x80d9132
    int32_t v5; // 0x80d9132
    int32_t v6; // 0x80d9132
    int32_t * v7; // 0x80d91d8
    int32_t v8; // 0x80d9182
    int32_t * v9; // 0x80d91f2
    char * v10; // 0x80d9223
    int32_t v11; // 0x80d922b
    if (v2 != NULL) {
        // 0x80d91d2
        v7 = HTAnchor_followLink(v2);
        if (v7 != v2) {
            // 0x80d91ec
            v9 = HTAnchor_parent(v7);
            v5 = 0;
            if (titles != 0) {
                // 0x80d9200
                v5 = (int32_t)HTAnchor_title(v9);
            }
            // 0x80d9217
            v6 = v5;
            v10 = HTAnchor_address(v7);
            v11 = keypad_mode;
            if (v11 != 1 != v11 != 2) {
                // 0x80d923f
                fprintf(fp, "%4d. ", v1);
            }
            // 0x80d9259
            v4 = v6 == 0 ? (int32_t)v10 : v6;
            v3 = v9 == v7 | v6 == 0 ? (char *)&g54 : "in ";
            fprintf(fp, "%s%s\n", v3, (char *)v4);
            if (v10 != NULL) {
                // 0x80d92b2
                free((int32_t *)v10);
            }
        }
    } else {
        // 0x80d9182
        v8 = keypad_mode;
        if (v8 != 3 != v8 != 2) {
            // 0x80d919a
            HText_FormDescNumber(v1, (char **)&cnt);
            fprintf(fp, "%4d. form field = %s\n", v1, (char *)cnt);
        }
    }
    int32_t v12 = v1 + 1; // 0x80d92c4
    while (v12 <= refs) {
        // 0x80d9167
        v1 = v12;
        v2 = HText_childNextNumber(v1, &address);
        if (v2 != NULL) {
            // 0x80d91d2
            v7 = HTAnchor_followLink(v2);
            if (v7 != v2) {
                // 0x80d91ec
                v9 = HTAnchor_parent(v7);
                v5 = 0;
                if (titles != 0) {
                    // 0x80d9200
                    v5 = (int32_t)HTAnchor_title(v9);
                }
                // 0x80d9217
                v6 = v5;
                v10 = HTAnchor_address(v7);
                v11 = keypad_mode;
                if (v11 != 1 != v11 != 2) {
                    // 0x80d923f
                    fprintf(fp, "%4d. ", v1);
                }
                // 0x80d9259
                v4 = v6 == 0 ? (int32_t)v10 : v6;
                v3 = v9 == v7 | v6 == 0 ? (char *)&g54 : "in ";
                fprintf(fp, "%s%s\n", v3, (char *)v4);
                if (v10 != NULL) {
                    // 0x80d92b2
                    free((int32_t *)v10);
                }
            }
        } else {
            // 0x80d9182
            v8 = keypad_mode;
            if (v8 != 3 != v8 != 2) {
                // 0x80d919a
                HText_FormDescNumber(v1, (char **)&cnt);
                fprintf(fp, "%4d. form field = %s\n", v1, (char *)cnt);
            }
        }
        // 0x80d92c4
        v12 = v1 + 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYList.c
// Address range: 0x80d92d6 - 0x80d93fe
// Line range:    290 - 312
void print_hidden_refs(struct _IO_FILE * fp, int32_t refs, uint32_t hidden_links) {
    int32_t cnt = 0; // bp-12, 0x80d92dc
    char * v1 = gettext("Hidden links:"); // 0x80d92ea
    char * v2 = refs < 1 ? (char *)&g54 : (char *)&g55;
    fprintf(fp, "%s   %s\n", v2, v1);
    if (hidden_links <= 0) {
        // 0x80d93fc
        return;
    }
    int32_t v3 = 0;
    char * v4 = HText_HiddenLinkAt(HTMainText, v3); // 0x80d9345
    HTSACopy((char **)&cnt, v4);
    int32_t v5 = cnt;
    char * v6; // 0x80d92d6
    char * v7; // 0x80d92d6
    int32_t v8; // 0x80d9385
    int32_t v9; // 0x80d93d3
    if (v5 != 0) {
        // 0x80d9360
        v7 = (char *)v5;
        if (*v7 != 0) {
            // 0x80d9385
            v8 = keypad_mode;
            v6 = v7;
            if (v8 != 1 != v8 != 2) {
                // 0x80d9399
                fprintf(fp, "%4d. ", v3 + 1 + refs);
                v6 = (char *)cnt;
            }
            // 0x80d93b9
            fprintf(fp, "%s\n", v6);
            v9 = cnt;
            if (v9 != 0) {
                // 0x80d93da
                free((int32_t *)v9);
                cnt = 0;
            }
        } else {
            // 0x80d9371
            free((int32_t *)v5);
            cnt = 0;
        }
    }
    int32_t v10 = v3 + 1; // 0x80d93ec
    while (v10 != hidden_links) {
        // 0x80d9335
        v3 = v10;
        v4 = HText_HiddenLinkAt(HTMainText, v3);
        HTSACopy((char **)&cnt, v4);
        v5 = cnt;
        if (v5 != 0) {
            // 0x80d9360
            v7 = (char *)v5;
            if (*v7 != 0) {
                // 0x80d9385
                v8 = keypad_mode;
                v6 = v7;
                if (v8 != 1 != v8 != 2) {
                    // 0x80d9399
                    fprintf(fp, "%4d. ", v3 + 1 + refs);
                    v6 = (char *)cnt;
                }
                // 0x80d93b9
                fprintf(fp, "%s\n", v6);
                v9 = cnt;
                if (v9 != 0) {
                    // 0x80d93da
                    free((int32_t *)v9);
                    cnt = 0;
                }
            } else {
                // 0x80d9371
                free((int32_t *)v5);
                cnt = 0;
            }
        }
        // 0x80d93ec
        v10 = v3 + 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYList.c
// Address range: 0x80d93fe - 0x80d9519
// Line range:    324 - 347
void printlist(struct _IO_FILE * fp, char titles) {
    int32_t v1 = HText_sourceAnchors(HTMainText); // 0x80d9412
    if (v1 >= 0 != v1 != 0) {
        // 0x80d9420
        if (LYHiddenLinks != 1) {
            // 0x80d950c
            LYPrintImgMaps(fp);
            return;
        }
    }
    int32_t v2 = HText_HiddenLinkCount(HTMainText); // 0x80d9436
    if (v1 >= 0 != v1 != 0 == v2 < 1) {
        // 0x80d950c
        LYPrintImgMaps(fp);
        return;
    }
    // 0x80d944e
    if (keypad_mode < 4) {
        // 0x80d9476
        fprintf(fp, "\n%s\n\n", gettext("References"));
    }
    int32_t v3 = LYHiddenLinks != 2 ? v2 : 0;
    if (v3 < 1) {
        // 0x80d94d3
        print_refs(fp, titles, v1);
    } else {
        // 0x80d94f3
        fprintf(fp, "   %s\n", gettext("Visible links"));
        print_refs(fp, titles, v1);
        print_hidden_refs(fp, v1, v3);
    }
    // 0x80d950c
    LYPrintImgMaps(fp);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYTraversal.c
// Address range: 0x80daeac - 0x80daef6
// Line range:    15 - 26
void final_perror(char * msg, char clean_flag) {
    int32_t v1 = *__errno_location(); // 0x80daebd
    if (LYCursesON == 0) {
        // 0x80daedf
        *__errno_location() = v1;
        perror(msg);
        return;
    }
    if (clean_flag == 0) {
        // 0x80daeda
        stop_curses();
    } else {
        // 0x80daed3
        cleanup();
    }
    // 0x80daedf
    *__errno_location() = v1;
    perror(msg);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYTraversal.c
// Address range: 0x80daef6 - 0x80daf1d
// Line range:    29 - 32
void exit_with_perror(char * msg) {
    // 0x80daef6
    final_perror(msg, 1);
    exit_immediately(1);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYTraversal.c
// Address range: 0x80daf1d - 0x80db02e
// Line range:    35 - 63
char lookup_link(char * target) {
    int32_t * ifp = NULL; // bp-12, 0x80daf23
    int32_t * ifp2 = NULL; // bp-16, 0x80daf2a
    struct _IO_FILE * v1 = fopen64("traverse.dat", "r"); // 0x80daf47
    if (v1 == NULL) {
        struct _IO_FILE * v2 = LYNewTxtFile("traverse.dat"); // 0x80daf5c
        if (v2 == NULL) {
            // 0x80daf6a
            exit_with_perror(gettext("Unable to open traversal file."));
            // UNREACHABLE
        }
        // 0x80daf80
        LYCloseOutput(v2);
        // 0x80db028
        return 0;
    }
    // 0x80daf94
    HTSprintf0((char **)&ifp2, "%s\n", target);
    char * v3 = LYSafeGets((char **)&ifp, v1); // 0x80dafdc
    char result = 0; // 0x80dafe3
    while (v3 != NULL) {
        // 0x80dafb0
        result = 1;
        if (strcmp((char *)ifp2, (char *)ifp) == 0) {
            // break -> 0x80dafe5
            break;
        }
        v3 = LYSafeGets((char **)&ifp, v1);
        result = 0;
    }
    // 0x80dafe5
    if (ifp2 != NULL) {
        // 0x80dafec
        free(ifp2);
        ifp2 = NULL;
    }
    // 0x80daffe
    if (ifp != NULL) {
        // 0x80db005
        free(ifp);
        ifp = NULL;
    }
    // 0x80db017
    LYCloseInput(v1);
    // 0x80db028
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYTraversal.c
// Address range: 0x80db02e - 0x80db084
// Line range:    66 - 77
void add_to_table(char * target) {
    struct _IO_FILE * stream = LYAppendToTxtFile("traverse.dat"); // 0x80db03b
    if (stream == NULL) {
        // 0x80db049
        exit_with_perror(gettext("Unable to open traversal file."));
        // UNREACHABLE
    }
    // 0x80db05d
    fprintf(stream, "%s\n", target);
    LYCloseOutput(stream);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYTraversal.c
// Address range: 0x80db084 - 0x80db0e1
// Line range:    80 - 91
void add_to_traverse_list(char * fname, char * prev_link_name) {
    struct _IO_FILE * stream = LYAppendToTxtFile("traverse2.dat"); // 0x80db091
    if (stream == NULL) {
        // 0x80db09f
        exit_with_perror(gettext("Unable to open traversal found file."));
        // UNREACHABLE
    }
    // 0x80db0b3
    fprintf(stream, "%s\t%s\n", fname, prev_link_name);
    LYCloseOutput(stream);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYTraversal.c
// Address range: 0x80db0e1 - 0x80db1c6
// Line range:    94 - 115
void dump_traversal_history(void) {
    // 0x80db0e1
    if (nhist < 1) {
        // 0x80db1c0
        return;
    }
    struct _IO_FILE * stream = LYAppendToTxtFile("traverse.dat"); // 0x80db0fc
    if (stream == NULL) {
        // 0x80db10a
        final_perror(gettext("Unable to open traversal file."), 0);
        // 0x80db1c0
        return;
    }
    char * v1 = gettext("here is a list of the history stack so that you may rebuild"); // 0x80db132
    fprintf(stream, "\n\n%s\n\n\t    %s\n\n", gettext("TRAVERSAL WAS INTERRUPTED"), v1);
    int32_t v2 = nhist - 1;
    int32_t v3 = v2; // 0x80db1b3
    if (v2 >= 0) {
        int32_t v4 = 44 * v3 + (int32_t)history; // 0x80db179
        int32_t v5 = *(int32_t *)(v4 + 4); // 0x80db17c
        fprintf(stream, "%s\t%s\n", (char *)*(int32_t *)v4, (char *)v5);
        v3--;
        while (v3 >= 0) {
            // 0x80db16d
            v4 = 44 * v3 + (int32_t)history;
            v5 = *(int32_t *)(v4 + 4);
            fprintf(stream, "%s\t%s\n", (char *)*(int32_t *)v4, (char *)v5);
            v3--;
        }
    }
    // 0x80db1b5
    LYCloseOutput(stream);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYTraversal.c
// Address range: 0x80db1c6 - 0x80db245
// Line range:    118 - 131
void add_to_reject_list(char * target) {
    // 0x80db1c6
    if (WWW_TraceFlag != 0) {
        // 0x80db1d7
        fprintf(TraceFP(), "add_to_reject_list(%s)\n", target);
    }
    struct _IO_FILE * stream = LYAppendToTxtFile("reject.dat"); // 0x80db1fc
    if (stream == NULL) {
        // 0x80db20a
        exit_with_perror(gettext("Unable to open reject file."));
        // UNREACHABLE
    }
    // 0x80db21e
    fprintf(stream, "%s\n", target);
    LYCloseOutput(stream);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYTraversal.c
// Address range: 0x80db245 - 0x80db3bb
// Line range:    143 - 179
char lookup_reject(char * target) {
    int32_t * ifp = NULL; // bp-12, 0x80db24b
    int32_t * ifp2 = NULL; // bp-16, 0x80db252
    struct _IO_FILE * v1 = fopen64("reject.dat", "r"); // 0x80db26f
    if (v1 == NULL) {
        // 0x80db3b5
        return 0;
    }
    // 0x80db286
    HTSprintf0((char **)&ifp2, "%s", target);
    char * v2 = LYSafeGets((char **)&ifp, v1); // 0x80db32d
    int32_t * v3 = ifp; // 0x80db334
    char * v4 = NULL; // 0x80db334
    int32_t * v5 = ifp; // 0x80db334
    char * v6; // 0x80db245
    if (v2 != NULL) {
        while (true) {
          lab_0x80db2a2:
            // 0x80db2a2
            LYTrimTrailing((char *)v3);
            int32_t len = strlen((char *)ifp); // 0x80db2b3
            v6 = NULL;
            if (len < 1) {
                goto lab_0x80db320;
            } else {
                int32_t * str = ifp; // 0x80db2c1
                int32_t n = len - 1; // 0x80db2c7
                if (*(char *)(n + (int32_t)str) != 42) {
                    char * v7 = strcmp((char *)ifp2, (char *)str) != 0 ? NULL : (char *)1;
                    v6 = v7;
                    goto lab_0x80db320;
                } else {
                    if ((char *)len == (char *)1) {
                        // 0x80db2fa
                        v6 = (char *)1;
                        goto lab_0x80db320;
                    } else {
                        // 0x80db2da
                        v6 = NULL;
                        if (strncmp((char *)ifp2, (char *)str, n) != 0) {
                            goto lab_0x80db320;
                        } else {
                            // 0x80db2fa
                            v6 = (char *)1;
                            goto lab_0x80db320;
                        }
                    }
                }
            }
        }
    }
  lab_0x80db340:
    // 0x80db340
    if (v5 != NULL) {
        // 0x80db347
        free(v5);
        ifp = NULL;
    }
    // 0x80db359
    if (ifp2 != NULL) {
        // 0x80db360
        free(ifp2);
        ifp2 = NULL;
    }
    // 0x80db372
    LYCloseInput(v1);
    int32_t result; // 0x80db245
    if (WWW_TraceFlag == 0) {
        // 0x80db372
        result = (int32_t)v4;
    } else {
        int32_t v8 = (int32_t)v4;
        fprintf(TraceFP(), "lookup_reject(%s) -> %d\n", target, v8);
        result = v8;
    }
    // 0x80db3b5
    return result;
  lab_0x80db320:;
    char * v9 = LYSafeGets((char **)&ifp, v1); // 0x80db32d
    v3 = ifp;
    v4 = v6;
    v5 = v3;
    if (v6 == NULL != v9 != NULL) {
        // break -> 0x80db340
        goto lab_0x80db340;
    }
    goto lab_0x80db2a2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYEditmap.c
// Address range: 0x80db3bc - 0x80db525
// Line range:    973 - 1012
int32_t EditBinding(uint32_t xlkc) {
    // 0x80db3bc
    if (xlkc == -1) {
        // 0x80db520
        return 0;
    }
    if ((int16_t)xlkc <= 0xffff) {
        // 0x80db520
        return xlkc / 256 % 128;
    }
    uint32_t v1 = xlkc % 2048; // 0x80db3cc
    int32_t result; // 0x80db3bc
    if ((xlkc & 0x4000) == 0) {
        if ((xlkc & 0x2000) == 0) {
            if ((xlkc & 0x1000) == 0) {
                int32_t v2 = *(int32_t *)(4 * current_lineedit + (int32_t)&LYLineEditors); // 0x80db4db
                result = (int32_t)*(char *)(v2 + v1);
                goto lab_0x80db4f1;
            } else {
                if (v1 > 273) {
                    goto lab_0x80db4f7;
                } else {
                    int16_t v3 = *(int16_t *)(2 * v1 + (int32_t)Mod3Binding); // 0x80db4be
                    result = v3;
                    goto lab_0x80db4f1;
                }
            }
        } else {
            if (v1 > 273) {
                goto lab_0x80db4f7;
            } else {
                // 0x80db475
                result = (int32_t)*(int16_t *)(2 * v1 + (int32_t)Mod2Binding);
                goto lab_0x80db4f1;
            }
        }
    } else {
        if (v1 > 273) {
            goto lab_0x80db4f7;
        } else {
            int16_t v4 = *(int16_t *)(2 * v1 + (int32_t)&Mod1Binding); // 0x80db440
            result = v4;
            goto lab_0x80db4f1;
        }
    }
  lab_0x80db4f7:;
    int32_t v5 = *(int32_t *)(4 * current_lineedit + (int32_t)&LYLineEditors); // 0x80db4fc
    // 0x80db520
    return (int32_t)*(char *)(v5 + v1);
  lab_0x80db4f1:
    // 0x80db4f1
    if (result != 31) {
        // 0x80db520
        return result;
    }
    goto lab_0x80db4f7;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYEditmap.c
// Address range: 0x80db695 - 0x80db778
// Line range:    1095 - 1110
int32_t LYKeyForEditAction(int32_t lec) {
    int32_t v1 = *(int32_t *)(4 * current_lineedit + (int32_t)&LYLineEditors); // 0x80db6ac
    int32_t v2 = 97;
    int32_t v3; // 0x80db695
    int32_t result; // 0x80db695
    while (true) {
      lab_0x80db6a7:;
        int32_t v4 = v2;
        result = v4;
        if ((int32_t)*(char *)(v4 + v1) == lec) {
            // break -> 0x80db773
            break;
        }
        // 0x80db6d5
        v3 = 32;
        switch (v4) {
            case 122: {
                goto lab_0x80db75c;
            }
            case 96: {
                // 0x80db75c
                v3 = 123;
                goto lab_0x80db75c;
            }
            case 126: {
                // 0x80db75c
                v3 = 0;
                goto lab_0x80db75c;
            }
            case 31: {
                // 0x80db75c
                v3 = 256;
                goto lab_0x80db75c;
            }
            case 659: {
                // 0x80db75c
                v3 = 127;
                goto lab_0x80db75c;
            }
            default: {
                // 0x80db6f6
                v3 = v4 == 255 ? -1 : v4 + 1;
                goto lab_0x80db75c;
            }
        }
    }
    // 0x80db773
    return result;
  lab_0x80db75c:
    // 0x80db75c
    v2 = v3;
    result = -1;
    if (v2 < 0) {
        return result;
    }
    goto lab_0x80db6a7;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYEditmap.c
// Address range: 0x80db778 - 0x80dc1e3
// Line range:    1127 - 1287
int32_t LYEditKeyForAction(int32_t lac, int32_t * pmodkey) {
    if (pmodkey != NULL) {
        // 0x80db79c
        *pmodkey = -1;
    }
    int32_t v1 = *(int32_t *)(4 * current_lineedit + (int32_t)&LYLineEditors); // 0x80db7b6
    bool v2 = lynx_edit_mode == 0 | lac == 0 | no_dired_support != 0;
    bool v3 = v2 | (int32_t)g138 != lac;
    int32_t v4 = 97;
    int32_t v5 = -1;
    int32_t v6 = -1;
    int32_t v7 = -1;
    int32_t v8; // 0x80db778
    int32_t v9; // 0x80db778
    int32_t v10; // 0x80db778
    int32_t result; // 0x80db778
    int32_t v11; // 0x80db778
    int32_t v12; // 0x80db778
    char v13; // 0x80db7c3
    while (true) {
      lab_0x80db7b1:
        // 0x80db7b1
        v8 = v7;
        v10 = v6;
        v9 = v5;
        v11 = v4;
        v13 = *(char *)(v11 + v1);
        if (v13 == 6) {
            if (!v2) {
                int32_t v14 = key_override[0]; // 0x80db819
                if (v11 != -1) {
                    if ((v11 & 0x8800) == 0) {
                        uint16_t v15 = *(int16_t *)((2 * v11 & 4094) + (int32_t)&key_override + 2); // 0x80db854
                        v14 = v15;
                    } else {
                        // 0x80db839
                        v14 = v11 % 256;
                    }
                }
                // 0x80db871
                result = v11;
                if (v14 == lac) {
                    // break -> 0x80dc1db
                    break;
                }
            }
            int32_t v16 = keymap[0]; // 0x80db88e
            if (v11 != -1) {
                if ((v11 & 0x8800) == 0) {
                    uint16_t v17 = *(int16_t *)((2 * v11 & 4094) + (int32_t)&keymap + 2); // 0x80db8c9
                    v16 = v17;
                } else {
                    // 0x80db8ae
                    v16 = v11 % 256;
                }
            }
            // 0x80db8e6
            result = v11;
            if (v16 == lac) {
                // break -> 0x80dc1db
                break;
            }
        }
        // 0x80db8ff
        result = v11;
        if (v13 == 3 && v3 != (int32_t)g137 != lac) {
            // break -> 0x80dc1db
            break;
        }
        // 0x80db95b
        v12 = 32;
        switch (v11) {
            case 122: {
                goto lab_0x80dba59;
            }
            case 96: {
                // 0x80dba59
                v12 = 123;
                goto lab_0x80dba59;
            }
            case 126: {
                // 0x80dba59
                v12 = 0;
                goto lab_0x80dba59;
            }
            case 31: {
                // 0x80dba59
                v12 = 256;
                goto lab_0x80dba59;
            }
            case 659: {
                // 0x80dba59
                v12 = 127;
                goto lab_0x80dba59;
            }
            default: {
                // 0x80db9c0
                v12 = v11 == 255 ? -1 : v11 + 1;
                goto lab_0x80dba59;
            }
        }
    }
  lab_0x80dc1db:
    // 0x80dc1db
    return result;
  lab_0x80dba59:
    // 0x80dba59
    v5 = v9 < 0 == v13 == 29 ? v11 : v9;
    v7 = v8 < 0 == v13 == 30 ? v11 : v8;
    v6 = v10 >= 0 | v13 > -1 ? v10 : v11;
    v4 = v12;
    int32_t v18; // 0x80db778
    if (v4 < 0) {
        if (v6 < 0) {
            goto lab_0x80dbd28;
        } else {
            // 0x80dba81
            v18 = v6;
            goto lab_0x80dba81_2;
        }
    }
    goto lab_0x80db7b1;
  lab_0x80dbd28:
    if (v5 < 0) {
        goto lab_0x80dbf72;
    } else {
        if (pmodkey == NULL) {
            goto lab_0x80dbd40;
        } else {
            // 0x80dbd38
            *pmodkey = v5;
            goto lab_0x80dbd40;
        }
    }
  lab_0x80dbf72:
    if (v7 < 0) {
        goto lab_0x80dc1c2;
    } else {
        if (pmodkey == NULL) {
            goto lab_0x80dbf8a;
        } else {
            // 0x80dbf82
            *pmodkey = v5;
            goto lab_0x80dbf8a;
        }
    }
  lab_0x80dba81_2:;
    uint32_t v19 = v18;
    int32_t v20 = *(int32_t *)(4 * current_lineedit + (int32_t)&LYLineEditors); // 0x80dba86
    int32_t v21; // 0x80dbab5
    int16_t v22; // 0x80dbaba
    if (*(char *)(v20 + v19) > -1) {
        goto lab_0x80dbc7b;
    } else {
        // 0x80dbaac
        v21 = 2 * v19;
        v22 = *(int16_t *)(v21 + (int32_t)Mod3Binding);
        if (pmodkey == NULL) {
            goto lab_0x80dbad5;
        } else {
            // 0x80dbacd
            *pmodkey = v19;
            goto lab_0x80dbad5;
        }
    }
  lab_0x80dc1c2:
    // 0x80dc1c2
    result = -1;
    if (pmodkey == NULL) {
        goto lab_0x80dc1db;
    } else {
        // 0x80dc1c8
        *pmodkey = -1;
        result = -1;
        goto lab_0x80dc1db;
    }
  lab_0x80dbd40:;
    int32_t v23 = lac | 0x1000; // 0x80dbd64
    int32_t v24 = key_override[0];
    int32_t v25 = keymap[0];
    int32_t v26 = 97; // 0x80db778
    goto lab_0x80dbd4c;
  lab_0x80dbc7b:;
    int32_t v32 = 32; // 0x80db778
    switch (v19) {
        case 122: {
            goto lab_0x80dbd15;
        }
        case 96: {
            // 0x80dbd15
            v32 = 123;
            goto lab_0x80dbd15;
        }
        case 126: {
            // 0x80dbd15
            v32 = 0;
            goto lab_0x80dbd15;
        }
        case 31: {
            // 0x80dbd15
            v32 = 256;
            goto lab_0x80dbd15;
        }
        case 273: {
            // 0x80dbd15
            v32 = 127;
            goto lab_0x80dbd15;
        }
        default: {
            int32_t v49 = v19 == 255 ? -1 : v19 + 1;
            v32 = v49;
            if (v49 >= 0) {
                goto lab_0x80dbd15;
            } else {
                goto lab_0x80dbd28;
            }
        }
    }
  lab_0x80dbf8a:;
    int32_t v36 = 97; // 0x80db778
    goto lab_0x80dbf96;
  lab_0x80dbd4c:;
    uint32_t v27 = v26;
    int32_t v28 = 2 * v27;
    int16_t v29 = *(int16_t *)(v28 + (int32_t)&Mod1Binding); // 0x80dbd4f
    int32_t v30; // 0x80db778
    if (v23 != (int32_t)v29) {
        if (v29 != 6) {
            goto lab_0x80dbe75;
        } else {
            if (v2) {
                goto lab_0x80dbe0d;
            } else {
                // 0x80dbda5
                v30 = v24;
                if (v27 != -1) {
                    if ((v27 & 0x8800) == 0) {
                        uint16_t v31 = *(int16_t *)((v28 & 4094) + (int32_t)&key_override + 2); // 0x80dbdde
                        v30 = v31;
                        goto lab_0x80dbdf2;
                    } else {
                        // 0x80dbdc6
                        v30 = v27 % 256;
                        goto lab_0x80dbdf2;
                    }
                } else {
                    goto lab_0x80dbdf2;
                }
            }
        }
    } else {
        // 0x80dbd6c
        result = v27 | 0x4000;
        goto lab_0x80dc1db;
    }
  lab_0x80dbd15:
    // 0x80dbd15
    v18 = v32;
    goto lab_0x80dba81_2;
  lab_0x80dbad5:;
    int32_t v33; // 0x80db778
    if ((lac || 0x1000) != (int32_t)v22) {
        if (v22 != 6) {
            goto lab_0x80dbc15;
        } else {
            if (v2) {
                goto lab_0x80dbb9b;
            } else {
                if (v19 != -1) {
                    if ((v19 & 0x8800) == 0) {
                        uint16_t v34 = *(int16_t *)((v21 & 4094) + (int32_t)&key_override + 2); // 0x80dbb60
                        v33 = v34;
                        goto lab_0x80dbb7d;
                    } else {
                        // 0x80dbb45
                        v33 = v19 % 256;
                        goto lab_0x80dbb7d;
                    }
                } else {
                    // 0x80dbb27
                    v33 = key_override[0];
                    goto lab_0x80dbb7d;
                }
            }
        }
    } else {
        // 0x80dbae0
        result = v19 | 0x1000;
        goto lab_0x80dc1db;
    }
  lab_0x80dbf96:;
    uint32_t v35 = v36;
    int32_t v37 = 2 * v35; // 0x80dbf9f
    int16_t v38 = *(int16_t *)(v37 + (int32_t)Mod2Binding); // 0x80dbfa4
    int32_t v39; // 0x80db778
    if ((lac || 0x1000) != (int32_t)v38) {
        if (v38 != 6) {
            goto lab_0x80dc0c5;
        } else {
            if (v2) {
                goto lab_0x80dc05d;
            } else {
                // 0x80dbff5
                v39 = key_override[0];
                if (v35 != -1) {
                    if ((v35 & 0x8800) == 0) {
                        uint16_t v40 = *(int16_t *)((v37 & 4094) + (int32_t)&key_override + 2); // 0x80dc02e
                        v39 = v40;
                        goto lab_0x80dc042;
                    } else {
                        // 0x80dc016
                        v39 = v35 % 256;
                        goto lab_0x80dc042;
                    }
                } else {
                    goto lab_0x80dc042;
                }
            }
        }
    } else {
        // 0x80dbfbc
        result = v35 | 0x2000;
        goto lab_0x80dc1db;
    }
  lab_0x80dbe75:
    if (v29 != 3) {
        goto lab_0x80dbedb;
    } else {
        if (v3) {
            if ((int32_t)g137 != lac) {
                goto lab_0x80dbedb;
            } else {
                // 0x80dbec8
                result = v27 | 0x4000;
                goto lab_0x80dc1db;
            }
        } else {
            // 0x80dbea6
            result = v27 | 0x4000;
            goto lab_0x80dc1db;
        }
    }
  lab_0x80dbc15:
    if (v22 != 3) {
        goto lab_0x80dbc7b;
    } else {
        if (v3) {
            if ((int32_t)g137 != lac) {
                goto lab_0x80dbc7b;
            } else {
                // 0x80dbc68
                result = v19 | 0x1000;
                goto lab_0x80dc1db;
            }
        } else {
            // 0x80dbc46
            result = v19 | 0x1000;
            goto lab_0x80dc1db;
        }
    }
  lab_0x80dc0c5:
    if (v38 != 3) {
        goto lab_0x80dc12b;
    } else {
        if (v3) {
            if ((int32_t)g137 != lac) {
                goto lab_0x80dc12b;
            } else {
                // 0x80dc118
                result = v35 | 0x2000;
                goto lab_0x80dc1db;
            }
        } else {
            // 0x80dc0f6
            result = v35 | 0x2000;
            goto lab_0x80dc1db;
        }
    }
  lab_0x80dbedb:;
    int32_t v41 = 32; // 0x80db778
    switch (v27) {
        case 122: {
            goto lab_0x80dbf62;
        }
        case 96: {
            // 0x80dbf62
            v41 = 123;
            goto lab_0x80dbf62;
        }
        case 126: {
            // 0x80dbf62
            v41 = 0;
            goto lab_0x80dbf62;
        }
        case 31: {
            // 0x80dbf62
            v41 = 256;
            goto lab_0x80dbf62;
        }
        case 273: {
            // 0x80dbf62
            v41 = 127;
            goto lab_0x80dbf62;
        }
        default: {
            // 0x80dbefc
            v41 = v27 == 255 ? -1 : v27 + 1;
            goto lab_0x80dbf62;
        }
    }
  lab_0x80dbe0d:;
    int32_t v42 = v25; // 0x80dbe11
    if (v27 != -1) {
        if ((v27 & 0x8800) == 0) {
            uint16_t v43 = *(int16_t *)((v28 & 4094) + (int32_t)&keymap + 2); // 0x80dbe46
            v42 = v43;
            goto lab_0x80dbe5a;
        } else {
            // 0x80dbe2e
            v42 = v27 % 256;
            goto lab_0x80dbe5a;
        }
    } else {
        goto lab_0x80dbe5a;
    }
  lab_0x80dbb9b:;
    int32_t v44; // 0x80db778
    if (v19 != -1) {
        if ((v19 & 0x8800) == 0) {
            uint16_t v45 = *(int16_t *)((v21 & 4094) + (int32_t)&keymap + 2); // 0x80dbbda
            v44 = v45;
            goto lab_0x80dbbf7;
        } else {
            // 0x80dbbbf
            v44 = v19 % 256;
            goto lab_0x80dbbf7;
        }
    } else {
        // 0x80dbba1
        v44 = keymap[0];
        goto lab_0x80dbbf7;
    }
  lab_0x80dc12b:;
    int32_t v46 = 32; // 0x80db778
    switch (v35) {
        case 122: {
            goto lab_0x80dc1b2;
        }
        case 96: {
            // 0x80dc1b2
            v46 = 123;
            goto lab_0x80dc1b2;
        }
        case 126: {
            // 0x80dc1b2
            v46 = 0;
            goto lab_0x80dc1b2;
        }
        case 31: {
            // 0x80dc1b2
            v46 = 256;
            goto lab_0x80dc1b2;
        }
        case 273: {
            // 0x80dc1b2
            v46 = 127;
            goto lab_0x80dc1b2;
        }
        default: {
            // 0x80dc14c
            v46 = v35 == 255 ? -1 : v35 + 1;
            goto lab_0x80dc1b2;
        }
    }
  lab_0x80dc05d:;
    int32_t v47 = keymap[0]; // 0x80dc061
    if (v35 != -1) {
        if ((v35 & 0x8800) == 0) {
            uint16_t v48 = *(int16_t *)((v37 & 4094) + (int32_t)&keymap + 2); // 0x80dc096
            v47 = v48;
            goto lab_0x80dc0aa;
        } else {
            // 0x80dc07e
            v47 = v35 % 256;
            goto lab_0x80dc0aa;
        }
    } else {
        goto lab_0x80dc0aa;
    }
  lab_0x80dbf62:
    // 0x80dbf62
    v26 = v41;
    if (v41 >= 0) {
        goto lab_0x80dbd4c;
    } else {
        goto lab_0x80dbf72;
    }
  lab_0x80dbe5a:
    // 0x80dbe5a
    if (v42 != lac) {
        goto lab_0x80dbe75;
    } else {
        // 0x80dbe62
        result = v27 | 0x4000;
        goto lab_0x80dc1db;
    }
  lab_0x80dbdf2:
    // 0x80dbdf2
    if (v30 != lac) {
        goto lab_0x80dbe0d;
    } else {
        // 0x80dbdfa
        result = v27 | 0x4000;
        goto lab_0x80dc1db;
    }
  lab_0x80dc1b2:
    // 0x80dc1b2
    v36 = v46;
    if (v46 >= 0) {
        goto lab_0x80dbf96;
    } else {
        goto lab_0x80dc1c2;
    }
  lab_0x80dc0aa:
    // 0x80dc0aa
    if (v47 != lac) {
        goto lab_0x80dc0c5;
    } else {
        // 0x80dc0b2
        result = v35 | 0x2000;
        goto lab_0x80dc1db;
    }
  lab_0x80dc042:
    // 0x80dc042
    if (v39 != lac) {
        goto lab_0x80dc05d;
    } else {
        // 0x80dc04a
        result = v35 | 0x2000;
        goto lab_0x80dc1db;
    }
  lab_0x80dbbf7:
    // 0x80dbbf7
    if (v44 != lac) {
        goto lab_0x80dbc15;
    } else {
        // 0x80dbc02
        result = v19 | 0x1000;
        goto lab_0x80dc1db;
    }
  lab_0x80dbb7d:
    // 0x80dbb7d
    if (v33 != lac) {
        goto lab_0x80dbb9b;
    } else {
        // 0x80dbb88
        result = v19 | 0x1000;
        goto lab_0x80dc1db;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYEditmap.c
// Address range: 0x80dc1e3 - 0x80dc1f5
// Line range:    1295 - 1299
int32_t LYEditmapDeclared(void) {
    // 0x80dc1e3
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharSets.c
// Address range: 0x80dc1f8 - 0x80dc595
// Line range:    409 - 515
void HTMLSetCharacterHandling(int32_t i) {
    int32_t v1 = safeUCGetLYhndl_byMIME((char *)UCAssume_MIMEcharset); // 0x80dc207
    char v2 = LYRawMode; // 0x80dc20f
    int32_t v3 = UCLYhndl_for_unspec; // 0x80dc219
    int32_t v4 = 32 * i; // 0x80dc224
    int32_t * v5 = (int32_t *)(v4 + (int32_t)&g144); // 0x80dc227
    char v6; // 0x80dc1f8
    int32_t * v7; // 0x80dc1f8
    char v8; // 0x80dc1f8
    char v9; // 0x80dc1f8
    if (*v5 == 5) {
        char * str = (char *)*(int32_t *)(v4 + (int32_t)&g143); // 0x80dc343
        if (strcmp(str, "euc-cn") != 0) {
            // 0x80dc365
            if (strcmp(str, "euc-jp") != 0) {
                // 0x80dc395
                if (strcmp(str, "shift_jis") != 0) {
                    // 0x80dc3c2
                    if (strcmp(str, "euc-kr") != 0) {
                        // 0x80dc3ef
                        if (strcmp(str, "big5") == 0) {
                            // 0x80dc406
                            HTCJK = 4;
                            kanji_code = 1;
                        }
                    } else {
                        // 0x80dc3d9
                        HTCJK = 3;
                        kanji_code = 1;
                    }
                } else {
                    // 0x80dc3ac
                    HTCJK = 1;
                    kanji_code = 2;
                }
            } else {
                // 0x80dc37c
                HTCJK = 1;
                kanji_code = 1;
            }
        } else {
            // 0x80dc34c
            HTCJK = 2;
            kanji_code = 1;
        }
        // 0x80dc41a
        char v10; // 0x80dc1f8
        if (LYUseDefaultRawMode != 0) {
            // 0x80dc41a
            v10 = HTCJK != 0;
        } else {
            // 0x80dc425
            HTCJK = 0;
            v10 = 0;
        }
        // 0x80dc42f
        LYRawMode = v10;
        HTPassEightBitRaw = 0;
        HTPassEightBitNum = 0;
        v9 = v10;
        v6 = v10;
        goto lab_0x80dc462;
    } else {
        // 0x80dc236
        HTCJK = 0;
        kanji_code = 0;
        char v11 = LYUseDefaultRawMode;
        v8 = v1 != i ? (char)(v11 == 0) : v11;
        LYRawMode = v8;
        int32_t v12 = v4 | 16; // 0x80dc276
        char v13 = 1; // 0x80dc287
        if ((*(int32_t *)(v12 + (int32_t)&g143) & 2) == 0) {
            int32_t v14 = *(int32_t *)(v12 + (int32_t)&g145); // 0x80dc294
            v13 = (v14 & 256) != 0;
        }
        // 0x80dc2b3
        HTPassEightBitNum = v13;
        if (v8 == 0) {
            // 0x80dc2e7
            HTPassEightBitRaw = 0;
            if (v1 != i) {
                // 0x80dc462
                HTPassHighCtrlRaw = 0;
                HTPassHighCtrlNum = 0;
                goto lab_0x80dc477;
            } else {
                // 0x80dc2e7
                v7 = (int32_t *)(4 * i + (int32_t)&LYlowest_eightbit);
                goto lab_0x80dc2fa;
            }
        } else {
            int32_t * v15 = (int32_t *)(4 * i + (int32_t)&LYlowest_eightbit);
            int32_t v16 = *v15; // 0x80dc2ca
            int32_t v17 = v16 - 160; // 0x80dc2d1
            HTPassEightBitRaw = v17 == 0 | v17 < 0 != (159 - v16 & v16) < 0;
            v7 = v15;
            goto lab_0x80dc2fa;
        }
    }
  lab_0x80dc462:
    // 0x80dc462
    HTPassHighCtrlRaw = v9;
    HTPassHighCtrlNum = 0;
    if (v6 == 0) {
        goto lab_0x80dc477;
    } else {
        // 0x80dc46d
        UCLYhndl_for_unspec = i;
        goto lab_0x80dc4b5;
    }
  lab_0x80dc477:
    if (v1 == i) {
        // 0x80dc4ab
        UCLYhndl_for_unspec = LATIN1;
        goto lab_0x80dc4b5;
    } else {
        // 0x80dc47f
        if (*v5 != 5) {
            // 0x80dc4a1
            UCLYhndl_for_unspec = v1;
            goto lab_0x80dc4b5;
        } else {
            // 0x80dc490
            if (*(int32_t *)(32 * v1 + (int32_t)&g144) == 5) {
                // 0x80dc4ab
                UCLYhndl_for_unspec = LATIN1;
                goto lab_0x80dc4b5;
            } else {
                // 0x80dc4a1
                UCLYhndl_for_unspec = v1;
                goto lab_0x80dc4b5;
            }
        }
    }
  lab_0x80dc2fa:;
    int32_t v18 = *v7; // 0x80dc2fd
    int32_t v19 = v18 - 130; // 0x80dc304
    v9 = v19 == 0 | v19 < 0 != (129 - v18 & v18) < 0;
    v6 = v8;
    goto lab_0x80dc462;
  lab_0x80dc4b5:;
    int32_t v20 = *(int32_t *)(4 * current_char_set + (int32_t)&LYlowest_eightbit); // 0x80dc4ba
    int32_t v21 = v20 - 155; // 0x80dc4c1
    ena_csi((char)(v21 < 0 == (154 - v20 & v20) < 0 == (v21 != 0)));
    if (WWW_TraceFlag == 0) {
        // 0x80dc58f
        return;
    }
    // 0x80dc4e3
    if (v2 != LYRawMode) {
        struct _IO_FILE * stream = TraceFP(); // 0x80dc52b
        char * v22 = v2 == 0 ? "OFF" : (char *)&g56; // 0x80dc549
        char * v23 = LYRawMode == 0 ? "OFF" : (char *)&g56; // 0x80dc549
        fprintf(stream, "HTMLSetCharacterHandling: LYRawMode changed %s -> %s\n", v22, v23);
    }
    // 0x80dc550
    if (WWW_TraceFlag != 0 && v3 != UCLYhndl_for_unspec) {
        // 0x80dc565
        fprintf(TraceFP(), "HTMLSetCharacterHandling: UCLYhndl_for_unspec changed %d -> %d\n", v3, UCLYhndl_for_unspec);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharSets.c
// Address range: 0x80dc595 - 0x80dc6f5
// Line range:    522 - 549
void Set_HTCJK(char * inMIMEname, char * outMIMEname) {
    // 0x80dc595
    if (LYRawMode == 0) {
        // 0x80dc6e9
        HTCJK = 0;
        // 0x80dc6f3
        return;
    }
    // 0x80dc5aa
    if (strcmp(inMIMEname, "euc-jp") == 0) {
        goto lab_0x80dc5ef;
    } else {
        // 0x80dc5c1
        if (strcmp(inMIMEname, "utf-8") == 0) {
            goto lab_0x80dc5ef;
        } else {
            // 0x80dc5d8
            if (strcmp(inMIMEname, "shift_jis") != 0) {
                goto lab_0x80dc62c;
            } else {
                goto lab_0x80dc5ef;
            }
        }
    }
  lab_0x80dc5ef:
    // 0x80dc5ef
    if (strcmp(outMIMEname, "euc-jp") == 0 || strcmp(outMIMEname, "shift_jis") == 0) {
        // 0x80dc61d
        HTCJK = 1;
        // 0x80dc6f3
        return;
    }
    goto lab_0x80dc62c;
  lab_0x80dc62c:
    // 0x80dc62c
    if (strcmp(inMIMEname, "euc-cn") == 0) {
        // 0x80dc643
        if (strcmp(outMIMEname, "euc-cn") == 0) {
            // 0x80dc65a
            HTCJK = 2;
            // 0x80dc6f3
            return;
        }
    }
    // 0x80dc669
    if (strcmp(inMIMEname, "big5") == 0) {
        // 0x80dc680
        if (strcmp(outMIMEname, "big5") == 0) {
            // 0x80dc697
            HTCJK = 4;
            // 0x80dc6f3
            return;
        }
    }
    // 0x80dc6a3
    if (strcmp(inMIMEname, "euc-kr") != 0 || strcmp(outMIMEname, "euc-kr") != 0) {
        // 0x80dc6dd
        HTCJK = 0;
        // 0x80dc6f3
        return;
    }
    // 0x80dc6d1
    HTCJK = 3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharSets.c
// Address range: 0x80dc6f5 - 0x80dc711
// Line range:    559 - 562
void HTMLSetRawModeDefault(int32_t i) {
    int32_t v1 = *(int32_t *)(32 * i + (int32_t)&g144); // 0x80dc6fe
    LYDefaultRawMode = v1 == 5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharSets.c
// Address range: 0x80dc711 - 0x80dc76a
// Line range:    570 - 583
void HTMLSetUseDefaultRawMode(int32_t i, char modeflag) {
    // 0x80dc711
    if (*(int32_t *)(32 * i + (int32_t)&g144) == 5) {
        // 0x80dc75f
        LYUseDefaultRawMode = modeflag;
        // 0x80dc768
        return;
    }
    // 0x80dc72e
    if (safeUCGetLYhndl_byMIME((char *)UCAssume_MIMEcharset) != i) {
        // 0x80dc751
        LYUseDefaultRawMode = modeflag == 0;
    } else {
        // 0x80dc746
        LYUseDefaultRawMode = modeflag;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharSets.c
// Address range: 0x80dc76a - 0x80dc786
// Line range:    590 - 593
void HTMLSetHaveCJKCharacterSet(int32_t i) {
    int32_t v1 = *(int32_t *)(32 * i + (int32_t)&g144); // 0x80dc773
    LYHaveCJKCharacterSet = v1 == 5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharSets.c
// Address range: 0x80dc786 - 0x80dc814
// Line range:    601 - 642
void HTMLSetDisplayCharsetMatchLocale(int32_t i) {
    // 0x80dc786
    if (LYHaveCJKCharacterSet != 0) {
        // 0x80dc812
        DisplayCharsetMatchLocale = 1;
        return;
    }
    int32_t * v1 = (int32_t *)(32 * i + (int32_t)&g143); // 0x80dc7a6
    if (strncasecomp((char *)*v1, "cp", 2) != 0) {
        // 0x80dc812
        DisplayCharsetMatchLocale = 0;
        return;
    }
    char v2 = 0; // 0x80dc7ee
    if (strncasecomp((char *)*v1, "windows", 7) == 0) {
        // 0x80dc7f6
        v2 = UCForce8bitTOUPPER == 0;
    }
    // 0x80dc812
    DisplayCharsetMatchLocale = v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharSets.c
// Address range: 0x80dc93e - 0x80dc9ef
// Line range:    875 - 906
int32_t HTMLGetEntityUCValue(char * name) {
    // 0x80dc93e
    if (name == NULL) {
        // 0x80dc9ea
        return 0;
    }
    int32_t v1 = 996; // 0x80dc967
    if (*name == 0) {
        // 0x80dc9ea
        return 0;
    }
    int32_t v2 = 0;
    int32_t v3 = (v1 - v2) / 2 + v2; // 0x80dc98a
    int32_t v4 = 8 * v3; // 0x80dc993
    int32_t str = *(int32_t *)(v4 + (int32_t)&g57); // 0x80dc993
    int32_t strcmp_rc = strcmp((char *)str, name); // 0x80dc9a4
    while (strcmp_rc != 0) {
        int32_t v5 = strcmp_rc >= 0 ? v2 : v3 + 1;
        v1 = strcmp_rc >= 0 ? v3 : v1;
        if (v1 <= v5) {
            // 0x80dc9ea
            return 0;
        }
        v2 = v5;
        v3 = (v1 - v2) / 2 + v2;
        v4 = 8 * v3;
        str = *(int32_t *)(v4 + (int32_t)&g57);
        strcmp_rc = strcmp((char *)str, name);
    }
    // 0x80dc9ea
    return (int32_t)*(int16_t *)(v4 + (int32_t)&g58);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharSets.c
// Address range: 0x80dc9ef - 0x80dca32
// Line range:    913 - 920
void HTMLUseCharacterSet(int32_t i) {
    // 0x80dc9ef
    HTMLSetRawModeDefault(i);
    *(int32_t *)&p_entity_values = *(int32_t *)(4 * i + (int32_t)&LYCharSets);
    HTMLSetCharacterHandling(i);
    HTMLSetHaveCJKCharacterSet(i);
    HTMLSetDisplayCharsetMatchLocale(i);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharSets.c
// Address range: 0x80dca32 - 0x80dca44
// Line range:    926 - 930
int32_t LYCharSetsDeclared(void) {
    // 0x80dca32
    UCInit();
    return UCInitialized;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharUtils.c
// Address range: 0x80dca44 - 0x80dd029
// Line range:    56 - 226
void LYEntify(char ** str, char isTITLE) {
    char * str2 = *str; // 0x80dca53
    char * v1 = str2; // bp-8, 0x80dca55
    if (str2 == NULL) {
        // 0x80dd027
        return;
    }
    // 0x80dca93
    if (*str2 == 0) {
        // 0x80dd027
        return;
    }
    char * v2 = NULL; // 0x80dca9b
    char * found_char_pos = strchr(str2, 38); // 0x80dcac7
    while (found_char_pos != NULL) {
        // 0x80dcaa2
        v2 = (char *)((int32_t)v2 + 1);
        char * str3 = (char *)((int32_t)found_char_pos + 1); // 0x80dcaac
        v1 = str3;
        if (*str3 == 0) {
            // break -> 0x80dcad5
            break;
        }
        found_char_pos = strchr(str3, 38);
    }
    char * v3 = NULL; // 0x80dcad9
    int32_t v4 = 0; // 0x80dcad9
    if (isTITLE == 1) {
        char * str4 = *str;
        int32_t v5 = (int32_t)str4;
        *(int32_t *)&v1 = v5;
        char * v6 = NULL; // 0x80dcafa
        char * str6 = str4; // 0x80dcafa
        int32_t v7 = v5; // 0x80dcafa
        char * v8 = NULL; // 0x80dcafa
        if (*str4 != 0) {
            char * found_char_pos2 = strchr(str4, 60); // 0x80dcb0a
            char * v9 = v6; // 0x80dcb16
            while (found_char_pos2 != NULL) {
                char * v10 = (char *)((int32_t)v6 + 1);
                char * str5 = (char *)((int32_t)found_char_pos2 + 1); // 0x80dcaef
                v1 = str5;
                v6 = v10;
                v9 = v10;
                if (*str5 == 0) {
                    // break -> 0x80dcb1e
                    break;
                }
                found_char_pos2 = strchr(str5, 60);
                v9 = v6;
            }
            // 0x80dcb1e
            str6 = *str;
            v7 = (int32_t)str6;
            v8 = v9;
        }
        // 0x80dcb1e
        *(int32_t *)&v1 = v7;
        int32_t v11 = 0; // 0x80dcb3d
        v3 = v8;
        v4 = 0;
        if (*str6 != 0) {
            char * found_char_pos3 = strchr(str6, 62); // 0x80dcb4d
            v3 = v8;
            v4 = v11;
            while (found_char_pos3 != NULL) {
                int32_t v12 = v11 + 1; // 0x80dcb28
                char * str7 = (char *)((int32_t)found_char_pos3 + 1); // 0x80dcb32
                v1 = str7;
                v11 = v12;
                v3 = v8;
                v4 = v12;
                if (*str7 == 0) {
                    // break -> 0x80dcb5b
                    break;
                }
                found_char_pos3 = strchr(str7, 62);
                v3 = v8;
                v4 = v11;
            }
        }
    }
    // 0x80dcb5b
    if (v2 == NULL) {
        if (v3 == NULL == v4 == 0) {
            // 0x80dd027
            return;
        }
    }
    char * str8 = *str;
    int32_t * mem = calloc(3 * (v4 + (int32_t)v3) + (4 * (int32_t)v2 | 1) + strlen(str8), 1); // 0x80dcbb0
    if (mem == NULL) {
        // 0x80dcbc4
        outofmem("./LYCharUtils.c", "LYEntify");
        // UNREACHABLE
    }
    char * v13 = *str;
    *(int32_t *)&v1 = (int32_t)v13;
    char v14 = *v13; // 0x80dcfef
    char * v15 = (char *)mem; // 0x80dcff4
    char v16; // 0x80dca44
    char * v17; // 0x80dca44
    char v18; // 0x80dca44
    char v19; // 0x80dca44
    char * v20; // 0x80dcfd9
    int32_t v21; // 0x80dca44
    int32_t v22; // 0x80dca44
    int32_t v23; // 0x80dca44
    int32_t v24; // 0x80dca44
    int32_t v25; // 0x80dca44
    int32_t v26; // 0x80dca44
    int32_t v27; // 0x80dca44
    char * v28; // 0x80dca44
    char * v29; // 0x80dca44
    char v30; // 0x80dcc9b
    char v31; // 0x80dcd54
    if (v14 != 0) {
        // 0x80dcbe5
        v16 = v14;
        v17 = v13;
        v22 = 0;
        v25 = 0;
        v28 = (char *)mem;
        while (true) {
          lab_0x80dcbe5:
            // 0x80dcbe5
            v29 = v28;
            v26 = v25;
            v23 = v22;
            v19 = v16;
            if (HTCJK == 0) {
                goto lab_0x80dcf24;
            } else {
                // 0x80dcbfc
                v20 = v17;
                g371 = v26;
                switch (v26) {
                    case 0: {
                        char v32 = *v20; // 0x80dcc0d
                        if (v32 != 27) {
                            goto lab_0x80dcdd4;
                        } else {
                            // 0x80dcc18
                            *v29 = v32;
                            v27 = (int32_t)v29 + 1;
                            v24 = 1;
                            v21 = v23;
                            goto lab_0x80dcfe8;
                        }
                    }
                    case 1: {
                        char v33 = *v20; // 0x80dcc36
                        if (v33 != 36) {
                            // 0x80dcc58
                            *v29 = v33;
                            v27 = (int32_t)v29 + 1;
                            v24 = v33 != 40 ? 0 : 3;
                            v21 = v23;
                        } else {
                            // 0x80dcc3d
                            *v29 = v33;
                            v27 = (int32_t)v29 + 1;
                            v24 = 2;
                            v21 = v23;
                        }
                        goto lab_0x80dcfe8;
                    }
                    case 2: {
                        // 0x80dcc98
                        v30 = *v20;
                        switch (v30) {
                            case 64: {
                                goto lab_0x80dccb6;
                            }
                            case 66: {
                                goto lab_0x80dccb6;
                            }
                            default: {
                                if (v30 != 65) {
                                    // 0x80dccd1
                                    *v29 = v30;
                                    v27 = (int32_t)v29 + 1;
                                    v24 = v30 != 40 ? 0 : 5;
                                    v21 = v23;
                                    goto lab_0x80dcfe8;
                                } else {
                                    goto lab_0x80dccb6;
                                }
                            }
                        }
                    }
                    case 3: {
                        // 0x80dcd51
                        v31 = *v20;
                        switch (v31) {
                            case 66: {
                                goto lab_0x80dcd6f;
                            }
                            case 74: {
                                goto lab_0x80dcd6f;
                            }
                            default: {
                                if (v31 != 84) {
                                    // 0x80dcd8a
                                    v18 = v31;
                                    if (v31 != 73) {
                                        goto lab_0x80dcdaf;
                                    } else {
                                        // 0x80dcd94
                                        *v29 = v31;
                                        v27 = (int32_t)v29 + 1;
                                        v24 = 4;
                                        v21 = v23;
                                        goto lab_0x80dcfe8;
                                    }
                                } else {
                                    goto lab_0x80dcd6f;
                                }
                            }
                        }
                    }
                    case 4: {
                        // 0x80dcbfc
                        v18 = *v20;
                        goto lab_0x80dcdaf;
                    }
                    case 5: {
                        char v34 = *v20; // 0x80dcd14
                        *v29 = v34;
                        v27 = (int32_t)v29 + 1;
                        v24 = v34 != 67 ? 0 : 4;
                        v21 = v23;
                        goto lab_0x80dcfe8;
                    }
                    default: {
                        goto lab_0x80dcdd4;
                    }
                }
            }
        }
    }
  lab_0x80dcffa:
    // 0x80dcffa
    *v15 = 0;
    char * v35 = *str;
    if (v35 != NULL) {
        // 0x80dd009
        free((int32_t *)v35);
        *(int32_t *)str = 0;
    }
    // 0x80dd01f
    *(int32_t *)str = (int32_t)mem;
  lab_0x80dcf24:;
    char v36 = v19; // 0x80dcf27
    char v37; // 0x80dca44
    if (v36 != 38) {
        if (isTITLE == 0 || v36 != 60) {
            // 0x80dcf9f
            v37 = v36;
            if (isTITLE == 0 || v36 != 62) {
                goto lab_0x80dcfd9;
            } else {
                // 0x80dcfaf
                *v29 = 38;
                int32_t v38 = (int32_t)v29; // 0x80dcfb5
                *(char *)(v38 + 1) = 103;
                *(char *)(v38 + 2) = 116;
                *(char *)(v38 + 3) = 59;
                v27 = v38 + 4;
                v24 = v26;
                v21 = v23;
                goto lab_0x80dcfe8;
            }
        } else {
            // 0x80dcf75
            *v29 = 38;
            int32_t v39 = (int32_t)v29; // 0x80dcf7b
            *(char *)(v39 + 1) = 108;
            *(char *)(v39 + 2) = 116;
            *(char *)(v39 + 3) = 59;
            v27 = v39 + 4;
            v24 = v26;
            v21 = v23;
            goto lab_0x80dcfe8;
        }
    } else {
        // 0x80dcf2e
        *v29 = 38;
        int32_t v40 = (int32_t)v29; // 0x80dcf34
        *(char *)(v40 + 1) = 97;
        *(char *)(v40 + 2) = 109;
        *(char *)(v40 + 3) = 112;
        *(char *)(v40 + 4) = 59;
        v27 = v40 + 5;
        v24 = v26;
        v21 = v23;
        goto lab_0x80dcfe8;
    }
  lab_0x80dcdd4:;
    unsigned char v41 = *(char *)((int32_t)v20 + 1); // 0x80dcdda
    char v42 = *v20;
    v19 = v42;
    int32_t v43; // 0x80dca44
    if (v41 == 0) {
        goto lab_0x80dcf24;
    } else {
        // 0x80dcde5
        v43 = v23;
        if (v41 != -1 == (v41 >= 161 && !((v42 < 161 | v42 == -1)))) {
            goto lab_0x80dcefd;
        } else {
            // 0x80dce17
            v43 = v23;
            if (v41 < 224 == v42 == -114) {
                goto lab_0x80dcefd;
            } else {
                // 0x80dce3f
                if (v41 != 127 == v41 < 253) {
                    // 0x80dce66
                    v43 = 1;
                    if (v42 < 160 == v42 < 0 == (v42 != -128)) {
                        goto lab_0x80dcefd;
                    } else {
                        // 0x80dce83
                        v43 = v23;
                        if (v23 != 0 == (v42 & -16) == -32) {
                            goto lab_0x80dcefd;
                        } else {
                            goto lab_0x80dceb5;
                        }
                    }
                } else {
                    goto lab_0x80dceb5;
                }
            }
        }
    }
  lab_0x80dcfe8:;
    char * v44 = (char *)v27;
    char * v45 = (char *)((int32_t)v1 + 1); // 0x80dcfe8
    v1 = v45;
    char v46 = *v45; // 0x80dcfef
    v16 = v46;
    v17 = v45;
    v22 = v21;
    v25 = v24;
    v28 = v44;
    v15 = v44;
    if (v46 == 0) {
        // break -> 0x80dcffa
        goto lab_0x80dcffa;
    }
    goto lab_0x80dcbe5;
  lab_0x80dccb6:
    // 0x80dccb6
    *v29 = v30;
    v27 = (int32_t)v29 + 1;
    v24 = 4;
    v21 = v23;
    goto lab_0x80dcfe8;
  lab_0x80dcd6f:
    // 0x80dcd6f
    *v29 = v31;
    v27 = (int32_t)v29 + 1;
    v24 = 0;
    v21 = v23;
    goto lab_0x80dcfe8;
  lab_0x80dcdaf:
    // 0x80dcdaf
    *v29 = v18;
    v27 = (int32_t)v29 + 1;
    v24 = v18 != 27 ? v26 : 1;
    v21 = v23;
    goto lab_0x80dcfe8;
  lab_0x80dcfd9:
    // 0x80dcfd9
    *v29 = v37;
    v27 = (int32_t)v29 + 1;
    v24 = v26;
    v21 = v23;
    goto lab_0x80dcfe8;
  lab_0x80dcefd:
    // 0x80dcefd
    *v29 = v42;
    int32_t v47 = (int32_t)v29; // 0x80dcf08
    char * v48 = (char *)((int32_t)v1 + 1); // 0x80dcf0c
    v1 = v48;
    *(char *)(v47 + 1) = *v48;
    v27 = v47 + 2;
    v24 = v26;
    v21 = v43;
    goto lab_0x80dcfe8;
  lab_0x80dceb5:
    // 0x80dceb5
    v19 = v42;
    bool v49; // 0x80dca44
    if (v49) {
        goto lab_0x80dcf24;
    } else {
        // 0x80dcec9
        v43 = v23;
        v37 = v42;
        unsigned char v50; // 0x80dca44
        if (v50 > 62 == (v41 < 161 || v41 == -1)) {
            goto lab_0x80dcfd9;
        } else {
            goto lab_0x80dcefd;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharUtils.c
// Address range: 0x80dd029 - 0x80dd09e
// Line range:    234 - 250
void LYTrimHead(char * str) {
    if (str == NULL) {
        // 0x80dd09c
        return;
    }
    char v1 = *str; // 0x80dd03e
    if (v1 == 0) {
        // 0x80dd09c
        return;
    }
    // 0x80dd04b
    if (v1 < 33 != v1 != 27) {
        // 0x80dd09c
        return;
    }
    char * v2 = str; // 0x80dd053
    v2 = (char *)((int32_t)v2 + 1);
    char v3 = *v2; // 0x80dd04e
    while (v3 < 33 == (v3 != 27)) {
        // 0x80dd047
        v2 = (char *)((int32_t)v2 + 1);
        v3 = *v2;
    }
    if (v2 <= str) {
        // 0x80dd09c
        return;
    }
    char * v4 = str; // 0x80dd094
    char * v5 = v2; // 0x80dd094
    if (v3 == 0) {
        // 0x80dd096
        *str = 0;
        // 0x80dd09c
        return;
    }
    *v4 = v3;
    v4 = (char *)((int32_t)v4 + 1);
    v5 = (char *)((int32_t)v5 + 1);
    char v6 = *v5; // 0x80dd08f
    while (v6 != 0) {
        // 0x80dd079
        *v4 = v6;
        v4 = (char *)((int32_t)v4 + 1);
        v5 = (char *)((int32_t)v5 + 1);
        v6 = *v5;
    }
    // 0x80dd096
    *v4 = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharUtils.c
// Address range: 0x80dd09e - 0x80dd0e9
// Line range:    258 - 272
void LYTrimTail(char * str) {
    if (str == NULL || *str == 0) {
        // 0x80dd0e7
        return;
    }
    int32_t v1 = strlen(str) - 1;
    if (v1 < 0) {
        // 0x80dd0e7
        return;
    }
    int32_t v2 = v1;
    char * v3 = (char *)(v2 + (int32_t)str); // 0x80dd0cd
    while (*v3 < 33) {
        // 0x80dd0d4
        *v3 = 0;
        v2--;
        if (v2 < 0) {
            // break -> 0x80dd0e7
            break;
        }
        v3 = (char *)(v2 + (int32_t)str);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharUtils.c
// Address range: 0x80dd25e - 0x80dd62a
// Line range:    399 - 486
void LYFillLocalFileURL(char ** href, char * base) {
    int32_t v1 = __readgsdword(20); // 0x80dd279
    char * v2 = NULL; // bp-268, 0x80dd284
    char * str = *href; // 0x80dd294
    if (str == NULL) {
        goto lab_0x80dd617;
    } else {
        // 0x80dd29e
        if (*str == 0) {
            goto lab_0x80dd617;
        } else {
            // 0x80dd2b1
            if (strcmp(str, "//") == 0) {
                if (base == NULL) {
                    goto lab_0x80dd386;
                } else {
                    goto lab_0x80dd302;
                }
            } else {
                // 0x80dd2cd
                if (base == NULL | strncmp(*href, "///", 3) != 0) {
                    goto lab_0x80dd386;
                } else {
                    goto lab_0x80dd302;
                }
            }
        }
    }
  lab_0x80dd617:
    // 0x80dd617
    if (v1 != __readgsdword(20)) {
        // 0x80dd623
        __stack_chk_fail();
    }
  lab_0x80dd386:;
    char * v3 = *href;
    char v4 = *v3; // 0x80dd38e
    if (v4 != 102 != v4 != 70) {
        // 0x80dd3a8
        if (strncasecomp(v3, "file:", 5) == 0) {
            char * str2 = *href;
            if (*(char *)((int32_t)str2 + 5) != 0) {
                // 0x80dd3fd
                if (strcmp(str2, "file://") != 0) {
                    int32_t strncmp_rc = strncmp(*href, "file:///", 8); // 0x80dd44f
                    char * str3 = *href;
                    if (strncmp_rc != 0) {
                        // 0x80dd48f
                        if (strncmp(str3, "file:/", 6) == 0) {
                            int32_t v5 = (int32_t)*href;
                            if (*(char *)(v5 + 6) != 47) {
                                // 0x80dd4c5
                                HTSACopy(&v2, (char *)(v5 + 5));
                                LYLocalFileToURL(href, v2);
                            }
                        }
                    } else {
                        // 0x80dd458
                        HTSACopy(&v2, (char *)((int32_t)str3 + 7));
                        LYLocalFileToURL(href, v2);
                    }
                } else {
                    // 0x80dd419
                    HTSACat(href, "localhost");
                }
            } else {
                // 0x80dd3e2
                HTSACat(href, "//localhost");
            }
        }
    }
    // 0x80dd4fa
    char * str4; // 0x80dd52b
    if (strcmp(*href, "file://localhost") != 0) {
        goto lab_0x80dd5f5;
    } else {
        // 0x80dd51a
        int32_t v6; // bp-264, 0x80dd25e
        char * v7 = Current_Dir((char *)&v6); // 0x80dd523
        str4 = wwwName(v7);
        if (*str4 != 47) {
            // 0x80dd543
            LYAddHtmlSep(href);
        }
        // 0x80dd551
        if (strchr(str4, 37) != NULL) {
            goto lab_0x80dd585;
        } else {
            // 0x80dd56b
            if (strchr(str4, 35) == NULL) {
                // 0x80dd5dd
                HTSACat(href, str4);
                goto lab_0x80dd5f5;
            } else {
                goto lab_0x80dd585;
            }
        }
    }
  lab_0x80dd302:;
    char v8 = *base; // 0x80dd308
    if (v8 != 102 != v8 != 70) {
        // 0x80dd31c
        if (strncasecomp(base, "file:", 5) == 0) {
            // 0x80dd33e
            HTSACopy(&v2, "file:");
            HTSACat(&v2, *href);
            HTSACopy(href, v2);
        }
    }
    goto lab_0x80dd386;
  lab_0x80dd5f5:
    // 0x80dd5f5
    if (v2 != NULL) {
        // 0x80dd5ff
        free((int32_t *)v2);
        v2 = NULL;
    }
    goto lab_0x80dd617;
  lab_0x80dd585:;
    char * v9 = v2; // 0x80dd585
    if (v9 != NULL) {
        // 0x80dd58f
        free((int32_t *)v9);
        v2 = NULL;
    }
    char * v10 = HTEscape(str4, 4); // 0x80dd5b8
    v2 = v10;
    HTSACat(href, v10);
    goto lab_0x80dd5f5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharUtils.c
// Address range: 0x80dd62a - 0x80dd691
// Line range:    515 - 548
void LYAddMETAcharsetToFD(struct _IO_FILE * fd, int32_t disp_chndl) {
    int32_t v1 = disp_chndl != -1 ? disp_chndl : current_char_set;
    if (UCLYhndl_HTFile_for_unspec == v1 || fd == NULL || v1 < 0) {
        // 0x80dd68f
        return;
    }
    int32_t v2 = 32 * v1; // 0x80dd657
    if (*(int32_t *)(v2 + (int32_t)&g144) != 0) {
        int32_t v3 = *(int32_t *)(v2 + (int32_t)&g143); // 0x80dd66a
        fprintf(fd, "<META %s content=\"text/html;charset=%s\">\n", "http-equiv=\"content-type\"", (char *)v3);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharUtils.c
// Address range: 0x80de7c5 - 0x80dea10
// Line range:    937 - 978
char * UCPutUtf8ToBuffer(char * q, uint32_t code, char terminate) {
    // 0x80de7c5
    if (q == NULL || code < 128 || code == 0x7fffffff) {
        // 0x80dea0b
        return NULL;
    }
    int32_t v1; // 0x80de7c5
    if (code > 2047) {
        if (code > 0xffff) {
            if (code > 0x1fffff) {
                if (code > 0x3ffffff) {
                    // 0x80de962
                    *q = (char)(code / 0x40000000) | -4;
                    int32_t v2 = (int32_t)q; // 0x80de972
                    *(char *)(v2 + 1) = (char)(code / 0x1000000) % 64 | -128;
                    *(char *)(v2 + 2) = (char)(code / 0x40000) % 64 | -128;
                    *(char *)(v2 + 3) = (char)(code / 0x1000) % 64 | -128;
                    *(char *)(v2 + 4) = (char)(code / 64) % 64 | -128;
                    *(char *)(v2 + 5) = (char)code % 64 | -128;
                    v1 = v2 + 6;
                } else {
                    // 0x80de8f0
                    *q = (char)(code / 0x1000000) | -8;
                    int32_t v3 = (int32_t)q; // 0x80de900
                    *(char *)(v3 + 1) = (char)(code / 0x40000) % 64 | -128;
                    *(char *)(v3 + 2) = (char)(code / 0x1000) % 64 | -128;
                    *(char *)(v3 + 3) = (char)(code / 64) % 64 | -128;
                    *(char *)(v3 + 4) = (char)code % 64 | -128;
                    v1 = v3 + 5;
                }
            } else {
                // 0x80de88c
                *q = (char)(code / 0x40000) | -16;
                int32_t v4 = (int32_t)q; // 0x80de89c
                *(char *)(v4 + 1) = (char)(code / 0x1000) % 64 | -128;
                *(char *)(v4 + 2) = (char)(code / 64) % 64 | -128;
                *(char *)(v4 + 3) = (char)code % 64 | -128;
                v1 = v4 + 4;
            }
        } else {
            // 0x80de83f
            *q = (char)(code / 0x1000) | -32;
            int32_t v5 = (int32_t)q; // 0x80de84f
            *(char *)(v5 + 1) = (char)(code / 64) % 64 | -128;
            *(char *)(v5 + 2) = (char)code % 64 | -128;
            v1 = v5 + 3;
        }
    } else {
        // 0x80de809
        *q = (char)(code / 64) | -64;
        int32_t v6 = (int32_t)q; // 0x80de819
        *(char *)(v6 + 1) = (char)code % 64 | -128;
        v1 = v6 + 2;
    }
    char * v7 = (char *)v1;
    char * result = v7; // 0x80de9ea
    if (terminate != 0) {
        // 0x80de9f7
        *v7 = 0;
        result = q;
    }
    // 0x80dea0b
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharUtils.c
// Address range: 0x80dea10 - 0x80e0715
// Line range:    1073 - 2021
char ** LYUCFullyTranslateString(char ** str, int32_t cs_from, int32_t cs_to, char do_ent, char use_lynx_specials, char plain_space, char hidden, char Back, int32_t stype) {
    char replace_buf[64]; // bp-88, 0x80dea10
    char v1[64]; // 0x80debb3
    int32_t v2 = __readgsdword(20); // 0x80dea56
    char * name = NULL; // bp-148, 0x80dea98
    char ** v3 = NULL; // 0x80deab3
    int32_t str7; // bp-84, 0x80dea10
    if (str == NULL) {
        goto lab_0x80e06f3;
    } else {
        char * v4 = *str;
        v3 = str;
        if (v4 == NULL) {
            goto lab_0x80e06f3;
        } else {
            // 0x80deac1
            v3 = str;
            if (*v4 != 0) {
                // 0x80deae1
                memset(&str7, 0, 64);
                if (HTCJK == 0) {
                    goto lab_0x80deb4b;
                } else {
                    int32_t str2 = *(int32_t *)(32 * cs_from + (int32_t)&g143); // 0x80deb0b
                    if (strcmp((char *)str2, "utf-8") == 0) {
                        goto lab_0x80deb4b;
                    } else {
                        int32_t str3 = *(int32_t *)(32 * cs_to + (int32_t)&g143); // 0x80deb2b
                        if (strcmp((char *)str3, "utf-8") == 0) {
                            goto lab_0x80deb4b;
                        } else {
                            // 0x80deb45
                            replace_buf = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                            goto lab_0x80debb6;
                        }
                    }
                }
            } else {
                goto lab_0x80e06f3;
            }
        }
    }
  lab_0x80dfe64:;
    int32_t v5; // 0x80dea10
    int32_t v6; // 0x80dea10
    int32_t v7; // 0x80dea10
    int32_t v8; // 0x80dea10
    char v9; // 0x80dea10
    char v10; // 0x80dea10
    char * v11; // 0x80dea10
    char * v12; // 0x80dea10
    char * v13; // 0x80dea10
    char * v14; // 0x80dea10
    char * v15; // 0x80dea10
    char * v16; // 0x80dea10
    char * v17; // 0x80dea10
    char * v18; // 0x80dea10
    char * v19; // 0x80dea10
    char * v20; // 0x80dea10
    char v21; // 0x80dea10
    char v22; // 0x80dea10
    int32_t v23; // 0x80dea10
    int32_t v24; // 0x80dea10
    char v25; // 0x80dea10
    int32_t v26; // 0x80ded5f
    int32_t v27; // 0x80e05de
    char * v28; // 0x80e05e1
    if (v16 != (char *)3 == (v16 != (char *)2)) {
        if (v16 != (char *)4) {
            if (hidden == 0 == stype == 0 == v25 == 0) {
                // 0x80dff09
                if (HTPassEightBitRaw == 0) {
                    goto lab_0x80dff22;
                } else {
                    // 0x80dff14
                    if (v26 > (int32_t)*v28) {
                        goto lab_0x80dff22;
                    } else {
                        goto lab_0x80dff4b;
                    }
                }
            } else {
                goto lab_0x80dff4b;
            }
        } else {
            // 0x80dfecd
            *v20 = v22;
            *v12 = 38;
            name = (char *)19;
            v19 = v20;
            v17 = v18;
            v21 = v22;
            v23 = v24;
            v7 = v8;
            v15 = v16;
            v9 = v10;
            v5 = v6;
            v11 = (char *)((int32_t)v12 + 1);
            v13 = v14;
            goto lab_0x80e05de;
        }
    } else {
        // 0x80dfe76
        *v12 = 38;
        int32_t v29 = (int32_t)v12; // 0x80dfe7c
        *(char *)(v29 + 1) = 35;
        char * v30 = (char *)(v29 + 2); // 0x80dfe86
        char * v31 = v30; // 0x80dfe91
        if (v16 == (char *)2) {
            // 0x80dfe93
            *v30 = 120;
            v31 = (char *)(v29 + 3);
        }
        // 0x80dfe9d
        if (v22 != 0) {
            // 0x80dfea3
            *(char *)(v27 - 1) = v22;
        }
        // 0x80dfeaf
        name = (char *)19;
        v19 = v20;
        v17 = v18;
        v21 = v22;
        v23 = v24;
        v7 = v8;
        v15 = v16;
        v9 = (int32_t)v20;
        v5 = v6;
        v11 = v31;
        v13 = v14;
        goto lab_0x80e05de;
    }
  lab_0x80e05c6:;
    // 0x80e05c6
    char * v32; // 0x80dea10
    char * v33 = v32; // 0x80e05c6
    char v34 = v10 + 1; // 0x80e05c6
    char * v35; // 0x80dea10
    char * v36 = v35; // 0x80e05c6
    char * v37; // 0x80dea10
    char * v38 = v37; // 0x80e05c6
    goto lab_0x80e05ca;
  lab_0x80e05ca:
    // 0x80e05ca
    name = NULL;
    v19 = v20;
    v17 = v33;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = NULL;
    v9 = v34;
    v5 = v6;
    v11 = v36;
    v13 = v38;
    goto lab_0x80e05de;
  lab_0x80e05de:;
    char * v39 = v19; // 0x80dea10
    char * v40 = v17; // 0x80dea10
    char v41 = v21; // 0x80dea10
    int32_t v42 = v23; // 0x80dea10
    int32_t v43 = v7; // 0x80dea10
    char * v44 = v15; // 0x80dea10
    char v45 = v9; // 0x80dea10
    int32_t v46 = v5; // 0x80dea10
    char * v47 = v11; // 0x80dea10
    char * v48 = v13; // 0x80dea10
    goto lab_0x80e05de_2;
  lab_0x80defcc:
    // 0x80defcc
    name = (char *)4;
    *v12 = *v28;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10 + 1;
    v5 = v6;
    v11 = (char *)((int32_t)v12 + 1);
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df082:
    // 0x80df082
    name = NULL;
    *v12 = *v28;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10 + 1;
    v5 = v6;
    v11 = (char *)((int32_t)v12 + 1);
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df1ff:;
    // 0x80df1ff
    char v67; // 0x80dea10
    *v12 = v67;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10 + 1;
    v5 = v6;
    v11 = (char *)((int32_t)v12 + 1);
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80dfade:
    // 0x80dfade
    name = (char *)12;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80e003d:
    // 0x80e003d
    UCPutUtf8ToBuffer((char *)&str7, v24, 1);
    name = (char *)14;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80e03d6:;
    char v143; // 0x80dea10
    if (hidden == 0 == v24 == 10) {
        char v162 = *(char *)(int32_t)v143; // 0x80e03e8
        if (v12 == v14 || v162 != 10) {
            goto lab_0x80e0425;
        } else {
            char * v163 = (char *)((int32_t)v12 - 1); // 0x80e03fd
            if (*v163 != 13) {
                goto lab_0x80e0425;
            } else {
                // 0x80e0404
                *v163 = v162;
                name = (char *)19;
                v19 = v20;
                v17 = v18;
                v21 = v22;
                v23 = 10;
                v7 = v8;
                v15 = v16;
                v9 = v143 + 1;
                v5 = v6;
                v11 = v12;
                v13 = v14;
                goto lab_0x80e05de;
            }
        }
    } else {
        goto lab_0x80e0425;
    }
  lab_0x80df7b1:;
    // 0x80df7b1
    char v89; // 0x80dea10
    int32_t len2; // 0x80df71d
    if (len2 < 3 || v89 != 35) {
        goto lab_0x80df81a;
    } else {
        // 0x80df7c7
        if (*(char *)(v27 + 2) < 127) {
            int16_t ** v164 = __ctype_b_loc(); // 0x80df7d7
            int16_t * v165 = *v164; // 0x80df7dc
            char * v166; // 0x80df7d0
            unsigned char v167 = *v166; // 0x80df7e7
            int16_t v168 = *(int16_t *)(2 * (int32_t)v167 + (int32_t)v165); // 0x80df7f2
            if ((v168 & 2048) == 0) {
                // 0x80df7d7
                goto lab_0x80df81a;
            } else {
                // 0x80df801
                name = (char *)8;
                v19 = v20;
                v17 = v18;
                v21 = v22;
                v23 = v24;
                v7 = v8;
                v15 = (char *)3;
                v9 = v10;
                v5 = len2;
                v11 = v12;
                v13 = v14;
                goto lab_0x80e05de;
            }
        } else {
            goto lab_0x80df81a;
        }
    }
  lab_0x80df978:
    // 0x80df978
    name = (char *)12;
    char * str6; // 0x80dea10
    v19 = str6;
    v17 = v18;
    char v108; // 0x80dea10
    v21 = v108;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    char v111; // 0x80dea10
    v9 = v111;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df971:;
    // 0x80df971
    int32_t lowest_8; // bp-132, 0x80dea10
    int32_t v169 = lowest_8; // 0x80df971
    if (v169 >= 0) {
        int32_t v170 = v169; // 0x80df991
        if (v169 != 1 != v169 > 155) {
            // 0x80df9b7
            g377 = v169;
            v170 = v169;
            switch (v169) {
                case 1: {
                    // 0x80df9c5
                    v170 = 0x263a;
                    // break -> 0x80dfa7a
                    break;
                }
                case 128: {
                    // 0x80df9d1
                    v170 = 0x20ac;
                    // break -> 0x80dfa7a
                    break;
                }
                case 130: {
                    // 0x80df9dd
                    v170 = 0x201a;
                    // break -> 0x80dfa7a
                    break;
                }
                case 132: {
                    // 0x80df9e9
                    v170 = 0x201e;
                    // break -> 0x80dfa7a
                    break;
                }
                case 133: {
                    // 0x80df9f5
                    v170 = 0x2026;
                    // break -> 0x80dfa7a
                    break;
                }
                case 134: {
                    // 0x80df9fe
                    v170 = 0x2020;
                    // break -> 0x80dfa7a
                    break;
                }
                case 135: {
                    // 0x80dfa07
                    v170 = 0x2021;
                    // break -> 0x80dfa7a
                    break;
                }
                case 137: {
                    // 0x80dfa10
                    v170 = 0x2030;
                    // break -> 0x80dfa7a
                    break;
                }
                case 139: {
                    // 0x80dfa19
                    v170 = 0x2039;
                    // break -> 0x80dfa7a
                    break;
                }
                case 145: {
                    // 0x80dfa22
                    v170 = 0x2018;
                    // break -> 0x80dfa7a
                    break;
                }
                case 146: {
                    // 0x80dfa2b
                    v170 = 0x2019;
                    // break -> 0x80dfa7a
                    break;
                }
                case 147: {
                    // 0x80dfa34
                    v170 = 0x201c;
                    // break -> 0x80dfa7a
                    break;
                }
                case 148: {
                    // 0x80dfa3d
                    v170 = 0x201d;
                    // break -> 0x80dfa7a
                    break;
                }
                case 149: {
                    // 0x80dfa46
                    v170 = 0x2022;
                    // break -> 0x80dfa7a
                    break;
                }
                case 150: {
                    // 0x80dfa4f
                    v170 = 0x2013;
                    // break -> 0x80dfa7a
                    break;
                }
                case 151: {
                    // 0x80dfa58
                    v170 = 0x2014;
                    // break -> 0x80dfa7a
                    break;
                }
                case 152: {
                    // 0x80dfa61
                    v170 = 732;
                    // break -> 0x80dfa7a
                    break;
                }
                case 153: {
                    // 0x80dfa6a
                    v170 = 0x2122;
                    // break -> 0x80dfa7a
                    break;
                }
                case 155: {
                    // 0x80dfa73
                    v170 = 0x203a;
                    // break -> 0x80dfa7a
                    break;
                }
            }
        }
        // 0x80dfa7a
        name = (char *)9;
        v19 = str6;
        v17 = v18;
        v21 = v108;
        v23 = v170;
        v7 = v8;
        v15 = v16;
        v9 = v111;
        v5 = v6;
        v11 = v12;
        v13 = v14;
        goto lab_0x80e05de;
    } else {
        goto lab_0x80df978;
    }
  lab_0x80dfac4:
    if ((v24 & -32) == 128) {
        // 0x80dfad3
        if (HTPassHighCtrlNum != 0) {
            goto lab_0x80dfaed;
        } else {
            goto lab_0x80dfade;
        }
    } else {
        goto lab_0x80dfaed;
    }
  lab_0x80e0066:
    // 0x80e0066
    name = (char *)16;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80e014a:;
    char * v171 = v18; // 0x80e0150
    if (v12 != v14) {
        char * v172; // 0x80dea10
        int32_t v173; // 0x80dea10
        if (v18 != NULL) {
            // 0x80e018f
            v172 = v18;
            v173 = (int32_t)v18;
        } else {
            int32_t * v174 = HTChunkCreate2(128, v6 + 1); // 0x80e017c
            v172 = (char *)v174;
            v173 = (int32_t)v174;
        }
        // 0x80e0198
        HTChunkPutb((int32_t *)v173, v14, (int32_t)v12 - (int32_t)v14);
        v171 = v172;
    }
    char * v175 = v171;
    char * v176; // 0x80dea10
    int32_t v177; // 0x80dea10
    if (v175 != NULL) {
        // 0x80e01e4
        v176 = v175;
        v177 = (int32_t)v175;
    } else {
        int32_t * v178 = HTChunkCreate2(128, v6 + 1); // 0x80e01d1
        v176 = (char *)v178;
        v177 = (int32_t)v178;
    }
    // 0x80e01ed
    HTChunkPuts((int32_t *)v177, (char *)&str7);
    char * v179 = *str;
    name = (char *)18;
    v19 = v20;
    v17 = v176;
    v21 = v22;
    int32_t v128; // 0x80dea10
    v23 = v128;
    v7 = v8;
    v15 = v16;
    char v127; // 0x80dea10
    v9 = v127;
    v5 = v6;
    v11 = v179;
    v13 = v179;
    goto lab_0x80e05de;
  lab_0x80e0425:
    // 0x80e0425
    *v12 = (char)v24;
    name = (char *)18;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v143;
    v5 = v6;
    v11 = (char *)((int32_t)v12 + 1);
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80e03c7:
    // 0x80e03c7
    name = (char *)17;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v143;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df54d:;
    // 0x80df54d
    int32_t v78; // 0x80dea10
    int32_t v180 = v78;
    bool v181; // 0x80dea10
    int32_t len; // bp-144, 0x80dea10
    bool v182; // 0x80dea10
    char * v183; // 0x80dea10
    int32_t v184; // 0x80dea10
    int32_t * v86; // 0x80dea10
    int32_t * v87; // 0x80dea10
    if (v181) {
        if (v182) {
            goto lab_0x80df63c;
        } else {
            if (v180 != 160 == (v180 != 173)) {
                goto lab_0x80df63c;
            } else {
                // 0x80df5d4
                if (*v86 == 2) {
                    goto lab_0x80df5ff;
                } else {
                    // 0x80df5e5
                    if ((char)*v87 > -1) {
                        goto lab_0x80df63c;
                    } else {
                        goto lab_0x80df5ff;
                    }
                }
            }
        }
    } else {
        // 0x80df553
        v184 = v180;
        v183 = v16;
        if (*v28 > 191) {
            // 0x80df56c
            len = v27;
            int32_t v185 = UCGetUniFromUtf8String((char **)&len); // 0x80df57e
            v184 = v185;
            v183 = (char *)1;
            if (v185 >= 0 != v185 != 0) {
                // 0x80df58c
                v184 = (int32_t)*v28;
                v183 = v16;
            }
        }
        goto lab_0x80df690;
    }
  lab_0x80df81a:;
    // 0x80df81a
    char * str5; // 0x80df71d
    if (v89 < 127) {
        int16_t v186 = *(int16_t *)(2 * (int32_t)*str5 + (int32_t)*__ctype_b_loc()); // 0x80df83f
        if ((v186 & 1024) == 0) {
            goto lab_0x80df867;
        } else {
            // 0x80df84e
            name = (char *)10;
            v19 = v20;
            v17 = v18;
            v21 = v22;
            v23 = v24;
            v7 = v8;
            v15 = (char *)4;
            v9 = v10;
            v5 = len2;
            v11 = v12;
            v13 = v14;
            goto lab_0x80e05de;
        }
    } else {
        goto lab_0x80df867;
    }
  lab_0x80dfaed:;
    int32_t * v84; // 0x80dea10
    int32_t v187; // 0x80dea10
    int32_t * v85; // 0x80dea10
    if (stype != 1 || v24 < 160) {
        if (v24 != 160) {
            goto lab_0x80dfbe8;
        } else {
            if (plain_space == 0) {
                if (use_lynx_specials == 0) {
                    if (hidden != 0 == Back == 0) {
                        goto lab_0x80dfbab;
                    } else {
                        // 0x80dfb68
                        if ((*(int32_t *)(v187 + (int32_t)&g143) & 2) != 0) {
                            goto lab_0x80dfbab;
                        } else {
                            // 0x80dfb80
                            if (*v84 == 2) {
                                goto lab_0x80dfbab;
                            } else {
                                // 0x80dfb91
                                if ((char)*v85 > -1) {
                                    // 0x80dfbba
                                    int32_t * v188; // 0x80dea10
                                    int32_t v189 = *v188; // 0x80dfbc5
                                    if ((v189 & 2) != 0) {
                                        goto lab_0x80dfbe8;
                                    } else {
                                        // 0x80dfbd2
                                        name = (char *)16;
                                        v19 = v20;
                                        v17 = v18;
                                        v21 = v22;
                                        v23 = 32;
                                        v7 = v8;
                                        v15 = v16;
                                        v9 = v10;
                                        v5 = v6;
                                        v11 = v12;
                                        v13 = v14;
                                        goto lab_0x80e05de;
                                    }
                                } else {
                                    goto lab_0x80dfbab;
                                }
                            }
                        }
                    }
                } else {
                    // 0x80dfb40
                    name = (char *)16;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = 1;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10;
                    v5 = v6;
                    v11 = v12;
                    v13 = v14;
                    goto lab_0x80e05de;
                }
            } else {
                // 0x80dfb21
                name = (char *)16;
                v19 = v20;
                v17 = v18;
                v21 = v22;
                v23 = 32;
                v7 = v8;
                v15 = v16;
                v9 = v10;
                v5 = v6;
                v11 = v12;
                v13 = v14;
                goto lab_0x80e05de;
            }
        }
    } else {
        // 0x80dfafc
        name = (char *)13;
        v19 = v20;
        v17 = v18;
        v21 = v22;
        v23 = v24;
        v7 = v8;
        v15 = v16;
        v9 = v10;
        v5 = v6;
        v11 = v12;
        v13 = v14;
        goto lab_0x80e05de;
    }
  lab_0x80dff4b:
    // 0x80dff4b
    len = v27;
    name = (char *)16;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = (int32_t)*v28;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80e013b:
    // 0x80e013b
    name = (char *)15;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    int32_t v130; // 0x80e0117
    v23 = v130;
    v7 = v8;
    v15 = v16;
    v9 = v127;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df867:
    // 0x80df867
    name = (char *)6;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = len2;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80dff22:
    // 0x80dff22
    sprintf((char *)&str7, "U%.2lX", v24);
    name = (char *)14;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df63c:
    if (v25 == 0) {
        // 0x80df676
        v184 = v180;
        v183 = v16;
        if (v25 != 0) {
            goto lab_0x80df690;
        } else {
            // 0x80df681
            name = (char *)16;
            v19 = v20;
            v17 = v18;
            v21 = v22;
            v23 = v180;
            v7 = v8;
            v15 = v16;
            v9 = v10;
            v5 = v6;
            v11 = v12;
            v13 = v14;
            goto lab_0x80e05de;
        }
    } else {
        int32_t v190 = UCTransToUni(*v28, cs_from); // 0x80df65a
        v184 = v190;
        v183 = v16;
        if (v190 >= 0 != v190 != 0) {
            // 0x80df668
            v184 = (int32_t)*v28;
            v183 = v16;
        }
        goto lab_0x80df690;
    }
  lab_0x80df690:;
    char * v191 = v183;
    int32_t v192 = v184;
    if (v182) {
        goto lab_0x80df6eb;
    } else {
        if (v192 != 160 == (v192 != 173)) {
            goto lab_0x80df6eb;
        } else {
            // 0x80df6b4
            name = (char *)16;
            v19 = v20;
            v17 = v18;
            v21 = v22;
            v23 = v192 != 160 ? 7 : 1;
            v7 = v8;
            v15 = v191;
            v9 = v10;
            v5 = v6;
            v11 = v12;
            v13 = v14;
            goto lab_0x80e05de;
        }
    }
  lab_0x80df346:
    // 0x80df346
    name = (char *)16;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = 173;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df2b2:
    // 0x80df2b2
    name = (char *)16;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = 160;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80dfbe8:
    if (v24 != 173) {
        goto lab_0x80dfc85;
    } else {
        if (plain_space == 0) {
            if (Back == 0) {
                goto lab_0x80dfc45;
            } else {
                // 0x80dfc1a
                int32_t * v193; // 0x80dea10
                int32_t v194 = *v193; // 0x80dfc20
                if (v194 == 2) {
                    goto lab_0x80dfc45;
                } else {
                    int32_t v195 = *v85; // 0x80dfc36
                    if ((char)v195 > -1) {
                        goto lab_0x80dfc85;
                    } else {
                        goto lab_0x80dfc45;
                    }
                }
            }
        } else {
            // 0x80dfbfe
            str7 = 0;
            name = (char *)14;
            v19 = v20;
            v17 = v18;
            v21 = v22;
            v23 = v24;
            v7 = v8;
            v15 = v16;
            v9 = v10;
            v5 = v6;
            v11 = v12;
            v13 = v14;
            goto lab_0x80e05de;
        }
    }
  lab_0x80df6eb:
    // 0x80df6eb
    name = (char *)9;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v192;
    v7 = v8;
    v15 = v191;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df4d6:
    // 0x80df4d6
    name = (char *)16;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df41a:;
    int32_t v80 = v24; // 0x80df438
    int32_t * str4; // 0x80dea10
    if (strcmp((char *)*str4, "shift_jis") != 0) {
        goto lab_0x80df4e5;
    } else {
        char v196 = *(char *)(v27 + 1); // 0x80df444
        v80 = v24;
        if (v196 != 127 == v196 < 253) {
            unsigned char v197 = *v28; // 0x80df470
            v80 = v24;
            if ((v197 & -16) == -32 || v197 < 160 == v197 < 0 == (v197 != -128)) {
                goto lab_0x80df495;
            } else {
                goto lab_0x80df4e5;
            }
        } else {
            goto lab_0x80df4e5;
        }
    }
  lab_0x80dfc85:;
    int32_t v198 = UCTransUniChar(v24, cs_to); // 0x80dfc92
    char * v199 = (char *)v198; // 0x80dfc97
    if (v198 < 32 || v199 > (char *)255) {
        goto lab_0x80dfccc;
    } else {
        char * v200; // 0x80ded66
        if (v199 >= (char *)127 == v199 < v200) {
            goto lab_0x80dfccc;
        } else {
            // 0x80dfcb7
            name = (char *)16;
            v19 = v20;
            v17 = v18;
            v21 = v22;
            v23 = v198;
            v7 = v8;
            v15 = v16;
            v9 = v10;
            v5 = v6;
            v11 = v12;
            v13 = v14;
            goto lab_0x80e05de;
        }
    }
  lab_0x80df5ff:;
    int32_t v201; // 0x80dea10
    if (v180 != 160) {
        // 0x80df617
        v201 = v180;
        if (v180 == 173) {
            // 0x80df620
            *v28 = 7;
            v201 = 7;
        }
    } else {
        // 0x80df608
        *v28 = 1;
        v201 = 1;
    }
    // 0x80df62d
    name = (char *)16;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v201;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80df4e5:;
    int32_t v202 = UCReverseTransChar(*v28, cs_to, cs_from); // 0x80df4ff
    v78 = v80;
    if (v202 < 128) {
        goto lab_0x80df54d;
    } else {
        // 0x80df513
        *v28 = (char)v202;
        name = (char *)16;
        v19 = v20;
        v17 = v18;
        v21 = v22;
        v23 = v202;
        v7 = v8;
        v15 = v16;
        v9 = v10;
        v5 = v6;
        v11 = v12;
        v13 = v14;
        goto lab_0x80e05de;
    }
  lab_0x80dfccc:
    if (v199 == (char *)-4) {
        goto lab_0x80dfce4;
    } else {
        char v203; // 0x80dea10
        if (v199 > (char *)31 || v203 == 0 || v199 < (char *)1) {
            goto lab_0x80dfd2a;
        } else {
            goto lab_0x80dfce4;
        }
    }
  lab_0x80df495:
    // 0x80df495
    name = (char *)9;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = UCTransJPToUni(v28, 2, cs_from);
    v7 = v8;
    v15 = v16;
    v9 = v10 + 1;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80dfce4:;
    int32_t v204 = UCTransUniCharStr((char *)&str7, 60, v24, cs_to, 0); // 0x80dfd08
    if (v204 < 0) {
        goto lab_0x80dfd2a;
    } else {
        // 0x80dfd1b
        name = (char *)14;
        v19 = v20;
        v17 = v18;
        v21 = v22;
        v23 = v24;
        v7 = v8;
        v15 = v16;
        v9 = v10;
        v5 = v6;
        v11 = v12;
        v13 = v14;
        goto lab_0x80e05de;
    }
  lab_0x80dfc45:
    if ((Back || hidden) == 0) {
        if (use_lynx_specials == 0) {
            goto lab_0x80dfc85;
        } else {
            // 0x80dfc6f
            name = (char *)16;
            v19 = v20;
            v17 = v18;
            v21 = v22;
            v23 = 7;
            v7 = v8;
            v15 = v16;
            v9 = v10;
            v5 = v6;
            v11 = v12;
            v13 = v14;
            goto lab_0x80e05de;
        }
    } else {
        // 0x80dfc57
        name = (char *)16;
        v19 = v20;
        v17 = v18;
        v21 = v22;
        v23 = v24;
        v7 = v8;
        v15 = v16;
        v9 = v10;
        v5 = v6;
        v11 = v12;
        v13 = v14;
        goto lab_0x80e05de;
    }
  lab_0x80dfbab:
    // 0x80dfbab
    name = (char *)16;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80dfd2a:;
    char v205; // 0x80dea10
    if (v24 == 0x7fffffff || v205 == 0 || v24 < 128) {
        if ((v24 || 1) != 0x2003 == (v24 != 0x2009)) {
            if (v24 > 0x200e == (v24 != 0x200f)) {
                if (v24 < 256) {
                    if (v24 < 161) {
                        goto lab_0x80dfe55;
                    } else {
                        char v206 = HTPassEightBitNum; // 0x80dfe40
                        if (v206 != 0) {
                            goto lab_0x80dfe55;
                        } else {
                            int32_t v207 = LATIN1; // 0x80dfe4b
                            if (v207 != cs_to) {
                                goto lab_0x80dfe64;
                            } else {
                                goto lab_0x80dfe55;
                            }
                        }
                    }
                } else {
                    // 0x80dfe1f
                    name = (char *)12;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v24;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10;
                    v5 = v6;
                    v11 = v12;
                    v13 = v14;
                    goto lab_0x80e05de;
                }
            } else {
                char v208 = WWW_TraceFlag; // 0x80dfdda
                if (v208 != 0) {
                    // 0x80dfde5
                    fprintf(TraceFP(), "LYUCFullyTranslateString: Ignoring '%ld'.\n", v24);
                }
                // 0x80dfe03
                str7 = 0;
                name = (char *)14;
                v19 = v20;
                v17 = v18;
                v21 = v22;
                v23 = v24;
                v7 = v8;
                v15 = v16;
                v9 = v10;
                v5 = v6;
                v11 = v12;
                v13 = v14;
                goto lab_0x80e05de;
            }
        } else {
            if (hidden == 0) {
                // 0x80dfd81
                name = (char *)16;
                v19 = v20;
                v17 = v18;
                v21 = v22;
                int32_t v209; // 0x80dea10
                v23 = v209;
                v7 = v8;
                v15 = v16;
                v9 = v10;
                v5 = v6;
                v11 = v12;
                v13 = v14;
            } else {
                // 0x80dfd72
                name = (char *)12;
                v19 = v20;
                v17 = v18;
                v21 = v22;
                v23 = v24;
                v7 = v8;
                v15 = v16;
                v9 = v10;
                v5 = v6;
                v11 = v12;
                v13 = v14;
            }
            goto lab_0x80e05de;
        }
    } else {
        // 0x80dfd3f
        name = (char *)13;
        v19 = v20;
        v17 = v18;
        v21 = v22;
        v23 = v24;
        v7 = v8;
        v15 = v16;
        v9 = v10;
        v5 = v6;
        v11 = v12;
        v13 = v14;
        goto lab_0x80e05de;
    }
  lab_0x80dfe55:
    // 0x80dfe55
    name = (char *)16;
    v19 = v20;
    v17 = v18;
    v21 = v22;
    v23 = v24;
    v7 = v8;
    v15 = v16;
    v9 = v10;
    v5 = v6;
    v11 = v12;
    v13 = v14;
    goto lab_0x80e05de;
  lab_0x80e06f3:;
    int32_t v210 = (int32_t)v3; // 0x80e0703
    if (v2 != __readgsdword(20)) {
        // 0x80e0705
        __stack_chk_fail();
        v210 = &g391;
    }
    // 0x80e070a
    return (char **)v210;
  lab_0x80deb4b:;
    char v211; // 0x80dea10
    if (cs_from != cs_to || cs_to >= 0 == (cs_to != 0)) {
        if ((Back || use_lynx_specials) == 0) {
            // 0x80deb80
            v211 = 1;
            if (UCNeedNotTranslate(cs_from, cs_to) == 0) {
                // 0x80deba2
                v211 = 0;
                goto lab_0x80debac;
            } else {
                goto lab_0x80debac;
            }
        } else {
            // 0x80deba2
            v211 = 0;
            goto lab_0x80debac;
        }
    } else {
        if (Back == 0 || cs_to < 0) {
            // 0x80deb68
            replace_buf = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
            goto lab_0x80debb6;
        } else {
            // 0x80deba2
            v211 = 0;
            goto lab_0x80debac;
        }
    }
  lab_0x80debac:
    // 0x80debac
    v1[0] = v211;
    replace_buf = v1;
    goto lab_0x80debb6;
  lab_0x80debb6:;
    char v212 = do_ent; // 0x80debbd
    if (do_ent != 0 && hidden != 0 && stype != 1) {
        // 0x80debce
        v212 = strchr(*str, 38) != NULL ? do_ent : 0;
    }
    // 0x80debf1
    char v53; // 0x80dea10
    if (UCCanTranslateFromTo(cs_from, cs_to) != 0) {
        // 0x80dec40
        v53 = cs_to >= 0 ? v212 : 0;
        goto lab_0x80dec4d;
    } else {
        // 0x80dec07
        v3 = NULL;
        if (cs_to >= 0) {
            if (v212 != 0) {
                // 0x80dec3a
                replace_buf = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                v53 = v212;
                goto lab_0x80dec4d;
            } else {
                // 0x80dec25
                v3 = NULL;
                if (replace_buf[0] == 0) {
                    // 0x80dec3a
                    replace_buf = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                    v53 = v212;
                    goto lab_0x80dec4d;
                } else {
                    goto lab_0x80e06f3;
                }
            }
        } else {
            goto lab_0x80e06f3;
        }
    }
  lab_0x80dec4d:;
    char v213 = replace_buf[0];
    int32_t v214; // 0x80dea10
    char v215; // 0x80dea10
    char v216; // 0x80dea10
    int32_t v217; // 0x80dea10
    char v79; // 0x80dea10
    int32_t v218; // 0x80dea10
    if (v53 != 0) {
        int32_t v219 = (int32_t)*str;
        char v220 = v219; // 0x80dec75
        v215 = v220;
        v218 = v219;
        if (v213 != 0) {
            int32_t v221 = 32 * cs_to;
            int32_t * v222 = (int32_t *)(v221 + (int32_t)&g144);
            v84 = v222;
            v216 = v220;
            v217 = v219;
            v214 = v221;
            v79 = 1;
            v181 = true;
            if (*v222 != 7) {
                // 0x80ded16
                v84 = v222;
                v216 = v220;
                v217 = v219;
                v214 = v221;
                v79 = HText_hasUTF8OutputSet(HTMainText) != 0;
                v181 = true;
            }
            goto lab_0x80ded5c;
        } else {
            goto lab_0x80dec7e;
        }
    } else {
        // 0x80dec56
        v3 = str;
        if (v213 == 0) {
            // 0x80dec6d
            v218 = (int32_t)*str;
            v215 = v218;
            goto lab_0x80dec7e;
        } else {
            goto lab_0x80e06f3;
        }
    }
  lab_0x80dec7e:;
    // 0x80dec7e
    int32_t v81; // bp-172, 0x80dea10
    UCTransParams_clear(&v81);
    int32_t v223 = 32 * cs_to;
    int32_t v224 = 32 * cs_from; // 0x80dec9b
    UCSetTransParams(&v81, cs_from, (int32_t *)(v224 + (int32_t)&LYCharSet_UC), cs_to, (int32_t *)(v223 + (int32_t)&LYCharSet_UC));
    len = 0x1000000 * v218 >> 24;
    v84 = (int32_t *)(v223 + (int32_t)&g144);
    v216 = v215;
    v217 = v218;
    v214 = v223;
    v181 = *(int32_t *)(v224 + (int32_t)&g144) != 7;
    goto lab_0x80ded5c;
  lab_0x80ded5c:
    // 0x80ded5c
    v26 = *(int32_t *)(4 * cs_to + (int32_t)&LYlowest_eightbit);
    char * str8 = (char *)(0x1000000 * v217 >> 24); // 0x80ded6f
    int32_t len3 = strlen(str8); // 0x80ded6f
    v187 = v214 | 16;
    v85 = (int32_t *)(v187 + (int32_t)&g145);
    int32_t v225 = 32 * cs_from;
    v86 = (int32_t *)(v225 + (int32_t)&g144);
    v87 = (int32_t *)((v225 | 16) + (int32_t)&g145);
    str4 = (int32_t *)(v225 + (int32_t)&g143);
    v182 = use_lynx_specials == 0 | Back != 0;
    v39 = NULL;
    v40 = NULL;
    v41 = 0;
    v42 = 0;
    v43 = 0;
    v44 = NULL;
    v45 = v216;
    v46 = len3 + 16;
    v47 = str8;
    v48 = str8;
    while (true) {
      lab_0x80e05de_2:
        // 0x80e05de
        v14 = v48;
        v12 = v47;
        v6 = v46;
        v10 = v45;
        v16 = v44;
        v8 = v43;
        v24 = v42;
        v22 = v41;
        v18 = v40;
        v20 = v39;
        v27 = v10;
        v28 = (char *)v27;
        char * v49 = name;
        if (*v28 == 0) {
            if (v49 != NULL != v49 != (char *)4) {
                // break -> 0x80e0602
                break;
            }
        }
        int32_t v50 = (int32_t)v49; // 0x80ded9b
        g376 = v50;
        v19 = v20;
        v17 = v18;
        v21 = v22;
        v23 = v24;
        v7 = v8;
        v15 = v16;
        v9 = v10;
        v5 = v6;
        v11 = v12;
        v13 = v14;
        v32 = v18;
        v35 = v12;
        v37 = v14;
        v33 = v18;
        v34 = v10;
        v36 = v12;
        v38 = v14;
        switch (v50) {
            case 0: {
                unsigned char v51 = *v28;
                int32_t v52 = v51; // 0x80dedaf
                if (v51 != 27) {
                    // 0x80def17
                    *(int32_t *)&name = v53 == 0 ? 6 : 7;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v52;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10;
                    v5 = v6;
                    v11 = v12;
                    v13 = v14;
                } else {
                    // 0x80dedc6
                    if (stype == 0 == (hidden == 0 != HTCJK != 0)) {
                        if (hidden != 0) {
                            // 0x80def08
                            name = (char *)6;
                            v19 = v20;
                            v17 = v18;
                            v21 = v22;
                            v23 = v52;
                            v7 = v8;
                            v15 = v16;
                            v9 = v10;
                            v5 = v6;
                            v11 = v12;
                            v13 = v14;
                        } else {
                            // 0x80deef9
                            name = (char *)18;
                            v19 = v20;
                            v17 = v18;
                            v21 = v22;
                            v23 = v52;
                            v7 = v8;
                            v15 = v16;
                            v9 = v10;
                            v5 = v6;
                            v11 = v12;
                            v13 = v14;
                        }
                    } else {
                        // 0x80dede2
                        name = (char *)1;
                        if (stype != 1) {
                            if (stype == 0) {
                                // 0x80deed8
                                *v12 = *v28;
                                v19 = v20;
                                v17 = v18;
                                v21 = v22;
                                v23 = v52;
                                v7 = v8;
                                v15 = v16;
                                v9 = v10 + 1;
                                v5 = v6;
                                v11 = (char *)((int32_t)v12 + 1);
                                v13 = v14;
                            } else {
                                // 0x80deecf
                                v19 = v20;
                                v17 = v18;
                                v21 = v22;
                                v23 = v52;
                                v7 = v8;
                                v15 = v16;
                                v9 = v10 + 1;
                                v5 = v6;
                                v11 = v12;
                                v13 = v14;
                            }
                        } else {
                            char * v54 = v18; // 0x80dedfc
                            if (v12 != v14) {
                                char * v55; // 0x80dea10
                                int32_t v56; // 0x80dea10
                                if (v18 != NULL) {
                                    // 0x80dee3b
                                    v55 = v18;
                                    v56 = (int32_t)v18;
                                } else {
                                    int32_t * v57 = HTChunkCreate2(128, v6 + 1); // 0x80dee28
                                    v55 = (char *)v57;
                                    v56 = (int32_t)v57;
                                }
                                // 0x80dee44
                                HTChunkPutb((int32_t *)v56, v14, (int32_t)v12 - (int32_t)v14);
                                v54 = v55;
                            }
                            char * v58 = v54;
                            char * v59; // 0x80dea10
                            int32_t v60; // 0x80dea10
                            if (v58 != NULL) {
                                // 0x80dee90
                                v59 = v58;
                                v60 = (int32_t)v58;
                            } else {
                                int32_t * v61 = HTChunkCreate2(128, v6 + 1); // 0x80dee7d
                                v59 = (char *)v61;
                                v60 = (int32_t)v61;
                            }
                            // 0x80dee99
                            HTChunkPuts((int32_t *)v60, "%1B");
                            char * v62 = *str;
                            v19 = v20;
                            v17 = v59;
                            v21 = v22;
                            v23 = v52;
                            v7 = v8;
                            v15 = v16;
                            v9 = v10 + 1;
                            v5 = v6;
                            v11 = v62;
                            v13 = v62;
                        }
                    }
                }
                goto lab_0x80e05de;
            }
            case 1: {
                char v63 = *v28; // 0x80def4a
                if (v63 != 36) {
                    if (v63 != 40) {
                        // 0x80def9f
                        name = NULL;
                        v19 = v20;
                        v17 = v18;
                        v21 = v22;
                        v23 = v24;
                        v7 = v8;
                        v15 = v16;
                        v9 = v10;
                        v5 = v6;
                        v11 = v12;
                        v13 = v14;
                    } else {
                        // 0x80def7d
                        name = (char *)3;
                        *v12 = *v28;
                        v19 = v20;
                        v17 = v18;
                        v21 = v22;
                        v23 = v24;
                        v7 = v8;
                        v15 = v16;
                        v9 = v10 + 1;
                        v5 = v6;
                        v11 = (char *)((int32_t)v12 + 1);
                        v13 = v14;
                    }
                } else {
                    // 0x80def51
                    name = (char *)2;
                    *v12 = *v28;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v24;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10 + 1;
                    v5 = v6;
                    v11 = (char *)((int32_t)v12 + 1);
                    v13 = v14;
                }
                goto lab_0x80e05de;
            }
            case 2: {
                char v64 = *v28; // 0x80defb1
                switch (v64) {
                    case 64: {
                        goto lab_0x80defcc;
                    }
                    case 66: {
                        goto lab_0x80defcc;
                    }
                    default: {
                        if (v64 != 65) {
                            if (v64 != 40) {
                                // 0x80df01a
                                name = NULL;
                                v19 = v20;
                                v17 = v18;
                                v21 = v22;
                                v23 = v24;
                                v7 = v8;
                                v15 = v16;
                                v9 = v10;
                                v5 = v6;
                                v11 = v12;
                                v13 = v14;
                            } else {
                                // 0x80deff8
                                name = (char *)5;
                                *v12 = *v28;
                                v19 = v20;
                                v17 = v18;
                                v21 = v22;
                                v23 = v24;
                                v7 = v8;
                                v15 = v16;
                                v9 = v10 + 1;
                                v5 = v6;
                                v11 = (char *)((int32_t)v12 + 1);
                                v13 = v14;
                            }
                            goto lab_0x80e05de;
                        } else {
                            goto lab_0x80defcc;
                        }
                    }
                }
            }
            case 3: {
                char v65 = *v28; // 0x80df067
                switch (v65) {
                    case 66: {
                        goto lab_0x80df082;
                    }
                    case 74: {
                        goto lab_0x80df082;
                    }
                    default: {
                        if (v65 != 84) {
                            if (v65 != 73) {
                                // 0x80df0d0
                                name = NULL;
                                v19 = v20;
                                v17 = v18;
                                v21 = v22;
                                v23 = v24;
                                v7 = v8;
                                v15 = v16;
                                v9 = v10;
                                v5 = v6;
                                v11 = v12;
                                v13 = v14;
                            } else {
                                // 0x80df0ae
                                name = (char *)4;
                                *v12 = *v28;
                                v19 = v20;
                                v17 = v18;
                                v21 = v22;
                                v23 = v24;
                                v7 = v8;
                                v15 = v16;
                                v9 = v10 + 1;
                                v5 = v6;
                                v11 = (char *)((int32_t)v12 + 1);
                                v13 = v14;
                            }
                            goto lab_0x80e05de;
                        } else {
                            goto lab_0x80df082;
                        }
                    }
                }
            }
            case 4: {
                char v66 = *v28; // 0x80df0e2
                v67 = v66;
                if (v66 != 27) {
                    goto lab_0x80df1ff;
                } else {
                    // 0x80df0ed
                    v67 = v66;
                    if (stype == 0 == (hidden != 0 || HTCJK == 0)) {
                        goto lab_0x80df1ff;
                    } else {
                        // 0x80df109
                        name = (char *)1;
                        if (stype != 1) {
                            if (stype == 0) {
                                // 0x80df1f0
                                v67 = *v28;
                                goto lab_0x80df1ff;
                            } else {
                                // 0x80df1f6
                                v19 = v20;
                                v17 = v18;
                                v21 = v22;
                                v23 = v24;
                                v7 = v8;
                                v15 = v16;
                                v9 = v10 + 1;
                                v5 = v6;
                                v11 = v12;
                                v13 = v14;
                                goto lab_0x80e05de;
                            }
                        } else {
                            char * v68 = v18; // 0x80df123
                            if (v12 != v14) {
                                char * v69; // 0x80dea10
                                int32_t v70; // 0x80dea10
                                if (v18 != NULL) {
                                    // 0x80df162
                                    v69 = v18;
                                    v70 = (int32_t)v18;
                                } else {
                                    int32_t * v71 = HTChunkCreate2(128, v6 + 1); // 0x80df14f
                                    v69 = (char *)v71;
                                    v70 = (int32_t)v71;
                                }
                                // 0x80df16b
                                HTChunkPutb((int32_t *)v70, v14, (int32_t)v12 - (int32_t)v14);
                                v68 = v69;
                            }
                            char * v72 = v68;
                            char * v73; // 0x80dea10
                            int32_t v74; // 0x80dea10
                            if (v72 != NULL) {
                                // 0x80df1b7
                                v73 = v72;
                                v74 = (int32_t)v72;
                            } else {
                                int32_t * v75 = HTChunkCreate2(128, v6 + 1); // 0x80df1a4
                                v73 = (char *)v75;
                                v74 = (int32_t)v75;
                            }
                            // 0x80df1c0
                            HTChunkPuts((int32_t *)v74, "%1B");
                            char * v76 = *str;
                            v19 = v20;
                            v17 = v73;
                            v21 = v22;
                            v23 = v24;
                            v7 = v8;
                            v15 = v16;
                            v9 = v10 + 1;
                            v5 = v6;
                            v11 = v76;
                            v13 = v76;
                            goto lab_0x80e05de;
                        }
                    }
                }
            }
            case 5: {
                // 0x80df029
                if (*v28 != 67) {
                    // 0x80df055
                    name = NULL;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v24;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10;
                    v5 = v6;
                    v11 = v12;
                    v13 = v14;
                } else {
                    // 0x80df033
                    name = (char *)4;
                    *v12 = *v28;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v24;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10 + 1;
                    v5 = v6;
                    v11 = (char *)((int32_t)v12 + 1);
                    v13 = v14;
                }
                goto lab_0x80e05de;
            }
            case 6: {
                char v77 = *v28; // 0x80df21a
                if (v77 != 0 == replace_buf[0] == 0) {
                    if (Back == 0) {
                        // 0x80df538
                        v78 = v24;
                        if (v24 > 126) {
                            goto lab_0x80df54d;
                        } else {
                            // 0x80df53e
                            name = (char *)16;
                            v19 = v20;
                            v17 = v18;
                            v21 = v22;
                            v23 = v24;
                            v7 = v8;
                            v15 = v16;
                            v9 = v10;
                            v5 = v6;
                            v11 = v12;
                            v13 = v14;
                            goto lab_0x80e05de;
                        }
                    } else {
                        if (v77 != 1 == (v77 != 2)) {
                            if (v77 != 7) {
                                if (v79 == 0) {
                                    if (v24 < 127) {
                                        goto lab_0x80df4d6;
                                    } else {
                                        // 0x80df4cb
                                        v80 = v24;
                                        if ((char)v81 == 0) {
                                            goto lab_0x80df4e5;
                                        } else {
                                            goto lab_0x80df4d6;
                                        }
                                    }
                                } else {
                                    // 0x80df3a4
                                    if (strcmp((char *)*str4, "euc-jp") != 0) {
                                        goto lab_0x80df41a;
                                    } else {
                                        unsigned char v82 = *v28; // 0x80df3c7
                                        if (v82 < 161 || v82 == -1) {
                                            if (v82 != -114) {
                                                goto lab_0x80df41a;
                                            } else {
                                                // 0x80df400
                                                if (*(char *)(v27 + 1) < 224) {
                                                    goto lab_0x80df495;
                                                } else {
                                                    goto lab_0x80df41a;
                                                }
                                            }
                                        } else {
                                            unsigned char v83 = *(char *)(v27 + 1); // 0x80df3de
                                            if (v83 > 160 == (v83 != -1)) {
                                                goto lab_0x80df495;
                                            } else {
                                                goto lab_0x80df41a;
                                            }
                                        }
                                    }
                                }
                            } else {
                                // 0x80df314
                                if (*v84 == 2) {
                                    goto lab_0x80df346;
                                } else {
                                    // 0x80df32c
                                    if ((char)*v85 > -1) {
                                        // 0x80df355
                                        if (*v86 == 2) {
                                            // 0x80df38f
                                            *v28 = -83;
                                            v80 = 173;
                                            goto lab_0x80df4e5;
                                        } else {
                                            // 0x80df366
                                            if ((char)*v87 <= -1) {
                                                // 0x80df38f
                                                *v28 = -83;
                                                v80 = 173;
                                                goto lab_0x80df4e5;
                                            } else {
                                                // 0x80df380
                                                name = (char *)9;
                                                v19 = v20;
                                                v17 = v18;
                                                v21 = v22;
                                                v23 = 173;
                                                v7 = v8;
                                                v15 = v16;
                                                v9 = v10;
                                                v5 = v6;
                                                v11 = v12;
                                                v13 = v14;
                                                goto lab_0x80e05de;
                                            }
                                        }
                                    } else {
                                        goto lab_0x80df346;
                                    }
                                }
                            }
                        } else {
                            if (plain_space == 0) {
                                // 0x80df280
                                if (*v84 == 2) {
                                    goto lab_0x80df2b2;
                                } else {
                                    // 0x80df298
                                    if ((char)*v85 > -1) {
                                        // 0x80df2c1
                                        if (*v86 == 2) {
                                            // 0x80df2fb
                                            *v28 = -96;
                                            v80 = 160;
                                            goto lab_0x80df4e5;
                                        } else {
                                            // 0x80df2d2
                                            if ((char)*v87 <= -1) {
                                                // 0x80df2fb
                                                *v28 = -96;
                                                v80 = 160;
                                                goto lab_0x80df4e5;
                                            } else {
                                                // 0x80df2ec
                                                name = (char *)9;
                                                v19 = v20;
                                                v17 = v18;
                                                v21 = v22;
                                                v23 = 160;
                                                v7 = v8;
                                                v15 = v16;
                                                v9 = v10;
                                                v5 = v6;
                                                v11 = v12;
                                                v13 = v14;
                                                goto lab_0x80e05de;
                                            }
                                        }
                                    } else {
                                        goto lab_0x80df2b2;
                                    }
                                }
                            } else {
                                // 0x80df264
                                *v28 = 32;
                                name = (char *)16;
                                v19 = v20;
                                v17 = v18;
                                v21 = v22;
                                v23 = 32;
                                v7 = v8;
                                v15 = v16;
                                v9 = v10;
                                v5 = v6;
                                v11 = v12;
                                v13 = v14;
                                goto lab_0x80e05de;
                            }
                        }
                    }
                } else {
                    // 0x80df227
                    name = (char *)16;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v24;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10;
                    v5 = v6;
                    v11 = v12;
                    v13 = v14;
                    goto lab_0x80e05de;
                }
            }
            case 7: {
                // 0x80df6fa
                if (*v28 != 38) {
                    // 0x80df876
                    name = (char *)6;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v24;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10;
                    v5 = v6;
                    v11 = v12;
                    v13 = v14;
                    goto lab_0x80e05de;
                } else {
                    // 0x80df708
                    str5 = (char *)(v27 + 1);
                    len2 = strlen(str5);
                    char v88 = *str5; // 0x80df72e
                    v89 = v88;
                    if (len2 < 3 || v88 != 35) {
                        goto lab_0x80df7b1;
                    } else {
                        char v90 = *(char *)(v27 + 2); // 0x80df747
                        v89 = v88;
                        if (v90 != 120 == (v90 != 88)) {
                            goto lab_0x80df7b1;
                        } else {
                            char * v91 = (char *)(v27 + 3); // 0x80df767
                            v89 = v88;
                            if (*v91 < 127) {
                                int16_t v92 = *(int16_t *)(2 * (int32_t)*v91 + (int32_t)*__ctype_b_loc()); // 0x80df789
                                if ((v92 & 0x1000) == 0) {
                                    // 0x80df76e
                                    v89 = *str5;
                                    goto lab_0x80df7b1;
                                } else {
                                    // 0x80df798
                                    name = (char *)8;
                                    v19 = v20;
                                    v17 = v18;
                                    v21 = v22;
                                    v23 = v24;
                                    v7 = v8;
                                    v15 = (char *)2;
                                    v9 = v10;
                                    v5 = len2;
                                    v11 = v12;
                                    v13 = v14;
                                    goto lab_0x80e05de;
                                }
                            } else {
                                goto lab_0x80df7b1;
                            }
                        }
                    }
                }
            }
            case 8: {
                char v93 = (v16 != (char *)2 ? 2 : 3) + v10;
                str6 = (char *)(int32_t)v93;
                char v94 = *str6;
                char * v95 = str6; // 0x80df8ac
                char v96 = v93; // 0x80df8ac
                char v97 = v93; // 0x80df8ac
                char * v98 = str6; // 0x80df8ac
                char v99 = v94; // 0x80df8ac
                if (v94 < 127) {
                    char v100 = v96;
                    int16_t * v101 = *__ctype_b_loc();
                    int16_t v102 = *(int16_t *)(2 * (int32_t)*v95 + (int32_t)v101);
                    if (v16 != (char *)2) {
                        // 0x80df8e7
                        if ((v102 & 2048) == 0) {
                            // break -> 0x80df90b
                            break;
                        }
                    } else {
                        // 0x80df8c1
                        if ((v102 & 0x1000) == 0) {
                            // break -> 0x80df90b
                            break;
                        }
                    }
                    char v103 = v100 + 1; // 0x80df8a0
                    char * v104 = (char *)(int32_t)v103;
                    char v105 = *v104;
                    v97 = v103;
                    v98 = v104;
                    v99 = v105;
                    while (v105 < 127) {
                        // 0x80df8b8
                        v100 = v103;
                        char * v106 = v104;
                        v101 = *__ctype_b_loc();
                        char v107 = *v106;
                        v102 = *(int16_t *)(2 * (int32_t)v107 + (int32_t)v101);
                        if (v16 != (char *)2) {
                            // 0x80df8e7
                            v97 = v100;
                            v98 = v106;
                            v99 = v107;
                            if ((v102 & 2048) == 0) {
                                // break -> 0x80df90b
                                break;
                            }
                        } else {
                            // 0x80df8c1
                            v97 = v100;
                            v98 = v106;
                            v99 = v107;
                            if ((v102 & 0x1000) == 0) {
                                // break -> 0x80df90b
                                break;
                            }
                        }
                        // 0x80df8a0
                        v103 = v100 + 1;
                        v104 = (char *)(int32_t)v103;
                        v105 = *v104;
                        v97 = v103;
                        v98 = v104;
                        v99 = v105;
                    }
                }
                // 0x80df90b
                v108 = v99;
                char v109 = v97;
                char v110 = v109; // 0x80df91c
                if (v108 != 0) {
                    // 0x80df91e
                    *v98 = 0;
                    v110 = v109 + 1;
                }
                // 0x80df928
                v111 = v110;
                if (v16 != (char *)2) {
                    // 0x80df952
                    if (sscanf(str6, "%lu", &lowest_8) != 1) {
                        goto lab_0x80df978;
                    } else {
                        goto lab_0x80df971;
                    }
                } else {
                    // 0x80df931
                    if (sscanf(str6, "%lx", &lowest_8) != 1) {
                        goto lab_0x80df978;
                    } else {
                        goto lab_0x80df971;
                    }
                }
            }
            case 9: {
                // 0x80dfa89
                if (HTCJK == 0 == (v24 != 13 && v24 <= 31 && v24 >= 11)) {
                    goto lab_0x80dfade;
                } else {
                    if (v24 != 127) {
                        goto lab_0x80dfac4;
                    } else {
                        // 0x80dfab0
                        if (HTCJK == 0 == HTPassHighCtrlRaw == 0) {
                            goto lab_0x80dfade;
                        } else {
                            goto lab_0x80dfac4;
                        }
                    }
                }
            }
            case 10: {
                char v112 = v10 + 1; // 0x80dff6f
                int32_t v113 = v112; // 0x80dff73
                char * v114 = (char *)v113;
                char v115 = *v114; // 0x80dff82
                char * v116 = v114; // 0x80dff87
                char * v117 = v114; // 0x80dff87
                char v118 = v115; // 0x80dff87
                if (v115 < 127) {
                    char * v119 = v116;
                    int16_t * v120 = *__ctype_b_loc(); // 0x80dff98
                    unsigned char v121 = *v119; // 0x80dff9d
                    v117 = v119;
                    v118 = v121;
                    while ((*(int16_t *)(2 * (int32_t)v121 + (int32_t)v120) & 8) != 0) {
                        char * v122 = (char *)((int32_t)v119 + 1);
                        char v123 = *v122; // 0x80dff82
                        v116 = v122;
                        v117 = v122;
                        v118 = v123;
                        if (v123 >= 127) {
                            // break -> 0x80dffb5
                            break;
                        }
                        v119 = v116;
                        v120 = *__ctype_b_loc();
                        v121 = *v119;
                        v117 = v119;
                        v118 = v121;
                    }
                }
                // 0x80dffb5
                *v117 = 0;
                name = (char *)11;
                v19 = v117;
                v17 = v18;
                v21 = v118;
                v23 = v24;
                v7 = v113;
                v15 = v16;
                v9 = v112;
                v5 = v6;
                v11 = v12;
                v13 = v14;
                goto lab_0x80e05de;
            }
            case 11: {
                int32_t v124 = HTMLGetEntityUCValue((char *)v8); // 0x80dffe5
                if (stype == 1 == v22 == 61 || v124 < 1) {
                    // 0x80e000e
                    name = (char *)12;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v124;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10;
                    v5 = v6;
                    v11 = v12;
                    v13 = v14;
                } else {
                    // 0x80dffff
                    name = (char *)9;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v124;
                    v7 = v8;
                    v15 = v16;
                    v9 = v10;
                    v5 = v6;
                    v11 = v12;
                    v13 = v14;
                }
                goto lab_0x80e05de;
            }
            case 12: {
                goto lab_0x80dfe64;
            }
            case 13: {
                if (v24 > 255) {
                    goto lab_0x80e003d;
                } else {
                    if (v24 < 128) {
                        goto lab_0x80e0066;
                    } else {
                        // 0x80e002c
                        if (*v84 != 7) {
                            goto lab_0x80e0066;
                        } else {
                            goto lab_0x80e003d;
                        }
                    }
                }
            }
            case 14: {
                char v125; // 0x80dea10
                if (v16 != (char *)3 == (v16 != (char *)2)) {
                    if (v16 != (char *)4) {
                        // 0x80e00e4
                        v125 = v10;
                        if (v16 == (char *)1) {
                            // 0x80e00ed
                            v125 = len;
                        }
                    } else {
                        // 0x80e00af
                        *v20 = v22;
                        v125 = (int32_t)(v22 != 59) + (int32_t)v20;
                    }
                } else {
                    char v126 = v10; // 0x80e0093
                    switch (v22) {
                        default: {
                            // 0x80e0093
                            v126 = v10 - 1;
                            *(char *)(int32_t)v126 = v22;
                        }
                        case 59: {
                        }
                        case 0: {
                            // 0x80e00a0
                            v125 = v126 - 1;
                            // break -> 0x80e00f6
                            break;
                        }
                    }
                }
                // 0x80e00f6
                v127 = v125;
                if ((char)str7 != 0) {
                    // 0x80e010d
                    v128 = v24;
                    if (stype != 1) {
                        goto lab_0x80e014a;
                    } else {
                        int32_t v129 = 0x1000000 * str7;
                        v130 = v129 >> 24;
                        if (v129 > 0x7e000000) {
                            goto lab_0x80e013b;
                        } else {
                            // 0x80e0123
                            v128 = v130;
                            if (v129 > 0x1f000000) {
                                goto lab_0x80e014a;
                            } else {
                                // switch.early.test
                                v128 = v130;
                                switch (v129) {
                                    case 0xa000000: {
                                        goto lab_0x80e014a;
                                    }
                                    case 0x9000000: {
                                        goto lab_0x80e014a;
                                    }
                                    case 0: {
                                        goto lab_0x80e014a;
                                    }
                                    default: {
                                        goto lab_0x80e013b;
                                    }
                                }
                            }
                        }
                    }
                } else {
                    // 0x80e00fe
                    name = (char *)18;
                    v19 = v20;
                    v17 = v18;
                    v21 = v22;
                    v23 = v24;
                    v7 = v8;
                    v15 = v16;
                    v9 = v127;
                    v5 = v6;
                    v11 = v12;
                    v13 = v14;
                    goto lab_0x80e05de;
                }
            }
            case 15: {
                char * v131 = HTEscape((char *)&str7, 1); // 0x80e0230
                char * v132 = v18; // 0x80e023e
                if (v12 != v14) {
                    char * v133; // 0x80dea10
                    int32_t v134; // 0x80dea10
                    if (v18 != NULL) {
                        // 0x80e027d
                        v133 = v18;
                        v134 = (int32_t)v18;
                    } else {
                        int32_t * v135 = HTChunkCreate2(128, v6 + 1); // 0x80e026a
                        v133 = (char *)v135;
                        v134 = (int32_t)v135;
                    }
                    // 0x80e0286
                    v132 = v133;
                    HTChunkPutb((int32_t *)v134, v14, (int32_t)v12 - (int32_t)v14);
                }
                char * v136 = v132;
                char * v137; // 0x80dea10
                int32_t v138; // 0x80dea10
                if (v136 != NULL) {
                    // 0x80e02d2
                    v137 = v136;
                    v138 = (int32_t)v136;
                } else {
                    int32_t * v139 = HTChunkCreate2(128, v6 + 1); // 0x80e02bf
                    v137 = (char *)v139;
                    v138 = (int32_t)v139;
                }
                // 0x80e02db
                HTChunkPuts((int32_t *)v138, v131);
                char * v140 = *str;
                if (v131 != NULL) {
                    // 0x80e0307
                    free((int32_t *)v131);
                }
                // 0x80e0319
                name = (char *)18;
                v19 = v20;
                v17 = v137;
                v21 = v22;
                v23 = v24;
                v7 = v8;
                v15 = v16;
                v9 = v10;
                v5 = v6;
                v11 = v140;
                v13 = v140;
                goto lab_0x80e05de;
            }
            case 16: {
                char v141; // 0x80dea10
                if (v16 != (char *)3 == (v16 != (char *)2)) {
                    if (v16 != (char *)4) {
                        // 0x80e0397
                        v141 = v10;
                        if (v16 == (char *)1) {
                            // 0x80e03a0
                            v141 = len;
                        }
                    } else {
                        // 0x80e0362
                        *v20 = v22;
                        v141 = (int32_t)(v22 != 59) + (int32_t)v20;
                    }
                } else {
                    char v142 = v10; // 0x80e0346
                    switch (v22) {
                        default: {
                            // 0x80e0346
                            v142 = v10 - 1;
                            *(char *)(int32_t)v142 = v22;
                        }
                        case 59: {
                        }
                        case 0: {
                            // 0x80e0353
                            v141 = v142 - 1;
                            // break -> 0x80e03a9
                            break;
                        }
                    }
                }
                // 0x80e03a9
                v143 = v141;
                if (stype != 1) {
                    goto lab_0x80e03d6;
                } else {
                    if (v24 > 126) {
                        goto lab_0x80e03c7;
                    } else {
                        if (v24 > 31 || v24 < 11) {
                            goto lab_0x80e03d6;
                        } else {
                            goto lab_0x80e03c7;
                        }
                    }
                }
            }
            case 17: {
                // 0x80e0442
                *v12 = 37;
                int32_t v144 = (int32_t)v12 + 1; // 0x80e0448
                char * v145; // 0x80dea10
                char * v146; // 0x80dea10
                int32_t v147; // 0x80dea10
                if (v144 > v27) {
                    char * v148; // 0x80dea10
                    int32_t v149; // 0x80dea10
                    if (v18 != NULL) {
                        // 0x80e0495
                        v148 = v18;
                        v149 = (int32_t)v18;
                    } else {
                        int32_t * v150 = HTChunkCreate2(128, v6 + 1); // 0x80e0482
                        v148 = (char *)v150;
                        v149 = (int32_t)v150;
                    }
                    // 0x80e049e
                    HTChunkPutb((int32_t *)v149, v14, v144 - (int32_t)v14);
                    char * v151 = *str;
                    *v151 = *(char *)(v24 / 16 % 16 + (int32_t)g146);
                    v146 = v148;
                    v145 = v151;
                    v147 = (int32_t)v151;
                } else {
                    char v152 = *(char *)(v24 / 16 % 16 + (int32_t)g146); // 0x80e0500
                    *(char *)v144 = v152;
                    v146 = v18;
                    v145 = v14;
                    v147 = v144;
                }
                int32_t v153 = v147;
                char * v154 = v145;
                char * v155 = v146;
                uint32_t v156 = v153 + 1;
                if (v156 > v27) {
                    char * v157; // 0x80dea10
                    int32_t v158; // 0x80dea10
                    if (v155 != NULL) {
                        // 0x80e0555
                        v157 = v155;
                        v158 = (int32_t)v155;
                    } else {
                        int32_t * v159 = HTChunkCreate2(128, v6 + 1); // 0x80e0542
                        v157 = (char *)v159;
                        v158 = (int32_t)v159;
                    }
                    // 0x80e055e
                    HTChunkPutb((int32_t *)v158, v154, v156 - (int32_t)v154);
                    char * v160 = *str;
                    *v160 = *(char *)(v24 % 16 + (int32_t)g146);
                    v32 = v157;
                    v35 = (char *)((int32_t)v160 + 1);
                    v37 = v160;
                } else {
                    char v161 = *(char *)(v24 % 16 + (int32_t)g146); // 0x80e05ba
                    *(char *)v156 = v161;
                    v32 = v155;
                    v35 = (char *)(v153 + 2);
                    v37 = v154;
                }
                goto lab_0x80e05c6;
            }
            case 18: {
                goto lab_0x80e05c6;
            }
            case 19: {
                goto lab_0x80e05ca;
            }
            default: {
                goto lab_0x80e05de;
            }
        }
    }
    // 0x80e0602
    *v12 = 0;
    if (v18 == NULL) {
        // 0x80e06c5
        v3 = str;
        if (stype != 1 != stype != 2) {
            // 0x80e06d1
            LYTrimHead(v14);
            LYTrimTail(v14);
            v3 = str;
        }
    } else {
        // 0x80e0612
        HTChunkPutb((int32_t *)v18, v14, (int32_t)v12 + 1 - (int32_t)v14);
        int32_t * v226 = (int32_t *)((int32_t)v18 + 12);
        if (stype != 1 != stype != 2) {
            // 0x80e0684
            LYTrimHead((char *)*v226);
            LYTrimTail((char *)*v226);
        }
        // 0x80e06a0
        HTSACopy(str, (char *)*v226);
        HTChunkFree((int32_t *)v18);
        v3 = str;
    }
    goto lab_0x80e06f3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharUtils.c
// Address range: 0x80e078c - 0x80e07ed
// Line range:    2049 - 2057
char LYUCTranslateBackFormData(char ** str, int32_t cs_from, int32_t cs_to, char plain_space) {
    // 0x80e078c
    return LYUCFullyTranslateString(str, cs_from, cs_to, 0, 0, plain_space, 1, 1, 0) != NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCharUtils.c
// Address range: 0x80e3b66 - 0x80e3c66
// Line range:    3531 - 3554
void LYformTitle(char ** dst, char * src) {
    // 0x80e3b66
    if (HTCJK != 1) {
        // 0x80e3c52
        HTSACopy(dst, src);
        // 0x80e3c64
        return;
    }
    int32_t * mem = malloc(strlen(src) + 1); // 0x80e3b92
    if (mem == NULL) {
        // 0x80e3ba0
        outofmem("./LYCharUtils.c", "LYformTitle");
        // UNREACHABLE
    }
    // 0x80e3bb4
    switch (kanji_code) {
        case 1: {
            // 0x80e3bca
            TO_EUC(src, (char *)mem);
            // 0x80e3c3e
            HTSACopy(dst, (char *)mem);
            free(mem);
            // 0x80e3c64
            return;
        }
        case 2: {
            // 0x80e3bde
            TO_SJIS(src, (char *)mem);
            // 0x80e3c3e
            HTSACopy(dst, (char *)mem);
            free(mem);
            // 0x80e3c64
            return;
        }
    }
    // 0x80e3bf2
    if (WWW_TraceFlag != 0) {
        // 0x80e3bfd
        fprintf(TraceFP(), "\nLYformTitle: kanji_code is an unexpected value.");
    }
    // 0x80e3c14
    strcpy((char *)mem, src);
    // 0x80e3c3e
    HTSACopy(dst, (char *)mem);
    free(mem);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMap.c
// Address range: 0x80e3c68 - 0x80e3ddf
// Line range:    60 - 87
void ImageMapList_free(int32_t * theList) {
    if (theList == NULL) {
        // 0x80e3ddd
        return;
    }
    int32_t v1 = *(int32_t *)((int32_t)theList + 4); // 0x80e3da5
    int32_t v2 = v1; // 0x80e3daf
    if (v1 == 0) {
        // 0x80e3dd2
        HTList_delete(theList);
        // 0x80e3ddd
        return;
    }
    int32_t v3 = *(int32_t *)v2; // 0x80e3db4
    while (v3 != 0) {
        int32_t * v4 = (int32_t *)v3; // 0x80e3db6
        int32_t v5 = *v4; // 0x80e3c86
        if (v5 != 0) {
            // 0x80e3c8c
            free((int32_t *)v5);
            *v4 = 0;
        }
        int32_t * v6 = (int32_t *)(v3 + 4); // 0x80e3ca5
        int32_t v7 = *v6; // 0x80e3ca5
        if (v7 != 0) {
            // 0x80e3cac
            free((int32_t *)v7);
            *v6 = 0;
        }
        int32_t * v8 = (int32_t *)(v3 + 8); // 0x80e3cc7
        int32_t v9 = *v8; // 0x80e3cc7
        if (v9 != 0) {
            int32_t v10 = *(int32_t *)(v9 + 4); // 0x80e3d3f
            int32_t v11 = v10; // 0x80e3d49
            if (v10 != 0) {
                int32_t v12 = v11;
                int32_t v13 = *(int32_t *)v12; // 0x80e3d4e
                while (v13 != 0) {
                    int32_t * v14 = (int32_t *)v13; // 0x80e3d50
                    int32_t v15 = *v14; // 0x80e3ce0
                    if (v15 != 0) {
                        // 0x80e3ce6
                        free((int32_t *)v15);
                        *v14 = 0;
                    }
                    int32_t * v16 = (int32_t *)(v13 + 4); // 0x80e3cff
                    int32_t v17 = *v16; // 0x80e3cff
                    if (v17 != 0) {
                        // 0x80e3d06
                        free((int32_t *)v17);
                        *v16 = 0;
                    }
                    // 0x80e3d24
                    free(v14);
                    int32_t v18 = *(int32_t *)(v12 + 4); // 0x80e3d3f
                    v11 = v18;
                    if (v18 == 0) {
                        // break -> 0x80e3d84
                        break;
                    }
                    v12 = v11;
                    v13 = *(int32_t *)v12;
                }
            }
            // 0x80e3d84
            HTList_delete((int32_t *)*v8);
            *v8 = 0;
        }
        // 0x80e3d9c
        free(v4);
        v2 += 4;
        if (v2 == 0) {
            // break -> 0x80e3dd2
            break;
        }
        v3 = *(int32_t *)v2;
    }
    // 0x80e3dd2
    HTList_delete(theList);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYMap.c
// Address range: 0x80e5004 - 0x80e51a6
// Line range:    612 - 644
void LYPrintImgMaps(struct _IO_FILE * fp) {
    char * str = HTLoadedDocumentURL(); // 0x80e500a
    int32_t len = strlen(str); // 0x80e5018
    int32_t * v1 = LynxMaps; // 0x80e5020
    if (v1 == NULL | HTList_count(v1) < 1) {
        // 0x80e51a4
        return;
    }
    int32_t v2 = *(int32_t *)((int32_t)v1 + 4); // 0x80e5177
    if (v2 == 0) {
        // 0x80e51a4
        return;
    }
    int32_t v3 = v2; // 0x80e5181
    int32_t v4; // 0x80e5186
    int32_t * str2; // 0x80e5197
    while (true) {
      lab_0x80e5194:
        // 0x80e5194
        v4 = *(int32_t *)v3;
        if (v4 == 0) {
            // break -> 0x80e51a4
            break;
        }
        // 0x80e5040
        str2 = (int32_t *)v4;
        if (len == 0) {
            goto lab_0x80e51a4;
        } else {
            // 0x80e5046
            if (strncmp(str, (char *)*str2, len) != 0) {
                goto lab_0x80e516e;
            } else {
                char v5 = *(char *)(*str2 + len); // 0x80e5074
                if (v5 != 0 == (v5 != 35)) {
                    goto lab_0x80e516e;
                } else {
                    goto lab_0x80e51a4;
                }
            }
        }
    }
  lab_0x80e51a4:;
    int32_t v6 = *(int32_t *)(v4 + 4); // 0x80e5094
    char * v7 = "[USEMAP]"; // 0x80e5099
    if (v6 != 0) {
        char * v8 = (char *)v6; // 0x80e50a1
        v7 = *v8 == 0 ? "[USEMAP]" : v8;
    }
    // 0x80e50ba
    fprintf(fp, "\n%s\n", v7);
    fprintf(fp, "%s\n", (char *)*str2);
    int32_t v9 = *(int32_t *)(v4 + 8); // 0x80e50f3
    int32_t * v10 = NULL; // 0x80e5140
    int32_t v11 = v9; // 0x80e5140
    if (v9 != 0) {
        int32_t v12 = *(int32_t *)(v11 + 4); // 0x80e5145
        while (v12 != 0) {
            int32_t v13 = *(int32_t *)v12; // 0x80e5154
            if (v13 == 0) {
                // break -> 0x80e516e
                break;
            }
            int32_t v14 = (int32_t)v10 + 1; // 0x80e5107
            fprintf(fp, "%4d. %s", v14, (char *)*(int32_t *)v13);
            fputc(10, fp);
            v10 = (int32_t *)v14;
            v12 += 4;
        }
    }
    goto lab_0x80e516e;
  lab_0x80e516e:
    // 0x80e516e
    v3 += 4;
    if (v3 == 0) {
        // break -> 0x80e51a4
        goto lab_0x80e51a4;
    }
    goto lab_0x80e5194;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e5264 - 0x80e52c4
// Line range:    143 - 151
int32_t * newCookie(void) {
    int32_t * mem = calloc(1, 56); // 0x80e5279
    if (mem == NULL) {
        // 0x80e5287
        outofmem("./LYCookie.c", "newCookie");
        // UNREACHABLE
    }
    // 0x80e529b
    HTSprintf0((char **)mem, "%p", mem);
    *(int32_t *)((int32_t)mem + 28) = 80;
    return mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e52c4 - 0x80e53fb
// Line range:    154 - 166
void freeCookie(int32_t * co) {
    if (co == NULL) {
        // 0x80e53f9
        return;
    }
    int32_t v1 = *co; // 0x80e52d7
    if (v1 != 0) {
        // 0x80e52dd
        free((int32_t *)v1);
        *co = 0;
    }
    int32_t v2 = (int32_t)co;
    int32_t * v3 = (int32_t *)(v2 + 4); // 0x80e52f6
    int32_t v4 = *v3; // 0x80e52f6
    if (v4 != 0) {
        // 0x80e52fd
        free((int32_t *)v4);
        *v3 = 0;
    }
    int32_t * v5 = (int32_t *)(v2 + 8); // 0x80e5318
    int32_t v6 = *v5; // 0x80e5318
    if (v6 != 0) {
        // 0x80e531f
        free((int32_t *)v6);
        *v5 = 0;
    }
    int32_t * v7 = (int32_t *)(v2 + 16); // 0x80e533a
    int32_t v8 = *v7; // 0x80e533a
    if (v8 != 0) {
        // 0x80e5341
        free((int32_t *)v8);
        *v7 = 0;
    }
    int32_t * v9 = (int32_t *)(v2 + 20); // 0x80e535c
    int32_t v10 = *v9; // 0x80e535c
    if (v10 != 0) {
        // 0x80e5363
        free((int32_t *)v10);
        *v9 = 0;
    }
    int32_t * v11 = (int32_t *)(v2 + 24); // 0x80e537e
    int32_t v12 = *v11; // 0x80e537e
    if (v12 != 0) {
        // 0x80e5385
        free((int32_t *)v12);
        *v11 = 0;
    }
    int32_t * v13 = (int32_t *)(v2 + 36); // 0x80e53a0
    int32_t v14 = *v13; // 0x80e53a0
    if (v14 != 0) {
        // 0x80e53a7
        free((int32_t *)v14);
        *v13 = 0;
    }
    int32_t * v15 = (int32_t *)(v2 + 32); // 0x80e53c2
    int32_t v16 = *v15; // 0x80e53c2
    if (v16 != 0) {
        // 0x80e53c9
        free((int32_t *)v16);
        *v15 = 0;
    }
    // 0x80e53e7
    free(co);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e53fb - 0x80e54ac
// Line range:    210 - 231
char host_matches(char * A, char * B) {
    // 0x80e53fb
    if (*B != 46) {
        // 0x80e540c
        if (strcasecomp(A, B) == 0) {
            // 0x80e54a2
            return 1;
        }
        // 0x80e5428
        if (*B != 46) {
            // 0x80e54a2
            return 0;
        }
    }
    // 0x80e5432
    switch (*(char *)((int32_t)B + 1)) {
        case 0: {
        }
        case 46: {
            // 0x80e54a2
            return 0;
        }
    }
    // 0x80e544c
    if (*A == 46) {
        // 0x80e54a2
        return 0;
    }
    int32_t v1 = strlen(A) - strlen(B); // 0x80e5470
    if (v1 < 1) {
        // 0x80e54a2
        return 0;
    }
    // 0x80e547d
    if (strcasecomp((char *)(v1 + (int32_t)A), B) == 0) {
        // 0x80e54a2
        return 1;
    }
    // 0x80e54a2
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e5571 - 0x80e55a6
// Line range:    265 - 271
int32_t ignore_trailing_slash(char * a) {
    int32_t len = strlen(a);
    while (len >= 2) {
        int32_t v1 = len - 1; // 0x80e5594
        if (*(char *)(v1 + (int32_t)a) != 47) {
            // break -> 0x80e55a1
            break;
        }
        len = v1;
    }
    // 0x80e55a1
    return len;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e55a6 - 0x80e563b
// Line range:    278 - 296
char is_prefix(char * a, char * b) {
    uint32_t n = ignore_trailing_slash(a); // 0x80e55b2
    int32_t v1 = ignore_trailing_slash(b); // 0x80e55c0
    if (n > v1 || strncmp(a, b, n) != 0) {
        // 0x80e5635
        return 0;
    }
    if (n >= v1) {
        // 0x80e5635
        return 1;
    }
    if (n <= 1) {
        // 0x80e5607
        if (*a == 47) {
            // 0x80e5635
            return 1;
        }
    }
    // 0x80e5611
    switch (*(char *)(n + (int32_t)b)) {
        case 0: {
        }
        case 47: {
            // 0x80e5635
            return 1;
        }
    }
    // 0x80e5635
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e563b - 0x80e5782
// Line range:    302 - 328
int32_t * find_domain_entry(char * name) {
    int32_t * result = NULL; // 0x80e564f
    if (name != NULL) {
        // 0x80e5655
        result = NULL;
        if (*name != 0) {
            // 0x80e5663
            result = NULL;
            if (domain_list != NULL) {
                char * v1 = (char *)domain_list; // 0x80e563b
                int32_t v2 = *(int32_t *)v1; // 0x80e5673
                int32_t v3; // 0x80e563b
                int32_t * v4; // 0x80e563b
                int32_t v5; // 0x80e5681
                int32_t v6; // 0x80e56a1
                int32_t v7; // 0x80e56a7
                if (v2 != 0) {
                    // 0x80e567e
                    v4 = (int32_t *)v2;
                    v5 = *v4;
                    if (v5 != 0) {
                        // 0x80e5687
                        v3 = v5;
                        if (WWW_TraceFlag != 0) {
                            // 0x80e5692
                            v3 = v5;
                            if ((WWW_TraceMask & 32) != 0) {
                                // 0x80e569e
                                v6 = *(int32_t *)(v2 + 8);
                                v7 = *(int32_t *)(v2 + 4);
                                fprintf(TraceFP(), "...test_domain_entry(%s) bv:%u, invcheck_bv:%u\n", (char *)v5, v7, v6);
                                v3 = *v4;
                            }
                        }
                        // 0x80e56d2
                        if (strcasecomp(name, (char *)v3) == 0) {
                            // break -> 0x80e5704
                            break;
                        }
                    }
                }
                int32_t v8 = *(int32_t *)((int32_t)v1 + 4); // 0x80e56f4
                v1 = (char *)v8;
                result = NULL;
                while (v8 != 0) {
                    // 0x80e5670
                    v2 = *(int32_t *)v1;
                    if (v2 != 0) {
                        // 0x80e567e
                        v4 = (int32_t *)v2;
                        v5 = *v4;
                        if (v5 != 0) {
                            // 0x80e5687
                            v3 = v5;
                            if (WWW_TraceFlag != 0) {
                                // 0x80e5692
                                v3 = v5;
                                if ((WWW_TraceMask & 32) != 0) {
                                    // 0x80e569e
                                    v6 = *(int32_t *)(v2 + 8);
                                    v7 = *(int32_t *)(v2 + 4);
                                    fprintf(TraceFP(), "...test_domain_entry(%s) bv:%u, invcheck_bv:%u\n", (char *)v5, v7, v6);
                                    v3 = *v4;
                                }
                            }
                            // 0x80e56d2
                            result = v4;
                            if (strcasecomp(name, (char *)v3) == 0) {
                                // break -> 0x80e5704
                                break;
                            }
                        }
                    }
                    // 0x80e56ea
                    v8 = *(int32_t *)((int32_t)v1 + 4);
                    v1 = (char *)v8;
                    result = NULL;
                }
            }
        }
    }
    // 0x80e5704
    if (WWW_TraceFlag == 0 || (WWW_TraceMask & 32) == 0) {
        // 0x80e5777
        return result;
    }
    int32_t v9 = -1; // 0x80e571f
    int32_t v10 = -1; // 0x80e571f
    if (result != NULL) {
        int32_t v11 = (int32_t)result;
        v9 = *(int32_t *)(v11 + 8);
        v10 = *(int32_t *)(v11 + 4);
    }
    // 0x80e574b
    fprintf(TraceFP(), "find_domain_entry(%s) bv:%d, invcheck_bv:%d\n", name, v10, v9);
    // 0x80e5777
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e5782 - 0x80e60b0
// Line range:    335 - 656
void store_cookie(int32_t * co, char * hostname2, char * path) {
    int32_t time_val = time(NULL); // 0x80e5790
    if (co == NULL) {
        // 0x80e60aa
        return;
    }
    // 0x80e57b4
    if (domain_list == NULL) {
        int32_t * v1 = HTList_new(); // 0x80e57bd
        *(int32_t *)&domain_list = (int32_t)v1;
        total_cookies = 0;
    }
    int32_t v2 = (int32_t)co;
    *(int32_t *)&cookie_list = 0;
    int32_t * str4 = (int32_t *)(v2 + 24); // 0x80e57de
    int32_t * v3 = find_domain_entry((char *)*str4); // 0x80e57e4
    int32_t v4 = (int32_t)v3; // 0x80e57e4
    if (v3 != NULL) {
        // 0x80e57f2
        *(int32_t *)&cookie_list = *(int32_t *)(v4 + 12);
    }
    int32_t * str = (int32_t *)(v2 + 36); // 0x80e5800
    char * v5 = NULL; // 0x80e5814
    if (is_prefix((char *)*str, path) != 0) {
        goto lab_0x80e58a7;
    } else {
        if (v3 == NULL) {
            // 0x80e5850
            v5 = (char *)1;
            goto lab_0x80e58a7;
        } else {
            // 0x80e5832
            v5 = NULL;
            switch (*(int32_t *)(v4 + 8)) {
                case 1: {
                    // 0x80e5856
                    if (WWW_TraceFlag != 0) {
                        // 0x80e5861
                        if ((WWW_TraceMask & 32) != 0) {
                            int32_t v6 = *str; // 0x80e5870
                            fprintf(TraceFP(), "store_cookie: Rejecting because '%s' is not a prefix of '%s'.\n", (char *)v6, path);
                        }
                    }
                    // 0x80e5897
                    freeCookie(co);
                    // 0x80e60aa
                    return;
                }
                case 0: {
                    // 0x80e5850
                    v5 = (char *)1;
                    goto lab_0x80e58a7;
                }
                default: {
                    goto lab_0x80e58a7;
                }
            }
        }
    }
  lab_0x80e5eb5:;
    // 0x80e5eb5
    int32_t * v7; // 0x80e5782
    int32_t * v8 = v7; // 0x80e5ebf
    int32_t v9; // 0x80e5da6
    int32_t * v10 = (int32_t *)v9; // 0x80e5ebf
    char v11; // 0x80e5782
    char v12 = v11; // 0x80e5ebf
    char v13 = v11; // 0x80e5ebf
    int32_t * v14 = v7; // 0x80e5ebf
    if (v9 == 0) {
        // break -> 0x80e5ec5
        goto lab_0x80e5ec5;
    }
    goto lab_0x80e5d9b;
  lab_0x80e5e0d:;
    // 0x80e5e0d
    int32_t v17; // 0x80e5d9e
    int32_t v19 = *(int32_t *)(v17 + 24); // 0x80e5e10
    int32_t * v16; // 0x80e5782
    int32_t * str2; // 0x80e5782
    int32_t * v18; // 0x80e5da0
    if (strcasecomp((char *)*str4, (char *)v19) != 0) {
        goto lab_0x80e5ea1;
    } else {
        // 0x80e5e29
        if (strcmp((char *)*str, (char *)*(int32_t *)(v17 + 36)) != 0) {
            goto lab_0x80e5ea1;
        } else {
            // 0x80e5e45
            if (strcmp((char *)*str2, (char *)*(int32_t *)(v17 + 4)) != 0) {
                goto lab_0x80e5ea1;
            } else {
                // 0x80e5e61
                HTList_removeObject(cookie_list, (char *)v17);
                freeCookie(v18);
                total_cookies--;
                v11 = 1;
                v7 = v16;
                goto lab_0x80e5eb5;
            }
        }
    }
  lab_0x80e5ea1:;
    // 0x80e5ea1
    char v15; // 0x80e5782
    v11 = v15;
    v7 = v16;
    if (*(int32_t *)(v17 + 40) >= *(int32_t *)(v2 + 40)) {
        // 0x80e5eb1
        v11 = v15;
        v7 = (int32_t *)((int32_t)v16 + 1);
    }
    goto lab_0x80e5eb5;
  lab_0x80e58a7:;
    // 0x80e58a7
    char * v20; // 0x80e5782
    char * v21; // 0x80e5782
    if (strcasecomp((char *)*str4, hostname2) == 0) {
        goto lab_0x80e5b36;
    } else {
        // 0x80e58c4
        if (strchr(hostname2, 46) == NULL) {
            // 0x80e58db
            if (WWW_TraceFlag != 0) {
                // 0x80e58e6
                if ((WWW_TraceMask & 32) != 0) {
                    // 0x80e58f2
                    fprintf(TraceFP(), "store_cookie: Rejecting because '%s' has no dot.\n", hostname2);
                }
            }
            // 0x80e5910
            freeCookie(co);
            // 0x80e60aa
            return;
        }
        int32_t v22 = *str4; // 0x80e5923
        v21 = (char *)v22;
        if (*v21 != 46) {
            goto lab_0x80e593d;
        } else {
            char * str3 = (char *)(v22 + 1); // 0x80e5936
            if (*str3 != 0) {
                char * found_char_pos = strchr(str3, 46); // 0x80e5999
                if (found_char_pos == NULL) {
                    goto lab_0x80e59b4;
                } else {
                    // 0x80e59a7
                    if (*(char *)((int32_t)found_char_pos + 1) != 0) {
                        // 0x80e59fc
                        if (host_matches(hostname2, (char *)*str4) == 0) {
                            // 0x80e5a15
                            if (WWW_TraceFlag != 0) {
                                // 0x80e5a20
                                if ((WWW_TraceMask & 32) != 0) {
                                    // 0x80e5a2c
                                    fprintf(TraceFP(), "store_cookie: Rejecting domain '%s' for host '%s'.\n", (char *)*str4, hostname2);
                                }
                            }
                            // 0x80e5a56
                            freeCookie(co);
                            // 0x80e60aa
                            return;
                        }
                        int32_t len = strlen(hostname2); // 0x80e5a6c
                        int32_t len2 = strlen((char *)*str4); // 0x80e5a7c
                        if (len + (int32_t)hostname2 - len2 <= (int32_t)strchr(hostname2, 46)) {
                            goto lab_0x80e5b36;
                        } else {
                            if (v3 == NULL) {
                                // 0x80e5b36
                                v20 = (char *)((int32_t)v5 | 2);
                                goto lab_0x80e5b40;
                            } else {
                                // 0x80e5ac1
                                switch (*(int32_t *)(v4 + 8)) {
                                    case 1: {
                                        // 0x80e5ae5
                                        if (WWW_TraceFlag != 0) {
                                            // 0x80e5af0
                                            if ((WWW_TraceMask & 32) != 0) {
                                                int32_t v23 = *str; // 0x80e5aff
                                                fprintf(TraceFP(), "store_cookie: Rejecting because '%s' is not a prefix of '%s'.\n", (char *)v23, path);
                                            }
                                        }
                                        // 0x80e5b26
                                        freeCookie(co);
                                        // 0x80e60aa
                                        return;
                                    }
                                    case 0: {
                                        // 0x80e5b36
                                        v20 = (char *)((int32_t)v5 | 2);
                                        goto lab_0x80e5b40;
                                    }
                                    default: {
                                        goto lab_0x80e5b36;
                                    }
                                }
                            }
                        }
                    } else {
                        goto lab_0x80e59b4;
                    }
                }
            } else {
                goto lab_0x80e593d;
            }
        }
    }
  lab_0x80e5b36:
    // 0x80e5b36
    v20 = v5;
    if (v5 == NULL) {
        goto lab_0x80e5cf6;
    } else {
        goto lab_0x80e5b40;
    }
  lab_0x80e5cf6:;
    int32_t v24 = v4; // 0x80e5cfa
    if (v3 == NULL) {
        int32_t * mem = calloc(1, 16); // 0x80e5d0f
        if (mem == NULL) {
            // 0x80e5d1d
            outofmem("./LYCookie.c", "store_cookie");
            // UNREACHABLE
        }
        int32_t v25 = (int32_t)mem; // 0x80e5d0f
        *(int32_t *)(v25 + 4) = 2;
        *(int32_t *)(v25 + 8) = 0;
        int32_t v26 = (int32_t)HTList_new(); // 0x80e5d45
        *(int32_t *)(v25 + 12) = v26;
        *(int32_t *)&cookie_list = v26;
        HTSACopy((char **)mem, (char *)*str4);
        HTList_appendObject(domain_list, (char *)mem);
        v24 = v25;
    }
    int32_t v27 = v24;
    v13 = 0;
    v14 = NULL;
    if (cookie_list != NULL) {
        // 0x80e5d9b
        str2 = (int32_t *)(v2 + 4);
        v8 = NULL;
        v10 = cookie_list;
        v12 = 0;
        while (true) {
          lab_0x80e5d9b:
            // 0x80e5d9b
            v15 = v12;
            v16 = v8;
            v17 = *v10;
            v9 = *(int32_t *)((int32_t)v10 + 4);
            v11 = v15;
            v7 = v16;
            if (v17 == 0) {
                goto lab_0x80e5eb5;
            } else {
                // 0x80e5db2
                v18 = (int32_t *)v17;
                if ((*(int32_t *)(v17 + 44) & 4) == 0) {
                    goto lab_0x80e5e0d;
                } else {
                    // 0x80e5dbf
                    if (*(int32_t *)(v17 + 48) > time_val) {
                        goto lab_0x80e5e0d;
                    } else {
                        // 0x80e5dca
                        HTList_removeObject(cookie_list, (char *)v17);
                        freeCookie(v18);
                        total_cookies--;
                        v11 = v15;
                        v7 = v16;
                        goto lab_0x80e5eb5;
                    }
                }
            }
        }
    }
  lab_0x80e5ec5:;
    int32_t * v28 = (int32_t *)(v2 + 44); // 0x80e5ec8
    if ((*v28 & 4) != 0) {
        // 0x80e5ed2
        if (*(int32_t *)(v2 + 48) <= time_val) {
            // 0x80e5edd
            freeCookie(co);
            // 0x80e60aa
            return;
        }
    }
    // 0x80e5ef4
    if (HTList_count(cookie_list) > max_cookies_domain) {
        // 0x80e5f0c
        if (WWW_TraceFlag != 0) {
            // 0x80e5f17
            if ((WWW_TraceMask & 32) != 0) {
                // 0x80e5f23
                fprintf(TraceFP(), "store_cookie: Domain's cookie limit exceeded!  Rejecting cookie.\n");
            }
        }
        // 0x80e5f3a
        freeCookie(co);
        // 0x80e60aa
        return;
    }
    // 0x80e5f51
    if (total_cookies > max_cookies_global) {
        // 0x80e5f60
        if (WWW_TraceFlag != 0) {
            // 0x80e5f6b
            if ((WWW_TraceMask & 32) != 0) {
                // 0x80e5f77
                fprintf(TraceFP(), "store_cookie: Total cookie limit exceeded!  Rejecting cookie.\n");
            }
        }
        // 0x80e5f8e
        freeCookie(co);
        // 0x80e60aa
        return;
    }
    int32_t v29 = *(int32_t *)(v2 + 8); // 0x80e5fa8
    if (v29 == 0) {
        // 0x80e5faf
        if (WWW_TraceFlag != 0) {
            // 0x80e5fba
            if ((WWW_TraceMask & 32) != 0) {
                // 0x80e5fc6
                fprintf(TraceFP(), "store_cookie: Value is NULL! Not storing cookie.\n");
            }
        }
        // 0x80e5fdd
        freeCookie(co);
        // 0x80e60aa
        return;
    }
    if (v27 != 0 && v13 == 1) {
        // 0x80e6000
        if (*(int32_t *)(v27 + 4) != 1) {
            // 0x80e600b
            HTList_insertObjectAt(cookie_list, (char *)co, (int32_t)v14);
            total_cookies++;
            // 0x80e60aa
            return;
        }
    }
    // 0x80e6036
    if ((*v28 & 32) != 0) {
        // 0x80e606d
        HTList_insertObjectAt(cookie_list, (char *)co, (int32_t)v14);
        total_cookies++;
        // 0x80e60aa
        return;
    }
    int32_t v30 = *(int32_t *)(v2 + 4); // 0x80e604c
    if (HTConfirmCookie((int32_t *)v27, hostname2, (char *)v30, (char *)v29) != 0) {
        // 0x80e606d
        HTList_insertObjectAt(cookie_list, (char *)co, (int32_t)v14);
        total_cookies++;
        // 0x80e60aa
        return;
    }
    // 0x80e6098
    freeCookie(co);
  lab_0x80e5b40:;
    char * v31 = NULL; // bp-56, 0x80e5b40
    uint32_t v32 = (int32_t)v20; // 0x80e5b47
    if ((v32 & 2) != 0) {
        char * v33 = gettext("Accept invalid cookie domain=%s for '%s'?"); // 0x80e5b62
        HTSprintf0(&v31, v33);
        if (HTForcedPrompt(cookie_noprompt, v31, 0) == 0) {
            // 0x80e5ba4
            if (WWW_TraceFlag != 0) {
                // 0x80e5baf
                if ((WWW_TraceMask & 32) != 0) {
                    // 0x80e5bbb
                    fprintf(TraceFP(), "store_cookie: Rejecting domain '%s' for host '%s'.\n", (char *)*str4, hostname2);
                }
            }
            // 0x80e5be5
            freeCookie(co);
            if (v31 != NULL) {
                // 0x80e5bfb
                free((int32_t *)v31);
                v31 = NULL;
            }
            // 0x80e60aa
            return;
        }
    }
    if (v32 % 2 != 0) {
        char * v34 = gettext("Accept invalid cookie path=%s as a prefix of '%s'?"); // 0x80e5c2d
        HTSprintf0(&v31, v34);
        if (HTForcedPrompt(cookie_noprompt, v31, 0) == 0) {
            // 0x80e5c6f
            if (WWW_TraceFlag != 0) {
                // 0x80e5c7a
                if ((WWW_TraceMask & 32) != 0) {
                    int32_t v35 = *str; // 0x80e5c89
                    fprintf(TraceFP(), "store_cookie: Rejecting because '%s' is not a prefix of '%s'.\n", (char *)v35, path);
                }
            }
            // 0x80e5cb0
            freeCookie(co);
            if (v31 != NULL) {
                // 0x80e5cc6
                free((int32_t *)v31);
                v31 = NULL;
            }
            // 0x80e60aa
            return;
        }
    }
    char * v36 = v31; // 0x80e5cdd
    if (v36 != NULL) {
        // 0x80e5ce4
        free((int32_t *)v36);
        v31 = NULL;
    }
    goto lab_0x80e5cf6;
  lab_0x80e593d:
    // 0x80e593d
    if (WWW_TraceFlag != 0) {
        // 0x80e5948
        if ((WWW_TraceMask & 32) != 0) {
            // 0x80e5954
            fprintf(TraceFP(), "store_cookie: Rejecting domain '%s'.\n", v21);
        }
    }
    // 0x80e5975
    freeCookie(co);
    // 0x80e60aa
    return;
  lab_0x80e59b4:
    // 0x80e59b4
    if (WWW_TraceFlag != 0) {
        // 0x80e59bf
        if ((WWW_TraceMask & 32) != 0) {
            // 0x80e59cb
            fprintf(TraceFP(), "store_cookie: Rejecting domain '%s'.\n", (char *)*str4);
        }
    }
    // 0x80e59ec
    freeCookie(co);
    // 0x80e60aa
    return;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e8e48 - 0x80e923c
// Line range:    1870 - 2020
void LYLoadCookies(char * cookie_file) {
    int32_t * cookie_handle = NULL; // bp-16, 0x80e8e4f
    struct _IO_FILE * v1 = fopen64(cookie_file, "r"); // 0x80e8e64
    if (v1 == NULL) {
        // 0x80e9236
        return;
    }
    // 0x80e8e76
    if (WWW_TraceFlag != 0) {
        // 0x80e8e81
        if ((WWW_TraceMask & 32) != 0) {
            // 0x80e8e8d
            fprintf(TraceFP(), "LYLoadCookies: reading cookies from %s\n", cookie_file);
        }
    }
    // 0x80e8eab
    number_of_file_cookies = 0;
    if (LYSafeGets((char **)&cookie_handle, v1) == NULL) {
        // 0x80e922b
        LYCloseInput(v1);
        // 0x80e9236
        return;
    }
    int32_t * cookie_handle2; // bp-20, 0x80e8e48
    int32_t * v2; // 0x80e90af
    int32_t v3; // 0x80e90b7
    int32_t str; // 0x80e90d0
    while (true) {
      lab_0x80e8eba:
        // 0x80e8eba
        LYTrimNewline((char *)cookie_handle);
        int32_t * v4; // 0x80e8ec5
        switch (*(char *)v4) {
            case 0: {
                goto lab_0x80e9211;
            }
            case 35: {
                goto lab_0x80e9211;
            }
            default: {
                // 0x80e8ee1
                number_of_file_cookies++;
                int32_t len = strlen((char *)cookie_handle); // 0x80e8f04
                memcpy((int32_t *)(len + (int32_t)cookie_handle), &g391, (int32_t)&g391);
                if (WWW_TraceFlag != 0) {
                    // 0x80e8f1f
                    if ((WWW_TraceMask & 32) != 0) {
                        // 0x80e8f2b
                        fprintf(TraceFP(), "LYLoadCookies: tokenising %s\n", cookie_handle);
                    }
                }
                int32_t v5 = (int32_t)cookie_handle; // bp-36, 0x80e8f4c
                char * v6 = LYstrsep((char **)&v5, "\t"); // 0x80e8f5d
                char * v7 = v6; // 0x80e9004
                int32_t v8 = 0; // 0x80e9004
                if (v6 != NULL) {
                    int32_t v9 = 0;
                    int32_t v10 = 8 * v9; // 0x80e9009
                    int32_t * v11 = (int32_t *)(v10 + (int32_t)&g147); // 0x80e9009
                    int32_t v12 = *v11; // 0x80e9009
                    v8 = v9;
                    while (v12 != 0) {
                        char * v13 = v7;
                        int32_t v14 = v12; // 0x80e8f7a
                        if (WWW_TraceFlag != 0) {
                            // 0x80e8f7c
                            v14 = v12;
                            if ((WWW_TraceMask & 32) != 0) {
                                // 0x80e8f88
                                fprintf(TraceFP(), "\t%d:[%03d]:[%s]\n", v9, (int32_t)v13 - (int32_t)cookie_handle, v13);
                                v14 = *v11;
                            }
                        }
                        int32_t v15 = *(int32_t *)(v10 + (int32_t)&g148); // 0x80e8fc0
                        LYstrncpy((char *)v14, v13, v15);
                        char * v16 = LYstrsep((char **)&v5, "\t"); // 0x80e8ff4
                        int32_t v17 = v9 + 1; // 0x80e8ffc
                        int32_t v18 = v17; // 0x80e9004
                        v7 = v16;
                        v8 = v17;
                        if (v16 == NULL) {
                            // break -> 0x80e9018
                            break;
                        }
                        v9 = v18;
                        v10 = 8 * v9;
                        v11 = (int32_t *)(v10 + (int32_t)&g147);
                        v12 = *v11;
                        v8 = v9;
                    }
                }
                int32_t v19 = *(int32_t *)(8 * v8 + (int32_t)&g147); // 0x80e901b
                if (v19 == 0) {
                    // 0x80e9061
                    cookie_handle2 = (int32_t *)atol((char *)&g310);
                    if (WWW_TraceFlag != 0) {
                        // 0x80e907b
                        if ((WWW_TraceMask & 32) != 0) {
                            char * time_str = ctime((int32_t *)&cookie_handle2); // 0x80e908d
                            fprintf(TraceFP(), "expires:\t%s\n", time_str);
                        }
                    }
                    // 0x80e90af
                    v2 = newCookie();
                    v3 = (int32_t)v2;
                    HTSACopy((char **)(v3 + 24), (char *)&g316);
                    str = v3 + 36;
                    HTSACopy((char **)str, (char *)&g315);
                    HTSACopy((char **)(v3 + 4), (char *)&g314);
                    if (*(char *)&g312 != 34 || *(char *)&g313 == 0) {
                        // 0x80e9178
                        HTSACopy((char **)(v3 + 8), (char *)&g312);
                        goto lab_0x80e918e;
                    } else {
                        int32_t len2 = strlen((char *)&g312); // 0x80e9116
                        if (*(char *)(len2 + (int32_t)&g312 - 1) != 34) {
                            // 0x80e9178
                            HTSACopy((char **)(v3 + 8), (char *)&g312);
                            goto lab_0x80e918e;
                        } else {
                            int32_t len3 = strlen((char *)&g312); // 0x80e9130
                            if (*(char *)(len3 + (int32_t)&g312 - 2) == 92) {
                                // 0x80e9178
                                HTSACopy((char **)(v3 + 8), (char *)&g312);
                                goto lab_0x80e918e;
                            } else {
                                int32_t len4 = strlen((char *)&g312); // 0x80e914a
                                *(char *)(len4 + (int32_t)&g312 - 1) = 0;
                                HTSACopy((char **)(v3 + 8), (char *)&g313);
                                *(char *)(v3 + 52) = 1;
                                goto lab_0x80e918e;
                            }
                        }
                    }
                } else {
                    // 0x80e9026
                    if (WWW_TraceFlag != 0) {
                        // 0x80e9035
                        if ((WWW_TraceMask & 32) != 0) {
                            // 0x80e9045
                            fprintf(TraceFP(), "*** wrong format: not enough tokens, ignoring line!\n");
                        }
                    }
                    goto lab_0x80e9211;
                }
            }
        }
    }
  lab_0x80e922b:
    // 0x80e922b
    LYCloseInput(v1);
  lab_0x80e9211:
    // 0x80e9211
    if (LYSafeGets((char **)&cookie_handle, v1) == NULL) {
        // break -> 0x80e922b
        goto lab_0x80e922b;
    }
    goto lab_0x80e8eba;
  lab_0x80e918e:
    // 0x80e918e
    *(int32_t *)(v3 + 40) = strlen((char *)*(int32_t *)str);
    int32_t * v20 = (int32_t *)(v3 + 44); // 0x80e91a7
    int32_t v21 = *v20; // 0x80e91a7
    int32_t v22 = v21 | 52; // 0x80e91ac
    *v20 = v22;
    int32_t v23 = v22; // 0x80e91be
    if (*(char *)&g316 == 46) {
        int32_t v24 = v21 | 60; // 0x80e91c8
        *v20 = v24;
        v23 = v24;
    }
    // 0x80e91d1
    if (g311 != 70) {
        // 0x80e91dc
        *v20 = v23 | 1;
    }
    // 0x80e91ed
    *(int32_t *)(v3 + 48) = (int32_t)cookie_handle2;
    store_cookie(v2, (char *)&g316, (char *)&g315);
    goto lab_0x80e9211;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e923c - 0x80e9284
// Line range:    2023 - 2026
struct _IO_FILE * NewCookieFile(char * cookie_file) {
    // 0x80e923c
    if (WWW_TraceFlag == 0) {
        // 0x80e9277
        return LYNewTxtFile(cookie_file);
    }
    // 0x80e924d
    if ((WWW_TraceMask & 32) != 0) {
        // 0x80e9259
        fprintf(TraceFP(), "LYStoreCookies: save cookies to %s on exit\n", cookie_file);
    }
    // 0x80e9277
    return LYNewTxtFile(cookie_file);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80e9284 - 0x80e95f0
// Line range:    2030 - 2117
void LYStoreCookies(char * cookie_file) {
    int32_t time_val = time(NULL); // 0x80e9299
    if (cookie_file == NULL || *cookie_file == 0 || strcmp(cookie_file, "/dev/null") == 0) {
        // 0x80e95ea
        return;
    }
    // 0x80e92d4
    int32_t * v1; // 0x80e9284
    if (domain_list == NULL) {
        goto lab_0x80e92e9;
    } else {
        // 0x80e92dd
        if (cookie_list != NULL) {
            // 0x80e92f6
            v1 = NULL;
            if (number_of_file_cookies == 0) {
                goto lab_0x80e9324;
            } else {
                goto lab_0x80e92ff;
            }
        } else {
            goto lab_0x80e92e9;
        }
    }
  lab_0x80e92e9:
    // 0x80e92e9
    if (number_of_file_cookies == 0) {
        // 0x80e95ea
        return;
    }
    goto lab_0x80e92ff;
  lab_0x80e92ff:;
    struct _IO_FILE * v2 = NewCookieFile(cookie_file); // 0x80e9305
    if (v2 == NULL) {
        // 0x80e95ea
        return;
    }
    // 0x80e9317
    v1 = &v2->e0;
    int32_t * v3 = &v2->e0; // 0x80e95d3
    if (domain_list != NULL) {
        goto lab_0x80e9324;
    } else {
        goto lab_0x80e95d9;
    }
  lab_0x80e9324:;
    char * v4 = (char *)domain_list; // 0x80e9284
    int32_t v5 = *(int32_t *)v4; // 0x80e9327
    int32_t * v6 = v1; // 0x80e9330
    char * v7; // 0x80e9284
    char * v8; // 0x80e9284
    int32_t v9; // 0x80e9284
    int32_t v10; // 0x80e9284
    int32_t * v11; // 0x80e9284
    int32_t * stream; // 0x80e9284
    int32_t * v12; // 0x80e9284
    int32_t * v13; // 0x80e9284
    int32_t v14; // 0x80e9284
    int32_t v15; // 0x80e9284
    int32_t v16; // 0x80e9284
    char * v17; // 0x80e9284
    char * v18; // 0x80e9284
    int32_t * v19; // 0x80e9329
    int32_t v20; // 0x80e9347
    int32_t * v21; // 0x80e939a
    int32_t v22; // 0x80e939a
    int32_t * v23; // 0x80e942a
    int32_t v24; // 0x80e942a
    char v25; // 0x80e948e
    int32_t v26; // 0x80e94a9
    int32_t v27; // 0x80e94e0
    int32_t v28; // 0x80e950f
    char * v29; // 0x80e951a
    struct _IO_FILE * v30; // 0x80e9479
    if (v5 != 0) {
        // 0x80e9336
        v19 = (int32_t *)v5;
        v15 = *(int32_t *)(v5 + 12);
        v16 = v15;
        v6 = v1;
        if (v15 != 0) {
            v20 = *(int32_t *)v16;
            v12 = v1;
            if (v20 != 0) {
                // 0x80e9356
                if (WWW_TraceFlag != 0) {
                    // 0x80e9361
                    if ((WWW_TraceMask & 32) != 0) {
                        // 0x80e936d
                        fprintf(TraceFP(), "LYStoreCookies: %d cf %d ", time_val, *(int32_t *)(v20 + 48));
                    }
                }
                // 0x80e9397
                v21 = (int32_t *)(v20 + 44);
                v22 = *v21;
                if ((v22 & 2) == 0) {
                    if ((v22 & 4) != 0) {
                        // 0x80e9427
                        v23 = (int32_t *)(v20 + 48);
                        v24 = *v23;
                        if (v24 > time_val) {
                            // 0x80e946d
                            v9 = v22;
                            v10 = v24;
                            v11 = v1;
                            if (v1 == NULL) {
                                // 0x80e9473
                                v30 = NewCookieFile(cookie_file);
                                if (v30 == NULL) {
                                    // 0x80e95ea
                                    return;
                                }
                                // 0x80e9473
                                v9 = *v21;
                                v10 = *v23;
                                v11 = &v30->e0;
                            }
                            // 0x80e948b
                            stream = v11;
                            v25 = *(char *)(v20 + 52);
                            v7 = v25 == 0 ? (char *)&g59 : (char *)&g60;
                            v26 = *(int32_t *)(v20 + 8);
                            v18 = v26 == 0 ? (char *)&g59 : (char *)v26;
                            v27 = *(int32_t *)(v20 + 4);
                            v17 = v9 % 2 == 0 ? "FALSE" : "TRUE";
                            v28 = *(int32_t *)(v20 + 36);
                            v29 = (char *)*v19;
                            v8 = *v29 != 46 ? "FALSE" : "TRUE";
                            fprintf((struct _IO_FILE *)stream, "%s\t%s\t%s\t%s\t%d\t%s\t%s%s%s\n", v29, v8, (char *)v28, v17, v10, (char *)v27, v7, v18, v7);
                            v12 = stream;
                            if (WWW_TraceFlag != 0) {
                                // 0x80e9590
                                v12 = stream;
                                if ((WWW_TraceMask & 32) != 0) {
                                    // 0x80e959c
                                    fprintf(TraceFP(), "STORED\n");
                                    v12 = stream;
                                }
                            }
                        } else {
                            // 0x80e9432
                            v12 = v1;
                            if (WWW_TraceFlag != 0) {
                                // 0x80e9441
                                v12 = v1;
                                if ((WWW_TraceMask & 32) != 0) {
                                    // 0x80e9451
                                    fprintf(TraceFP(), "not stored - EXPIRED\n");
                                    v12 = v1;
                                }
                            }
                        }
                    } else {
                        // 0x80e93ec
                        v12 = v1;
                        if (WWW_TraceFlag != 0) {
                            // 0x80e93fb
                            v12 = v1;
                            if ((WWW_TraceMask & 32) != 0) {
                                // 0x80e940b
                                fprintf(TraceFP(), "not stored - no expiration time\n");
                                v12 = v1;
                            }
                        }
                    }
                } else {
                    // 0x80e93a4
                    v12 = v1;
                    if (WWW_TraceFlag != 0) {
                        // 0x80e93b3
                        v12 = v1;
                        if ((WWW_TraceMask & 32) != 0) {
                            // 0x80e93c3
                            fprintf(TraceFP(), "not stored - DISCARD\n");
                            v12 = v1;
                        }
                    }
                }
            }
            // 0x80e95b3
            v14 = *(int32_t *)(v16 + 4);
            v16 = v14;
            v6 = v12;
            while (v14 != 0) {
                // 0x80e9344
                v13 = v12;
                v20 = *(int32_t *)v16;
                v12 = v13;
                if (v20 != 0) {
                    // 0x80e9356
                    if (WWW_TraceFlag != 0) {
                        // 0x80e9361
                        if ((WWW_TraceMask & 32) != 0) {
                            // 0x80e936d
                            fprintf(TraceFP(), "LYStoreCookies: %d cf %d ", time_val, *(int32_t *)(v20 + 48));
                        }
                    }
                    // 0x80e9397
                    v21 = (int32_t *)(v20 + 44);
                    v22 = *v21;
                    if ((v22 & 2) == 0) {
                        if ((v22 & 4) != 0) {
                            // 0x80e9427
                            v23 = (int32_t *)(v20 + 48);
                            v24 = *v23;
                            if (v24 > time_val) {
                                // 0x80e946d
                                v9 = v22;
                                v10 = v24;
                                v11 = v13;
                                if (v13 == NULL) {
                                    // 0x80e9473
                                    v30 = NewCookieFile(cookie_file);
                                    if (v30 == NULL) {
                                        // 0x80e95ea
                                        return;
                                    }
                                    // 0x80e9473
                                    v9 = *v21;
                                    v10 = *v23;
                                    v11 = &v30->e0;
                                }
                                // 0x80e948b
                                stream = v11;
                                v25 = *(char *)(v20 + 52);
                                v7 = v25 == 0 ? (char *)&g59 : (char *)&g60;
                                v26 = *(int32_t *)(v20 + 8);
                                v18 = v26 == 0 ? (char *)&g59 : (char *)v26;
                                v27 = *(int32_t *)(v20 + 4);
                                v17 = v9 % 2 == 0 ? "FALSE" : "TRUE";
                                v28 = *(int32_t *)(v20 + 36);
                                v29 = (char *)*v19;
                                v8 = *v29 != 46 ? "FALSE" : "TRUE";
                                fprintf((struct _IO_FILE *)stream, "%s\t%s\t%s\t%s\t%d\t%s\t%s%s%s\n", v29, v8, (char *)v28, v17, v10, (char *)v27, v7, v18, v7);
                                v12 = stream;
                                if (WWW_TraceFlag != 0) {
                                    // 0x80e9590
                                    v12 = stream;
                                    if ((WWW_TraceMask & 32) != 0) {
                                        // 0x80e959c
                                        fprintf(TraceFP(), "STORED\n");
                                        v12 = stream;
                                    }
                                }
                            } else {
                                // 0x80e9432
                                v12 = v13;
                                if (WWW_TraceFlag != 0) {
                                    // 0x80e9441
                                    v12 = v13;
                                    if ((WWW_TraceMask & 32) != 0) {
                                        // 0x80e9451
                                        fprintf(TraceFP(), "not stored - EXPIRED\n");
                                        v12 = v13;
                                    }
                                }
                            }
                        } else {
                            // 0x80e93ec
                            v12 = v13;
                            if (WWW_TraceFlag != 0) {
                                // 0x80e93fb
                                v12 = v13;
                                if ((WWW_TraceMask & 32) != 0) {
                                    // 0x80e940b
                                    fprintf(TraceFP(), "not stored - no expiration time\n");
                                    v12 = v13;
                                }
                            }
                        }
                    } else {
                        // 0x80e93a4
                        v12 = v13;
                        if (WWW_TraceFlag != 0) {
                            // 0x80e93b3
                            v12 = v13;
                            if ((WWW_TraceMask & 32) != 0) {
                                // 0x80e93c3
                                fprintf(TraceFP(), "not stored - DISCARD\n");
                                v12 = v13;
                            }
                        }
                    }
                }
                // 0x80e95b3
                v14 = *(int32_t *)(v16 + 4);
                v16 = v14;
                v6 = v12;
            }
        }
    }
    int32_t v31 = *(int32_t *)((int32_t)v4 + 4); // 0x80e95c9
    v4 = (char *)v31;
    v3 = v6;
    while (v31 != 0) {
        int32_t * v32 = v6;
        v5 = *(int32_t *)v4;
        v6 = v32;
        if (v5 != 0) {
            // 0x80e9336
            v19 = (int32_t *)v5;
            v15 = *(int32_t *)(v5 + 12);
            v16 = v15;
            int32_t * v33 = v32; // 0x80e95c0
            v6 = v32;
            if (v15 != 0) {
                v13 = v33;
                v20 = *(int32_t *)v16;
                v12 = v13;
                if (v20 != 0) {
                    // 0x80e9356
                    if (WWW_TraceFlag != 0) {
                        // 0x80e9361
                        if ((WWW_TraceMask & 32) != 0) {
                            // 0x80e936d
                            fprintf(TraceFP(), "LYStoreCookies: %d cf %d ", time_val, *(int32_t *)(v20 + 48));
                        }
                    }
                    // 0x80e9397
                    v21 = (int32_t *)(v20 + 44);
                    v22 = *v21;
                    if ((v22 & 2) == 0) {
                        if ((v22 & 4) != 0) {
                            // 0x80e9427
                            v23 = (int32_t *)(v20 + 48);
                            v24 = *v23;
                            if (v24 > time_val) {
                                // 0x80e946d
                                v9 = v22;
                                v10 = v24;
                                v11 = v13;
                                if (v13 == NULL) {
                                    // 0x80e9473
                                    v30 = NewCookieFile(cookie_file);
                                    if (v30 == NULL) {
                                        // 0x80e95ea
                                        return;
                                    }
                                    // 0x80e9473
                                    v9 = *v21;
                                    v10 = *v23;
                                    v11 = &v30->e0;
                                }
                                // 0x80e948b
                                stream = v11;
                                v25 = *(char *)(v20 + 52);
                                v7 = v25 == 0 ? (char *)&g59 : (char *)&g60;
                                v26 = *(int32_t *)(v20 + 8);
                                v18 = v26 == 0 ? (char *)&g59 : (char *)v26;
                                v27 = *(int32_t *)(v20 + 4);
                                v17 = v9 % 2 == 0 ? "FALSE" : "TRUE";
                                v28 = *(int32_t *)(v20 + 36);
                                v29 = (char *)*v19;
                                v8 = *v29 != 46 ? "FALSE" : "TRUE";
                                fprintf((struct _IO_FILE *)stream, "%s\t%s\t%s\t%s\t%d\t%s\t%s%s%s\n", v29, v8, (char *)v28, v17, v10, (char *)v27, v7, v18, v7);
                                v12 = stream;
                                if (WWW_TraceFlag != 0) {
                                    // 0x80e9590
                                    v12 = stream;
                                    if ((WWW_TraceMask & 32) != 0) {
                                        // 0x80e959c
                                        fprintf(TraceFP(), "STORED\n");
                                        v12 = stream;
                                    }
                                }
                            } else {
                                // 0x80e9432
                                v12 = v13;
                                if (WWW_TraceFlag != 0) {
                                    // 0x80e9441
                                    v12 = v13;
                                    if ((WWW_TraceMask & 32) != 0) {
                                        // 0x80e9451
                                        fprintf(TraceFP(), "not stored - EXPIRED\n");
                                        v12 = v13;
                                    }
                                }
                            }
                        } else {
                            // 0x80e93ec
                            v12 = v13;
                            if (WWW_TraceFlag != 0) {
                                // 0x80e93fb
                                v12 = v13;
                                if ((WWW_TraceMask & 32) != 0) {
                                    // 0x80e940b
                                    fprintf(TraceFP(), "not stored - no expiration time\n");
                                    v12 = v13;
                                }
                            }
                        }
                    } else {
                        // 0x80e93a4
                        v12 = v13;
                        if (WWW_TraceFlag != 0) {
                            // 0x80e93b3
                            v12 = v13;
                            if ((WWW_TraceMask & 32) != 0) {
                                // 0x80e93c3
                                fprintf(TraceFP(), "not stored - DISCARD\n");
                                v12 = v13;
                            }
                        }
                    }
                }
                // 0x80e95b3
                v14 = *(int32_t *)(v16 + 4);
                v16 = v14;
                v6 = v12;
                while (v14 != 0) {
                    // 0x80e9344
                    v13 = v12;
                    v20 = *(int32_t *)v16;
                    v12 = v13;
                    if (v20 != 0) {
                        // 0x80e9356
                        if (WWW_TraceFlag != 0) {
                            // 0x80e9361
                            if ((WWW_TraceMask & 32) != 0) {
                                // 0x80e936d
                                fprintf(TraceFP(), "LYStoreCookies: %d cf %d ", time_val, *(int32_t *)(v20 + 48));
                            }
                        }
                        // 0x80e9397
                        v21 = (int32_t *)(v20 + 44);
                        v22 = *v21;
                        if ((v22 & 2) == 0) {
                            if ((v22 & 4) != 0) {
                                // 0x80e9427
                                v23 = (int32_t *)(v20 + 48);
                                v24 = *v23;
                                if (v24 > time_val) {
                                    // 0x80e946d
                                    v9 = v22;
                                    v10 = v24;
                                    v11 = v13;
                                    if (v13 == NULL) {
                                        // 0x80e9473
                                        v30 = NewCookieFile(cookie_file);
                                        if (v30 == NULL) {
                                            // 0x80e95ea
                                            return;
                                        }
                                        // 0x80e9473
                                        v9 = *v21;
                                        v10 = *v23;
                                        v11 = &v30->e0;
                                    }
                                    // 0x80e948b
                                    stream = v11;
                                    v25 = *(char *)(v20 + 52);
                                    v7 = v25 == 0 ? (char *)&g59 : (char *)&g60;
                                    v26 = *(int32_t *)(v20 + 8);
                                    v18 = v26 == 0 ? (char *)&g59 : (char *)v26;
                                    v27 = *(int32_t *)(v20 + 4);
                                    v17 = v9 % 2 == 0 ? "FALSE" : "TRUE";
                                    v28 = *(int32_t *)(v20 + 36);
                                    v29 = (char *)*v19;
                                    v8 = *v29 != 46 ? "FALSE" : "TRUE";
                                    fprintf((struct _IO_FILE *)stream, "%s\t%s\t%s\t%s\t%d\t%s\t%s%s%s\n", v29, v8, (char *)v28, v17, v10, (char *)v27, v7, v18, v7);
                                    v12 = stream;
                                    if (WWW_TraceFlag != 0) {
                                        // 0x80e9590
                                        v12 = stream;
                                        if ((WWW_TraceMask & 32) != 0) {
                                            // 0x80e959c
                                            fprintf(TraceFP(), "STORED\n");
                                            v12 = stream;
                                        }
                                    }
                                } else {
                                    // 0x80e9432
                                    v12 = v13;
                                    if (WWW_TraceFlag != 0) {
                                        // 0x80e9441
                                        v12 = v13;
                                        if ((WWW_TraceMask & 32) != 0) {
                                            // 0x80e9451
                                            fprintf(TraceFP(), "not stored - EXPIRED\n");
                                            v12 = v13;
                                        }
                                    }
                                }
                            } else {
                                // 0x80e93ec
                                v12 = v13;
                                if (WWW_TraceFlag != 0) {
                                    // 0x80e93fb
                                    v12 = v13;
                                    if ((WWW_TraceMask & 32) != 0) {
                                        // 0x80e940b
                                        fprintf(TraceFP(), "not stored - no expiration time\n");
                                        v12 = v13;
                                    }
                                }
                            }
                        } else {
                            // 0x80e93a4
                            v12 = v13;
                            if (WWW_TraceFlag != 0) {
                                // 0x80e93b3
                                v12 = v13;
                                if ((WWW_TraceMask & 32) != 0) {
                                    // 0x80e93c3
                                    fprintf(TraceFP(), "not stored - DISCARD\n");
                                    v12 = v13;
                                }
                            }
                        }
                    }
                    // 0x80e95b3
                    v14 = *(int32_t *)(v16 + 4);
                    v16 = v14;
                    v6 = v12;
                }
            }
        }
        // 0x80e95c6
        v31 = *(int32_t *)((int32_t)v4 + 4);
        v4 = (char *)v31;
        v3 = v6;
    }
    goto lab_0x80e95d9;
  lab_0x80e95d9:
    // 0x80e95d9
    if (v3 != NULL) {
        // 0x80e95df
        LYCloseOutput((struct _IO_FILE *)v3);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80ea65e - 0x80ea914
// Line range:    2570 - 2671
void cookie_domain_flag_set(char * domainstr, int32_t flag) {
    int32_t * mem = calloc(1, 4); // 0x80ea67c
    int32_t * de = NULL; // bp-24, 0x80ea684
    if (mem == NULL) {
        char * v1 = gettext("cookie_domain_flag_set error, aborting program"); // 0x80ea69f
        HTAlwaysAlert(gettext("Internal"), v1);
        exit_immediately(1);
        // UNREACHABLE
    }
    // 0x80ea6ca
    if (domain_list == NULL) {
        int32_t * v2 = HTList_new(); // 0x80ea6d3
        *(int32_t *)&domain_list = (int32_t)v2;
        total_cookies = 0;
    }
    // 0x80ea6e7
    HTSACopy((char **)&de, domainstr);
    *mem = (int32_t)de;
    char * v3 = LYstrsep((char **)mem, ","); // 0x80ea8b2
    if (v3 != NULL) {
        char * v4; // 0x80ea65e
        char * v5; // 0x80ea65e
        int32_t * v6; // 0x80ea71a
        int32_t * mem2; // 0x80ea73b
        int32_t v7; // 0x80ea75d
        int32_t * v8; // 0x80ea760
        int32_t * v9; // 0x80ea76a
        int32_t v10; // 0x80ea870
        int32_t v11; // 0x80ea873
        int32_t v12; // 0x80ea879
        if (*v3 != 0) {
            // 0x80ea714
            v6 = find_domain_entry(v3);
            v4 = (char *)v6;
            if (v6 == NULL) {
                // 0x80ea72c
                mem2 = calloc(1, 16);
                if (mem2 == NULL) {
                    // 0x80ea749
                    outofmem("./LYCookie.c", "cookie_domain_flag_set");
                    // UNREACHABLE
                }
                // 0x80ea75d
                v7 = (int32_t)mem2;
                v8 = (int32_t *)(v7 + 4);
                *v8 = 0;
                v9 = (int32_t *)(v7 + 8);
                *v9 = 0;
                g381 = flag;
                switch (flag) {
                    case 0: {
                        // 0x80ea785
                        *v9 = 0;
                        // break -> 0x80ea7cb
                        break;
                    }
                    case 1: {
                        // 0x80ea791
                        *v9 = 0;
                        // break -> 0x80ea7cb
                        break;
                    }
                    case 2: {
                        // 0x80ea79d
                        *v9 = 0;
                        // break -> 0x80ea7cb
                        break;
                    }
                    case 4: {
                        // 0x80ea7a9
                        *v8 = 2;
                        // break -> 0x80ea7cb
                        break;
                    }
                    case 5: {
                        // 0x80ea7b5
                        *v8 = 2;
                        // break -> 0x80ea7cb
                        break;
                    }
                    case 6: {
                        // 0x80ea7c1
                        *v8 = 2;
                        // break -> 0x80ea7cb
                        break;
                    }
                }
                // 0x80ea7cb
                HTSACopy((char **)mem2, v3);
                *(int32_t *)(v7 + 12) = (int32_t)HTList_new();
                HTList_appendObject(domain_list, (char *)mem2);
                v4 = (char *)mem2;
            }
            // 0x80ea805
            v5 = v4;
            g383 = flag;
            switch (flag) {
                case 0: {
                    // 0x80ea813
                    *(int32_t *)((int32_t)v5 + 4) = 0;
                    // break -> 0x80ea859
                    break;
                }
                case 1: {
                    // 0x80ea81f
                    *(int32_t *)((int32_t)v5 + 4) = 1;
                    // break -> 0x80ea859
                    break;
                }
                case 2: {
                    // 0x80ea82b
                    *(int32_t *)((int32_t)v5 + 4) = 2;
                    // break -> 0x80ea859
                    break;
                }
                case 4: {
                    // 0x80ea837
                    *(int32_t *)((int32_t)v5 + 8) = 0;
                    // break -> 0x80ea859
                    break;
                }
                case 5: {
                    // 0x80ea843
                    *(int32_t *)((int32_t)v5 + 8) = 1;
                    // break -> 0x80ea859
                    break;
                }
                case 6: {
                    // 0x80ea84f
                    *(int32_t *)((int32_t)v5 + 8) = 2;
                    // break -> 0x80ea859
                    break;
                }
            }
            // 0x80ea859
            if (WWW_TraceFlag != 0) {
                // 0x80ea864
                if ((WWW_TraceMask & 32) != 0) {
                    // 0x80ea870
                    v10 = (int32_t)v5;
                    v11 = *(int32_t *)(v10 + 8);
                    v12 = *(int32_t *)(v10 + 4);
                    fprintf(TraceFP(), "cookie_domain_flag_set (%s, bv=%u, invcheck_bv=%u)\n", v3, v12, v11);
                }
            }
        }
        char * v13 = LYstrsep((char **)mem, ","); // 0x80ea8b2
        while (v13 != NULL) {
            char * v14 = v13;
            if (*v14 != 0) {
                // 0x80ea714
                v6 = find_domain_entry(v14);
                v4 = (char *)v6;
                if (v6 == NULL) {
                    // 0x80ea72c
                    mem2 = calloc(1, 16);
                    if (mem2 == NULL) {
                        // 0x80ea749
                        outofmem("./LYCookie.c", "cookie_domain_flag_set");
                        // UNREACHABLE
                    }
                    // 0x80ea75d
                    v7 = (int32_t)mem2;
                    v8 = (int32_t *)(v7 + 4);
                    *v8 = 0;
                    v9 = (int32_t *)(v7 + 8);
                    *v9 = 0;
                    g381 = flag;
                    switch (flag) {
                        case 0: {
                            // 0x80ea785
                            *v9 = 0;
                            // break -> 0x80ea7cb
                            break;
                        }
                        case 1: {
                            // 0x80ea791
                            *v9 = 0;
                            // break -> 0x80ea7cb
                            break;
                        }
                        case 2: {
                            // 0x80ea79d
                            *v9 = 0;
                            // break -> 0x80ea7cb
                            break;
                        }
                        case 4: {
                            // 0x80ea7a9
                            *v8 = 2;
                            // break -> 0x80ea7cb
                            break;
                        }
                        case 5: {
                            // 0x80ea7b5
                            *v8 = 2;
                            // break -> 0x80ea7cb
                            break;
                        }
                        case 6: {
                            // 0x80ea7c1
                            *v8 = 2;
                            // break -> 0x80ea7cb
                            break;
                        }
                    }
                    // 0x80ea7cb
                    HTSACopy((char **)mem2, v14);
                    *(int32_t *)(v7 + 12) = (int32_t)HTList_new();
                    HTList_appendObject(domain_list, (char *)mem2);
                    v4 = (char *)mem2;
                }
                // 0x80ea805
                v5 = v4;
                g383 = flag;
                switch (flag) {
                    case 0: {
                        // 0x80ea813
                        *(int32_t *)((int32_t)v5 + 4) = 0;
                        // break -> 0x80ea859
                        break;
                    }
                    case 1: {
                        // 0x80ea81f
                        *(int32_t *)((int32_t)v5 + 4) = 1;
                        // break -> 0x80ea859
                        break;
                    }
                    case 2: {
                        // 0x80ea82b
                        *(int32_t *)((int32_t)v5 + 4) = 2;
                        // break -> 0x80ea859
                        break;
                    }
                    case 4: {
                        // 0x80ea837
                        *(int32_t *)((int32_t)v5 + 8) = 0;
                        // break -> 0x80ea859
                        break;
                    }
                    case 5: {
                        // 0x80ea843
                        *(int32_t *)((int32_t)v5 + 8) = 1;
                        // break -> 0x80ea859
                        break;
                    }
                    case 6: {
                        // 0x80ea84f
                        *(int32_t *)((int32_t)v5 + 8) = 2;
                        // break -> 0x80ea859
                        break;
                    }
                }
                // 0x80ea859
                if (WWW_TraceFlag != 0) {
                    // 0x80ea864
                    if ((WWW_TraceMask & 32) != 0) {
                        // 0x80ea870
                        v10 = (int32_t)v5;
                        v11 = *(int32_t *)(v10 + 8);
                        v12 = *(int32_t *)(v10 + 4);
                        fprintf(TraceFP(), "cookie_domain_flag_set (%s, bv=%u, invcheck_bv=%u)\n", v14, v12, v11);
                    }
                }
            }
            // 0x80ea8a4
            v13 = LYstrsep((char **)mem, ",");
        }
    }
    // 0x80ea8f4
    free(mem);
    if (de != NULL) {
        // 0x80ea8fb
        free(de);
        de = NULL;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYCookie.c
// Address range: 0x80ea914 - 0x80ea9e6
// Line range:    2680 - 2714
void LYConfigCookies(void) {
    for (int32_t i = 0; i < 10; i++) {
        int32_t v1 = 12 * i; // 0x80ea92f
        int32_t * v2 = (int32_t *)(v1 + (int32_t)&g61); // 0x80ea932
        int32_t v3 = *(int32_t *)*v2; // 0x80ea938
        if (v3 != 0) {
            int32_t v4 = *(int32_t *)(v1 + (int32_t)&g62); // 0x80ea94e
            cookie_domain_flag_set((char *)v3, v4);
            if (*(int32_t *)(v1 + (int32_t)&g63) != 0) {
                int32_t v5 = *(int32_t *)*v2; // 0x80ea99c
                if (v5 != 0) {
                    // 0x80ea9a2
                    free((int32_t *)v5);
                    *(int32_t *)*v2 = 0;
                }
            }
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ea9e8 - 0x80eaa09
// Line range:    123 - 127
char * TrimLowercase(char * buffer) {
    // 0x80ea9e8
    LYRemoveBlanks(buffer);
    strtolower(buffer);
    return buffer;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80eaa09 - 0x80eaae0
// Line range:    136 - 158
void parse_either(char * attrs, int32_t dft_color, int32_t * monop, int32_t * colorp) {
    // 0x80eaa09
    if (*attrs == 0) {
        // 0x80eaade
        return;
    }
    char * str = attrs;
    char * found_char_pos = strchr(str, 43); // 0x80eaa22
    bool v1; // 0x80eaa09
    char v2; // 0x80eaa09
    int32_t v3; // 0x80eaa09
    int32_t v4; // 0x80eaa22
    char v5; // 0x80eaa33
    if (found_char_pos == NULL) {
        // 0x80eaa5d
        v1 = true;
        v3 = strlen(str) + (int32_t)str;
        v2 = 0;
    } else {
        // 0x80eaa5d
        v4 = (int32_t)found_char_pos;
        v5 = *found_char_pos;
        v1 = true;
        v3 = v4;
        v2 = 0;
        if (v5 != 0) {
            // 0x80eaa63
            *found_char_pos = 0;
            v1 = false;
            v3 = v4;
            v2 = v5;
        }
    }
    char v6 = v2;
    int32_t v7 = v3;
    int32_t v8 = string_to_attr(str); // 0x80eaa6f
    int32_t v9; // 0x80eaaa1
    if (v8 == 0) {
        if (colorp != NULL) {
            // 0x80eaa94
            v9 = check_color(str, dft_color);
            if (v9 != -3) {
                // 0x80eaaaf
                *colorp = v9;
            }
        }
    } else {
        // 0x80eaa7d
        *monop = *monop | v8;
    }
    char * v10 = (char *)v7; // 0x80eaaba
    char * v11 = v10; // 0x80eaac1
    if (!v1) {
        // 0x80eaac3
        *v10 = v6;
        v11 = (char *)(v7 + 1);
    }
    // 0x80eaad0
    while (*v11 != 0) {
        // 0x80eaa14
        str = v11;
        found_char_pos = strchr(str, 43);
        if (found_char_pos == NULL) {
            // 0x80eaa5d
            v1 = true;
            v3 = strlen(str) + (int32_t)str;
            v2 = 0;
        } else {
            // 0x80eaa5d
            v4 = (int32_t)found_char_pos;
            v5 = *found_char_pos;
            v1 = true;
            v3 = v4;
            v2 = 0;
            if (v5 != 0) {
                // 0x80eaa63
                *found_char_pos = 0;
                v1 = false;
                v3 = v4;
                v2 = v5;
            }
        }
        // 0x80eaa69
        v6 = v2;
        v7 = v3;
        v8 = string_to_attr(str);
        if (v8 == 0) {
            if (colorp != NULL) {
                // 0x80eaa94
                v9 = check_color(str, dft_color);
                if (v9 != -3) {
                    // 0x80eaaaf
                    *colorp = v9;
                }
            }
        } else {
            // 0x80eaa7d
            *monop = *monop | v8;
        }
        // 0x80eaab7
        v10 = (char *)v7;
        v11 = v10;
        if (!v1) {
            // 0x80eaac3
            *v10 = v6;
            v11 = (char *)(v7 + 1);
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80eaae0 - 0x80eaff2
// Line range:    166 - 253
void parse_attributes(char * mono, char * fg, char * bg, uint32_t style, char * element) {
    int32_t v1 = 0; // bp-20, 0x80eaae9
    int32_t mA = default_fg; // bp-24, 0x80eaaf5
    int32_t mA2 = default_bg; // bp-28, 0x80eaafd
    int32_t fA = 0; // bp-32, 0x80eab00
    int32_t v2 = hash_code(element); // 0x80eab0d
    if (WWW_TraceFlag != 0) {
        // 0x80eab20
        if ((WWW_TraceMask & 2) != 0) {
            // 0x80eab2c
            fprintf(TraceFP(), "CSS(PA):style d=%d / h=%d, e=%s\n", style, v2, element);
        }
    }
    // 0x80eab5a
    parse_either(mono, -3, &v1, NULL);
    parse_either(bg, default_bg, &fA, &mA2);
    parse_either(fg, default_fg, &fA, &mA);
    if (style == -1) {
        // 0x80eabc8
        if (WWW_TraceFlag != 0) {
            // 0x80eabd3
            if ((WWW_TraceMask & 2) != 0) {
                // 0x80eabdf
                fprintf(TraceFP(), "CSS(DEF):default_fg=%d, default_bg=%d\n", mA, mA2);
            }
        }
        // 0x80eac04
        default_fg = mA;
        default_bg = mA2;
        default_color_reset = 1;
        // 0x80eafea
        return;
    }
    int32_t v3 = mA; // 0x80eac20
    int32_t v4; // 0x80eaae0
    int32_t v5; // 0x80eaae0
    if (v3 != -2) {
        int32_t v6 = g157;
        if (v6 == 0) {
            // 0x80eaca6
            fA = 0x200000;
            mA = -2;
            mA2 = -2;
            v4 = -2;
            v5 = -2;
        } else {
            int32_t v7 = mA2; // 0x80eac49
            if (v3 < v6 != v7 < v6) {
                // 0x80eac55
                fA = 0x200000;
            }
            int32_t v8 = v3; // 0x80eac66
            if (v3 >= v6) {
                // 0x80eac68
                v8 = (0x100000000 * (int64_t)(v3 >> 31) | (int64_t)v3) % (g157 & 0xffffffff);
                mA = v8;
            }
            // 0x80eac80
            v4 = v7;
            v5 = v8;
            if (v7 >= v6) {
                int32_t v9 = (0x100000000 * (int64_t)(v7 >> 31) | (int64_t)v7) % (g157 & 0xffffffff); // 0x80eac9c
                mA2 = v9;
                v4 = v9;
                v5 = v8;
            }
        }
    } else {
        // 0x80eac28
        mA2 = -2;
        v4 = -2;
        v5 = v3;
    }
    // 0x80eacbb
    int32_t v10; // 0x80eaae0
    int32_t v11; // 0x80eaae0
    int32_t v12; // 0x80ead02
    int32_t v13; // 0x80eaf54
    int32_t v14; // 0x80eaae0
    if (lynx_has_color == 0) {
        goto lab_0x80eaf96;
    } else {
        // 0x80eacc8
        v13 = v5;
        int32_t v15 = g172 - 1; // 0x80eaccd
        if (v13 == -2 || v15 <= colorPairs) {
            // 0x80eaf4b
            if (v13 != -2 && WWW_TraceFlag != 0) {
                // 0x80eaf67
                if ((WWW_TraceMask & 2) != 0) {
                    // 0x80eaf73
                    fprintf(TraceFP(), "CSS(NC): maximum of %d colorpairs exhausted\n", v15);
                }
            }
            goto lab_0x80eaf96;
        } else {
            // 0x80eace9
            v12 = v4;
            v10 = v12;
            v11 = v13;
            if (WWW_TraceFlag != 0) {
                // 0x80ead39
                v10 = v12;
                v11 = v13;
                if ((WWW_TraceMask & 2) != 0) {
                    // 0x80ead45
                    fprintf(TraceFP(), "parse_attributes %d/%d %d/%d %#x\n", v13, default_fg, v12, default_bg, fA);
                    v10 = mA2;
                    v11 = mA;
                }
            }
            // 0x80ead91
            v14 = 0;
            if (v10 > 15 || v11 > 15) {
                goto lab_0x80eaead;
            } else {
                // 0x80eada9
                if (fA != 0) {
                    goto lab_0x80eadd9;
                } else {
                    // 0x80eadb0
                    v14 = 0;
                    if (v11 == default_fg == v10 == default_bg) {
                        goto lab_0x80eaead;
                    } else {
                        goto lab_0x80eadd9;
                    }
                }
            }
        }
    }
  lab_0x80eaf96:
    if (style <= 132) {
        // 0x80eaf9f
        setStyle(style, -1, -1, v1);
    }
    // 0x80eafc1
    setHashStyle(v2, -1, -1, v1, element);
  lab_0x80eaead:
    // 0x80eaead
    if (WWW_TraceFlag != 0) {
        // 0x80eaeb8
        if ((WWW_TraceMask & 2) != 0) {
            // 0x80eaec4
            fprintf(TraceFP(), "CSS(CURPAIR):%d\n", v14);
        }
    }
    int32_t v16; // 0x80eaae0
    if (style > 132) {
        // 0x80eaee2
        v16 = 256 * v14;
    } else {
        int32_t v17 = fA;
        int32_t v18 = 256 * v14;
        setStyle(style, v17 | v18, v17, v1);
        v16 = v18;
    }
    int32_t v19 = fA;
    setHashStyle(v2, v19 | v16, v19, v1, element);
    // 0x80eafea
    return;
  lab_0x80eadd9:;
    int32_t v20 = (fA & 0x200000) != 0 ? 289 : 0; // 0x80eadf5
    char * v21 = (char *)((v12 & (int32_t)(v12 < 0) - 1) + (int32_t)&our_pairs + 18 + 17 * (v13 & (int32_t)(v13 < 0) - 1) + v20); // 0x80eae05
    unsigned char v22 = *v21; // 0x80eae05
    if (v22 == 0) {
        int32_t v23 = colorPairs + 1; // 0x80eae48
        colorPairs = v23;
        function_804ae04(0x10000 * v23 >> 16, 0x10000 * v11 >> 16, 0x10000 * v10 >> 16);
        *v21 = (char)v23;
        v14 = v23;
    } else {
        // 0x80eae0c
        v14 = v22;
    }
    goto lab_0x80eaead;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80eaff2 - 0x80eb3be
// Line range:    259 - 382
void parse_style(char * param) {
    int32_t n = 0; // bp-20, 0x80eaffd
    if (param == NULL) {
        // 0x80eb3b8
        return;
    }
    // 0x80eb015
    if (WWW_TraceFlag != 0) {
        // 0x80eb020
        if ((WWW_TraceMask & 2) != 0) {
            // 0x80eb02c
            fprintf(TraceFP(), "parse_style(%s)\n", param);
        }
    }
    // 0x80eb04a
    HTSACopy((char **)&n, param);
    if (n == 0) {
        // 0x80eb3b8
        return;
    }
    // 0x80eb067
    TrimLowercase((char *)n);
    char * found_char_pos = strchr((char *)n, 58); // 0x80eb080
    if (found_char_pos == NULL) {
        // 0x80eb08e
        fprintf((struct _IO_FILE *)g160, gettext("Syntax Error parsing style in lss file:\n[%s]\nThe line must be of the form:\nOBJECT:MONO:COLOR (ie em:bold:brightblue:white)\nwhere OBJECT is one of EM,STRONG,B,I,U,BLINK etc.\n\n"));
        exit_immediately(1);
        // UNREACHABLE
    }
    // 0x80eb0bf
    *found_char_pos = 0;
    char * str = (char *)((int32_t)found_char_pos + 1); // 0x80eb0d1
    char * found_char_pos2 = strchr(str, 58); // 0x80eb0e2
    char * v1 = "nocolor"; // 0x80eb0ee
    char * v2 = "nocolor"; // 0x80eb0ee
    if (found_char_pos2 != NULL) {
        // 0x80eb100
        *found_char_pos2 = 0;
        char * str2 = (char *)((int32_t)found_char_pos2 + 1); // 0x80eb10c
        char * found_char_pos3 = strchr(str2, 58); // 0x80eb11d
        v1 = str2;
        v2 = "default";
        if (found_char_pos3 != NULL) {
            // 0x80eb134
            *found_char_pos3 = 0;
            v1 = str2;
            v2 = (char *)((int32_t)found_char_pos3 + 1);
        }
    }
    char * v3 = (char *)n; // 0x80eb0c8
    if (WWW_TraceFlag != 0) {
        // 0x80eb14e
        if ((WWW_TraceMask & 2) != 0) {
            int32_t v4 = hash_code(v3); // 0x80eb160
            int32_t v5 = *(int32_t *)(24 * v4 + (int32_t)&hashStyles); // 0x80eb170
            char * v6 = v5 == 0 ? (char *)&g64 : "used";
            int32_t v7 = hash_code(v3); // 0x80eb190
            fprintf(TraceFP(), "CSSPARSE:%s => %d %s\n", v3, v7, v6);
        }
    }
    int32_t v8 = 0; // 0x80eb286
    int32_t v9 = 12 * v8; // 0x80eb1d7
    int32_t * v10 = (int32_t *)(v9 + (int32_t)&g149);
    while (strcasecomp(v3, (char *)*v10) != 0) {
        // 0x80eb28a
        v8++;
        if (v8 >= 27) {
            int32_t * v11 = SGMLFindTag(&HTML_dtd, v3); // 0x80eb30e
            if (v11 == NULL) {
                // 0x80eb377
                parse_attributes(str, v1, v2, 133, v3);
                goto lab_0x80eb39f;
            } else {
                // 0x80eb31c
                if (*v11 == 0) {
                    // 0x80eb377
                    parse_attributes(str, v1, v2, 133, v3);
                    goto lab_0x80eb39f;
                } else {
                    int32_t v12 = -0x49249249 * ((int32_t)v11 - (int32_t)&tags >> 3); // 0x80eb336
                    if (v12 < 0 || (char *)v12 > (char *)117) {
                        // 0x80eb377
                        parse_attributes(str, v1, v2, 133, v3);
                        goto lab_0x80eb39f;
                    } else {
                        // 0x80eb34b
                        parse_attributes(str, v1, v2, v12 + 8, v3);
                        goto lab_0x80eb39f;
                    }
                }
            }
        }
        v9 = 12 * v8;
        v10 = (int32_t *)(v9 + (int32_t)&g149);
    }
    int32_t v13 = *(int32_t *)(v9 + (int32_t)&g150); // 0x80eb215
    parse_attributes(str, v1, v2, v13, (char *)*v10);
    int32_t v14 = *(int32_t *)(v9 + (int32_t)&g151); // 0x80eb248
    if (v14 != 0) {
        // 0x80eb252
        *(int32_t *)v14 = hash_code((char *)*v10);
    }
    // 0x80eb29a
    if (strcasecomp(v3, "normal") == 0) {
        // 0x80eb2b5
        parse_attributes(str, v1, v2, 128, "html");
        s_normal = hash_code("html");
        LYnormalColor();
    }
    goto lab_0x80eb39f;
  lab_0x80eb39f:
    // 0x80eb39f
    if (n != 0) {
        // 0x80eb3a6
        free((int32_t *)n);
        n = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80eb3be - 0x80eb3dd
// Line range:    385 - 388
void style_deleteStyleList(void) {
    // 0x80eb3be
    LYFreeStringList(lss_styles);
    *(int32_t *)&lss_styles = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80eb3dd - 0x80eb410
// Line range:    391 - 396
void free_colorstylestuff(void) {
    // 0x80eb3dd
    style_initialiseHashTable();
    style_deleteStyleList();
    memset((int32_t *)&our_pairs, 0, 578);
    FreeCachedStyles();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80eb410 - 0x80eb5fd
// Line range:    402 - 506
void initialise_default_stylesheet(void) {
    char * v1 = LYgetTableString(0); // 0x80eb41d
    char * v2 = LYgetTableString(4); // 0x80eb42c
    if (WWW_TraceFlag != 0) {
        // 0x80eb43f
        if ((WWW_TraceMask & 10) != 0) {
            // 0x80eb462
            fprintf(TraceFP(), "initialise_default_stylesheet\n");
        }
    }
    int32_t v3 = 0; // 0x80eb4e9
    char * strong = NULL; // bp-24, 0x80eb482
    int32_t v4 = *(int32_t *)(56 * v3 + (int32_t)&tags); // 0x80eb4a5
    HTSprintf0(&strong, "%s:%s", (char *)v4, v1);
    parse_style(strong);
    char * v5 = strong; // 0x80eb4d0
    if (v5 != NULL) {
        // 0x80eb4d7
        free((int32_t *)v5);
        strong = NULL;
    }
    // 0x80eb4e9
    v3++;
    int32_t v6 = 0; // 0x80eb4f5
    while (v3 != 118) {
        // 0x80eb482
        strong = NULL;
        v4 = *(int32_t *)(56 * v3 + (int32_t)&tags);
        HTSprintf0(&strong, "%s:%s", (char *)v4, v1);
        parse_style(strong);
        v5 = strong;
        if (v5 != NULL) {
            // 0x80eb4d7
            free((int32_t *)v5);
            strong = NULL;
        }
        // 0x80eb4e9
        v3++;
        v6 = 0;
    }
    int32_t v7 = 8 * v6; // 0x80eb506
    int32_t v8 = *(int32_t *)(v7 + (int32_t)&g65); // 0x80eb506
    strong = NULL;
    char * v9 = v1; // 0x80eb410
    char * v10; // 0x80eb410
    int32_t v11; // 0x80eb553
    char * v12; // 0x80eb583
    switch (v8) {
        case 4: {
            // 0x80eb53a
            v9 = v2;
        }
        case 0: {
            // 0x80eb550
            v10 = v9;
            v11 = *(int32_t *)(v7 + (int32_t)&g66);
            HTSprintf0(&strong, "%s:%s", (char *)v11, v10);
            parse_style(strong);
            v12 = strong;
            if (v12 != NULL) {
                // 0x80eb58a
                free((int32_t *)v12);
                strong = NULL;
            }
            // break -> 0x80eb59c
            break;
        }
        default: {
            // 0x80eb542
            v9 = LYgetTableString(v8);
            // branch (via goto) -> 0x80eb550
            goto lab_0x80eb550;
        }
    }
    if (v1 != v10) {
        if (v10 != NULL && v2 != v10) {
            // 0x80eb5b2
            free((int32_t *)v10);
        }
    }
    int32_t v13 = v6 + 1; // 0x80eb5bd
    v6 = v13;
    while (v13 != 27) {
        // 0x80eb503
        v7 = 8 * v6;
        v8 = *(int32_t *)(v7 + (int32_t)&g65);
        strong = NULL;
        v9 = v1;
        switch (v8) {
            case 4: {
                // 0x80eb53a
                v9 = v2;
            }
            case 0: {
                // 0x80eb550
                v10 = v9;
                v11 = *(int32_t *)(v7 + (int32_t)&g66);
                HTSprintf0(&strong, "%s:%s", (char *)v11, v10);
                parse_style(strong);
                v12 = strong;
                if (v12 != NULL) {
                    // 0x80eb58a
                    free((int32_t *)v12);
                    strong = NULL;
                }
                // break -> 0x80eb59c
                break;
            }
            default: {
                // 0x80eb542
                v9 = LYgetTableString(v8);
                // branch (via goto) -> 0x80eb550
                goto lab_0x80eb550;
            }
        }
        if (v1 != v10) {
            if (v10 != NULL && v2 != v10) {
                // 0x80eb5b2
                free((int32_t *)v10);
            }
        }
        // 0x80eb5bd
        v13 = v6 + 1;
        v6 = v13;
    }
    if (v1 != NULL) {
        // 0x80eb5d1
        free((int32_t *)v1);
    }
    if (v2 != NULL) {
        // 0x80eb5e9
        free((int32_t *)v2);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80eb5fd - 0x80eb77b
// Line range:    510 - 540
void style_initialiseHashTable(void) {
    for (int32_t i = 0; i < 0x2001; i++) {
        int32_t v1 = 24 * i;
        int32_t * v2 = (int32_t *)(v1 + (int32_t)&hashStyles);
        if (g152 == 0) {
            int32_t v3 = *v2; // 0x80eb640
            if (v3 != 0) {
                // 0x80eb64a
                free((int32_t *)v3);
                *v2 = 0;
            }
        } else {
            // 0x80eb618
            *v2 = 0;
        }
        // 0x80eb67a
        *(int32_t *)(v1 + (int32_t)&g358) = 0;
        *(int32_t *)(v1 + (int32_t)&g360) = 0;
        *(int32_t *)(v1 + (int32_t)&g359) = 0;
    }
    if (g152 != 0) {
        // 0x80eb6d6
        g152 = 0;
    }
    // 0x80eb6e0
    s_alink = hash_code("alink");
    s_a = hash_code("a");
    s_status = hash_code("status");
    s_alert = hash_code("alert");
    s_title = hash_code("title");
    s_sb_bar = hash_code("scroll.bar");
    s_sb_bg = hash_code("scroll.back");
    s_sb_aa = hash_code("scroll.arrow");
    s_sb_naa = hash_code("scroll.noarrow");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80eb77b - 0x80eb95d
// Line range:    543 - 581
void parse_userstyles(void) {
    // 0x80eb77b
    colorPairs = 0;
    style_initialiseHashTable();
    if (lss_styles == NULL) {
        // 0x80eb7a8
        initialise_default_stylesheet();
        goto lab_0x80eb843;
    } else {
        // 0x80eb79e
        if (cached_styles_ptr != NULL) {
            int32_t v1 = *(int32_t *)((int32_t)lss_styles + 4); // 0x80eb816
            int32_t v2 = v1; // 0x80eb820
            if (v1 != 0) {
                int32_t v3 = *(int32_t *)v2; // 0x80eb825
                while (v3 != 0) {
                    // 0x80eb7b2
                    if (WWW_TraceFlag != 0) {
                        // 0x80eb7bd
                        if ((WWW_TraceMask & 2) != 0) {
                            // 0x80eb7c9
                            fprintf(TraceFP(), "LSS:%s\n", (char *)v3);
                        }
                    }
                    // 0x80eb80d
                    parse_style((char *)v3);
                    int32_t v4 = *(int32_t *)(v2 + 4); // 0x80eb816
                    v2 = v4;
                    if (v4 == 0) {
                        // break -> 0x80eb843
                        break;
                    }
                    v3 = *(int32_t *)v2;
                }
            }
            goto lab_0x80eb843;
        } else {
            // 0x80eb7a8
            initialise_default_stylesheet();
            goto lab_0x80eb843;
        }
    }
  lab_0x80eb843:;
    int32_t v5 = s_prompt_edit; // 0x80eb84b
    if (s_prompt_edit == -1) {
        // 0x80eb84d
        s_prompt_edit = s_normal;
        v5 = s_normal;
    }
    // 0x80eb857
    if (s_prompt_edit_arr == -1) {
        // 0x80eb861
        s_prompt_edit_arr = v5;
    }
    // 0x80eb86b
    if (s_prompt_edit_pad == -1) {
        // 0x80eb875
        s_prompt_edit_pad = v5;
    }
    // 0x80eb87f
    if (s_prompt_sel == -1) {
        // 0x80eb889
        s_prompt_sel = v5;
    }
    int32_t v6 = s_aedit; // 0x80eb89b
    if (s_aedit == -1) {
        // 0x80eb89d
        s_aedit = s_alink;
        v6 = s_alink;
    }
    // 0x80eb8a7
    if (s_aedit_arr == -1) {
        // 0x80eb8b1
        s_aedit_arr = v6;
    }
    // 0x80eb8bb
    if (s_aedit_pad == -1) {
        // 0x80eb8c5
        s_aedit_pad = v6;
    }
    // 0x80eb8cf
    if (s_curedit == -1) {
        // 0x80eb8d9
        s_curedit = v6;
    }
    // 0x80eb8e3
    if (s_aedit_sel == -1) {
        // 0x80eb8ed
        s_aedit_sel = v6;
    }
    int32_t v7 = s_menu_bg; // 0x80eb8ff
    if (s_menu_bg == -1) {
        // 0x80eb901
        s_menu_bg = s_normal;
        v7 = s_normal;
    }
    // 0x80eb90b
    if (s_menu_entry == -1) {
        // 0x80eb915
        s_menu_entry = v7;
    }
    // 0x80eb91f
    if (s_menu_frame == -1) {
        // 0x80eb929
        s_menu_frame = v7;
    }
    // 0x80eb933
    if (s_menu_number == -1) {
        // 0x80eb93d
        s_menu_number = v7;
    }
    // 0x80eb947
    if (s_menu_active == -1) {
        // 0x80eb951
        s_menu_active = s_alink;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80eb95d - 0x80ebaf0
// Line range:    588 - 610
void HStyle_addStyle(char * buffer) {
    char * v1 = NULL; // bp-8, 0x80eb963
    if (WWW_TraceFlag != 0) {
        // 0x80eb975
        if ((WWW_TraceMask & 10) != 0) {
            // 0x80eb998
            fprintf(TraceFP(), "HStyle_addStyle(%s)\n", buffer);
        }
    }
    // 0x80eb9b6
    HTSACopy(&v1, buffer);
    TrimLowercase(v1);
    if (lss_styles == NULL) {
        int32_t * v2 = HTList_new(); // 0x80eb9dc
        *(int32_t *)&lss_styles = (int32_t)v2;
    }
    // 0x80eb9e6
    if (strncasecomp(v1, "default:", 8) != 0) {
        if (WWW_TraceFlag != 0) {
            // 0x80eba99
            if ((WWW_TraceMask & 2) != 0) {
                char * v3 = v1; // 0x80ebaa5
                fprintf(TraceFP(), "READCSS:%s\n", v3 == NULL ? "!?! empty !?!" : v3);
            }
        }
        // 0x80ebad9
        HTList_addObject(lss_styles, v1);
        // 0x80ebaee
        return;
    }
    if (WWW_TraceFlag != 0) {
        // 0x80eba14
        if ((WWW_TraceMask & 2) != 0) {
            char * v4 = v1; // 0x80eba20
            char * v5 = default_color_reset == 0 ? (char *)&g64 : ".ignore";
            fprintf(TraceFP(), "READCSS.default%s:%s\n", v5, v4 == NULL ? "!?! empty !?!" : v4);
        }
    }
    // 0x80eba76
    if (default_color_reset == 0) {
        // 0x80eba81
        parse_style(v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ebaf0 - 0x80ebcac
// Line range:    614 - 648
int32_t style_readFromFileREC(char * lss_filename, char * parent_filename) {
    int32_t * fh = NULL; // bp-12, 0x80ebaf6
    if (WWW_TraceFlag != 0) {
        // 0x80ebb08
        if ((WWW_TraceMask & 2) != 0) {
            // 0x80ebb14
            fprintf(TraceFP(), "CSS:Reading styles from file: %s\n", lss_filename == NULL ? "?!? empty ?!?" : lss_filename);
        }
    }
    // 0x80ebb47
    if (lss_filename == NULL || *lss_filename == 0) {
        // 0x80ebca7
        return -1;
    }
    struct _IO_FILE * v1 = LYOpenCFG(lss_filename, parent_filename, "/etc/lynx-cur/lynx.lss"); // 0x80ebb78
    if (v1 == NULL) {
        // 0x80ebb86
        if (WWW_TraceFlag == 0) {
            // 0x80ebca7
            return -1;
        }
        // 0x80ebb91
        if ((WWW_TraceMask & 2) != 0) {
            // 0x80ebb9d
            fprintf(TraceFP(), "CSS:Can't open style file '%s', using defaults\n", lss_filename);
        }
        // 0x80ebca7
        return -1;
    }
    if (parent_filename == NULL) {
        // 0x80ebbd1
        free_colorstylestuff();
    }
    // 0x80ebc65
    if (LYSafeGets((char **)&fh, v1) != NULL) {
        LYTrimTrailing((char *)fh);
        LYTrimTail((char *)fh);
        LYTrimHead((char *)fh);
        if (strncasecomp((char *)fh, "include:", 8) != 0) {
            // 0x80ebc3c
            if (*(char *)fh != 35) {
                // 0x80ebc46
                if (strlen((char *)fh) >= 1) {
                    // 0x80ebc5a
                    HStyle_addStyle((char *)fh);
                }
            }
        } else {
            // 0x80ebc1b
            style_readFromFileREC(LYSkipBlanks((char *)((int32_t)fh + 8)), lss_filename);
        }
        while (LYSafeGets((char **)&fh, v1) != NULL) {
            // 0x80ebbdb
            LYTrimTrailing((char *)fh);
            LYTrimTail((char *)fh);
            LYTrimHead((char *)fh);
            if (strncasecomp((char *)fh, "include:", 8) != 0) {
                // 0x80ebc3c
                if (*(char *)fh != 35) {
                    // 0x80ebc46
                    if (strlen((char *)fh) >= 1) {
                        // 0x80ebc5a
                        HStyle_addStyle((char *)fh);
                    }
                }
            } else {
                // 0x80ebc1b
                style_readFromFileREC(LYSkipBlanks((char *)((int32_t)fh + 8)), lss_filename);
            }
        }
    }
    // 0x80ebc7f
    LYCloseInput(v1);
    if (parent_filename == NULL && LYCursesON != 0) {
        // 0x80ebc9b
        parse_userstyles();
    }
    // 0x80ebca7
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ebcac - 0x80ebcc7
// Line range:    651 - 653
int32_t style_readFromFile(char * filename) {
    // 0x80ebcac
    return style_readFromFileREC(filename, NULL);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ebeb4 - 0x80ebf63
// Line range:    719 - 728
void cache_tag_styles(void) {
    char buf[200]; // bp-216, 0x80ebeb4
    char v1[200]; // 0x80ebf39
    int32_t v2 = __readgsdword(20); // 0x80ebebe
    buf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    int32_t v3 = *(int32_t *)&buf; // 0x80ebf40
    if (v3 < 118) {
        int32_t v4 = *(int32_t *)(56 * v3 + (int32_t)&tags); // 0x80ebef4
        int32_t v5; // bp-212, 0x80ebeb4
        LYstrncpy((char *)&v5, (char *)v4, 199);
        LYLowerCase((char *)&v5);
        int32_t v6 = hash_code((char *)&v5); // 0x80ebf2d
        *(int32_t *)(4 * v3 + (int32_t)&cached_tag_styles) = v6;
        v1[0] = (char)*(int32_t *)&buf + 1;
        buf = v1;
        uint32_t v7 = *(int32_t *)&buf; // 0x80ebf40
        while (v7 < 118) {
            // 0x80ebed5
            v4 = *(int32_t *)(56 * v7 + (int32_t)&tags);
            LYstrncpy((char *)&v5, (char *)v4, 199);
            LYLowerCase((char *)&v5);
            v6 = hash_code((char *)&v5);
            *(int32_t *)(4 * v7 + (int32_t)&cached_tag_styles) = v6;
            v1[0] = (char)*(int32_t *)&buf + 1;
            buf = v1;
            v7 = *(int32_t *)&buf;
        }
    }
    // 0x80ebf49
    if (v2 != __readgsdword(20)) {
        // 0x80ebf55
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ebf63 - 0x80ebff5
// Line range:    733 - 748
int32_t * RefCachedStyle(int32_t y, int32_t x) {
    int32_t * mem = cached_styles_ptr; // 0x80ebf77
    if (cached_styles_ptr == NULL) {
        // 0x80ebf79
        cached_styles_rows = display_lines;
        cached_styles_cols = LYcols;
        mem = calloc(LYcols * display_lines, 4);
        *(int32_t *)&cached_styles_ptr = (int32_t)mem;
    }
    // 0x80ebfb0
    if (y > -1 == x > -1 != cached_styles_rows > y) {
        // 0x80ebff0
        return NULL;
    }
    int32_t * result = NULL; // 0x80ebfce
    if (cached_styles_cols > x) {
        // 0x80ebfd0
        result = (int32_t *)(4 * (cached_styles_cols * y + x) + (int32_t)mem);
    }
    // 0x80ebff0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ebff5 - 0x80ec014
// Line range:    751 - 753
char ValidCachedStyle(int32_t y, int32_t x) {
    // 0x80ebff5
    return RefCachedStyle(y, x) != NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ec014 - 0x80ec049
// Line range:    756 - 764
int32_t GetCachedStyle(int32_t y, int32_t x) {
    int32_t * v1 = RefCachedStyle(y, x); // 0x80ec02e
    int32_t result = 0; // 0x80ec03a
    if (v1 != NULL) {
        // 0x80ec03c
        result = *v1;
    }
    // 0x80ec044
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ec049 - 0x80ec074
// Line range:    767 - 773
void SetCachedStyle(int32_t y, int32_t x, int32_t value) {
    int32_t * v1 = RefCachedStyle(y, x); // 0x80ec05c
    if (v1 != NULL) {
        // 0x80ec06a
        *v1 = value;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ec074 - 0x80ec0b0
// Line range:    776 - 780
void ResetCachedStyles(void) {
    // 0x80ec074
    if (cached_styles_ptr != NULL) {
        // 0x80ec083
        memset(cached_styles_ptr, 0, 4 * cached_styles_rows * cached_styles_cols);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYStyle.c
// Address range: 0x80ec0b0 - 0x80ec0f5
// Line range:    783 - 789
void FreeCachedStyles(void) {
    // 0x80ec0b0
    if (cached_styles_ptr != NULL) {
        // 0x80ec0c8
        free(cached_styles_ptr);
        *(int32_t *)&cached_styles_ptr = 0;
        cached_styles_rows = 0;
        cached_styles_cols = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHash.c
// Address range: 0x80ec0f8 - 0x80ec16b
// Line range:    17 - 25
int32_t hash_code(char * string) {
    char v1 = *string; // 0x80ec15b
    if (v1 == 0) {
        // 0x80ec162
        return 0;
    }
    int32_t result = 0;
    int32_t v2 = (int32_t)string; // 0x80ec154
    result = (3 * result + (int32_t)v1) % 0x2001;
    v2++;
    char v3 = *(char *)v2; // 0x80ec15b
    while (v3 != 0) {
        // 0x80ec10e
        result = (3 * result + (int32_t)v3) % 0x2001;
        v2++;
        v3 = *(char *)v2;
    }
    // 0x80ec162
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHash.c
// Address range: 0x80ec16b - 0x80ec22a
// Line range:    28 - 36
int32_t hash_code_lowercase_on_fly(char * string) {
    // 0x80ec16b
    if (*string == 0) {
        // 0x80ec221
        return 0;
    }
    int32_t result = 0;
    int32_t v1 = (int32_t)string; // 0x80ec20f
    int16_t * v2 = *__ctype_b_loc(); // 0x80ec195
    int32_t c = (int32_t)*string; // 0x80ec19a
    int32_t v3 = c; // 0x80ec1b2
    if ((*(int16_t *)(2 * c + (int32_t)v2) & 256) != 0) {
        // 0x80ec1b4
        v3 = tolower(c) % 256;
    }
    // 0x80ec1d9
    result = (v3 + 3 * result) % 0x2001;
    v1++;
    char * v4 = (char *)v1; // 0x80ec216
    while (*v4 != 0) {
        // 0x80ec184
        v2 = *__ctype_b_loc();
        c = (int32_t)*v4;
        v3 = c;
        if ((*(int16_t *)(2 * c + (int32_t)v2) & 256) != 0) {
            // 0x80ec1b4
            v3 = tolower(c) % 256;
        }
        // 0x80ec1d9
        result = (v3 + 3 * result) % 0x2001;
        v1++;
        v4 = (char *)v1;
    }
    // 0x80ec221
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHash.c
// Address range: 0x80ec22a - 0x80ec27f
// Line range:    39 - 41
int32_t hash_code_aggregate_char(unsigned char c, int32_t hash) {
    // 0x80ec22a
    return (3 * hash + (int32_t)c) % 0x2001;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYHash.c
// Address range: 0x80ec27f - 0x80ec33d
// Line range:    44 - 52
int32_t hash_code_aggregate_lower_str(char * string, int32_t hash_was) {
    // 0x80ec27f
    if (*string == 0) {
        // 0x80ec334
        return hash_was;
    }
    int32_t result = hash_was;
    int32_t v1 = (int32_t)string; // 0x80ec322
    int16_t * v2 = *__ctype_b_loc(); // 0x80ec2a8
    int32_t c = (int32_t)*string; // 0x80ec2ad
    int32_t v3 = c; // 0x80ec2c5
    if ((*(int16_t *)(2 * c + (int32_t)v2) & 256) != 0) {
        // 0x80ec2c7
        v3 = tolower(c) % 256;
    }
    // 0x80ec2ec
    result = (v3 + 3 * result) % 0x2001;
    v1++;
    char * v4 = (char *)v1; // 0x80ec329
    while (*v4 != 0) {
        // 0x80ec297
        v2 = *__ctype_b_loc();
        c = (int32_t)*v4;
        v3 = c;
        if ((*(int16_t *)(2 * c + (int32_t)v2) & 256) != 0) {
            // 0x80ec2c7
            v3 = tolower(c) % 256;
        }
        // 0x80ec2ec
        result = (v3 + 3 * result) % 0x2001;
        v1++;
        v4 = (char *)v1;
    }
    // 0x80ec334
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrettySrc.c
// Address range: 0x80ec340 - 0x80ec393
// Line range:    77 - 81
int32_t html_src_tag_index(char * tagname) {
    int32_t * v1 = SGMLFindTag(&HTML_dtd, tagname); // 0x80ec354
    int32_t result = -1; // 0x80ec360
    if (v1 != NULL && v1 != &HTTag_unrecognized) {
        // 0x80ec36b
        result = -0x49249249 * ((int32_t)v1 - (int32_t)&tags >> 3);
    }
    // 0x80ec38e
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrettySrc.c
// Address range: 0x80ec393 - 0x80ec494
// Line range:    93 - 125
void append_close_tag(char * tagname, int32_t ** head, int32_t ** tail) {
    int32_t v1 = html_src_tag_index(tagname); // 0x80ec39f
    if (v1 == -1) {
        // 0x80ec3d5
        fprintf((struct _IO_FILE *)g160, "internal error: previous check didn't find bad HTML tag %s", tagname);
        exit_immediately(1);
        // UNREACHABLE
    }
    int32_t nmemb = *(int32_t *)(56 * v1 + (int32_t)&tags + 16); // 0x80ec3c9
    int32_t mem = (int32_t)calloc(1, 28); // 0x80ec40d
    *(int32_t *)(mem + 12) = v1;
    *(int32_t *)(mem + 16) = (int32_t)calloc(nmemb, 1);
    *(int32_t *)(mem + 20) = (int32_t)calloc(nmemb, 4);
    *(char *)(mem + 24) = 0;
    *(int32_t *)(mem + 8) = 0;
    if (*head != NULL) {
        // 0x80ec480
        **tail = mem;
        *(int32_t *)tail = mem;
    } else {
        // 0x80ec46e
        *(int32_t *)head = mem;
        *(int32_t *)tail = mem;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrettySrc.c
// Address range: 0x80ec494 - 0x80ec565
// Line range:    133 - 172
void append_open_tag(char * tagname, char * classname, int32_t ** head, int32_t ** tail) {
    // 0x80ec494
    append_close_tag(tagname, head, tail);
    int32_t v1 = (int32_t)*tail; // 0x80ec4b6
    *(char *)(v1 + 24) = 1;
    int32_t v2 = hash_code_lowercase_on_fly(tagname); // 0x80ec4ea
    if (classname == NULL || *classname == 0) {
        // 0x80ec544
        HTSACopy((char **)(v1 + 8), (char *)&g67);
        // 0x80ec55a
        *(int32_t *)(v1 + 4) = v2;
        return;
    }
    int32_t v3 = hash_code_aggregate_lower_str(classname, hash_code_aggregate_char(46, v2)); // 0x80ec525
    HTSACopy((char **)(v1 + 8), classname);
    // 0x80ec55a
    *(int32_t *)(v1 + 4) = v3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrettySrc.c
// Address range: 0x80ec565 - 0x80ecb4d
// Line range:    185 - 340
int32_t html_src_parse_tagspec(char * ts, int32_t lexeme, char checkonly, char isstart) {
    int32_t v1 = (int32_t)ts;
    char * p = NULL; // bp-28, 0x80ec587
    char * classend = NULL; // bp-48, 0x80ec5a0
    int32_t state = 0; // bp-52, 0x80ec5a7
    int32_t v2 = isstart == 0 ? (int32_t)&lexeme_end : (int32_t)&lexeme_start; // 0x80ec5ca
    char * v3 = NULL; // 0x80ec565
    char v4 = 0; // 0x80ec565
    char * v5 = NULL; // 0x80ec565
    char v6 = v1; // 0x80ec565
    char v7 = 0;
    char * v8; // 0x80ec565
    char v9; // 0x80ec565
    char v10; // 0x80ec565
    char v11; // 0x80ec565
    char v12; // 0x80ec565
    char v13; // 0x80ec565
    char result; // 0x80ec565
    char v14; // 0x80ec565
    char v15; // 0x80ec565
    char v16; // 0x80ec565
    int32_t v17; // 0x80ec77f
    char v18; // 0x80ec782
    int32_t v19; // 0x80ec565
    char * v20; // 0x80ec565
    while (true) {
      lab_0x80ec5d5:
        // 0x80ec5d5
        v15 = v7;
        v10 = v6;
        v8 = v5;
        v16 = v4;
        char * v21 = v3;
        if (v21 == (char *)2) {
            // 0x80ec77f
            v17 = v10;
            v18 = *(char *)v17;
            v11 = 0;
            v13 = v15;
            if (v18 == 32) {
                goto lab_0x80ec7bf;
            } else {
                if (v18 > 32) {
                    if (v18 != 46) {
                        // break -> 0x80ec8f6
                        break;
                    }
                    // 0x80ec891
                    v12 = 0;
                    v14 = v15;
                    v9 = v10;
                    v5 = v8;
                    v4 = 0;
                    v3 = (char *)3;
                    if (v16 != 0) {
                        // 0x80ec897
                        result = v15;
                        if (WWW_TraceFlag == 0) {
                            goto lab_0x80ecb28;
                        } else {
                            // 0x80ec8a2
                            result = v15;
                            if ((WWW_TraceMask & 8) == 0) {
                                goto lab_0x80ecb28;
                            } else {
                                // 0x80ec8ae
                                fprintf(TraceFP(), "dot after '!' at column %d:\n\t%s\n", v17 + 1 - v1, ts);
                                result = v15;
                                goto lab_0x80ecb28;
                            }
                        }
                    }
                    goto lab_0x80ecb1a;
                } else {
                    // 0x80ec797
                    v11 = 0;
                    v13 = v15;
                    switch (v18) {
                        case 0: {
                            // 0x80ec7b7
                            v11 = 1;
                            v13 = 1;
                            goto lab_0x80ec7bf;
                        }
                        case 9: {
                            goto lab_0x80ec7bf;
                        }
                        default: {
                            goto lab_0x80ec8f6;
                        }
                    }
                }
            }
        } else {
            if (v21 < (char *)2) {
                // 0x80ec5fa
                v19 = v10;
                v20 = (char *)v19;
                char v22 = *v20; // 0x80ec5fd
                v12 = 0;
                v14 = v15;
                v9 = v10;
                v5 = v8;
                v4 = v16;
                v3 = v21;
                if (v22 == 32) {
                    goto lab_0x80ecb1a;
                } else {
                    if (v22 > 32) {
                        if (v22 == 33) {
                            // 0x80ec63d
                            v12 = 0;
                            v14 = v15;
                            v9 = v10;
                            v5 = v8;
                            v4 = 1;
                            v3 = (char *)1;
                            if (v21 == (char *)1) {
                                // 0x80ec643
                                result = v15;
                                if (WWW_TraceFlag == 0) {
                                    goto lab_0x80ecb28;
                                } else {
                                    // 0x80ec64e
                                    result = v15;
                                    if ((WWW_TraceMask & 8) == 0) {
                                        goto lab_0x80ecb28;
                                    } else {
                                        // 0x80ec65a
                                        fprintf(TraceFP(), "second '!' at column %d:\n\t%s\n", v19 + 1 - v1, ts);
                                        result = v15;
                                        goto lab_0x80ecb28;
                                    }
                                }
                            }
                            goto lab_0x80ecb1a;
                        } else {
                            goto lab_0x80ec6a6;
                        }
                    } else {
                        // 0x80ec616
                        v12 = 0;
                        v14 = v15;
                        v9 = v10;
                        v5 = v8;
                        v4 = v16;
                        v3 = v21;
                        result = 1;
                        switch (v22) {
                            case 0: {
                                goto lab_0x80ecb28;
                            }
                            case 9: {
                                goto lab_0x80ecb1a;
                            }
                            default: {
                                goto lab_0x80ec6a6;
                            }
                        }
                    }
                }
            } else {
                // 0x80ec5eb
                v12 = 0;
                v14 = v15;
                v9 = v10;
                v5 = v8;
                v4 = v16;
                v3 = v21;
                if (v21 == (char *)3) {
                    int32_t v23 = v10;
                    char * v24 = (char *)v23;
                    char v25 = *v24; // 0x80ec959
                    v12 = 0;
                    v14 = v15;
                    v9 = v10;
                    v5 = v8;
                    v4 = v16;
                    v3 = (char *)3;
                    switch (v25) {
                        case 32: {
                            goto lab_0x80ecb1a;
                        }
                        case 9: {
                            goto lab_0x80ecb1a;
                        }
                        default: {
                            if (v25 == 0) {
                                // 0x80ec97c
                                result = v15;
                                if (WWW_TraceFlag == 0) {
                                    goto lab_0x80ecb28;
                                } else {
                                    // 0x80ec987
                                    result = v15;
                                    if ((WWW_TraceMask & 8) == 0) {
                                        goto lab_0x80ecb28;
                                    } else {
                                        // 0x80ec993
                                        fprintf(TraceFP(), "expected text after dot at column %d:\n\t%s\n", v23 + 1 - v1, ts);
                                        result = v15;
                                        goto lab_0x80ecb28;
                                    }
                                }
                            }
                            int16_t * v26 = *__ctype_b_loc(); // 0x80ec9d4
                            unsigned char v27 = *v24; // 0x80ec9d9
                            int16_t v28 = *(int16_t *)(2 * (int32_t)v27 + (int32_t)v26); // 0x80ec9e4
                            if (v27 != 95 && (v28 & 1024) == 0) {
                                // 0x80ec9fd
                                result = v15;
                                if (WWW_TraceFlag == 0) {
                                    goto lab_0x80ecb28;
                                } else {
                                    // 0x80eca08
                                    result = v15;
                                    if ((WWW_TraceMask & 8) == 0) {
                                        goto lab_0x80ecb28;
                                    } else {
                                        // 0x80eca14
                                        fprintf(TraceFP(), "no name starting at column %d:\n\t%s\n", v23 + 1 - v1, ts);
                                        result = v15;
                                        goto lab_0x80ecb28;
                                    }
                                }
                            }
                            char * v29 = v24; // 0x80eca64
                            char v30 = v10; // 0x80eca64
                            char v31 = 0; // 0x80eca64
                            char v32 = v10; // 0x80eca64
                            char * v33 = v24; // 0x80eca64
                            if (v27 != 0) {
                                char v34 = v30;
                                int16_t * v35 = *__ctype_b_loc(); // 0x80eca6b
                                unsigned char v36 = *v29; // 0x80eca70
                                int16_t v37 = *(int16_t *)(2 * (int32_t)v36 + (int32_t)v35); // 0x80eca7b
                                v31 = v36;
                                v32 = v34;
                                v33 = v29;
                                while (v36 == 95 || (v37 & 8) != 0) {
                                    char v38 = v34 + 1; // 0x80eca58
                                    char * v39 = (char *)(int32_t)v38;
                                    v29 = v39;
                                    v30 = v38;
                                    v31 = 0;
                                    v32 = v38;
                                    v33 = v39;
                                    if (*v39 == 0) {
                                        // break -> 0x80eca92
                                        break;
                                    }
                                    v34 = v30;
                                    v35 = *__ctype_b_loc();
                                    v36 = *v29;
                                    v37 = *(int16_t *)(2 * (int32_t)v36 + (int32_t)v35);
                                    v31 = v36;
                                    v32 = v34;
                                    v33 = v29;
                                }
                            }
                            char * v40 = v33;
                            char v41 = v32 - 1; // 0x80eca98
                            *v40 = 0;
                            char v42 = *v8; // 0x80ecaae
                            *v8 = 0;
                            char * v43 = p;
                            if (checkonly == 0) {
                                // 0x80ecaef
                                append_open_tag(v43, v24, (int32_t **)&classend, (int32_t **)&state);
                                v12 = 0;
                                v14 = v15;
                                v9 = v41;
                                v5 = v8;
                                v4 = 0;
                                v3 = NULL;
                            } else {
                                int32_t v44 = html_src_tag_index(v43); // 0x80ecac6
                                *v8 = v42;
                                *v40 = v31;
                                v12 = 0;
                                v14 = v15;
                                v9 = v41;
                                v5 = v8;
                                v4 = 0;
                                v3 = NULL;
                                if (v44 == -1) {
                                    // 0x80ecb43
                                    return 0;
                                }
                            }
                            goto lab_0x80ecb1a;
                        }
                    }
                } else {
                    goto lab_0x80ecb1a;
                }
            }
        }
    }
  lab_0x80ec8f6:
    // 0x80ec8f6
    result = v15;
    if (WWW_TraceFlag != 0) {
        // 0x80ec901
        result = v15;
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80ec90d
            fprintf(TraceFP(), "unexpected char '%c' after tagname at column %d:\n\t%s\n", v18, v17 + 1 - v1, ts);
            result = v15;
        }
    }
    goto lab_0x80ecb28;
  lab_0x80ecb28:
    // 0x80ecb28
    if (checkonly == 0 && result != 0) {
        // 0x80ecb34
        *(int32_t *)(v2 + 4 * lexeme) = (int32_t)classend;
    }
    // 0x80ecb43
    return result;
  lab_0x80ec7bf:;
    char v45 = v13;
    char v46 = v11;
    char v47 = *v8; // 0x80ec7c2
    *v8 = 0;
    if (checkonly == 0) {
        char * v48 = p;
        if (v16 == 0) {
            // 0x80ec860
            append_open_tag(v48, NULL, (int32_t **)&classend, (int32_t **)&state);
            v12 = v46;
            v14 = v45;
            v9 = v10;
            v5 = v8;
            v4 = 0;
            v3 = NULL;
        } else {
            // 0x80ec845
            append_close_tag(v48, (int32_t **)&classend, (int32_t **)&state);
            v12 = v46;
            v14 = v45;
            v9 = v10;
            v5 = v8;
            v4 = 0;
            v3 = NULL;
        }
    } else {
        char * v49 = p;
        int32_t v50 = html_src_tag_index(v49); // 0x80ec7e1
        if (WWW_TraceFlag != 0) {
            // 0x80ec7f4
            if ((WWW_TraceMask & 8) != 0) {
                // 0x80ec800
                fprintf(TraceFP(), "tag index(%s) = %d\n", v49, v50);
            }
        }
        // 0x80ec827
        *v8 = v47;
        v12 = v46;
        v14 = v45;
        v9 = v10;
        v5 = v8;
        v4 = 0;
        v3 = NULL;
        char result2 = v45; // 0x80ec834
        if ((int32_t *)v50 == (int32_t *)-1) {
            // 0x80ecb43
            return result2;
        }
    }
    goto lab_0x80ecb1a;
  lab_0x80ecb1a:
    // 0x80ecb1a
    v7 = v14;
    v6 = v9 + 1;
    result = v7;
    if (v12 != 0) {
        goto lab_0x80ecb28;
    }
    goto lab_0x80ec5d5;
  lab_0x80ec6a6:;
    int16_t * v51 = *__ctype_b_loc(); // 0x80ec6ab
    unsigned char v52 = *v20; // 0x80ec6b0
    int16_t v53 = *(int16_t *)(2 * (int32_t)v52 + (int32_t)v51); // 0x80ec6bb
    if (v52 != 95 && (v53 & 1024) == 0) {
        // 0x80ec6d4
        result = v15;
        if (WWW_TraceFlag == 0) {
            goto lab_0x80ecb28;
        } else {
            // 0x80ec6df
            result = v15;
            if ((WWW_TraceMask & 8) == 0) {
                goto lab_0x80ecb28;
            } else {
                // 0x80ec6eb
                fprintf(TraceFP(), "no name starting at column %d:\n\t%s\n", v19 + 1 - v1, ts);
                result = v15;
                goto lab_0x80ecb28;
            }
        }
    }
    // 0x80ec727
    p = v20;
    char * v54 = v20; // 0x80ec73b
    char v55 = v10; // 0x80ec73b
    char v56 = v10; // 0x80ec73b
    char * v57 = v20; // 0x80ec73b
    if (*v20 != 0) {
        char v58 = v55;
        int16_t * v59 = *__ctype_b_loc(); // 0x80ec742
        unsigned char v60 = *v54; // 0x80ec747
        int16_t v61 = *(int16_t *)(2 * (int32_t)v60 + (int32_t)v59); // 0x80ec752
        v56 = v58;
        v57 = v54;
        while (v60 == 95 || (v61 & 8) != 0) {
            char v62 = v58 + 1; // 0x80ec72f
            char * v63 = (char *)(int32_t)v62;
            v54 = v63;
            v55 = v62;
            v56 = v62;
            v57 = v63;
            if (*v63 == 0) {
                // break -> 0x80ec769
                break;
            }
            v58 = v55;
            v59 = *__ctype_b_loc();
            v60 = *v54;
            v61 = *(int16_t *)(2 * (int32_t)v60 + (int32_t)v59);
            v56 = v58;
            v57 = v54;
        }
    }
    // 0x80ec769
    v12 = 0;
    v14 = v15;
    v9 = v56 - 1;
    v5 = v57;
    v4 = v16;
    v3 = (char *)2;
    goto lab_0x80ecb1a;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrettySrc.c
// Address range: 0x80ecb4d - 0x80ecc84
// Line range:    344 - 368
void html_src_clean_item(int32_t l) {
    int32_t v1 = 4 * l; // 0x80ecb56
    int32_t * v2 = (int32_t *)(v1 + (int32_t)&HTL_tagspecs); // 0x80ecb56
    int32_t v3 = *v2; // 0x80ecb56
    if (v3 != 0) {
        // 0x80ecb6f
        free((int32_t *)v3);
        *v2 = 0;
    }
    for (int32_t i = 0; i < 2; i++) {
        int32_t v4 = i == 0 ? (int32_t)&lexeme_end : (int32_t)&lexeme_start; // 0x80ecbb7
        int32_t * v5 = (int32_t *)(v4 + v1); // 0x80ecbc0
        int32_t v6 = *v5; // 0x80ecbc0
        *v5 = 0;
        int32_t v7 = v6; // 0x80ecc6e
        if (v6 != 0) {
            int32_t v8 = v7;
            int32_t * v9 = (int32_t *)(v8 + 16); // 0x80ecbd6
            int32_t v10 = *v9; // 0x80ecbd6
            if (v10 != 0) {
                // 0x80ecbdd
                free((int32_t *)v10);
                *v9 = 0;
            }
            int32_t * v11 = (int32_t *)(v8 + 20); // 0x80ecbf8
            int32_t v12 = *v11; // 0x80ecbf8
            if (v12 != 0) {
                // 0x80ecbff
                free((int32_t *)v12);
                *v11 = 0;
            }
            // 0x80ecc17
            int32_t * v13; // 0x80ecc25
            int32_t v14; // 0x80ecc25
            if (*(char *)(v8 + 24) != 0) {
                // 0x80ecc22
                v13 = (int32_t *)(v8 + 8);
                v14 = *v13;
                if (v14 != 0) {
                    // 0x80ecc2c
                    free((int32_t *)v14);
                    *v13 = 0;
                }
            }
            int32_t * v15 = (int32_t *)v8; // 0x80ecc4d
            int32_t v16 = *v15; // 0x80ecc4d
            free(v15);
            while (v16 != 0) {
                // 0x80ecbd3
                v8 = v16;
                v9 = (int32_t *)(v8 + 16);
                v10 = *v9;
                if (v10 != 0) {
                    // 0x80ecbdd
                    free((int32_t *)v10);
                    *v9 = 0;
                }
                // 0x80ecbf5
                v11 = (int32_t *)(v8 + 20);
                v12 = *v11;
                if (v12 != 0) {
                    // 0x80ecbff
                    free((int32_t *)v12);
                    *v11 = 0;
                }
                // 0x80ecc17
                if (*(char *)(v8 + 24) != 0) {
                    // 0x80ecc22
                    v13 = (int32_t *)(v8 + 8);
                    v14 = *v13;
                    if (v14 != 0) {
                        // 0x80ecc2c
                        free((int32_t *)v14);
                        *v13 = 0;
                    }
                }
                // 0x80ecc58
                v15 = (int32_t *)v8;
                v16 = *v15;
                free(v15);
            }
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrettySrc.c
// Address range: 0x80ecc84 - 0x80eccaa
// Line range:    372 - 377
void html_src_clean_data(void) {
    for (int32_t i = 0; i < 12; i++) {
        // 0x80ecc93
        html_src_clean_item(i);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrettySrc.c
// Address range: 0x80eccaa - 0x80eccc3
// Line range:    380 - 383
void html_src_on_lynxcfg_reload(void) {
    // 0x80eccaa
    html_src_clean_data();
    HTMLSRC_init_caches(1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrettySrc.c
// Address range: 0x80eccc3 - 0x80ecd23
// Line range:    386 - 393
void failed_init(char * tag, int32_t lexeme) {
    // 0x80eccc3
    fprintf((struct _IO_FILE *)g160, gettext("parse-error while caching %s tagspec of lexeme %d\n"));
    fprintf((struct _IO_FILE *)g160, gettext("Use -trace -trace-mask=8 to see details in log.\n"));
    exit_immediately(1);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYPrettySrc.c
// Address range: 0x80ecd23 - 0x80ecf69
// Line range:    396 - 428
void HTMLSRC_init_caches(char dont_exit) {
    char buf2[1000]; // bp-1016, 0x80ecd23
    char buf[1000]; // bp-1020, 0x80ecd23
    char v1[1000]; // 0x80ece5d
    char v2[1000]; // 0x80ecf3b
    int32_t v3 = __readgsdword(20); // 0x80ecd36
    if (WWW_TraceFlag != 0) {
        // 0x80ecd4c
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80ecd58
            fprintf(TraceFP(), "HTMLSRC_init_caches(%d tagspecs)\n", 12);
        }
    }
    // 0x80ecd77
    buf2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    int32_t v4 = *(int32_t *)&buf2; // 0x80ecf42
    if (v4 >= 12) {
      lab_0x80ecf4f:
        // 0x80ecf4f
        if (v3 != __readgsdword(20)) {
            // 0x80ecf5b
            __stack_chk_fail();
        }
        // 0x80ecf60
        return;
    }
    int32_t v5 = 4 * v4;
    int32_t v6 = v5 + (int32_t)&HTL_tagspecs;
    int32_t v7 = *(int32_t *)v6; // 0x80ecd8c
    int32_t v8 = v7 == 0 ? v5 + (int32_t)&HTL_tagspecs_defaults : v6;
    int32_t v9 = *(int32_t *)v8;
    int32_t str; // bp-1012, 0x80ecd23
    LYstrncpy((char *)&str, (char *)v9, 999);
    HTSACopy((char **)v6, (char *)&str);
    if (WWW_TraceFlag != 0) {
        // 0x80ece0b
        if ((WWW_TraceMask & 8) != 0) {
            // 0x80ece17
            fprintf(TraceFP(), "parsing lexeme %d: %s\n", v4 + 1, &str);
        }
    }
    char * found_char_pos = strchr((char *)&str, 58); // 0x80ece58
    v1[0] = (int32_t)found_char_pos;
    buf = v1;
    int32_t v10 = *(int32_t *)&buf; // 0x80ece63
    int32_t v11 = v4; // 0x80ece6a
    if (v10 != 0) {
        // 0x80ece6c
        *(char *)v10 = 0;
        v11 = *(int32_t *)&buf2;
    }
    int32_t v12 = v11;
    while (dont_exit == 0 != (html_src_parse_tagspec((char *)&str, v12, 0, 1) == 0)) {
        int32_t v13 = *(int32_t *)&buf; // 0x80ececc
        int32_t v14 = v13 == 0 ? 0 : v13 + 1;
        if (dont_exit == 0 == html_src_parse_tagspec((char *)v14, v12, 0, 0) == 0) {
            // 0x80ecf25
            failed_init("2nd", v12);
            // UNREACHABLE
        }
        // 0x80ecf3b
        v2[0] = (char)v12 + 1;
        buf2 = v2;
        uint32_t v15 = *(int32_t *)&buf2; // 0x80ecf42
        if (v15 >= 12) {
            goto lab_0x80ecf4f;
        }
        int32_t v16 = v15; // 0x80ece17
        v5 = 4 * v16;
        v6 = v5 + (int32_t)&HTL_tagspecs;
        v7 = *(int32_t *)v6;
        v8 = v7 == 0 ? v5 + (int32_t)&HTL_tagspecs_defaults : v6;
        v9 = *(int32_t *)v8;
        LYstrncpy((char *)&str, (char *)v9, 999);
        HTSACopy((char **)v6, (char *)&str);
        if (WWW_TraceFlag != 0) {
            // 0x80ece0b
            if ((WWW_TraceMask & 8) != 0) {
                // 0x80ece17
                fprintf(TraceFP(), "parsing lexeme %d: %s\n", v16 + 1, &str);
            }
        }
        // 0x80ece47
        found_char_pos = strchr((char *)&str, 58);
        v1[0] = (int32_t)found_char_pos;
        buf = v1;
        v10 = *(int32_t *)&buf;
        v11 = v16;
        if (v10 != 0) {
            // 0x80ece6c
            *(char *)v10 = 0;
            v11 = *(int32_t *)&buf2;
        }
        // 0x80ece75
        v12 = v11;
    }
    // 0x80eceaa
    failed_init("1st", v12);
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./TRSTable.c
// Address range: 0x80f17f3 - 0x80f1827
// Line range:    1966 - 1972
int32_t Stbl_getStartLineDeep(int32_t * me) {
    // 0x80f17f3
    if (me == NULL) {
        // 0x80f1822
        return -1;
    }
    int32_t v1 = (int32_t)me;
    int32_t v2 = *(int32_t *)v1; // 0x80f1813
    while (v2 != 0) {
        // 0x80f1810
        v1 = v2;
        v2 = *(int32_t *)v1;
    }
    // 0x80f1822
    return *(int32_t *)(v1 + 8);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f3548 - 0x80f3637
// Line range:    303 - 330
void set_inverse_transl(int32_t i) {
    int32_t * v1 = (int32_t *)(4 * i + (int32_t)&inverse_translations);
    int32_t v2 = *v1; // 0x80f3562
    int32_t v3 = v2; // 0x80f3570
    if (v2 == 0) {
        // 0x80f3572
        char * q; // bp-28, 0x80f3548
        *(int32_t *)&q = i;
        int16_t * mem = (int16_t *)&inv_norm_transl; // 0x80f357c
        if (i != 0) {
            // 0x80f357e
            mem = (int16_t *)malloc(512);
        }
        // 0x80f3596
        *v1 = (int32_t)mem;
        v3 = *(int32_t *)(4 * (int32_t)q + (int32_t)&inverse_translations);
        if (v3 == 0) {
            // 0x80f3635
            return;
        }
    }
    char v4 = 0; // 0x80f35bd
    while (true) {
        // 0x80f35cc
        *(char *)(v3 + (int32_t)v4) = 0;
        v4++;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f3637 - 0x80f3675
// Line range:    333 - 338
int16_t * set_translate(int32_t m) {
    int32_t * v1 = (int32_t *)(4 * m + (int32_t)&inverse_translations); // 0x80f3640
    int32_t v2 = *v1; // 0x80f3640
    int32_t v3 = v2; // 0x80f3649
    if (v2 == 0) {
        // 0x80f364b
        set_inverse_transl(m);
        v3 = *v1;
    }
    // 0x80f3656
    inv_translate = v3;
    return (int16_t *)(512 * m + (int32_t)&translations);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f3675 - 0x80f36a0
// Line range:    341 - 343
int32_t UC_valid_UC_charset(int32_t UC_charset_hndl) {
    // 0x80f3675
    return UC_charset_hndl > -1 == UCNumCharsets > UC_charset_hndl;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f36a0 - 0x80f379b
// Line range:    348 - 382
void UC_con_set_trans(int32_t UC_charset_in_hndl, int32_t Gn, int32_t update_flag) {
    // 0x80f36a0
    if (UC_valid_UC_charset(UC_charset_in_hndl) == 0) {
        // 0x80f36b5
        if (WWW_TraceFlag != 0) {
            // 0x80f36c4
            fprintf(TraceFP(), "UC_con_set_trans: Invalid charset handle %d.\n", UC_charset_in_hndl);
        }
        // 0x80f3799
        return;
    }
    int32_t v1 = 60 * UC_charset_in_hndl; // 0x80f3709
    int32_t v2 = *(int32_t *)(v1 + (int32_t)&g325); // 0x80f36a0
    for (int32_t i = 0; i < 256; i++) {
        int32_t v3 = v2;
        int32_t v4 = *(int32_t *)(v1 + (int32_t)&g324); // 0x80f372e
        unsigned char v5 = *(char *)(v4 + i); // 0x80f373a
        int32_t v6 = 512 * Gn + (int32_t)&translations + 2 * i;
        if (v5 == 0) {
            // 0x80f376e
            *(int16_t *)v6 = -3;
            v2 = v3;
        } else {
            // 0x80f375e
            *(int16_t *)v6 = *(int16_t *)v3;
            int32_t v7 = v5; // 0x80f3762
            int32_t v8 = v3; // 0x80f375e
            v8 += 2;
            v7--;
            v2 = v8;
            while (v7 != 0) {
                // 0x80f375e
                v8 += 2;
                v7--;
                v2 = v8;
            }
        }
    }
    if (update_flag != 0) {
        // 0x80f378e
        set_inverse_transl(Gn);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f379b - 0x80f38f0
// Line range:    441 - 476
int32_t con_insert_unipair(uint16_t unicode, int16_t fontpos, int32_t fordefault) {
    uint32_t v1 = (int32_t)unicode;
    int32_t v2 = 4 * v1 / 2048;
    int32_t v3 = fordefault == 0 ? (int32_t)&uni_pagedir : (int32_t)&unidefault_pagedir;
    int32_t v4 = *(int32_t *)(v3 + v2);
    int32_t v5 = v4; // 0x80f37f2
    if (v4 == 0) {
        int32_t * mem = malloc(128); // 0x80f37fb
        v5 = (int32_t)mem;
        if (fordefault == 0) {
            // 0x80f3818
            *(int32_t *)(v2 + (int32_t)&uni_pagedir) = v5;
        } else {
            // 0x80f3809
            *(int32_t *)(v2 + (int32_t)&unidefault_pagedir) = v5;
        }
        // 0x80f3825
        if (mem == NULL) {
            // 0x80f38e7
            return -1;
        }
        for (int32_t i = 0; i < 32; i++) {
            // 0x80f3840
            *(int32_t *)(4 * i + v5) = 0;
        }
    }
    int32_t * v6 = (int32_t *)(v5 + (v1 / 16 & 124)); // 0x80f3873
    int32_t v7 = *v6; // 0x80f3873
    if (v7 != 0) {
        // 0x80f38cb
        *(int16_t *)(v7 + (2 * v1 & 126)) = fontpos;
        // 0x80f38e7
        return 0;
    }
    int32_t * mem2 = malloc(128); // 0x80f3890
    int32_t v8 = (int32_t)mem2; // 0x80f3890
    *v6 = v8;
    if (mem2 == NULL) {
        // 0x80f38e7
        return -1;
    }
    for (int32_t i = 0; i < 64; i++) {
        // 0x80f38b4
        *(int16_t *)(2 * i + v8) = -1;
    }
    // 0x80f38cb
    *(int16_t *)(v8 + (2 * v1 & 126)) = fontpos;
    // 0x80f38e7
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f38f0 - 0x80f3a5a
// Line range:    480 - 521
int32_t con_insert_unipair_str(uint16_t unicode, char * replace_str, int32_t fordefault) {
    uint32_t v1 = (int32_t)unicode;
    int32_t v2 = 4 * v1 / 2048;
    int32_t v3 = fordefault == 0 ? (int32_t)&uni_pagedir_str : (int32_t)&unidefault_pagedir_str;
    int32_t v4 = *(int32_t *)(v3 + v2);
    int32_t v5 = v4; // 0x80f3940
    if (v4 == 0) {
        int32_t * mem = malloc(128); // 0x80f3949
        v5 = (int32_t)mem;
        if (fordefault == 0) {
            // 0x80f3966
            *(int32_t *)(v2 + (int32_t)&uni_pagedir_str) = v5;
        } else {
            // 0x80f3957
            *(int32_t *)(v2 + (int32_t)&unidefault_pagedir_str) = v5;
        }
        // 0x80f3973
        if (mem == NULL) {
            // 0x80f3a51
            return (int32_t)(char **)-1;
        }
        for (int32_t i = 0; i < 32; i++) {
            // 0x80f398e
            *(int32_t *)(4 * i + v5) = 0;
        }
    }
    int32_t * v6 = (int32_t *)(v5 + (v1 / 16 & 124)); // 0x80f39c1
    int32_t v7 = *v6; // 0x80f39c1
    if (v7 != 0) {
        // 0x80f3a28
        *(int32_t *)(v7 + (4 * v1 & 252)) = (int32_t)replace_str;
        // 0x80f3a51
        return (int32_t)NULL;
    }
    int32_t * mem2 = malloc(256); // 0x80f39d9
    int32_t v8 = (int32_t)mem2; // 0x80f39d9
    *v6 = v8;
    if (mem2 == NULL) {
        // 0x80f3a51
        return (int32_t)(char **)-1;
    }
    for (int32_t i = 0; i < 64; i++) {
        // 0x80f3a0f
        *(int32_t *)(4 * i + v8) = 0;
    }
    // 0x80f3a28
    *(int32_t *)(*v6 + (4 * v1 & 252)) = (int32_t)replace_str;
    // 0x80f3a51
    return (int32_t)NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f3a5a - 0x80f3bb3
// Line range:    527 - 556
void con_clear_unimap(int32_t fordefault) {
    int32_t v1 = 0; // 0x80f3a64
    int32_t v2 = 0; // 0x80f3a64
    if (fordefault == 0) {
        int32_t * v3 = (int32_t *)(4 * v2 + (int32_t)&uni_pagedir); // 0x80f3b1f
        int32_t v4 = *v3; // 0x80f3b1f
        int32_t v5 = 0; // 0x80f3b2d
        int32_t v6; // 0x80f3b69
        int32_t * v7; // 0x80f3b41
        int32_t v8; // 0x80f3b41
        if (v4 != 0) {
            v7 = (int32_t *)(4 * v5 + v4);
            v8 = *v7;
            if (v8 != 0) {
                // 0x80f3b47
                free((int32_t *)v8);
                *v7 = 0;
            }
            // 0x80f3b69
            v6 = v5 + 1;
            v5 = v6;
            while (v6 != 32) {
                // 0x80f3b38
                v7 = (int32_t *)(4 * v5 + v4);
                v8 = *v7;
                if (v8 != 0) {
                    // 0x80f3b47
                    free((int32_t *)v8);
                    *v7 = 0;
                }
                // 0x80f3b69
                v6 = v5 + 1;
                v5 = v6;
            }
            // 0x80f3b79
            free((int32_t *)v4);
        }
        // 0x80f3b8b
        *v3 = 0;
        v2++;
        while (v2 != 32) {
            // 0x80f3b1c
            v3 = (int32_t *)(4 * v2 + (int32_t)&uni_pagedir);
            v4 = *v3;
            v5 = 0;
            if (v4 != 0) {
                v7 = (int32_t *)(4 * v5 + v4);
                v8 = *v7;
                if (v8 != 0) {
                    // 0x80f3b47
                    free((int32_t *)v8);
                    *v7 = 0;
                }
                // 0x80f3b69
                v6 = v5 + 1;
                v5 = v6;
                while (v6 != 32) {
                    // 0x80f3b38
                    v7 = (int32_t *)(4 * v5 + v4);
                    v8 = *v7;
                    if (v8 != 0) {
                        // 0x80f3b47
                        free((int32_t *)v8);
                        *v7 = 0;
                    }
                    // 0x80f3b69
                    v6 = v5 + 1;
                    v5 = v6;
                }
                // 0x80f3b79
                free((int32_t *)v4);
            }
            // 0x80f3b8b
            *v3 = 0;
            v2++;
        }
        // 0x80f3ba7
        hashtable_contents_valid = 1;
        // 0x80f3bb1
        return;
    }
    int32_t * v9 = (int32_t *)(4 * v1 + (int32_t)&unidefault_pagedir); // 0x80f3a79
    int32_t v10 = *v9; // 0x80f3a79
    int32_t v11 = 0; // 0x80f3a87
    int32_t v12; // 0x80f3a9b
    int32_t v13; // 0x80f3ac3
    int32_t * v14; // 0x80f3a9b
    if (v10 != 0) {
        v14 = (int32_t *)(4 * v11 + v10);
        v12 = *v14;
        if (v12 != 0) {
            // 0x80f3aa1
            free((int32_t *)v12);
            *v14 = 0;
        }
        // 0x80f3ac3
        v13 = v11 + 1;
        v11 = v13;
        while (v13 != 32) {
            // 0x80f3a92
            v14 = (int32_t *)(4 * v11 + v10);
            v12 = *v14;
            if (v12 != 0) {
                // 0x80f3aa1
                free((int32_t *)v12);
                *v14 = 0;
            }
            // 0x80f3ac3
            v13 = v11 + 1;
            v11 = v13;
        }
        // 0x80f3ad3
        free((int32_t *)v10);
    }
    // 0x80f3ae5
    *v9 = 0;
    v1++;
    while (v1 != 32) {
        // 0x80f3a76
        v9 = (int32_t *)(4 * v1 + (int32_t)&unidefault_pagedir);
        v10 = *v9;
        v11 = 0;
        if (v10 != 0) {
            v14 = (int32_t *)(4 * v11 + v10);
            v12 = *v14;
            if (v12 != 0) {
                // 0x80f3aa1
                free((int32_t *)v12);
                *v14 = 0;
            }
            // 0x80f3ac3
            v13 = v11 + 1;
            v11 = v13;
            while (v13 != 32) {
                // 0x80f3a92
                v14 = (int32_t *)(4 * v11 + v10);
                v12 = *v14;
                if (v12 != 0) {
                    // 0x80f3aa1
                    free((int32_t *)v12);
                    *v14 = 0;
                }
                // 0x80f3ac3
                v13 = v11 + 1;
                v11 = v13;
            }
            // 0x80f3ad3
            free((int32_t *)v10);
        }
        // 0x80f3ae5
        *v9 = 0;
        v1++;
    }
    // 0x80f3b01
    unidefault_contents_valid = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f3bb3 - 0x80f3d0c
// Line range:    559 - 588
void con_clear_unimap_str(int32_t fordefault) {
    int32_t v1 = 0; // 0x80f3bbd
    int32_t v2 = 0; // 0x80f3bbd
    if (fordefault == 0) {
        int32_t * v3 = (int32_t *)(4 * v2 + (int32_t)&uni_pagedir_str); // 0x80f3c78
        int32_t v4 = *v3; // 0x80f3c78
        int32_t v5 = 0; // 0x80f3c86
        int32_t v6; // 0x80f3cc2
        int32_t * v7; // 0x80f3c9a
        int32_t v8; // 0x80f3c9a
        if (v4 != 0) {
            v7 = (int32_t *)(4 * v5 + v4);
            v8 = *v7;
            if (v8 != 0) {
                // 0x80f3ca0
                free((int32_t *)v8);
                *v7 = 0;
            }
            // 0x80f3cc2
            v6 = v5 + 1;
            v5 = v6;
            while (v6 != 32) {
                // 0x80f3c91
                v7 = (int32_t *)(4 * v5 + v4);
                v8 = *v7;
                if (v8 != 0) {
                    // 0x80f3ca0
                    free((int32_t *)v8);
                    *v7 = 0;
                }
                // 0x80f3cc2
                v6 = v5 + 1;
                v5 = v6;
            }
            // 0x80f3cd2
            free((int32_t *)v4);
        }
        // 0x80f3ce4
        *v3 = 0;
        v2++;
        while (v2 != 32) {
            // 0x80f3c75
            v3 = (int32_t *)(4 * v2 + (int32_t)&uni_pagedir_str);
            v4 = *v3;
            v5 = 0;
            if (v4 != 0) {
                v7 = (int32_t *)(4 * v5 + v4);
                v8 = *v7;
                if (v8 != 0) {
                    // 0x80f3ca0
                    free((int32_t *)v8);
                    *v7 = 0;
                }
                // 0x80f3cc2
                v6 = v5 + 1;
                v5 = v6;
                while (v6 != 32) {
                    // 0x80f3c91
                    v7 = (int32_t *)(4 * v5 + v4);
                    v8 = *v7;
                    if (v8 != 0) {
                        // 0x80f3ca0
                        free((int32_t *)v8);
                        *v7 = 0;
                    }
                    // 0x80f3cc2
                    v6 = v5 + 1;
                    v5 = v6;
                }
                // 0x80f3cd2
                free((int32_t *)v4);
            }
            // 0x80f3ce4
            *v3 = 0;
            v2++;
        }
        // 0x80f3d00
        hashtable_str_contents_valid = 1;
        // 0x80f3d0a
        return;
    }
    int32_t * v9 = (int32_t *)(4 * v1 + (int32_t)&unidefault_pagedir_str); // 0x80f3bd2
    int32_t v10 = *v9; // 0x80f3bd2
    int32_t v11 = 0; // 0x80f3be0
    int32_t v12; // 0x80f3bf4
    int32_t v13; // 0x80f3c1c
    int32_t * v14; // 0x80f3bf4
    if (v10 != 0) {
        v14 = (int32_t *)(4 * v11 + v10);
        v12 = *v14;
        if (v12 != 0) {
            // 0x80f3bfa
            free((int32_t *)v12);
            *v14 = 0;
        }
        // 0x80f3c1c
        v13 = v11 + 1;
        v11 = v13;
        while (v13 != 32) {
            // 0x80f3beb
            v14 = (int32_t *)(4 * v11 + v10);
            v12 = *v14;
            if (v12 != 0) {
                // 0x80f3bfa
                free((int32_t *)v12);
                *v14 = 0;
            }
            // 0x80f3c1c
            v13 = v11 + 1;
            v11 = v13;
        }
        // 0x80f3c2c
        free((int32_t *)v10);
    }
    // 0x80f3c3e
    *v9 = 0;
    v1++;
    while (v1 != 32) {
        // 0x80f3bcf
        v9 = (int32_t *)(4 * v1 + (int32_t)&unidefault_pagedir_str);
        v10 = *v9;
        v11 = 0;
        if (v10 != 0) {
            v14 = (int32_t *)(4 * v11 + v10);
            v12 = *v14;
            if (v12 != 0) {
                // 0x80f3bfa
                free((int32_t *)v12);
                *v14 = 0;
            }
            // 0x80f3c1c
            v13 = v11 + 1;
            v11 = v13;
            while (v13 != 32) {
                // 0x80f3beb
                v14 = (int32_t *)(4 * v11 + v10);
                v12 = *v14;
                if (v12 != 0) {
                    // 0x80f3bfa
                    free((int32_t *)v12);
                    *v14 = 0;
                }
                // 0x80f3c1c
                v13 = v11 + 1;
                v11 = v13;
            }
            // 0x80f3c2c
            free((int32_t *)v10);
        }
        // 0x80f3c3e
        *v9 = 0;
        v1++;
    }
    // 0x80f3c5a
    unidefault_str_contents_valid = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f3d0c - 0x80f3dc2
// Line range:    597 - 618
void con_set_default_unimap(void) {
    // 0x80f3d0c
    con_clear_unimap(1);
    int32_t v1 = (int32_t)&dfont_unitable;
    int32_t v2 = 0;
    unsigned char v3 = *(char *)(v2 + (int32_t)"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\x02\b\x03\x02\x02\x02\x06\x02\x02\"d\x06\b\x06\x05\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x05\x04\x02\x02\x02\x03\x03\f\x02\a\x04\r\x02\n\x05\x0f\x04\x06\b\x03\b\v\x03\x04\a\a\x05\r\x03\x03\b\x05\a\x03\x02\x02\x03\x02\x05\f\x03\a\x04\f\x02\v\x06\r\x06\x05\x06\x03\a\x0e\x03\x03\a\a\x05\r\x04\x04\x02\x06\x06\x02\x03\x02\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"); // 0x80f3d31
    int32_t v4 = v1; // 0x80f3d6f
    int32_t v5; // 0x80f3d0c
    int32_t v6; // 0x80f3d4f
    int32_t v7; // 0x80f3d67
    if (v3 != 0) {
        // 0x80f3d40
        v7 = v3;
        v6 = v1 + 2;
        con_insert_unipair(*(int16_t *)v1, (int16_t)v2, 1);
        v7--;
        v4 = v6;
        while (v7 != 0) {
            // 0x80f3d40
            v5 = v6;
            v6 = v5 + 2;
            con_insert_unipair(*(int16_t *)v5, (int16_t)v2, 1);
            v7--;
            v4 = v6;
        }
    }
    int32_t v8 = v2 + 1; // 0x80f3d71
    while (v8 != 256) {
        // 0x80f3d2e
        v1 = v4;
        v2 = v8;
        v3 = *(char *)(v2 + (int32_t)"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\x02\b\x03\x02\x02\x02\x06\x02\x02\"d\x06\b\x06\x05\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x05\x04\x02\x02\x02\x03\x03\f\x02\a\x04\r\x02\n\x05\x0f\x04\x06\b\x03\b\v\x03\x04\a\a\x05\r\x03\x03\b\x05\a\x03\x02\x02\x03\x02\x05\f\x03\a\x04\f\x02\v\x06\r\x06\x05\x06\x03\a\x0e\x03\x03\a\a\x05\r\x04\x04\x02\x06\x06\x02\x03\x02\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00");
        v4 = v1;
        if (v3 != 0) {
            // 0x80f3d40
            v7 = v3;
            v6 = v1 + 2;
            con_insert_unipair(*(int16_t *)v1, (int16_t)v2, 1);
            v7--;
            v4 = v6;
            while (v7 != 0) {
                // 0x80f3d40
                v5 = v6;
                v6 = v5 + 2;
                con_insert_unipair(*(int16_t *)v5, (int16_t)v2, 1);
                v7--;
                v4 = v6;
            }
        }
        // 0x80f3d71
        v8 = v2 + 1;
    }
    // 0x80f3d7e
    *(int32_t *)&UC_default_unitable = (int32_t)&dfont_unitable;
    con_clear_unimap_str(1);
    UC_con_set_unimap_str(2610, &repl_map, 1);
    *(int32_t *)&UC_default_unitable_str = (int32_t)&dfont_replacedesc;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f3dc2 - 0x80f3eee
// Line range:    635 - 669
int32_t UC_con_set_unimap(int32_t UC_charset_out_hndl, int32_t update_flag) {
    // 0x80f3dc2
    if (UC_valid_UC_charset(UC_charset_out_hndl) == 0) {
        // 0x80f3dd7
        if (WWW_TraceFlag != 0) {
            // 0x80f3de2
            fprintf(TraceFP(), "UC_con_set_unimap: Invalid charset handle %d.\n", UC_charset_out_hndl);
        }
        // 0x80f3ee9
        return (int32_t)(int16_t *)-1;
    }
    int32_t v1 = 60 * UC_charset_out_hndl; // 0x80f3e1b
    int32_t v2 = *(int32_t *)(v1 + (int32_t)&g325); // 0x80f3e1d
    if (v2 == (int32_t)UC_current_unitable) {
        // 0x80f3ee9
        return (int32_t)(int16_t *)update_flag;
    }
    // 0x80f3e3b
    *(int32_t *)&UC_current_unitable = v2;
    con_clear_unimap(0);
    int32_t v3 = 0;
    int32_t v4 = *(int32_t *)(v1 + (int32_t)&g324); // 0x80f3e69
    unsigned char v5 = *(char *)(v4 + v3); // 0x80f3e75
    int32_t v6 = v2; // 0x80f3eaf
    int32_t v7; // 0x80f3dc2
    int32_t v8; // 0x80f3e8f
    int32_t v9; // 0x80f3ea7
    if (v5 != 0) {
        // 0x80f3e80
        v9 = v5;
        v8 = v2 + 2;
        con_insert_unipair(*(int16_t *)v2, (int16_t)v3, 0);
        v9--;
        v6 = v8;
        while (v9 != 0) {
            // 0x80f3e80
            v7 = v8;
            v8 = v7 + 2;
            con_insert_unipair(*(int16_t *)v7, (int16_t)v3, 0);
            v9--;
            v6 = v8;
        }
    }
    int32_t v10 = v3 + 1; // 0x80f3eb1
    while (v10 != 256) {
        int32_t v11 = v6;
        v3 = v10;
        v4 = *(int32_t *)(v1 + (int32_t)&g324);
        v5 = *(char *)(v4 + v3);
        v6 = v11;
        if (v5 != 0) {
            // 0x80f3e80
            v9 = v5;
            v8 = v11 + 2;
            con_insert_unipair(*(int16_t *)v11, (int16_t)v3, 0);
            v9--;
            v6 = v8;
            while (v9 != 0) {
                // 0x80f3e80
                v7 = v8;
                v8 = v7 + 2;
                con_insert_unipair(*(int16_t *)v7, (int16_t)v3, 0);
                v9--;
                v6 = v8;
            }
        }
        // 0x80f3eb1
        v10 = v3 + 1;
    }
    // 0x80f3ebe
    if (update_flag == 0) {
        // 0x80f3ee9
        return (int32_t)NULL;
    }
    for (int32_t i = 0; i < 4; i++) {
        // 0x80f3ecd
        set_inverse_transl(i);
    }
    // 0x80f3ee9
    return (int32_t)NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f3eee - 0x80f3f71
// Line range:    673 - 696
int32_t UC_con_set_unimap_str(int16_t ct, int32_t * list, int32_t fordefault) {
    int32_t result = 0; // 0x80f3f48
    if (ct != 0) {
        int16_t v1 = ct; // 0x80f3f41
        int32_t v2 = (int32_t)list; // 0x80f3eee
        v1--;
        int32_t v3 = *(int32_t *)(v2 + 4); // 0x80f3f07
        int32_t v4 = con_insert_unipair_str(*(int16_t *)v2, (char *)v3, fordefault); // 0x80f3f21
        result = v4 == 0 ? 0 : v4;
        v2 += 8;
        int32_t v5 = result; // 0x80f3f48
        while (v1 != 0) {
            // 0x80f3f04
            v1--;
            v3 = *(int32_t *)(v2 + 4);
            v4 = con_insert_unipair_str(*(int16_t *)v2, (char *)v3, fordefault);
            result = v4 == 0 ? v5 : v4;
            v2 += 8;
            v5 = result;
        }
        // 0x80f3f4a
        if (result != 0) {
            // 0x80f3f6c
            return result;
        }
    }
    // 0x80f3f50
    if (fordefault == 0) {
        // 0x80f3f62
        hashtable_str_contents_valid = 1;
    } else {
        // 0x80f3f56
        unidefault_str_contents_valid = 1;
    }
    // 0x80f3f6c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f3f71 - 0x80f408d
// Line range:    700 - 752
int32_t conv_uni_to_pc(int32_t ucs, int32_t usedefault) {
    int32_t v1 = 0xfffd; // 0x80f3f7e
    if (ucs < 0x10000) {
        // 0x80f3f89
        if (ucs >= 0xfffe) {
            // 0x80f4088
            return -1;
        }
        // 0x80f3fa4
        switch (ucs) {
            case 0xfeff: {
            }
            case 0x200f: {
            }
            case 0x200e: {
            }
            case 0x200d: {
            }
            case 0x200c: {
            }
            case 0x200b: {
                // 0x80f4088
                return -2;
            }
        }
        // 0x80f3fcb
        v1 = ucs;
        if ((ucs & -512) == 0xf000) {
            // 0x80f4088
            return ucs % 512;
        }
    }
    // 0x80f3fed
    int32_t v2; // 0x80f3f71
    if (usedefault == 0) {
        // 0x80f401a
        if (hashtable_contents_valid == 0) {
            // 0x80f4088
            return -3;
        }
        // 0x80f402c
        v2 = 4 * v1 / 2048 + (int32_t)&uni_pagedir;
    } else {
        // 0x80f3ff3
        if (unidefault_contents_valid == 0) {
            // 0x80f4088
            return -3;
        }
        // 0x80f4008
        v2 = 4 * v1 / 2048 + (int32_t)&unidefault_pagedir;
    }
    int32_t v3 = *(int32_t *)v2;
    if (v3 == 0) {
        // 0x80f4088
        return -4;
    }
    int32_t v4 = *(int32_t *)(v3 + (v1 / 16 & 124)); // 0x80f4051
    if (v4 == 0) {
        // 0x80f4088
        return -4;
    }
    uint16_t v5 = *(int16_t *)(v4 + (2 * v1 & 126)); // 0x80f4067
    return v5 > 511 ? -4 : (int32_t)v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f408d - 0x80f419e
// Line range:    761 - 809
int32_t conv_uni_to_str(char * outbuf, int32_t buflen, int32_t ucs, int32_t usedefault) {
    int32_t v1 = 0xfffd; // 0x80f409a
    if (ucs < 0x10000) {
        // 0x80f40a5
        if (ucs >= 0xfffe) {
            // 0x80f4199
            return (int32_t)(char **)-1;
        }
        // 0x80f40c0
        v1 = ucs;
        switch (ucs) {
            case 0xfeff: {
            }
            case 0x200f: {
            }
            case 0x200e: {
            }
            case 0x200d: {
            }
            case 0x200c: {
            }
            case 0x200b: {
                // 0x80f4199
                return (int32_t)(char **)-2;
            }
        }
    }
    // 0x80f40e7
    int32_t v2; // 0x80f408d
    if (usedefault == 0) {
        // 0x80f4114
        if (hashtable_str_contents_valid == 0) {
            // 0x80f4199
            return (int32_t)(char **)-3;
        }
        // 0x80f4126
        v2 = 4 * v1 / 2048 + (int32_t)&uni_pagedir_str;
    } else {
        // 0x80f40ed
        if (unidefault_str_contents_valid == 0) {
            // 0x80f4199
            return (int32_t)(char **)-3;
        }
        // 0x80f4102
        v2 = 4 * v1 / 2048 + (int32_t)&unidefault_pagedir_str;
    }
    int32_t v3 = *(int32_t *)v2;
    if (v3 == 0) {
        // 0x80f4199
        return (int32_t)(char **)-4;
    }
    int32_t v4 = *(int32_t *)(v3 + (v1 / 16 & 124)); // 0x80f414b
    if (v4 == 0) {
        // 0x80f4199
        return (int32_t)(char **)-4;
    }
    int32_t str = *(int32_t *)(v4 + (4 * v1 & 252)); // 0x80f4162
    char ** v5 = (char **)-4; // 0x80f416b
    if (str != 0) {
        // 0x80f416d
        strncpy(outbuf, (char *)str, buflen - 1);
        v5 = (char **)1;
    }
    // 0x80f4199
    return (int32_t)v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f419e - 0x80f41b5
// Line range:    820 - 823
void UCconsole_map_init(void) {
    // 0x80f419e
    con_set_default_unimap();
    UCInitialized = 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f41b5 - 0x80f436c
// Line range:    830 - 871
int32_t UCTransUniChar(int32_t unicode, int32_t charset_out) {
    int32_t v1 = 32 * charset_out; // 0x80f41cc
    int32_t v2 = *(int32_t *)(v1 + (int32_t)&LYCharSet_UC); // 0x80f41cf
    bool v3; // 0x80f41b5
    bool v4; // 0x80f41b5
    bool v5; // 0x80f41b5
    int32_t v6; // 0x80f41b5
    if (v2 >= 0) {
        int32_t v7 = 60 * v2;
        v3 = true;
        if (*(int32_t *)(v7 + (int32_t)&g329) != 0) {
            goto lab_0x80f42f1;
        } else {
            // 0x80f4273
            if (*(int32_t *)(v7 + (int32_t)&g325) != (int32_t)UC_current_unitable) {
                int32_t result = UC_con_set_unimap(v2, 1); // 0x80f42a5
                if (result < 0) {
                    // 0x80f4367
                    return result;
                }
            }
            int32_t result2 = conv_uni_to_pc(unicode, 0); // 0x80f42cc
            if (result2 >= 0) {
                // 0x80f4367
                return result2;
            }
            // 0x80f42e5
            v3 = false;
            v5 = true;
            v4 = false;
            v6 = result2;
            if (*(int32_t *)(v7 + (int32_t)&g330) == 0) {
                goto lab_0x80f4315;
            } else {
                goto lab_0x80f42f1;
            }
        }
    } else {
        int32_t v8 = *(int32_t *)(v1 + (int32_t)&g145); // 0x80f41e4
        if (v8 < 0) {
            // 0x80f4367
            return unicode < 128 ? unicode : v8;
        }
        // 0x80f4216
        v3 = true;
        if (default_UChndl < 0) {
            // 0x80f4367
            return -12;
        }
        goto lab_0x80f42f1;
    }
  lab_0x80f42f1:;
    int32_t result3 = conv_uni_to_pc(unicode, 1); // 0x80f42ff
    v5 = false;
    v4 = v3;
    v6 = result3;
    if (result3 >= 0) {
        // 0x80f4367
        return result3;
    }
    goto lab_0x80f4315;
  lab_0x80f4315:;
    int32_t v9 = v6; // 0x80f4319
    if (!v4 && v6 == -4) {
        // 0x80f4321
        v9 = conv_uni_to_pc(0xfffd, 0);
    }
    int32_t result4 = v9; // 0x80f433c
    if (!v5 && v9 == -4) {
        // 0x80f434a
        result4 = conv_uni_to_pc(0xfffd, 1);
    }
    // 0x80f4367
    return result4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f436c - 0x80f489e
// Line range:    881 - 998
int32_t UCTransUniCharStr(char * outbuf, int32_t buflen, uint32_t unicode, int32_t charset_out, int32_t chk_single_flag) {
    // 0x80f436c
    if (buflen <= 1) {
        // 0x80f4899
        return -13;
    }
    int32_t v1 = 32 * charset_out; // 0x80f439c
    int32_t v2 = *(int32_t *)(v1 + (int32_t)&LYCharSet_UC); // 0x80f439f
    int32_t v3; // 0x80f436c
    int32_t v4; // 0x80f436c
    int32_t v5; // 0x80f436c
    if (v2 >= 0) {
        int32_t v6 = 60 * v2; // 0x80f4404
        v5 = *(int32_t *)(v6 + (int32_t)&g330);
        v4 = v2;
        v3 = *(int32_t *)(v6 + (int32_t)&g329);
    } else {
        int32_t result = *(int32_t *)(v1 + (int32_t)&g145); // 0x80f43b4
        if (result < 0) {
            // 0x80f4899
            return result;
        }
        // 0x80f43d2
        v5 = 0;
        v4 = default_UChndl;
        v3 = 1;
        if (default_UChndl < 0) {
            // 0x80f4899
            return -12;
        }
    }
    int32_t v7 = (int32_t)outbuf;
    int32_t v8 = 0; // 0x80f442d
    if (chk_single_flag != 0) {
        if (v3 == 0) {
            int32_t v9 = *(int32_t *)(60 * v4 + (int32_t)&g325); // 0x80f444a
            if (v9 != (int32_t)UC_current_unitable) {
                int32_t result2 = UC_con_set_unimap(v4, 1); // 0x80f446b
                if (result2 < 0) {
                    // 0x80f4899
                    return result2;
                }
            }
        }
        // 0x80f4484
        v8 = conv_uni_to_pc(unicode, v3);
        if (v8 >= 32) {
            // 0x80f449f
            *outbuf = (char)v8;
            *(char *)(v7 + 1) = 0;
            // 0x80f4899
            return 1;
        }
    }
    char v10 = -14; // 0x80f44e1
    if (v3 == 0) {
        int32_t v11 = 60 * v4; // 0x80f44cd
        int32_t v12 = v11 + 0x81b2154; // 0x80f44d7
        if (v12 != (int32_t)UC_current_unitable_str) {
            // 0x80f44f1
            con_clear_unimap_str(0);
            int16_t v13 = *(int16_t *)v12; // 0x80f4506
            UC_con_set_unimap_str(v13, (int32_t *)*(int32_t *)(v11 + 0x81b2158), 0);
            *(int32_t *)&UC_current_unitable_str = v12;
        }
        uint32_t v14 = conv_uni_to_str(outbuf, buflen, unicode, 0); // 0x80f4547
        v10 = v14;
        if (v14 >= 0) {
            // 0x80f4899
            return strlen(outbuf);
        }
    }
    int32_t v15 = v8; // 0x80f456c
    if (chk_single_flag != 0 && v5 != 0) {
        // 0x80f4574
        v15 = conv_uni_to_pc(unicode, 1);
        if (v15 >= 32) {
            // 0x80f4590
            *outbuf = (char)v15;
            *(char *)(v7 + 1) = 0;
            // 0x80f4899
            return 1;
        }
    }
    char v16 = v10; // 0x80f45b3
    int32_t * str; // 0x80f45c5
    if ((v3 || v5) == 0) {
        goto lab_0x80f4795;
    } else {
        // 0x80f45bf
        str = (int32_t *)(v1 + (int32_t)&g143);
        if (strcmp((char *)*str, "shift_jis") == 0) {
            goto lab_0x80f4603;
        } else {
            // 0x80f45df
            if (strcmp((char *)*str, "euc-jp") != 0) {
                goto lab_0x80f4758;
            } else {
                goto lab_0x80f4603;
            }
        }
    }
  lab_0x80f4795:;
    char v17 = v16; // 0x80f4799
    if (v16 == -4) {
        char v18 = v16; // 0x80f479f
        if (v3 == 0) {
            // 0x80f47a1
            v18 = conv_uni_to_str(outbuf, buflen, 0xfffd, 0);
        }
        char v19 = v18; // 0x80f47ca
        if ((v3 || v5) != 0 && v18 == -4) {
            // 0x80f47d8
            v19 = conv_uni_to_str(outbuf, buflen, 0xfffd, 1);
        }
        // 0x80f47fd
        v17 = v19;
        if (v19 >= 0) {
            // 0x80f4899
            return strlen(outbuf);
        }
    }
    // 0x80f4816
    if (chk_single_flag == 0 || v15 != -4) {
        // 0x80f4899
        return -4;
    }
    char v20 = v17; // 0x80f4826
    if (v3 == 0) {
        // 0x80f4828
        v20 = conv_uni_to_pc(0xfffd, 0);
    }
    char v21 = v20; // 0x80f4843
    if ((v3 || v5) != 0 && v20 == -4) {
        // 0x80f4851
        v21 = conv_uni_to_pc(0xfffd, 1);
    }
    // 0x80f4868
    int32_t result3; // 0x80f436c
    if (v21 < 32) {
        // 0x80f488a
        result3 = v21;
    } else {
        // 0x80f486e
        *outbuf = v21;
        *(char *)(v7 + 1) = 0;
        result3 = 1;
    }
    // 0x80f4899
    return result3;
  lab_0x80f4603:;
    int32_t tocode = 0; // bp-64, 0x80f4603
    char v22 = unicode / 256; // bp-7, 0x80f4610
    int16_t * ut = (int16_t *)&v22; // bp-48, 0x80f4620
    int32_t inbytesleft = 2; // bp-56, 0x80f4623
    char * outbuf2; // bp-52, 0x80f436c
    *(int32_t *)&outbuf2 = v7;
    int32_t outbytesleft = buflen; // bp-60, 0x80f4633
    HTSprintf0((char **)&tocode, "%s//TRANSLIT", (char *)*str);
    int32_t * v23 = iconv_open((char *)tocode, "UTF-16BE"); // 0x80f4667
    if (tocode != 0) {
        // 0x80f4676
        free((int32_t *)tocode);
        tocode = 0;
    }
    int32_t * cd = v23; // 0x80f468c
    if (v23 == (int32_t *)-1) {
        // 0x80f468e
        cd = iconv_open((char *)*str, "UTF-16BE");
    }
    int32_t v24 = iconv(cd, (char **)&ut, &inbytesleft, &outbuf2, &outbytesleft); // 0x80f46cf
    iconv_close(cd);
    if ((int32_t)outbuf2 - v7 != 3) {
        if ((char)v24 >= 0) {
            // 0x80f473f
            *outbuf2 = 0;
            // 0x80f4899
            return strlen(outbuf);
        }
    } else {
        // 0x80f46f5
        if (WWW_TraceFlag != 0) {
            // 0x80f4700
            fprintf(TraceFP(), "It seems to be a JIS X 0201 code(%ld). Not supported.\n", unicode);
        }
        // 0x80f471e
        ut = (int16_t *)&v22;
        inbytesleft = 2;
        *(int32_t *)&outbuf2 = v7;
        outbytesleft = buflen;
    }
    goto lab_0x80f4758;
  lab_0x80f4758:;
    uint32_t v25 = conv_uni_to_str(outbuf, buflen, unicode, 1); // 0x80f4774
    v16 = v25;
    if (v25 >= 0) {
        // 0x80f4899
        return strlen(outbuf);
    }
    goto lab_0x80f4795;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f489e - 0x80f4a24
// Line range:    1004 - 1038
int32_t UC_MapGN(int32_t UChndl, int32_t update_flag) {
    int32_t v1 = 0; // 0x80f48ee
    int32_t v2 = 0;
    int32_t v3 = -1;
    int32_t v4 = *(int32_t *)(4 * v1 + (int32_t)&UC_GNhandles); // 0x80f48bf
    bool v5 = false; // 0x80f48c8
    int32_t result = v1; // 0x80f48c8
    while (v4 >= 0) {
        // 0x80f48ee
        v3 = v4 != UChndl ? v3 : v1;
        v2 = v4 != UChndl ? v2 : 1;
        v1++;
        v5 = v3 < 0;
        result = v3;
        if (v1 < 4 != v3 < 0) {
            // break -> 0x80f48fe
            break;
        }
        v4 = *(int32_t *)(4 * v1 + (int32_t)&UC_GNhandles);
        v5 = false;
        result = v1;
    }
    // 0x80f48fe
    if (v2 != 0) {
        // 0x80f4a1b
        return result;
    }
    // 0x80f490f
    int32_t result2; // 0x80f489e
    if (v5) {
        int32_t v6 = UC_lastautoGN != 1 ? 1 : 2;
        UC_lastautoGN = v6;
        int32_t * v7 = (int32_t *)(4 * v6 + (int32_t)&UC_GNhandles); // 0x80f4963
        *(int32_t *)(60 * *v7 + (int32_t)&g333) = -1;
        *(int32_t *)(60 * UChndl + (int32_t)&g333) = v6;
        *v7 = UChndl;
        result2 = v6;
    } else {
        // 0x80f4915
        *(int32_t *)(60 * UChndl + (int32_t)&g333) = result;
        *(int32_t *)(4 * result + (int32_t)&UC_GNhandles) = UChndl;
        result2 = result;
    }
    // 0x80f49af
    if (WWW_TraceFlag != 0) {
        int32_t v8 = *(int32_t *)(60 * UChndl + (int32_t)&UCInfo); // 0x80f49cb
        fprintf(TraceFP(), "UC_MapGN: Using %d <- %d (%s)\n", result2, UChndl, (char *)v8);
    }
    // 0x80f49fc
    UC_con_set_trans(UChndl, result2, update_flag);
    // 0x80f4a1b
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f4a24 - 0x80f4cce
// Line range:    1043 - 1108
int32_t UCTransChar(unsigned char ch_in, int32_t charset_in, int32_t charset_out) {
    if (charset_in == charset_out) {
        // 0x80f4cc9
        return ch_in;
    }
    // 0x80f4a5c
    if (charset_in < 0) {
        // 0x80f4cc9
        return -11;
    }
    int32_t v1 = *(int32_t *)(32 * charset_in + (int32_t)&LYCharSet_UC); // 0x80f4a74
    if (v1 < 0) {
        // 0x80f4cc9
        return -11;
    }
    int32_t v2 = 32 * charset_out; // 0x80f4a92
    int32_t v3 = *(int32_t *)(v2 + (int32_t)&LYCharSet_UC); // 0x80f4a95
    int32_t v4; // 0x80f4a24
    int32_t v5; // 0x80f4a24
    int32_t v6; // 0x80f4a24
    if (v3 >= 0) {
        int32_t v7 = 60 * v3; // 0x80f4afa
        v6 = *(int32_t *)(v7 + (int32_t)&g330);
        v4 = v3;
        v5 = *(int32_t *)(v7 + (int32_t)&g329);
    } else {
        int32_t result = *(int32_t *)(v2 + (int32_t)&g145); // 0x80f4aaa
        if (result < 0) {
            // 0x80f4cc9
            return result;
        }
        // 0x80f4ac8
        v6 = 0;
        v4 = default_UChndl;
        v5 = 1;
        if (default_UChndl < 0) {
            // 0x80f4cc9
            return -12;
        }
    }
    int32_t v8 = 60 * v1; // 0x80f4b2e
    if (*(int32_t *)(v8 + (int32_t)&g326) == 0) {
        // 0x80f4cc9
        return -11;
    }
    int32_t v9 = *(int32_t *)(v8 + (int32_t)&g333); // 0x80f4b57
    int32_t v10 = 0; // 0x80f4b64
    int32_t v11 = v9; // 0x80f4b64
    if (v9 < 0) {
        // 0x80f4b66
        v10 = 1;
        v11 = UC_MapGN(v1, 0);
    }
    int32_t v12 = -4; // 0x80f4ba1
    if (v5 == 0) {
        int32_t v13 = *(int32_t *)(60 * v4 + (int32_t)&g325); // 0x80f4b94
        if (v13 != (int32_t)UC_current_unitable) {
            int32_t result2 = UC_con_set_unimap(v4, 1); // 0x80f4bce
            if (result2 < 1) {
                // 0x80f4be9
                v12 = 0;
                if (result2 != 0) {
                    // 0x80f4cc9
                    return result2;
                }
            } else {
                // 0x80f4bdc
                set_inverse_transl(v11);
                v12 = result2;
            }
        } else {
            // 0x80f4bad
            v12 = -4;
            if (v10 != 0) {
                // 0x80f4bb3
                set_inverse_transl(v11);
                v12 = -4;
            }
        }
    }
    int32_t v14 = (int32_t)set_translate(v11); // 0x80f4c00
    *(int32_t *)&UC_translate = v14;
    int32_t v15 = (int32_t)*(int16_t *)(2 * (int32_t)ch_in + v14); // 0x80f4c1c
    int32_t result3 = v12; // 0x80f4c29
    if (v5 == 0) {
        // 0x80f4c2b
        result3 = conv_uni_to_pc(v15, 0);
        if (result3 >= 0) {
            // 0x80f4cc9
            return result3;
        }
    }
    int32_t v16 = result3; // 0x80f4c53
    if ((v5 || v6) != 0 && result3 == -4) {
        // 0x80f4c61
        v16 = conv_uni_to_pc(v15, 1);
    }
    int32_t v17 = v16; // 0x80f4c7b
    if (v5 == 0 == v16 == -4) {
        // 0x80f4c83
        v17 = conv_uni_to_pc(0xfffd, 0);
    }
    int32_t result4 = v17; // 0x80f4c9e
    if ((v5 || v6) != 0 && v17 == -4) {
        // 0x80f4cac
        result4 = conv_uni_to_pc(0xfffd, 1);
    }
    // 0x80f4cc9
    return result4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f4cce - 0x80f4d75
// Line range:    1114 - 1131
int32_t UCTransJPToUni(char * inbuf, int32_t buflen, int32_t charset_in) {
    char * inbuf2 = inbuf; // bp-12, 0x80f4cd7
    int32_t v1; // bp-7, 0x80f4cce
    char * pin = (char *)&v1; // bp-16, 0x80f4cdd
    char * pout = (char *)2; // bp-24, 0x80f4ce0
    int32_t rc = buflen; // bp-28, 0x80f4cea
    int32_t fromcode = *(int32_t *)(32 * charset_in + (int32_t)&g143); // 0x80f4cf3
    int32_t * cd = iconv_open("UTF-16BE", (char *)fromcode); // 0x80f4d04
    iconv(cd, &inbuf2, (int32_t *)&pout, &pin, &rc);
    iconv_close(cd);
    if (pout != NULL) {
        // 0x80f4d70
        return (int32_t)(char *)-11;
    }
    char * v2 = (char *)-11; // 0x80f4d4d
    if (rc == 0) {
        // 0x80f4d4f
        char v3; // 0x80f4cce
        v2 = (char *)(256 * v1 & 0xff00 | (int32_t)(unsigned char)v3);
    }
    // 0x80f4d70
    return (int32_t)v2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f4d75 - 0x80f5138
// Line range:    1136 - 1230
int32_t UCTransToUni(unsigned char ch_in, int32_t charset_in) {
    // 0x80f4d75
    char v1; // 0x80f4d75
    unsigned char v2 = v1;
    if (LATIN1 == charset_in) {
        // 0x80f5133
        return ch_in;
    }
    int32_t v3 = 32 * charset_in; // 0x80f4da1
    int32_t * str = (int32_t *)(v3 + (int32_t)&g143); // 0x80f4da4
    if (strcmp((char *)*str, "shift_jis") == 0) {
        goto lab_0x80f4de2;
    } else {
        // 0x80f4dbe
        if (strcmp((char *)*str, "euc-jp") != 0) {
            goto lab_0x80f5036;
        } else {
            goto lab_0x80f4de2;
        }
    }
  lab_0x80f4de2:;
    int32_t Gn = &g318; // bp-24, 0x80f4de2
    int32_t v4; // bp-8, 0x80f4d75
    int32_t UChndl_in = &v4; // bp-28, 0x80f4dec
    int32_t outbytesleft = 2; // bp-40, 0x80f4def
    int32_t inbytesleft = 2; // bp-36, 0x80f4df9
    if (strcmp((char *)*str, "shift_jis") == 0) {
        // 0x80f4e20
        if (g317 != 0) {
            if (ch_in != 127 == ch_in < 253) {
                // 0x80f4e92
                *(char *)&g319 = ch_in;
                *(char *)&g320 = 0;
                int32_t * cd = iconv_open("UTF-16BE", "Shift_JIS"); // 0x80f4eb1
                iconv(cd, (char **)&Gn, &inbytesleft, (char **)&UChndl_in, &outbytesleft);
                iconv_close(cd);
                g317 = 0;
                if (inbytesleft == 0) {
                    // 0x80f4eff
                    if (outbytesleft == 0) {
                        // 0x80f5133
                        return 256 * v4 & 0xff00 | (int32_t)v2;
                    }
                }
            }
        } else {
            if ((ch_in & -16) == -32 || ch_in < 160 == ch_in < 0 == (ch_in != -128)) {
                // 0x80f4e51
                *(char *)&g318 = ch_in;
                g317 = 1;
                // 0x80f5133
                return -11;
            }
        }
    }
    // 0x80f4f23
    if (strcmp((char *)*str, "euc-jp") == 0) {
        bool v5 = ch_in < 161 | ch_in == -1;
        if (g317 != 0) {
            if (!v5) {
                // 0x80f4f9b
                *(char *)&g319 = ch_in;
                *(char *)&g320 = 0;
                int32_t * cd2 = iconv_open("UTF-16BE", "EUC-JP"); // 0x80f4fba
                iconv(cd2, (char **)&Gn, &inbytesleft, (char **)&UChndl_in, &outbytesleft);
                iconv_close(cd2);
                g317 = 0;
                if (inbytesleft == 0) {
                    // 0x80f5008
                    if (outbytesleft == 0) {
                        // 0x80f5133
                        return 256 * v4 & 0xff00 | (int32_t)v2;
                    }
                }
            }
        } else {
            if (!v5) {
                // 0x80f4f66
                *(char *)&g318 = ch_in;
                g317 = 1;
                // 0x80f5133
                return -11;
            }
        }
    }
    // 0x80f502c
    g317 = 0;
    goto lab_0x80f5036;
  lab_0x80f5036:
    if (ch_in >= 0 && ch_in >= 32) {
        // 0x80f5133
        return ch_in;
    }
    // 0x80f5050
    if (charset_in < 0) {
        // 0x80f5133
        return -11;
    }
    if (ch_in < 32) {
        // 0x80f506a
        if (*(int32_t *)(v3 + (int32_t)&g144) != 3) {
            // 0x80f5133
            return ch_in;
        }
    }
    int32_t v6 = *(int32_t *)(v3 + (int32_t)&LYCharSet_UC); // 0x80f508d
    if (v6 < 0) {
        // 0x80f5133
        return -11;
    }
    int32_t v7 = 60 * v6; // 0x80f50b7
    if (*(int32_t *)(v7 + (int32_t)&g326) == 0) {
        // 0x80f5133
        return -11;
    }
    int32_t v8 = *(int32_t *)(v7 + (int32_t)&g333); // 0x80f50dd
    int32_t v9 = v8; // 0x80f50ea
    if (v8 < 0) {
        // 0x80f50ec
        v9 = UC_MapGN(v6, 1);
    }
    int32_t v10 = (int32_t)set_translate(v9); // 0x80f5108
    *(int32_t *)&UC_translate = v10;
    // 0x80f5133
    return (int32_t)*(int16_t *)(2 * (int32_t)ch_in + v10);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f5138 - 0x80f5310
// Line range:    1235 - 1286
int32_t UCReverseTransChar(unsigned char ch_out, int32_t charset_in, int32_t charset_out) {
    int32_t result = ch_out;
    if (charset_in == charset_out) {
        // 0x80f530b
        return result;
    }
    // 0x80f516c
    if (charset_in < 0) {
        // 0x80f530b
        return -11;
    }
    int32_t v1 = *(int32_t *)(32 * charset_in + (int32_t)&LYCharSet_UC); // 0x80f5184
    if (v1 < 0) {
        // 0x80f530b
        return -11;
    }
    int32_t v2 = 60 * v1; // 0x80f51ae
    if (*(int32_t *)(v2 + (int32_t)&g326) == 0) {
        // 0x80f530b
        return -11;
    }
    // 0x80f51c6
    if (charset_out < 0) {
        // 0x80f530b
        return -12;
    }
    int32_t v3 = 32 * charset_out; // 0x80f51db
    int32_t v4 = *(int32_t *)(v3 + (int32_t)&LYCharSet_UC); // 0x80f51de
    if (v4 < 0) {
        int32_t result2 = *(int32_t *)(v3 + (int32_t)&g145); // 0x80f51f3
        if (result2 < 0) {
            // 0x80f530b
            return result2;
        }
        // 0x80f5211
        if (default_UChndl >= 0) {
            // 0x80f530b
            return UCTransChar(ch_out, charset_out, charset_in);
        }
        // 0x80f530b
        return -12;
    }
    int32_t v5 = 60 * v4; // 0x80f5243
    if (*(int32_t *)(v5 + (int32_t)&g329) != 0) {
        // 0x80f530b
        return UCTransChar(ch_out, charset_out, charset_in);
    }
    int32_t v6 = *(int32_t *)(v5 + (int32_t)&g325); // 0x80f5269
    if (v6 != (int32_t)UC_current_unitable) {
        // 0x80f530b
        return UCTransChar(ch_out, charset_out, charset_in);
    }
    int32_t v7 = *(int32_t *)(v2 + (int32_t)&g333); // 0x80f528d
    int32_t v8 = v7; // 0x80f529a
    if (v7 < 0) {
        // 0x80f529c
        v8 = UC_MapGN(v1, 1);
    }
    int16_t * v9 = set_translate(v8); // 0x80f52b8
    *(int32_t *)&UC_translate = (int32_t)v9;
    if (inv_translate == 0) {
        // 0x80f530b
        return UCTransChar(ch_out, charset_out, charset_in);
    }
    unsigned char result3 = *(char *)(inv_translate + result); // 0x80f52d7
    if (result3 < 32) {
        // 0x80f530b
        return UCTransChar(ch_out, charset_out, charset_in);
    }
    // 0x80f530b
    return result3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f5310 - 0x80f57e7
// Line range:    1297 - 1410
int32_t UCTransCharStr(char * outbuf, uint32_t buflen, unsigned char ch_in, int32_t charset_in, int32_t charset_out, int32_t chk_single_flag) {
    // 0x80f5310
    if (buflen <= 1) {
        // 0x80f57e2
        return -13;
    }
    if (chk_single_flag != 0 && charset_in == charset_out) {
        // 0x80f5358
        *outbuf = ch_in;
        *(char *)((int32_t)outbuf + 1) = 0;
        // 0x80f57e2
        return 1;
    }
    // 0x80f5376
    if (charset_in < 0) {
        // 0x80f57e2
        return -11;
    }
    int32_t v1 = *(int32_t *)(32 * charset_in + (int32_t)&LYCharSet_UC); // 0x80f538e
    if (v1 < 0) {
        // 0x80f57e2
        return -11;
    }
    int32_t v2 = 60 * v1; // 0x80f53b8
    if (*(int32_t *)(v2 + (int32_t)&g326) == 0) {
        // 0x80f57e2
        return -11;
    }
    int32_t v3 = 32 * charset_out; // 0x80f53d3
    int32_t v4 = *(int32_t *)(v3 + (int32_t)&LYCharSet_UC); // 0x80f53d6
    int32_t v5; // 0x80f5310
    int32_t v6; // 0x80f5310
    int32_t v7; // 0x80f5310
    if (v4 >= 0) {
        int32_t v8 = 60 * v4; // 0x80f543b
        v7 = *(int32_t *)(v8 + (int32_t)&g330);
        v5 = v4;
        v6 = *(int32_t *)(v8 + (int32_t)&g329);
    } else {
        int32_t result = *(int32_t *)(v3 + (int32_t)&g145); // 0x80f53eb
        if (result < 0) {
            // 0x80f57e2
            return result;
        }
        // 0x80f5409
        v7 = 0;
        v5 = default_UChndl;
        v6 = 1;
        if (default_UChndl < 0) {
            // 0x80f57e2
            return -12;
        }
    }
    int32_t v9 = *(int32_t *)(v2 + (int32_t)&g333); // 0x80f5471
    int32_t * v10 = NULL; // 0x80f547e
    int32_t v11 = v9; // 0x80f547e
    if (v9 < 0) {
        // 0x80f5480
        v11 = UC_MapGN(v1, (int32_t)(chk_single_flag == 0));
        v10 = (int32_t *)chk_single_flag;
    }
    int32_t v12 = (int32_t)set_translate(v11); // 0x80f54a8
    *(int32_t *)&UC_translate = v12;
    int32_t v13 = (int32_t)*(int16_t *)(2 * (int32_t)ch_in + v12); // 0x80f54c4
    int32_t v14 = 0; // 0x80f54d1
    if (chk_single_flag != 0) {
        if (v6 == 0) {
            int32_t v15 = *(int32_t *)(60 * v5 + (int32_t)&g325); // 0x80f54ee
            if (v15 != (int32_t)UC_current_unitable) {
                int32_t result2 = UC_con_set_unimap(v5, 1); // 0x80f5522
                if (result2 < 1) {
                    // 0x80f553d
                    if (result2 != 0) {
                        // 0x80f57e2
                        return result2;
                    }
                } else {
                    // 0x80f5530
                    set_inverse_transl(v11);
                }
            } else {
                // 0x80f5501
                if (v10 != NULL) {
                    // 0x80f5507
                    set_inverse_transl(v11);
                }
            }
        }
        // 0x80f554e
        v14 = conv_uni_to_pc(v13, v6);
        if (v14 >= 32) {
            // 0x80f5569
            *outbuf = (char)v14;
            *(char *)((int32_t)outbuf + 1) = 0;
            // 0x80f57e2
            return 1;
        }
    }
    int32_t v16 = -14; // 0x80f55ab
    if (v6 == 0) {
        int32_t v17 = 60 * v5; // 0x80f5597
        int32_t v18 = v17 + 0x81b2154; // 0x80f55a1
        if (v18 != (int32_t)UC_current_unitable_str) {
            // 0x80f55bb
            con_clear_unimap_str(0);
            int16_t v19 = *(int16_t *)v18; // 0x80f55d0
            UC_con_set_unimap_str(v19, (int32_t *)*(int32_t *)(v17 + 0x81b2158), 0);
            *(int32_t *)&UC_current_unitable_str = v18;
        }
        // 0x80f55f5
        v16 = conv_uni_to_str(outbuf, buflen, v13, 0);
        if (v16 >= 0) {
            // 0x80f57e2
            return strlen(outbuf);
        }
    }
    int32_t v20 = v14; // 0x80f5636
    if (chk_single_flag != 0 && v7 != 0) {
        // 0x80f563e
        v20 = conv_uni_to_pc(v13, 1);
        if (v20 >= 32) {
            // 0x80f565a
            *outbuf = (char)v20;
            *(char *)((int32_t)outbuf + 1) = 0;
            // 0x80f57e2
            return 1;
        }
    }
    int32_t v21 = v16; // 0x80f567d
    if ((v6 || v7) != 0) {
        // 0x80f5685
        v21 = conv_uni_to_str(outbuf, buflen, v13, 1);
        if (v21 >= 0) {
            // 0x80f57e2
            return strlen(outbuf);
        }
    }
    int32_t v22 = v21; // 0x80f56c6
    if (v21 == -4) {
        int32_t v23 = v21; // 0x80f56cc
        if (v6 == 0) {
            // 0x80f56ce
            v23 = conv_uni_to_str(outbuf, buflen, 0xfffd, 0);
        }
        int32_t v24 = v23; // 0x80f56f7
        if ((v6 || v7) != 0 && v23 == -4) {
            // 0x80f5705
            v24 = conv_uni_to_str(outbuf, buflen, 0xfffd, 1);
        }
        // 0x80f572a
        v22 = v24;
        if (v22 >= 0) {
            // 0x80f57e2
            return strlen(outbuf);
        }
    }
    // 0x80f5743
    if (chk_single_flag == 0 || v20 != -4) {
        // 0x80f57e2
        return -4;
    }
    int32_t v25 = v22; // 0x80f575b
    if (v6 == 0) {
        // 0x80f575d
        v25 = conv_uni_to_pc(0xfffd, 0);
    }
    int32_t v26 = v25; // 0x80f5778
    if ((v6 || v7) != 0 && v25 == -4) {
        // 0x80f5786
        v26 = conv_uni_to_pc(0xfffd, 1);
    }
    int32_t result3 = v26;
    if (result3 < 32) {
        // 0x80f57bf
        if (result3 >= 0 != result3 != 0) {
            // 0x80f57c5
            *outbuf = 0;
        }
        // 0x80f57e2
        return result3;
    }
    // 0x80f57a3
    *outbuf = (char)result3;
    *(char *)((int32_t)outbuf + 1) = 0;
    // 0x80f57e2
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f57e7 - 0x80f5831
// Line range:    1413 - 1422
int32_t UC_FindGN_byMIME(char * UC_MIMEcharset) {
    int32_t v1 = 0; // 0x80f581b
    int32_t str = *(int32_t *)(4 * v1 + (int32_t)&UC_GNsetMIMEnames); // 0x80f57f9
    int32_t result = v1; // 0x80f5811
    while (strcmp(UC_MIMEcharset, (char *)str) != 0) {
        // 0x80f581b
        v1++;
        result = -1;
        if (v1 >= 4) {
            // break -> 0x80f582c
            break;
        }
        str = *(int32_t *)(4 * v1 + (int32_t)&UC_GNsetMIMEnames);
        result = v1;
    }
    // 0x80f582c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f585a - 0x80f58e1
// Line range:    1438 - 1452
int32_t getLYhndl_byCP(char * prefix, char * codepage) {
    int32_t v1 = g321; // 0x80f5867
    g321 = v1 + 1;
    if (v1 != 0) {
        // 0x80f58cf
        g321--;
        return -1;
    }
    int32_t result = 0; // bp-12, 0x80f587d
    HTSACopy((char **)&result, prefix);
    HTSACat((char **)&result, codepage);
    int32_t result2 = UCGetLYhndl_byMIME((char *)result); // 0x80f58ae
    if (result != 0) {
        // 0x80f58bd
        free((int32_t *)result);
        result = 0;
    }
    // 0x80f58cf
    g321--;
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f58e1 - 0x80f5ebd
// Line range:    1460 - 1593
int32_t UCGetLYhndl_byMIME(char * value) {
    int32_t result; // 0x80f58e1
    if (value == NULL) {
        goto lab_0x80f58fe;
    } else {
        // 0x80f58f4
        if (*value != 0) {
            int32_t v1 = LYNumCharsets; // 0x80f5977
            if (LYNumCharsets > 0) {
                int32_t v2 = 0;
                while (*(int32_t *)(4 * v2 + (int32_t)&LYchar_set_names) != 0) {
                    int32_t v3 = *(int32_t *)(32 * v2 + (int32_t)&g143); // 0x80f593b
                    int32_t v4 = v1; // 0x80f5943
                    if (v3 != 0) {
                        // 0x80f5945
                        result = v2;
                        if (strcasecomp(value, (char *)v3) == 0) {
                            // 0x80f5eb8
                            return result;
                        }
                        // 0x80f5945
                        v4 = LYNumCharsets;
                    }
                    int32_t v5 = v2 + 1; // 0x80f596f
                    v1 = v4;
                    if (v5 < 60 != v5 < v4) {
                        // break -> 0x80f5991
                        break;
                    }
                    v2 = v5;
                }
            }
            // 0x80f5991
            if (strcasecomp(value, "unicode-1-1-utf-8") == 0 || strcasecomp(value, "utf8") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("utf-8");
            }
            // 0x80f59d3
            if (strcasecomp(value, "x-euc-jp") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("euc-jp");
            }
            // 0x80f59fe
            if (strcasecomp(value, "x-shift-jis") == 0 || strcasecomp(value, "x-sjis") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("shift_jis");
            }
            // 0x80f5a40
            if (strcasecomp(value, "iso-2022-kr") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("euc-kr");
            }
            // 0x80f5a6b
            if (strcasecomp(value, "gb2312") == 0 || strncasecomp(value, "cn-gb", 5) == 0 || strcasecomp(value, "iso-2022-cn") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("euc-cn");
            }
            // 0x80f5acc
            if (strcasecomp(value, "cn-big5") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("big5");
            }
            // 0x80f5af7
            if (strcasecomp(value, "x-mac-roman") == 0 || strcasecomp(value, "mac-roman") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("macintosh");
            }
            // 0x80f5b39
            if (strcasecomp(value, "x-next") == 0 || strcasecomp(value, "nextstep") == 0 || strcasecomp(value, "x-nextstep") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("next");
            }
            // 0x80f5b92
            if (strcasecomp(value, "iso-8859-1-windows-3.1-latin-1") == 0 || strcasecomp(value, "cp1252") == 0 || strcasecomp(value, "cp-1252") == 0 || strcasecomp(value, "ibm1252") == 0 || strcasecomp(value, "iso-8859-1-windows-3.0-latin-1") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("windows-1252");
            }
            // 0x80f5c19
            if (strcasecomp(value, "iso-8859-2-windows-latin-2") == 0 || strcasecomp(value, "cp1250") == 0 || strcasecomp(value, "cp-1250") == 0 || strcasecomp(value, "ibm1250") == 0) {
                // 0x80f5eb8
                return UCGetLYhndl_byMIME("windows-1250");
            }
            // 0x80f5c89
            if (strncasecomp(value, "ibm", 3) == 0) {
                goto lab_0x80f5ccb;
            } else {
                // 0x80f5ca8
                if (strncasecomp(value, "cp-", 3) != 0) {
                    goto lab_0x80f5d8c;
                } else {
                    goto lab_0x80f5ccb;
                }
            }
        } else {
            goto lab_0x80f58fe;
        }
    }
  lab_0x80f58fe:
    // 0x80f58fe
    if (WWW_TraceFlag != 0) {
        // 0x80f5909
        fprintf(TraceFP(), "UCGetLYhndl_byMIME: NULL argument instead of MIME name.\n");
    }
    // 0x80f5eb8
    return -1;
  lab_0x80f5ccb:;
    int16_t * v6 = *__ctype_b_loc(); // 0x80f5cd0
    int32_t v7 = (int32_t)value; // 0x80f5cd2
    char * v8 = (char *)(v7 + 3); // 0x80f5cd8
    if ((*(int16_t *)(2 * (int32_t)*v8 + (int32_t)v6) & 2048) != 0) {
        int16_t * v9 = *__ctype_b_loc(); // 0x80f5cfb
        unsigned char v10 = *(char *)(v7 + 4); // 0x80f5d03
        if ((*(int16_t *)(2 * (int32_t)v10 + (int32_t)v9) & 2048) != 0) {
            int16_t * v11 = *__ctype_b_loc(); // 0x80f5d22
            unsigned char v12 = *(char *)(v7 + 5); // 0x80f5d2a
            if ((*(int16_t *)(2 * (int32_t)v12 + (int32_t)v11) & 2048) != 0) {
                int32_t v13 = getLYhndl_byCP("cp", v8); // 0x80f5d55
                result = v13;
                if (v13 < 0) {
                    // 0x80f5d6e
                    result = getLYhndl_byCP("windows-", v8);
                }
                // 0x80f5eb8
                return result;
            }
        }
    }
    goto lab_0x80f5d8c;
  lab_0x80f5d8c:
    // 0x80f5d8c
    if (strncasecomp(value, "windows-", 8) == 0) {
        int16_t * v14 = *__ctype_b_loc(); // 0x80f5db4
        int32_t v15 = (int32_t)value; // 0x80f5db6
        char * v16 = (char *)(v15 + 8); // 0x80f5dbc
        if ((*(int16_t *)(2 * (int32_t)*v16 + (int32_t)v14) & 2048) != 0) {
            int16_t * v17 = *__ctype_b_loc(); // 0x80f5ddb
            unsigned char v18 = *(char *)(v15 + 9); // 0x80f5de3
            if ((*(int16_t *)(2 * (int32_t)v18 + (int32_t)v17) & 2048) != 0) {
                int16_t * v19 = *__ctype_b_loc(); // 0x80f5e02
                unsigned char v20 = *(char *)(v15 + 10); // 0x80f5e0a
                if ((*(int16_t *)(2 * (int32_t)v20 + (int32_t)v19) & 2048) != 0) {
                    // 0x80f5eb8
                    return getLYhndl_byCP("cp", v16);
                }
            }
        }
    }
    // 0x80f5e3f
    if (strcasecomp(value, "koi-8") == 0) {
        // 0x80f5eb8
        return UCGetLYhndl_byMIME("koi8-r");
    }
    // 0x80f5e67
    if (strcasecomp(value, "ANSI_X3.4-1968") == 0) {
        // 0x80f5eb8
        return US_ASCII;
    }
    // 0x80f5e88
    if (WWW_TraceFlag != 0) {
        // 0x80f5e93
        fprintf(TraceFP(), "UCGetLYhndl_byMIME: unrecognized MIME name \"%s\"\n", value);
    }
    // 0x80f5eb8
    return -1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f5ebd - 0x80f5ee6
// Line range:    1617 - 1623
void UCreset_allocated_LYCharSets(void) {
    for (int32_t i = 0; i < 60; i++) {
        // 0x80f5ecc
        *(int32_t *)(4 * i + (int32_t)&remember_allocated_LYCharSets) = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f5ee6 - 0x80f6311
// Line range:    1640 - 1776
char ** UC_setup_LYCharSets_repl(int32_t UC_charset_in_hndl, uint32_t lowest8) {
    int32_t * mem = malloc(384); // 0x80f5efb
    if (mem == NULL) {
        // 0x80f630c
        return NULL;
    }
    int32_t v1 = (int32_t)mem;
    int32_t v2 = (int32_t)NULL; // 0x80f5f1e
    *(int32_t *)(4 * v2 + v1) = 0;
    char * v3 = (char *)(v2 + 1); // 0x80f5f2d
    while (v3 <= (char *)95) {
        // 0x80f5f1e
        v2 = (int32_t)v3;
        *(int32_t *)(4 * v2 + v1) = 0;
        v3 = (char *)(v2 + 1);
    }
    int32_t * mem2 = malloc(96); // 0x80f5f3e
    int32_t v4 = (int32_t)mem2; // 0x80f5f3e
    if (mem2 == NULL) {
        // 0x80f5f64
        free(mem);
        // 0x80f630c
        return NULL;
    }
    int32_t v5 = (int32_t)NULL; // 0x80f5f79
    *(char *)(v5 + v4) = 0;
    char * v6 = (char *)(v5 + 1); // 0x80f5f85
    while (v6 <= (char *)95) {
        // 0x80f5f79
        v5 = (int32_t)v6;
        *(char *)(v5 + v4) = 0;
        v6 = (char *)(v5 + 1);
    }
    int32_t v7 = 60 * UC_charset_in_hndl; // 0x80f5f9e
    if (*(int32_t *)(v7 + (int32_t)&g326) >= 1) {
        int32_t v8 = *(int32_t *)(v7 + (int32_t)&g325); // 0x80f5fa0
        char ** v9 = (char **)v8;
        int32_t v10 = *(int32_t *)(v7 + (int32_t)&g324); // 0x80f5fe2
        uint32_t v11 = (int32_t)NULL; // 0x80f5fe8
        unsigned char v12 = *(char *)(v10 + v11); // 0x80f5feb
        char ** v13 = v9; // 0x80f5ff8
        uint16_t v14; // 0x80f5ffd
        char ** v15; // 0x80f5ee6
        int32_t v16; // 0x80f6035
        if (v12 != 0) {
            // 0x80f5ffa
            v14 = *(int16_t *)v9;
            if (v11 >= lowest8 && v14 <= 255) {
                // 0x80f601c
                *(char *)(v4 - 160 + (int32_t)v14) = (char)v11;
            }
            // 0x80f6031
            v16 = v12;
            v15 = v9;
            v15 = (char **)((int32_t)v15 + 2);
            v16--;
            v13 = v15;
            while (v16 != 0) {
                // 0x80f6031
                v15 = (char **)((int32_t)v15 + 2);
                v16--;
                v13 = v15;
            }
        }
        char * v17 = (char *)(v11 + 1); // 0x80f603f
        while (v17 <= (char *)255) {
            // 0x80f5fd1
            v9 = v13;
            v10 = *(int32_t *)(v7 + (int32_t)&g324);
            v11 = (int32_t)v17;
            v12 = *(char *)(v10 + v11);
            v13 = v9;
            if (v12 != 0) {
                // 0x80f5ffa
                v14 = *(int16_t *)v9;
                if (v11 >= lowest8 && v14 <= 255) {
                    // 0x80f601c
                    *(char *)(v4 - 160 + (int32_t)v14) = (char)v11;
                }
                // 0x80f6031
                v16 = v12;
                v15 = v9;
                v15 = (char **)((int32_t)v15 + 2);
                v16--;
                v13 = v15;
                while (v16 != 0) {
                    // 0x80f6031
                    v15 = (char **)((int32_t)v15 + 2);
                    v16--;
                    v13 = v15;
                }
            }
            // 0x80f603f
            v17 = (char *)(v11 + 1);
        }
    }
    int16_t v18 = *(int16_t *)(v7 + (int32_t)&g327); // 0x80f605d
    if (v18 != 0) {
        int16_t v19 = v18;
        int32_t v20 = *(int32_t *)(v7 + (int32_t)&g328);
        uint16_t v21 = *(int16_t *)v20; // 0x80f6087
        int32_t v22; // 0x80f60b2
        if (v21 < 256) {
            // 0x80f609e
            v22 = *(int32_t *)(v20 + 4);
            *(int32_t *)(v1 - 640 + 4 * (int32_t)v21) = v22;
        }
        // 0x80f60b7
        v19--;
        int32_t v23 = v20 + 8; // 0x80f60ca
        while (v19 != 0) {
            // 0x80f6084
            v20 = v23;
            v21 = *(int16_t *)v20;
            if (v21 < 256) {
                // 0x80f609e
                v22 = *(int32_t *)(v20 + 4);
                *(int32_t *)(v1 - 640 + 4 * (int32_t)v21) = v22;
            }
            // 0x80f60b7
            v19--;
            v23 = v20 + 8;
        }
    }
    int32_t * mem3 = malloc(448); // 0x80f60d7
    char ** ISO_Latin1_ = (char **)mem3; // bp-20, 0x80f60dc
    if (mem3 == NULL) {
        // 0x80f6115
        free(mem);
        free(mem2);
        // 0x80f630c
        return NULL;
    }
    // 0x80f6121
    char ** ISO_Latin1; // bp-16, 0x80f5ee6
    *(int32_t *)&ISO_Latin1 = (int32_t)mem3;
    int32_t v24 = v1 - 640;
    char ** v25 = (char **)mem3; // 0x80f629d
    int32_t v26 = 0;
    char * v27 = NULL; // 0x80f6299
    int32_t v28; // 0x80f5ee6
    int32_t v29; // 0x80f5ee6
    int32_t v30; // 0x80f613a
    int32_t str; // 0x80f613d
    int32_t v31; // 0x80f6150
    char * v32; // 0x80f616a
    unsigned char v33; // 0x80f616a
    int32_t v34; // 0x80f5ee6
    unsigned char v35; // 0x80f6197
    while (true) {
      lab_0x80f613a:
        // 0x80f613a
        v29 = v26;
        v30 = (int32_t)v27;
        int32_t v36 = 4 * v30; // 0x80f613d
        str = *(int32_t *)(v36 + (int32_t)&SevenBitApproximations);
        v31 = *(int32_t *)(v36 + *(int32_t *)&LYCharSets);
        *(int32_t *)v25 = str;
        v28 = v29;
        if (v31 == 0) {
            goto lab_0x80f6299;
        } else {
            // 0x80f6167
            v32 = (char *)v31;
            v33 = *v32;
            v28 = v29;
            if (v33 < 160) {
                goto lab_0x80f6299;
            } else {
                // 0x80f6175
                v28 = v29;
                if (*(char *)(v31 + 1) != 0) {
                    goto lab_0x80f6299;
                } else {
                    // 0x80f6186
                    v34 = v33;
                    v35 = *(char *)(v4 - 160 + v34);
                    if (v35 < (char)lowest8) {
                        goto lab_0x80f6234;
                    } else {
                        // 0x80f61a5
                        if ((int32_t)*(char *)str != (int32_t)v35) {
                            goto lab_0x80f61d6;
                        } else {
                            // 0x80f61c9
                            if (*(char *)(str + 1) == 0) {
                                goto lab_0x80f6234;
                            } else {
                                goto lab_0x80f61d6;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x80f62df:
    // 0x80f62df
    free(mem);
    free(mem2);
    if (v26 != 0) {
        // 0x80f630c
        return ISO_Latin1_;
    }
    // 0x80f62e5
    if (ISO_Latin1_ != NULL) {
        // 0x80f62eb
        free((int32_t *)ISO_Latin1_);
    }
    // 0x80f630c
    return NULL;
  lab_0x80f6299:
    // 0x80f6299
    v26 = v28;
    v27 = (char *)(v30 + 1);
    v25 = (char **)((int32_t)ISO_Latin1 + 4);
    ISO_Latin1 = v25;
    if (v27 >= (char *)112) {
        // break -> 0x80f62df
        goto lab_0x80f62df;
    }
    goto lab_0x80f613a;
  lab_0x80f6234:;
    int32_t str2 = *(int32_t *)(4 * v34 + v24); // 0x80f6248
    v28 = v29;
    if (str2 != 0) {
        // 0x80f624e
        v28 = v29;
        if (strcmp((char *)str, (char *)str2) != 0) {
            // 0x80f6277
            *(int32_t *)ISO_Latin1 = *(int32_t *)(4 * (int32_t)*v32 + v24);
            v28 = 1;
        }
    }
    goto lab_0x80f6299;
  lab_0x80f61d6:
    if (v35 != v33) {
        // 0x80f61fe
        *(char *)&g322 = v35;
        int32_t v37 = *(int32_t *)((int32_t)HTAtom_for((char *)&g322) + 4); // 0x80f6223
        *(int32_t *)ISO_Latin1 = v37;
        v28 = 1;
    } else {
        // 0x80f61f4
        *(int32_t *)ISO_Latin1 = v31;
        v28 = 1;
    }
    goto lab_0x80f6299;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f6311 - 0x80f657c
// Line range:    1785 - 1866
int32_t UC_Register_with_LYCharSets(int32_t s, char * UC_MIMEcharset, char * UC_LYNXcharset, int32_t lowest_eightbit) {
    // 0x80f6311
    if (LYNumCharsets == 0) {
        uint32_t v1 = 0;
        while (*(int32_t *)(4 * v1 + (int32_t)&LYchar_set_names) != 0) {
            int32_t v2 = v1 + 1; // 0x80f6333
            LYNumCharsets = v2;
            if (v1 > 58) {
                // break -> 0x80f6353
                break;
            }
            v1 = v2;
        }
    }
    int32_t v3 = -1;
    uint32_t v4 = 0;
    int32_t v5 = *(int32_t *)(4 * v4 + (int32_t)&LYchar_set_names); // 0x80f639e
    int32_t v6 = v3; // 0x80f63a7
    while (v3 < 0 == (v5 != 0)) {
        int32_t str = *(int32_t *)(32 * v4 + (int32_t)&g143); // 0x80f6362
        int32_t v7 = v3; // 0x80f636a
        if (str != 0) {
            // 0x80f636c
            v7 = strcmp(UC_MIMEcharset, (char *)str) != 0 ? v3 : v4;
        }
        // 0x80f6391
        v6 = v7;
        if (v4 > 58) {
            // break -> 0x80f63af
            break;
        }
        v3 = v7;
        v4++;
        v5 = *(int32_t *)(4 * v4 + (int32_t)&LYchar_set_names);
        v6 = v3;
    }
    // 0x80f63af
    int32_t * v8; // 0x80f6311
    int32_t v9; // 0x80f6311
    int32_t result; // 0x80f6311
    int32_t v10; // 0x80f6311
    if (v6 >= 0) {
        int32_t v11 = 4 * v6; // 0x80f64cf
        v8 = (int32_t *)(v11 + (int32_t)&LYlowest_eightbit);
        v9 = v11;
        v10 = 1;
        result = v6;
    } else {
        int32_t v12 = LYNumCharsets; // 0x80f63c0
        if (v12 >= 60) {
            // 0x80f63ca
            if (WWW_TraceFlag != 0) {
                // 0x80f63d5
                fprintf(TraceFP(), "UC_Register_with_LYCharSets: Too many.  Ignoring %s/%s.", UC_MIMEcharset, UC_LYNXcharset);
            }
            // 0x80f6577
            return -1;
        }
        // 0x80f6408
        LYNumCharsets = v12 + 1;
        int32_t v13 = 4 * v12;
        int32_t * v14 = (int32_t *)(v13 + (int32_t)&LYlowest_eightbit);
        *v14 = 999;
        *(int32_t *)(v13 + (int32_t)&LYCharSets) = (int32_t)&SevenBitApproximations;
        *(int32_t *)(v13 + (int32_t)&LYchar_set_names) = (int32_t)UC_LYNXcharset;
        *(int32_t *)(v13 + (int32_t)&LYchar_set_names + 4) = 0;
        v8 = v14;
        v9 = v13;
        v10 = 0;
        result = v12;
    }
    int32_t v15 = 32 * result; // 0x80f6465
    *(int32_t *)(v15 + (int32_t)&LYCharSet_UC) = s;
    *(int32_t *)(v15 + (int32_t)&g143) = (int32_t)UC_MIMEcharset;
    int32_t v16 = 60 * s; // 0x80f6494
    int32_t v17 = *(int32_t *)(v16 + (int32_t)&g335); // 0x80f6496
    *(int32_t *)(v15 + (int32_t)&g144) = v17;
    int32_t v18 = *(int32_t *)(v16 + (int32_t)&g336); // 0x80f64bb
    *(int32_t *)(v15 + (int32_t)&g145) = v18;
    int32_t v19 = *v8; // 0x80f64cf
    if (v19 > lowest_eightbit) {
        // 0x80f64db
        *v8 = lowest_eightbit;
    } else {
        if (v19 < lowest_eightbit) {
            // 0x80f64f9
            *(int32_t *)(v16 + (int32_t)&g334) = v19;
        }
    }
    // 0x80f651c
    if (v10 != 0 || result < 1) {
        // 0x80f6577
        return result;
    }
    char ** v20 = UC_setup_LYCharSets_repl(s, *(int32_t *)(v16 + (int32_t)&g334)); // 0x80f6549
    if (v20 != NULL) {
        int32_t v21 = (int32_t)v20; // 0x80f6549
        *(int32_t *)(v9 + (int32_t)&LYCharSets) = v21;
        *(int32_t *)(v9 + (int32_t)&remember_allocated_LYCharSets) = v21;
    }
    // 0x80f6577
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f657c - 0x80f67ff
// Line range:    1881 - 1930
void UC_Charset_Setup(char * UC_MIMEcharset, char * UC_LYNXcharset, char * unicount, int16_t * unitable, int32_t nnuni, int32_t replacedesc, int32_t lowest_eight, int32_t UC_rawuni, int32_t codepage) {
    int32_t v1 = 0; // 0x80f65d6
    int32_t v2 = -1; // 0x80f65d6
    int32_t v3 = UCNumCharsets; // 0x80f65d6
    bool v4; // 0x80f657c
    int32_t v5; // 0x80f657c
    int32_t v6; // 0x80f657c
    if (UCNumCharsets > 0) {
        int32_t str = *(int32_t *)(60 * v1 + (int32_t)&UCInfo); // 0x80f65ab
        v2 = strcmp((char *)str, UC_MIMEcharset) != 0 ? v2 : v1;
        v1++;
        v3 = UCNumCharsets;
        while (v1 < v3 == v2 < 0) {
            // 0x80f659a
            str = *(int32_t *)(60 * v1 + (int32_t)&UCInfo);
            v2 = strcmp((char *)str, UC_MIMEcharset) != 0 ? v2 : v1;
            v1++;
            v3 = UCNumCharsets;
        }
        if (v2 < 0) {
            // 0x80f65ec
            if (v3 >= 60) {
                // 0x80f65f6
                if (WWW_TraceFlag != 0) {
                    // 0x80f6605
                    fprintf(TraceFP(), "UC_Charset_Setup: Too many.  Ignoring %s/%s.", UC_MIMEcharset, UC_LYNXcharset);
                }
                // 0x80f67f9
                return;
            }
            goto lab_0x80f6631;
        } else {
            // 0x80f65de
            v4 = false;
            v5 = 60 * v2;
            v6 = v2;
            goto lab_0x80f6653;
        }
    } else {
        goto lab_0x80f6631;
    }
  lab_0x80f6631:;
    int32_t v7 = 60 * v3;
    *(int32_t *)(v7 + (int32_t)&UCInfo) = (int32_t)UC_MIMEcharset;
    v4 = true;
    v5 = v7;
    v6 = v3;
    goto lab_0x80f6653;
  lab_0x80f6653:
    // 0x80f6653
    *(int32_t *)(v5 + (int32_t)&g323) = (int32_t)UC_LYNXcharset;
    *(int32_t *)(v5 + (int32_t)&g324) = (int32_t)unicount;
    *(int32_t *)(v5 + (int32_t)&g325) = (int32_t)unitable;
    *(int32_t *)(v5 + (int32_t)&g326) = nnuni;
    *(int32_t *)(v5 + (int32_t)&g327) = replacedesc;
    *(int32_t *)(v5 + (int32_t)&g328) = lowest_eight;
    *(int32_t *)(v5 + (int32_t)&g329) = UC_rawuni;
    *(int32_t *)(v5 + (int32_t)&g330) = codepage;
    if (UC_rawuni != 0) {
        // 0x80f66f3
        default_UChndl = v6;
    }
    uint32_t v8 = UC_FindGN_byMIME(UC_MIMEcharset); // 0x80f6701
    if (v8 >= 0) {
        // 0x80f670f
        *(int32_t *)(4 * v8 + (int32_t)&UC_GNhandles) = v6;
    }
    // 0x80f671c
    *(int32_t *)(v5 + (int32_t)&g333) = v8;
    int32_t v9; // 0x80f657c
    int32_t v10 = v9 != 7 ? v9 : 128;
    *(int32_t *)(v5 + (int32_t)&g334) = v10;
    int32_t v11 = UC_Register_with_LYCharSets(v6, UC_MIMEcharset, UC_LYNXcharset, v10); // 0x80f67af
    *(int32_t *)(v5 + (int32_t)&g332) = v11;
    *(int32_t *)(v5 + (int32_t)&g331) = 0;
    if (v4) {
        // 0x80f67ec
        UCNumCharsets++;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f67ff - 0x80f6987
// Line range:    1945 - 2001
int32_t UC_NoUctb_Register_with_LYCharSets(char * UC_MIMEcharset, char * UC_LYNXcharset, int32_t lowest_eightbit, int32_t UC_rawuni, int32_t codepage) {
    // 0x80f67ff
    if (LYNumCharsets == 0) {
        uint32_t v1 = 0;
        while (*(int32_t *)(4 * v1 + (int32_t)&LYchar_set_names) != 0) {
            int32_t v2 = v1 + 1; // 0x80f6821
            LYNumCharsets = v2;
            if (v1 > 58) {
                // break -> 0x80f6841
                break;
            }
            v1 = v2;
        }
    }
    uint32_t v3 = 0;
    while (*(int32_t *)(4 * v3 + (int32_t)&LYchar_set_names) != 0) {
        int32_t str = *(int32_t *)(32 * v3 + (int32_t)&g143); // 0x80f6850
        if (str != 0) {
            // 0x80f685a
            if (strcmp(UC_MIMEcharset, (char *)str) == 0) {
                // 0x80f6982
                return -1;
            }
        }
        if (v3 > 58) {
            // break -> 0x80f68a3
            break;
        }
        // 0x80f6885
        v3++;
    }
    int32_t result = LYNumCharsets; // 0x80f68a3
    if (result >= 60) {
        // 0x80f68ad
        if (WWW_TraceFlag != 0) {
            // 0x80f68b8
            fprintf(TraceFP(), "UC_NoUctb_Register_with_LYCharSets: Too many.  Ignoring %s/%s.", UC_MIMEcharset, UC_LYNXcharset);
        }
        // 0x80f6982
        return -1;
    }
    // 0x80f68eb
    LYNumCharsets = result + 1;
    int32_t v4 = 4 * result; // 0x80f6906
    *(int32_t *)(v4 + (int32_t)&LYlowest_eightbit) = lowest_eightbit;
    *(int32_t *)(v4 + (int32_t)&LYCharSets) = (int32_t)&SevenBitApproximations;
    *(int32_t *)(v4 + (int32_t)&LYchar_set_names) = (int32_t)UC_LYNXcharset;
    *(int32_t *)(v4 + (int32_t)&LYchar_set_names + 4) = 0;
    int32_t v5 = 32 * result; // 0x80f693c
    *(int32_t *)(v5 + (int32_t)&LYCharSet_UC) = -1;
    *(int32_t *)(v5 + (int32_t)&g143) = (int32_t)UC_MIMEcharset;
    *(int32_t *)(v5 + (int32_t)&g144) = UC_rawuni;
    *(int32_t *)(v5 + (int32_t)&g145) = codepage;
    // 0x80f6982
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f6987 - 0x80f6a17
// Line range:    2012 - 2037
void UC_Charset_NoUctb_Setup(char * UC_MIMEcharset, char * UC_LYNXcharset, int32_t trydefault, int32_t lowest_eight, int32_t UC_rawuni, int32_t codepage) {
    int32_t v1 = 0; // 0x80f69cc
    if ((uint32_t)UCNumCharsets <= 0) {
      lab_0x80f69ce:;
        int32_t v2 = UC_rawuni != 7 ? lowest_eight : 128;
        int32_t v3 = (codepage | trydefault) == 0 ? -12 : codepage;
        UC_NoUctb_Register_with_LYCharSets(UC_MIMEcharset, UC_LYNXcharset, v2, UC_rawuni, v3);
        // 0x80f6a15
        return;
    }
    int32_t str = *(int32_t *)(60 * v1 + (int32_t)&UCInfo); // 0x80f69a7
    while (strcmp((char *)str, UC_MIMEcharset) != 0) {
        // 0x80f69c4
        v1++;
        if (v1 >= UCNumCharsets) {
            goto lab_0x80f69ce;
        }
        str = *(int32_t *)(60 * v1 + (int32_t)&UCInfo);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f6a17 - 0x80f7ce9
// Line range:    2099 - 2208
void UCInit(void) {
    // 0x80f6a17
    UCreset_allocated_LYCharSets();
    UCconsole_map_init();
    UC_Charset_Setup("iso-8859-1", "Western (ISO-8859-1)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x02\x02\x01\x01\x01\x01\x02\x01\x04\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_iso_8859_1, 201, 67, (int32_t)&repl_map_iso_8859_1, 0, 1);
    UC_Charset_Setup("iso-8859-15", "Western (ISO-8859-15)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_iso_8859_15, 191, 0, 0, 0, 1);
    UC_Charset_Setup("cp850", "Western (cp850)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x02\x02\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x02\x02\x02\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x02\x01\x02\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x02\x02\x01\x01\x02\x01\x01\x01\x01\x02\x02\x02\x04\x01\x01\x01\x01\x01", dfont_unitable_cp850, 247, 8, (int32_t)&repl_map_cp850, 0, 1);
    UC_Charset_Setup("windows-1252", "Western (windows-1252)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x00\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x00\x01\x00\x00\x01\x01\x01\x03\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x02\x02\x01\x01\x01\x01\x02\x01\x04\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_windows_1252, 229, 9, (int32_t)&repl_map_windows_1252, 0, 1);
    UC_Charset_Setup("cp437", "IBM PC US codepage (cp437)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x02\x02\x02\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x02\x01\x02\x01\x01\x02\x02\x01\x01\x02\x03\x01\x01\x01\x02\x02\x02\x01\x01\x01\x02\x03\x02\x01\x01\x01\x01\x01", dfont_unitable_cp437, 247, 12, (int32_t)&repl_map_cp437, 0, 1);
    UC_Charset_Setup("dec-mcs", "DEC Multinational", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x00\x01\x00\x01\x01\x01\x01\x01\x00\x00\x00\x00\x01\x01\x01\x01\x00\x01\x01\x01\x00\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00", dfont_unitable_dec_mcs, 176, 17, (int32_t)&repl_map_dec_mcs, 0, 1);
    UC_Charset_Setup("macintosh", "Macintosh (8 bit)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x04\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_macintosh, 226, 14, (int32_t)&repl_map_macintosh, 0, 1);
    UC_Charset_Setup("next", "NeXT character set", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00", dfont_unitable_next, 222, 0, 0, 0, 1);
    UC_Charset_Setup("hp-roman8", "HP Roman8", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_hp_roman8, 190, 0, 0, 0, 1);
    UC_Charset_NoUctb_Setup("euc-cn", "Chinese", 1, 128, 5, 0);
    UC_Charset_NoUctb_Setup("euc-jp", "Japanese (EUC-JP)", 1, 128, 5, 0);
    UC_Charset_NoUctb_Setup("shift_jis", "Japanese (Shift_JIS)", 1, 128, 5, 0);
    UC_Charset_NoUctb_Setup("euc-kr", "Korean", 1, 128, 5, 0);
    UC_Charset_NoUctb_Setup("big5", "Taipei (Big5)", 1, 128, 5, 0);
    UC_Charset_Setup("viscii", "Vietnamese (VISCII)", "\x00\x00\x01\x00\x00\x01\x01\x00\x00\x01\x01\x00\x01\x01\x00\x00\x00\x00\x00\x00\x01\x00\x00\x01\x01\x01\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_viscii, 142, 8, (int32_t)&repl_map_viscii, 0, 1);
    UC_Charset_Setup("us-ascii", "7 bit approximations (US-ASCII)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\x02\b\x03\x02\x02\x02\x06\x02\x02\"d\x06\b\x06\x05\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x05\x04\x02\x02\x02\x03\x03\f\x02\a\x04\r\x02\n\x05\x0f\x04\x06\b\x03\b\v\x03\x04\a\a\x05\r\x03\x03\b\x05\a\x03\x02\x02\x03\x02\x05\f\x03\a\x04\f\x02\v\x06\r\x06\x05\x06\x03\a\x0e\x03\x03\a\a\x05\r\x04\x04\x02\x06\x06\x02\x03\x02\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", dfont_unitable, 616, 2610, (int32_t)&repl_map, 1, 0);
    UC_Charset_NoUctb_Setup("x-transparent", "Transparent", 0, 128, 1, 0);
    UC_Charset_Setup("iso-8859-2", "Eastern European (ISO-8859-2)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x02\x01\x01\x01\x01\x01\x02\x02\x01\x01\x01\x01\x02\x01\x02\x01\x02\x01\x01\x01\x01\x02\x02\x02\x01\x01\x01\x02\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x03\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x03", dfont_unitable_iso_8859_2, 209, 7, (int32_t)&repl_map_iso_8859_2, 0, 1);
    UC_Charset_Setup("cp852", "Eastern European (cp852)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x02\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x03\x02\x02\x02\x02\x01\x01\x02\x02\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x02\x02\x01\x01\x01\x01\x01\x01\x01\x02\x01\x02\x02\x02\x02\x01\x01\x02\x02\x02\x03\x01\x01\x01\x01\x01", dfont_unitable_cp852, 251, 7, (int32_t)&repl_map_cp852, 0, 1);
    UC_Charset_Setup("windows-1250", "Eastern European (windows-1250)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x00\x01\x00\x01\x01\x01\x01\x00\x01\x02\x01\x01\x01\x02\x01\x00\x01\x01\x01\x01\x01\x01\x01\x00\x01\x02\x01\x01\x01\x02\x01\x01\x02\x02\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x02\x01\x02\x01\x01\x02\x01\x01\x02\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x03\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x03", dfont_unitable_windows_1250, 235, 8, (int32_t)&repl_map_windows_1250, 0, 1);
    UC_Charset_Setup("iso-8859-3", "Latin 3 (ISO-8859-3)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_iso_8859_3, 184, 0, 0, 0, 1);
    UC_Charset_Setup("iso-8859-4", "Latin 4 (ISO-8859-4)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_iso_8859_4, 97, 0, 0, 0, 1);
    UC_Charset_Setup("iso-8859-13", "Baltic Rim (ISO-8859-13)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_iso_8859_13, 191, 0, 0, 0, 1);
    UC_Charset_Setup("cp775", "Baltic Rim (cp775)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_cp775, 223, 0, 0, 0, 1);
    UC_Charset_Setup("windows-1257", "Baltic Rim (windows-1257)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x00\x01\x00\x01\x01\x01\x01\x00\x01\x00\x01\x00\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x00\x01\x00\x01\x00\x01\x01\x00\x01\x00\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_windows_1257, 211, 0, 0, 0, 1);
    UC_Charset_Setup("iso-8859-5", "Cyrillic (ISO-8859-5)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x02\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x02\x01\x01\x01\x01\x02\x01\x01\x01\x02\x01\x01\x01\x01\x02\x01\x01\x02\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x02\x01\x01\x01\x02\x01\x01\x01\x01\x02\x01\x01\x02\x02\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_iso_8859_5, 208, 4, (int32_t)&repl_map_iso_8859_5, 0, 1);
    UC_Charset_Setup("cp866", "Cyrillic (cp866)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_cp866, 224, 0, 0, 0, 1);
    UC_Charset_Setup("windows-1251", "Cyrillic (windows-1251)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_windows_1251, 222, 0, 0, 0, 1);
    UC_Charset_Setup("koi8-r", "Cyrillic (KOI8-R)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x02\x01\x01\x01\x02\x01\x01\x01\x01\x01\x02\x01\x01\x02\x01\x02\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x02\x02\x01\x01\x01\x01\x02\x01\x01\x01\x02\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x02\x01\x01\x02\x01", dfont_unitable_koi8_r, 239, 0, 0, 0, 1);
    UC_Charset_Setup("iso-8859-6", "Arabic (ISO-8859-6)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", dfont_unitable_iso_8859_6, 146, 0, 0, 0, 1);
    UC_Charset_Setup("cp864", "Arabic (cp864)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x01\x01\x00\x01\x01\x01\x01\x01\x01\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_cp864, 218, 0, 0, 0, 1);
    UC_Charset_Setup("windows-1256", "Arabic (windows-1256)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_windows_1256, 223, 0, 0, 0, 1);
    UC_Charset_Setup("iso-8859-14", "Celtic (ISO-8859-14)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_iso_8859_14, 191, 0, 0, 0, 1);
    UC_Charset_Setup("iso-8859-7", "Greek (ISO-8859-7)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x03\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x02\x04\x02\x02\x02\x01\x02\x01\x02\x02\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x02\x01\x00\x01\x01\x01\x02\x02\x01\x01\x01\x01\x02\x02\x02\x02\x01\x01\x01\x02\x02\x01\x01\x01\x01\x02\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x02\x02\x02\x02", dfont_unitable_iso_8859_7, 220, 6, (int32_t)&repl_map_iso_8859_7, 0, 1);
    UC_Charset_Setup("cp737", "Greek (cp737)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x02\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x03\x01\x01\x01\x01\x01\x01", dfont_unitable_cp737, 231, 9, (int32_t)&repl_map_cp737, 0, 1);
    UC_Charset_Setup("cp869", "Greek2 (cp869)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x01\x00\x01\x01\x01\x02\x02\x01\x01\x01\x01\x01\x01\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_cp869, 217, 0, 0, 0, 1);
    UC_Charset_Setup("windows-1253", "Greek (windows-1253)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x00\x01\x01\x01\x01\x01\x01\x00\x01\x00\x01\x00\x00\x00\x00\x00\x02\x02\x01\x01\x01\x01\x01\x00\x01\x00\x01\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_windows_1253, 208, 0, 0, 0, 1);
    UC_Charset_Setup("iso-8859-8", "Hebrew (ISO-8859-8)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x01\x01", dfont_unitable_iso_8859_8, 155, 22, (int32_t)&repl_map_iso_8859_8, 0, 1);
    UC_Charset_Setup("cp862", "Hebrew (cp862)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_cp862, 224, 0, 0, 0, 1);
    UC_Charset_Setup("windows-1255", "Hebrew (windows-1255)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x01\x01", dfont_unitable_windows_1255, 200, 0, 0, 0, 1);
    UC_Charset_Setup("iso-8859-9", "Turkish (ISO-8859-9)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x02\x01\x01\x01\x01\x01\x01\x02\x02\x01\x01\x01\x01\x02\x01\x03\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x03\x02\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x03\x02\x01", dfont_unitable_iso_8859_9, 205, 8, (int32_t)&repl_map_iso_8859_9, 0, 1);
    UC_Charset_Setup("cp857", "Turkish (cp857)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_cp857, 221, 0, 0, 0, 1);
    UC_Charset_Setup("iso-8859-10", "North European (ISO-8859-10)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_iso_8859_10, 191, 1, (int32_t)&repl_map_iso_8859_10, 0, 1);
    UC_Charset_NoUctb_Setup("utf-8", "UNICODE (UTF-8)", 0, 128, 7, -4);
    UC_Charset_Setup("mnemonic+ascii+0", "RFC 1345 w/o Intro", "", dfont_unitable_mnemonic_ascii_0, 0, 1941, (int32_t)&repl_map_mnemonic_ascii_0, 0, 0);
    UC_Charset_Setup("mnemonic", "RFC 1345 Mnemonic", "", dfont_unitable_mnemonic, 0, 1851, (int32_t)&repl_map_mnemonic, 0, 0);
    UC_Charset_Setup("cp866u", "Ukrainian Cyrillic (cp866u)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_cp866u, 224, 0, 0, 0, 1);
    UC_Charset_Setup("koi8-u", "Ukrainian Cyrillic (KOI8-U)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_koi8_u, 224, 0, 0, 0, 1);
    UC_Charset_Setup("ptcp154", "Cyrillic-Asian (PT154)", "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01", dfont_unitable_ptcp154, 223, 0, 0, 0, 1);
    LATIN1 = UCGetLYhndl_byMIME("iso-8859-1");
    US_ASCII = UCGetLYhndl_byMIME("us-ascii");
    UTF8_handle = UCGetLYhndl_byMIME("utf-8");
    TRANSPARENT = UCGetLYhndl_byMIME("x-transparent");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f7ce9 - 0x80f7d32
// Line range:    2215 - 2224
int32_t safeUCGetLYhndl_byMIME(char * value) {
    int32_t result = UCGetLYhndl_byMIME(value); // 0x80f7cf5
    if (result != -1) {
        // 0x80f7d2d
        return result;
    }
    // 0x80f7d03
    if (WWW_TraceFlag != 0) {
        // 0x80f7d16
        fprintf(TraceFP(), "safeUCGetLYhndl_byMIME: ISO-8859-1 assumed.\n");
    }
    // 0x80f7d2d
    return LATIN1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCdomap.c
// Address range: 0x80f7d32 - 0x80f7e44
// Line range:    2386 - 2410
void LYFindLocaleCharset(void) {
    // 0x80f7d32
    if (WWW_TraceFlag != 0) {
        // 0x80f7d48
        fprintf(TraceFP(), "LYFindLocaleCharset(%d)\n", (int32_t)LYLocaleCharset);
    }
    char * v1 = nl_langinfo(14); // 0x80f7d74
    if (v1 == NULL) {
        // 0x80f7e01
        if (WWW_TraceFlag != 0) {
            // 0x80f7e0c
            fprintf(TraceFP(), "Cannot find a MIME name for locale\n");
        }
        // 0x80f7e3e
        return;
    }
    int32_t v2 = UCGetLYhndl_byMIME(v1); // 0x80f7d88
    if (v2 < 0) {
        // 0x80f7dd6
        if (WWW_TraceFlag != 0) {
            // 0x80f7de1
            fprintf(TraceFP(), "Cannot find a handle for MIME name \"%s\"\n", v1);
        }
        // 0x80f7e3e
        return;
    }
    // 0x80f7d96
    linedrawing_char_set = v2;
    if (WWW_TraceFlag != 0) {
        // 0x80f7dad
        fprintf(TraceFP(), "Found name \"%s\" -> %d\n", v1, v2);
    }
    // 0x80f7e23
    if (LYLocaleCharset != 0) {
        // 0x80f7e34
        current_char_set = linedrawing_char_set;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCAux.c
// Address range: 0x80f7e44 - 0x80f7e86
// Line range:    16 - 28
char UCCanUniTranslateFrom(int32_t from) {
    char result = 0; // 0x80f7e4e
    if (from >= 0) {
        int32_t str = *(int32_t *)(32 * from + (int32_t)&g143); // 0x80f7e5c
        result = strcmp((char *)str, "x-transparent") != 0;
    }
    // 0x80f7e80
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCAux.c
// Address range: 0x80f7e86 - 0x80f7ea2
// Line range:    31 - 40
char UCCanTranslateUniTo(int32_t to) {
    // 0x80f7e86
    return (bool)(to >= 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCAux.c
// Address range: 0x80f7ea2 - 0x80f8028
// Line range:    44 - 87
char UCCanTranslateFromTo(int32_t from, int32_t to) {
    // 0x80f7ea2
    if (from == to) {
        // 0x80f8022
        return 1;
    }
    // 0x80f7eb9
    if (from > -1 != to >= 0) {
        // 0x80f8022
        return 0;
    }
    // 0x80f7ece
    if (LATIN1 == from) {
        // 0x80f8022
        return UCCanTranslateUniTo(to);
    }
    if (LATIN1 == to) {
        // 0x80f8022
        return UCCanUniTranslateFrom(from);
    }
    int32_t v1 = 32 * to; // 0x80f7ef8
    int32_t * v2 = (int32_t *)(v1 + (int32_t)&g144); // 0x80f7efb
    if (*v2 == 7) {
        // 0x80f8022
        return UCCanUniTranslateFrom(from);
    }
    int32_t v3 = 32 * from; // 0x80f7f1c
    char * str = (char *)*(int32_t *)(v3 + (int32_t)&g143); // 0x80f7f45
    if (strcmp(str, "x-transparent") == 0) {
        // 0x80f8022
        return 1;
    }
    char * str2 = (char *)*(int32_t *)(v1 + (int32_t)&g143); // 0x80f7f5c
    if (strcmp(str2, "x-transparent") == 0 || strcmp(str, "us-ascii") == 0 || *(int32_t *)(v3 + (int32_t)&g144) != 5) {
        // 0x80f8022
        return 1;
    }
    // 0x80f7f9f
    if (*v2 != 5) {
        // 0x80f8022
        return 0;
    }
    // 0x80f7fb6
    if (strcmp(str2, "euc-jp") != 0) {
        // 0x80f7fcd
        if (strcmp(str2, "shift_jis") != 0) {
            // 0x80f8022
            return 0;
        }
    }
    // 0x80f7fe4
    if (strcmp(str, "euc-jp") == 0 || strcmp(str, "shift_jis") == 0) {
        // 0x80f8022
        return 1;
    }
    // 0x80f8022
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCAux.c
// Address range: 0x80f8028 - 0x80f81c6
// Line range:    95 - 138
char UCNeedNotTranslate(int32_t from, int32_t to) {
    // 0x80f8028
    if (from == to) {
        // 0x80f81c0
        return 1;
    }
    // 0x80f803f
    if (from < 0) {
        // 0x80f81c0
        return 0;
    }
    int32_t v1 = 32 * from; // 0x80f8051
    int32_t * v2 = (int32_t *)(v1 + (int32_t)&g144); // 0x80f8054
    if (*v2 == 0) {
        // 0x80f81c0
        return 1;
    }
    char * str = (char *)*(int32_t *)(v1 + (int32_t)&g143); // 0x80f8073
    if (strcmp(str, "x-transparent") == 0 || strcmp(str, "us-ascii") == 0) {
        // 0x80f81c0
        return 1;
    }
    // 0x80f80ad
    if (to < 0) {
        // 0x80f81c0
        return 0;
    }
    // 0x80f80bc
    if (LATIN1 == to) {
        // 0x80f80c6
        if (*(int32_t *)((v1 | 16) + (int32_t)&g143) % 2 != 0) {
            // 0x80f81c0
            return 1;
        }
    }
    int32_t v3 = 32 * to; // 0x80f80ea
    int32_t str2 = *(int32_t *)(v3 + (int32_t)&g143); // 0x80f80ed
    if (strcmp((char *)str2, "x-transparent") == 0) {
        // 0x80f81c0
        return 1;
    }
    // 0x80f8116
    if (*(int32_t *)(v3 + (int32_t)&g144) == 7) {
        // 0x80f81c0
        return 0;
    }
    // 0x80f8130
    if (LATIN1 == from) {
        // 0x80f813a
        if ((*(int32_t *)((v1 | 16) + (int32_t)&g143) & 2) != 0) {
            // 0x80f81c0
            return 1;
        }
    }
    // 0x80f8158
    if (*v2 != 5 || HTCJK == 0) {
        // 0x80f81c0
        return 0;
    }
    if (HTCJK != 1) {
        // 0x80f81c0
        return 0;
    }
    // 0x80f8182
    if (strcmp(str, "euc-jp") == 0 || strcmp(str, "shift_jis") == 0) {
        // 0x80f81c0
        return 1;
    }
    // 0x80f81c0
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCAux.c
// Address range: 0x80f81c6 - 0x80f853f
// Line range:    158 - 292
void UCSetTransParams(int32_t * pT, int32_t cs_in, int32_t * p_in, int32_t cs_out, int32_t * p_out) {
    int32_t v1 = (int32_t)p_out;
    int32_t v2 = (int32_t)p_in;
    int32_t * str; // 0x80f81c6
    if (WWW_TraceFlag == 0) {
        // 0x80f81c6
        str = (int32_t *)(v2 + 4);
    } else {
        int32_t * v3 = (int32_t *)(v1 + 4); // 0x80f81dd
        int32_t v4 = UCGetLYhndl_byMIME((char *)*v3); // 0x80f81e3
        int32_t v5 = *v3; // 0x80f81ed
        int32_t * v6 = (int32_t *)(v2 + 4);
        int32_t v7 = UCGetLYhndl_byMIME((char *)*v6); // 0x80f81fc
        int32_t v8 = *v6; // 0x80f8206
        fprintf(TraceFP(), "UCSetTransParams: from %s(%d) to %s(%d)\n", (char *)v8, v7, (char *)v5, v4);
        str = v6;
    }
    int32_t v9 = (int32_t)pT;
    char * v10 = (char *)(v9 + 9); // 0x80f8236
    *v10 = 0;
    char * v11; // 0x80f81c6
    char * v12; // 0x80f81c6
    char v13; // 0x80f81c6
    bool v14; // 0x80f81c6
    bool v15; // 0x80f81c6
    bool v16; // 0x80f81c6
    int32_t * v17; // 0x80f8354
    char * v18; // 0x80f8360
    if (strcmp((char *)*str, "x-transparent") == 0) {
        // 0x80f827e
        *(char *)pT = 1;
        goto lab_0x80f8291;
    } else {
        int32_t strcmp_rc = strcmp((char *)*(int32_t *)(v1 + 4), "x-transparent"); // 0x80f8265
        *(char *)pT = (char)(strcmp_rc == 0);
        if (strcmp_rc != 0) {
            int32_t * v19 = (int32_t *)(v2 + 8); // 0x80f8314
            char * v20 = (char *)(v9 + 1); // 0x80f833c
            *v20 = (char)(*v19 == 5 == (HTCJK != 0));
            char * v21 = (char *)(v9 + 2); // 0x80f834e
            *v21 = (char)(*v19 == 7);
            v17 = (int32_t *)(v1 + 8);
            v18 = (char *)(v9 + 3);
            *v18 = (char)(*v17 == 7);
            if (*v20 != 0) {
                // 0x80f836e
                *(char *)(v9 + 8) = 0;
                *(char *)(v9 + 7) = 0;
                *(char *)(v9 + 6) = 1;
                *(char *)(v9 + 4) = 0;
                *(char *)(v9 + 10) = 0;
                *(char *)(v9 + 11) = 0;
                // 0x80f8537
                return;
            }
            // 0x80f83a5
            v16 = true;
            if (LATIN1 == cs_in) {
                goto lab_0x80f8403;
            } else {
                // 0x80f83af
                v16 = true;
                if (*v21 != 0) {
                    goto lab_0x80f8403;
                } else {
                    // 0x80f83d7
                    v16 = true;
                    if ((*(int32_t *)(v2 + 20) & 5) != 0) {
                        goto lab_0x80f8403;
                    } else {
                        // 0x80f83e4
                        v16 = false;
                        if (UCCanUniTranslateFrom(cs_in) == 0) {
                            goto lab_0x80f8403;
                        } else {
                            char * v22 = (char *)(v9 + 8); // 0x80f840a
                            *v22 = 1;
                            v11 = v22;
                            v15 = false;
                            v12 = v22;
                            v14 = false;
                            v13 = 1;
                            if (*v19 != 3) {
                                goto lab_0x80f842c;
                            } else {
                                goto lab_0x80f8433;
                            }
                        }
                    }
                }
            }
        } else {
            goto lab_0x80f8291;
        }
    }
  lab_0x80f8291:
    // 0x80f8291
    *(char *)(v9 + 1) = 0;
    *(char *)(v9 + 2) = 0;
    *(char *)(v9 + 3) = 0;
    *(char *)(v9 + 7) = 1;
    *(char *)(v9 + 4) = 1;
    *(char *)(v9 + 5) = 0;
    *(char *)(v9 + 6) = 1;
    int32_t * v23 = (int32_t *)(v1 + 8); // 0x80f82c5
    *(char *)(v9 + 10) = (char)(*v23 == 3);
    char v24 = 1; // 0x80f82dd
    if (*(int32_t *)(v2 + 8) != 3) {
        // 0x80f82df
        v24 = *v23 == 3;
    }
    // 0x80f82fa
    *v10 = v24;
  lab_0x80f8403:;
    char * v25 = (char *)(v9 + 8); // 0x80f840a
    *v25 = 0;
    v11 = v25;
    v15 = v16;
    goto lab_0x80f842c;
  lab_0x80f842c:
    // 0x80f842c
    v12 = v11;
    v14 = v15;
    v13 = 0;
    goto lab_0x80f8433;
  lab_0x80f8433:
    // 0x80f8433
    *v10 = v13;
    *(char *)(v9 + 10) = (char)(*v17 == 3);
    *(char *)(v9 + 5) = 0;
    char * v26; // 0x80f81c6
    char * v27; // 0x80f81c6
    char v28; // 0x80f81c6
    bool v29; // 0x80f81c6
    bool v30; // 0x80f81c6
    if (v14) {
        char * v31 = (char *)(v9 + 7); // 0x80f8488
        *v31 = 0;
        v26 = v31;
        v30 = false;
        goto lab_0x80f84a9;
    } else {
        char v32 = *v12; // 0x80f845f
        char * v33 = (char *)(v9 + 7); // 0x80f8488
        *v33 = (char)(v32 == 0);
        v26 = v33;
        v30 = false;
        if (v32 != 0) {
            goto lab_0x80f84a9;
        } else {
            // 0x80f8491
            v26 = v33;
            v30 = true;
            v27 = v33;
            v29 = true;
            v28 = 1;
            if ((char)*(int32_t *)(v2 + 28) <= -1) {
                goto lab_0x80f84a9;
            } else {
                goto lab_0x80f84b0;
            }
        }
    }
  lab_0x80f84a9:
    // 0x80f84a9
    v27 = v26;
    v29 = v30;
    v28 = 0;
    goto lab_0x80f84b0;
  lab_0x80f84b0:
    // 0x80f84b0
    *(char *)(v9 + 6) = v28;
    char v34; // 0x80f81c6
    if (cs_in == cs_out == *v18 == 0) {
        // 0x80f84cd
        v34 = 1;
        if (*v10 != 0) {
            // 0x80f84e1
            v34 = 0;
            goto lab_0x80f84e8;
        } else {
            goto lab_0x80f84e8;
        }
    } else {
        // 0x80f84e1
        v34 = 0;
        goto lab_0x80f84e8;
    }
  lab_0x80f84e8:
    // 0x80f84e8
    *(char *)(v9 + 4) = v34;
    if (!v29) {
        // 0x80f84f8
        if ((*v27 || v34) == 0) {
            // 0x80f850e
            if (UCCanTranslateUniTo(cs_out) != 0) {
                // 0x80f852d
                *(char *)(v9 + 11) = 1;
                // 0x80f8537
                return;
            }
        }
    }
    // 0x80f852d
    *(char *)(v9 + 11) = 0;
    // 0x80f8537
    return;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCAux.c
// Address range: 0x80f853f - 0x80f8597
// Line range:    300 - 313
void UCTransParams_clear(int32_t * pT) {
    int32_t v1 = (int32_t)pT;
    *(char *)pT = 0;
    *(char *)(v1 + 1) = 0;
    *(char *)(v1 + 2) = 0;
    *(char *)(v1 + 3) = 0;
    *(char *)(v1 + 7) = 0;
    *(char *)(v1 + 4) = 0;
    *(char *)(v1 + 5) = 0;
    *(char *)(v1 + 6) = 0;
    *(char *)(v1 + 8) = 0;
    *(char *)(v1 + 9) = 0;
    *(char *)(v1 + 10) = 0;
    *(char *)(v1 + 11) = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCAux.c
// Address range: 0x80f8597 - 0x80f85d3
// Line range:    331 - 437
void UCSetBoxChars(int32_t cset, int32_t * pvert_out, int32_t * phori_out, int32_t vert_in, int32_t hori_in) {
    // 0x80f8597
    *(int32_t *)cset = (int32_t)phori_out;
    *pvert_out = vert_in;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./UCAux.c
// Address range: 0x80f8aa6 - 0x80f8dbb
// Line range:    555 - 616
int32_t UCGetUniFromUtf8String(char ** ppuni) {
    char * v1 = *ppuni;
    unsigned char result = *v1;
    if (result >= 0) {
        // 0x80f8db6
        return result;
    }
    // 0x80f8ada
    if ((result & 64) == 0) {
        // 0x80f8db6
        return -1;
    }
    int32_t v2 = 1; // 0x80f8b0b
    if ((result & -32) != -64) {
        // 0x80f8b19
        v2 = 2;
        if ((result & -16) != -32) {
            // 0x80f8b37
            v2 = 3;
            if ((result & -8) != -16) {
                // 0x80f8b55
                v2 = 4;
                if ((result & -4) != -8) {
                    // 0x80f8b73
                    v2 = 5;
                    if ((result & -2) != -4) {
                        // 0x80f8db6
                        return -1;
                    }
                }
            }
        }
    }
    int32_t v3 = (int32_t)v1;
    int32_t v4 = 0; // 0x80f8bd3
    int32_t v5 = v3; // 0x80f8bae
    v5++;
    int32_t result2 = -1; // 0x80f8bc5
    int32_t v6; // 0x80f8aa6
    while ((*(char *)v5 & -64) == -128) {
        // 0x80f8bd3
        v4++;
        if (v2 <= v4) {
            // 0x80f8bdf
            g378 = v2;
            v6 = 0;
            switch (v2) {
                case 1: {
                    unsigned char v7 = *(char *)(v3 + 1); // 0x80f8c16
                    v6 = 64 * (int32_t)(*v1 % 32) | (int32_t)(v7 % 64);
                    goto lab_0x80f8da3;
                }
                case 2: {
                    unsigned char v8 = *v1; // 0x80f8c2c
                    unsigned char v9 = *(char *)(v3 + 1); // 0x80f8c40
                    unsigned char v10 = *(char *)(v3 + 2); // 0x80f8c56
                    v6 = 64 * (64 * (int32_t)(v8 % 16) | (int32_t)(v9 % 64)) | (int32_t)(v10 % 64);
                    goto lab_0x80f8da3;
                }
                case 3: {
                    unsigned char v11 = *v1; // 0x80f8c6c
                    unsigned char v12 = *(char *)(v3 + 1); // 0x80f8c80
                    unsigned char v13 = *(char *)(v3 + 2); // 0x80f8c96
                    unsigned char v14 = *(char *)(v3 + 3); // 0x80f8cac
                    v6 = 64 * (64 * (64 * (int32_t)(v11 % 8) | (int32_t)(v12 % 64)) | (int32_t)(v13 % 64)) | (int32_t)(v14 % 64);
                    goto lab_0x80f8da3;
                }
                case 4: {
                    char v15 = *v1; // 0x80f8cc2
                    unsigned char v16 = *(char *)(v3 + 1); // 0x80f8cd4
                    unsigned char v17 = *(char *)(v3 + 2); // 0x80f8cea
                    unsigned char v18 = *(char *)(v3 + 3); // 0x80f8d00
                    unsigned char v19 = *(char *)(v3 + 4); // 0x80f8d16
                    v6 = 64 * (64 * (64 * (64 * (int32_t)v15 & 192 | (int32_t)(v16 % 64)) | (int32_t)(v17 % 64)) | (int32_t)(v18 % 64)) | (int32_t)(v19 % 64);
                    goto lab_0x80f8da3;
                }
                case 5: {
                    char v20 = *v1; // 0x80f8d29
                    unsigned char v21 = *(char *)(v3 + 1); // 0x80f8d3d
                    unsigned char v22 = *(char *)(v3 + 2); // 0x80f8d53
                    unsigned char v23 = *(char *)(v3 + 3); // 0x80f8d69
                    unsigned char v24 = *(char *)(v3 + 4); // 0x80f8d7f
                    unsigned char v25 = *(char *)(v3 + 5); // 0x80f8d95
                    v6 = 64 * (64 * (64 * (64 * (int32_t)(v21 % 64 | 64 * v20 & 64) | (int32_t)(v22 % 64)) | (int32_t)(v23 % 64)) | (int32_t)(v24 % 64)) | (int32_t)(v25 % 64);
                    goto lab_0x80f8da3;
                }
                default: {
                    goto lab_0x80f8da3;
                }
            }
        }
        v5++;
        result2 = -1;
    }
    // 0x80f8db6
    return result2;
  lab_0x80f8da3:
    // 0x80f8da3
    *(int32_t *)ppuni = v2 + v3;
    result2 = v6;
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYExtern.c
// Address range: 0x80f8de8 - 0x80f8e34
// Line range:    160 - 164
void format(char ** result, char * fmt, char * parm) {
    // 0x80f8de8
    *(int32_t *)result = 0;
    HTAddParam(result, fmt, 1, parm);
    HTEndParam(result, fmt, 1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYExtern.c
// Address range: 0x80f8e34 - 0x80f8e5f
// Line range:    176 - 244
char * format_command(char * command, char * param) {
    char * result = NULL; // bp-8, 0x80f8e3a
    format(&result, command, param);
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYExtern.c
// Address range: 0x80f8e5f - 0x80f9180
// Line range:    253 - 323
char * lookup_external(char * param, char only_overriders) {
    int32_t v1 = 0; // 0x80f8fbe
    int32_t v2 = 0;
    int32_t v3 = 0;
    int32_t v4 = 0;
    int32_t v5; // 0x80f8e5f
    int32_t v6; // 0x80f8e5f
    int32_t v7; // 0x80f8e5f
    int32_t v8; // 0x80f8e5f
    int32_t v9; // 0x80f8e5f
    int32_t v10; // 0x80f8e5f
    int32_t v11; // 0x80f8e5f
    int32_t v12; // 0x80f8e5f
    int32_t v13; // 0x80f8e5f
    int32_t v14; // 0x80f8e5f
    int32_t v15; // 0x80f8e5f
    int32_t v16; // 0x80f8e5f
    int32_t v17; // 0x80f8e5f
    int32_t v18; // 0x80f8e5f
    int32_t v19; // 0x80f8e5f
    int32_t v20; // 0x80f8e5f
    int32_t v21; // 0x80f8e5f
    int32_t v22; // 0x80f8e5f
    int32_t v23; // 0x80f8e5f
    int32_t v24; // 0x80f8e5f
    int32_t v25; // 0x80f8e5f
    int32_t v26; // 0x80f8e5f
    int32_t v27; // 0x80f8e5f
    int32_t v28; // 0x80f8e5f
    char * v29; // 0x80f8e5f
    char * v30; // 0x80f8e5f
    int32_t v31; // 0x80f8ed8
    while (true) {
        int32_t v32 = v4;
        int32_t v33 = v3;
        v9 = v2;
        v28 = v1;
        v13 = v32;
        v8 = v33;
        v22 = 0;
        v26 = 0;
        v17 = 0;
        if (externals != NULL) {
            // 0x80f8eb6
            v29 = (char *)externals;
            v15 = 0;
            v25 = 0;
            v20 = 0;
            v6 = v33;
            v11 = v32;
            while (true) {
              lab_0x80f8eb6:
                // 0x80f8eb6
                v12 = v11;
                v7 = v6;
                v21 = v20;
                int32_t v34 = v25;
                v16 = v15;
                v30 = v29;
                v10 = v12;
                v5 = v7;
                v19 = v21;
                v24 = v34;
                v14 = v16;
                if (match_item_by_name((int32_t *)v30, param, only_overriders) == 0) {
                    goto lab_0x80f8f76;
                } else {
                    // 0x80f8ed8
                    if (WWW_TraceFlag != 0) {
                        int32_t v35 = *(int32_t *)((int32_t)v30 + 4); // 0x80f8eea
                        fprintf(TraceFP(), "EXTERNAL: '%s' <==> '%s'\n", (char *)v35, param);
                    }
                    // 0x80f8f11
                    v31 = v34 + 1;
                    if (no_externals == 0) {
                        goto lab_0x80f8f32;
                    } else {
                        int32_t v36 = *(int32_t *)((int32_t)v30 + 12); // 0x80f8f1f
                        if (only_overriders == 0 == v36 == 0) {
                            // 0x80f8f2c
                            v10 = v12;
                            v5 = v7;
                            v19 = v21 + 1;
                            v24 = v31;
                            v14 = v16;
                            goto lab_0x80f8f76;
                        } else {
                            goto lab_0x80f8f32;
                        }
                    }
                }
            }
        }
      lab_0x80f8f88:
        // 0x80f8f88
        v18 = v17;
        v27 = v26;
        v23 = v22;
        v3 = v8;
        v4 = v13;
        int32_t mem = v9; // 0x80f8f8c
        if (v4 >= 2) {
            if (v28 != 0) {
                // 0x80f8faf
                *(int32_t *)(4 * v18 + v9) = 0;
                mem = v9;
            } else {
                // 0x80f8f94
                mem = (int32_t)calloc(v4 + 1, 4);
            }
        }
        // 0x80f8fbe
        v2 = mem;
        v1 = v28 + 1;
        if (v1 == 2) {
            // break -> 0x80f8fcc
            break;
        }
    }
    if (v23 != 0 && v23 == v27) {
        // 0x80f8fda
        HTUserMsg(gettext("External support is currently disabled."));
        // 0x80f9177
        return (char *)v3;
    }
    // 0x80f8ff3
    if (v18 < 2) {
        // 0x80f9177
        return (char *)v3;
    }
    int32_t * v37 = LYwin;
    int32_t v38 = v37 == NULL ? -1 : 0x10000 * (int32_t)v37 >> 16;
    int32_t v39 = v37 == NULL ? -1 : (int32_t)*(int16_t *)&g255;
    int32_t v40 = LYhandlePopupList(-1, 0, v39, (char **)v2, -1, -1, 0, 1); // 0x80f9083
    function_804a914((int32_t)LYwin, v38, v39);
    if (WWW_TraceFlag != 0) {
        // 0x80f90b2
        fprintf(TraceFP(), "selected choice %d of %d\n", v40, v18);
    }
    int32_t v41 = v3; // 0x80f90dd
    if (v40 < 0) {
        // 0x80f90df
        HTInfoMsg(gettext("Cancelled!!!"));
        v41 = 0;
    }
    int32_t * v42 = (int32_t *)v2;
    int32_t v43 = *v42; // 0x80f9159
    int32_t v44 = 0; // 0x80f915d
    int32_t v45 = v41; // 0x80f915d
    if (v43 != 0) {
        int32_t v46 = v43; // 0x80f9109
        if (v44 != v40) {
            // 0x80f912a
            v46 = v41;
            free((int32_t *)v43);
            *v42 = 0;
        }
        // 0x80f914c
        v44++;
        int32_t * v47 = (int32_t *)(4 * v44 + v2); // 0x80f9159
        int32_t v48 = *v47; // 0x80f9159
        int32_t * v49 = v47; // 0x80f915d
        int32_t v50 = v46; // 0x80f915d
        v45 = v46;
        while (v48 != 0) {
            int32_t v51 = v48;
            v46 = v51;
            if (v44 != v40) {
                // 0x80f912a
                v46 = v50;
                free((int32_t *)v51);
                *v49 = 0;
            }
            // 0x80f914c
            v44++;
            v47 = (int32_t *)(4 * v44 + v2);
            v48 = *v47;
            v49 = v47;
            v50 = v46;
            v45 = v46;
        }
    }
    // 0x80f915f
    if (v2 != 0) {
        // 0x80f9165
        free(v42);
    }
    // 0x80f9177
    return (char *)v45;
  lab_0x80f8f76:;
    int32_t v52 = *(int32_t *)v30; // 0x80f8f79
    v29 = (char *)v52;
    v15 = v14;
    v25 = v24;
    v20 = v19;
    v6 = v5;
    v11 = v10;
    v13 = v10;
    v8 = v5;
    v22 = v19;
    v26 = v24;
    v17 = v14;
    if (v52 == 0) {
        // break -> 0x80f8f88
        goto lab_0x80f8f88;
    }
    goto lab_0x80f8eb6;
  lab_0x80f8f32:;
    int32_t v53; // 0x80f8e5f
    int32_t v54; // 0x80f8e5f
    if (v28 != 0) {
        int32_t v55 = *(int32_t *)((int32_t)v30 + 8); // 0x80f8f47
        int32_t v56 = (int32_t)format_command((char *)v55, param); // 0x80f8f54
        v54 = v12;
        v53 = v56;
        if (v12 >= 2) {
            // 0x80f8f62
            *(int32_t *)(4 * v16 + v9) = v56;
            v54 = v12;
            v53 = v56;
        }
    } else {
        // 0x80f8f38
        v54 = v12 + 1;
        v53 = v7;
    }
    // 0x80f8f72
    v10 = v54;
    v5 = v53;
    v19 = v21;
    v24 = v31;
    v14 = v16 + 1;
    goto lab_0x80f8f76;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYExtern.c
// Address range: 0x80f9180 - 0x80f9252
// Line range:    327 - 430
char run_external(char * param, char only_overriders) {
    // 0x80f9180
    if (externals == NULL) {
        // 0x80f924c
        return 0;
    }
    char * v1 = lookup_external(param, only_overriders); // 0x80f91c5
    if (v1 == NULL) {
        // 0x80f924c
        return 0;
    }
    char result = 0; // 0x80f91db
    if (*v1 != 0) {
        // 0x80f91dd
        HTUserMsg(v1);
        stop_curses();
        fflush((struct _IO_FILE *)g164);
        LYSystem(v1);
        fflush((struct _IO_FILE *)g164);
        start_curses();
        result = 1;
    }
    // 0x80f9233
    free((int32_t *)v1);
    // 0x80f924c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f9254 - 0x80f92b0
// Line range:    268 - 275
char cannot_stat(char * name) {
    int32_t v1 = 0; // bp-8, 0x80f925a
    char * v2 = gettext("Unable to get status of '%s'."); // 0x80f9268
    HTSprintf0((char **)&v1, v2);
    HTAlert((char *)v1);
    if (v1 != 0) {
        // 0x80f9297
        free((int32_t *)v1);
        v1 = 0;
    }
    // 0x80f92a9
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f92b0 - 0x80f9311
// Line range:    280 - 286
char ok_stat(char * name, int32_t * sb) {
    // 0x80f92b0
    if (WWW_TraceFlag != 0) {
        // 0x80f92c1
        fprintf(TraceFP(), "testing ok_stat(%s)\n", name);
    }
    char result = 1; // 0x80f92f5
    if (stat64((int32_t)name, sb) != 0) {
        // 0x80f92f7
        result = cannot_stat(name);
    }
    // 0x80f930b
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f9311 - 0x80f9370
// Line range:    290 - 296
char ok_lstat(char * name, int32_t * sb) {
    // 0x80f9311
    if (WWW_TraceFlag != 0) {
        // 0x80f9322
        fprintf(TraceFP(), "testing ok_lstat(%s)\n", name);
    }
    char result = 1; // 0x80f9354
    if (lstat64((int32_t)name, sb) < 0) {
        // 0x80f9356
        result = cannot_stat(name);
    }
    // 0x80f936a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f9370 - 0x80f93be
// Line range:    302 - 309
char ok_file_or_dir(int32_t * sb) {
    int32_t v1 = *(int32_t *)((int32_t)sb + 16); // 0x80f9379
    char result = 1; // 0x80f9370
    switch ((int16_t)v1 & -0x1000) {
        default: {
            // 0x80f939a
            HTAlert(gettext("The selected item is not a file or a directory!  Request ignored."));
            result = 0;
        }
        case 0x4000: {
        }
        case -0x8000: {
            // 0x80f93b8
            return result;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f93be - 0x80f95bb
// Line range:    335 - 429
int32_t LYExecv(char * path, char ** argv, char * msg) {
    char * exec_argv[1]; // 0x80f94c0
    int32_t rc = 0; // bp-20, 0x80f93cc
    if (WWW_TraceFlag != 0) {
        // 0x80f93e9
        fprintf(TraceFP(), "LYExecv path='%s'\n", path);
        char * v1 = *argv;
        if (v1 != NULL) {
            int32_t v2 = 0;
            if (WWW_TraceFlag != 0) {
                // 0x80f941b
                fprintf(TraceFP(), "argv[%d] = '%s'\n", v2, (char *)(int32_t)v1);
            }
            int32_t v3 = v2 + 1; // 0x80f944a
            int32_t v4 = *(int32_t *)(4 * v3 + (int32_t)argv); // 0x80f9457
            int32_t v5 = v4; // 0x80f945b
            while (v4 != 0) {
                // 0x80f9410
                v2 = v3;
                if (WWW_TraceFlag != 0) {
                    // 0x80f941b
                    fprintf(TraceFP(), "argv[%d] = '%s'\n", v2, (char *)v5);
                }
                // 0x80f944a
                v3 = v2 + 1;
                v4 = *(int32_t *)(4 * v3 + (int32_t)argv);
                v5 = v4;
            }
        }
    }
    // 0x80f945d
    stop_curses();
    int32_t pid = fork(); // 0x80f9469
    uint32_t v6; // 0x80f93be
    char * v7; // 0x80f954f
    switch (pid) {
        case -1: {
            char * v8 = gettext("Unable to %s due to system error!"); // 0x80f948c
            HTSprintf0((char **)&rc, v8);
            goto lab_0x80f9577;
        }
        case 0: {
            // 0x80f94b3
            exec_argv[0] = (char *)argv;
            execv(path, exec_argv);
            LYexit(1);
            // UNREACHABLE
        }
        default: {
            char * tmpbuf; // bp-28, 0x80f93be
            while (waitpid(pid, (int32_t *)&tmpbuf, 0) == -1) {
                // 0x80f94d3
                if (*__errno_location() != 4) {
                    // break -> 0x80f94fe
                    break;
                }
            }
            // 0x80f94fe
            v6 = (int32_t)tmpbuf;
            if (v6 % 128 != 0) {
                goto lab_0x80f9523;
            } else {
                if ((v6 & 0xff00) != 0) {
                    // 0x80f9548
                    v7 = gettext("Probable failure to %s due to system error!");
                    HTSprintf0((char **)&rc, v7);
                    goto lab_0x80f9577;
                } else {
                    goto lab_0x80f9523;
                }
            }
        }
    }
  lab_0x80f9523:;
    char v9 = (char)v6 % 128 + 1; // 0x80f9532
    bool v10 = true; // 0x80f9536
    int32_t result = 1; // 0x80f9536
    if (v6 % 128 == 0 || v9 < 2 || v9 < 0) {
        goto lab_0x80f957c;
    } else {
        // 0x80f9548
        v7 = gettext("Probable failure to %s due to system error!");
        HTSprintf0((char **)&rc, v7);
        goto lab_0x80f9577;
    }
  lab_0x80f9577:
    // 0x80f9577
    LYSleepAlert();
    v10 = false;
    result = 0;
    goto lab_0x80f957c;
  lab_0x80f957c:
    // 0x80f957c
    start_curses();
    int32_t v11 = rc;
    if (v11 == 0) {
        // 0x80f95b2
        return result;
    }
    // 0x80f9588
    if (v10) {
        // 0x80f95a0
        free((int32_t *)v11);
        rc = 0;
        // 0x80f95b2
        return result;
    }
    // 0x80f9599
    HTAlert((char *)v11);
    if (rc == 0) {
        // 0x80f95b2
        return result;
    }
    // 0x80f95a0
    free((int32_t *)rc);
    rc = 0;
    // 0x80f95b2
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f95bb - 0x80f968f
// Line range:    432 - 454
int32_t make_directory(char * path) {
    char * v1 = HTGetProgramPath(9); // 0x80f95c8
    if (v1 == NULL) {
        // 0x80f968a
        return mkdir(path, 511) == 0 ? 1 : -1;
    }
    int32_t code = 0; // bp-16, 0x80f95da
    HTSprintf0((char **)&code, "make directory %s", path);
    char * v2 = "mkdir"; // bp-36, 0x80f95fb
    int32_t v3 = LYExecv(v1, &v2, (char *)code); // 0x80f9623
    if (code != 0) {
        // 0x80f9649
        free((int32_t *)code);
        code = 0;
    }
    // 0x80f968a
    return v3 >= 0 == (v3 != 0) ? 1 : -1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f968f - 0x80f9751
// Line range:    457 - 476
int32_t remove_file(char * path) {
    char * v1 = HTGetProgramPath(12); // 0x80f969c
    if (v1 == NULL) {
        // 0x80f974c
        return remove(path) == 0 ? 1 : -1;
    }
    int32_t code = 0; // bp-16, 0x80f96aa
    char * v2 = "rm"; // bp-36, 0x80f96b1
    char * v3 = gettext("remove %s"); // 0x80f96d3
    HTSprintf0((char **)&code, v3);
    int32_t result = LYExecv(v1, &v2, (char *)code); // 0x80f9704
    if (code != 0) {
        // 0x80f9713
        free((int32_t *)code);
        code = 0;
    }
    // 0x80f974c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f9751 - 0x80f980c
// Line range:    479 - 497
int32_t remove_directory(char * path) {
    char * v1 = HTGetProgramPath(13); // 0x80f975e
    if (v1 == NULL) {
        // 0x80f9807
        return rmdir(path) == 0 ? 1 : -1;
    }
    int32_t code = 0; // bp-16, 0x80f976c
    char * v2 = "rmdir"; // bp-36, 0x80f9773
    char * v3 = gettext("remove %s"); // 0x80f978e
    HTSprintf0((char **)&code, v3);
    int32_t result = LYExecv(v1, &v2, (char *)code); // 0x80f97bf
    if (code != 0) {
        // 0x80f97ce
        free((int32_t *)code);
        code = 0;
    }
    // 0x80f9807
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f980c - 0x80f98f4
// Line range:    500 - 525
int32_t touch_file(char * path) {
    char * v1 = HTGetProgramPath(18); // 0x80f9819
    int32_t result; // 0x80f980c
    if (v1 == NULL) {
        struct _IO_FILE * file = fopen64(path, "w"); // 0x80f98c6
        result = -1;
        if (file != NULL) {
            // 0x80f98d4
            fclose(file);
            result = 1;
        }
    } else {
        int32_t code = 0; // bp-16, 0x80f982b
        char * v2 = gettext("touch %s"); // 0x80f9839
        HTSprintf0((char **)&code, v2);
        char * v3 = "touch"; // bp-40, 0x80f9856
        int32_t v4 = LYExecv(v1, &v3, (char *)code); // 0x80f987e
        int32_t v5 = v4 >= 0 == (v4 != 0) ? 1 : -1;
        result = v5;
        if (code != 0) {
            // 0x80f98a4
            free((int32_t *)code);
            code = 0;
            result = v5;
        }
    }
    // 0x80f98ef
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f98f4 - 0x80f9abb
// Line range:    528 - 564
int32_t move_file(char * source, char * target) {
    char * v1 = HTGetProgramPath(10); // 0x80f9904
    int32_t code = 0;
    char * v2; // bp-112, 0x80f98f4
    if (v1 != NULL) {
        char * v3 = gettext("move %s to %s"); // 0x80f9924
        HTSprintf0((char **)&code, v3);
        v2 = "mv";
        int32_t v4 = LYExecv(v1, &v2, (char *)code); // 0x80f9976
        if (code != 0) {
            // 0x80f99a0
            free((int32_t *)code);
            code = 0;
        }
        // 0x80f9ab6
        return v4 >= 0 == (v4 != 0) ? 1 : -1;
    }
    int32_t v5 = stat64((int32_t)target, (int32_t *)&v2); // 0x80f99cb
    char * file_path = target; // 0x80f99d2
    if (v5 == 0) {
        // 0x80f99d4
        file_path = target;
        int32_t v6; // 0x80f98f4
        if ((v6 & 0xf000) == 0x4000) {
            char * v7 = LYPathLeaf(source); // 0x80f99e9
            HTSprintf0((char **)&code, "%s/%s", target, v7);
            if (WWW_TraceFlag != 0) {
                // 0x80f9a17
                fprintf(TraceFP(), "move_file source=%s, target=%s\n", source, target);
            }
            // 0x80f9a3e
            file_path = (char *)code;
        }
    }
    int32_t remove_rc = 0; // 0x80f9a5d
    if (rename(source, file_path) != 0) {
        int32_t v8 = LYCopyFile(source, file_path); // 0x80f9a6c
        remove_rc = v8;
        if (v8 >= 0) {
            // 0x80f9a7a
            remove_rc = remove(source);
        }
    }
    int32_t v9 = remove_rc;
    int32_t v10 = code; // 0x80f9a95
    if (v10 != (int32_t)file_path && v10 != 0) {
        // 0x80f9aa4
        free((int32_t *)v10);
        code = 0;
    }
    // 0x80f9ab6
    return v9 != 0 ? v9 : 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f9abb - 0x80f9b5e
// Line range:    567 - 584
char not_already_exists(char * name) {
    // 0x80f9abb
    int32_t v1; // bp-100, 0x80f9abb
    if (stat64((int32_t)name, &v1) != 0) {
        int32_t v2 = *__errno_location(); // 0x80f9adc
        char result = 1; // 0x80f9ae1
        if (v2 != 2) {
            // 0x80f9ae3
            cannot_stat(name);
            result = 0;
        }
        // 0x80f9b58
        return result;
    }
    // 0x80f9af6
    int32_t v3; // 0x80f9abb
    int32_t v4 = v3 & 0xf000; // 0x80f9af9
    if (v4 == 0x4000) {
        // 0x80f9b05
        HTAlert(gettext("There is already a directory with that name!  Request ignored."));
        // 0x80f9b58
        return 0;
    }
    if (v4 != 0x8000) {
        // 0x80f9b40
        HTAlert(gettext("The specified name is already in use!  Request ignored."));
    } else {
        // 0x80f9b2a
        HTAlert(gettext("There is already a file with that name!  Request ignored."));
    }
    // 0x80f9b58
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f9b5e - 0x80f9bbb
// Line range:    587 - 598
char dir_has_same_owner(int32_t * info, int32_t owner) {
    int32_t v1 = (int32_t)info;
    if ((*(int32_t *)(v1 + 16) & 0xf000) != 0x4000) {
        // 0x80f9b9d
        HTAlert(gettext("Destination is not a valid directory!  Request denied."));
        // 0x80f9bb5
        return 0;
    }
    char result = 1; // 0x80f9b7f
    if (*(int32_t *)(v1 + 24) != owner) {
        // 0x80f9b87
        HTAlert(gettext("Destination has different owner!  Request denied."));
        result = 0;
    }
    // 0x80f9bb5
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f9bbb - 0x80f9d57
// Line range:    604 - 650
int32_t remove_tagged(void) {
    // 0x80f9bbb
    if (tagged == NULL || dir_list_order == 0) {
        // 0x80f9d4f
        return 0;
    }
    // 0x80f9bfa
    if (HTConfirm(gettext("Remove all tagged files and directories?")) != 1 || tagged == NULL) {
        // 0x80f9d41
        clear_tags();
        // 0x80f9d4f
        return 0;
    }
    int32_t v1 = *(int32_t *)((int32_t)tagged + 4); // 0x80f9cd5
    int32_t v2 = v1; // 0x80f9cdf
    char * v3 = NULL; // 0x80f9cdf
    if (v1 == 0) {
        // 0x80f9d41
        clear_tags();
        // 0x80f9d4f
        return 0;
    }
    int32_t v4 = 0;
    int32_t v5 = *(int32_t *)v2; // 0x80f9ce4
    int32_t v6 = v4; // 0x80f9d05
    int32_t v7; // 0x80f9bbb
    char * v8; // 0x80f9c52
    while (v5 != 0) {
        char * v9 = v3;
        char * v10 = (char *)v5; // 0x80f9c2b
        int32_t v11 = v4; // 0x80f9c36
        v3 = v9;
        if (is_url(v10) == 3) {
            // 0x80f9c3c
            v8 = HTnameOfFile_WWW(v10, 0, 1);
            LYTrimPathSep(v8);
            int32_t v12; // bp-128, 0x80f9bbb
            char v13 = ok_stat(v8, &v12); // 0x80f9c76
            v7 = v4;
            if (v13 == 0) {
                goto lab_0x80f9d0b;
            }
            int32_t v14 = remove_file(v8); // 0x80f9c8e
            if (v14 >= 0 != v14 != 0) {
                // 0x80f9c97
                v7 = v9 != NULL ? v4 : -1;
                goto lab_0x80f9d0b;
            }
            int32_t v15 = (int32_t)v9 + 1; // 0x80f9caa
            char * v16 = (char *)v15; // 0x80f9caa
            v11 = v15;
            v3 = v16;
            if (v8 != NULL) {
                // 0x80f9cb4
                free((int32_t *)v8);
                v11 = v15;
                v3 = v16;
            }
        }
        // 0x80f9cc6
        v2 += 4;
        v6 = v11;
        if (v2 == 0) {
            // break -> 0x80f9d41
            break;
        }
        v4 = v11;
        v5 = *(int32_t *)v2;
        v6 = v4;
    }
    // 0x80f9d41
    clear_tags();
    int32_t result = v6; // 0x80f9d41
    // 0x80f9d4f
    return result;
  lab_0x80f9d0b:
    // 0x80f9d0b
    result = v7;
    if (v8 == NULL) {
        return result;
    } else {
        // 0x80f9d11
        free((int32_t *)v8);
        result = v7;
        return result;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80f9d57 - 0x80fa429
// Line range:    660 - 810
int32_t modify_tagged(char * testpath) {
    char tmpbuf2[1024]; // bp-1036, 0x80f9d57
    char tmpbuf[1024]; // bp-1040, 0x80f9d57
    char v1[1024]; // 0x80f9e7a
    char v2[1024]; // 0x80f9eb2
    char v3[1024]; // 0x80f9ed6
    char v4[1024]; // 0x80f9e3b
    char v5[1024]; // 0x80f9f73
    char v6[1024]; // 0x80fa066
    char v7[1024]; // 0x80f9fb8
    char v8[1024]; // 0x80fa39d
    int32_t v9 = __readgsdword(20); // 0x80f9d69
    int32_t v10 = 0; // 0x80f9d8f
    char * v11; // 0x80f9d57
    int32_t * v12; // 0x80f9d57
    char * cp; // bp-1044, 0x80f9d57
    char v13; // bp-1032, 0x80f9d57
    if (tagged == NULL) {
        goto lab_0x80fa410;
    } else {
        // 0x80f9d91
        v10 = 0;
        if (dir_list_order != 0) {
            // 0x80f9dac
            mustshow = 1;
            statusline(gettext("Enter new location for tagged items: "));
            v13 = 0;
            LYgetstr(&v13, 0, 1024, 0);
            v10 = 0;
            if (v13 == 0) {
                goto lab_0x80fa410;
            } else {
                if (testpath == NULL) {
                    goto lab_0x80f9e43;
                } else {
                    // 0x80f9e0e
                    if (*testpath == 0) {
                        goto lab_0x80f9e43;
                    } else {
                        // 0x80f9e1b
                        if (strcmp(testpath, "/") == 0) {
                            goto lab_0x80f9e43;
                        } else {
                            // 0x80f9e8a
                            v4[0] = (int32_t)testpath;
                            tmpbuf2 = v4;
                            int32_t v14 = *(int32_t *)&tmpbuf2;
                            char * str = (char *)v14;
                            if (strncmp(str, "file://localhost", 16) != 0) {
                                char v15 = *str; // 0x80f9f82
                                if (v15 != 102 != v15 != 70) {
                                    // 0x80f9f96
                                    if (strncasecomp(str, "file:", 5) == 0) {
                                        // 0x80f9fb8
                                        v7[0] = (char)v14 + 5;
                                        tmpbuf2 = v7;
                                    }
                                }
                            } else {
                                // 0x80f9f73
                                v5[0] = (char)v14 + 16;
                                tmpbuf2 = v5;
                            }
                            char * v16 = HTURLPath_toFile((char *)*(int32_t *)&tmpbuf2, 1, 0); // 0x80f9fd8
                            cp = v16;
                            v11 = v16;
                            v12 = (int32_t *)&tmpbuf2;
                            goto lab_0x80f9fe3;
                        }
                    }
                }
            }
        } else {
            goto lab_0x80fa410;
        }
    }
  lab_0x80fa410:;
    int32_t result = v10; // 0x80fa420
    if (v9 != __readgsdword(20)) {
        // 0x80fa422
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80fa427
    return result;
  lab_0x80f9e43:;
    char v17 = 0; // 0x80f9e4a
    if (tagged != NULL && dir_list_order != 0) {
        // 0x80f9e58
        v17 = (char)*(int32_t *)dir_list_order;
    }
    // 0x80f9e8a
    v1[0] = v17;
    tmpbuf2 = v1;
    int32_t v18 = *(int32_t *)&tmpbuf2;
    if (v18 == 0) {
        char * v19 = HTURLPath_toFile(".", 1, 0); // 0x80f9f41
        cp = v19;
        v11 = v19;
        v12 = (int32_t *)&tmpbuf2;
    } else {
        char * v20 = strip_trailing_slash((char *)v18); // 0x80f9ead
        v2[0] = (int32_t)v20;
        tmpbuf2 = v2;
        char * v21 = HTParse(".", (char *)*(int32_t *)&tmpbuf2, 5); // 0x80f9ed1
        v3[0] = (int32_t)v21;
        tmpbuf2 = v3;
        int32_t v22 = *(int32_t *)&tmpbuf2;
        char * v23 = HTURLPath_toFile((char *)v22, 1, 0); // 0x80f9ef5
        cp = v23;
        v11 = v23;
        v12 = (int32_t *)&tmpbuf2;
        if (v22 != 0) {
            // 0x80f9f0d
            free((int32_t *)v22);
            tmpbuf2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
            v11 = cp;
            v12 = (int32_t *)&tmpbuf2;
        }
    }
    goto lab_0x80f9fe3;
  lab_0x80f9fe3:;
    // 0x80f9fe3
    int32_t v24; // bp-1172, 0x80f9d57
    if (ok_stat(v11, &v24) != 0) {
        // 0x80fa030
        char v25; // 0x80f9d57
        v6[0] = v25;
        tmpbuf = v6;
        if (v13 != 126) {
            goto lab_0x80fa184;
        } else {
            // 0x80fa07b
            char v26; // bp-1031, 0x80f9d57
            if (v26 != 47) {
                // 0x80fa184
                goto lab_0x80fa184;
            } else {
                int32_t count = 0; // bp-1060, 0x80fa08a
                char * v27 = Home_Dir(); // 0x80fa094
                HTSACopy((char **)&count, v27);
                HTSACat((char **)&count, &v26);
                if (strlen((char *)count) < 1024) {
                    // 0x80fa142
                    LYstrncpy(&v13, (char *)count, 1023);
                    if (count != 0) {
                        // 0x80fa16c
                        free((int32_t *)count);
                        count = 0;
                    }
                    // 0x80fa184
                    goto lab_0x80fa184;
                } else {
                    // 0x80fa0db
                    HTAlert(gettext("Path too long"));
                    if (cp != NULL) {
                        // 0x80fa0f9
                        free((int32_t *)cp);
                        cp = NULL;
                    }
                    // 0x80fa111
                    v10 = 0;
                    if (count != 0) {
                        // 0x80fa11b
                        free((int32_t *)count);
                        count = 0;
                        v10 = 0;
                    }
                    goto lab_0x80fa410;
                }
            }
        }
    } else {
        // 0x80f9fff
        v10 = 0;
        if (v11 != NULL) {
            // 0x80fa009
            free((int32_t *)v11);
            cp = NULL;
            v10 = 0;
        }
        goto lab_0x80fa410;
    }
  lab_0x80fa184:
    // 0x80fa184
    if (v13 == 47) {
        // 0x80fa1b7
        HTSACopy(&cp, &v13);
    } else {
        // 0x80fa18f
        LYAddPathSep(&cp);
        HTSACat(&cp, &v13);
    }
    // 0x80fa1cf
    int32_t v28; // 0x80f9d57
    char * v29; // 0x80f9d57
    char * v30; // 0x80f9d57
    if (ok_stat(cp, &v24) != 0) {
        // 0x80fa25c
        HTAlert(gettext("Source and destination are the same location - request ignored!"));
        v10 = 0;
        if (cp != NULL) {
            // 0x80fa27a
            free((int32_t *)cp);
            cp = NULL;
            v10 = 0;
        }
        goto lab_0x80fa410;
    } else {
        // 0x80fa1eb
        v10 = 0;
        if (cp != NULL) {
            // 0x80fa1f5
            free((int32_t *)cp);
            cp = NULL;
            v10 = 0;
        }
        goto lab_0x80fa410;
    }
  lab_0x80fa3d6:
    // 0x80fa3d6
    if (cp != NULL) {
        // 0x80fa3e0
        free((int32_t *)cp);
        cp = NULL;
    }
    // 0x80fa3f8
    v10 = (int32_t)v29;
    goto lab_0x80fa410;
  lab_0x80fa3b0:
    // 0x80fa3b0
    clear_tags();
    v29 = v30;
    if (v28 != 0) {
        // 0x80fa3be
        free((int32_t *)v28);
        v29 = v30;
    }
    goto lab_0x80fa3d6;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fa429 - 0x80fa67e
// Line range:    816 - 866
int32_t modify_name(char * testpath) {
    char tmpbuf2[512]; // bp-524, 0x80fa429
    char tmpbuf[512]; // bp-528, 0x80fa429
    char v1[512]; // 0x80fa4d2
    char v2[512]; // 0x80fa59b
    char v3[512]; // 0x80fa4ac
    int32_t v4 = __readgsdword(20); // 0x80fa43b
    tmpbuf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char * v5 = strip_trailing_slash(testpath); // 0x80fa463
    int32_t v6; // 0x80fa429
    int32_t v7; // bp-628, 0x80fa429
    if (ok_stat(v5, &v7) == 0) {
        // 0x80fa659
        v6 = (int32_t)NULL;
        goto lab_0x80fa665;
    } else {
        // 0x80fa48e
        int32_t v8; // 0x80fa429
        int32_t v9 = v8 & 0xf000; // 0x80fa494
        if (v9 != 0x4000) {
            if (v9 != 0x8000) {
                // 0x80fa4da
                v6 = ok_file_or_dir(&v7);
                goto lab_0x80fa665;
            } else {
                char * v10 = gettext("Enter new name for file: "); // 0x80fa4cd
                v1[0] = (int32_t)v10;
                goto lab_0x80fa4f6;
            }
        } else {
            char * v11 = gettext("Enter new name for directory: "); // 0x80fa4a7
            v3[0] = (int32_t)v11;
            v1 = v3;
            goto lab_0x80fa4f6;
        }
    }
  lab_0x80fa665:;
    int32_t result = v6; // 0x80fa675
    if (v4 != __readgsdword(20)) {
        // 0x80fa677
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80fa67c
    return result;
  lab_0x80fa4f6:
    // 0x80fa4f6
    tmpbuf2 = v1;
    char * v12 = LYPathLeaf(v5); // 0x80fa4ff
    int32_t v13; // bp-520, 0x80fa429
    LYstrncpy((char *)&v13, v12, 511);
    int32_t v14 = *(int32_t *)&tmpbuf2; // 0x80fa530
    char * v15 = get_filename((char *)v14, (char *)&v13, 512); // 0x80fa539
    v6 = 0;
    if (v15 != NULL) {
        // 0x80fa551
        char * v16; // 0x80fa429
        if (LYLastPathSep((char *)&v13) == NULL) {
            // 0x80fa57c
            v16 = NULL;
            if ((char)v13 != 0) {
                char * v17 = LYLastPathSep(v5); // 0x80fa596
                v2[0] = (int32_t)v17;
                tmpbuf2 = v2;
                int32_t v18 = *(int32_t *)&tmpbuf2; // 0x80fa5a1
                if (v18 == 0) {
                    // 0x80fa5ef
                    HTSACopy((char **)&tmpbuf, (char *)&v13);
                } else {
                    // 0x80fa5aa
                    HTSprintf0((char **)&tmpbuf, "%.*s%s", 1 - (int32_t)v5 + v18, v5, &v13);
                }
                char * v19 = NULL; // 0x80fa617
                if (not_already_exists((char *)*(int32_t *)&tmpbuf) != 0) {
                    int32_t v20 = *(int32_t *)&tmpbuf; // 0x80fa619
                    v19 = (char *)move_file(v5, (char *)v20);
                }
                int32_t v21 = *(int32_t *)&tmpbuf; // 0x80fa637
                v16 = v19;
                if (v21 != 0) {
                    // 0x80fa641
                    free((int32_t *)v21);
                    tmpbuf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                    v16 = v19;
                }
            }
        } else {
            // 0x80fa563
            HTAlert(gettext("Illegal character (path-separator) found! Request ignored."));
            v16 = NULL;
        }
        // 0x80fa659
        v6 = (int32_t)v16;
        goto lab_0x80fa665;
    } else {
        goto lab_0x80fa665;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fa67e - 0x80faaf2
// Line range:    872 - 961
int32_t modify_location(char * testpath) {
    char v1[1024]; // 0x80fa67e
    char tmpbuf[1024]; // bp-1036, 0x80fa67e
    char tmpbuf2[1024]; // bp-1040, 0x80fa67e
    char v2[1024]; // 0x80fa76f
    char v3[1024]; // 0x80fa726
    char v4[1024]; // 0x80fa8e8
    char v5[1024]; // 0x80fa8f7
    int32_t v6 = __readgsdword(20); // 0x80fa690
    char * sp = NULL; // bp-1048, 0x80fa69b
    int32_t owner = 0; // bp-1052, 0x80fa6a5
    char * v7 = strip_trailing_slash(testpath); // 0x80fa6c2
    int32_t v8; // bp-1172, 0x80fa67e
    char v9 = ok_stat(v7, &v8); // 0x80fa6e0
    int32_t v10 = 0; // 0x80fa6e7
    if (v9 != 0) {
        // 0x80fa6f8
        int32_t v11; // 0x80fa67e
        int32_t v12 = v11 & 0xf000; // 0x80fa6fe
        if (v12 != 0x4000) {
            if (v12 != 0x8000) {
                // 0x80fa777
                v10 = ok_file_or_dir(&v8);
                goto lab_0x80faad9;
            } else {
                char * v13 = gettext("Enter new location for file: "); // 0x80fa76a
                v2[0] = (int32_t)v13;
                v1 = v2;
                goto lab_0x80fa793;
            }
        } else {
            // 0x80fa70a
            if (HTGetProgramPath(10) == NULL) {
                // 0x80fa72e
                HTAlert(gettext("Could not access directory."));
                v10 = 0;
                goto lab_0x80faad9;
            } else {
                char * v14 = gettext("Enter new location for directory: "); // 0x80fa721
                v3[0] = (int32_t)v14;
                v1 = v3;
                goto lab_0x80fa793;
            }
        }
    } else {
        goto lab_0x80faad9;
    }
  lab_0x80faad9:;
    int32_t result = v10; // 0x80faae9
    if (v6 != __readgsdword(20)) {
        // 0x80faaeb
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80faaf0
    return result;
  lab_0x80fa793:
    // 0x80fa793
    tmpbuf = v1;
    int32_t v15; // bp-1032, 0x80fa67e
    LYstrncpy((char *)&v15, v7, 1023);
    *LYPathLeaf((char *)&v15) = 0;
    int32_t v16 = *(int32_t *)&tmpbuf; // 0x80fa7d6
    char * v17 = get_filename((char *)v16, (char *)&v15, 1024); // 0x80fa7df
    v10 = 0;
    char * v18; // 0x80fa67e
    if (v17 != NULL) {
        // 0x80fa7f7
        if ((char)v15 == 0) {
            // 0x80faacd
            v10 = (int32_t)NULL;
            goto lab_0x80faad9;
        } else {
            // 0x80fa808
            HTSACopy((char **)&owner, v7);
            HTSACopy(&sp, v7);
            if ((char)v15 == 126) {
                // 0x80fa843
                char v19; // bp-1031, 0x80fa67e
                char v20 = v19; // 0x80fa843
                if (v20 != 0 != v20 != 47) {
                    char * v21 = Home_Dir(); // 0x80fa859
                    HTSACopy(&sp, v21);
                    HTSACat(&sp, &v19);
                    LYstrncpy((char *)&v15, sp, 1023);
                }
            }
            // 0x80fa8ab
            if (LYisAbsPath((char *)&v15) == 0) {
                char * v22 = LYLastPathSep(sp); // 0x80fa8e3
                v4[0] = (int32_t)v22;
                tmpbuf2 = v4;
                int32_t v23 = *(int32_t *)&tmpbuf2; // 0x80fa8ee
                if (v23 == 0) {
                    // 0x80fa921
                    HTAlert(gettext("Unexpected failure - unable to find trailing path separator"));
                    if (sp != NULL) {
                        // 0x80fa93f
                        free((int32_t *)sp);
                        sp = NULL;
                    }
                    // 0x80fa957
                    v10 = 0;
                    if (owner != 0) {
                        // 0x80fa961
                        free((int32_t *)owner);
                        owner = 0;
                        v10 = 0;
                    }
                    goto lab_0x80faad9;
                } else {
                    // 0x80fa8f7
                    v5[0] = (char)v23 + 1;
                    tmpbuf2 = v5;
                    *(char *)*(int32_t *)&tmpbuf2 = 0;
                    HTSACat(&sp, (char *)&v15);
                    char * v24; // bp-1148, 0x80fa67e
                    v18 = v24;
                    goto lab_0x80fa988;
                }
            } else {
                // 0x80fa8bd
                HTSACopy(&sp, (char *)&v15);
                goto lab_0x80fa988;
            }
        }
    } else {
        goto lab_0x80faad9;
    }
  lab_0x80fa988:;
    char v25 = ok_stat(sp, &v8); // 0x80fa9d7
    char * v26 = NULL; // 0x80fa9de
    if (v25 != 0) {
        // 0x80faa2f
        HTAlert(gettext("Source and destination are the same location!  Request ignored!"));
        v26 = NULL;
    }
    // 0x80faa89
    if (sp != NULL) {
        // 0x80faa93
        free((int32_t *)sp);
        sp = NULL;
    }
    // 0x80faaab
    if (owner != 0) {
        // 0x80faab5
        free((int32_t *)owner);
        owner = 0;
    }
    // 0x80faacd
    v10 = (int32_t)v26;
    goto lab_0x80faad9;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80faaf2 - 0x80fadf9
// Line range:    967 - 1032
int32_t local_modify(int32_t * doc, char ** newpath) {
    char testpath2[512]; // bp-524, 0x80faaf2
    char testpath[512]; // bp-528, 0x80faaf2
    char v1[512]; // 0x80fab56
    char v2[512]; // 0x80fac3d
    char v3[512]; // 0x80fac92
    int32_t v4 = __readgsdword(20); // 0x80fab0d
    int32_t v5 = (int32_t)doc;
    int32_t v6; // 0x80faaf2
    if (tagged == NULL || dir_list_order == 0) {
        int32_t * v7 = (int32_t *)(v5 + 24); // 0x80fabf5
        int32_t v8 = *v7; // 0x80fabf5
        v6 = 0;
        if (v8 >= 0 && v8 <= nlinks) {
            // 0x80fac1d
            mustshow = 1;
            statusline(gettext("Modify name, location, or permission (n, l, or p): "));
            int32_t v9 = LYgetch_single(); // 0x80fac38
            v2[0] = v9;
            testpath2 = v2;
            int32_t c = *(int32_t *)&testpath2; // 0x80fac43
            v6 = 0;
            if (strchr("NLP", c) != NULL) {
                int32_t v10 = *(int32_t *)(68 * *v7 + (int32_t)&links); // 0x80fac74
                char * v11 = HTnameOfFile_WWW((char *)v10, 0, 1); // 0x80fac8d
                v3[0] = (int32_t)v11;
                testpath = v3;
                int32_t v12 = *(int32_t *)&testpath;
                char * str = (char *)v12; // 0x80fac9e
                if (strlen(str) < 512) {
                    // 0x80facdd
                    int32_t v13; // bp-520, 0x80faaf2
                    LYstrncpy((char *)&v13, str, 511);
                    if (v12 != 0) {
                        // 0x80fad06
                        free((int32_t *)v12);
                        testpath = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                    }
                    if (c != 78) {
                        if (c != 76) {
                            if (c != 80) {
                                // 0x80fadc2
                                HTAlert(gettext("This feature not yet implemented!"));
                                v6 = 0;
                            } else {
                                // 0x80fad9a
                                v6 = permit_location(NULL, (char *)&v13, newpath);
                            }
                        } else {
                            int32_t v14 = modify_location((char *)&v13); // 0x80fad52
                            v6 = 0;
                            if (v14 != 0) {
                                int32_t v15 = *v7; // 0x80fad61
                                v6 = 1;
                                if (v15 == nlinks - 1) {
                                    // 0x80fad70
                                    *v7 = v15 - 1;
                                    v6 = 1;
                                }
                            }
                        }
                    } else {
                        // 0x80fad27
                        v6 = modify_name((char *)&v13);
                    }
                } else {
                    // 0x80facad
                    v6 = 0;
                    if (v12 != 0) {
                        // 0x80facb6
                        free((int32_t *)v12);
                        testpath = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                        v6 = 0;
                    }
                }
            }
        }
    } else {
        char * v16 = HTnameOfFile_WWW((char *)*(int32_t *)(v5 + 4), 0, 0); // 0x80fab51
        v1[0] = (int32_t)v16;
        testpath = v1;
        int32_t v17 = *(int32_t *)&testpath;
        int32_t v18 = modify_tagged((char *)v17); // 0x80fab65
        if (v17 != 0) {
            // 0x80fab79
            free((int32_t *)v17);
            testpath = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        }
        int32_t * v19 = (int32_t *)(v5 + 24); // 0x80fab97
        int32_t v20 = *v19; // 0x80fab97
        int32_t v21 = nlinks + -1 - v18; // 0x80faba5
        int32_t v22 = v20; // 0x80fabaa
        if (v20 > v21) {
            // 0x80fabac
            *v19 = v21;
            v22 = v21;
        }
        int32_t v23 = v22; // 0x80fabc9
        *v19 = v23 & (int32_t)(v23 < 0) - 1;
        v6 = v18;
    }
    int32_t result = v6; // 0x80fadf0
    if (v4 != __readgsdword(20)) {
        // 0x80fadf2
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80fadf7
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fadf9 - 0x80fafa0
// Line range:    1042 - 1072
int32_t create_file(char * current_location) {
    char tmpbuf2[512]; // bp-524, 0x80fadf9
    char tmpbuf[512]; // bp-528, 0x80fadf9
    char v1[512]; // 0x80faf5f
    int32_t v2 = __readgsdword(20); // 0x80fae0b
    tmpbuf2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    tmpbuf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char str = 0; // bp-520, 0x80fae2a
    char * v3 = gettext("Enter name of file to create: "); // 0x80fae38
    if (get_filename(v3, &str, 512) != NULL) {
        // 0x80fae61
        if (strstr(&str, "//") == NULL) {
            // 0x80fae94
            if (str != 0) {
                // 0x80faea5
                if (strchr(no_dotfiles != 0 || show_dotfiles == 0 ? ".~/" : "~/", (int32_t)str) == NULL) {
                    // 0x80faf01
                    HTSACopy((char **)&tmpbuf, current_location);
                    LYAddPathSep((char **)&tmpbuf);
                    HTSACat((char **)&tmpbuf, &str);
                    if (not_already_exists((char *)*(int32_t *)&tmpbuf) != 0) {
                        int32_t v4 = touch_file((char *)*(int32_t *)&tmpbuf); // 0x80faf5a
                        v1[0] = v4;
                        tmpbuf2 = v1;
                    }
                    int32_t v5 = *(int32_t *)&tmpbuf; // 0x80faf65
                    if (v5 != 0) {
                        // 0x80faf6f
                        free((int32_t *)v5);
                        tmpbuf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                    }
                }
            }
        } else {
            // 0x80fae7b
            HTAlert(gettext("Illegal redirection \"//\" found! Request ignored."));
        }
    }
    int32_t result = *(int32_t *)&tmpbuf2; // 0x80faf97
    if (v2 != __readgsdword(20)) {
        // 0x80faf99
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80faf9e
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fafa0 - 0x80fb147
// Line range:    1078 - 1105
int32_t create_directory(char * current_location) {
    char tmpbuf[512]; // bp-524, 0x80fafa0
    char tmpbuf2[512]; // bp-528, 0x80fafa0
    char v1[512]; // 0x80fb106
    int32_t v2 = __readgsdword(20); // 0x80fafb2
    tmpbuf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    tmpbuf2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    char str = 0; // bp-520, 0x80fafd1
    char * v3 = gettext("Enter name for new directory: "); // 0x80fafdf
    if (get_filename(v3, &str, 512) != NULL) {
        // 0x80fb008
        if (strstr(&str, "//") == NULL) {
            // 0x80fb03b
            if (str != 0) {
                // 0x80fb04c
                if (strchr(no_dotfiles != 0 || show_dotfiles == 0 ? ".~/" : "~/", (int32_t)str) == NULL) {
                    // 0x80fb0a8
                    HTSACopy((char **)&tmpbuf2, current_location);
                    LYAddPathSep((char **)&tmpbuf2);
                    HTSACat((char **)&tmpbuf2, &str);
                    if (not_already_exists((char *)*(int32_t *)&tmpbuf2) != 0) {
                        int32_t v4 = make_directory((char *)*(int32_t *)&tmpbuf2); // 0x80fb101
                        v1[0] = v4;
                        tmpbuf = v1;
                    }
                    int32_t v5 = *(int32_t *)&tmpbuf2; // 0x80fb10c
                    if (v5 != 0) {
                        // 0x80fb116
                        free((int32_t *)v5);
                        tmpbuf2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                    }
                }
            }
        } else {
            // 0x80fb022
            HTAlert(gettext("Illegal redirection \"//\" found! Request ignored."));
        }
    }
    int32_t result = *(int32_t *)&tmpbuf; // 0x80fb13e
    if (v2 != __readgsdword(20)) {
        // 0x80fb140
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80fb145
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fb147 - 0x80fb290
// Line range:    1111 - 1134
int32_t local_create(int32_t * doc) {
    char testpath2[512]; // bp-524, 0x80fb147
    char testpath[512]; // bp-528, 0x80fb147
    char v1[512]; // 0x80fb229
    char v2[512]; // 0x80fb185
    int32_t v3 = __readgsdword(20); // 0x80fb159
    char * v4 = HTnameOfFile_WWW((char *)*(int32_t *)((int32_t)doc + 4), 0, 1); // 0x80fb180
    v2[0] = (int32_t)v4;
    testpath = v2;
    int32_t v5 = *(int32_t *)&testpath;
    char * str = (char *)v5; // 0x80fb191
    int32_t v6; // 0x80fb147
    if (strlen(str) < 512) {
        // 0x80fb1d0
        int32_t str2; // bp-520, 0x80fb147
        strcpy((char *)&str2, str);
        if (v5 != 0) {
            // 0x80fb1f1
            free((int32_t *)v5);
            testpath = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        }
        // 0x80fb209
        mustshow = 1;
        statusline(gettext("Create file or directory (f or d): "));
        int32_t v7 = LYgetch_single(); // 0x80fb224
        v1[0] = v7;
        testpath2 = v1;
        int32_t v8 = *(int32_t *)&testpath2; // 0x80fb22f
        if (v8 != 70) {
            // 0x80fb24e
            v6 = 0;
            if (v8 == 68) {
                // 0x80fb257
                v6 = create_directory((char *)&str2);
            }
        } else {
            // 0x80fb238
            v6 = create_file((char *)&str2);
        }
    } else {
        // 0x80fb1a0
        v6 = 0;
        if (v5 != 0) {
            // 0x80fb1a9
            free((int32_t *)v5);
            testpath = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
            v6 = 0;
        }
    }
    int32_t result = v6; // 0x80fb287
    if (v3 != __readgsdword(20)) {
        // 0x80fb289
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80fb28e
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fb290 - 0x80fb4a4
// Line range:    1140 - 1199
int32_t remove_single(char * testpath) {
    int32_t code = 0; // bp-20, 0x80fb2a0
    int32_t v1; // bp-116, 0x80fb290
    if (ok_lstat(testpath, &v1) == 0) {
        // 0x80fb49f
        return 0;
    }
    char * v2 = LYLastPathSep(testpath); // 0x80fb2d3
    int32_t str = v2 == NULL ? (int32_t)testpath : (int32_t)v2 + 1;
    int32_t v3; // 0x80fb290
    int32_t v4 = v3 & 0xf000; // 0x80fb2f0
    char v5; // 0x80fb290
    if (v4 != 0x4000) {
        if (v4 != 0x8000) {
            if (v4 != 0xa000) {
                // 0x80fb41a
                cannot_stat(testpath);
                if (code != 0) {
                    // 0x80fb42c
                    free((int32_t *)code);
                    code = 0;
                }
                // 0x80fb49f
                return 0;
            }
            // 0x80fb3c9
            if (strlen((char *)str) < 50) {
                char * v6 = gettext("Remove symbolic link '%s'?"); // 0x80fb3e0
                HTSprintf0((char **)&code, v6);
                v5 = 0;
            } else {
                char * v7 = gettext("Remove symbolic link?"); // 0x80fb404
                HTSprintf0((char **)&code, v7);
                v5 = 0;
            }
        } else {
            // 0x80fb363
            if (strlen((char *)str) < 60) {
                char * v8 = gettext("Remove file '%s'?"); // 0x80fb37a
                HTSprintf0((char **)&code, v8);
                v5 = 0;
            } else {
                char * v9 = gettext("Remove file?"); // 0x80fb3a1
                HTSprintf0((char **)&code, v9);
                v5 = 0;
            }
        }
    } else {
        // 0x80fb2fc
        if (strlen((char *)str) < 37) {
            char * v10 = gettext("Remove directory '%s'?"); // 0x80fb313
            HTSprintf0((char **)&code, v10);
            v5 = 1;
        } else {
            char * v11 = gettext("Remove directory?"); // 0x80fb337
            HTSprintf0((char **)&code, v11);
            v5 = 1;
        }
    }
    int32_t result = 0; // 0x80fb454
    if (HTConfirm((char *)code) == 1) {
        // 0x80fb456
        if (v5 == 0) {
            // 0x80fb46c
            result = remove_file(testpath);
        } else {
            // 0x80fb45c
            result = remove_directory(testpath);
        }
    }
    // 0x80fb480
    if (code != 0) {
        // 0x80fb487
        free((int32_t *)code);
        code = 0;
    }
    // 0x80fb49f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fb4a4 - 0x80fb6f3
// Line range:    1205 - 1240
int32_t local_remove(int32_t * doc) {
    char testpath[512]; // bp-524, 0x80fb4a4
    char testpath2[512]; // bp-528, 0x80fb4a4
    char v1[512]; // 0x80fb586
    char v2[512]; // 0x80fb5c1
    int32_t v3 = (int32_t)doc;
    int32_t v4 = __readgsdword(20); // 0x80fb4b6
    int32_t v5; // 0x80fb4a4
    if (tagged == NULL || dir_list_order == 0) {
        int32_t * v6 = (int32_t *)(v3 + 24); // 0x80fb545
        int32_t v7 = *v6; // 0x80fb545
        v5 = 0;
        if (v7 >= 0 && v7 <= nlinks) {
            // 0x80fb56d
            v1[0] = (char)*(int32_t *)(68 * v7 + (int32_t)&links);
            testpath = v1;
            char * v8 = (char *)*(int32_t *)&testpath;
            v5 = 0;
            if (is_url(v8) == 3) {
                char * v9 = HTnameOfFile_WWW(v8, 0, 1); // 0x80fb5bc
                v2[0] = (int32_t)v9;
                testpath2 = v2;
                int32_t v10 = *(int32_t *)&testpath2;
                char * str = (char *)v10; // 0x80fb5cd
                if (strlen(str) < 512) {
                    // 0x80fb60c
                    int32_t str2; // bp-520, 0x80fb4a4
                    strcpy((char *)&str2, str);
                    if (v10 != 0) {
                        // 0x80fb62d
                        free((int32_t *)v10);
                        testpath2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                    }
                    int32_t len = strlen((char *)&str2); // 0x80fb64e
                    if (len != 0) {
                        // 0x80fb662
                        int32_t v11; // bp-4, 0x80fb4a4
                        char * v12 = (char *)((int32_t)&v11 - 517 + len); // 0x80fb66b
                        if (*v12 == 47) {
                            // 0x80fb677
                            *v12 = 0;
                        }
                    }
                    int32_t v13 = remove_single((char *)&str2); // 0x80fb691
                    v5 = 0;
                    if (v13 != 0) {
                        int32_t v14 = *v6; // 0x80fb6a0
                        v5 = 1;
                        if (v14 == nlinks - 1) {
                            // 0x80fb6af
                            *v6 = v14 - 1;
                            v5 = 1;
                        }
                    }
                } else {
                    // 0x80fb5dc
                    v5 = 0;
                    if (v10 != 0) {
                        // 0x80fb5e5
                        free((int32_t *)v10);
                        testpath2 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                        v5 = 0;
                    }
                }
            }
        }
    } else {
        int32_t v15 = remove_tagged(); // 0x80fb4d6
        int32_t * v16 = (int32_t *)(v3 + 24); // 0x80fb4e7
        int32_t v17 = *v16; // 0x80fb4e7
        int32_t v18 = nlinks + -1 - v15; // 0x80fb4f5
        int32_t v19 = v17; // 0x80fb4fa
        if (v17 > v18) {
            // 0x80fb4fc
            *v16 = v18;
            v19 = v18;
        }
        int32_t v20 = v19; // 0x80fb519
        *v16 = v20 & (int32_t)(v20 < 0) - 1;
        v5 = v15;
    }
    int32_t result = v5; // 0x80fb6ea
    if (v4 != __readgsdword(20)) {
        // 0x80fb6ec
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80fb6f1
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fb6f3 - 0x80fb834
// Line range:    1247 - 1268
int32_t permit_bits(char * string_mode) {
    // 0x80fb6f3
    if (strcmp(string_mode, "IRUSR") == 0) {
        // 0x80fb82f
        return 256;
    }
    // 0x80fb71c
    if (strcmp(string_mode, "IWUSR") == 0) {
        // 0x80fb82f
        return 128;
    }
    // 0x80fb73f
    if (strcmp(string_mode, "IXUSR") == 0) {
        // 0x80fb82f
        return 64;
    }
    // 0x80fb762
    if (strcmp(string_mode, "IRGRP") == 0) {
        // 0x80fb82f
        return 32;
    }
    // 0x80fb785
    if (strcmp(string_mode, "IWGRP") == 0) {
        // 0x80fb82f
        return 16;
    }
    // 0x80fb7a8
    if (strcmp(string_mode, "IXGRP") == 0) {
        // 0x80fb82f
        return 8;
    }
    // 0x80fb7c8
    if (strcmp(string_mode, "IROTH") == 0) {
        // 0x80fb82f
        return 4;
    }
    int32_t result = 2; // 0x80fb7fd
    if (strcmp(string_mode, "IWOTH") != 0) {
        // 0x80fb808
        result = strcmp(string_mode, "IXOTH") == 0;
    }
    // 0x80fb82f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fb834 - 0x80fc45c
// Line range:    1276 - 1522
int32_t permit_location(char * destpath, char * srcpath, char ** newpath) {
    // 0x80fb834
    int32_t v1; // 0x80fb834
    uint32_t v2 = v1;
    int32_t v3 = __readgsdword(20); // 0x80fb858
    char v4; // 0x80fb834
    char * v5; // 0x80fb834
    int32_t v6; // 0x80fb834
    int32_t v7; // 0x80fb834
    char * v8; // bp-280, 0x80fb834
    int32_t v9; // 0x80fb834
    int32_t v10; // 0x80fb834
    int32_t mode; // 0x80fb834
    int32_t v11; // bp-432, 0x80fb834
    int32_t v12; // 0x80fb834
    char * path; // 0x80fc170
    if (srcpath == NULL) {
        // 0x80fbeea
        if (LYValidPermitFile[0] != 0) {
            int32_t v13 = (int32_t)destpath; // 0x80fb834
            char * v14 = (char *)v13;
            v8 = v14;
            char v15 = *v14; // 0x80fbfc1
            int32_t v16 = v13 + 1;
            v13 = v16;
            while (v15 != 0 == (v15 != 63)) {
                // 0x80fbfbb
                v14 = (char *)v13;
                v8 = v14;
                v15 = *v14;
                v16 = v13 + 1;
                v13 = v16;
            }
            // 0x80fbfd5
            v12 = 0;
            if (v15 != 0) {
                // 0x80fbff1
                *v14 = 0;
                char * v17 = (char *)v16; // 0x80fbffa
                v8 = v17;
                char * str = HTURLPath_toFile(destpath, 1, 0); // 0x80fc01a
                v12 = 0;
                if (str != NULL) {
                    // 0x80fc03d
                    if (strlen(str) < 256) {
                        // 0x80fc0bb
                        int32_t str2; // bp-274, 0x80fb834
                        strcpy((char *)&str2, str);
                        free((int32_t *)str);
                        if (strcmp((char *)&str2, LYValidPermitFile) == 0) {
                            // 0x80fc167
                            path = strip_trailing_slash((char *)&str2);
                            char v18 = ok_stat(path, &v11); // 0x80fc18e
                            v12 = 0;
                            if (v18 == 0) {
                                goto lab_0x80fc443;
                            } else {
                                char v19 = ok_file_or_dir(&v11); // 0x80fc1a0
                                v12 = 0;
                                if (v19 != 0) {
                                    char v20 = *v17; // 0x80fc2ee
                                    mode = 0;
                                    if (v20 != 0) {
                                        // 0x80fc1bc
                                        v4 = v20;
                                        v5 = v17;
                                        v6 = v16;
                                        v10 = 0;
                                        while (true) {
                                          lab_0x80fc1bc:;
                                            int32_t v21 = v10;
                                            char v22 = v4; // 0x80fc1d7
                                            char * v23 = (char *)v6;
                                            char * v24 = v23; // 0x80fc1dc
                                            int32_t v25 = v6; // 0x80fc1dc
                                            char * v26 = v23; // 0x80fc1dc
                                            char v27 = v22; // 0x80fc1dc
                                            if (v22 != 0 == (v22 != 38)) {
                                                int32_t v28 = (int32_t)v24 + 1; // 0x80fc1ca
                                                char * v29 = (char *)v28;
                                                char v30 = *v29; // 0x80fc1d7
                                                v25 = v28;
                                                v26 = v29;
                                                v27 = v30;
                                                while (v30 != 0 == (v30 != 38)) {
                                                    // 0x80fc1ca
                                                    v28 = (int32_t)v29 + 1;
                                                    v29 = (char *)v28;
                                                    v30 = *v29;
                                                    v25 = v28;
                                                    v26 = v29;
                                                    v27 = v30;
                                                }
                                            }
                                            // 0x80fc1eb
                                            v7 = v25;
                                            char * str3 = v5; // 0x80fc1f6
                                            if (v27 != 0) {
                                                // 0x80fc1f8
                                                *v26 = 0;
                                                v7 = (int32_t)v26 + 1;
                                                str3 = v8;
                                            }
                                            // 0x80fc208
                                            if (strncmp(str3, "mode=", 5) != 0) {
                                                // break -> 0x80fc2c5
                                                break;
                                            }
                                            char * str4 = (char *)((int32_t)str3 + 5);
                                            int32_t v31 = permit_bits(str4); // 0x80fc23a
                                            if (v31 == 0) {
                                                // 0x80fc2a2
                                                HTAlert(gettext("Invalid mode format."));
                                                v12 = 0;
                                                goto lab_0x80fc443;
                                            }
                                            // 0x80fc24e
                                            if (no_change_exec_perms == 0) {
                                                // 0x80fc288
                                                v9 = v31 | v21;
                                                goto lab_0x80fc294;
                                            } else {
                                                // 0x80fc259
                                                v9 = v21;
                                                if ((v2 & 0xf000) == 0x4000 | strchr(str4, 88) == NULL) {
                                                    // 0x80fc288
                                                    v9 = v31 | v21;
                                                    goto lab_0x80fc294;
                                                } else {
                                                    goto lab_0x80fc294;
                                                }
                                            }
                                        }
                                        // 0x80fc2c5
                                        HTAlert(gettext("Invalid syntax format."));
                                        v12 = 0;
                                        goto lab_0x80fc443;
                                    } else {
                                        goto lab_0x80fc2f9;
                                    }
                                } else {
                                    goto lab_0x80fc443;
                                }
                            }
                        } else {
                            char * v32 = gettext("Special URL only valid from current File Permission menu!");
                            if (LYCursesON == 0) {
                                // 0x80fc106
                                fprintf((struct _IO_FILE *)g160, "%s\n", v32);
                            } else {
                                // 0x80fc0f0
                                HTAlert(v32);
                            }
                            // 0x80fc12c
                            v12 = 0;
                            if (WWW_TraceFlag != 0) {
                                // 0x80fc137
                                fprintf(TraceFP(), "permit_location: called for file '%s'.\n", &str2);
                                v12 = 0;
                            }
                            goto lab_0x80fc443;
                        }
                    } else {
                        // 0x80fc05b
                        free((int32_t *)str);
                        v12 = 0;
                        goto lab_0x80fc443;
                    }
                } else {
                    goto lab_0x80fc443;
                }
            } else {
                goto lab_0x80fc443;
            }
        } else {
            char * v33 = gettext("Special URL only valid from current File Permission menu!");
            if (LYCursesON == 0) {
                // 0x80fbf24
                fprintf((struct _IO_FILE *)g160, "%s\n", v33);
            } else {
                // 0x80fbf0e
                HTAlert(v33);
            }
            // 0x80fbf4a
            v12 = 0;
            if (WWW_TraceFlag != 0) {
                char ** v34 = destpath == NULL ? (char **)"NULL URL pointer" : (char **)destpath;
                fprintf(TraceFP(), "permit_location: called for <%s>.\n", v34);
                v12 = 0;
            }
            goto lab_0x80fc443;
        }
    } else {
        char * v35 = strip_trailing_slash(srcpath); // 0x80fb879
        char v36 = ok_lstat(v35, &v11); // 0x80fb897
        v12 = 0;
        if (v36 != 0) {
            char v37 = ok_file_or_dir(&v11); // 0x80fb8a9
            v12 = 0;
            if (v37 != 0) {
                char * v38 = LYPathLeaf(v35); // 0x80fb8ca
                LYRemoveTemp((char *)&g153);
                struct _IO_FILE * stream = LYOpenTemp((char *)&g153, ".html", "w"); // 0x80fb8f8
                if (stream != NULL) {
                    // 0x80fb92f
                    LYLocalFileToURL(newpath, (char *)&g153);
                    LYRegisterUIPage(*newpath, 9);
                    char * v39 = HTAA_GidToName(v1); // 0x80fb966
                    LYstrncpy(LYValidPermitFile, v35, 255);
                    fprintf(stream, "<Html><Head>\n<Title>%s</Title>\n</Head>\n<Body>\n", gettext("File Permission Options"));
                    fprintf(stream, "<H1>%s%s</H1>\n", gettext("Permissions for "), v38);
                    char * v40 = HTEscape(v35, 4); // 0x80fb9f8
                    fprintf(stream, "<Form Action=\"%s//PERMIT_LOCATION%s\">\n", "LYNXDIRED:", v40);
                    if (v40 != NULL) {
                        // 0x80fba34
                        free((int32_t *)v40);
                    }
                    // 0x80fba4c
                    fprintf(stream, "<Ol><Li>%s<Br><Br>\n", gettext("Specify permissions below:"));
                    fprintf(stream, "%s:<Br>\n", gettext("Owner:"));
                    char * v41 = (v2 & 256) == 0 ? (char *)&g68 : "checked";
                    fprintf(stream, "<Input Type=\"checkbox\" Name=\"mode\" Value=\"IRUSR\" %s> Read<Br>\n", v41);
                    char * v42 = (char)v2 > -1 ? (char *)&g68 : "checked";
                    fprintf(stream, "<Input Type=\"checkbox\" Name=\"mode\" Value=\"IWUSR\" %s> Write<Br>\n", v42);
                    if ((v2 & 0xf000) != 0x4000 != no_change_exec_perms != 0) {
                        char * v43 = (v2 & 0xf000) != 0x4000 ? "Execute" : "Search";
                        char * v44 = (v2 & 64) == 0 ? (char *)&g68 : "checked";
                        fprintf(stream, "<Input Type=\"checkbox\" Name=\"mode\" Value=\"IXUSR\" %s> %s<Br>\n", v44, v43);
                    }
                    // 0x80fbbb4
                    fprintf(stream, "%s %s:<Br>\n", gettext("Group"), v39);
                    char * v45 = (v2 & 32) == 0 ? (char *)&g68 : "checked";
                    fprintf(stream, "<Input Type=\"checkbox\" Name=\"mode\" Value=\"IRGRP\" %s> Read<Br>\n", v45);
                    char * v46 = (v2 & 16) == 0 ? (char *)&g68 : "checked";
                    fprintf(stream, "<Input Type=\"checkbox\" Name=\"mode\" Value=\"IWGRP\" %s> Write<Br>\n", v46);
                    if ((v2 & 0xf000) != 0x4000 != no_change_exec_perms != 0) {
                        char * v47 = (v2 & 0xf000) != 0x4000 ? "Execute" : "Search";
                        char * v48 = (v2 & 8) == 0 ? (char *)&g68 : "checked";
                        fprintf(stream, "<Input Type=\"checkbox\" Name=\"mode\" Value=\"IXGRP\" %s> %s<Br>\n", v48, v47);
                    }
                    // 0x80fbcfe
                    fprintf(stream, "%s<Br>\n", gettext("Others:"));
                    char * v49 = (v2 & 4) == 0 ? (char *)&g68 : "checked";
                    fprintf(stream, "<Input Type=\"checkbox\" Name=\"mode\" Value=\"IROTH\" %s> Read<Br>\n", v49);
                    char * v50 = (v2 & 2) == 0 ? (char *)&g68 : "checked";
                    fprintf(stream, "<Input Type=\"checkbox\" Name=\"mode\" Value=\"IWOTH\" %s> Write<Br>\n", v50);
                    if ((v2 & 0xf000) != 0x4000 != no_change_exec_perms != 0) {
                        char * v51 = (v2 & 0xf000) != 0x4000 ? "Execute" : "Search";
                        char * v52 = v2 % 2 == 0 ? (char *)&g68 : "checked";
                        fprintf(stream, "<Input Type=\"checkbox\" Name=\"mode\" Value=\"IXOTH\" %s> %s<Br>\n", v52, v51);
                    }
                    char * v53 = (v2 & 0xf000) != 0x4000 ? "file" : "directory";
                    fprintf(stream, "<Br>\n<Li><Input Type=\"submit\" Value=\"Submit\">  %s %s %s.\n</Ol>\n</Form>\n", gettext("form to permit"), v53, v38);
                    fwrite((int32_t *)"</Body></Html>", 1, 14, stream);
                    LYCloseTempFP(stream);
                    LYforce_no_cache = 1;
                    v12 = -99;
                } else {
                    // 0x80fb90c
                    HTAlert(gettext("Unable to open permit options file"));
                    v12 = 0;
                }
            }
        }
        goto lab_0x80fc443;
    }
  lab_0x80fc2f9:;
    char * v54 = HTGetProgramPath(2); // 0x80fc300
    if (v54 == NULL) {
        // 0x80fc40a
        v12 = -1;
        if (chmod(path, mode) >= 0) {
            // 0x80fc432
            LYforce_no_cache = 1;
            v12 = 1;
            goto lab_0x80fc443;
        } else {
            goto lab_0x80fc443;
        }
    } else {
        char * v55 = NULL; // bp-316, 0x80fc318
        HTSprintf0(&v55, "chmod %.4o %s", mode, path);
        int32_t str5; // bp-18, 0x80fb834
        sprintf((char *)&str5, "%.4o", mode);
        char * v56 = "chmod"; // bp-336, 0x80fc369
        int32_t v57 = LYExecv(v54, &v56, v55); // 0x80fc3af
        char * v58 = v55;
        if (v57 >= 0 == (v57 != 0)) {
            if (v58 != NULL) {
                // 0x80fc3f0
                free((int32_t *)v58);
                v55 = NULL;
            }
            // 0x80fc432
            LYforce_no_cache = 1;
            v12 = 1;
            goto lab_0x80fc443;
        } else {
            // 0x80fc3b8
            v12 = -1;
            if (v58 != NULL) {
                // 0x80fc3c2
                free((int32_t *)v58);
                v55 = NULL;
                v12 = -1;
            }
            goto lab_0x80fc443;
        }
    }
  lab_0x80fc294:
    // 0x80fc294
    *(int32_t *)&v8 = v7;
    char * v59 = (char *)v7;
    char v60 = *v59; // 0x80fc2ee
    v4 = v60;
    v5 = v59;
    v6 = v7;
    v10 = v9;
    mode = v9;
    if (v60 == 0) {
        goto lab_0x80fc2f9;
    }
    goto lab_0x80fc1bc;
  lab_0x80fc443:;
    int32_t result = v12; // 0x80fc453
    if (v3 != __readgsdword(20)) {
        // 0x80fc455
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80fc45a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fc45c - 0x80fc541
// Line range:    1530 - 1552
void tagflag(int32_t flag, int32_t cur) {
    // 0x80fc45c
    if (nlinks < 1) {
        // 0x80fc53f
        return;
    }
    int32_t v1 = 68 * cur; // 0x80fc47a
    int32_t * v2 = (int32_t *)(v1 + (int32_t)&g346); // 0x80fc47c
    LYmove(*v2, 2);
    lynx_stop_reverse();
    int32_t v3 = (int32_t)LYwin;
    if (flag != 1) {
        // 0x80fc4b4
        function_804a8f4(v3, 32);
    } else {
        // 0x80fc49d
        function_804a8f4(v3, 43);
    }
    // 0x80fc4c9
    if (LYShowCursor != 0) {
        // 0x80fc508
        LYmove(*v2, *(int32_t *)(v1 + (int32_t)&g345));
    } else {
        // 0x80fc4d4
        LYmove(LYlines - 1, LYcols + (int32_t)(LYShowScrollbar != 0) - 1);
    }
    // 0x80fc53a
    LYrefresh();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fc541 - 0x80fc5d9
// Line range:    1558 - 1572
void showtags(int32_t * t) {
    // 0x80fc541
    if (nlinks <= 0) {
        // 0x80fc5d7
        return;
    }
    int32_t v1 = 0; // 0x80fc5d1
    int32_t v2; // 0x80fc541
    while (true) {
      lab_0x80fc593:
        // 0x80fc593
        v2 = v1;
        int32_t * str = (int32_t *)(68 * v2 + (int32_t)&links);
        int32_t v3 = (int32_t)t;
        while (v3 != 0) {
            int32_t v4 = *(int32_t *)(v3 + 4); // 0x80fc59c
            if (v4 == 0) {
                // break -> 0x80fc5c5
                break;
            }
            int32_t str2 = *(int32_t *)v4; // 0x80fc5ab
            if (str2 == 0) {
                // break -> 0x80fc5c5
                break;
            }
            // 0x80fc558
            if (strcmp((char *)*str, (char *)str2) == 0) {
                // 0x80fc57e
                tagflag(1, v2);
                goto lab_0x80fc5c5;
            }
            v3 = v4;
        }
        goto lab_0x80fc5c5;
    }
  lab_0x80fc5c5:
    // 0x80fc5c5
    v1 = v2 + 1;
    if (v1 >= nlinks) {
        return;
    }
    goto lab_0x80fc593;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fc5d9 - 0x80fc65a
// Line range:    1575 - 1592
char * DirectoryOf(char * pathname) {
    char * result2 = NULL; // bp-8, 0x80fc5df
    HTSACopy(&result2, pathname);
    char * result = LYPathLeaf(result2); // 0x80fc5fe
    if (result == result2) {
        // 0x80fc655
        return result;
    }
    // 0x80fc60e
    *result = 0;
    if (LYisRootPath(result2) == 0) {
        // 0x80fc62a
        LYTrimPathSep(result2);
    }
    char * v1 = wwwName(result2); // 0x80fc63b
    HTSACopy(&result2, v1);
    // 0x80fc655
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fc65a - 0x80fc6ca
// Line range:    1626 - 1640
char * match_op(char * prefix, char * data) {
    int32_t len = strlen(prefix); // 0x80fc666
    if (strncmp("LYNXDIRED://", data, 12) != 0) {
        // 0x80fc6c5
        return NULL;
    }
    int32_t str = (int32_t)data + 12;
    char * result = NULL; // 0x80fc6ab
    if (strncmp(prefix, (char *)str, len) == 0) {
        // 0x80fc6ad
        result = (char *)(len + str);
    }
    // 0x80fc6c5
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fc6ca - 0x80fd395
// Line range:    1649 - 1834
char * build_command(char * line, char * dirname, char * arg) {
    char * result = NULL; // bp-8, 0x80fc6d0
    char * v1 = HTGetProgramPath(15); // 0x80fc6de
    char * v2 = match_op("DECOMPRESS", line); // 0x80fc6f4
    if (v2 != NULL) {
        char * v3 = HTGetProgramPath(19); // 0x80fc709
        if (v3 != NULL) {
            // 0x80fc717
            HTAddParam(&result, "%s %s", 1, v3);
            HTAddParam(&result, "%s %s", 2, v2);
            HTEndParam(&result, "%s %s", 2);
        }
        // 0x80fd390
        return result;
    }
    char * v4 = match_op("UUDECODE", line); // 0x80fc78f
    if (v4 != NULL) {
        char * v5 = HTGetProgramPath(21); // 0x80fc7a8
        if (v5 != NULL) {
            // 0x80fc7b6
            HTAddParam(&result, "%s %s", 1, v5);
            HTAddParam(&result, "%s %s", 2, v4);
            HTEndParam(&result, "%s %s", 2);
            HTAlert(gettext("Warning!  UUDecoded file will exist in the directory you started Lynx."));
        }
        // 0x80fd390
        return result;
    }
    if (v1 != NULL) {
        char * v6 = match_op("UNTAR_GZ", line); // 0x80fc84c
        if (v6 != NULL) {
            char * v7 = HTGetProgramPath(6); // 0x80fc865
            if (v7 != NULL) {
                char * v8 = DirectoryOf(v6); // 0x80fc87d
                HTAddParam(&result, "cd %s; %s -qdc %s |  %s %s %s", 1, v8);
                HTAddParam(&result, "cd %s; %s -qdc %s |  %s %s %s", 2, v7);
                HTAddParam(&result, "cd %s; %s -qdc %s |  %s %s %s", 3, v6);
                HTAddParam(&result, "cd %s; %s -qdc %s |  %s %s %s", 4, v1);
                HTAddToCmd(&result, "cd %s; %s -qdc %s |  %s %s %s", 5, "-xf");
                HTAddToCmd(&result, "cd %s; %s -qdc %s |  %s %s %s", 6, "-");
                HTEndParam(&result, "cd %s; %s -qdc %s |  %s %s %s", 6);
            }
            // 0x80fd390
            return result;
        }
        char * v9 = match_op("UNTAR_Z", line); // 0x80fc987
        if (v9 != NULL) {
            char * v10 = HTGetProgramPath(22); // 0x80fc9a0
            if (v10 != NULL) {
                char * v11 = DirectoryOf(v9); // 0x80fc9b8
                HTAddParam(&result, "cd %s; %s %s |  %s %s %s", 1, v11);
                HTAddParam(&result, "cd %s; %s %s |  %s %s %s", 2, v10);
                HTAddParam(&result, "cd %s; %s %s |  %s %s %s", 3, v9);
                HTAddParam(&result, "cd %s; %s %s |  %s %s %s", 4, v1);
                HTAddToCmd(&result, "cd %s; %s %s |  %s %s %s", 5, "-xf");
                HTAddToCmd(&result, "cd %s; %s %s |  %s %s %s", 6, "-");
                HTEndParam(&result, "cd %s; %s %s |  %s %s %s", 6);
            }
            // 0x80fd390
            return result;
        }
        char * v12 = match_op("UNTAR", line); // 0x80fcac2
        if (v12 != NULL) {
            char * v13 = DirectoryOf(v12); // 0x80fcada
            HTAddParam(&result, "cd %s; %s %s %s", 1, v13);
            HTAddParam(&result, "cd %s; %s %s %s", 2, v1);
            HTAddToCmd(&result, "cd %s; %s %s %s", 3, "-xf");
            HTAddParam(&result, "cd %s; %s %s %s", 4, v12);
            HTEndParam(&result, "cd %s; %s %s %s", 4);
            // 0x80fd390
            return result;
        }
        char * v14 = match_op("TAR_GZ", line); // 0x80fcb9f
        if (v14 != NULL) {
            char * v15 = HTGetProgramPath(6); // 0x80fcbb8
            if (v15 != NULL) {
                char * v16 = DirectoryOf(v14); // 0x80fcbd0
                HTAddParam(&result, "cd %s; %s %s %s %s | %s -qc >%s%s", 1, v16);
                HTAddParam(&result, "cd %s; %s %s %s %s | %s -qc >%s%s", 2, v1);
                HTAddToCmd(&result, "cd %s; %s %s %s %s | %s -qc >%s%s", 3, "-cf");
                HTAddToCmd(&result, "cd %s; %s %s %s %s | %s -qc >%s%s", 4, "-");
                char * v17 = LYPathLeaf(v14); // 0x80fcc68
                HTAddParam(&result, "cd %s; %s %s %s %s | %s -qc >%s%s", 5, v17);
                HTAddParam(&result, "cd %s; %s %s %s %s | %s -qc >%s%s", 6, v15);
                char * v18 = LYPathLeaf(v14); // 0x80fccb4
                HTAddParam(&result, "cd %s; %s %s %s %s | %s -qc >%s%s", 7, v18);
                HTAddParam(&result, "cd %s; %s %s %s %s | %s -qc >%s%s", 8, ".tar.gz");
                HTEndParam(&result, "cd %s; %s %s %s %s | %s -qc >%s%s", 8);
            }
            // 0x80fd390
            return result;
        }
        char * v19 = match_op("TAR_Z", line); // 0x80fcd2f
        if (v19 != NULL) {
            char * v20 = HTGetProgramPath(3); // 0x80fcd48
            if (v20 != NULL) {
                char * v21 = DirectoryOf(v19); // 0x80fcd60
                HTAddParam(&result, "cd %s; %s %s %s %s | %s >%s%s", 1, v21);
                HTAddParam(&result, "cd %s; %s %s %s %s | %s >%s%s", 2, v1);
                HTAddToCmd(&result, "cd %s; %s %s %s %s | %s >%s%s", 3, "-cf");
                HTAddToCmd(&result, "cd %s; %s %s %s %s | %s >%s%s", 4, "-");
                char * v22 = LYPathLeaf(v19); // 0x80fcdf8
                HTAddParam(&result, "cd %s; %s %s %s %s | %s >%s%s", 5, v22);
                HTAddParam(&result, "cd %s; %s %s %s %s | %s >%s%s", 6, v20);
                char * v23 = LYPathLeaf(v19); // 0x80fce44
                HTAddParam(&result, "cd %s; %s %s %s %s | %s >%s%s", 7, v23);
                HTAddParam(&result, "cd %s; %s %s %s %s | %s >%s%s", 8, ".tar.Z");
                HTEndParam(&result, "cd %s; %s %s %s %s | %s >%s%s", 8);
            }
            // 0x80fd390
            return result;
        }
        char * v24 = match_op("TAR", line); // 0x80fcebf
        if (v24 != NULL) {
            char * v25 = DirectoryOf(v24); // 0x80fced7
            HTAddParam(&result, "cd %s; %s %s %s %s.tar %s", 1, v25);
            HTAddParam(&result, "cd %s; %s %s %s %s.tar %s", 2, v1);
            HTAddToCmd(&result, "cd %s; %s %s %s %s.tar %s", 3, "-cf");
            HTAddToCmd(&result, "cd %s; %s %s %s %s.tar %s", 4, (char *)&g68);
            char * v26 = LYPathLeaf(v24); // 0x80fcf6f
            HTAddParam(&result, "cd %s; %s %s %s %s.tar %s", 5, v26);
            char * v27 = LYPathLeaf(v24); // 0x80fcf99
            HTAddParam(&result, "cd %s; %s %s %s %s.tar %s", 6, v27);
            HTEndParam(&result, "cd %s; %s %s %s %s.tar %s", 6);
            // 0x80fd390
            return result;
        }
    }
    char * v28 = match_op("GZIP", line); // 0x80fcff1
    if (v28 != NULL) {
        char * v29 = HTGetProgramPath(6); // 0x80fd006
        if (v29 != NULL) {
            // 0x80fd014
            HTAddParam(&result, "%s -q %s", 1, v29);
            HTAddParam(&result, "%s -q %s", 2, v28);
            HTEndParam(&result, "%s -q %s", 2);
        }
        // 0x80fd390
        return result;
    }
    char * v30 = match_op("UNGZIP", line); // 0x80fd08c
    if (v30 != NULL) {
        char * v31 = HTGetProgramPath(6); // 0x80fd0a1
        if (v31 != NULL) {
            // 0x80fd0af
            HTAddParam(&result, "%s -d %s", 1, v31);
            HTAddParam(&result, "%s -d %s", 2, v30);
            HTEndParam(&result, "%s -d %s", 2);
        }
        // 0x80fd390
        return result;
    }
    char * v32 = match_op("ZIP", line); // 0x80fd127
    if (v32 != NULL) {
        char * v33 = HTGetProgramPath(23); // 0x80fd140
        if (v33 != NULL) {
            char * v34 = DirectoryOf(v32); // 0x80fd158
            HTAddParam(&result, "cd %s; %s -rq %s.zip %s", 1, v34);
            HTAddParam(&result, "cd %s; %s -rq %s.zip %s", 2, v33);
            char * v35 = LYPathLeaf(v32); // 0x80fd1aa
            HTAddParam(&result, "cd %s; %s -rq %s.zip %s", 3, v35);
            char * v36 = LYPathLeaf(v32); // 0x80fd1d4
            HTAddParam(&result, "cd %s; %s -rq %s.zip %s", 4, v36);
            HTEndParam(&result, "cd %s; %s -rq %s.zip %s", 4);
        }
        // 0x80fd390
        return result;
    }
    char * v37 = match_op("UNZIP", line); // 0x80fd22c
    if (v37 != NULL) {
        char * v38 = HTGetProgramPath(20); // 0x80fd245
        if (v38 != NULL) {
            char * v39 = DirectoryOf(v37); // 0x80fd25d
            HTAddParam(&result, "cd %s; %s -q %s", 1, v39);
            HTAddParam(&result, "cd %s; %s -q %s", 2, v38);
            HTAddParam(&result, "cd %s; %s -q %s", 3, v37);
            HTEndParam(&result, "cd %s; %s -q %s", 3);
        }
        // 0x80fd390
        return result;
    }
    char * v40 = match_op("COMPRESS", line); // 0x80fd2ff
    if (v40 == NULL) {
        // 0x80fd390
        return NULL;
    }
    char * v41 = HTGetProgramPath(3); // 0x80fd314
    if (v41 != NULL) {
        // 0x80fd322
        HTAddParam(&result, "%s %s", 1, v41);
        HTAddParam(&result, "%s %s", 2, v40);
        HTEndParam(&result, "%s %s", 2);
    }
    // 0x80fd390
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fd395 - 0x80fd8ea
// Line range:    1846 - 1967
int32_t local_dired(int32_t * doc) {
    char * line_url = NULL; // bp-20, 0x80fd39c
    char * line = NULL; // bp-28, 0x80fd3aa
    char * arg = NULL; // bp-32, 0x80fd3b1
    int32_t * v1 = (int32_t *)((int32_t)doc + 4); // 0x80fd3cd
    int32_t v2 = *v1; // 0x80fd3cd
    char * v3 = (char *)v2;
    if (WWW_TraceFlag != 0) {
        char * v4 = v3; // 0x80fd3e2
        if (v2 == 0) {
            // 0x80fd3e4
            v4 = gettext("NULL URL pointer");
        }
        // 0x80fd3fb
        fprintf(TraceFP(), "local_dired: called for <%s>.\n", v4);
    }
    // 0x80fd419
    HTUnEscapeSome(v3, "/");
    HTSACopy(&line_url, v3);
    HTUnEscape(line_url);
    char v5; // 0x80fd395
    char * v6; // 0x80fd395
    if (match_op("CHDIR", line_url) == NULL) {
        char * v7 = match_op("NEW_FILE", line_url); // 0x80fd488
        if (v7 == NULL) {
            char * v8 = match_op("NEW_FOLDER", line_url); // 0x80fd4c3
            if (v8 == NULL) {
                char * v9 = match_op("MODIFY_NAME", line_url); // 0x80fd4fe
                if (v9 == NULL) {
                    char * v10 = match_op("MODIFY_LOCATION", line_url); // 0x80fd539
                    if (v10 == NULL) {
                        char * v11 = match_op("MOVE_TAGGED", v3); // 0x80fd574
                        if (v11 == NULL) {
                            char * v12 = match_op("PERMIT_SRC", line_url); // 0x80fd5af
                            if (v12 != NULL) {
                                // 0x80fd5bd
                                permit_location(NULL, v12, &line);
                                if (line != NULL) {
                                    int32_t v13 = *v1; // 0x80fd5e1
                                    char * v14 = line; // 0x80fd5e6
                                    if (v13 != 0) {
                                        // 0x80fd5e8
                                        free((int32_t *)v13);
                                        *v1 = 0;
                                        v14 = line;
                                    }
                                    // 0x80fd600
                                    *v1 = (int32_t)v14;
                                }
                                // 0x80fd609
                                if (line_url != NULL) {
                                    // 0x80fd610
                                    free((int32_t *)line_url);
                                    line_url = NULL;
                                }
                                // 0x80fd8e1
                                return 0;
                            }
                            char * v15 = match_op("PERMIT_LOCATION", v3); // 0x80fd63c
                            if (v15 == NULL) {
                                char * v16 = match_op("REMOVE_SINGLE", line_url); // 0x80fd677
                                if (v16 == NULL) {
                                    // 0x80fd6a4
                                    if (match_op("REMOVE_TAGGED", line_url) == NULL) {
                                        // 0x80fd6d9
                                        if (match_op("CLEAR_TAGGED", line_url) == NULL) {
                                            // 0x80fd6ff
                                            if (match_op("UPLOAD", line_url) == NULL) {
                                                // 0x80fd73a
                                                LYTrimPathSep(line_url);
                                                char * v17 = line_url;
                                                if (LYLastPathSep(line_url) == NULL) {
                                                    if (v17 != NULL) {
                                                        // 0x80fd75b
                                                        free((int32_t *)v17);
                                                        line_url = NULL;
                                                    }
                                                    // 0x80fd8e1
                                                    return 0;
                                                }
                                                char * str = build_command(v17, NULL, NULL); // 0x80fd78d
                                                v6 = NULL;
                                                v5 = 1;
                                                if (str != NULL) {
                                                    // 0x80fd79f
                                                    if (strlen(str) < LYcols - 14 + (int32_t)(LYShowScrollbar != 0)) {
                                                        char * v18 = gettext("Executing %s "); // 0x80fd7d5
                                                        HTSprintf0(&arg, v18);
                                                    } else {
                                                        char * v19 = gettext("Executing system command. This might take a while."); // 0x80fd7f9
                                                        HTSprintf0(&arg, v19);
                                                    }
                                                    // 0x80fd80d
                                                    mustshow = 1;
                                                    statusline(arg);
                                                    stop_curses();
                                                    printf("%s\r\n", arg);
                                                    LYSystem(str);
                                                    start_curses();
                                                    LYforce_no_cache = 1;
                                                    v6 = str;
                                                    v5 = 1;
                                                }
                                            } else {
                                                // 0x80fd71b
                                                v6 = NULL;
                                                v5 = 1;
                                                if (LYUpload(v3) != 0) {
                                                    // 0x80fd72e
                                                    LYforce_no_cache = 1;
                                                    v6 = NULL;
                                                    v5 = 1;
                                                }
                                            }
                                        } else {
                                            // 0x80fd6f5
                                            clear_tags();
                                            v6 = NULL;
                                            v5 = 1;
                                        }
                                    } else {
                                        // 0x80fd6c0
                                        v6 = NULL;
                                        v5 = 1;
                                        if (remove_tagged() != 0) {
                                            // 0x80fd6cd
                                            LYforce_no_cache = 1;
                                            v6 = NULL;
                                            v5 = 1;
                                        }
                                    }
                                } else {
                                    // 0x80fd685
                                    v6 = NULL;
                                    v5 = 1;
                                    if (remove_single(v16) >= 1) {
                                        // 0x80fd698
                                        LYforce_no_cache = 1;
                                        v6 = NULL;
                                        v5 = 1;
                                    }
                                }
                            } else {
                                // 0x80fd64a
                                permit_location(v15, NULL, &line);
                                v6 = NULL;
                                v5 = 1;
                            }
                        } else {
                            // 0x80fd582
                            v6 = NULL;
                            v5 = 1;
                            if (modify_tagged(v11) >= 1) {
                                // 0x80fd595
                                LYforce_no_cache = 1;
                                v6 = NULL;
                                v5 = 1;
                            }
                        }
                    } else {
                        // 0x80fd547
                        v6 = NULL;
                        v5 = 1;
                        if (modify_location(v10) >= 1) {
                            // 0x80fd55a
                            LYforce_no_cache = 1;
                            v6 = NULL;
                            v5 = 1;
                        }
                    }
                } else {
                    // 0x80fd50c
                    v6 = NULL;
                    v5 = 1;
                    if (modify_name(v9) >= 1) {
                        // 0x80fd51f
                        LYforce_no_cache = 1;
                        v6 = NULL;
                        v5 = 1;
                    }
                }
            } else {
                // 0x80fd4d1
                v6 = NULL;
                v5 = 1;
                if (create_directory(v8) >= 1) {
                    // 0x80fd4e4
                    LYforce_no_cache = 1;
                    v6 = NULL;
                    v5 = 1;
                }
            }
        } else {
            // 0x80fd496
            v6 = NULL;
            v5 = 1;
            if (create_file(v7) >= 1) {
                // 0x80fd4a9
                LYforce_no_cache = 1;
                v6 = NULL;
                v5 = 1;
            }
        }
    } else {
        // 0x80fd465
        handle_LYK_CHDIR();
        v6 = NULL;
        v5 = 0;
    }
    // 0x80fd866
    if (arg != NULL) {
        // 0x80fd86d
        free((int32_t *)arg);
        arg = NULL;
    }
    if (v6 != NULL) {
        // 0x80fd885
        free((int32_t *)v6);
    }
    // 0x80fd897
    if (line_url != NULL) {
        // 0x80fd89e
        free((int32_t *)line_url);
        line_url = NULL;
    }
    // 0x80fd8b0
    if (line != NULL) {
        // 0x80fd8b7
        free((int32_t *)line);
        line = NULL;
    }
    if (v5 != 0) {
        // 0x80fd8cf
        LYpop(doc);
    }
    // 0x80fd8e1
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fd8ea - 0x80fe2ca
// Line range:    1973 - 2123
int32_t dired_options(int32_t * doc, char ** newfile) {
    char buf[2048]; // bp-2072, 0x80fd8ea
    char v1[2048]; // 0x80fd9cd
    int32_t v2 = __readgsdword(20); // 0x80fd907
    struct _IO_FILE * stream = InternalPageFP((char *)&g337, 0); // 0x80fd921
    char * dir = (char *)stream; // bp-2084, 0x80fd926
    int32_t v3; // 0x80fd8ea
    if (stream != NULL) {
        // 0x80fd944
        v3 = (int32_t)doc;
        LYLocalFileToURL(newfile, (char *)&g337);
        LYRegisterUIPage(*newfile, 8);
        int32_t v4 = *(int32_t *)(v3 + 24); // 0x80fd978
        if (v4 < 0) {
            // 0x80fda3c
            HTSACopy((char **)&buf, (char *)&g68);
            goto lab_0x80fda52;
        } else {
            // 0x80fd983
            if (v4 < nlinks + 1) {
                int32_t v5 = *(int32_t *)(68 * v4 + (int32_t)&links); // 0x80fd9af
                char * v6 = HTnameOfFile_WWW((char *)v5, 0, 1); // 0x80fd9c8
                v1[0] = (int32_t)v6;
                buf = v1;
                LYTrimPathSep((char *)*(int32_t *)&buf);
                int32_t v7; // bp-2216, 0x80fd8ea
                if (ok_lstat((char *)*(int32_t *)&buf, &v7) != 0) {
                    goto lab_0x80fda52;
                } else {
                    // 0x80fd9fd
                    LYCloseTempFP(stream);
                    int32_t v8 = *(int32_t *)&buf; // 0x80fda0b
                    if (v8 != 0) {
                        // 0x80fda15
                        free((int32_t *)v8);
                        buf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
                    }
                    goto lab_0x80fe2a9;
                }
            } else {
                // 0x80fda3c
                HTSACopy((char **)&buf, (char *)&g68);
                goto lab_0x80fda52;
            }
        }
    } else {
        goto lab_0x80fe2a9;
    }
  lab_0x80fe17e:;
    // 0x80fe17e
    char * v9; // 0x80fd8ea
    int32_t v10 = *(int32_t *)((int32_t)v9 + 20); // 0x80fe184
    char * v11 = (char *)v10; // 0x80fe194
    if (v10 == 0) {
        // break -> 0x80fe19a
        goto lab_0x80fe19a;
    }
    goto lab_0x80fdea3;
  lab_0x80fdf0b:;
    int32_t v14; // 0x80fd8ea
    int32_t v12; // 0x80fdea9
    if (v12 != 3) {
        goto lab_0x80fdf3f;
    } else {
        // 0x80fdf18
        if (v14 != 0x8000 | *(char *)*(int32_t *)&buf == 0) {
            goto lab_0x80fe17e;
        } else {
            goto lab_0x80fdf3f;
        }
    }
  lab_0x80fdf3f:
    if (v12 != 4) {
        goto lab_0x80fdf73;
    } else {
        // 0x80fdf4c
        if (v14 != 0xa000 | *(char *)*(int32_t *)&buf == 0) {
            goto lab_0x80fe17e;
        } else {
            goto lab_0x80fdf73;
        }
    }
  lab_0x80fdf73:;
    int32_t v15 = (int32_t)v9; // 0x80fdf73
    int32_t * str = (int32_t *)(v15 + 4); // 0x80fdf79
    if (*(char *)*str == 0) {
        goto lab_0x80fdff9;
    } else {
        uint32_t len = strlen((char *)*(int32_t *)&buf); // 0x80fdf8c
        if (len < strlen((char *)*str)) {
            goto lab_0x80fe17e;
        } else {
            int32_t str2 = *(int32_t *)&buf;
            int32_t len2 = strlen((char *)str2); // 0x80fdfbb
            int32_t len3 = strlen((char *)*str); // 0x80fdfce
            if (strcmp((char *)*str, (char *)(len2 + str2 - len3)) != 0) {
                goto lab_0x80fe17e;
            } else {
                goto lab_0x80fdff9;
            }
        }
    }
  lab_0x80fdff9:;
    // 0x80fdff9
    char * path; // bp-2076, 0x80fd8ea
    char * v16 = HTEscape(path, 4); // 0x80fe00a
    char * v17 = HTEscape((char *)*(int32_t *)&buf, 4); // 0x80fe026
    int32_t v18 = *(int32_t *)(v15 + 16); // 0x80fe037
    int32_t v19; // bp-2064, 0x80fd8ea
    char * v20 = render_item((char *)v18, v17, v16, (char *)&v19, 2048, 1); // 0x80fe06b
    fprintf((struct _IO_FILE *)dir, "<a href=\"%s", v20);
    int32_t v21 = *(int32_t *)&buf; // 0x80fe08a
    int32_t v22 = *(int32_t *)(v15 + 8); // 0x80fe096
    char * v23 = render_item((char *)v22, (char *)v21, path, (char *)&v19, 2048, 0); // 0x80fe0c4
    fprintf((struct _IO_FILE *)dir, "\">%s</a> ", v23);
    int32_t v24 = *(int32_t *)&buf; // 0x80fe0e3
    int32_t v25 = *(int32_t *)(v15 + 12); // 0x80fe0ef
    char * v26 = render_item((char *)v25, (char *)v24, path, (char *)&v19, 2048, 0); // 0x80fe11d
    fprintf((struct _IO_FILE *)dir, "%s<br>\n", v26);
    if (v16 != NULL) {
        // 0x80fe145
        free((int32_t *)v16);
    }
    if (v17 != NULL) {
        // 0x80fe166
        free((int32_t *)v17);
    }
    goto lab_0x80fe17e;
  lab_0x80fe2a9:;
    int32_t result = 0; // 0x80fe2b9
    if (v2 != __readgsdword(20)) {
        // 0x80fe2bb
        __stack_chk_fail();
        result = &g391;
    }
    // 0x80fe2c0
    return result;
  lab_0x80fda52:;
    int32_t * v27 = (int32_t *)(v3 + 4); // 0x80fda58
    char * v28 = HTnameOfFile_WWW((char *)*v27, 0, 1); // 0x80fda6e
    path = v28;
    LYTrimPathSep(v28);
    bool v29 = false; // 0x80fda8e
    if (tagged != NULL) {
        // 0x80fda90
        v29 = dir_list_order != 0;
    }
    bool v13 = v29;
    BeginInternalPage(stream, gettext("File Management Options"), "keystrokes/dired_help.html.gz");
    fprintf(stream, "<em>%s</em> %s<br>\n", gettext("Current directory:"), v28);
    if (v13) {
        int32_t v30 = HTList_count(tagged); // 0x80fdbaf
        int32_t * mp = NULL; // bp-2108, 0x80fdbba
        char * v31 = NULL; // bp-2112, 0x80fdbc4
        char * v32; // 0x80fd8ea
        if (v30 != 1) {
            // 0x80fdbeb
            v32 = gettext("tagged items:");
        } else {
            // 0x80fdbd7
            v32 = gettext("tagged item:");
        }
        // 0x80fdbfd
        fprintf(stream, "<em>%s</em> %d %s", gettext("Current selection:"), v30, v32);
        HTSACopy(&v31, (char *)*v27);
        HTUnEscapeSome(v31, "/");
        LYAddHtmlSep(&v31);
        uint32_t v33 = v30 < 10 ? v30 : 10;
        if (v33 >= 1) {
            uint32_t v34 = 1;
            char * v35 = v31; // 0x80fdcb2
            char * v36 = *v35 == 0 ? "file://localhost" : v35;
            char * v37 = HTRelative(HTList_objectAt(tagged, v34 - 1), v36); // 0x80fdcff
            mp = (int32_t *)v37;
            HTUnEscape(v37);
            LYEntify((char **)&mp, 1);
            char * v38 = v34 != 1 ? " ," : (char *)&g68;
            fprintf(stream, "%s<br>\n&nbsp;&nbsp;&nbsp;%s", v38, mp);
            int32_t * v39 = mp; // 0x80fdd83
            if (v39 != NULL) {
                // 0x80fdd8d
                free(v39);
                mp = NULL;
            }
            int32_t v40 = v34 + 1; // 0x80fddb8
            while (v34 < v33) {
                // 0x80fdcb2
                v34 = v40;
                v35 = v31;
                v36 = *v35 == 0 ? "file://localhost" : v35;
                v37 = HTRelative(HTList_objectAt(tagged, v34 - 1), v36);
                mp = (int32_t *)v37;
                HTUnEscape(v37);
                LYEntify((char **)&mp, 1);
                v38 = v34 != 1 ? " ," : (char *)&g68;
                fprintf(stream, "%s<br>\n&nbsp;&nbsp;&nbsp;%s", v38, mp);
                v39 = mp;
                if (v39 != NULL) {
                    // 0x80fdd8d
                    free(v39);
                    mp = NULL;
                }
                // 0x80fdda5
                v40 = v34 + 1;
            }
        }
        if (v30 > 10) {
            // 0x80fddcc
            fwrite((int32_t *)" , ...", 1, 6, stream);
        }
        // 0x80fddf2
        fwrite((int32_t *)"<p>\n", 1, 4, stream);
        if (v31 != NULL) {
            // 0x80fde22
            free((int32_t *)v31);
            v31 = NULL;
        }
    } else {
        // 0x80fdb24
        fprintf(stream, "<em>%s</em> ", gettext("Current selection:"));
        char * v41 = (char *)*(int32_t *)&buf; // 0x80fdb50
        if (*v41 == 0) {
            // 0x80fdb7c
            fprintf(stream, "%s.<p>\n", gettext("Nothing currently selected."));
        } else {
            // 0x80fdb57
            fprintf(stream, "%s<p>\n", v41);
        }
    }
    // 0x80fde3a
    char * v42; // 0x80fd8ea
    if (menu_head != NULL) {
        // 0x80fde93
        v42 = (char *)menu_head;
    } else {
        int32_t v43 = &defmenu; // 0x80fde73
        if (*(int32_t *)((int32_t)&defmenu + 16) != 0) {
            int32_t v44 = &defmenu;
            int32_t v45 = v44 + 24; // 0x80fde55
            *(int32_t *)(v44 + 20) = v45;
            v43 = v45;
            while (*(int32_t *)(v44 + 40) != 0) {
                // 0x80fde4f
                v44 = v45;
                v45 = v44 + 24;
                *(int32_t *)(v44 + 20) = v45;
                v43 = v45;
            }
        }
        // 0x80fde93
        *(int32_t *)(v43 - 4) = 0;
        *(int32_t *)&menu_head = (int32_t)&defmenu;
        v42 = (char *)&defmenu;
    }
    // 0x80fdea3
    int32_t v46; // 0x80fd8ea
    v14 = v46 & 0xf000;
    v11 = v42;
    while (true) {
      lab_0x80fdea3:
        // 0x80fdea3
        v9 = v11;
        v12 = *(int32_t *)v9;
        if (v13 == (v12 != 1) || !v13 == v12 == 1) {
            goto lab_0x80fe17e;
        } else {
            if (v12 != 2) {
                goto lab_0x80fdf0b;
            } else {
                // 0x80fdee4
                if (v14 != 0x4000 | *(char *)*(int32_t *)&buf == 0) {
                    goto lab_0x80fe17e;
                } else {
                    goto lab_0x80fdf0b;
                }
            }
        }
    }
  lab_0x80fe19a:;
    int32_t v47 = *(int32_t *)&buf; // 0x80fe19a
    if (v47 != 0) {
        // 0x80fe1a4
        free((int32_t *)v47);
        buf = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    }
    // 0x80fe1bc
    if (uploaders != NULL) {
        // 0x80fe1c9
        fwrite((int32_t *)"<p>Upload to current directory:<p>\n", 1, 35, (struct _IO_FILE *)dir);
        if (uploaders != NULL) {
            char * v48 = (char *)uploaders; // 0x80fd8ea
            int32_t v49 = *(int32_t *)((int32_t)v48 + 4); // 0x80fe20c
            int32_t v50 = (int32_t)NULL; // 0x80fe21d
            fprintf((struct _IO_FILE *)dir, "<a href=\"LYNXDIRED://UPLOAD=%d/TO=%s\"> %s </a><br>\n", v50, path, (char *)v49);
            int32_t v51 = *(int32_t *)v48; // 0x80fe243
            v48 = (char *)v51;
            char * v52 = (char *)(v50 + 1); // 0x80fe259
            while (v51 != 0) {
                // 0x80fe206
                v49 = *(int32_t *)((int32_t)v48 + 4);
                v50 = (int32_t)v52;
                fprintf((struct _IO_FILE *)dir, "<a href=\"LYNXDIRED://UPLOAD=%d/TO=%s\"> %s </a><br>\n", v50, path, (char *)v49);
                v51 = *(int32_t *)v48;
                v48 = (char *)v51;
                v52 = (char *)(v50 + 1);
            }
        }
    }
    // 0x80fe25b
    if (path != NULL) {
        // 0x80fe264
        free((int32_t *)path);
    }
    // 0x80fe27c
    EndInternalPage((struct _IO_FILE *)dir);
    LYCloseTempFP((struct _IO_FILE *)dir);
    LYforce_no_cache = 1;
    goto lab_0x80fe2a9;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fe2ca - 0x80fe3a0
// Line range:    2131 - 2154
char * get_filename(char * prompt, char * buf, int32_t bufsize) {
    // 0x80fe2ca
    mustshow = 1;
    statusline(prompt);
    LYgetstr(buf, 0, bufsize, 0);
    if (strstr(buf, "../") != NULL) {
        // 0x80fe31b
        HTAlert(gettext("Illegal filename; request ignored."));
        // 0x80fe39b
        return NULL;
    }
    // 0x80fe338
    if (no_dotfiles == 0) {
        // 0x80fe343
        if (show_dotfiles != 0) {
            // 0x80fe39b
            return buf;
        }
    }
    char * v1 = LYLastPathSep(buf); // 0x80fe354
    char * result = buf; // 0x80fe376
    if (*((v1 == NULL ? buf : (char *)((int32_t)v1 + 1))) == 46) {
        // 0x80fe378
        HTAlert(gettext("Illegal filename; request ignored."));
        result = NULL;
    }
    // 0x80fe39b
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fe3a0 - 0x80fe414
// Line range:    2408 - 2416
void clear_tags(void) {
    char * v1 = HTList_removeLastObject(tagged); // 0x80fe3cf
    if (v1 != NULL) {
        free((int32_t *)v1);
        char * v2 = HTList_removeLastObject(tagged); // 0x80fe3cf
        while (v2 != NULL) {
            // 0x80fe3b5
            free((int32_t *)v2);
            v2 = HTList_removeLastObject(tagged);
        }
    }
    // 0x80fe3dd
    if (tagged == NULL) {
        // 0x80fe412
        return;
    }
    // 0x80fe3e6
    if (dir_list_order == 0) {
        // 0x80fe3fb
        free(tagged);
        *(int32_t *)&tagged = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fe60e - 0x80fe6f4
// Line range:    2482 - 2496
void reset_dired_menu(void) {
    // 0x80fe60e
    if (menu_head == &defmenu) {
        // 0x80fe6f2
        return;
    }
    if (menu_head == NULL) {
        // 0x80fe6e8
        *(int32_t *)&menu_head = 0;
        // 0x80fe6f2
        return;
    }
    int32_t v1 = (int32_t)menu_head;
    int32_t * v2 = (int32_t *)(v1 + 4);
    int32_t v3 = *v2; // 0x80fe63b
    if (v3 != 0) {
        // 0x80fe642
        free((int32_t *)v3);
        *v2 = 0;
    }
    int32_t * v4 = (int32_t *)(v1 + 8);
    int32_t v5 = *v4; // 0x80fe65d
    if (v5 != 0) {
        // 0x80fe664
        free((int32_t *)v5);
        *v4 = 0;
    }
    int32_t * v6 = (int32_t *)(v1 + 12);
    int32_t v7 = *v6; // 0x80fe67f
    if (v7 != 0) {
        // 0x80fe686
        free((int32_t *)v7);
        *v6 = 0;
    }
    int32_t * v8 = (int32_t *)(v1 + 16);
    int32_t v9 = *v8; // 0x80fe6a1
    if (v9 != 0) {
        // 0x80fe6a8
        free((int32_t *)v9);
        *v8 = 0;
    }
    // 0x80fe6c6
    free(menu_head);
    // 0x80fe6e8
    *(int32_t *)&menu_head = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/src/./LYLocal.c
// Address range: 0x80fe6f4 - 0x80feade
// Line range:    2507 - 2591
char * render_item(char * s, char * path, char * dir, char * buf, int32_t bufsize, char url_syntax) {
    char v1 = 0; // bp-5, 0x80fe700
    char * cp = NULL; // bp-20, 0x80fe704
    char * cp2 = buf; // bp-16, 0x80fe70e
    char v2 = *s; // 0x80fea9b
    int32_t v3 = (int32_t)buf;
    v1 = 0;
    char v4; // 0x80fe6f4
    char v5; // 0x80fe6f4
    char v6; // 0x80fe6f4
    char * v7; // 0x80fe6f4
    char * v8; // 0x80fe6f4
    uint32_t v9; // 0x80fe6f4
    char * v10; // 0x80fe724
    if (v2 != 0) {
        // 0x80fe716
        v9 = bufsize - 2 + v3;
        v4 = v2;
        v8 = s;
        while (true) {
          lab_0x80fe716:;
            char * v11 = v8;
            char v12 = v4;
            if (v12 != 37) {
                char * v13 = cp2; // 0x80fea72
                uint32_t v14 = (int32_t)v13;
                char v15 = v12; // 0x80fea75
                char * v16 = &v1; // 0x80fea75
                if (v9 >= v14) {
                    // 0x80fea7f
                    cp2 = (char *)(v14 + 1);
                    v15 = *v11;
                    v16 = v13;
                }
                // 0x80fea89
                *v16 = v15;
                v7 = v11;
                goto lab_0x80fea94;
            } else {
                // 0x80fe724
                v10 = (char *)((int32_t)v11 + 1);
                char v17 = *v10; // 0x80fe72b
                if (v17 == 108) {
                    goto lab_0x80fe8ef;
                } else {
                    if (v17 > 108) {
                        switch (v17) {
                            case 112: {
                                // 0x80fe7a3
                                v5 = 47;
                                if (*path == 47) {
                                    goto lab_0x80fe7db;
                                } else {
                                    char * v18 = cp2; // 0x80fe7bc
                                    uint32_t v19 = (int32_t)v18;
                                    char * v20 = &v1; // 0x80fe7bf
                                    if (v9 >= v19) {
                                        // 0x80fe7c9
                                        cp2 = (char *)(v19 + 1);
                                        v20 = v18;
                                    }
                                    // 0x80fe80a
                                    *v20 = 47;
                                    char v21 = *path;
                                    v5 = v21;
                                    v7 = v10;
                                    if (v21 != 0) {
                                        goto lab_0x80fe7db;
                                    } else {
                                        goto lab_0x80fea94;
                                    }
                                }
                            }
                            case 116: {
                                goto lab_0x80fe8ef;
                            }
                            default: {
                                goto lab_0x80fea16;
                            }
                        }
                    } else {
                        switch (v17) {
                            case 100: {
                                // 0x80fe819
                                v6 = 47;
                                if (*dir == 47) {
                                    goto lab_0x80fe851;
                                } else {
                                    char * v22 = cp2; // 0x80fe832
                                    uint32_t v23 = (int32_t)v22;
                                    char * v24 = &v1; // 0x80fe835
                                    if (v9 >= v23) {
                                        // 0x80fe83f
                                        cp2 = (char *)(v23 + 1);
                                        v24 = v22;
                                    }
                                    // 0x80fe880
                                    *v24 = 47;
                                    char v25 = *dir;
                                    v6 = v25;
                                    v7 = v10;
                                    if (v25 != 0) {
                                        goto lab_0x80fe851;
                                    } else {
                                        goto lab_0x80fea94;
                                    }
                                }
                            }
                            case 102: {
                                char * v26 = LYLastPathSep(path); // 0x80fe895
                                char * v27 = v26 == NULL ? path : (char *)((int32_t)v26 + 1);
                                char v28 = *v27; // 0x80fe8e3
                                char * v29 = v27; // 0x80fe8e8
                                char v30 = v28; // 0x80fe8e8
                                v7 = v10;
                                if (v28 != 0) {
                                    char * v31 = v29; // 0x80fe8dc
                                    char * v32 = cp2; // 0x80fe8ba
                                    uint32_t v33 = (int32_t)v32;
                                    char v34 = v30; // 0x80fe8bd
                                    char * v35 = &v1; // 0x80fe8bd
                                    if (v9 >= v33) {
                                        // 0x80fe8c7
                                        cp2 = (char *)(v33 + 1);
                                        v34 = *v31;
                                        v35 = v32;
                                    }
                                    // 0x80fe8d1
                                    *v35 = v34;
                                    char * v36 = (char *)((int32_t)v31 + 1); // 0x80fe8dc
                                    char v37 = *v36; // 0x80fe8e3
                                    v7 = v10;
                                    while (v37 != 0) {
                                        // 0x80fe8b1
                                        v31 = v36;
                                        v32 = cp2;
                                        v33 = (int32_t)v32;
                                        v34 = v37;
                                        v35 = &v1;
                                        if (v9 >= v33) {
                                            // 0x80fe8c7
                                            cp2 = (char *)(v33 + 1);
                                            v34 = *v31;
                                            v35 = v32;
                                        }
                                        // 0x80fe8d1
                                        *v35 = v34;
                                        v36 = (char *)((int32_t)v31 + 1);
                                        v37 = *v36;
                                        v7 = v10;
                                    }
                                }
                                goto lab_0x80fea94;
                            }
                            case 37: {
                                char * v38 = cp2; // 0x80fe781
                                uint32_t v39 = (int32_t)v38;
                                char * v40 = &v1; // 0x80fe784
                                if (v9 >= v39) {
                                    // 0x80fe78e
                                    cp2 = (char *)(v39 + 1);
                                    v40 = v38;
                                }
                                // 0x80fe798
                                *v40 = 37;
                                v7 = v10;
                                goto lab_0x80fea94;
                            }
                            default: {
                                goto lab_0x80fea16;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x80feaae:;
    // 0x80feaae
    char * v41; // 0x80fe6f4
    if ((v1 & url_syntax) == 0) {
        // 0x80feaae
        v41 = cp2;
    } else {
        // 0x80feab9
        HTAlert(gettext("Temporary URL or list would be too long."));
        *(int32_t *)&cp2 = v3;
        v41 = buf;
    }
    // 0x80fead3
    *v41 = 0;
    return buf;
  lab_0x80fea94:;
    char * v42 = (char *)((int32_t)v7 + 1); // 0x80fea94
    char v43 = *v42; // 0x80fea9b
    v4 = v43;
    v8 = v42;
    if (v43 != 0 != (v1 == 0)) {
        // break -> 0x80feaae
        goto lab_0x80feaae;
    }
    goto lab_0x80fe716;
  lab_0x80fe8ef:
    // 0x80fe8ef
    if (tagged != NULL && dir_list_order != 0) {
        char * v44 = (char *)tagged;
        while (v44 != NULL) {
            int32_t v45 = *(int32_t *)((int32_t)v44 + 4); // 0x80fe97e
            if (v45 == 0) {
                // break -> 0x80fe9ab
                break;
            }
            int32_t v46 = *(int32_t *)v45; // 0x80fe98d
            if (v46 == 0) {
                // break -> 0x80fe9ab
                break;
            }
            char * str = (char *)v46;
            char * v47 = str; // 0x80fe91e
            if (*v10 == 108) {
                char * found_char_pos = strrchr(str, 47); // 0x80fe92e
                v47 = str;
                if (found_char_pos != NULL) {
                    // 0x80fe93c
                    v47 = (char *)((int32_t)found_char_pos + 1);
                }
            }
            // 0x80fe948
            HTSACat(&cp, v47);
            HTSACat(&cp, " ");
            v44 = (char *)v45;
        }
    }
    // 0x80fe9ab
    v7 = v10;
    char * v48; // 0x80fe6f4
    if (cp == NULL) {
        goto lab_0x80fea94;
    } else {
        char v49 = *cp; // 0x80fe9f0
        char v50 = v49; // 0x80fe9f5
        char * v51 = cp; // 0x80fe9f5
        v48 = cp;
        if (v49 != 0) {
            char * v52 = v51; // 0x80fe9e9
            char * v53 = cp2; // 0x80fe9c7
            uint32_t v54 = (int32_t)v53;
            char v55 = v50; // 0x80fe9ca
            char * v56 = &v1; // 0x80fe9ca
            if (v9 >= v54) {
                // 0x80fe9d4
                cp2 = (char *)(v54 + 1);
                v55 = *v52;
                v56 = v53;
            }
            // 0x80fe9de
            *v56 = v55;
            char * v57 = (char *)((int32_t)v52 + 1); // 0x80fe9e9
            char v58 = *v57; // 0x80fe9f0
            while (v58 != 0) {
                // 0x80fe9be
                v52 = v57;
                v53 = cp2;
                v54 = (int32_t)v53;
                v55 = v58;
                v56 = &v1;
                if (v9 >= v54) {
                    // 0x80fe9d4
                    cp2 = (char *)(v54 + 1);
                    v55 = *v52;
                    v56 = v53;
                }
                // 0x80fe9de
                *v56 = v55;
                v57 = (char *)((int32_t)v52 + 1);
                v58 = *v57;
            }
            // 0x80fe9f7
            v48 = cp;
            v7 = v10;
            if (cp == NULL) {
                goto lab_0x80fea94;
            } else {
                goto lab_0x80fea02;
            }
        } else {
            goto lab_0x80fea02;
        }
    }
  lab_0x80fea02:
    // 0x80fea02
    free((int32_t *)v48);
    cp = NULL;
    v7 = v10;
    goto lab_0x80fea94;
  lab_0x80fea16:;
    char * v59 = cp2; // 0x80fea1f
    uint32_t v60 = (int32_t)v59;
    char * v61 = &v1; // 0x80fea22
    if (v9 >= v60) {
        // 0x80fea2c
        cp2 = (char *)(v60 + 1);
        v61 = v59;
    }
    // 0x80fea36
    *v61 = 37;
    char * v62 = cp2; // 0x80fea45
    uint32_t v63 = (int32_t)v62;
    char * v64 = &v1; // 0x80fea48
    if (v9 >= v63) {
        // 0x80fea52
        cp2 = (char *)(v63 + 1);
        v64 = v62;
    }
    // 0x80fea5c
    *v64 = *v10;
    v7 = v10;
    goto lab_0x80fea94;
  lab_0x80fe7db:;
    char * v65 = cp2; // 0x80fe7e4
    uint32_t v66 = (int32_t)v65;
    char v67 = v5; // 0x80fe7e7
    char * v68 = &v1; // 0x80fe7e7
    if (v9 >= v66) {
        // 0x80fe7f1
        cp2 = (char *)(v66 + 1);
        v67 = *path;
        v68 = v65;
    }
    // 0x80fe7fb
    *v68 = v67;
    char * v69 = (char *)((int32_t)path + 1); // 0x80fe806
    char v70 = *v69; // 0x80fe80d
    v7 = v10;
    while (v70 != 0) {
        char * v71 = v69; // 0x80fe806
        v65 = cp2;
        v66 = (int32_t)v65;
        v67 = v70;
        v68 = &v1;
        if (v9 >= v66) {
            // 0x80fe7f1
            cp2 = (char *)(v66 + 1);
            v67 = *v71;
            v68 = v65;
        }
        // 0x80fe7fb
        *v68 = v67;
        v69 = (char *)((int32_t)v71 + 1);
        v70 = *v69;
        v7 = v10;
    }
    goto lab_0x80fea94;
  lab_0x80fe851:;
    char * v72 = cp2; // 0x80fe85a
    uint32_t v73 = (int32_t)v72;
    char v74 = v6; // 0x80fe85d
    char * v75 = &v1; // 0x80fe85d
    if (v9 >= v73) {
        // 0x80fe867
        cp2 = (char *)(v73 + 1);
        v74 = *dir;
        v75 = v72;
    }
    // 0x80fe871
    *v75 = v74;
    char * v76 = (char *)((int32_t)dir + 1); // 0x80fe87c
    char v77 = *v76; // 0x80fe883
    v7 = v10;
    while (v77 != 0) {
        char * v78 = v76; // 0x80fe87c
        v72 = cp2;
        v73 = (int32_t)v72;
        v74 = v77;
        v75 = &v1;
        if (v9 >= v73) {
            // 0x80fe867
            cp2 = (char *)(v73 + 1);
            v74 = *v78;
            v75 = v72;
        }
        // 0x80fe871
        *v75 = v74;
        v76 = (char *)((int32_t)v78 + 1);
        v77 = *v76;
        v7 = v10;
    }
    goto lab_0x80fea94;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x80feae0 - 0x80feb61
// Line range:    61 - 75
char * HTStrip(char * s) {
    char * v1 = s; // 0x80feb00
    char * v2 = s; // 0x80feb00
    if (*s != 0) {
        v1 = (char *)((int32_t)v1 + 1);
        v2 = v1;
        while (*v1 != 0) {
            // 0x80feaf4
            v1 = (char *)((int32_t)v1 + 1);
            v2 = v1;
        }
    }
    char * v3 = (char *)((int32_t)v2 - 1);
    char * v4 = v3; // 0x80feb36
    if (v3 >= s) {
        while (true) {
          lab_0x80feb08:;
            char v5 = *v4; // 0x80feb0b
            switch (v5) {
                case 32: {
                    goto lab_0x80feb26;
                }
                case 9: {
                    goto lab_0x80feb26;
                }
                default: {
                    if (v5 != 10) {
                        // break -> 0x80feb3e
                        break;
                    }
                    goto lab_0x80feb26;
                }
            }
        }
    }
  lab_0x80feb3e_2:;
    char * v6 = s; // 0x80feae0
    char * result; // 0x80feae0
    while (true) {
      lab_0x80feb3e:
        // 0x80feb3e
        result = v6;
        switch (*result) {
            case 32: {
                // 0x80feb3a
                v6 = (char *)((int32_t)result + 1);
                goto lab_0x80feb3e;
            }
            case 9: {
                // 0x80feb3a
                v6 = (char *)((int32_t)result + 1);
                goto lab_0x80feb3e;
            }
            case 10: {
                // 0x80feb3a
                v6 = (char *)((int32_t)result + 1);
                goto lab_0x80feb3e;
            }
            default: {
                return result;
            }
        }
    }
    // 0x80feb5c
    return result;
  lab_0x80feb26:
    // 0x80feb26
    *v4 = 0;
    v4 = (char *)((int32_t)v4 - 1);
    if (v4 < s) {
        // break -> 0x80feb3e
        goto lab_0x80feb3e_2;
    }
    goto lab_0x80feb08;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x80feb61 - 0x80fedf7
// Line range:    89 - 177
void scan(char * name, int32_t * parts) {
    int32_t v1 = (int32_t)parts;
    *parts = 0;
    int32_t * str = (int32_t *)(v1 + 4); // 0x80feb73
    *str = 0;
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x80feb7d
    *v2 = 0;
    int32_t * v3 = (int32_t *)(v1 + 12); // 0x80feb87
    *v3 = 0;
    int32_t * v4 = (int32_t *)(v1 + 16); // 0x80feb91
    *v4 = 0;
    int32_t * v5 = (int32_t *)(v1 + 20); // 0x80feb9b
    *v5 = 0;
    char * after_access = name;
    char v6 = *name; // 0x80fec02
    int32_t v7 = (int32_t)name;
    char v8 = v6; // 0x80fec07
    char * v9 = name; // 0x80fec07
    char * v10 = name; // 0x80fec07
    int32_t v11 = v7; // 0x80fec07
    if (v6 != 0) {
        char * v12; // 0x80feb61
        while (true) {
          lab_0x80febb0:
            // 0x80febb0
            v12 = v9;
            if (v8 == 58) {
                // break -> 0x80febba
                break;
            }
            unsigned char v13 = v8 - 35;
            v10 = name;
            v11 = v7;
            switch (v13 / 4 || 64 * v13) {
                case 3: {
                    goto lab_0x80fec09;
                }
                case 0: {
                    goto lab_0x80fec09;
                }
                case 6: {
                    goto lab_0x80fec09;
                }
                case 7: {
                    goto lab_0x80fec09;
                }
                default: {
                    // 0x80febfb
                    v9 = (char *)((int32_t)v12 + 1);
                    after_access = v9;
                    v8 = *v9;
                    v10 = name;
                    v11 = v7;
                    if (v8 == 0) {
                        goto lab_0x80fec09;
                    }
                    goto lab_0x80febb0;
                }
            }
        }
        // 0x80febba
        *v12 = 0;
        *parts = v7;
        int32_t v14 = (int32_t)after_access + 1; // 0x80febcb
        v10 = (char *)v14;
        v11 = v14;
    }
  lab_0x80fec09:
    // 0x80fec09
    *(int32_t *)&after_access = v11;
    char v15 = *v10; // 0x80fec36
    char v16 = v15; // 0x80fec3b
    int32_t v17 = v11; // 0x80fec3b
    if (v15 != 0) {
        char * v18 = v10;
        int32_t v19 = (int32_t)v18 + 1;
        while (v16 != 35) {
            char * v20 = (char *)v19;
            char v21 = *v20; // 0x80fec36
            v16 = v21;
            if (v21 == 0) {
                // 0x80fec33
                after_access = v20;
                v17 = v11;
                goto lab_0x80fec3d;
            }
            v18 = v20;
            v19 = (int32_t)v18 + 1;
        }
        // 0x80fec1b
        after_access = v18;
        *v5 = v19;
        *after_access = 0;
        v17 = (int32_t)v10;
    }
    goto lab_0x80fec3d;
  lab_0x80fec3d:
    // 0x80fec3d
    after_access = v10;
    char v22 = *v10; // 0x80fec46
    if (v22 != 47) {
        // 0x80fece4
        *v3 = v22 == 0 ? 0 : v17;
    } else {
        int32_t v23 = (int32_t)v10; // 0x80fec51
        int32_t v24 = v23 + 1; // 0x80fec54
        if (*(char *)v24 != 47) {
            // 0x80fecd6
            *v2 = v24;
        } else {
            // 0x80fec5e
            *str = v23 + 2;
            *after_access = 0;
            char * found_char_pos = strchr((char *)*str, 47); // 0x80fec81
            after_access = found_char_pos;
            if (found_char_pos == NULL) {
                char * found_char_pos2 = strchr((char *)*str, 63); // 0x80fecb4
                after_access = found_char_pos2;
                if (found_char_pos2 != NULL) {
                    // 0x80fecc2
                    *found_char_pos2 = 0;
                    *v4 = (int32_t)found_char_pos2 + 1;
                }
            } else {
                // 0x80fec8f
                *found_char_pos = 0;
                *v2 = (int32_t)found_char_pos + 1;
            }
        }
    }
    int32_t c = *parts; // 0x80fed09
    if (c == 0 || *v5 == 0 || strchr("lnsdLNSD", (int32_t)*(char *)c) == NULL) {
        // 0x80fedf5
        return;
    }
    // 0x80fed44
    if (*str != 0) {
        goto lab_0x80fed67;
    } else {
        // 0x80fed4e
        if (strcasecomp((char *)*parts, "lynxcgi") != 0) {
            goto lab_0x80fedcb;
        } else {
            goto lab_0x80fed67;
        }
    }
  lab_0x80fed67:
    // 0x80fed67
    if (strcasecomp((char *)*parts, "nntp") != 0) {
        // 0x80fed80
        if (strcasecomp((char *)*parts, "snews") != 0) {
            // 0x80fed99
            if (strcasecomp((char *)*parts, "news") != 0) {
                // 0x80fedb2
                if (strcasecomp((char *)*parts, "data") != 0) {
                    // 0x80fedf5
                    return;
                }
            }
        }
    }
    goto lab_0x80fedcb;
  lab_0x80fedcb:
    // 0x80fedcb
    if (*v3 == 0) {
        // 0x80fedd5
        if (*v2 == 0) {
            // 0x80fedf5
            return;
        }
    }
    // 0x80feddf
    *(char *)(*v5 - 1) = 35;
    *v5 = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x80fedf7 - 0x80fee2e
// Line range:    188 - 195
char * strchr_or_end(char * string, int32_t ch) {
    char * found_char_pos = strchr(string, ch); // 0x80fee0a
    char * result = found_char_pos; // 0x80fee16
    if (found_char_pos == NULL) {
        // 0x80fee18
        result = (char *)(strlen(string) + (int32_t)string);
    }
    // 0x80fee29
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x80fee2e - 0x80fef59
// Line range:    206 - 235
char * HTParsePort(char * host, int32_t * portp) {
    // 0x80fee2e
    *portp = 0;
    if (host == NULL) {
        // 0x80fef50
        return (char *)0;
    }
    char v1 = *host; // 0x80fef3f
    if (v1 == 0) {
        // 0x80fef50
        return (char *)0;
    }
    int32_t v2 = 0;
    int32_t v3 = (int32_t)host; // 0x80fee67
    int32_t v4 = v3 + 1; // 0x80fee67
    char * str = (char *)v4; // 0x80fee67
    int32_t v5; // 0x80fee2e
    int32_t brackets; // bp-20, 0x80fee2e
    int32_t v6; // 0x80fee2e
    int32_t str_as_l; // 0x80feed7
    int32_t v7; // 0x80feee3
    int16_t v8; // 0x80feea8
    switch (v1) {
        case 91: {
            // 0x80fef32
            v5 = 0;
            v6 = v2 + 1;
            // break -> 0x80fef3c
            break;
        }
        case 93: {
            // 0x80fef38
            v5 = 0;
            v6 = v2 - 1;
            // break -> 0x80fef3c
            break;
        }
        default: {
            // 0x80fee7f
            v5 = 0;
            v6 = v2;
            if (v1 == 58 == v2 == 0) {
                // 0x80fee93
                v8 = *(int16_t *)(2 * (int32_t)*str + (int32_t)*__ctype_b_loc());
                v5 = 0;
                v6 = 0;
                if ((v8 & 2048) != 0) {
                    // 0x80feebb
                    brackets = 0;
                    str_as_l = strtol(str, (char **)&brackets, 10);
                    *portp = str_as_l;
                    v7 = brackets;
                    v5 = 0;
                    v6 = 0;
                    if (v7 != 0 && v7 != v4) {
                        // 0x80feef2
                        v5 = 0;
                        v6 = 0;
                        if (*(char *)v7 == 0) {
                            // 0x80feefc
                            v5 = v3;
                            v6 = 0;
                            if (WWW_TraceFlag != 0) {
                                // 0x80fef10
                                fprintf(TraceFP(), "HTParsePort %d\n", str_as_l);
                                v5 = v3;
                                v6 = 0;
                            }
                        }
                    }
                }
            }
            // break -> 0x80fef3c
            break;
        }
    }
    char v9 = *str; // 0x80fef3f
    while (v5 == 0 == (v9 != 0)) {
        // 0x80fee5b
        v2 = v6;
        char v10 = v9;
        v3 = (int32_t)str;
        v4 = v3 + 1;
        str = (char *)v4;
        switch (v10) {
            case 91: {
                // 0x80fef32
                v5 = 0;
                v6 = v2 + 1;
                // break -> 0x80fef3c
                break;
            }
            case 93: {
                // 0x80fef38
                v5 = 0;
                v6 = v2 - 1;
                // break -> 0x80fef3c
                break;
            }
            default: {
                // 0x80fee7f
                v5 = 0;
                v6 = v2;
                if (v10 == 58 == v2 == 0) {
                    // 0x80fee93
                    v8 = *(int16_t *)(2 * (int32_t)*str + (int32_t)*__ctype_b_loc());
                    v5 = 0;
                    v6 = 0;
                    if ((v8 & 2048) != 0) {
                        // 0x80feebb
                        brackets = 0;
                        str_as_l = strtol(str, (char **)&brackets, 10);
                        *portp = str_as_l;
                        v7 = brackets;
                        v5 = 0;
                        v6 = 0;
                        if (v7 != 0 && v7 != v4) {
                            // 0x80feef2
                            v5 = 0;
                            v6 = 0;
                            if (*(char *)v7 == 0) {
                                // 0x80feefc
                                v5 = v3;
                                v6 = 0;
                                if (WWW_TraceFlag != 0) {
                                    // 0x80fef10
                                    fprintf(TraceFP(), "HTParsePort %d\n", str_as_l);
                                    v5 = v3;
                                    v6 = 0;
                                }
                            }
                        }
                    }
                }
                // break -> 0x80fef3c
                break;
            }
        }
        // 0x80fef3c
        v9 = *str;
    }
    // 0x80fef50
    return (char *)v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x80fef59 - 0x80ffeac
// Line range:    254 - 657
char * HTParse(char * aName, char * relatedName, int32_t wanted) {
    // 0x80fef59
    int32_t v1; // 0x80fef59
    int32_t v2 = v1;
    int32_t v3 = __readgsdword(20); // 0x80fef75
    char * result = NULL; // bp-24, 0x80fef8e
    char * v4; // bp-236, 0x80fef59
    if (WWW_TraceFlag != 0) {
        struct _IO_FILE * stream = TraceFP(); // 0x80fefae
        v4 = (char *)stream;
        fprintf(stream, "HTParse: aName:`%s'\n", aName);
        if (WWW_TraceFlag != 0) {
            struct _IO_FILE * stream2 = TraceFP(); // 0x80fefda
            v4 = (char *)stream2;
            fprintf(stream2, "   relatedName:`%s'\n", relatedName);
        }
    }
    int32_t v5 = wanted & 96; // 0x80feffe
    int32_t v6 = wanted; // 0x80ff003
    if (v5 != 0) {
        int32_t v7 = v5 != 96 ? wanted : wanted | 4;
        v6 = (v7 & 4) == 0 ? v7 : v7 & -97;
    }
    // 0x80ff022
    if (WWW_TraceFlag != 0) {
        char * v8 = (v6 & 64) == 0 ? (char *)&g69 : " QUERY";
        char * v9 = (v6 & 32) == 0 ? (char *)&g69 : " PATH";
        char * v10 = (v6 & 16) == 0 ? (char *)&g69 : " access";
        char * v11 = (v6 & 8) == 0 ? (char *)&g69 : " host";
        char * v12 = (v6 & 4) == 0 ? (char *)&g69 : " path";
        char * v13 = (v6 & 2) == 0 ? (char *)&g69 : " anchor";
        char * v14 = v6 % 2 == 0 ? (char *)&g69 : " punc";
        struct _IO_FILE * stream3 = TraceFP(); // 0x80ff111
        v4 = (char *)stream3;
        fprintf(stream3, "   want:%s%s%s%s%s%s%s\n", v14, v13, v12, v11, v10, v9, v8);
    }
    int32_t v15 = (int32_t)aName;
    int32_t v16 = (int32_t)relatedName;
    *(int32_t *)&v4 = v15;
    int32_t v17 = strlen(aName) + 1; // 0x80ff17c
    *(int32_t *)&v4 = v16;
    int32_t v18 = strlen(relatedName) + 1; // 0x80ff190
    int32_t v19 = v18 + v17;
    int32_t v20 = v19 + 8; // 0x80ff19e
    int32_t v21 = (int32_t)&v4 - (v19 + 30 + 2 * v20 & -16); // 0x80ff1bb
    int32_t v22 = v21 + 51 & -16; // 0x80ff1d0
    char * v23 = (char *)v22; // 0x80ff1e2
    if (v22 == 0) {
        // 0x80ff1f1
        *(int32_t *)(v21 + 4) = (int32_t)"HTParse";
        *(int32_t *)v21 = (int32_t)"../../../WWW/Library/Implementation/HTParse.c";
        outofmem((char *)v20, v23);
        // UNREACHABLE
    }
    // 0x80ff205
    *v23 = 0;
    int32_t v24 = v22 + v20; // 0x80ff211
    int32_t v25 = v24 + v17; // 0x80ff21c
    int32_t * v26 = (int32_t *)(v21 + 8); // 0x80ff224
    *v26 = v17;
    int32_t * v27 = (int32_t *)(v21 + 4); // 0x80ff22e
    *v27 = v15;
    int32_t * v28 = (int32_t *)v21; // 0x80ff235
    *v28 = v24;
    memcpy((int32_t *)v25, &g391, (int32_t)&g391);
    int32_t v29; // bp-104, 0x80fef59
    *v27 = (int32_t)&v29;
    *v28 = v24;
    scan((char *)&g391, &g391);
    int32_t v30; // 0x80fef59
    int32_t v31; // bp-128, 0x80fef59
    if (v1 != 0 == (v2 != 0 && v29 != 0)) {
        goto lab_0x80ff271;
    } else {
        // 0x80ff264
        if (*relatedName != 0) {
            // 0x80ff29d
            *v26 = v18;
            *v27 = v16;
            *v28 = v25;
            memcpy(&g391, &g391, (int32_t)&g391);
            *v27 = (int32_t)&v31;
            *v28 = v25;
            scan((char *)&g391, &g391);
            v30 = v29;
            goto lab_0x80ff2cb;
        } else {
            goto lab_0x80ff271;
        }
    }
  lab_0x80ff271:
    // 0x80ff271
    v31 = 0;
    v30 = v29;
    int32_t v32 = 0; // 0x80ff29b
    int32_t v33 = 0; // 0x80ff29b
    int32_t v34 = 0; // 0x80ff29b
    int32_t v35 = 0; // 0x80ff29b
    goto lab_0x80ff2cb;
  lab_0x80ff2cb:;
    // 0x80ff2cb
    int32_t v36; // 0x80fef59
    char * v37; // 0x80fef59
    if (v37 == NULL != (v1 == 0) || v2 == 0 || v30 == 0) {
        goto lab_0x80ff333;
    } else {
        // 0x80ff2e7
        *v27 = (int32_t)"http";
        *v28 = v30;
        if (strcmp((char *)&g391, (char *)&g391) == 0) {
            // 0x80ff32c
            v36 = &g154;
            goto lab_0x80ff333;
        } else {
            // 0x80ff2fe
            *v27 = (int32_t)"https";
            *v28 = v29;
            if (strcmp((char *)&g391, (char *)&g391) == 0) {
                // 0x80ff32c
                v36 = &g154;
                goto lab_0x80ff333;
            } else {
                // 0x80ff315
                *v27 = (int32_t)"ftp";
                *v28 = v29;
                int32_t strcmp_rc = strcmp((char *)&g391, (char *)&g391); // 0x80ff323
                v36 = 0;
                if (strcmp_rc != 0) {
                    goto lab_0x80ff333;
                } else {
                    // 0x80ff32c
                    v36 = &g154;
                    goto lab_0x80ff333;
                }
            }
        }
    }
  lab_0x80ff333:;
    int32_t v38 = v29;
    int32_t str = v38 == 0 ? v31 : v38;
    char * p; // bp-56, 0x80fef59
    *(int32_t *)&p = str;
    char * v39 = v23; // 0x80ff35f
    if ((v6 & 16) != 0 && str != 0) {
        // 0x80ff367
        *v27 = str;
        *v28 = v22;
        strcpy((char *)str, (char *)&g391);
        *v28 = v22;
        int32_t v40 = strlen((char *)&g391) + v22; // 0x80ff384
        char * v41 = (char *)v40; // 0x80ff384
        v39 = v41;
        if (v6 % 2 != 0) {
            // 0x80ff391
            *v41 = 58;
            char * v42 = (char *)(v40 + 1); // 0x80ff397
            *v42 = 0;
            v39 = v42;
        }
    }
    int32_t v43 = v32; // 0x80ff3a6
    int32_t v44 = v33; // 0x80ff3a6
    int32_t v45 = v34; // 0x80ff3a6
    int32_t v46 = v35; // 0x80ff3a6
    if (v29 != 0 && v31 != 0) {
        // 0x80ff3af
        *v27 = v31;
        *v28 = v29;
        int32_t strcmp_rc2 = strcmp((char *)&g391, (char *)&g391); // 0x80ff3bc
        v43 = strcmp_rc2 == 0 ? v32 : 0;
        v44 = strcmp_rc2 == 0 ? v33 : 0;
        v45 = strcmp_rc2 == 0 ? v34 : 0;
        v46 = strcmp_rc2 == 0 ? v35 : 0;
    }
    // 0x80ff3e8
    char * v47; // 0x80fef59
    char * found_char_pos; // 0x80ff464
    char * str3; // 0x80ff488
    if ((v6 & 8) == 0 || (v43 || v2) == 0) {
        goto lab_0x80ff76e;
    } else {
        // 0x80ff408
        v47 = v39;
        if (v6 % 2 != 0) {
            // 0x80ff412
            *v39 = 47;
            int32_t v48 = (int32_t)v39; // 0x80ff418
            *(char *)(v48 + 1) = 47;
            v47 = (char *)(v48 + 2);
        }
        int32_t str2 = v2 == 0 ? v43 : v2;
        *v27 = str2;
        *v28 = (int32_t)v47;
        strcpy((char *)str2, (char *)&g391);
        *v27 = 64;
        *v28 = v22;
        found_char_pos = strchr((char *)&g391, (int32_t)&g391);
        int32_t v49; // bp-68, 0x80fef59
        *v27 = (int32_t)&v49;
        *v28 = v22;
        str3 = HTParsePort(found_char_pos, &g391);
        if (str3 == NULL || p == NULL) {
            goto lab_0x80ff6f5;
        } else {
            // 0x80ff4a4
            *v27 = (int32_t)"http";
            *v28 = (int32_t)p;
            if (strcmp(str3, (char *)&g391) == 0 == v49 == 80) {
                // 0x80ff6ef
                *str3 = 0;
                goto lab_0x80ff6f5;
            } else {
                // 0x80ff4c7
                *v27 = (int32_t)"https";
                *v28 = (int32_t)p;
                if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 443) {
                    // 0x80ff6ef
                    *str3 = 0;
                    goto lab_0x80ff6f5;
                } else {
                    // 0x80ff4ec
                    *v27 = (int32_t)"gopher";
                    *v28 = (int32_t)p;
                    if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 70) {
                        // 0x80ff6ef
                        *str3 = 0;
                        goto lab_0x80ff6f5;
                    } else {
                        // 0x80ff50f
                        *v27 = (int32_t)"ftp";
                        *v28 = (int32_t)p;
                        if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 21) {
                            // 0x80ff6ef
                            *str3 = 0;
                            goto lab_0x80ff6f5;
                        } else {
                            // 0x80ff532
                            *v27 = (int32_t)"wais";
                            *v28 = (int32_t)p;
                            if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 210) {
                                // 0x80ff6ef
                                *str3 = 0;
                                goto lab_0x80ff6f5;
                            } else {
                                // 0x80ff557
                                *v27 = (int32_t)"nntp";
                                *v28 = (int32_t)p;
                                if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 119) {
                                    // 0x80ff6ef
                                    *str3 = 0;
                                    goto lab_0x80ff6f5;
                                } else {
                                    // 0x80ff57a
                                    *v27 = (int32_t)"news";
                                    *v28 = (int32_t)p;
                                    if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 119) {
                                        // 0x80ff6ef
                                        *str3 = 0;
                                        goto lab_0x80ff6f5;
                                    } else {
                                        // 0x80ff59d
                                        *v27 = (int32_t)"newspost";
                                        *v28 = (int32_t)p;
                                        if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 119) {
                                            // 0x80ff6ef
                                            *str3 = 0;
                                            goto lab_0x80ff6f5;
                                        } else {
                                            // 0x80ff5c0
                                            *v27 = (int32_t)"newsreply";
                                            *v28 = (int32_t)p;
                                            if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 119) {
                                                // 0x80ff6ef
                                                *str3 = 0;
                                                goto lab_0x80ff6f5;
                                            } else {
                                                // 0x80ff5e3
                                                *v27 = (int32_t)"snews";
                                                *v28 = (int32_t)p;
                                                if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 563) {
                                                    // 0x80ff6ef
                                                    *str3 = 0;
                                                    goto lab_0x80ff6f5;
                                                } else {
                                                    // 0x80ff608
                                                    *v27 = (int32_t)"snewspost";
                                                    *v28 = (int32_t)p;
                                                    if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 563) {
                                                        // 0x80ff6ef
                                                        *str3 = 0;
                                                        goto lab_0x80ff6f5;
                                                    } else {
                                                        // 0x80ff62d
                                                        *v27 = (int32_t)"snewsreply";
                                                        *v28 = (int32_t)p;
                                                        if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 563) {
                                                            // 0x80ff6ef
                                                            *str3 = 0;
                                                            goto lab_0x80ff6f5;
                                                        } else {
                                                            // 0x80ff652
                                                            *v27 = (int32_t)"finger";
                                                            *v28 = (int32_t)p;
                                                            if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 79) {
                                                                // 0x80ff6ef
                                                                *str3 = 0;
                                                                goto lab_0x80ff6f5;
                                                            } else {
                                                                // 0x80ff671
                                                                *v27 = (int32_t)"telnet";
                                                                *v28 = (int32_t)p;
                                                                if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 23) {
                                                                    // 0x80ff6ef
                                                                    *str3 = 0;
                                                                    goto lab_0x80ff6f5;
                                                                } else {
                                                                    // 0x80ff690
                                                                    *v27 = (int32_t)"tn3270";
                                                                    *v28 = (int32_t)p;
                                                                    if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 23) {
                                                                        // 0x80ff6ef
                                                                        *str3 = 0;
                                                                        goto lab_0x80ff6f5;
                                                                    } else {
                                                                        // 0x80ff6af
                                                                        *v27 = (int32_t)"rlogin";
                                                                        *v28 = (int32_t)p;
                                                                        if (strcmp((char *)&g391, (char *)&g391) == 0 == v49 == 513) {
                                                                            // 0x80ff6ef
                                                                            *str3 = 0;
                                                                            goto lab_0x80ff6f5;
                                                                        } else {
                                                                            // 0x80ff6d0
                                                                            *v27 = (int32_t)"cso";
                                                                            *v28 = (int32_t)p;
                                                                            if (strcmp((char *)&g391, (char *)&g391) != 0) {
                                                                                goto lab_0x80ff6f5;
                                                                            } else {
                                                                                // 0x80ff6e7
                                                                                if (v49 != 105) {
                                                                                    goto lab_0x80ff6f5;
                                                                                } else {
                                                                                    // 0x80ff6ef
                                                                                    *str3 = 0;
                                                                                    goto lab_0x80ff6f5;
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x80ff76e:
    // 0x80ff76e
    *v28 = v22;
    char * str4 = LYRemoveBlanks((char *)&g391); // 0x80ff774
    int32_t v50; // 0x80fef59
    int32_t v51; // 0x80fef59
    if (v1 == 0) {
        goto lab_0x80ff7a1;
    } else {
        int32_t v52 = v1 - 1; // 0x80ff786
        char * v53 = (char *)v52; // 0x80ff789
        if (*v53 != 0) {
            goto lab_0x80ff7a1;
        } else {
            // 0x80ff790
            *v53 = 63;
            v51 = v52;
            v50 = v44;
            goto lab_0x80ff7cb;
        }
    }
  lab_0x80ff7a1:
    // 0x80ff7a1
    v51 = v36;
    v50 = v44;
    if (v44 == 0 && v46 != 0) {
        int32_t v54 = v46 - 1; // 0x80ff7b2
        char * v55 = (char *)v54; // 0x80ff7b5
        v51 = v36;
        v50 = v44;
        if (*v55 == 0) {
            // 0x80ff7bc
            *v55 = 63;
            v51 = v36;
            v50 = v54;
        }
    }
    goto lab_0x80ff7cb;
  lab_0x80ff6f5:
    if (str3 != NULL) {
        if (str3 != v23) {
            char * v116 = (char *)((int32_t)str3 - 1); // 0x80ff73b
            if (*v116 == 46) {
                char v117 = *str3; // 0x80ff761
                char * v118 = v116; // 0x80ff766
                if (v117 != 0) {
                    *v116 = v117;
                    char * v119 = (char *)((int32_t)v116 + 1);
                    char * v120 = (char *)((int32_t)str3 + 1); // 0x80ff75a
                    char v121 = *v120; // 0x80ff761
                    char * v122 = v119; // 0x80ff766
                    char * v123 = v120; // 0x80ff766
                    v118 = v119;
                    while (v121 != 0) {
                        // 0x80ff74b
                        *v122 = v121;
                        v119 = (char *)((int32_t)v122 + 1);
                        v120 = (char *)((int32_t)v123 + 1);
                        v121 = *v120;
                        v122 = v119;
                        v123 = v120;
                        v118 = v119;
                    }
                }
                // 0x80ff768
                *v118 = 0;
            }
        }
    } else {
        char * v124 = found_char_pos == NULL ? v47 : (char *)((int32_t)found_char_pos + 1);
        int32_t v125 = (int32_t)v124; // 0x80ff6fb
        *v28 = v125;
        uint32_t len2 = strlen((char *)&g391); // 0x80ff701
        if (len2 >= 1) {
            char * v126 = (char *)(v125 - 1 + len2); // 0x80ff718
            if (*v126 == 46) {
                // 0x80ff725
                *v126 = 0;
            }
        }
    }
    goto lab_0x80ff76e;
  lab_0x80ff7cb:;
    int32_t v56 = v50; // 0x80ff7d0
    int32_t v57 = v45; // 0x80ff7d0
    if (v2 != 0 && v43 != 0) {
        // 0x80ff7d9
        *v27 = v43;
        int32_t strcmp_rc3 = strcmp(str4, (char *)&g391); // 0x80ff7e6
        v56 = strcmp_rc3 == 0 ? v50 : 0;
        v57 = strcmp_rc3 == 0 ? v45 : 0;
    }
    char * v58 = str4; // 0x80ff80c
    int32_t v59; // 0x80fef59
    char * v60; // 0x80ff844
    if ((v6 & 100) == 0) {
        goto lab_0x80ffc76;
    } else {
        // 0x80ff812
        v59 = v51;
        if (p == NULL) {
            goto lab_0x80ff905;
        } else {
            // 0x80ff825
            v59 = v51;
            if (v37 == NULL || v51 != 0) {
                goto lab_0x80ff905;
            } else {
                char v61 = *p; // 0x80ff83e
                int32_t v62 = v61; // 0x80ff841
                v60 = (char *)v62;
                if (v61 == 83) {
                    goto lab_0x80ff8e1;
                } else {
                    if (v60 > (char *)83) {
                        // 0x80ff86e
                        v59 = v51;
                        switch (v62) {
                            case 110: {
                                goto lab_0x80ff885;
                            }
                            case 115: {
                                goto lab_0x80ff8e1;
                            }
                            default: {
                                goto lab_0x80ff905;
                            }
                        }
                    } else {
                        // 0x80ff860
                        v59 = v51;
                        if (v60 == (char *)78) {
                            goto lab_0x80ff885;
                        } else {
                            goto lab_0x80ff905;
                        }
                    }
                }
            }
        }
    }
  lab_0x80ffc76:
    if (v37 != NULL && (v6 & 2) != 0) {
        // 0x80ffc87
        if (*v37 != 0) {
            int32_t v63 = (int32_t)v58; // 0x80ffc91
            *v28 = v63;
            int32_t v64 = strlen((char *)&g391) + v63; // 0x80ffc9c
            char * v65 = (char *)v64; // 0x80ffc9c
            char * str5 = v65; // 0x80ffca7
            if (v6 % 2 != 0) {
                // 0x80ffca9
                *v65 = 35;
                str5 = (char *)(v64 + 1);
            }
            // 0x80ffcb3
            *v27 = (int32_t)v37;
            *v28 = (int32_t)str5;
            strcpy(str5, (char *)&g391);
        }
    }
    // 0x80ffcc5
    *v27 = 32;
    *v28 = v22;
    char * found_char_pos2 = strchr((char *)&g391, (int32_t)&g391); // 0x80ffcd3
    if (found_char_pos2 == NULL) {
        goto lab_0x80ffe02;
    } else {
        // 0x80ffce5
        *v28 = v22;
        int32_t v66 = is_url(found_char_pos2); // 0x80ffceb
        g392 = v66;
        switch (v66) {
            case 1: {
                // 0x80ffd0e
                if (WWW_TraceFlag == 0) {
                    goto lab_0x80ffe2b;
                } else {
                    struct _IO_FILE * v67 = TraceFP(); // 0x80ffd1d
                    *v26 = v22;
                    *v27 = (int32_t)"HTParse:      ignore:`%s'\n";
                    *v28 = (int32_t)v67;
                    fprintf((struct _IO_FILE *)&g391, (char *)&g391);
                    goto lab_0x80ffe02;
                }
            }
            case 25: {
                goto lab_0x80ffd40;
            }
            case 26: {
                goto lab_0x80ffd40;
            }
            case 27: {
                goto lab_0x80ffd40;
            }
            case 32: {
                goto lab_0x80ffd40;
            }
            case 33: {
                goto lab_0x80ffd40;
            }
            case 34: {
                goto lab_0x80ffd40;
            }
            case 35: {
                goto lab_0x80ffd40;
            }
            case 36: {
                goto lab_0x80ffd40;
            }
            case 37: {
                goto lab_0x80ffd40;
            }
            case 38: {
                goto lab_0x80ffd40;
            }
            case 39: {
                goto lab_0x80ffd40;
            }
            case 40: {
                goto lab_0x80ffd40;
            }
            case 41: {
                goto lab_0x80ffd40;
            }
            case 42: {
                goto lab_0x80ffd40;
            }
            case 43: {
                goto lab_0x80ffd40;
            }
            default: {
                // 0x80ffd72
                if (WWW_TraceFlag != 0) {
                    struct _IO_FILE * v68 = TraceFP(); // 0x80ffd7d
                    *v26 = v22;
                    *v27 = (int32_t)"HTParse:      encode:`%s'\n";
                    *v28 = (int32_t)v68;
                    fprintf((struct _IO_FILE *)&g391, (char *)&g391);
                }
                int32_t v69 = (int32_t)found_char_pos2; // 0x80ffd9b
                *v28 = v69;
                int32_t len = strlen((char *)&g391); // 0x80ffda1
                int32_t v70 = v69 + 2;
                int32_t v71 = v70 + len; // 0x80ffda9
                char * v72 = (char *)v71;
                int32_t v73 = v69 + 1; // 0x80ffdc6
                char * v74 = v72; // 0x80ffdcc
                int32_t v75 = v71; // 0x80ffdcc
                char * str6 = v72; // 0x80ffdcc
                char * v76; // 0x80fef59
                int32_t v77; // 0x80ffdbf
                if (v73 != v71) {
                    *v74 = *(char *)(v75 - 2);
                    v77 = v75 - 1;
                    v76 = (char *)v77;
                    v75 = v77;
                    str6 = v76;
                    while (v73 != v77) {
                        // 0x80ffdb1
                        *v76 = *(char *)(v75 - 2);
                        v77 = v75 - 1;
                        v76 = (char *)v77;
                        v75 = v77;
                        str6 = v76;
                    }
                }
                // 0x80ffdce
                *found_char_pos2 = 37;
                *(char *)v73 = 50;
                *(char *)v70 = 48;
                *v27 = 32;
                *v28 = v22;
                char * found_char_pos3 = strchr(str6, (int32_t)&g391); // 0x80ffdf4
                while (found_char_pos3 != NULL) {
                    // 0x80ffd9b
                    v69 = (int32_t)found_char_pos3;
                    *v28 = v69;
                    len = strlen((char *)&g391);
                    v70 = v69 + 2;
                    v71 = v70 + len;
                    v72 = (char *)v71;
                    v73 = v69 + 1;
                    v74 = v72;
                    v75 = v71;
                    str6 = v72;
                    if (v73 != v71) {
                        *v74 = *(char *)(v75 - 2);
                        v77 = v75 - 1;
                        v76 = (char *)v77;
                        v75 = v77;
                        str6 = v76;
                        while (v73 != v77) {
                            // 0x80ffdb1
                            *v76 = *(char *)(v75 - 2);
                            v77 = v75 - 1;
                            v76 = (char *)v77;
                            v75 = v77;
                            str6 = v76;
                        }
                    }
                    // 0x80ffdce
                    *found_char_pos3 = 37;
                    *(char *)v73 = 50;
                    *(char *)v70 = 48;
                    *v27 = 32;
                    *v28 = v22;
                    found_char_pos3 = strchr(str6, (int32_t)&g391);
                }
                goto lab_0x80ffe02;
            }
        }
    }
  lab_0x80ffe02:
    // 0x80ffe02
    if (WWW_TraceFlag != 0) {
        struct _IO_FILE * v78 = TraceFP(); // 0x80ffe0d
        *v26 = v22;
        *v27 = (int32_t)"HTParse:      result:`%s'\n";
        *v28 = (int32_t)v78;
        fprintf((struct _IO_FILE *)&g391, (char *)&g391);
    }
    goto lab_0x80ffe2b;
  lab_0x80ff905:;
    // 0x80ff905
    char v86; // 0x80fef59
    char * v87; // 0x80fef59
    char * v83; // 0x80fef59
    char * v85; // 0x80fef59
    if (v59 == 0) {
        // 0x80ff95d
        if (v56 == 0) {
            if (v85 == NULL) {
                if (v57 == 0) {
                    char v88 = *aName; // 0x80ffb38
                    v86 = v88;
                    if (v88 != 108 == (v88 != 76)) {
                        goto lab_0x80ffb72;
                    } else {
                        // 0x80ffb4c
                        *v26 = 8;
                        *v27 = (int32_t)"lynxcgi:";
                        *v28 = v15;
                        int32_t v89 = strncasecomp((char *)&g391, (char *)&g391, (int32_t)&g391); // 0x80ffb65
                        v87 = str4;
                        if (v89 == 0) {
                            goto lab_0x80ffbfa;
                        } else {
                            // 0x80ffb4c
                            v86 = *aName;
                            goto lab_0x80ffb72;
                        }
                    }
                } else {
                    // 0x80ffaf5
                    *v27 = v57;
                    *v28 = (int32_t)str4;
                    strcpy((char *)&g391, (char *)&g391);
                    v83 = str4;
                    if (WWW_TraceFlag != 0) {
                        struct _IO_FILE * v90 = TraceFP(); // 0x80ffb16
                        *v27 = (int32_t)"HTParse: (Related-REL)\n";
                        *v28 = (int32_t)v90;
                        fprintf((struct _IO_FILE *)&g391, (char *)&g391);
                        v83 = str4;
                    }
                    goto lab_0x80ffc3c;
                }
            } else {
                // 0x80ffab1
                *v27 = (int32_t)v85;
                *v28 = (int32_t)str4;
                strcpy((char *)&g391, (char *)&g391);
                v83 = str4;
                if (WWW_TraceFlag != 0) {
                    struct _IO_FILE * v91 = TraceFP(); // 0x80ffad2
                    *v27 = (int32_t)"HTParse: (REL)\n";
                    *v28 = (int32_t)v91;
                    fprintf((struct _IO_FILE *)&g391, (char *)&g391);
                    v83 = str4;
                }
                goto lab_0x80ffc3c;
            }
        } else {
            // 0x80ff968
            *str4 = 47;
            int32_t v92 = (int32_t)str4; // 0x80ff974
            int32_t v93 = v92 + 1; // 0x80ff974
            *v27 = v56;
            *v28 = v93;
            strcpy(str4, (char *)&g391);
            if (v85 != NULL) {
                char v94 = *v85; // 0x80ff998
                if (v94 != 59) {
                    if (v94 != 63) {
                        // 0x80ff9f4
                        *v27 = 63;
                        *v28 = v93;
                        char * found_char_pos5 = strchr((char *)&g391, (int32_t)&g391); // 0x80ffa02
                        char * v95 = found_char_pos5; // 0x80ffa0e
                        if (found_char_pos5 == NULL) {
                            // 0x80ffa10
                            *v28 = v93;
                            v95 = (char *)(strlen(found_char_pos5) + v92);
                        }
                        int32_t v96 = (int32_t)v95;
                        char * str7 = v95; // 0x80ffa32
                        int32_t v97 = v96; // 0x80ffa32
                        if (*v95 != 47) {
                            int32_t v98 = v96 - 1; // 0x80ffa26
                            char * v99 = (char *)v98;
                            int32_t v100 = v98; // 0x80ffa32
                            str7 = v99;
                            v97 = v98;
                            while (*v99 != 47) {
                                // 0x80ffa26
                                v98 = v100 - 1;
                                v99 = (char *)v98;
                                v100 = v98;
                                str7 = v99;
                                v97 = v98;
                            }
                        }
                        // 0x80ffa34
                        *(char *)(v97 + 1) = 0;
                        *v27 = (int32_t)v85;
                        *v28 = v97;
                        strcat(str7, (char *)&g391);
                    } else {
                        // 0x80ff9d0
                        *v27 = 63;
                        *v28 = v93;
                        char * v101 = strchr_or_end((char *)&g391, (int32_t)&g391); // 0x80ff9e1
                        *v27 = (int32_t)v85;
                        *v28 = (int32_t)v101;
                        strcpy((char *)&g391, (char *)&g391);
                    }
                } else {
                    // 0x80ff99f
                    *v27 = 59;
                    *v28 = v93;
                    char * v102 = strchr_or_end((char *)&g391, (int32_t)&g391); // 0x80ff9b0
                    *v27 = (int32_t)v85;
                    *v28 = (int32_t)v102;
                    strcpy((char *)&g391, (char *)&g391);
                }
                // 0x80ffa4f
                *v28 = v92;
                HTSimplify((char *)&g391);
                if (*str4 == 0) {
                    // 0x80ffa64
                    *v26 = 2;
                    *v27 = (int32_t)&g70;
                    *v28 = v92;
                    memcpy(&g391, &g391, (int32_t)&g391);
                }
            }
            char * v103 = (char *)v93; // 0x80ff974
            v83 = v103;
            if (WWW_TraceFlag != 0) {
                struct _IO_FILE * v104 = TraceFP(); // 0x80ffa8e
                *v27 = (int32_t)"HTParse: (Related-ABS)\n";
                *v28 = (int32_t)v104;
                fprintf((struct _IO_FILE *)&g391, (char *)&g391);
                v83 = v103;
            }
            goto lab_0x80ffc3c;
        }
    } else {
        char * v105 = str4; // 0x80ff914
        if (v6 % 2 != 0) {
            // 0x80ff916
            *str4 = 47;
            v105 = (char *)((int32_t)str4 + 1);
        }
        // 0x80ff920
        *v27 = v59;
        *v28 = (int32_t)v105;
        strcpy((char *)&g391, (char *)&g391);
        v83 = v105;
        if (WWW_TraceFlag != 0) {
            struct _IO_FILE * v106 = TraceFP(); // 0x80ff941
            *v27 = (int32_t)"HTParse: (ABS)\n";
            *v28 = (int32_t)v106;
            fprintf((struct _IO_FILE *)&g391, (char *)&g391);
            v83 = v105;
        }
        goto lab_0x80ffc3c;
    }
  lab_0x80ffe2b:
    // 0x80ffe2b
    *v27 = v22;
    int32_t v79 = (int32_t)&result; // 0x80ffe35
    *v28 = v79;
    HTSACopy((char **)&g391, (char *)&g391);
    if (*relatedName != 0) {
        if ((v6 & 29) == 29) {
            // 0x80ffe55
            *v27 = v16;
            *v28 = v79;
            LYFillLocalFileURL((char **)&g391, (char *)&g391);
            if (WWW_TraceFlag != 0) {
                struct _IO_FILE * v80 = TraceFP(); // 0x80ffe78
                *v26 = (int32_t)result;
                *v27 = (int32_t)"pass LYFillLocalFile:`%s'\n";
                *v28 = (int32_t)v80;
                fprintf((struct _IO_FILE *)&g391, (char *)&g391);
            }
        }
    }
    int32_t v81 = (int32_t)result; // 0x80ffea0
    if (v3 != __readgsdword(20)) {
        // 0x80ffea2
        __stack_chk_fail();
        v81 = &g391;
    }
    // 0x80ffea7
    return (char *)v81;
  lab_0x80ffd40:
    // 0x80ffd40
    if (WWW_TraceFlag == 0) {
        goto lab_0x80ffe2b;
    } else {
        struct _IO_FILE * v82 = TraceFP(); // 0x80ffd4f
        *v26 = v22;
        *v27 = (int32_t)"HTParse:      spaces:`%s'\n";
        *v28 = (int32_t)v82;
        fprintf((struct _IO_FILE *)&g391, (char *)&g391);
        goto lab_0x80ffe02;
    }
  lab_0x80ffc3c:
    // 0x80ffc3c
    v58 = v83;
    if ((v6 & 96) != 0) {
        // 0x80ffc42
        *v27 = 63;
        *v28 = (int32_t)v83;
        char * found_char_pos4 = strchr((char *)&g391, (int32_t)&g391); // 0x80ffc50
        if (found_char_pos4 == NULL) {
            // 0x80ffc66
            v58 = v83;
            if ((v6 & 64) != 0) {
                // 0x80ffc70
                *v83 = 0;
                v58 = v83;
            }
        } else {
            // 0x80ffc5e
            *found_char_pos4 = 0;
            v58 = v83;
        }
    }
    goto lab_0x80ffc76;
  lab_0x80ff8e1:
    // 0x80ff8e1
    *v27 = (int32_t)"snews";
    *v28 = (int32_t)p;
    int32_t v84 = strcasecomp(v60, (char *)&g391); // 0x80ff8ef
    v59 = v84 != 0 ? v51 : (int32_t)v37;
    v85 = v84 != 0 ? v37 : NULL;
    goto lab_0x80ff905;
  lab_0x80ff885:
    // 0x80ff885
    *v27 = (int32_t)"nntp";
    *v28 = (int32_t)p;
    if (strcasecomp(v60, (char *)&g391) == 0) {
        // 0x80ff8d2
        v59 = (int32_t)v37;
        v85 = NULL;
        goto lab_0x80ff905;
    } else {
        // 0x80ff89c
        *v27 = (int32_t)"news";
        *v28 = (int32_t)p;
        int32_t v107 = strcasecomp((char *)&g391, (char *)&g391); // 0x80ff8aa
        v59 = v51;
        if (v107 != 0) {
            goto lab_0x80ff905;
        } else {
            // 0x80ff8b3
            *v26 = 7;
            *v27 = (int32_t)"news://";
            *v28 = v22;
            int32_t v108 = strncasecomp((char *)&g391, (char *)&g391, (int32_t)&g391); // 0x80ff8c9
            v59 = v51;
            if (v108 != 0) {
                goto lab_0x80ff905;
            } else {
                // 0x80ff8d2
                v59 = (int32_t)v37;
                v85 = NULL;
                goto lab_0x80ff905;
            }
        }
    }
  lab_0x80ffb72:;
    char v109 = v86; // 0x80ffb78
    char v110 = v109; // 0x80ffb7d
    if (v109 != 108 == (v109 != 76)) {
        goto lab_0x80ffbae;
    } else {
        // 0x80ffb8c
        *v26 = 9;
        *v27 = (int32_t)"lynxexec:";
        *v28 = v15;
        int32_t v111 = strncasecomp((char *)&g391, (char *)&g391, (int32_t)&g391); // 0x80ffba5
        v87 = str4;
        if (v111 == 0) {
            goto lab_0x80ffbfa;
        } else {
            // 0x80ffb8c
            v110 = *aName;
            goto lab_0x80ffbae;
        }
    }
  lab_0x80ffbae:;
    char v112 = v110; // 0x80ffbb4
    if (v112 != 108 == (v112 != 76)) {
        goto lab_0x80ffbea;
    } else {
        // 0x80ffbc8
        *v26 = 9;
        *v27 = (int32_t)"lynxprog:";
        *v28 = v15;
        int32_t v113 = strncasecomp((char *)&g391, (char *)&g391, (int32_t)&g391); // 0x80ffbe1
        v87 = str4;
        if (v113 == 0) {
            goto lab_0x80ffbfa;
        } else {
            goto lab_0x80ffbea;
        }
    }
  lab_0x80ffbfa:
    // 0x80ffbfa
    *v27 = (int32_t)"news:/";
    *v28 = v22;
    if (strcmp((char *)&g391, (char *)&g391) == 0) {
        // 0x80ffc11
        *(char *)(v22 | 5) = 42;
    }
    // 0x80ffc1a
    v83 = v87;
    if (WWW_TraceFlag != 0) {
        struct _IO_FILE * v114 = TraceFP(); // 0x80ffc25
        *v27 = (int32_t)"HTParse: (No inheritance)\n";
        *v28 = (int32_t)v114;
        fprintf((struct _IO_FILE *)&g391, (char *)&g391);
        v83 = v87;
    }
    goto lab_0x80ffc3c;
  lab_0x80ffbea:
    // 0x80ffbea
    *str4 = 47;
    char * v115 = (char *)((int32_t)str4 + 1); // 0x80ffbf0
    *v115 = 0;
    v87 = v115;
    goto lab_0x80ffbfa;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x80ffeac - 0x80fffad
// Line range:    666 - 692
char * HTParseAnchor(char * aName) {
    int32_t v1 = __readgsdword(20); // 0x80ffeb9
    char v2 = *aName; // 0x80ffed3
    char * v3 = aName; // 0x80ffed8
    char * str = aName; // 0x80ffed8
    bool v4 = v2 != 35; // 0x80ffed8
    if (v2 != 0 == (v2 != 35)) {
        v3 = (char *)((int32_t)v3 + 1);
        char v5 = *v3; // 0x80ffed3
        str = v3;
        v4 = v5 != 35;
        while (v5 != 0 == (v5 != 35)) {
            // 0x80ffecc
            v3 = (char *)((int32_t)v3 + 1);
            v5 = *v3;
            str = v3;
            v4 = v5 != 35;
        }
    }
    char * v6 = str; // 0x80ffeec
    if (!v4) {
        int32_t v7 = (int32_t)str; // 0x80ffef2
        int32_t v8 = (int32_t)aName; // 0x80ffef5
        char * v9; // bp-76, 0x80ffeac
        *(int32_t *)&v9 = v7;
        int32_t len = strlen(str); // 0x80fff06
        int32_t v10 = (int32_t)&v9 - (31 - v8 + v7 + len & -16); // 0x80fff1d
        int32_t v11 = v10 + 23 & -16; // 0x80fff2c
        char * str2 = (char *)v11; // 0x80fff38
        int32_t * v12 = (int32_t *)(v10 + 4);
        if (v11 == 0) {
            // 0x80fff41
            *v12 = (int32_t)"HTParseAnchor";
            *(int32_t *)v10 = (int32_t)"../../../WWW/Library/Implementation/HTParse.c";
            outofmem(str2, (char *)&g391);
            // UNREACHABLE
        }
        // 0x80fff55
        *v12 = v8;
        int32_t * v13 = (int32_t *)v10; // 0x80fff5f
        *v13 = v11;
        strcpy(str2, (char *)&g391);
        int32_t v14; // bp-44, 0x80ffeac
        *v12 = (int32_t)&v14;
        *v13 = v11;
        scan((char *)&g391, &g391);
        char * v15 = (char *)(v7 + 1); // 0x80fff79
        v6 = v15;
        char * v16; // 0x80ffeac
        if (v16 == NULL) {
            // 0x80fff8a
            v6 = v15;
            if (*v15 != 0) {
                char * v17 = (char *)((int32_t)v15 + 1);
                char * v18 = v17; // 0x80fff92
                v6 = v17;
                while (*v17 != 0) {
                    // 0x80fff86
                    v17 = (char *)((int32_t)v18 + 1);
                    v18 = v17;
                    v6 = v17;
                }
            }
        }
    }
    int32_t v19 = (int32_t)v6; // 0x80fffa1
    if (v1 != __readgsdword(20)) {
        // 0x80fffa3
        __stack_chk_fail();
        v19 = &g391;
    }
    // 0x80fffa8
    return (char *)v19;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x80fffad - 0x81003f4
// Line range:    710 - 838
void HTSimplify(char * filename) {
    if (filename == NULL) {
        // 0x81003f2
        return;
    }
    // 0x80fffbd
    char * v1; // 0x80fffad
    char * p; // bp-12, 0x80fffad
    char * p2; // bp-16, 0x80fffad
    char * v2; // bp-8, 0x80fffad
    char * v3; // 0x80fffad
    int32_t v4; // 0x80fffad
    uint32_t v5; // 0x80fffad
    char * v6; // 0x8100068
    char v7; // 0x8100068
    char * v8; // 0x80fffad
    uint32_t v9; // 0x80fffad
    char * v10; // 0x80fffad
    switch (*filename) {
        case 0: {
            return;
        }
        case 63: {
            return;
        }
        default: {
            // switch.early.test
            v9 = (int32_t)filename;
            uint32_t v11 = v9 + 1; // 0x80fffce
            switch (*(char *)v11) {
                case 63: {
                    return;
                }
                case 0: {
                    return;
                }
                default: {
                    int32_t v12 = v9 + 2;
                    if (*(char *)v12 == 63 || strchr(filename, 47) == NULL) {
                        // 0x81003f2
                        return;
                    }
                    // 0x8100027
                    v4 = v12;
                    char * v13; // 0x80fffad
                    char * str; // 0x80fffad
                    char * v14; // 0x80fffad
                    char * v15; // 0x80fffad
                    int32_t str2; // 0x80fffad
                    int32_t v16; // 0x80fffad
                    int32_t v17; // 0x80fffad
                    char * v18; // 0x80fffad
                    char * v19; // 0x80fffad
                    char * v20; // 0x80fffad
                    char * v21; // 0x80fffad
                    char v22; // 0x8100285
                    char v23; // 0x81002b3
                    uint32_t v24; // 0x81002d9
                    char * v25; // 0x80fffad
                    char * v26; // 0x81002ac
                    char v27; // 0x81002b3
                    int32_t v28; // 0x80fffad
                    char * v29; // 0x80fffad
                    int32_t v30; // 0x810032e
                    uint32_t v31; // 0x80fffad
                    char v32; // 0x810035c
                    int32_t v33; // 0x810037f
                    char * v34; // 0x80fffad
                    char v35; // 0x81003e5
                    char * v36; // 0x80fffad
                    char * v37; // 0x81003de
                    char v38; // 0x81003e5
                    char v39; // 0x8100246
                    while (true) {
                      lab_0x8100243:
                        // 0x8100243
                        v5 = v4;
                        v3 = (char *)v5;
                        v2 = v3;
                        v39 = *v3;
                        switch (v39) {
                            case 63: {
                            }
                            case 0: {
                                if (v12 > v5 || v39 != 63) {
                                    // 0x81003f2
                                    return;
                                }
                                // 0x810026e
                                v21 = (char *)(v5 - 1);
                                if (*v21 != 46) {
                                    // 0x81003f2
                                    return;
                                }
                                // 0x810027f
                                v22 = *(char *)(v5 - 2);
                                if (v22 == 47) {
                                    // 0x810028c
                                    p = v21;
                                    *(int32_t *)&p2 = v5;
                                    v23 = *v3;
                                    v14 = v21;
                                    if (v23 != 0) {
                                        *v21 = v23;
                                        v25 = (char *)((int32_t)p + 1);
                                        p = v25;
                                        v26 = (char *)((int32_t)p2 + 1);
                                        p2 = v26;
                                        v27 = *v26;
                                        v14 = v25;
                                        while (v27 != 0) {
                                            // 0x810029d
                                            *v25 = v27;
                                            v25 = (char *)((int32_t)p + 1);
                                            p = v25;
                                            v26 = (char *)((int32_t)p2 + 1);
                                            p2 = v26;
                                            v27 = *v26;
                                            v14 = v25;
                                        }
                                    }
                                    // 0x81002ba
                                    *v14 = 0;
                                    // 0x81003f2
                                    return;
                                }
                                if (v22 != 46) {
                                    // 0x81003f2
                                    return;
                                }
                                // 0x81002d6
                                v24 = v9 + 4;
                                if (v24 > v5 || *(char *)(v5 - 3) != 47) {
                                    // 0x81003f2
                                    return;
                                }
                                // 0x81002f6
                                v28 = v5 - 4;
                                v29 = (char *)v28;
                                if (*v29 == 47) {
                                    if (v24 >= v5 || *(char *)(v5 - 5) == 58) {
                                        // 0x81003f2
                                        return;
                                    }
                                }
                                // 0x8100323
                                p = v29;
                                v16 = v28;
                                v20 = v29;
                                v17 = v28;
                                v18 = v29;
                                if (v29 > filename) {
                                    v17 = v16;
                                    v18 = v20;
                                    while (*v20 != 47) {
                                        // 0x8100332
                                        v30 = v16 - 1;
                                        v19 = (char *)v30;
                                        p = v19;
                                        v16 = v30;
                                        v20 = v19;
                                        v17 = v30;
                                        v18 = v19;
                                        if (v19 <= filename) {
                                            // break -> 0x8100344
                                            break;
                                        }
                                        v17 = v16;
                                        v18 = v20;
                                    }
                                }
                                // 0x8100344
                                if (*v18 != 47) {
                                    // 0x8100344
                                    str2 = v17;
                                    str = (char *)v17;
                                } else {
                                    // 0x810034e
                                    v31 = (int32_t)v18;
                                    if (v18 > filename) {
                                        // 0x8100356
                                        v32 = *(char *)(v31 - 1);
                                        if (v32 == 47) {
                                            if (v11 >= v31 || v32 == 58) {
                                                // 0x81003f2
                                                return;
                                            }
                                        }
                                    }
                                    // 0x810037f
                                    v33 = v31 + 1;
                                    v34 = (char *)v33;
                                    p = v34;
                                    str2 = v33;
                                    str = v34;
                                }
                                // 0x8100383
                                if (strncmp(str, "../", 3) == 0 || strncmp((char *)str2, "./", 2) == 0) {
                                    // 0x81003f2
                                    return;
                                }
                                // 0x81003c1
                                *(int32_t *)&p2 = v5;
                                *(int32_t *)&v2 = str2;
                                v35 = *v3;
                                v13 = (char *)str2;
                                v15 = v13;
                                if (v35 != 0) {
                                    *v13 = v35;
                                    v36 = (char *)((int32_t)v2 + 1);
                                    v2 = v36;
                                    v37 = (char *)((int32_t)p2 + 1);
                                    p2 = v37;
                                    v38 = *v37;
                                    v15 = v36;
                                    while (v38 != 0) {
                                        // 0x81003cf
                                        *v36 = v38;
                                        v36 = (char *)((int32_t)v2 + 1);
                                        v2 = v36;
                                        v37 = (char *)((int32_t)p2 + 1);
                                        p2 = v37;
                                        v38 = *v37;
                                        v15 = v36;
                                    }
                                }
                                // 0x81003ec
                                *v15 = 0;
                                // 0x81003f2
                                return;
                            }
                        }
                        // 0x8100043
                        v1 = v3;
                        if (v39 != 47) {
                            // 0x810023f
                            v4 = (int32_t)v1 + 1;
                            goto lab_0x8100243;
                        } else {
                            // 0x8100051
                            v10 = (char *)(v5 + 1);
                            v1 = v3;
                            if (*v10 != 46) {
                                // 0x810023f
                                v4 = (int32_t)v1 + 1;
                                goto lab_0x8100243;
                            } else {
                                // 0x8100062
                                v6 = (char *)(v5 + 2);
                                v7 = *v6;
                                if (v7 != 46) {
                                    goto lab_0x810017e;
                                } else {
                                    // 0x8100073
                                    v8 = (char *)(v5 + 3);
                                    char v40 = *v8; // 0x8100079
                                    switch (v40) {
                                        case 47: {
                                            goto lab_0x810009e;
                                        }
                                        case 63: {
                                            goto lab_0x810009e;
                                        }
                                        default: {
                                            if (v40 != 0) {
                                                goto lab_0x810017e;
                                            } else {
                                                goto lab_0x810009e;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                    if (v12 > v5 || v39 != 63) {
                        // 0x81003f2
                        return;
                    }
                    // 0x810026e
                    v21 = (char *)(v5 - 1);
                    if (*v21 != 46) {
                        // 0x81003f2
                        return;
                    }
                    // 0x810027f
                    v22 = *(char *)(v5 - 2);
                    if (v22 == 47) {
                        // 0x810028c
                        p = v21;
                        *(int32_t *)&p2 = v5;
                        v23 = *v3;
                        v14 = v21;
                        if (v23 != 0) {
                            *v21 = v23;
                            v25 = (char *)((int32_t)p + 1);
                            p = v25;
                            v26 = (char *)((int32_t)p2 + 1);
                            p2 = v26;
                            v27 = *v26;
                            v14 = v25;
                            while (v27 != 0) {
                                // 0x810029d
                                *v25 = v27;
                                v25 = (char *)((int32_t)p + 1);
                                p = v25;
                                v26 = (char *)((int32_t)p2 + 1);
                                p2 = v26;
                                v27 = *v26;
                                v14 = v25;
                            }
                        }
                        // 0x81002ba
                        *v14 = 0;
                        // 0x81003f2
                        return;
                    }
                    if (v22 != 46) {
                        // 0x81003f2
                        return;
                    }
                    // 0x81002d6
                    v24 = v9 + 4;
                    if (v24 > v5 || *(char *)(v5 - 3) != 47) {
                        // 0x81003f2
                        return;
                    }
                    // 0x81002f6
                    v28 = v5 - 4;
                    v29 = (char *)v28;
                    if (*v29 == 47) {
                        if (v24 >= v5 || *(char *)(v5 - 5) == 58) {
                            // 0x81003f2
                            return;
                        }
                    }
                    // 0x8100323
                    p = v29;
                    v16 = v28;
                    v20 = v29;
                    v17 = v28;
                    v18 = v29;
                    if (v29 > filename) {
                        v17 = v16;
                        v18 = v20;
                        while (*v20 != 47) {
                            // 0x8100332
                            v30 = v16 - 1;
                            v19 = (char *)v30;
                            p = v19;
                            v16 = v30;
                            v20 = v19;
                            v17 = v30;
                            v18 = v19;
                            if (v19 <= filename) {
                                // break -> 0x8100344
                                break;
                            }
                            v17 = v16;
                            v18 = v20;
                        }
                    }
                    // 0x8100344
                    if (*v18 != 47) {
                        // 0x8100344
                        str2 = v17;
                        str = (char *)v17;
                    } else {
                        // 0x810034e
                        v31 = (int32_t)v18;
                        if (v18 > filename) {
                            // 0x8100356
                            v32 = *(char *)(v31 - 1);
                            if (v32 == 47) {
                                if (v11 >= v31 || v32 == 58) {
                                    // 0x81003f2
                                    return;
                                }
                            }
                        }
                        // 0x810037f
                        v33 = v31 + 1;
                        v34 = (char *)v33;
                        p = v34;
                        str2 = v33;
                        str = v34;
                    }
                    // 0x8100383
                    if (strncmp(str, "../", 3) == 0 || strncmp((char *)str2, "./", 2) == 0) {
                        // 0x81003f2
                        return;
                    }
                    // 0x81003c1
                    *(int32_t *)&p2 = v5;
                    *(int32_t *)&v2 = str2;
                    v35 = *v3;
                    v13 = (char *)str2;
                    v15 = v13;
                    if (v35 != 0) {
                        *v13 = v35;
                        v36 = (char *)((int32_t)v2 + 1);
                        v2 = v36;
                        v37 = (char *)((int32_t)p2 + 1);
                        p2 = v37;
                        v38 = *v37;
                        v15 = v36;
                        while (v38 != 0) {
                            // 0x81003cf
                            *v36 = v38;
                            v36 = (char *)((int32_t)v2 + 1);
                            v2 = v36;
                            v37 = (char *)((int32_t)p2 + 1);
                            p2 = v37;
                            v38 = *v37;
                            v15 = v36;
                        }
                    }
                    // 0x81003ec
                    *v15 = 0;
                    // 0x81003f2
                    return;
                }
            }
        }
    }
  lab_0x810017e:
    if (v7 != 47) {
        if (v7 != 63) {
            // 0x8100229
            v1 = v3;
            if (v7 == 0) {
                // 0x8100236
                *v10 = 0;
                v1 = v2;
            }
        } else {
            // 0x81001df
            p = v10;
            p2 = v6;
            char v41 = *v6; // 0x8100209
            char * v42 = v10; // 0x810020e
            char v43 = v41; // 0x810020e
            char * v44 = v10; // 0x810020e
            if (v41 != 0) {
                *v42 = v43;
                char * v45 = (char *)((int32_t)p + 1);
                p = v45;
                char * v46 = (char *)((int32_t)p2 + 1);
                p2 = v46;
                char v47 = *v46; // 0x8100209
                v44 = v45;
                while (v47 != 0) {
                    // 0x81001f3
                    *v45 = v47;
                    v45 = (char *)((int32_t)p + 1);
                    p = v45;
                    v46 = (char *)((int32_t)p2 + 1);
                    p2 = v46;
                    v47 = *v46;
                    v44 = v45;
                }
            }
            // 0x8100210
            *v44 = 0;
            char * v48 = (char *)((int32_t)v2 - 1); // 0x8100216
            v2 = v48;
            v1 = v48;
        }
    } else {
        // 0x810018b
        *(int32_t *)&p = v5;
        p2 = v6;
        char v49 = *v6; // 0x81001b2
        char * v50 = v3; // 0x81001b7
        char v51 = v49; // 0x81001b7
        char * v52 = v3; // 0x81001b7
        if (v49 != 0) {
            *v50 = v51;
            char * v53 = (char *)((int32_t)p + 1);
            p = v53;
            char * v54 = (char *)((int32_t)p2 + 1);
            p2 = v54;
            char v55 = *v54; // 0x81001b2
            v52 = v53;
            while (v55 != 0) {
                // 0x810019c
                *v53 = v55;
                v53 = (char *)((int32_t)p + 1);
                p = v53;
                v54 = (char *)((int32_t)p2 + 1);
                p2 = v54;
                v55 = *v54;
                v52 = v53;
            }
        }
        // 0x81001b9
        *v52 = 0;
        char * v56 = (char *)((int32_t)v2 - 1); // 0x81001bf
        v2 = v56;
        v1 = v56;
    }
    // 0x810023f
    v4 = (int32_t)v1 + 1;
    goto lab_0x8100243;
  lab_0x810009e:;
    int32_t v57 = (int32_t)v3;
    int32_t v58 = v57 - 1;
    char * str3 = (char *)v58;
    p = str3;
    char v59 = *str3;
    while (str3 >= filename == (v59 != 47)) {
        // 0x81000ad
        v57 = (int32_t)str3;
        v58 = v57 - 1;
        str3 = (char *)v58;
        p = str3;
        v59 = *str3;
    }
    // 0x81000bf
    v1 = v3;
    if (v59 != 47) {
        // 0x810023f
        v4 = (int32_t)v1 + 1;
        goto lab_0x8100243;
    } else {
        // 0x81000cd
        v1 = v3;
        if (strncmp(str3, "/../", 4) == 0) {
            // 0x810023f
            v4 = (int32_t)v1 + 1;
            goto lab_0x8100243;
        } else {
            // 0x81000f0
            v1 = v3;
            if (strncmp(str3, "/..?", 4) == 0) {
                // 0x810023f
                v4 = (int32_t)v1 + 1;
                goto lab_0x8100243;
            } else {
                uint32_t v60 = v57 - 2; // 0x8100116
                if (v60 > v9) {
                    // 0x810011e
                    v1 = v3;
                    if (*(char *)v60 == 47) {
                        // 0x810023f
                        v4 = (int32_t)v1 + 1;
                        goto lab_0x8100243;
                    } else {
                        goto lab_0x810012f;
                    }
                } else {
                    goto lab_0x810012f;
                }
            }
        }
    }
  lab_0x810012f:
    // 0x810012f
    p2 = v8;
    *(int32_t *)&v2 = v58;
    char v61 = *v8; // 0x8100156
    char * v62 = str3; // 0x810015b
    char v63 = v61; // 0x810015b
    char * v64 = str3; // 0x810015b
    if (v61 != 0) {
        *v62 = v63;
        char * v65 = (char *)((int32_t)v2 + 1);
        v2 = v65;
        char * v66 = (char *)((int32_t)p2 + 1); // 0x810014f
        p2 = v66;
        char v67 = *v66; // 0x8100156
        v64 = v65;
        while (v67 != 0) {
            // 0x8100140
            *v65 = v67;
            v65 = (char *)((int32_t)v2 + 1);
            v2 = v65;
            v66 = (char *)((int32_t)p2 + 1);
            p2 = v66;
            v67 = *v66;
            v64 = v65;
        }
    }
    // 0x810015d
    *v64 = 0;
    char * v68 = (char *)((int32_t)p - 1); // 0x8100169
    v2 = v68;
    // 0x810023f
    v4 = (int32_t)v68 + 1;
    goto lab_0x8100243;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x81003f4 - 0x81005cd
// Line range:    859 - 908
char * HTRelative(char * aName, char * relatedName) {
    char * str2 = NULL; // bp-12, 0x81003fb
    char v1 = *aName; // 0x810047a
    if (v1 != 0) {
        char * v2 = NULL;
        int32_t v3 = (int32_t)aName; // 0x81003f4
        char v4 = v1; // 0x810047a
        char * v5 = aName;
        char * v6 = NULL;
        char * v7 = relatedName;
        char * v8 = NULL;
        char * v9 = NULL;
        char * v10 = NULL; // 0x810043a
        char * str = v2; // 0x810043a
        char * v11 = v9; // 0x810043a
        char * v12 = v7; // 0x810043a
        char * v13 = v6; // 0x810043a
        char * v14 = v8; // 0x810043a
        while (v4 == *v7) {
            char * v15 = v2; // 0x8100457
            char * v16 = v9; // 0x8100457
            char * v17 = v8; // 0x8100457
            if (v4 == 47) {
                // 0x8100459
                v15 = (char *)v3;
                v16 = v8 != (char *)2 ? v9 : v15;
                v17 = (char *)((int32_t)v8 + 1);
            }
            int32_t v18 = (int32_t)v5 + 1;
            v5 = (char *)v18;
            v6 = v4 != 58 ? v6 : v5;
            v2 = v15;
            v7 = (char *)((int32_t)v7 + 1);
            v4 = *v5;
            v3 = v18;
            v10 = v15;
            str = v2;
            v11 = v16;
            v12 = v7;
            v13 = v6;
            v14 = v17;
            if (v4 == 0) {
                // break -> 0x8100481
                break;
            }
            v8 = v17;
            v9 = v16;
            v10 = v15;
            str = v2;
            v11 = v9;
            v12 = v7;
            v13 = v6;
            v14 = v8;
        }
        // 0x8100481
        if (v13 != NULL) {
            // 0x810049e
            if (v14 > (char *)2) {
                if (v14 != (char *)3) {
                    char v19 = *v12; // 0x81004f6
                    char * v20 = NULL; // 0x81004fb
                    if (v19 != 0 == (v19 != 35)) {
                        char * v21 = NULL;
                        char * v22 = v19 != 47 ? v21 : (char *)((int32_t)v21 + 1);
                        char * v23 = (char *)((int32_t)v12 + 1); // 0x81004ef
                        char v24 = *v23; // 0x81004f6
                        char * v25 = v23; // 0x81004fb
                        v20 = v22;
                        while (v24 != 0 == (v24 != 35)) {
                            // 0x81004e1
                            v21 = v22;
                            v22 = v24 != 47 ? v21 : (char *)((int32_t)v21 + 1);
                            v23 = (char *)((int32_t)v25 + 1);
                            v24 = *v23;
                            v25 = v23;
                            v20 = v22;
                        }
                    }
                    int32_t * mem = calloc(strlen(str) + 1 + 3 * (int32_t)v20, 1); // 0x810052e
                    str2 = (char *)mem;
                    if (mem == NULL) {
                        // 0x810053d
                        outofmem("../../../WWW/Library/Implementation/HTParse.c", "HTRelative");
                        // UNREACHABLE
                    }
                    // 0x8100551
                    *(char *)mem = 0;
                    if (v20 != NULL) {
                        strcat(str2, "../");
                        int32_t v26 = (int32_t)v20 - 1; // 0x810056c
                        char * v27 = (char *)v26; // 0x8100574
                        while (v26 != 0) {
                            // 0x8100559
                            strcat(str2, "../");
                            v26 = (int32_t)v27 - 1;
                            v27 = (char *)v26;
                        }
                    }
                    // 0x8100576
                    strcat(str2, (char *)((int32_t)v10 + 1));
                } else {
                    // 0x81004c1
                    HTSACopy(&str2, v11);
                }
            } else {
                // 0x81004a4
                HTSACopy(&str2, v13);
            }
            goto lab_0x810058b;
        } else {
            // 0x8100487
            HTSACopy(&str2, aName);
            goto lab_0x810058b;
        }
    } else {
        // 0x8100487
        HTSACopy(&str2, aName);
        goto lab_0x810058b;
    }
  lab_0x810058b:
    // 0x810058b
    if (WWW_TraceFlag != 0) {
        // 0x8100596
        fprintf(TraceFP(), "HTparse: `%s' expressed relative to\n   `%s' is\n   `%s'.\n", aName, relatedName, str2);
    }
    // 0x81005c4
    return str2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x81005cd - 0x8100722
// Line range:    942 - 967
char * HTEscape(char * str, char mask) {
    char * v1 = str;
    char v2 = *str; // 0x8100621
    int32_t v3 = (int32_t)str;
    char * v4 = str; // 0x8100626
    char v5 = v2; // 0x8100626
    char * v6 = NULL; // 0x8100626
    char * v7; // 0x810061a
    if (v2 != 0) {
        while (true) {
          lab_0x81005e8:;
            char * v8 = v6;
            unsigned char v9 = v5;
            v7 = v4;
            if (v9 < 32 || v9 < 0) {
                // 0x8100616
                v6 = (char *)((int32_t)v8 + 1);
                goto lab_0x810061a;
            } else {
                char v10 = *(char *)((int32_t)v9 + (int32_t)"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\a\x06\x00\a\a\x04\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00\x00\x00\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00\a\x00\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00" - 32); // 0x8100608
                v6 = v8;
                if ((v10 & mask) != 0) {
                    goto lab_0x810061a;
                } else {
                    // 0x8100616
                    v6 = (char *)((int32_t)v8 + 1);
                    goto lab_0x810061a;
                }
            }
        }
    }
  lab_0x8100628:;
    int32_t * mem = calloc(1 - v3 + v3 + 2 * (int32_t)NULL, 1); // 0x810064c
    if (mem == NULL) {
        // 0x810065a
        outofmem("../../../WWW/Library/Implementation/HTParse.c", "HTEscape");
        // UNREACHABLE
    }
    // 0x810066e
    *(int32_t *)&v1 = v3;
    char v11 = *str; // 0x8100708
    char * v12 = (char *)mem; // 0x810070d
    char v13 = v11; // 0x810070d
    if (v11 == 0) {
        // 0x8100713
        *(char *)mem = 0;
        return (char *)mem;
    }
    char * v14; // 0x81005cd
    unsigned char v15; // 0x81005cd
    int32_t v16; // 0x81005cd
    while (true) {
      lab_0x810067f:
        // 0x810067f
        v15 = v13;
        v14 = v12;
        if (v15 < 32 || v15 < 0) {
            goto lab_0x81006ab;
        } else {
            char v17 = *(char *)((int32_t)v15 + (int32_t)"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\a\x06\x00\a\a\x04\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00\x00\x00\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00\a\x00\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00" - 32); // 0x810069d
            if ((v17 & mask) != 0) {
                // 0x81006f2
                *v14 = v15;
                v16 = (int32_t)v14 + 1;
                goto lab_0x8100701;
            } else {
                goto lab_0x81006ab;
            }
        }
    }
  lab_0x8100713:;
    // 0x8100713
    char * v18; // 0x81005cd
    *v18 = 0;
    return (char *)mem;
  lab_0x81006ab:
    // 0x81006ab
    *v14 = 37;
    int32_t v19 = (int32_t)v14; // 0x81006b1
    char v20 = *(char *)((int32_t)g155 + (int32_t)(v15 / 16)); // 0x81006c8
    *(char *)(v19 + 1) = v20;
    char v21 = *(char *)((int32_t)g155 + (int32_t)(v15 % 16)); // 0x81006e4
    *(char *)(v19 + 2) = v21;
    v16 = v19 + 3;
    goto lab_0x8100701;
  lab_0x8100701:;
    char * v22 = (char *)v16;
    char * v23 = (char *)((int32_t)v1 + 1); // 0x8100701
    v1 = v23;
    char v24 = *v23; // 0x8100708
    v12 = v22;
    v13 = v24;
    v18 = v22;
    if (v24 == 0) {
        // break -> 0x8100713
        goto lab_0x8100713;
    }
    goto lab_0x810067f;
  lab_0x810061a:
    // 0x810061a
    v4 = (char *)((int32_t)v7 + 1);
    v1 = v4;
    v5 = *v4;
    if (v5 == 0) {
        // break -> 0x8100628
        goto lab_0x8100628;
    }
    goto lab_0x81005e8;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x8100722 - 0x8100839
// Line range:    982 - 1007
char * HTEscapeUnsafe(char * str) {
    char * v1 = str;
    char v2 = *str; // 0x8100756
    int32_t v3 = (int32_t)str;
    int32_t v4 = v3; // 0x810075b
    int32_t v5 = 0; // 0x810075b
    if (v2 != 0) {
        char * v6 = NULL;
        char * v7 = v2 < 127 ? v6 : (char *)((int32_t)v6 + 1);
        v4 = (int32_t)str + 1;
        char * v8 = (char *)v4;
        v1 = v8;
        char v9 = *v8; // 0x8100756
        while (v9 != 0) {
            // 0x8100737
            v6 = v7;
            v7 = v9 < 127 ? v6 : (char *)((int32_t)v6 + 1);
            v4 = (int32_t)v8 + 1;
            v8 = (char *)v4;
            v1 = v8;
            v9 = *v8;
        }
        // 0x8100753
        v5 = 2 * (int32_t)v7;
    }
    int32_t * mem = calloc(1 - v3 + v4 + v5, 1); // 0x8100781
    if (mem == NULL) {
        // 0x810078f
        outofmem("../../../WWW/Library/Implementation/HTParse.c", "HTEscapeUnsafe");
        // UNREACHABLE
    }
    // 0x81007a3
    *(int32_t *)&v1 = v3;
    char v10 = *str; // 0x8100823
    if (v10 == 0) {
        // 0x810082a
        *(char *)mem = 0;
        return (char *)mem;
    }
    char * v11 = (char *)mem;
    int32_t v12; // 0x8100722
    char v13; // 0x81007e3
    char v14; // 0x81007ff
    int32_t v15; // 0x81007cc
    if (v10 < 127) {
        // 0x810080d
        *v11 = v10;
        v12 = (int32_t)v11 + 1;
    } else {
        // 0x81007c6
        *v11 = 37;
        v15 = (int32_t)v11;
        v13 = *(char *)((int32_t)g155 + (int32_t)(v10 / 16));
        *(char *)(v15 + 1) = v13;
        v14 = *(char *)((int32_t)g155 + (int32_t)(v10 % 16));
        *(char *)(v15 + 2) = v14;
        v12 = v15 + 3;
    }
    char * v16 = (char *)v12;
    char * v17 = (char *)((int32_t)v1 + 1); // 0x810081c
    v1 = v17;
    char v18 = *v17; // 0x8100823
    while (v18 != 0) {
        unsigned char v19 = v18;
        v11 = v16;
        if (v19 < 127) {
            // 0x810080d
            *v11 = v19;
            v12 = (int32_t)v11 + 1;
        } else {
            // 0x81007c6
            *v11 = 37;
            v15 = (int32_t)v11;
            v13 = *(char *)((int32_t)g155 + (int32_t)(v19 / 16));
            *(char *)(v15 + 1) = v13;
            v14 = *(char *)((int32_t)g155 + (int32_t)(v19 % 16));
            *(char *)(v15 + 2) = v14;
            v12 = v15 + 3;
        }
        // 0x810081c
        v16 = (char *)v12;
        v17 = (char *)((int32_t)v1 + 1);
        v1 = v17;
        v18 = *v17;
    }
    // 0x810082a
    *v16 = 0;
    return (char *)mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x8100839 - 0x81009aa
// Line range:    1022 - 1050
char * HTEscapeSP(char * str, char mask) {
    char * v1 = str;
    char v2 = *str; // 0x8100897
    int32_t v3 = (int32_t)str;
    char * v4 = str; // 0x810089c
    char v5 = v2; // 0x810089c
    char * v6 = NULL; // 0x810089c
    int32_t v7 = v3; // 0x810089c
    char * v8 = NULL; // 0x810089c
    char * v9; // 0x8100839
    if (v2 != 0) {
        while (true) {
          lab_0x8100854:;
            char * v10 = v6;
            unsigned char v11 = v5;
            v9 = v10;
            if (v11 == 32) {
                goto lab_0x8100890;
            } else {
                if (v11 < 32 || v11 < 0) {
                    // 0x810088c
                    v9 = (char *)((int32_t)v10 + 1);
                    goto lab_0x8100890;
                } else {
                    char v12 = *(char *)((int32_t)v11 + (int32_t)"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\a\x06\x00\a\a\x04\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00\x00\x00\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00\a\x00\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00" - 32); // 0x810087e
                    v9 = v10;
                    if ((v12 & mask) != 0) {
                        goto lab_0x8100890;
                    } else {
                        // 0x810088c
                        v9 = (char *)((int32_t)v10 + 1);
                        goto lab_0x8100890;
                    }
                }
            }
        }
    }
  lab_0x810089e:;
    int32_t * mem = calloc(1 - v3 + v7 + 2 * (int32_t)v8, 1); // 0x81008c2
    if (mem == NULL) {
        // 0x81008d0
        outofmem("../../../WWW/Library/Implementation/HTParse.c", "HTEscape");
        // UNREACHABLE
    }
    // 0x81008e4
    *(int32_t *)&v1 = v3;
    char v13 = *str; // 0x8100990
    char * v14 = (char *)mem; // 0x8100995
    char v15 = v13; // 0x8100995
    if (v13 == 0) {
        // 0x810099b
        *(char *)mem = 0;
        return (char *)mem;
    }
    int32_t v16; // 0x8100839
    char * v17; // 0x8100839
    unsigned char v18; // 0x8100839
    while (true) {
      lab_0x81008f5:
        // 0x81008f5
        v18 = v15;
        v17 = v14;
        if (v18 != 32) {
            if (v18 < 32 || v18 < 0) {
                goto lab_0x8100933;
            } else {
                char v19 = *(char *)((int32_t)v18 + (int32_t)"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\a\x06\x00\a\a\x04\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00\x00\x00\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00\a\x00\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\a\x00\x00\x00\x00" - 32); // 0x8100925
                if ((v19 & mask) != 0) {
                    // 0x810097a
                    *v17 = v18;
                    v16 = (int32_t)v17 + 1;
                    goto lab_0x8100989;
                } else {
                    goto lab_0x8100933;
                }
            }
        } else {
            // 0x8100904
            *v17 = 43;
            v16 = (int32_t)v17 + 1;
            goto lab_0x8100989;
        }
    }
  lab_0x810099b:;
    // 0x810099b
    char * v20; // 0x8100839
    *v20 = 0;
    return (char *)mem;
  lab_0x8100933:
    // 0x8100933
    *v17 = 37;
    int32_t v21 = (int32_t)v17; // 0x8100939
    char v22 = *(char *)((int32_t)g155 + (int32_t)(v18 / 16)); // 0x8100950
    *(char *)(v21 + 1) = v22;
    char v23 = *(char *)((int32_t)g155 + (int32_t)(v18 % 16)); // 0x810096c
    *(char *)(v21 + 2) = v23;
    v16 = v21 + 3;
    goto lab_0x8100989;
  lab_0x8100989:;
    char * v24 = (char *)v16;
    char * v25 = (char *)((int32_t)v1 + 1); // 0x8100989
    v1 = v25;
    char v26 = *v25; // 0x8100990
    v14 = v24;
    v15 = v26;
    v20 = v24;
    if (v26 == 0) {
        // break -> 0x810099b
        goto lab_0x810099b;
    }
    goto lab_0x81008f5;
  lab_0x8100890:
    // 0x8100890
    v6 = v9;
    int32_t v27 = (int32_t)v4 + 1; // 0x8100890
    v4 = (char *)v27;
    v1 = v4;
    v5 = *v4;
    v7 = v27;
    v8 = v6;
    if (v5 == 0) {
        // break -> 0x810089e
        goto lab_0x810089e;
    }
    goto lab_0x8100854;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x81009aa - 0x81009fd
// Line range:    1061 - 1065
char from_hex(char c) {
    char v1 = c - 48;
    char result = v1; // 0x81009ba
    if (v1 > 9) {
        // 0x81009ce
        result = (c > 70 ? -87 : -55) + c;
    }
    // 0x81009f7
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x81009fd - 0x8100b5d
// Line range:    1068 - 1103
char * HTUnEscape(char * str) {
    // 0x81009fd
    if (str == NULL) {
        // 0x8100b54
        return NULL;
    }
    char v1 = *str; // 0x8100a19
    char v2 = v1; // 0x8100a1e
    char * v3 = str; // 0x8100a1e
    if (v1 == 0) {
        // 0x8100b54
        return str;
    }
    char * v4 = str; // 0x8100a1e
    char * v5; // 0x81009fd
    char * v6; // 0x81009fd
    char * v7; // 0x81009fd
    char * v8; // 0x81009fd
    while (true) {
      lab_0x8100a2f:
        // 0x8100a2f
        v7 = v4;
        v6 = v3;
        int32_t v9 = (int32_t)v7;
        v5 = (char *)(v9 + 1);
        if (v2 != 37) {
            goto lab_0x8100b23;
        } else {
            // 0x8100a3d
            if (*v5 == 0) {
                goto lab_0x8100b23;
            } else {
                char * v10 = (char *)(v9 + 2); // 0x8100a54
                if (*v10 == 0) {
                    goto lab_0x8100b23;
                } else {
                    int16_t v11 = *(int16_t *)(2 * (int32_t)*v5 + (int32_t)*__ctype_b_loc()); // 0x8100a77
                    if ((v11 & 0x1000) == 0) {
                        goto lab_0x8100b23;
                    } else {
                        int16_t v12 = *(int16_t *)(2 * (int32_t)*v10 + (int32_t)*__ctype_b_loc()); // 0x8100aa2
                        if ((v12 & 0x1000) == 0) {
                            goto lab_0x8100b23;
                        } else {
                            char v13 = *v5;
                            v8 = v5;
                            if (v13 != 0) {
                                char v14 = 16 * from_hex(v13); // 0x8100ad7
                                *v6 = v14;
                                char v15 = *v10;
                                v8 = v10;
                                if (v15 != 0) {
                                    // 0x8100aeb
                                    *v6 = from_hex(v15) + v14;
                                    v8 = (char *)(v9 + 3);
                                }
                            }
                            goto lab_0x8100b36;
                        }
                    }
                }
            }
        }
    }
  lab_0x8100b44:
    // 0x8100b44
    *v3 = 0;
    // 0x8100b54
    return str;
  lab_0x8100b23:
    // 0x8100b23
    *v6 = *v7;
    v8 = v5;
    goto lab_0x8100b36;
  lab_0x8100b36:
    // 0x8100b36
    v4 = v8;
    v3 = (char *)((int32_t)v6 + 1);
    v2 = *v4;
    if (v2 == 0) {
        // break -> 0x8100b44
        goto lab_0x8100b44;
    }
    goto lab_0x8100a2f;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x8100b5d - 0x8100cc1
// Line range:    1117 - 1143
char * HTUnEscapeSome(char * str, char * do_trans) {
    // 0x8100b5d
    if (str == NULL) {
        // 0x8100cb8
        return NULL;
    }
    char v1 = *str; // 0x8100b79
    if (do_trans == NULL || v1 == 0 || *do_trans == 0) {
        // 0x8100cb8
        return str;
    }
    char v2 = v1; // 0x8100c9d
    char * v3 = str;
    char * v4 = str;
    int32_t v5; // 0x8100b5d
    char * v6; // 0x8100b5d
    char * v7; // 0x8100b5d
    int32_t v8; // 0x8100b5d
    while (true) {
      lab_0x8100b9f:
        // 0x8100b9f
        v7 = v4;
        v6 = v3;
        int32_t v9 = (int32_t)v7;
        v5 = v9 + 1;
        if (v2 != 37) {
            goto lab_0x8100c87;
        } else {
            char * v10 = (char *)v5; // 0x8100bb3
            if (*v10 == 0) {
                goto lab_0x8100c87;
            } else {
                char * v11 = (char *)(v9 + 2); // 0x8100bc4
                if (*v11 == 0) {
                    goto lab_0x8100c87;
                } else {
                    int16_t v12 = *(int16_t *)(2 * (int32_t)*v10 + (int32_t)*__ctype_b_loc()); // 0x8100be7
                    if ((v12 & 0x1000) == 0) {
                        goto lab_0x8100c87;
                    } else {
                        int16_t v13 = *(int16_t *)(2 * (int32_t)*v11 + (int32_t)*__ctype_b_loc()); // 0x8100c12
                        if ((v13 & 0x1000) == 0) {
                            goto lab_0x8100c87;
                        } else {
                            char v14 = from_hex(*v10); // 0x8100c30
                            char c = from_hex(*v11) + 16 * v14; // 0x8100c51
                            if (c == 0) {
                                goto lab_0x8100c87;
                            } else {
                                // 0x8100c5d
                                if (strchr(do_trans, (int32_t)c) == NULL) {
                                    goto lab_0x8100c87;
                                } else {
                                    // 0x8100c74
                                    *v6 = c;
                                    v8 = v9 + 3;
                                    goto lab_0x8100c9a;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x8100ca8:
    // 0x8100ca8
    *v3 = 0;
    // 0x8100cb8
    return str;
  lab_0x8100c87:
    // 0x8100c87
    *v6 = *v7;
    v8 = v5;
    goto lab_0x8100c9a;
  lab_0x8100c9a:
    // 0x8100c9a
    v3 = (char *)((int32_t)v6 + 1);
    v4 = (char *)v8;
    v2 = *v4;
    if (v2 == 0) {
        // break -> 0x8100ca8
        goto lab_0x8100ca8;
    }
    goto lab_0x8100b9f;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTParse.c
// Address range: 0x8100cc1 - 0x8100ee8
// Line range:    1172 - 1229
void HTMake822Word(char ** str, int32_t quoted) {
    char * v1 = *str; // 0x8100cd1
    if (v1 == NULL) {
        // 0x8100ce3
        HTSACopy(str, quoted == 0 ? (char *)&g69 : "\"\"");
        // 0x8100ee6
        return;
    }
    char v2 = *v1; // 0x8100cdc
    if (v2 == 0) {
        // 0x8100ce3
        HTSACopy(str, quoted == 0 ? (char *)&g69 : "\"\"");
        // 0x8100ee6
        return;
    }
    int32_t v3 = (int32_t)v1;
    char * v4; // bp-12, 0x8100cc1
    *(int32_t *)&v4 = v3;
    char * v5 = v1; // 0x8100d9f
    char v6 = v2; // 0x8100da6
    char * v7 = NULL;
    unsigned char v8; // 0x8100cc1
    char * v9; // 0x8100cc1
    char * v10; // 0x8100cc1
    while (true) {
      lab_0x8100d1d:
        // 0x8100d1d
        v10 = v7;
        v8 = v6;
        if (v8 < 32 || v8 < 0) {
            goto lab_0x8100d4c;
        } else {
            unsigned char v11 = *(char *)((int32_t)v8 + (int32_t)"\x01\x00\x03\x00\x00\x00\x00\x00\x01\x01\x00\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x02\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03" - 32); // 0x8100d3b
            v9 = v10;
            if (v11 % 2 == 0) {
                goto lab_0x8100d9f;
            } else {
                goto lab_0x8100d4c;
            }
        }
    }
  lab_0x8100db1:
    if (v7 == NULL) {
        // 0x8100ee6
        return;
    }
    // 0x8100dbb
    int32_t v12; // 0x8100d9f
    int32_t * mem = calloc(1 - v3 + v12 + (int32_t)v7, 1); // 0x8100dda
    if (mem == NULL) {
        // 0x8100de8
        outofmem("../../../WWW/Library/Implementation/HTParse.c", "HTMake822Word");
        // UNREACHABLE
    }
    int32_t v13 = (int32_t)mem;
    char * v14 = (char *)mem; // 0x8100e06
    if (quoted != 0) {
        // 0x8100e08
        *(char *)mem = 34;
        v14 = (char *)(v13 + 1);
    }
    char * v15 = *str;
    *(int32_t *)&v4 = (int32_t)v15;
    char v16 = *v15; // 0x8100e9a
    char * v17 = v14; // 0x8100e9f
    char v18 = v16; // 0x8100e9f
    char * v19 = v14; // 0x8100e9f
    char v20; // 0x8100cc1
    char * v21; // 0x8100cc1
    char * v22; // 0x8100cc1
    char * v23; // 0x8100cc1
    char v24; // 0x8100cc1
    if (v16 != 0) {
        while (true) {
          lab_0x8100e1c:
            // 0x8100e1c
            v24 = v18;
            v23 = v17;
            if (v24 == 9) {
                // 0x8100e76
                *v23 = v24;
                v22 = (char *)((int32_t)v23 + 1);
                goto lab_0x8100e93;
            } else {
                if ((v24 & 96) == 0) {
                    goto lab_0x8100e57;
                } else {
                    if (v24 < 0) {
                        // 0x8100e76
                        *v23 = v24;
                        v22 = (char *)((int32_t)v23 + 1);
                        goto lab_0x8100e93;
                    } else {
                        char v25 = *(char *)((int32_t)v24 + (int32_t)"\x01\x00\x03\x00\x00\x00\x00\x00\x01\x01\x00\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x02\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03" - 32); // 0x8100e46
                        v20 = v24;
                        v21 = v23;
                        if ((v25 & 2) == 0) {
                            goto lab_0x8100e61;
                        } else {
                            goto lab_0x8100e57;
                        }
                    }
                }
            }
        }
    }
  lab_0x8100ea5:;
    char * v26 = v19; // 0x8100ea9
    if (quoted != 0) {
        // 0x8100eab
        *v19 = 34;
        v26 = (char *)((int32_t)v19 + 1);
    }
    // 0x8100eb5
    *v26 = 0;
    char * v27 = *str;
    if (v27 != NULL) {
        // 0x8100ec8
        free((int32_t *)v27);
        *(int32_t *)str = 0;
    }
    // 0x8100ede
    *(int32_t *)str = v13;
  lab_0x8100e93:;
    char * v28 = (char *)((int32_t)v4 + 1); // 0x8100e93
    v4 = v28;
    char v29 = *v28; // 0x8100e9a
    v17 = v22;
    v18 = v29;
    v19 = v22;
    if (v29 == 0) {
        // break -> 0x8100ea5
        goto lab_0x8100ea5;
    }
    goto lab_0x8100e1c;
  lab_0x8100e57:
    // 0x8100e57
    *v23 = 92;
    v20 = *v4;
    v21 = (char *)((int32_t)v23 + 1);
    goto lab_0x8100e61;
  lab_0x8100e61:
    // 0x8100e61
    *v21 = v20;
    int32_t v30 = (int32_t)v21; // 0x8100e6c
    char * v31 = (char *)(v30 + 1); // 0x8100e6c
    if (v24 == 10) {
        // 0x8100e89
        *v31 = 32;
        v22 = (char *)(v30 + 2);
        goto lab_0x8100e93;
    } else {
        // 0x8100e76
        v22 = v31;
        if (v24 != 13) {
            goto lab_0x8100e93;
        } else {
            // 0x8100e7c
            v22 = v31;
            if (*(char *)((int32_t)v4 + 1) == 10) {
                goto lab_0x8100e93;
            } else {
                // 0x8100e89
                *v31 = 32;
                v22 = (char *)(v30 + 2);
                goto lab_0x8100e93;
            }
        }
    }
  lab_0x8100d4c:;
    char * v32 = v10 != NULL ? v10 : (char *)2;
    v9 = v32;
    if (v8 > 159 || v8 == 9) {
        goto lab_0x8100d9f;
    } else {
        if (v8 != 13 == (v8 != 10)) {
            if ((v8 & 96) == 0) {
                // 0x8100d9b
                v9 = (char *)((int32_t)v32 + 1);
                goto lab_0x8100d9f;
            } else {
                char v33 = *(char *)((int32_t)v8 + (int32_t)"\x01\x00\x03\x00\x00\x00\x00\x00\x01\x01\x00\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x00\x01\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x02\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03" - 32); // 0x8100d8a
                v9 = v32;
                if ((v33 & 2) == 0) {
                    goto lab_0x8100d9f;
                } else {
                    // 0x8100d9b
                    v9 = (char *)((int32_t)v32 + 1);
                    goto lab_0x8100d9f;
                }
            }
        } else {
            // 0x8100d71
            v9 = (char *)((int32_t)v32 + 2);
            goto lab_0x8100d9f;
        }
    }
  lab_0x8100d9f:
    // 0x8100d9f
    v7 = v9;
    v12 = (int32_t)v5 + 1;
    v5 = (char *)v12;
    v4 = v5;
    v6 = *v5;
    if (v6 == 0) {
        // break -> 0x8100db1
        goto lab_0x8100db1;
    }
    goto lab_0x8100d1d;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8100ee8 - 0x8100f1d
// Line range:    107 - 116
char HTRegisterProtocol(int32_t * protocol) {
    int32_t * v1 = protocols; // 0x8100ef5
    if (protocols == NULL) {
        // 0x8100ef7
        v1 = HTList_new();
        *(int32_t *)&protocols = (int32_t)v1;
    }
    // 0x8100f01
    HTList_addObject(v1, (char *)protocol);
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8100f1d - 0x8100ff6
// Line range:    187 - 219
void HTAccessInit(void) {
    // 0x8100f1d
    HTRegisterProtocol(&HTTP);
    HTRegisterProtocol(&HTTPS);
    HTRegisterProtocol(&HTFile);
    HTRegisterProtocol(&HTTelnet);
    HTRegisterProtocol(&HTTn3270);
    HTRegisterProtocol(&HTRlogin);
    HTRegisterProtocol(&HTFTP);
    HTRegisterProtocol(&HTNews);
    HTRegisterProtocol(&HTNNTP);
    HTRegisterProtocol(&HTNewsPost);
    HTRegisterProtocol(&HTNewsReply);
    HTRegisterProtocol(&HTSNews);
    HTRegisterProtocol(&HTSNewsPost);
    HTRegisterProtocol(&HTSNewsReply);
    HTRegisterProtocol(&HTGopher);
    HTRegisterProtocol(&HTCSO);
    HTRegisterProtocol(&HTFinger);
    LYRegisterLynxProtocols();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8100ff6 - 0x8101682
// Line range:    239 - 373
char override_proxy(char * addr) {
    char * env_val = getenv("no_proxy"); // 0x8101003
    if (env_val != NULL) {
        // 0x8101042
        if (strcmp(env_val, "*") == 0) {
            // 0x810167c
            return 1;
        }
    }
    // 0x8101062
    if (addr == NULL) {
        // 0x810167c
        return 0;
    }
    char * str = HTParse(addr, (char *)&g71, 8); // 0x8101087
    if (str == NULL) {
        // 0x810167c
        return 0;
    }
    // 0x810109e
    if (*str == 0) {
        // 0x81010ae
        free((int32_t *)str);
        // 0x810167c
        return 0;
    }
    char * found_char_pos = strchr(str, 64); // 0x81010d7
    int32_t v1 = found_char_pos == NULL ? (int32_t)str : (int32_t)found_char_pos + 1;
    char * str3 = (char *)v1;
    char * str2 = HTParse(addr, (char *)&g71, 16); // 0x8101112
    if (str2 != NULL) {
        // 0x8101124
        if (strcmp("file", str2) == 0) {
            // 0x810113b
            if (strcmp(str3, "localhost") == 0 || strcmp(str3, HTHostName()) == 0) {
                // 0x8101188
                free((int32_t *)str);
                free((int32_t *)str2);
                // 0x810167c
                return 1;
            }
        }
        // 0x81011a9
        free((int32_t *)str2);
    }
    if (env_val == NULL) {
        // 0x81011c7
        free((int32_t *)str);
        // 0x810167c
        return 0;
    }
    char * found_char_pos2 = strrchr(str3, 58); // 0x81011f0
    char * str_as_i; // 0x8100ff6
    if (found_char_pos2 == NULL) {
        char * str4 = HTParse(addr, (char *)&g71, 16); // 0x8101231
        str_as_i = NULL;
        if (str4 != NULL) {
            char * v2 = (char *)80; // 0x8101258
            if (strcmp(str4, "http") != 0) {
                // 0x8101266
                v2 = (char *)443;
                if (strcmp(str4, "https") != 0) {
                    // 0x8101289
                    v2 = (char *)21;
                    if (strcmp(str4, "ftp") != 0) {
                        // 0x81012ac
                        v2 = (char *)70;
                        if (strcmp(str4, "gopher") != 0) {
                            // 0x81012cf
                            v2 = (char *)105;
                            if (strcmp(str4, "cso") != 0) {
                                // 0x81012f2
                                v2 = (char *)119;
                                if (strcmp(str4, "news") != 0) {
                                    // 0x8101315
                                    v2 = (char *)119;
                                    if (strcmp(str4, "nntp") != 0) {
                                        // 0x8101338
                                        v2 = (char *)119;
                                        if (strcmp(str4, "newspost") != 0) {
                                            // 0x810135b
                                            v2 = (char *)119;
                                            if (strcmp(str4, "newsreply") != 0) {
                                                // 0x810137e
                                                v2 = (char *)563;
                                                if (strcmp(str4, "snews") != 0) {
                                                    // 0x81013a1
                                                    v2 = (char *)563;
                                                    if (strcmp(str4, "snewspost") != 0) {
                                                        // 0x81013c4
                                                        v2 = (char *)563;
                                                        if (strcmp(str4, "snewsreply") != 0) {
                                                            // 0x81013e7
                                                            v2 = (char *)210;
                                                            if (strcmp(str4, "wais") != 0) {
                                                                // 0x8101407
                                                                v2 = (char *)79;
                                                                if (strcmp(str4, "finger") != 0) {
                                                                    // 0x8101427
                                                                    v2 = (char *)23;
                                                                    if (strcmp(str4, "telnet") != 0) {
                                                                        // 0x8101447
                                                                        v2 = (char *)23;
                                                                        if (strcmp(str4, "tn3270") != 0) {
                                                                            // 0x8101467
                                                                            v2 = strcmp(str4, "rlogin") != 0 ? NULL : (char *)513;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            // 0x810148b
            free((int32_t *)str4);
            str_as_i = v2;
        }
    } else {
        // 0x81011fe
        *found_char_pos2 = 0;
        str_as_i = (char *)atoi((char *)((int32_t)found_char_pos2 + 1));
    }
    int32_t len = strlen(str3); // 0x81014b0
    char v3 = *env_val; // 0x8101655
    if (v3 == 0) {
        // 0x8101666
        free((int32_t *)str);
        // 0x810167c
        return 0;
    }
    char * v4 = str_as_i;
    int32_t v5 = v4 != NULL ? (int32_t)v4 : 80;
    int32_t v6 = len + v1;
    char v7 = v3; // 0x8101655
    char * v8 = env_val; // 0x810164f
    char * v9; // 0x8100ff6
    char * v10; // 0x8100ff6
    char * v11; // 0x8100ff6
    char * v12; // 0x8100ff6
    char * v13; // 0x8100ff6
    int32_t v14; // 0x8100ff6
    char * v15; // 0x8100ff6
    char * v16; // 0x8100ff6
    char * v17; // 0x8100ff6
    bool v18; // 0x8100ff6
    char * v19; // 0x8100ff6
    int32_t v20; // 0x8100ff6
    int32_t v21; // 0x8100ff6
    int32_t v22; // 0x8100ff6
    int32_t v23; // 0x8100ff6
    int32_t v24; // 0x8100ff6
    int32_t v25; // 0x8100ff6
    int32_t v26; // 0x8100ff6
    int32_t v27; // 0x8100ff6
    int32_t v28; // 0x8100ff6
    while (true) {
      lab_0x81014d1:;
        char * v29 = v8; // 0x81014d9
        char v30 = v7; // 0x81014d9
        v13 = v8;
        if (v7 == 0) {
            goto lab_0x81014ef;
        } else {
            char v31 = v30;
            char * v32 = v29;
            int32_t v33 = (int32_t)v32;
            while (v31 < 33 || v31 == 44) {
                char * v34 = (char *)(v33 + 1);
                char v35 = *v34; // 0x81014d4
                v29 = v34;
                v30 = v35;
                v13 = v34;
                if (v35 == 0) {
                    goto lab_0x81014ef;
                }
                v31 = v30;
                v32 = v29;
                v33 = (int32_t)v32;
            }
            char v36 = v31; // 0x8101513
            int32_t v37 = v33; // 0x8101513
            v14 = v33;
            v15 = v32;
            v12 = v32;
            v25 = v33;
            int32_t v38 = v36 != 58 ? 0 : v37;
            int32_t v39 = v37 + 1; // 0x8101507
            char * v40 = (char *)v39;
            unsigned char v41 = *v40; // 0x810150e
            v37 = v39;
            int32_t v42 = v38; // 0x8101513
            while (v41 > 32 == (v41 != 44)) {
                // 0x81014f7
                v38 = v41 != 58 ? v42 : v37;
                v39 = v37 + 1;
                v40 = (char *)v39;
                v41 = *v40;
                v37 = v39;
                v42 = v38;
            }
            // 0x8101529
            v14 = v33;
            v15 = v32;
            v12 = v40;
            v25 = v39;
            if (v38 == 0) {
                goto lab_0x810155c;
            } else {
                int32_t str_as_i2 = atoi((char *)(v38 + 1)); // 0x8101538
                int32_t v43 = v38 - v33; // 0x8101548
                v16 = v32;
                v11 = v40;
                v24 = v39;
                v27 = v43;
                if (str_as_i2 == 0) {
                    goto lab_0x810156a;
                } else {
                    // 0x8101562
                    v17 = v32;
                    v9 = v40;
                    v22 = v39;
                    v18 = false;
                    v26 = v43;
                    v20 = str_as_i2;
                    v19 = v32;
                    v10 = v40;
                    v23 = v39;
                    v21 = str_as_i2;
                    v28 = v43;
                    if (len < v43 || v43 < 1 || str_as_i2 != v5) {
                        goto lab_0x81015ca;
                    } else {
                        goto lab_0x8101578;
                    }
                }
            }
        }
    }
  lab_0x81015a9:
    // 0x81015a9
    free((int32_t *)str);
  lab_0x810167c:
    // 0x810167c
    return 1;
  lab_0x81014ef:;
    int32_t v44 = (int32_t)v13;
    v14 = v44;
    v15 = v13;
    v12 = v13;
    v25 = v44;
    goto lab_0x810155c;
  lab_0x810155c:
    // 0x810155c
    v16 = v15;
    v11 = v12;
    v24 = v25;
    v27 = v25 - v14;
    goto lab_0x810156a;
  lab_0x810156a:;
    int32_t v45 = v27;
    v17 = v16;
    v9 = v11;
    v22 = v24;
    v18 = true;
    v26 = v45;
    v20 = 0;
    char * v46 = v16; // 0x810156e
    char * v47 = v11; // 0x810156e
    int32_t v48 = v24; // 0x810156e
    int32_t v49 = v45; // 0x810156e
    if (v45 < 1 || len < v45) {
        goto lab_0x81015d2;
    } else {
        goto lab_0x8101578;
    }
  lab_0x81015d2:;
    int32_t v50 = v49;
    char * v51 = v46; // 0x81015d6
    char * v52 = v47; // 0x81015d6
    int32_t v53 = v48; // 0x81015d6
    int32_t n = v50; // 0x81015d6
    char * v54 = v47; // 0x81015d6
    int32_t v55 = v48; // 0x81015d6
    if (v50 < 1 || len < v50) {
        goto lab_0x810163f;
    } else {
        goto lab_0x81015e0;
    }
  lab_0x8101578:;
    int32_t v56 = v26;
    if (strncasecomp((char *)(v6 - v56), v17, v56) == 0) {
        // break -> 0x81015a9
        goto lab_0x81015a9;
    }
    // 0x81015c4
    v19 = v17;
    v10 = v9;
    v23 = v22;
    v21 = v20;
    v28 = v56;
    v46 = v17;
    v47 = v9;
    v48 = v22;
    v49 = v56;
    if (v18) {
        goto lab_0x81015d2;
    } else {
        goto lab_0x81015ca;
    }
  lab_0x810163f:
    // 0x810163f
    if (*v54 == 0) {
        // 0x8101666
        free((int32_t *)str);
        // 0x810167c
        return 0;
    }
    // 0x8101649
    v8 = (char *)(v55 + 1);
    v7 = *v8;
    if (v7 == 0) {
        // 0x8101666
        free((int32_t *)str);
        // 0x810167c
        return 0;
    }
    goto lab_0x81014d1;
  lab_0x81015e0:;
    int32_t v57 = v53;
    char * v58 = v52;
    char * str5 = v51;
    int16_t * v59 = *__ctype_b_loc(); // 0x81015e5
    v54 = v58;
    v55 = v57;
    if ((*(int16_t *)(2 * (int32_t)*str5 + (int32_t)v59) & 2048) != 0) {
        // 0x8101604
        v54 = v58;
        v55 = v57;
        if (strncmp(str, str5, n) == 0) {
            // 0x8101627
            free((int32_t *)str);
            goto lab_0x810167c;
        }
    }
    goto lab_0x810163f;
  lab_0x81015ca:;
    int32_t v60 = v28;
    v51 = v19;
    v52 = v10;
    v53 = v23;
    n = v60;
    v54 = v10;
    v55 = v23;
    if (len < v60 || v21 != v5 || v60 < 1) {
        goto lab_0x810163f;
    } else {
        goto lab_0x81015e0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8101682 - 0x8101e41
// Line range:    388 - 597
int32_t get_physical(char * addr, int32_t * anchor) {
    int32_t result = 0; // bp-20, 0x810168f
    char * acc_method = NULL; // bp-24, 0x8101696
    if (WWW_TraceFlag != 0) {
        // 0x81016ac
        fprintf(TraceFP(), "get_physical %s\n", addr);
    }
    // 0x81016cc
    using_proxy = 0;
    char * v1 = HTTranslate(addr); // 0x81016d9
    result = (int32_t)v1;
    if (v1 == NULL) {
        // 0x8101e3c
        return redirecting_url == 0 ? -403 : 399;
    }
    char * v2 = (char *)((int32_t)anchor + 84); // 0x810170c
    if (*v2 == 1) {
        // 0x8101714
        HTSACat((char **)&result, "?0,0");
        if (WWW_TraceFlag != 0) {
            // 0x8101732
            fprintf(TraceFP(), "HTAccess: Appending '?0,0' coordinate pair.\n");
        }
    }
    int32_t str = result;
    char v3; // 0x8101682
    if (strncmp((char *)result, "Proxied=", 8) != 0) {
        int32_t v4 = result;
        if (strncmp((char *)str, "NoProxy=", 8) != 0) {
            // 0x81017c0
            HTAnchor_setPhysical(anchor, (char *)v4);
            v3 = 0;
        } else {
            // 0x81017a5
            HTAnchor_setPhysical(anchor, (char *)(v4 + 8));
            v3 = 1;
        }
    } else {
        // 0x8101768
        HTAnchor_setPhysical(anchor, (char *)(str + 8));
        using_proxy = 1;
        v3 = 0;
    }
    // 0x81017d2
    if (result != 0) {
        // 0x81017d9
        free((int32_t *)result);
        result = 0;
    }
    char * str4 = HTParse(HTAnchor_physical(anchor), "file:", 16); // 0x8101809
    char v5 = v3; // 0x8101815
    if (v3 == 0) {
        // 0x810181b
        v5 = v3;
        if (using_proxy == 0) {
            // 0x810182a
            if (strcasecomp(str4, "news") != 0) {
                // 0x810193a
                if (strcasecomp(str4, "wais") != 0) {
                    // 0x81019fd
                    HTSACopy(&acc_method, addr);
                } else {
                    char * str2 = HTParse(addr, (char *)&g71, 8); // 0x8101972
                    if (str2 == NULL) {
                        // 0x81019e9
                        HTSACopy(&acc_method, addr);
                    } else {
                        // 0x8101980
                        if (strchr(str2, 58) == NULL) {
                            // 0x8101997
                            HTSACopy(&acc_method, "wais://");
                            HTSACat(&acc_method, str2);
                            HTSACat(&acc_method, ":210/");
                        }
                        // 0x81019d5
                        free((int32_t *)str2);
                    }
                }
            } else {
                char * str3 = HTParse(addr, (char *)&g71, 8); // 0x8101862
                if (str3 == NULL) {
                    // 0x81018e0
                    if (LYGetEnv("NNTPSERVER") != NULL) {
                        // 0x81018f4
                        HTSACopy(&acc_method, "news://");
                        char * v6 = LYGetEnv("NNTPSERVER"); // 0x810190e
                        HTSACat(&acc_method, v6);
                        HTSACat(&acc_method, ":119/");
                    }
                } else {
                    // 0x8101870
                    if (strchr(str3, 58) == NULL) {
                        // 0x8101887
                        HTSACopy(&acc_method, "news://");
                        HTSACat(&acc_method, str3);
                        HTSACat(&acc_method, ":119/");
                    }
                    // 0x81018c9
                    free((int32_t *)str3);
                }
            }
            // 0x8101a0f
            v5 = override_proxy(acc_method);
        }
    }
    int32_t v7 = (int32_t)str4; // 0x8101809
    int32_t str8 = v7; // 0x8101a21
    if (v5 == 0) {
        // 0x8101a27
        str8 = v7;
        if (using_proxy == 0) {
            int32_t v8 = 0; // bp-36, 0x8101a36
            HTSprintf0((char **)&v8, "WWW_%s_GATEWAY", str4);
            char * v9 = LYGetEnv((char *)v8); // 0x8101a5d
            int32_t str5 = v8;
            if (strcmp(str4, "file") != 0) {
                // 0x8101a99
                sprintf((char *)str5, "%s_proxy", str4);
            } else {
                // 0x8101a7c
                memcpy((int32_t *)str5, (int32_t *)"ftp_proxy", 10);
            }
            char * v10 = LYGetEnv((char *)v8); // 0x8101ab9
            if (v8 != 0) {
                // 0x8101ac8
                free((int32_t *)v8);
                v8 = 0;
            }
            // 0x8101ada
            if (v9 != NULL && WWW_TraceFlag != 0) {
                // 0x8101aeb
                fprintf(TraceFP(), "Gateway found: %s\n", v9);
            }
            // 0x8101b09
            if (v10 != NULL && WWW_TraceFlag != 0) {
                // 0x8101b1a
                fprintf(TraceFP(), "proxy server found: %s\n", v10);
            }
            if (v10 == NULL) {
                // 0x8101ca0
                str8 = v7;
                if (v9 != NULL) {
                    char * v11 = HTParse(addr, (char *)&g71, 13); // 0x8101cc0
                    char * v12 = HTParse((char *)((int32_t)v11 + 1), v9, 31); // 0x8101ce0
                    if (v11 != NULL) {
                        // 0x8101cee
                        free((int32_t *)v11);
                    }
                    // 0x8101d00
                    HTAnchor_setPhysical(anchor, v12);
                    if (v12 != NULL) {
                        // 0x8101d18
                        free((int32_t *)v12);
                    }
                    if (str4 != NULL) {
                        // 0x8101d30
                        free((int32_t *)str4);
                    }
                    char * v13 = HTAnchor_physical(anchor); // 0x8101d48
                    str8 = (int32_t)HTParse(v13, "http:", 16);
                }
            } else {
                char * str6 = NULL; // bp-48, 0x8101b42
                HTSACopy(&str6, v10);
                if (strncmp(str6, "http", 4) == 0) {
                    char * found_char_pos = strrchr(str6, 47); // 0x8101b88
                    if (found_char_pos != NULL) {
                        // 0x8101b96
                        if ((int32_t)found_char_pos - (int32_t)str6 <= 7) {
                            // 0x8101ba7
                            LYAddHtmlSep(&str6);
                        }
                    }
                }
                // 0x8101bb2
                if (strncmp(addr, "file", 4) != 0) {
                    // 0x8101bfb
                    HTSACat(&str6, addr);
                } else {
                    // 0x8101bd1
                    HTSACat(&str6, "ftp");
                    HTSACat(&str6, (char *)((int32_t)addr + 4));
                }
                // 0x8101c0d
                using_proxy = 1;
                if (*v2 == 1) {
                    // 0x8101c1f
                    HTSACat(&str6, "?0,0");
                }
                // 0x8101c32
                HTAnchor_setPhysical(anchor, str6);
                if (str6 != NULL) {
                    // 0x8101c4b
                    free((int32_t *)str6);
                    str6 = NULL;
                }
                if (str4 != NULL) {
                    // 0x8101c63
                    free((int32_t *)str4);
                }
                char * v14 = HTAnchor_physical(anchor); // 0x8101c7b
                str8 = (int32_t)HTParse(v14, "http:", 16);
            }
        }
    }
    // 0x8101d68
    if (acc_method != NULL) {
        // 0x8101d6f
        free((int32_t *)acc_method);
        acc_method = NULL;
    }
    int32_t * v15 = protocols; // 0x8101d8f
    if (protocols == NULL) {
        // 0x8101d91
        HTAccessInit();
        v15 = protocols;
    }
    int32_t v16 = HTList_count(v15); // 0x8101d9e
    if (v16 <= 0) {
      lab_0x8101e1e:
        // 0x8101e1e
        if (str8 != 0) {
            // 0x8101e24
            free((int32_t *)str8);
        }
        // 0x8101e3c
        return -401;
    }
    int32_t v17 = 0; // 0x8101e12
    char * v18 = HTList_objectAt(protocols, v17); // 0x8101dbf
    int32_t str7 = *(int32_t *)v18; // 0x8101dca
    while (strcmp((char *)str7, (char *)str8) != 0) {
        // 0x8101e16
        v17++;
        if (v17 >= v16) {
            goto lab_0x8101e1e;
        }
        v18 = HTList_objectAt(protocols, v17);
        str7 = *(int32_t *)v18;
    }
    // 0x8101ddf
    HTAnchor_setProtocol(anchor, v18);
    if (str8 != 0) {
        // 0x8101df7
        free((int32_t *)str8);
    }
    // 0x8101e3c
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8101e41 - 0x8101f76
// Line range:    607 - 636
void LYUCPushAssumed(int32_t * anchor) {
    if (anchor != NULL) {
        int32_t v1 = HTAnchor_getUCLYhndl(anchor, 1); // 0x8101e6e
        if (v1 >= 0) {
            int32_t * v2 = HTAnchor_getUCInfoStage(anchor, 1); // 0x8101e8a
            if (v2 != NULL) {
                int32_t * v3 = (int32_t *)((int32_t)v2 + 4); // 0x8101e9f
                if (*v3 != 0) {
                    int32_t v4 = UCAssume_MIMEcharset; // 0x8101eaa
                    pushed_assume_MIMEname = v4;
                    UCAssume_MIMEcharset = 0;
                    if (HTCJK != 1) {
                        // 0x8101edf
                        HTSACopy((char **)&UCAssume_MIMEcharset, (char *)*v3);
                    } else {
                        // 0x8101ec8
                        HTSACopy((char **)&UCAssume_MIMEcharset, (char *)v4);
                    }
                    // 0x8101ef5
                    pushed_assume_LYhndl = v1;
                    int32_t v5 = UCLYhndl_for_unspec; // 0x8101efd
                    if (v5 != v1 && WWW_TraceFlag != 0) {
                        // 0x8101f12
                        fprintf(TraceFP(), "LYUCPushAssumed: UCLYhndl_for_unspec changed %d -> %d\n", v5, v1);
                    }
                    // 0x8101f3c
                    UCLYhndl_for_unspec = v1;
                    // 0x8101f70
                    return;
                }
            }
        }
    }
    // 0x8101f46
    pushed_assume_LYhndl = -1;
    if (pushed_assume_MIMEname != 0) {
        // 0x8101f59
        free((int32_t *)pushed_assume_MIMEname);
        pushed_assume_MIMEname = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8101f76 - 0x8102033
// Line range:    643 - 659
int32_t LYUCPopAssumed(void) {
    int32_t v1 = pushed_assume_LYhndl; // 0x8101f7e
    if (v1 < 0) {
        // 0x8102029
        return (int32_t)(char *)-1;
    }
    int32_t v2 = UCLYhndl_for_unspec; // 0x8101f8b
    int32_t v3 = v1; // 0x8101f98
    if (v2 != v1 && WWW_TraceFlag != 0) {
        // 0x8101fa5
        fprintf(TraceFP(), "LYUCPopAssumed: UCLYhndl_for_unspec changed %d -> %d\n", v2, v1);
        v3 = pushed_assume_LYhndl;
    }
    // 0x8101fd0
    UCLYhndl_for_unspec = v3;
    pushed_assume_LYhndl = -1;
    int32_t v4 = UCAssume_MIMEcharset; // 0x8101fe4
    int32_t v5 = v3; // 0x8101feb
    if (v4 != 0) {
        // 0x8101fed
        free((int32_t *)v4);
        UCAssume_MIMEcharset = 0;
        v5 = UCLYhndl_for_unspec;
    }
    // 0x8102004
    UCAssume_MIMEcharset = pushed_assume_MIMEname;
    pushed_assume_MIMEname = 0;
    // 0x8102029
    return (int32_t)(char *)v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8102033 - 0x8102113
// Line range:    681 - 702
int32_t HTLoad(char * addr, int32_t * anchor, int32_t * format_out, int32_t * sink) {
    int32_t v1 = get_physical(addr, anchor); // 0x8102047
    if (v1 == -403) {
        // 0x8102058
        LYFixCursesOn("show alert:");
        char * v2 = gettext("Access forbidden by rule"); // 0x810206b
        // 0x810210a
        return (int32_t)(int32_t *)HTLoadError(sink, 500, v2);
    }
    int32_t * v3 = (int32_t *)v1; // 0x810204c
    int32_t * v4 = v3; // 0x8102093
    if (v1 >= 0 && v3 != (int32_t *)399) {
        // 0x810209b
        LYFixCursesOnForAccess(addr, HTAnchor_physical(anchor));
        HTAnchor_protocol(anchor);
        *(char *)(*anchor + 34) = 1;
        HTAnchor_physical(anchor);
        *(char *)(*anchor + 34) = 0;
        LYUCPopAssumed();
        v4 = anchor;
    }
    // 0x810210a
    return (int32_t)v4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x810214c - 0x8102b34
// Line range:    740 - 1097
char HTLoadDocument(char * full_address, int32_t * anchor, int32_t * format_out, int32_t * sink) {
    char v1 = LYforce_no_cache; // 0x8102159
    if (WWW_TraceFlag != 0) {
        // 0x810216e
        fprintf(TraceFP(), "HTAccess: loading document %s\n", full_address);
    }
    int32_t v2 = use_this_url_instead; // 0x810218c
    if (v2 != 0) {
        // 0x8102195
        free((int32_t *)v2);
        use_this_url_instead = 0;
    }
    // 0x81021ac
    permanent_redirection = 0;
    if (redirection_attempts >= 11) {
        // 0x81021bd
        redirection_attempts = 0;
        HTAlert(gettext("Redirection limit of 10 URL's reached."));
        // 0x8102b2a
        return 0;
    }
    int32_t v3 = (int32_t)anchor;
    char result; // 0x810214c
    if (LYinternal_flag != 0 && HTAnchor_document(anchor) == NULL) {
        // 0x8102203
        if (LYforce_no_cache == 0) {
            // 0x810220e
            if (*(int32_t *)(v3 + 20) != 0) {
                // 0x8102218
                if (*(char *)(v3 + 86) == 0) {
                    // 0x8102223
                    if (strncasecomp(full_address, "LYNXIMGMAP:", 11) != 0) {
                        char * v4 = gettext("Document with POST content not found in cache.  Resubmit?"); // 0x8102249
                        result = 0;
                        if (HTConfirm(v4) != 1) {
                          lab_0x8102b2a:
                            // 0x8102b2a
                            return result;
                        }
                    }
                }
            }
        }
    }
    int32_t v5 = v3; // 0x810226b
    int32_t * text; // bp-28, 0x810214c
    if (*(int32_t *)(v3 + 20) == 0) {
        char * v6 = HTAnchor_physical(anchor); // 0x8102389
        text = (int32_t *)v6;
        char * str = v6; // 0x8102396
        v5 = v3;
        if (v6 != NULL) {
            int32_t v7 = v3;
            v5 = v7;
            while (strncmp(str, "Location=", 9) == 0) {
                // 0x8102276
                if (WWW_TraceFlag != 0) {
                    int32_t v8 = *(int32_t *)(v7 + 16); // 0x8102284
                    fprintf(TraceFP(), "HTAccess: '%s' is a redirection URL.\n", (char *)v8);
                    if (WWW_TraceFlag != 0) {
                        // 0x81022ad
                        fprintf(TraceFP(), "HTAccess: Redirecting to '%s'\n", (char *)((int32_t)text + 9));
                    }
                }
                int32_t v9 = redirection_attempts + 1; // 0x81022d3
                redirection_attempts = v9;
                if (v9 >= 11) {
                    // 0x81022e5
                    HTAlert(gettext("Redirection limit of 10 URL's reached."));
                    redirection_attempts = 0;
                    result = 0;
                    if (use_this_url_instead == 0) {
                        return result;
                    } else {
                        // 0x810230c
                        free((int32_t *)use_this_url_instead);
                        use_this_url_instead = 0;
                        result = 0;
                        return result;
                    }
                }
                // 0x810232c
                HTSACopy((char **)&use_this_url_instead, (char *)((int32_t)text + 9));
                int32_t v10 = use_this_url_instead; // bp-52, 0x8102347
                int32_t * v11 = HTAnchor_findAddress(&v10); // 0x810237b
                int32_t v12 = (int32_t)v11;
                char * v13 = HTAnchor_physical(v11); // 0x8102389
                text = (int32_t *)v13;
                str = v13;
                v5 = v12;
                if (v13 == NULL) {
                    // break -> 0x81023bb
                    break;
                }
                v7 = v12;
                v5 = v7;
            }
        }
    }
    // 0x81023bb
    if (use_this_url_instead != 0) {
        // 0x81023c4
        if (redirecting_url != 0) {
            // 0x81023cd
            free((int32_t *)redirecting_url);
            redirecting_url = 0;
        }
        // 0x8102b2a
        return 0;
    }
    int32_t * v14 = (int32_t *)v5;
    int32_t * v15 = HTAnchor_document(v14); // 0x81023f3
    char v16 = v1; // 0x81023ff
    if (v15 == NULL) {
        goto lab_0x81024dc;
    } else {
        // 0x8102405
        v16 = v1;
        if (LYforce_no_cache != 0) {
            goto lab_0x81024dc;
        } else {
            // 0x8102414
            if (LYoverride_no_cache != 0) {
                goto lab_0x8102444;
            } else {
                // 0x810241f
                if (HText_hasNoCacheSet(v15) == 0) {
                    goto lab_0x8102444;
                } else {
                    // 0x810242e
                    if (HText_AreDifferent(v14, full_address) != 0) {
                        // 0x81024a8
                        HTSABFree((int32_t **)(v5 + 20));
                        v16 = 1;
                        if (WWW_TraceFlag != 0) {
                            // 0x81024c5
                            fprintf(TraceFP(), "HTAccess: Auto-reloading document.\n");
                            v16 = 1;
                        }
                        goto lab_0x81024dc;
                    } else {
                        goto lab_0x8102444;
                    }
                }
            }
        }
    }
  lab_0x81024dc:
    // 0x81024dc
    if (HText_HaveUserChangedForms(v15) != 0) {
        // 0x81024eb
        HTAlert(gettext("Reloading document.  Any form entries will be lost!"));
    }
    // 0x81024ff
    LYforce_no_cache = 0;
    if (v16 != 0) {
        int32_t * v17 = (int32_t *)(v5 + 52); // 0x810250f
        int32_t v18 = *v17; // 0x810250f
        if (v18 != 0) {
            // 0x8102516
            free((int32_t *)v18);
            *v17 = 0;
        }
    }
    int32_t v19 = HTLoad(full_address, v14, format_out, sink); // 0x8102549
    if (WWW_TraceFlag != 0) {
        // 0x810255c
        fprintf(TraceFP(), "HTAccess:  status=%d\n", v19);
    }
    if (v15 != NULL && v19 < 0) {
        // 0x810258e
        if (v15 == HTAnchor_document(v14)) {
            // 0x810259e
            HTAlert(gettext("Loading failed, use a previous copy."));
            if (WWW_TraceFlag != 0) {
                // 0x81025bd
                fprintf(TraceFP(), "HTAccess: Loading failed, use a previous copy.\n");
            }
            // 0x81025d4
            HText_select(v15);
            int32_t * v20 = HTAnchor_format(v14); // 0x81025e5
            if (v20 == HTAtom_for("www/dired")) {
                // 0x81025fc
                lynx_edit_mode = 1;
            }
            // 0x8102603
            redirection_attempts = 0;
            // 0x8102b2a
            return 1;
        }
    }
    // 0x8102616
    if (HTlogfile != NULL) {
        // 0x8102623
        char * address_to_load; // bp-32, 0x810214c
        time((int32_t *)&address_to_load);
        char * v21 = v19 >= 0 ? "GET" : "FAIL";
        int32_t v22 = HTClientHost; // 0x8102644
        int32_t v23 = v22 == 0 ? (int32_t)"local" : v22;
        char * time_str = ctime((int32_t *)&address_to_load); // 0x8102664
        fprintf((struct _IO_FILE *)HTlogfile, "%24.24s %s %s %s\n", time_str, (char *)v23, v21, full_address);
        fflush((struct _IO_FILE *)HTlogfile);
        if (WWW_TraceFlag != 0) {
            int32_t v24 = HTClientHost; // 0x81026c8
            int32_t v25 = v24 == 0 ? (int32_t)"local" : v24;
            char * time_str2 = ctime((int32_t *)&address_to_load); // 0x81026e8
            fprintf(TraceFP(), "Log: %24.24s %s %s %s\n", time_str2, (char *)v25, v21, full_address);
        }
    }
    if (v19 == 399) {
        // 0x810272e
        if (WWW_TraceFlag != 0) {
            // 0x8102757
            fprintf(TraceFP(), "HTAccess: '%s' is a redirection URL.\n", full_address);
            if (WWW_TraceFlag != 0) {
                // 0x8102762
                fprintf(TraceFP(), "HTAccess: Redirecting to '%s'\n", (char *)redirecting_url);
            }
        }
        // 0x8102783
        if (strcmp(full_address, (char *)redirecting_url) == 0) {
            // 0x8102837
            redirection_attempts++;
            if (redirecting_url != 0) {
                // 0x810284d
                free((int32_t *)redirecting_url);
                redirecting_url = 0;
            }
            // 0x8102864
            permanent_redirection = 0;
            // 0x8102b2a
            return 1;
        }
        // 0x810279f
        if (permanent_redirection != 0) {
            char ** v26 = (char **)(v5 + 80); // 0x81027b8
            HTSACopy(v26, "Location=");
            HTSACat(v26, (char *)redirecting_url);
        }
        // 0x81027d8
        HTSACopy((char **)&use_this_url_instead, (char *)redirecting_url);
        if (v16 != 0) {
            // 0x81027f3
            LYforce_no_cache = 1;
        }
        // 0x81027fa
        redirection_attempts++;
        if (redirecting_url != 0) {
            // 0x8102810
            free((int32_t *)redirecting_url);
            redirecting_url = 0;
        }
        // 0x8102827
        permanent_redirection = 0;
        // 0x8102b2a
        return 0;
      lab_0x8102444:
        // 0x8102444
        if (WWW_TraceFlag != 0) {
            // 0x810244f
            fprintf(TraceFP(), "HTAccess: Document already in memory.\n");
        }
        // 0x8102466
        HText_select(v15);
        int32_t * v27 = HTAnchor_format(v14); // 0x8102477
        if (v27 == HTAtom_for("www/dired")) {
            // 0x810248e
            lynx_edit_mode = 1;
        }
        // 0x8102495
        redirection_attempts = 0;
        // 0x8102b2a
        return 1;
    }
    // 0x8102874
    redirection_attempts = 0;
    if (redirecting_url != 0) {
        // 0x8102887
        free((int32_t *)redirecting_url);
        redirecting_url = 0;
    }
    // 0x810289e
    permanent_redirection = 0;
    if (v19 == 200) {
        // 0x81028ae
        if (WWW_TraceFlag != 0) {
            // 0x81028b9
            fprintf(TraceFP(), "HTAccess: `%s' has been accessed.\n", full_address);
        }
        // 0x8102b2a
        return 1;
    }
    if (v19 == 206) {
        // 0x81028e9
        HTAlert(gettext("Loading incomplete."));
        if (WWW_TraceFlag != 0) {
            // 0x8102908
            fprintf(TraceFP(), "HTAccess: `%s' has been accessed, partial content.\n", full_address);
        }
        // 0x8102b2a
        return 1;
    }
    if (v19 == -204) {
        // 0x8102938
        if (WWW_TraceFlag != 0) {
            // 0x8102943
            fprintf(TraceFP(), "HTAccess: `%s' has been accessed, No data left.\n", full_address);
        }
        // 0x8102b2a
        return 0;
    }
    if (v19 == -0x752f) {
        // 0x8102973
        if (WWW_TraceFlag != 0) {
            // 0x810297e
            fprintf(TraceFP(), "HTAccess: `%s' has been accessed, No data loaded.\n", full_address);
        }
        // 0x8102b2a
        return 0;
    }
    if (v19 == -0x752e) {
        // 0x81029ae
        if (WWW_TraceFlag != 0) {
            // 0x81029b9
            fprintf(TraceFP(), "HTAccess: `%s' has been accessed, transfer interrupted.\n", full_address);
        }
        // 0x8102b2a
        return 0;
    }
    if (v19 >= 1) {
        // 0x81029e6
        fprintf((struct _IO_FILE *)g160, gettext("**** HTAccess: socket or file number returned by obsolete load routine!\n"));
        fprintf((struct _IO_FILE *)g160, gettext("**** HTAccess: Internal software error.  Please mail lynx-dev@nongnu.org!\n"));
        fprintf((struct _IO_FILE *)g160, gettext("**** HTAccess: Status returned was: %d\n"));
        exit_immediately(1);
        // UNREACHABLE
    }
    // 0x8102a55
    text = NULL;
    char * v28 = gettext("Can't Access"); // 0x8102a63
    HTSACopy((char **)&text, v28);
    HTSACat((char **)&text, " `");
    HTSACat((char **)&text, full_address);
    HTSACat((char **)&text, "'");
    mustshow = 1;
    HTProgress((char *)text);
    if (text != NULL) {
        // 0x8102ac8
        free(text);
        text = NULL;
    }
    // 0x8102ada
    if (WWW_TraceFlag != 0) {
        // 0x8102ae5
        fprintf(TraceFP(), "HTAccess: Can't access `%s'\n", full_address);
    }
    // 0x8102b03
    HTLoadError(sink, 500, gettext("Unable to access document."));
    // 0x8102b2a
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8102b34 - 0x8102b93
// Line range:    1111 - 1116
char HTLoadAbsolute(int32_t * docaddr) {
    int32_t * v1 = HTOutputFormat; // 0x8102b49
    if (HTOutputFormat == NULL) {
        // 0x8102b4b
        v1 = HTAtom_for("www/present");
    }
    int32_t * v2 = HTAnchor_findAddress(docaddr); // 0x8102b6b
    return HTLoadDocument((char *)*docaddr, v2, v1, HTOutputStream);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8102b93 - 0x8102c51
// Line range:    1154 - 1183
char HTLoadRelative(char * relative_name, int32_t * here) {
    int32_t v1 = 0; // bp-12, 0x8102b99
    char * v2 = NULL; // bp-36, 0x8102ba7
    HTSACopy((char **)&v1, relative_name);
    char * v3 = HTStrip((char *)v1); // 0x8102be3
    int32_t v4 = *(int32_t *)((int32_t)here + 16); // 0x8102bee
    v2 = HTParse(v3, (char *)v4, 29);
    char result = HTLoadAbsolute((int32_t *)&v2); // 0x8102c11
    if (v2 != NULL) {
        // 0x8102c20
        free((int32_t *)v2);
        v2 = NULL;
    }
    // 0x8102c32
    if (v1 != 0) {
        // 0x8102c39
        free((int32_t *)v1);
        v1 = 0;
    }
    // 0x8102c4b
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8102d36 - 0x8102d4e
// Line range:    1246 - 1250
char hex(int32_t i) {
    // 0x8102d36
    return *(char *)(i + (int32_t)"0123456789ABCDEF");
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAccess.c
// Address range: 0x8102d4e - 0x8102f67
// Line range:    1254 - 1321
char HTSearch(char * keywords, int32_t * here) {
    char * s = NULL; // bp-32, 0x8102d54
    int32_t * mem = calloc(3 * strlen(keywords) + 1, 1); // 0x8102d7c
    if (mem == NULL) {
        // 0x8102d8a
        outofmem("../../../WWW/Library/Implementation/HTAccess.c", "HTSearch");
        // UNREACHABLE
    }
    // 0x8102d9e
    HTSACopy(&s, (char *)*(int32_t *)((int32_t)here + 44));
    char * str = keywords; // 0x8102dc7
    int32_t v1 = (int32_t)keywords; // 0x8102dc7
    if (*keywords < 33) {
        int32_t v2 = (int32_t)keywords + 1; // 0x8102dbb
        char * v3 = (char *)v2;
        str = v3;
        v1 = v2;
        while (*v3 < 33) {
            // 0x8102dbb
            v2 = (int32_t)v3 + 1;
            v3 = (char *)v2;
            str = v3;
            v1 = v2;
        }
    }
    int32_t v4 = strlen(str) + v1; // 0x8102de4
    char * v5 = (char *)v4;
    while (str < v5) {
        // 0x8102df2
        v4--;
        if (*(char *)v4 >= 33) {
            // break -> 0x8102dff
            break;
        }
        v5 = (char *)v4;
    }
    // 0x8102dff
    char * q; // bp-20, 0x8102d4e
    *(int32_t *)&q = v1;
    char * v6 = (char *)v1;
    char * v7 = (char *)mem; // 0x8102ec8
    char * v8 = v6; // 0x8102ec8
    char * v9 = (char *)mem; // 0x8102ec8
    int32_t v10; // 0x8102d4e
    char * v11; // 0x8102d4e
    unsigned char v12; // 0x8102d4e
    if (v6 < v5) {
        while (true) {
          lab_0x8102e10:
            // 0x8102e10
            v11 = v7;
            v12 = *v8;
            if (v12 < 33) {
                // 0x8102e23
                *v11 = 43;
                v10 = (int32_t)v11 + 1;
                goto lab_0x8102ebe;
            } else {
                // 0x8102e32
                if (HTCJK == 0) {
                    if (v12 < 0) {
                        goto lab_0x8102e7d;
                    } else {
                        char v13 = *(char *)((int32_t)v12 + (int32_t)&g72 - 32); // 0x8102e61
                        if (v13 == 0) {
                            goto lab_0x8102e7d;
                        } else {
                            // 0x8102e6c
                            *v11 = v12;
                            v10 = (int32_t)v11 + 1;
                            goto lab_0x8102ebe;
                        }
                    }
                } else {
                    // 0x8102e3b
                    *v11 = v12;
                    v10 = (int32_t)v11 + 1;
                    goto lab_0x8102ebe;
                }
            }
        }
    }
  lab_0x8102ece:
    // 0x8102ece
    *v9 = 0;
    char * found_char_pos = strchr(s, 63); // 0x8102ee2
    if (found_char_pos != NULL) {
        // 0x8102ef0
        *found_char_pos = 0;
    }
    // 0x8102f33
    HTSACat(&s, "?");
    HTSACat(&s, (char *)mem);
    free(mem);
    char result = HTLoadRelative(s, here); // 0x8102f40
    if (s != NULL) {
        // 0x8102f4f
        free((int32_t *)s);
        s = NULL;
    }
    // 0x8102f61
    return result;
  lab_0x8102ebe:
    // 0x8102ebe
    v7 = (char *)v10;
    v8 = (char *)((int32_t)q + 1);
    q = v8;
    v9 = v7;
    if (v8 >= v5) {
        // break -> 0x8102ece
        goto lab_0x8102ece;
    }
    goto lab_0x8102e10;
  lab_0x8102e7d:
    // 0x8102e7d
    *v11 = 37;
    int32_t v14 = (int32_t)v11; // 0x8102e83
    *(char *)(v14 + 1) = hex((int32_t)(v12 / 16));
    *(char *)(v14 + 2) = hex((int32_t)(v12 % 16));
    v10 = v14 + 3;
    goto lab_0x8102ebe;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x81071f5 - 0x8107504
// Line range:    498 - 551
void HTSetSuffix5(char * suffix, char * representation, char * encoding, char * desc, float64_t value) {
    char v1 = 1; // 0x810720c
    if (encoding != NULL) {
        // 0x810720e
        v1 = 1;
        if (*encoding != 0) {
            // 0x8107218
            v1 = 1;
            if (strcmp(encoding, "identity") != 0) {
                // 0x810722f
                v1 = 1;
                if (strcmp(encoding, "8bit") != 0) {
                    // 0x8107246
                    v1 = 1;
                    if (strcmp(encoding, "binary") != 0) {
                        // 0x810725d
                        v1 = strcmp(encoding, "7bit") == 0;
                    }
                }
            }
        }
    }
    int32_t strcmp_rc = strcmp(suffix, "*"); // 0x8107299
    int32_t v2 = &no_suffix; // 0x81072a0
    if (strcmp_rc != 0) {
        int32_t strcmp_rc2 = strcmp(suffix, "*.*"); // 0x81072bc
        v2 = &unknown_suffix;
        if (strcmp_rc2 != 0) {
            // 0x81072d1
            if (HTSuffixes != NULL) {
                int32_t v3 = *(int32_t *)((int32_t)HTSuffixes + 4); // 0x8107410
                int32_t v4 = v3; // 0x810741a
                if (v3 != 0) {
                    int32_t v5 = *(int32_t *)v4; // 0x810741f
                    while (v5 != 0) {
                        int32_t str = *(int32_t *)v5; // 0x81072e1
                        if (str != 0) {
                            // 0x81072eb
                            if (strcmp((char *)str, suffix) == 0) {
                                int32_t * v6 = (int32_t *)(v5 + 8);
                                int32_t v7 = *v6;
                                if (v1 == 0) {
                                    if (v7 != 0) {
                                        // 0x8107393
                                        if (v7 != (int32_t)HTAtom_for("identity")) {
                                            // 0x81073a9
                                            if (*v6 != (int32_t)HTAtom_for("8bit")) {
                                                // 0x81073bf
                                                if (*v6 != (int32_t)HTAtom_for("binary")) {
                                                    // 0x81073d5
                                                    if (*v6 != (int32_t)HTAtom_for("7bit")) {
                                                        // 0x81073eb
                                                        v2 = v5;
                                                        if (strcmp(encoding, (char *)*(int32_t *)(*v6 + 4)) == 0) {
                                                            goto lab_0x81074ae_6;
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    // 0x810730d
                                    v2 = v5;
                                    if (v7 == 0) {
                                        goto lab_0x81074ae_6;
                                    }
                                    // 0x810731b
                                    v2 = v5;
                                    if (v7 == (int32_t)HTAtom_for("identity")) {
                                        goto lab_0x81074ae_6;
                                    }
                                    // 0x8107335
                                    v2 = v5;
                                    if (*v6 == (int32_t)HTAtom_for("8bit")) {
                                        goto lab_0x81074ae_6;
                                    }
                                    // 0x810734f
                                    v2 = v5;
                                    if (*v6 == (int32_t)HTAtom_for("binary")) {
                                        goto lab_0x81074ae_6;
                                    }
                                    // 0x8107369
                                    v2 = v5;
                                    if (*v6 == (int32_t)HTAtom_for("7bit")) {
                                        goto lab_0x81074ae_6;
                                    }
                                }
                            }
                        }
                        int32_t v8 = *(int32_t *)(v4 + 4); // 0x8107410
                        v4 = v8;
                        if (v8 == 0) {
                            // break -> 0x8107443
                            break;
                        }
                        v5 = *(int32_t *)v4;
                    }
                }
            }
            int32_t * mem = calloc(1, 20); // 0x8107452
            if (mem == NULL) {
                // 0x8107460
                outofmem("../../../WWW/Library/Implementation/HTFile.c", "HTSetSuffix");
                // UNREACHABLE
            }
            int32_t * v9 = HTSuffixes; // 0x810747b
            if (HTSuffixes == NULL) {
                // 0x810747d
                v9 = HTList_new();
                *(int32_t *)&HTSuffixes = (int32_t)v9;
            }
            // 0x8107487
            HTList_addObject(v9, (char *)mem);
            HTSACopy((char **)mem, suffix);
            v2 = (int32_t)mem;
        }
    }
  lab_0x81074ae_6:
    // 0x81074ae
    if (representation != NULL) {
        // 0x81074b4
        *(int32_t *)(v2 + 4) = (int32_t)HTAtom_for(representation);
    }
    // 0x81074c7
    *(int32_t *)(v2 + 8) = (int32_t)HTAtom_for(encoding);
    HTSACopy((char **)(v2 + 12), desc);
    *(float32_t *)(v2 + 16) = (float32_t)value;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x81075ea - 0x81076a9
// Line range:    635 - 655
char * HTURLPath_toFile(char * name, char expand_all, char is_remote) {
    char ** v1 = NULL; // bp-12, 0x81075fd
    char * path = NULL; // bp-16, 0x8107604
    HTSACopy((char **)&v1, name);
    char ** v2 = v1;
    if (expand_all == 0) {
        // 0x8107630
        HTUnEscapeSome((char *)v2, "/");
    } else {
        // 0x8107623
        HTUnEscape((char *)v2);
    }
    // 0x8107643
    if (WWW_TraceFlag != 0) {
        // 0x810764e
        fprintf(TraceFP(), "URLPath `%s' means path `%s'\n", name, v1);
    }
    // 0x8107675
    HTSACopy(&path, (char *)v1);
    if (v1 != NULL) {
        // 0x810768e
        free((int32_t *)v1);
        v1 = NULL;
    }
    // 0x81076a0
    return path;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x81076a9 - 0x8107961
// Line range:    674 - 726
char * HTnameOfFile_WWW(char * name, char WWW_prefix, char expand_all) {
    char * str = HTParse(name, (char *)&g73, 16); // 0x81076d4
    char * v1 = HTParse(name, (char *)&g73, 8); // 0x81076f2
    char * v2 = HTParse(name, (char *)&g73, 5); // 0x8107710
    char * path = NULL; // bp-36, 0x8107718
    if (expand_all == 0) {
        // 0x8107732
        HTUnEscapeSome(v2, "/");
    } else {
        // 0x8107725
        HTUnEscape(v2);
    }
    // 0x8107745
    if (strcmp(str, "file") == 0) {
        goto lab_0x810776a;
    } else {
        // 0x810775c
        if (*str != 0) {
            if (WWW_prefix == 0) {
                // 0x81078ba
                HTSACopy(&path, v2);
            } else {
                char * v3 = LYGetEnv("HOME"); // 0x8107874
                HTSprintf0(&path, "%s/WWW/%s/%s%s", v3 != NULL ? v3 : "/tmp", str, v1, v2);
            }
            goto lab_0x81078cc;
        } else {
            goto lab_0x810776a;
        }
    }
  lab_0x810776a:;
    char * v4 = HTHostName(); // 0x810776a
    if (strcasecomp(v1, v4) == 0) {
        goto lab_0x81077a3;
    } else {
        // 0x8107782
        if (strcasecomp(v1, "localhost") == 0) {
            goto lab_0x81077a3;
        } else {
            // 0x8107799
            if (*v1 != 0) {
                if (WWW_prefix == 0) {
                    // 0x8107853
                    HTSACopy(&path, v2);
                } else {
                    // 0x81077f2
                    HTSprintf0(&path, "%s%s%s", "/Net/", v1, v2);
                    if (WWW_TraceFlag != 0) {
                        // 0x810782a
                        fprintf(TraceFP(), "Node `%s' means file `%s'\n", name, path);
                    }
                }
                // 0x81078d2
                free((int32_t *)v1);
                goto lab_0x81078e4;
            } else {
                goto lab_0x81077a3;
            }
        }
    }
  lab_0x81077a3:
    // 0x81077a3
    if (WWW_TraceFlag != 0) {
        // 0x81077ae
        fprintf(TraceFP(), "Node `%s' means path `%s'\n", name, v2);
    }
    // 0x81077d5
    HTSACopy(&path, v2);
    goto lab_0x81078cc;
  lab_0x81078cc:
    if (v1 == NULL) {
        goto lab_0x81078e4;
    } else {
        // 0x81078d2
        free((int32_t *)v1);
        goto lab_0x81078e4;
    }
  lab_0x81078e4:
    if (v2 != NULL) {
        // 0x81078ea
        free((int32_t *)v2);
    }
    if (str != NULL) {
        // 0x8107902
        free((int32_t *)str);
    }
    // 0x8107914
    if (WWW_TraceFlag != 0) {
        // 0x810791f
        fprintf(TraceFP(), "HTnameOfFile_WWW(%s,%d,%d) = %s\n", name, (int32_t)WWW_prefix, (int32_t)expand_all, path);
    }
    // 0x8107956
    return path;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x8107c17 - 0x8107fa7
// Line range:    858 - 934
int32_t * HTFileFormat(char * filename, int32_t ** pencoding, char ** pdesc) {
    if (pencoding != NULL) {
        // 0x8107c24
        *(int32_t *)pencoding = 0;
    }
    if (pdesc != NULL) {
        // 0x8107c33
        *(int32_t *)pdesc = 0;
    }
    // 0x8107c3c
    if (LYforce_HTML_mode != 0) {
        if (pencoding != NULL) {
            // 0x8107c4d
            *(int32_t *)pencoding = (int32_t)HTAtom_for("8bit");
        }
        // 0x8107f9e
        return (int32_t *)(int32_t)HTAtom_for("text/html");
    }
    uint32_t len = strlen(filename); // 0x8107c7a
    int32_t v1 = HTList_count(HTSuffixes); // 0x8107c8a
    int32_t v2; // 0x8107c17
    int32_t v3; // 0x8107c17
    int32_t * v4; // 0x8107c17
    if (v1 > 0) {
        int32_t v5 = (int32_t)NULL; // 0x8107ca4
        char * str = HTList_objectAt(HTSuffixes, v5); // 0x8107cae
        uint32_t len2 = strlen((char *)*(int32_t *)str); // 0x8107cbe
        int32_t v6; // 0x8107c17
        int32_t v7; // 0x8107cae
        int32_t v8; // 0x8107d21
        char * str2; // 0x8107d52
        int32_t len3; // 0x8107d62
        int32_t v9; // 0x8107ed4
        int32_t v10; // 0x8107d94
        if (len >= len2) {
            // 0x8107cd2
            v6 = len - len2 + (int32_t)filename;
            if (strcasecomp((char *)*(int32_t *)str, (char *)v6) == 0) {
                // 0x8107cfc
                v7 = (int32_t)str;
                if (pencoding != NULL) {
                    // 0x8107d02
                    *(int32_t *)pencoding = *(int32_t *)(v7 + 8);
                }
                if (pdesc != NULL) {
                    // 0x8107d13
                    *(int32_t *)pdesc = *(int32_t *)(v7 + 12);
                }
                // 0x8107d1e
                v8 = *(int32_t *)(v7 + 4);
                v9 = 0;
                v2 = v8;
                if (v8 != 0) {
                    // 0x8107f9e
                    return (int32_t *)v2;
                }
                str2 = HTList_objectAt(HTSuffixes, v9);
                len3 = strlen((char *)*(int32_t *)str2);
                if (len3 + len2 <= len) {
                    // 0x8107d7b
                    v10 = *(int32_t *)str2;
                    if (strncasecomp((char *)v10, (char *)(v6 - len3), len3) == 0) {
                        // 0x8107db1
                        v3 = (int32_t)str2;
                        v4 = (int32_t *)(v3 + 4);
                        if (*v4 != 0) {
                            if (pdesc == NULL) {
                                goto lab_0x8107dd9;
                            } else {
                                // 0x8107dc5
                                if (*pdesc != NULL) {
                                    goto lab_0x8107dd9;
                                } else {
                                    // 0x8107dce
                                    *(int32_t *)pdesc = *(int32_t *)(v3 + 12);
                                    goto lab_0x8107dd9;
                                }
                            }
                        }
                    }
                }
                // 0x8107ed4
                v9++;
                while (v9 < v1) {
                    // 0x8107d42
                    str2 = HTList_objectAt(HTSuffixes, v9);
                    len3 = strlen((char *)*(int32_t *)str2);
                    if (len3 + len2 <= len) {
                        // 0x8107d7b
                        v10 = *(int32_t *)str2;
                        if (strncasecomp((char *)v10, (char *)(v6 - len3), len3) == 0) {
                            // 0x8107db1
                            v3 = (int32_t)str2;
                            v4 = (int32_t *)(v3 + 4);
                            if (*v4 != 0) {
                                if (pdesc == NULL) {
                                    goto lab_0x8107dd9;
                                } else {
                                    // 0x8107dc5
                                    if (*pdesc != NULL) {
                                        goto lab_0x8107dd9;
                                    } else {
                                        // 0x8107dce
                                        *(int32_t *)pdesc = *(int32_t *)(v3 + 12);
                                        goto lab_0x8107dd9;
                                    }
                                }
                            }
                        }
                    }
                    // 0x8107ed4
                    v9++;
                }
            }
        }
        int32_t * v11 = (int32_t *)(v5 + 1); // 0x8107ee4
        while (v11 < (int32_t *)v1) {
            // 0x8107c9e
            v5 = (int32_t)v11;
            str = HTList_objectAt(HTSuffixes, v5);
            len2 = strlen((char *)*(int32_t *)str);
            if (len >= len2) {
                // 0x8107cd2
                v6 = len - len2 + (int32_t)filename;
                if (strcasecomp((char *)*(int32_t *)str, (char *)v6) == 0) {
                    // 0x8107cfc
                    v7 = (int32_t)str;
                    if (pencoding != NULL) {
                        // 0x8107d02
                        *(int32_t *)pencoding = *(int32_t *)(v7 + 8);
                    }
                    if (pdesc != NULL) {
                        // 0x8107d13
                        *(int32_t *)pdesc = *(int32_t *)(v7 + 12);
                    }
                    // 0x8107d1e
                    v8 = *(int32_t *)(v7 + 4);
                    v9 = 0;
                    v2 = v8;
                    if (v8 != 0) {
                        // 0x8107f9e
                        return (int32_t *)v2;
                    }
                    str2 = HTList_objectAt(HTSuffixes, v9);
                    len3 = strlen((char *)*(int32_t *)str2);
                    if (len3 + len2 <= len) {
                        // 0x8107d7b
                        v10 = *(int32_t *)str2;
                        if (strncasecomp((char *)v10, (char *)(v6 - len3), len3) == 0) {
                            // 0x8107db1
                            v3 = (int32_t)str2;
                            v4 = (int32_t *)(v3 + 4);
                            if (*v4 != 0) {
                                if (pdesc == NULL) {
                                    goto lab_0x8107dd9;
                                } else {
                                    // 0x8107dc5
                                    if (*pdesc != NULL) {
                                        goto lab_0x8107dd9;
                                    } else {
                                        // 0x8107dce
                                        *(int32_t *)pdesc = *(int32_t *)(v3 + 12);
                                        goto lab_0x8107dd9;
                                    }
                                }
                            }
                        }
                    }
                    // 0x8107ed4
                    v9++;
                    while (v9 < v1) {
                        // 0x8107d42
                        str2 = HTList_objectAt(HTSuffixes, v9);
                        len3 = strlen((char *)*(int32_t *)str2);
                        if (len3 + len2 <= len) {
                            // 0x8107d7b
                            v10 = *(int32_t *)str2;
                            if (strncasecomp((char *)v10, (char *)(v6 - len3), len3) == 0) {
                                // 0x8107db1
                                v3 = (int32_t)str2;
                                v4 = (int32_t *)(v3 + 4);
                                if (*v4 != 0) {
                                    if (pdesc == NULL) {
                                        goto lab_0x8107dd9;
                                    } else {
                                        // 0x8107dc5
                                        if (*pdesc != NULL) {
                                            goto lab_0x8107dd9;
                                        } else {
                                            // 0x8107dce
                                            *(int32_t *)pdesc = *(int32_t *)(v3 + 12);
                                            goto lab_0x8107dd9;
                                        }
                                    }
                                }
                            }
                        }
                        // 0x8107ed4
                        v9++;
                    }
                }
            }
            // 0x8107ee4
            v11 = (int32_t *)(v5 + 1);
        }
    }
    char * found_char_pos = strchr(filename, 46); // 0x8107f02
    int32_t v12 = &no_suffix; // 0x8107f09
    if (found_char_pos != NULL) {
        // 0x8107f0b
        v12 = g156 == 0 ? (int32_t)&no_suffix : (int32_t)&unknown_suffix;
    }
    // 0x8107f33
    if (pencoding != NULL) {
        // 0x8107f3f
        if (*pencoding == NULL) {
            int32_t v13 = *(int32_t *)(v12 + 8); // 0x8107f4b
            int32_t v14 = v13; // 0x8107f50
            if (v13 == 0) {
                // 0x8107f5d
                v14 = (int32_t)HTAtom_for("binary");
            }
            // 0x8107f6c
            *(int32_t *)pencoding = v14;
        }
    }
    int32_t v15 = *(int32_t *)(v12 + 4); // 0x8107f77
    v2 = v15;
    if (v15 == 0) {
        // 0x8107f89
        v2 = (int32_t)HTAtom_for("application/octet-stream");
    }
  lab_0x8107f9e:
    // 0x8107f9e
    return (int32_t *)v2;
  lab_0x8107dd9:
    if (pencoding == NULL) {
        // 0x8107ec6
        v2 = *v4;
        return (int32_t *)v2;
    } else {
        int32_t * v16 = *pencoding;
        if (v16 == NULL) {
            goto lab_0x8107e44;
        } else {
            // 0x8107dec
            if (v16 == HTAtom_for("identity")) {
                goto lab_0x8107e44;
            } else {
                // 0x8107e01
                if (*pencoding == HTAtom_for("8bit")) {
                    goto lab_0x8107e44;
                } else {
                    // 0x8107e16
                    if (*pencoding == HTAtom_for("binary")) {
                        goto lab_0x8107e44;
                    } else {
                        // 0x8107e2b
                        if (*pencoding != HTAtom_for("7bit")) {
                            // 0x8107ec6
                            v2 = *v4;
                            return (int32_t *)v2;
                        } else {
                            goto lab_0x8107e44;
                        }
                    }
                }
            }
        }
    }
  lab_0x8107e44:
    // 0x8107e44
    if (*pencoding == HTAtom_for("7bit")) {
        // 0x8107ec6
        v2 = *v4;
        return (int32_t *)v2;
    } else {
        int32_t * v17 = (int32_t *)(v3 + 8); // 0x8107e5c
        int32_t v18 = *v17; // 0x8107e5c
        if (v18 == 0) {
            // 0x8107ec6
            v2 = *v4;
            return (int32_t *)v2;
        } else {
            // 0x8107e63
            if (v18 == (int32_t)HTAtom_for("identity")) {
                // 0x8107ec6
                v2 = *v4;
                return (int32_t *)v2;
            } else {
                // 0x8107e79
                if (*v17 == (int32_t)HTAtom_for("8bit")) {
                    // 0x8107ec6
                    v2 = *v4;
                    return (int32_t *)v2;
                } else {
                    // 0x8107e8f
                    if (*v17 == (int32_t)HTAtom_for("binary")) {
                        // 0x8107ec6
                        v2 = *v4;
                        return (int32_t *)v2;
                    } else {
                        // 0x8107ea5
                        if (*v17 == (int32_t)HTAtom_for("7bit")) {
                            // 0x8107ec6
                            v2 = *v4;
                            return (int32_t *)v2;
                        } else {
                            // 0x8107ebb
                            *(int32_t *)pencoding = *v17;
                            // 0x8107ec6
                            v2 = *v4;
                            return (int32_t *)v2;
                        }
                    }
                }
            }
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x8107fa7 - 0x81085c6
// Line range:    947 - 1097
int32_t * HTCharsetFormat(int32_t * format2, int32_t * anchor, int32_t default_LYhndl) {
    int32_t str = 0; // bp-16, 0x8107fae
    char * cp1 = NULL; // bp-28, 0x8107fb5
    int32_t v1 = (int32_t)anchor + 36; // 0x8107fca
    int32_t * v2 = (int32_t *)v1; // 0x8107fca
    int32_t v3 = *v2; // 0x8107fca
    if (v3 != 0) {
        // 0x8107fd1
        free((int32_t *)v3);
        *v2 = 0;
    }
    int32_t v4 = (int32_t)format2;
    int32_t * v5 = (int32_t *)(v4 + 4); // 0x8107fec
    HTSACopy((char **)&str, (char *)*v5);
    LYLowerCase((char *)str);
    char * found_char_pos = strchr((char *)str, 59); // 0x8108017
    int32_t v6 = v4; // 0x8108023
    char v7 = 0; // 0x8108023
    int32_t v8; // 0x8107fa7
    char * cp2; // bp-32, 0x8107fa7
    int32_t v9; // 0x8107fa7
    char * str2; // 0x8107fa7
    int32_t v10; // 0x8107fa7
    if (found_char_pos == NULL) {
        goto lab_0x8108549;
    } else {
        char * substr_pos = strstr(found_char_pos, "charset"); // 0x8108037
        if (substr_pos == NULL) {
            // 0x8108535
            *found_char_pos = 0;
            v6 = (int32_t)HTAtom_for((char *)str);
            v7 = 0;
            goto lab_0x8108549;
        } else {
            // 0x8108049
            if (WWW_TraceFlag != 0) {
                // 0x8108054
                fprintf(TraceFP(), "HTCharsetFormat: Extended MIME Content-Type is %s\n", (char *)*v5);
            }
            int32_t v11 = (int32_t)substr_pos + 7; // 0x8108079
            char * v12; // 0x8107fa7
            while (true) {
              lab_0x810807f:;
                int32_t v13 = v11;
                v12 = (char *)v13;
                switch (*v12) {
                    case 32: {
                        // 0x810807b
                        v11 = v13 + 1;
                        goto lab_0x810807f;
                    }
                    case 61: {
                        // 0x810807b
                        v11 = v13 + 1;
                        goto lab_0x810807f;
                    }
                    default: {
                        goto lab_0x8108093;
                    }
                }
            }
          lab_0x8108093:
            // 0x8108093
            HTSACopy(&cp1, v12);
            int32_t v14 = (int32_t)cp1;
            *(int32_t *)&cp2 = v14;
            int32_t v15 = v14; // 0x81080ab
            char * v16; // 0x8107fa7
            while (true) {
              lab_0x81080b1:
                // 0x81080b1
                v16 = (char *)v15;
                unsigned char v17 = *v16; // 0x81080b4
                switch (v17) {
                    case 0: {
                        goto lab_0x81080e3;
                    }
                    case 34: {
                        goto lab_0x81080e3;
                    }
                    case 59: {
                        goto lab_0x81080e3;
                    }
                    case 58: {
                        goto lab_0x81080e3;
                    }
                    default: {
                        // 0x81080d9
                        v15++;
                        if (v17 < 33) {
                            // break -> 0x81080e3
                            break;
                        }
                        goto lab_0x81080b1;
                    }
                }
            }
          lab_0x81080e3:
            // 0x81080e3
            *v16 = 0;
            str2 = cp1;
            v10 = (int32_t)str2;
            *(int32_t *)&cp2 = v10;
            int32_t v18 = UCGetLYhndl_byMIME(str2); // 0x81080f5
            if (UCCanTranslateFromTo(v18, current_char_set) == 0) {
                if (v18 >= 0) {
                    goto lab_0x8108335;
                } else {
                    int32_t v19 = UCLYhndl_for_unrec; // 0x810816c
                    int32_t v20 = v19 >= 0 ? v19 : UCLYhndl_for_unspec;
                    if (UCCanTranslateFromTo(v20, current_char_set) == 0) {
                        goto lab_0x8108335;
                    } else {
                        // 0x810819a
                        HTAnchor_setUCInfoStage(anchor, v20, 0, 1);
                        v8 = v20;
                        v9 = v4;
                        goto lab_0x81081ca;
                    }
                }
            } else {
                // 0x8108115
                *found_char_pos = 0;
                int32_t * v21 = HTAtom_for((char *)str); // 0x8108125
                HTSACopy((char **)v1, str2);
                HTAnchor_setUCInfoStage(anchor, v18, 0, 5);
                v8 = v18;
                v9 = (int32_t)v21;
                goto lab_0x81081ca;
            }
        }
    }
  lab_0x8108549:
    // 0x8108549
    if (str != 0) {
        // 0x8108550
        free((int32_t *)str);
        str = 0;
    }
    if (v7 != 0) {
        // 0x810859a
        HTAnchor_copyUCInfoStage(anchor, 1, 0, -1);
        return (int32_t *)v6;
    }
    // 0x8108568
    if (!((default_LYhndl < 0 | *v2 != 0))) {
        // 0x8108578
        HTAnchor_setUCInfoStage(anchor, default_LYhndl, 0, 1);
    }
    // 0x810859a
    HTAnchor_copyUCInfoStage(anchor, 1, 0, -1);
    return (int32_t *)v6;
  lab_0x8108335:;
    // 0x8108335
    bool v22; // 0x8107fa7
    if (strncmp(str2, "iso-8859-", 9) != 0) {
        goto lab_0x8108398;
    } else {
        int16_t * v23 = *__ctype_b_loc(); // 0x8108359
        unsigned char v24 = *(char *)(v10 + 9); // 0x8108361
        v22 = false;
        if ((*(int16_t *)(2 * (int32_t)v24 + (int32_t)v23) & 2048) == 0) {
            goto lab_0x8108398;
        } else {
            goto lab_0x8108412;
        }
    }
  lab_0x81081ca:;
    int32_t * v25 = HTAnchor_getUCInfoStage(anchor, 0); // 0x81081d8
    int32_t * v26 = HTAnchor_setUCInfoStage(anchor, current_char_set, 3, 1); // 0x81081ff
    int32_t * v27 = v26; // 0x810820b
    if (v26 == NULL) {
        // 0x810820d
        v27 = HTAnchor_getUCInfoStage(anchor, 3);
    }
    int32_t v28 = (int32_t)v25; // 0x8108223
    int32_t * str3 = (int32_t *)(v28 + 4); // 0x8108226
    if (strcmp((char *)*str3, "x-transparent") == 0) {
        // 0x810823d
        HTPassEightBitRaw = 1;
        HTAnchor_setUCInfoStage(anchor, HTAnchor_getUCLYhndl(anchor, 3), 0, 1);
    }
    int32_t v29 = (int32_t)v27;
    int32_t * str4 = (int32_t *)(v29 + 4); // 0x8108279
    if (strcmp((char *)*str4, "x-transparent") == 0) {
        // 0x8108290
        HTPassEightBitRaw = 1;
        HTAnchor_setUCInfoStage(anchor, HTAnchor_getUCLYhndl(anchor, 0), 3, 1);
    }
    // 0x81082c9
    int32_t v30; // 0x8107fa7
    char v31; // 0x8107fa7
    if (*(int32_t *)(v28 + 8) == 5) {
        // 0x8108309
        v31 = 1;
        v30 = v9;
        if (*(int32_t *)(v29 + 8) == 5) {
            // 0x8108318
            Set_HTCJK((char *)*str3, (char *)*str4);
            v31 = 1;
            v30 = v9;
        }
    } else {
        // 0x81082d4
        HTCJK = 0;
        v31 = 1;
        v30 = v9;
        if (*(int32_t *)(v28 + 20) % 2 == 0) {
            // 0x81082ef
            v31 = 1;
            v30 = v9;
            if (current_char_set == v8) {
                // 0x81082fd
                HTPassEightBitRaw = 1;
                v31 = 1;
                v30 = v9;
            }
        }
    }
    goto lab_0x8108514;
  lab_0x8108398:
    // 0x8108398
    v22 = true;
    char * v34; // 0x8107fa7
    int32_t v35; // 0x8107fa7
    if (strncmp(str2, "windows-", 8) == 0) {
        goto lab_0x8108412;
    } else {
        // 0x81083b7
        v22 = true;
        if (strncmp(str2, "cp12", 4) == 0) {
            goto lab_0x8108412;
        } else {
            int32_t strncmp_rc = strncmp(str2, "cp-12", 5); // 0x81083ec
            v22 = true;
            v34 = str2;
            v35 = v4;
            if (strncmp_rc != 0) {
                goto lab_0x81084ee;
            } else {
                goto lab_0x8108412;
            }
        }
    }
  lab_0x8108514:
    // 0x8108514
    v6 = v30;
    v7 = v31;
    if (cp1 != NULL) {
        // 0x810851b
        free((int32_t *)cp1);
        cp1 = NULL;
        v6 = v30;
        v7 = v31;
    }
    goto lab_0x8108549;
  lab_0x8108412:;
    int32_t str5 = *(int32_t *)(4 * current_char_set + (int32_t)&LYchar_set_names); // 0x8108417
    int32_t v32; // 0x8107fa7
    bool v33; // 0x8107fa7
    if (strstr((char *)str5, "ISO-8859") != NULL) {
        goto lab_0x810846f;
    } else {
        int32_t str6 = *(int32_t *)(4 * current_char_set + (int32_t)&LYchar_set_names); // 0x8108437
        if (strstr((char *)str6, "windows-") == NULL) {
            // 0x8108483
            v32 = v4;
            v33 = true;
            v34 = str2;
            v35 = v4;
            if (v22) {
                goto lab_0x81084ee;
            } else {
                goto lab_0x8108489;
            }
        } else {
            goto lab_0x810846f;
        }
    }
  lab_0x810846f:
    // 0x810846f
    *found_char_pos = 0;
    int32_t v36 = (int32_t)HTAtom_for((char *)str); // 0x810847b
    v32 = v36;
    v33 = false;
    char * v37 = str2; // 0x8108487
    int32_t v38 = v36; // 0x8108487
    if (v22) {
        goto lab_0x81084d2;
    } else {
        goto lab_0x8108489;
    }
  lab_0x81084d2:
    // 0x81084d2
    HTSACopy((char **)v1, v37);
    HTPassEightBitRaw = 1;
    v34 = v37;
    v35 = v38;
    goto lab_0x81084ee;
  lab_0x8108489:;
    char * v40 = (char *)(v10 + 10);
    char * v41 = v40; // 0x81084a0
    char * v42 = v40; // 0x81084a0
    if (*v40 != 0) {
        int16_t v43 = *(int16_t *)(2 * (int32_t)*v41 + (int32_t)*__ctype_b_loc()); // 0x81084b7
        v42 = v41;
        while ((v43 & 2048) != 0) {
            char * v44 = (char *)((int32_t)v41 + 1);
            v41 = v44;
            v42 = v44;
            if (*v44 == 0) {
                // break -> 0x81084cc
                break;
            }
            v43 = *(int16_t *)(2 * (int32_t)*v41 + (int32_t)*__ctype_b_loc());
            v42 = v41;
        }
    }
    // 0x81084cc
    *v42 = 0;
    v37 = cp2;
    v38 = v32;
    v34 = cp2;
    v35 = v32;
    if (v33) {
        goto lab_0x81084ee;
    } else {
        goto lab_0x81084d2;
    }
  lab_0x81084ee:;
    // 0x81084ee
    int32_t v39; // 0x8107fa7
    if (*v34 != 0) {
        // 0x8108503
        v39 = (int32_t)v34;
    } else {
        // 0x81084f8
        v39 = *v2;
    }
    // 0x8108509
    HTAlert((char *)v39);
    v31 = 0;
    v30 = v35;
    goto lab_0x8108514;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x81085c6 - 0x81087d0
// Line range:    1126 - 1174
void LYGetFileInfo(char * filename, int32_t ** pfile_anchor, int32_t ** pformat, int32_t ** pencoding, char ** pdesc, char ** pcharset, int32_t * pfile_cs) {
    char * Afn = NULL; // bp-12, 0x81085cc
    char * Aname = NULL; // bp-20, 0x81085d3
    char * v1 = HTEscape(filename, 4); // 0x81085e8
    LYLocalFileToURL(&Afn, v1);
    int32_t * v2 = HTAnchor_findSimpleAddress(Afn); // 0x8108608
    int32_t v3 = (int32_t)v2; // 0x8108610
    int32_t v4 = *(int32_t *)(v3 + 36); // 0x8108613
    int32_t * v5 = HTFileFormat(filename, (int32_t **)&Aname, pdesc); // 0x810862d
    int32_t * v6 = HTCharsetFormat(v5, v2, UCLYhndl_HTFile_for_unspec); // 0x810864b
    uint32_t v7 = HTAnchor_getUCLYhndl(v2, 0); // 0x8108661
    int32_t * v8 = (int32_t *)v4; // 0x810866d
    if (v4 == 0) {
        // 0x810866f
        v8 = (int32_t *)"display character set";
        if (v7 >= 0) {
            int32_t v9 = *(int32_t *)(32 * v7 + (int32_t)&g143); // 0x810867b
            v8 = (int32_t *)v9;
        }
    }
    // 0x810868d
    if (WWW_TraceFlag != 0) {
        char * v10 = (char *)*(int32_t *)((int32_t)v6 + 4);
        char * v11; // 0x81085c6
        char * v12; // 0x81085c6
        if (Aname == NULL) {
            // 0x81086d9
            v11 = *v10 != 97 ? (char *)&g73 : (char *)&g74;
            v12 = (char *)&g73;
        } else {
            char * v13 = (char *)*(int32_t *)((int32_t)Aname + 4);
            v11 = *v13 == 56 ? (char *)&g74 : (char *)&g73;
            v12 = v13;
        }
        // 0x8108714
        fprintf(TraceFP(), "GetFileInfo: '%s' is a%s %s %s file, charset=%s (%d).\n", filename, v11, v12, v10, v8, v7);
    }
    if (v1 != NULL) {
        // 0x810875d
        free((int32_t *)v1);
    }
    // 0x810876f
    if (Afn != NULL) {
        // 0x8108776
        free((int32_t *)Afn);
        Afn = NULL;
    }
    if (pfile_anchor != NULL) {
        // 0x810878e
        *(int32_t *)pfile_anchor = v3;
    }
    if (pformat != NULL) {
        // 0x810879c
        *(int32_t *)pformat = (int32_t)v6;
    }
    if (pencoding != NULL) {
        // 0x81087aa
        *(int32_t *)pencoding = (int32_t)Aname;
    }
    if (pcharset != NULL) {
        // 0x81087b8
        *(int32_t *)pcharset = (int32_t)v8;
    }
    if (pfile_cs != NULL) {
        // 0x81087c6
        *pfile_cs = v7;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x81088ba - 0x8108a6d
// Line range:    1213 - 1247
int32_t HTCompressFileType(char * filename, char * dots, int32_t * rootlen) {
    int32_t v1 = (int32_t)filename;
    uint32_t len = strlen(filename); // 0x81088cf
    int32_t v2 = len + v1; // 0x81088dd
    int32_t v3; // 0x81088ba
    int32_t result; // 0x81088ba
    if (len < 5) {
        if (len == 4) {
            goto lab_0x8108937;
        } else {
            // 0x81089cc
            v3 = v2;
            result = 0;
            if (len < 3) {
                goto lab_0x8108a16;
            } else {
                goto lab_0x81089d2;
            }
        }
    } else {
        // 0x81088e8
        if (strcasecomp((char *)(v2 - 3), "bz2") != 0) {
            goto lab_0x8108937;
        } else {
            int32_t c = v2 - 4; // 0x8108905
            v3 = c;
            result = 3;
            if (strchr(dots, (int32_t)*(char *)c) == NULL) {
                goto lab_0x8108937;
            } else {
                goto lab_0x8108a16;
            }
        }
    }
  lab_0x8108937:;
    char * v4 = (char *)(v2 - 2);
    if (strcasecomp(v4, "gz") != 0) {
        goto lab_0x8108986;
    } else {
        int32_t c2 = v2 - 3; // 0x8108954
        v3 = c2;
        result = 2;
        if (strchr(dots, (int32_t)*(char *)c2) == NULL) {
            goto lab_0x8108986;
        } else {
            goto lab_0x8108a16;
        }
    }
  lab_0x8108986:
    // 0x8108986
    if (strcasecomp(v4, "zz") != 0) {
        goto lab_0x81089d2;
    } else {
        int32_t c3 = v2 - 3; // 0x81089a3
        v3 = c3;
        result = 4;
        if (strchr(dots, (int32_t)*(char *)c3) == NULL) {
            goto lab_0x81089d2;
        } else {
            goto lab_0x8108a16;
        }
    }
  lab_0x8108a16:
    // 0x8108a16
    *rootlen = v3 - v1;
    if (WWW_TraceFlag != 0) {
        // 0x8108a2e
        fprintf(TraceFP(), "HTCompressFileType(%s) returns %d:%s\n", filename, result, (char *)v3);
    }
    // 0x8108a63
    return result;
  lab_0x81089d2:;
    int32_t strcmp_rc = strcmp((char *)(v2 - 1), "Z"); // 0x81089e3
    v3 = v2;
    result = 0;
    if (strcmp_rc == 0) {
        int32_t c4 = v2 - 2; // 0x81089ef
        char * found_char_pos = strchr(dots, (int32_t)*(char *)c4); // 0x8108a02
        v3 = found_char_pos == NULL ? v2 : c4;
        result = found_char_pos != NULL;
    }
    goto lab_0x8108a16;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x8108a6d - 0x8108ad0
// Line range:    1253 - 1275
char * HTCompressTypeToSuffix(uint32_t method) {
    char * result = ".gz"; // 0x8108a84
    if (method == 2) {
        // 0x8108acb
        return result;
    }
    if (method < 3) {
        // 0x8108a8c
        return method == 1 ? ".Z" : (char *)&g73;
    }
    // 0x8108a94
    result = (char *)&g73;
    switch (method) {
        case 3: {
            // 0x8108abb
            result = ".bz2";
            // break -> 0x8108acb
            break;
        }
        case 4: {
            // 0x8108ac4
            result = ".zz";
            // break -> 0x8108acb
            break;
        }
    }
    // 0x8108acb
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x8108b33 - 0x8108c34
// Line range:    1314 - 1333
int32_t HTEncodingToCompressType(char * coding) {
    // 0x8108b33
    if (coding == NULL) {
        // 0x8108c2f
        return 0;
    }
    // 0x8108b52
    if (strcasecomp(coding, "gzip") == 0 || strcasecomp(coding, "x-gzip") == 0) {
        // 0x8108c2f
        return 2;
    }
    // 0x8108b8c
    if (strcasecomp(coding, "compress") == 0 || strcasecomp(coding, "x-compress") == 0) {
        // 0x8108c2f
        return 1;
    }
    // 0x8108bc3
    if (strcasecomp(coding, "bzip2") == 0 || strcasecomp(coding, "x-bzip2") == 0) {
        // 0x8108c2f
        return 3;
    }
    // 0x8108bfa
    if (strcasecomp(coding, "deflate") == 0) {
        // 0x8108c2f
        return 4;
    }
    // 0x8108c11
    if (strcasecomp(coding, "x-deflate") != 0) {
        // 0x8108c2f
        return 0;
    }
    // 0x8108c2f
    return 4;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x8108c34 - 0x8108d2e
// Line range:    1336 - 1352
int32_t HTContentTypeToCompressType(char * ct) {
    // 0x8108c34
    if (ct == NULL) {
        // 0x8108d29
        return 0;
    }
    // 0x8108c53
    if (strncasecomp(ct, "application/gzip", 16) == 0 || strncasecomp(ct, "application/x-gzip", 18) == 0) {
        // 0x8108d29
        return 2;
    }
    // 0x8108c9d
    if (strncasecomp(ct, "application/compress", 20) == 0 || strncasecomp(ct, "application/x-compress", 22) == 0) {
        // 0x8108d29
        return 1;
    }
    // 0x8108ce4
    if (strncasecomp(ct, "application/bzip2", 17) == 0) {
        // 0x8108d29
        return 3;
    }
    // 0x8108d03
    if (strncasecomp(ct, "application/x-bzip2", 19) != 0) {
        // 0x8108d29
        return 0;
    }
    // 0x8108d29
    return 3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x8108d2e - 0x8108d8c
// Line range:    1359 - 1370
int32_t HTContentToCompressType(int32_t * anchor) {
    char * v1 = HTAnchor_content_type(anchor); // 0x8108d41
    char * v2 = HTAnchor_content_encoding(anchor); // 0x8108d4f
    if (v1 != NULL && v2 == NULL) {
        // 0x8108d87
        return HTContentTypeToCompressType(v1);
    }
    int32_t result = 0; // 0x8108d77
    if (v2 != NULL) {
        // 0x8108d79
        result = HTEncodingToCompressType(v2);
    }
    // 0x8108d87
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x8108d8c - 0x8108f37
// Line range:    1383 - 1429
char HTEditable(char * filename) {
    int32_t groups[65536]; // bp-262276, 0x8108d8c
    int32_t v1[65536]; // 0x8108dfa
    int32_t grouplist[1]; // 0x8108dcb
    // 0x8108d8c
    int32_t v2; // bp-128, 0x8108d8c
    if (stat64((int32_t)filename, &v2) != 0) {
        // 0x8108f25
        return 0;
    }
    // 0x8108dba
    int32_t v3; // bp-4, 0x8108d8c
    int32_t v4 = &v3; // 0x8108d8d
    int32_t v5; // bp-262272, 0x8108d8c
    grouplist[0] = &v5;
    int32_t v6 = getgroups(0x10000, grouplist); // 0x8108dcb
    int32_t v7 = geteuid(); // 0x8108dd3
    int32_t v8; // 0x8108d8c
    if (WWW_TraceFlag != 0) {
        // 0x8108dea
        v1[0] = v8;
        groups = v1;
        struct _IO_FILE * stream = TraceFP(); // 0x8108e00
        fprintf(stream, "File mode is 0%o, uid=%d, gid=%d. My uid=%d, %d groups (", groups[0], v8, v8, v7, v6);
        if (v6 > 0) {
            int32_t v9 = 0; // 0x8108e62
            fprintf(TraceFP(), " %d", *(int32_t *)(v4 - 0x4007c + 4 * v9));
            v9++;
            while (v9 != v6) {
                // 0x8108e3d
                fprintf(TraceFP(), " %d", *(int32_t *)(v4 - 0x4007c + 4 * v9));
                v9++;
            }
        }
        // 0x8108e6e
        fwrite((int32_t *)")\n", 1, 2, TraceFP());
    }
    // 0x8108e93
    if ((v8 & 2) != 0 || (char)v8 <= -1 && v8 == v7) {
        // 0x8108f25
        return 1;
    }
    if ((v8 & 16) != 0 != v6 > 0) {
      lab_0x8108efc:
        // 0x8108efc
        if (WWW_TraceFlag != 0) {
            // 0x8108f07
            fprintf(TraceFP(), "\tFile is not editable.\n");
        }
        // 0x8108f25
        return 0;
    }
    int32_t v10 = 0; // 0x8108ef0
    while (*(int32_t *)(v4 - 0x4007c + 4 * v10) != v8) {
        // 0x8108ef4
        v10++;
        if (v10 >= v6) {
            goto lab_0x8108efc;
        }
    }
    // 0x8108f25
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x810aac2 - 0x810ab5e
// Line range:    2238 - 2263
int32_t HTStat(char * filename, int32_t * data) {
    int32_t len = strlen(filename); // 0x810aad5
    int32_t v1 = (int32_t)filename;
    if (len == 0 || *(char *)(v1 - 1 + len) != 47) {
        // 0x810ab59
        return stat64(v1, data);
    }
    int32_t result = 0; // bp-16, 0x810aaf3
    HTSprintf0((char **)&result, "%s.", filename);
    int32_t result2 = HTStat((char *)result, data); // 0x810ab21
    if (result != 0) {
        // 0x810ab30
        free((int32_t *)result);
        result = 0;
    }
    // 0x810ab59
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x810bfc9 - 0x810bff4
// Line range:    2985 - 2991
char * HTGetProgramPath(int32_t code) {
    char * result = NULL; // 0x810bfda
    if (code < 24) {
        int32_t v1 = *(int32_t *)(4 * code + (int32_t)&program_paths); // 0x810bfe5
        result = (char *)v1;
    }
    // 0x810bfef
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x810bff4 - 0x810c03a
// Line range:    2998 - 3002
void HTSetProgramPath(int32_t code, char * path) {
    if ((uint32_t)(code - 1) >= 23) {
        // 0x810c038
        return;
    }
    int32_t v1 = 0; // 0x810c010
    if (path != NULL) {
        // 0x810c012
        v1 = *path == 0 ? 0 : (int32_t)path;
    }
    // 0x810c02b
    *(int32_t *)(4 * code + (int32_t)&program_paths) = v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFile.c
// Address range: 0x810c03a - 0x810c138
// Line range:    3008 - 3141
void HTInitProgramPaths(void) {
    for (int32_t i = 1; i < 24; i++) {
        // 0x810c04c
        g384 = i;
        int32_t v1 = &g75; // 0x810c068
        switch (i) {
            case 3: {
                // 0x810c073
                v1 = (int32_t)"/usr/bin/compress";
            }
            case 1: {
                char * v2 = HTGetProgramPath(i); // 0x810c0f5
                if (v2 != NULL && v1 != (int32_t)v2) {
                    // 0x810c10b
                    free((int32_t *)v2);
                }
                // break -> 0x810c116
                break;
            }
            case 6: {
                // 0x810c07c
                v1 = (int32_t)"/bin/gzip";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 8: {
                // 0x810c085
                v1 = (int32_t)"/usr/bin/install";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 10: {
                // 0x810c08e
                v1 = (int32_t)"/bin/mv";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 11: {
                // 0x810c097
                v1 = (int32_t)"/usr/bin/rlogin";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 12: {
                // 0x810c0a0
                v1 = (int32_t)"/bin/rm";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 15: {
                // 0x810c0a9
                v1 = (int32_t)"/bin/tar";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 16: {
                // 0x810c0b2
                v1 = (int32_t)"/usr/bin/telnet";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 19: {
                // 0x810c0bb
                v1 = (int32_t)"/bin/gunzip";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 20: {
                // 0x810c0c4
                v1 = (int32_t)"/usr/bin/unzip";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 21: {
                // 0x810c0cd
                v1 = (int32_t)"/usr/bin/uudecode";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 22: {
                // 0x810c0d6
                v1 = (int32_t)"/bin/zcat";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            case 23: {
                // 0x810c0df
                v1 = (int32_t)"/usr/bin/zip";
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
            default: {
                // 0x810c0e8
                v1 = 0;
                // branch (via goto) -> 0x810c0ef
                goto lab_0x810c0ef;
            }
        }
        // 0x810c116
        HTSetProgramPath(i, (char *)v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTBTree.c
// Address range: 0x810c138 - 0x810c17e
// Line range:    21 - 31
int32_t * HTBTree_new(int32_t (*comp)(char *, char *)) {
    int32_t * mem = malloc(8); // 0x810c145
    if (mem == NULL) {
        // 0x810c153
        outofmem("../../../WWW/Library/Implementation/HTBTree.c", "HTBTree_new");
        // UNREACHABLE
    }
    // 0x810c167
    *mem = (int32_t)comp;
    *(int32_t *)((int32_t)mem + 4) = 0;
    return mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTBTree.c
// Address range: 0x810c17e - 0x810c1d4
// Line range:    37 - 45
void HTBTElement_free(int32_t * element) {
    if (element == NULL) {
        // 0x810c1d2
        return;
    }
    int32_t v1 = (int32_t)element;
    int32_t v2 = *(int32_t *)(v1 + 8); // 0x810c18d
    if (v2 != 0) {
        // 0x810c194
        HTBTElement_free((int32_t *)v2);
    }
    int32_t v3 = *(int32_t *)(v1 + 16); // 0x810c1a5
    if (v3 != 0) {
        // 0x810c1ac
        HTBTElement_free((int32_t *)v3);
    }
    // 0x810c1c0
    free(element);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTBTree.c
// Address range: 0x810c1d4 - 0x810c202
// Line range:    51 - 54
void HTBTree_free(int32_t * tree) {
    // 0x810c1d4
    HTBTElement_free((int32_t *)*(int32_t *)((int32_t)tree + 4));
    if (tree != NULL) {
        // 0x810c1ee
        free(tree);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTBTree.c
// Address range: 0x810c2a5 - 0x810c311
// Line range:    85 - 100
char * HTBTree_search(int32_t * tree, char * object) {
    int32_t v1 = (int32_t)tree + 4; // 0x810c2b4
    char * result; // 0x810c2a5
    while (true) {
      lab_0x810c2ff_2:;
        int32_t v2 = *(int32_t *)v1;
        result = NULL;
        if (v2 == 0) {
            return result;
        }
        if (object == NULL) {
            // 0x810c2d5
            result = (char *)*(int32_t *)v2;
            return result;
        }
        while (object >= NULL) {
            if (object >= (char *)1) {
                // 0x810c2ff
                v1 = v2 + 16;
                goto lab_0x810c2ff_2;
            }
            result = NULL;
            if (v2 == 0) {
                return result;
            }
            if (object == NULL) {
                // 0x810c2d5
                result = (char *)*(int32_t *)v2;
                return result;
            }
        }
        // 0x810c2ff
        v1 = v2 + 8;
        goto lab_0x810c2ff_2;
    }
  lab_0x810c30c:
    // 0x810c30c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTBTree.c
// Address range: 0x810c311 - 0x810cb95
// Line range:    110 - 451
void HTBTree_add(int32_t * tree, char * object) {
    int32_t * v1 = (int32_t *)((int32_t)tree + 4); // 0x810c31d
    int32_t v2 = *v1; // 0x810c31d
    if (v2 == 0) {
        int32_t * mem = malloc(24); // 0x810c32f
        int32_t v3 = (int32_t)mem; // 0x810c32f
        *v1 = v3;
        if (mem == NULL) {
            // 0x810c346
            outofmem("../../../WWW/Library/Implementation/HTBTree.c", "HTBTree_add");
            // UNREACHABLE
        }
        // 0x810c35a
        *(int32_t *)(v3 + 4) = 0;
        *(int32_t *)*v1 = (int32_t)object;
        *(int32_t *)(*v1 + 8) = 0;
        *(int32_t *)(*v1 + 12) = 0;
        *(int32_t *)(*v1 + 16) = 0;
        *(int32_t *)(*v1 + 20) = 0;
        // 0x810cb93
        return;
    }
    int32_t * father_of_element = NULL; // bp-16, 0x810c3b8
    int32_t v4 = (int32_t)object;
    int32_t v5 = v2; // 0x810c311
    int32_t v6; // 0x810c311
    int32_t * v7; // 0x810c311
    while (true) {
        // 0x810c3d2
        v6 = v5;
        if (object >= NULL) {
            // 0x810c48a
            v7 = (int32_t *)(v6 + 16);
            int32_t v8 = *v7; // 0x810c48d
            v5 = v8;
            if (v8 == 0) {
                // break -> 0x810c49f
                break;
            }
        } else {
            int32_t * v9 = (int32_t *)(v6 + 8);
            int32_t v10 = *v9; // 0x810c3f8
            v5 = v10;
            if (v10 == 0) {
                int32_t * mem2 = malloc(24); // 0x810c418
                int32_t v11 = (int32_t)mem2; // 0x810c418
                *v9 = v11;
                if (mem2 == NULL) {
                    // 0x810c42f
                    outofmem("../../../WWW/Library/Implementation/HTBTree.c", "HTBTree_add");
                    // UNREACHABLE
                }
                // 0x810c443
                father_of_element = mem2;
                *(int32_t *)(v11 + 4) = v6;
                *mem2 = v4;
                *(int32_t *)(v11 + 8) = 0;
                *(int32_t *)(v11 + 12) = 0;
                *(int32_t *)(v11 + 16) = 0;
                *(int32_t *)(v11 + 20) = 0;
                goto lab_0x810c521;
            }
        }
    }
    int32_t * mem3 = malloc(24); // 0x810c4aa
    int32_t v12 = (int32_t)mem3; // 0x810c4aa
    *v7 = v12;
    if (mem3 == NULL) {
        // 0x810c4c1
        outofmem("../../../WWW/Library/Implementation/HTBTree.c", "HTBTree_add");
        // UNREACHABLE
    }
    // 0x810c4d5
    father_of_element = mem3;
    *(int32_t *)(v12 + 4) = v6;
    *mem3 = v4;
    *(int32_t *)(v12 + 8) = 0;
    *(int32_t *)(v12 + 12) = 0;
    *(int32_t *)(v12 + 16) = 0;
    *(int32_t *)(v12 + 20) = 0;
    goto lab_0x810c521;
  lab_0x810c521:;
    int32_t v13 = (int32_t)father_of_element;
    int32_t * father_of_element2; // bp-20, 0x810c311
    *(int32_t *)&father_of_element2 = v13;
    int32_t v14 = v6;
    int32_t v15; // 0x810c311
    int32_t v16; // 0x810c311
    int32_t * v17; // 0x810c311
    int32_t v18; // 0x810c599
    int32_t v19; // 0x810c59f
    int32_t v20; // 0x810c5ce
    int32_t * v21; // 0x810c311
    int32_t v22; // 0x810c544
    int32_t v23; // 0x810c54a
    int32_t v24; // 0x810c579
    if (*(int32_t *)(v14 + 8) != v13) {
        // 0x810c58d
        v17 = (int32_t *)(v14 + 20);
        v18 = *(int32_t *)(v13 + 12);
        v19 = *(int32_t *)(v13 + 20);
        v20 = (v18 < v19 ? v19 : v18) + 1;
        *v17 = v20;
        v16 = v20;
        v15 = *v17;
    } else {
        // 0x810c538
        v21 = (int32_t *)(v14 + 12);
        v22 = *(int32_t *)(v13 + 12);
        v23 = *(int32_t *)(v13 + 20);
        v24 = (v22 < v23 ? v23 : v22) + 1;
        *v21 = v24;
        v16 = v24;
        v15 = *v21;
    }
    // 0x810c5e0
    *(int32_t *)&father_of_element2 = v14;
    int32_t v25 = *(int32_t *)(v14 + 4); // 0x810c5e9
    while ((int32_t *)v15 != (int32_t *)v16 == (v25 != 0)) {
        int32_t v26 = v14;
        v14 = v25;
        if (*(int32_t *)(v14 + 8) != v26) {
            // 0x810c58d
            v17 = (int32_t *)(v14 + 20);
            v18 = *(int32_t *)(v26 + 12);
            v19 = *(int32_t *)(v26 + 20);
            v20 = (v18 < v19 ? v19 : v18) + 1;
            *v17 = v20;
            v16 = v20;
            v15 = *v17;
        } else {
            // 0x810c538
            v21 = (int32_t *)(v14 + 12);
            v22 = *(int32_t *)(v26 + 12);
            v23 = *(int32_t *)(v26 + 20);
            v24 = (v22 < v23 ? v23 : v22) + 1;
            *v21 = v24;
            v16 = v24;
            v15 = *v21;
        }
        // 0x810c5e0
        *(int32_t *)&father_of_element2 = v14;
        v25 = *(int32_t *)(v14 + 4);
    }
    int32_t * v27 = (int32_t *)(v6 + 12); // 0x810c614
    int32_t * v28 = (int32_t *)(v6 + 20); // 0x810c61a
    int32_t * v29 = (int32_t *)(v6 + 8);
    int32_t * v30 = (int32_t *)(v6 + 16);
    int32_t * v31 = (int32_t *)(v6 + 4);
    int32_t v32 = 0;
    int32_t v33 = *v27; // 0x810c614
    int32_t v34 = *v28; // 0x810c61a
    int32_t v35; // 0x810c311
    int32_t v36; // 0x810c311
    int32_t v37; // 0x810c311
    int32_t v38; // 0x810c311
    int32_t v39; // 0x810c311
    int32_t v40; // 0x810c311
    int32_t v41; // 0x810c311
    int32_t v42; // 0x810c311
    int32_t v43; // 0x810c311
    char v44; // 0x810c311
    char v45; // 0x810c311
    int32_t v46; // 0x810c311
    int32_t v47; // 0x810c311
    int32_t v48; // 0x810c311
    int32_t v49; // 0x810c311
    int32_t v50; // 0x810c311
    int32_t v51; // 0x810c311
    int32_t v52; // 0x810c311
    int32_t v53; // 0x810c311
    int32_t v54; // 0x810c311
    int32_t v55; // 0x810c311
    int32_t v56; // 0x810c9ea
    int32_t v57; // 0x810c9f3
    int32_t v58; // 0x810c9b5
    int32_t v59; // 0x810c9bb
    int32_t * v60; // 0x810c866
    int32_t v61; // 0x810c86c
    int32_t v62; // 0x810caa0
    int32_t * v63; // 0x810caac
    int32_t v64; // 0x810c887
    int32_t * v65; // 0x810c890
    int32_t v66; // 0x810cac4
    int32_t * v67; // 0x810cacd
    int32_t * v68; // 0x810c8b9
    int32_t * v69; // 0x810caf6
    int32_t v70; // 0x810c660
    int32_t v71; // 0x810c667
    int32_t v72; // 0x810c681
    int32_t v73; // 0x810c700
    int32_t v74; // 0x810c712
    int32_t v75; // 0x810c738
    int32_t v76; // 0x810c93d
    int32_t v77; // 0x810c949
    int32_t v78; // 0x810c975
    int32_t v79; // 0x810c6bf
    int32_t v80; // 0x810c915
    int32_t v81; // 0x810c75c
    int32_t v82; // 0x810c75f
    int32_t v83; // 0x810cb52
    int32_t v84; // 0x810c999
    int32_t v85; // 0x810c99c
    int32_t * v86; // 0x810c311
    int32_t * v87; // 0x810c311
    int32_t * v88; // 0x810c311
    int32_t * v89; // 0x810c311
    int32_t v90; // 0x810c82b
    int32_t v91; // 0x810c834
    int32_t v92; // 0x810c7f6
    int32_t v93; // 0x810c7fc
    int32_t v94; // 0x810c7ad
    int32_t v95; // 0x810c7b6
    int32_t v96; // 0x810c778
    int32_t v97; // 0x810c77e
    int32_t v98; // 0x810ca68
    int32_t v99; // 0x810ca71
    int32_t v100; // 0x810ca33
    int32_t v101; // 0x810ca39
    while (v33 + 1 - v34 > 2) {
        // 0x810c660
        v70 = v32 + 1;
        v71 = *v29;
        v35 = *v30;
        v38 = v70;
        if (v71 == 0) {
            // 0x810c66e
            v38 = v70;
            if (*(int32_t *)(v35 + 16) == 0) {
                // 0x810c67b
                v72 = *(int32_t *)(v35 + 8);
                v38 = v70;
                if (*(int32_t *)(v72 + 8) == 0) {
                    // 0x810c68b
                    v38 = *(int32_t *)(v72 + 16) != 0 ? v70 : 7;
                }
            }
        }
        // 0x810c6a2
        v39 = v38;
        v40 = v39;
        if (v35 == 0) {
            // 0x810c6ac
            v40 = v39;
            if (*(int32_t *)(v71 + 8) == 0) {
                // 0x810c6b9
                v79 = *(int32_t *)(v71 + 16);
                v40 = v39;
                if (*(int32_t *)(v79 + 16) == 0) {
                    // 0x810c6c9
                    v40 = *(int32_t *)(v79 + 8) != 0 ? v39 : 7;
                }
            }
        }
        // 0x810c6e0
        if (v33 > v34) {
            // 0x810c6f4
            father_of_element = (int32_t *)v71;
            v73 = *(int32_t *)(v71 + 20);
            *v27 = v73;
            v74 = *v28;
            *(int32_t *)((int32_t)father_of_element + 20) = (v73 < v74 ? v74 : v73) + 1;
            v75 = *v31;
            if (v75 == 0) {
                // 0x810c8ea
                *(int32_t *)((int32_t)father_of_element + 4) = 0;
                *v29 = *(int32_t *)((int32_t)father_of_element + 16);
                *(int32_t *)((int32_t)father_of_element + 16) = v6;
            } else {
                // 0x810c743
                *(int32_t *)&father_of_element2 = (int32_t)father_of_element;
                v44 = 1;
                v36 = v75;
                v81 = (int32_t)father_of_element;
                v82 = *(int32_t *)(v81 + 4);
                if (*(int32_t *)(v36 + 8) != v82) {
                    // 0x810c7e4
                    v86 = (int32_t *)(v36 + 20);
                    if (v44 == 0) {
                        // 0x810c825
                        v90 = *(int32_t *)(v82 + 20);
                        v91 = *(int32_t *)(v82 + 12);
                        v53 = v90 < v91 ? v91 : v90;
                    } else {
                        // 0x810c7f3
                        v92 = *(int32_t *)(v81 + 20);
                        v93 = *(int32_t *)(v81 + 12);
                        v53 = v92 < v93 ? v93 : v92;
                    }
                    // 0x810c857
                    v52 = v53 + 1;
                    *v86 = v52;
                    v55 = v52;
                    v41 = *v86;
                } else {
                    // 0x810c766
                    v87 = (int32_t *)(v36 + 12);
                    if (v44 == 0) {
                        // 0x810c7a7
                        v94 = *(int32_t *)(v82 + 20);
                        v95 = *(int32_t *)(v82 + 12);
                        v51 = v94 < v95 ? v95 : v94;
                    } else {
                        // 0x810c775
                        v96 = *(int32_t *)(v81 + 20);
                        v97 = *(int32_t *)(v81 + 12);
                        v51 = v96 < v97 ? v97 : v96;
                    }
                    // 0x810c7d9
                    v50 = v51 + 1;
                    *v87 = v50;
                    v55 = v50;
                    v41 = *v87;
                }
                // 0x810c860
                v60 = (int32_t *)*(int32_t *)((int32_t)father_of_element2 + 4);
                father_of_element2 = v60;
                v61 = *(int32_t *)(v36 + 4);
                while ((int32_t *)v41 != (int32_t *)v55 == (v61 != 0)) {
                    // 0x810c756
                    v44 = 0;
                    v36 = v61;
                    v81 = (int32_t)v60;
                    v82 = *(int32_t *)(v81 + 4);
                    if (*(int32_t *)(v36 + 8) != v82) {
                        // 0x810c7e4
                        v86 = (int32_t *)(v36 + 20);
                        if (v44 == 0) {
                            // 0x810c825
                            v90 = *(int32_t *)(v82 + 20);
                            v91 = *(int32_t *)(v82 + 12);
                            v53 = v90 < v91 ? v91 : v90;
                        } else {
                            // 0x810c7f3
                            v92 = *(int32_t *)(v81 + 20);
                            v93 = *(int32_t *)(v81 + 12);
                            v53 = v92 < v93 ? v93 : v92;
                        }
                        // 0x810c857
                        v52 = v53 + 1;
                        *v86 = v52;
                        v55 = v52;
                        v41 = *v86;
                    } else {
                        // 0x810c766
                        v87 = (int32_t *)(v36 + 12);
                        if (v44 == 0) {
                            // 0x810c7a7
                            v94 = *(int32_t *)(v82 + 20);
                            v95 = *(int32_t *)(v82 + 12);
                            v51 = v94 < v95 ? v95 : v94;
                        } else {
                            // 0x810c775
                            v96 = *(int32_t *)(v81 + 20);
                            v97 = *(int32_t *)(v81 + 12);
                            v51 = v96 < v97 ? v97 : v96;
                        }
                        // 0x810c7d9
                        v50 = v51 + 1;
                        *v87 = v50;
                        v55 = v50;
                        v41 = *v87;
                    }
                    // 0x810c860
                    v60 = (int32_t *)*(int32_t *)((int32_t)father_of_element2 + 4);
                    father_of_element2 = v60;
                    v61 = *(int32_t *)(v36 + 4);
                }
                // 0x810c884
                v64 = *v31;
                v65 = (int32_t *)(v64 + 8);
                if (*v65 == v6) {
                    // 0x810c898
                    *v65 = (int32_t)father_of_element;
                    *v29 = *(int32_t *)((int32_t)father_of_element + 16);
                    *(int32_t *)((int32_t)father_of_element + 16) = v6;
                }
                // 0x810c8b6
                v68 = (int32_t *)(v64 + 16);
                if (*v68 == v6) {
                    // 0x810c8c1
                    *v68 = (int32_t)father_of_element;
                    *v29 = *(int32_t *)((int32_t)father_of_element + 16);
                    *(int32_t *)((int32_t)father_of_element + 16) = v6;
                }
                // 0x810c8df
                *(int32_t *)((int32_t)father_of_element + 4) = v64;
            }
            // 0x810c909
            *v31 = (int32_t)father_of_element;
            v80 = *v29;
            if (v80 != 0) {
                // 0x810c920
                *(int32_t *)(v80 + 4) = v6;
            }
        } else {
            // 0x810c931
            father_of_element = (int32_t *)v35;
            v76 = *(int32_t *)(v35 + 12);
            *v28 = v76;
            v77 = *v27;
            *(int32_t *)((int32_t)father_of_element + 12) = (v77 < v76 ? v76 : v77) + 1;
            v78 = *v31;
            if (v78 == 0) {
                // 0x810cb27
                *(int32_t *)((int32_t)father_of_element + 4) = 0;
                *v30 = *(int32_t *)((int32_t)father_of_element + 8);
                *(int32_t *)((int32_t)father_of_element + 8) = v6;
            } else {
                // 0x810c980
                *(int32_t *)&father_of_element2 = (int32_t)father_of_element;
                v45 = 1;
                v37 = v78;
                v84 = (int32_t)father_of_element;
                v85 = *(int32_t *)(v84 + 4);
                if (*(int32_t *)(v37 + 8) != v85) {
                    // 0x810ca21
                    v88 = (int32_t *)(v37 + 20);
                    if (v45 == 0) {
                        // 0x810ca62
                        v98 = *(int32_t *)(v85 + 20);
                        v99 = *(int32_t *)(v85 + 12);
                        v49 = v98 < v99 ? v99 : v98;
                    } else {
                        // 0x810ca30
                        v100 = *(int32_t *)(v84 + 20);
                        v101 = *(int32_t *)(v84 + 12);
                        v49 = v100 < v101 ? v101 : v100;
                    }
                    // 0x810ca94
                    v48 = v49 + 1;
                    *v88 = v48;
                    v54 = v48;
                    v42 = *v88;
                } else {
                    // 0x810c9a3
                    v89 = (int32_t *)(v37 + 12);
                    if (v45 == 0) {
                        // 0x810c9e4
                        v56 = *(int32_t *)(v85 + 20);
                        v57 = *(int32_t *)(v85 + 12);
                        v47 = v56 < v57 ? v57 : v56;
                    } else {
                        // 0x810c9b2
                        v58 = *(int32_t *)(v84 + 20);
                        v59 = *(int32_t *)(v84 + 12);
                        v47 = v58 < v59 ? v59 : v58;
                    }
                    // 0x810ca16
                    v46 = v47 + 1;
                    *v89 = v46;
                    v54 = v46;
                    v42 = *v89;
                }
                // 0x810ca9d
                v62 = *(int32_t *)(v37 + 4);
                v63 = (int32_t *)*(int32_t *)((int32_t)father_of_element2 + 4);
                father_of_element2 = v63;
                while ((int32_t *)v42 != (int32_t *)v54 == (v62 != 0)) {
                    // 0x810c993
                    v45 = 0;
                    v37 = v62;
                    v84 = (int32_t)v63;
                    v85 = *(int32_t *)(v84 + 4);
                    if (*(int32_t *)(v37 + 8) != v85) {
                        // 0x810ca21
                        v88 = (int32_t *)(v37 + 20);
                        if (v45 == 0) {
                            // 0x810ca62
                            v98 = *(int32_t *)(v85 + 20);
                            v99 = *(int32_t *)(v85 + 12);
                            v49 = v98 < v99 ? v99 : v98;
                        } else {
                            // 0x810ca30
                            v100 = *(int32_t *)(v84 + 20);
                            v101 = *(int32_t *)(v84 + 12);
                            v49 = v100 < v101 ? v101 : v100;
                        }
                        // 0x810ca94
                        v48 = v49 + 1;
                        *v88 = v48;
                        v54 = v48;
                        v42 = *v88;
                    } else {
                        // 0x810c9a3
                        v89 = (int32_t *)(v37 + 12);
                        if (v45 == 0) {
                            // 0x810c9e4
                            v56 = *(int32_t *)(v85 + 20);
                            v57 = *(int32_t *)(v85 + 12);
                            v47 = v56 < v57 ? v57 : v56;
                        } else {
                            // 0x810c9b2
                            v58 = *(int32_t *)(v84 + 20);
                            v59 = *(int32_t *)(v84 + 12);
                            v47 = v58 < v59 ? v59 : v58;
                        }
                        // 0x810ca16
                        v46 = v47 + 1;
                        *v89 = v46;
                        v54 = v46;
                        v42 = *v89;
                    }
                    // 0x810ca9d
                    v62 = *(int32_t *)(v37 + 4);
                    v63 = (int32_t *)*(int32_t *)((int32_t)father_of_element2 + 4);
                    father_of_element2 = v63;
                }
                // 0x810cac1
                v66 = *v31;
                v67 = (int32_t *)(v66 + 8);
                if (*v67 == v6) {
                    // 0x810cad5
                    *v67 = (int32_t)father_of_element;
                    *v30 = *(int32_t *)((int32_t)father_of_element + 8);
                    *(int32_t *)((int32_t)father_of_element + 8) = v6;
                }
                // 0x810caf3
                v69 = (int32_t *)(v66 + 16);
                if (*v69 == v6) {
                    // 0x810cafe
                    *v69 = (int32_t)father_of_element;
                    *v30 = *(int32_t *)((int32_t)father_of_element + 8);
                    *(int32_t *)((int32_t)father_of_element + 8) = v6;
                }
                // 0x810cb1c
                *(int32_t *)((int32_t)father_of_element + 4) = v66;
            }
            // 0x810cb46
            *v31 = (int32_t)father_of_element;
            v83 = *v30;
            if (v83 != 0) {
                // 0x810cb59
                *(int32_t *)(v83 + 4) = v6;
            }
        }
        // 0x810cb65
        v43 = v6;
        if (v40 >= 7) {
            // break (via goto) -> 0x810cb80
            goto lab_0x810cb80;
        }
        v32 = v40;
        v33 = *v27;
        v34 = *v28;
    }
    int32_t v102 = *v31; // 0x810c642
    int32_t v103 = v102 == 0 ? v6 : v102;
    char v104 = v102 == 0 ? 0 : 1;
    int32_t v105 = v32; // 0x810cb69
    char v106 = v104; // 0x810cb69
    v43 = v103;
    while (v104 != 0) {
        int32_t v107 = v103;
        v27 = (int32_t *)(v107 + 12);
        v28 = (int32_t *)(v107 + 20);
        v29 = (int32_t *)(v107 + 8);
        v30 = (int32_t *)(v107 + 16);
        v31 = (int32_t *)(v107 + 4);
        v32 = v105;
        v33 = *v27;
        v34 = *v28;
        while (v33 + 1 - v34 > 2) {
            // 0x810c660
            v70 = v32 + 1;
            v71 = *v29;
            v35 = *v30;
            v38 = v70;
            if (v71 == 0) {
                // 0x810c66e
                v38 = v70;
                if (*(int32_t *)(v35 + 16) == 0) {
                    // 0x810c67b
                    v72 = *(int32_t *)(v35 + 8);
                    v38 = v70;
                    if (*(int32_t *)(v72 + 8) == 0) {
                        // 0x810c68b
                        v38 = *(int32_t *)(v72 + 16) != 0 ? v70 : 7;
                    }
                }
            }
            // 0x810c6a2
            v39 = v38;
            v40 = v39;
            if (v35 == 0) {
                // 0x810c6ac
                v40 = v39;
                if (*(int32_t *)(v71 + 8) == 0) {
                    // 0x810c6b9
                    v79 = *(int32_t *)(v71 + 16);
                    v40 = v39;
                    if (*(int32_t *)(v79 + 16) == 0) {
                        // 0x810c6c9
                        v40 = *(int32_t *)(v79 + 8) != 0 ? v39 : 7;
                    }
                }
            }
            // 0x810c6e0
            if (v33 > v34) {
                // 0x810c6f4
                father_of_element = (int32_t *)v71;
                v73 = *(int32_t *)(v71 + 20);
                *v27 = v73;
                v74 = *v28;
                *(int32_t *)((int32_t)father_of_element + 20) = (v73 < v74 ? v74 : v73) + 1;
                v75 = *v31;
                if (v75 == 0) {
                    // 0x810c8ea
                    *(int32_t *)((int32_t)father_of_element + 4) = 0;
                    *v29 = *(int32_t *)((int32_t)father_of_element + 16);
                    *(int32_t *)((int32_t)father_of_element + 16) = v107;
                } else {
                    // 0x810c743
                    *(int32_t *)&father_of_element2 = (int32_t)father_of_element;
                    v44 = 1;
                    v36 = v75;
                    v81 = (int32_t)father_of_element;
                    v82 = *(int32_t *)(v81 + 4);
                    if (*(int32_t *)(v36 + 8) != v82) {
                        // 0x810c7e4
                        v86 = (int32_t *)(v36 + 20);
                        if (v44 == 0) {
                            // 0x810c825
                            v90 = *(int32_t *)(v82 + 20);
                            v91 = *(int32_t *)(v82 + 12);
                            v53 = v90 < v91 ? v91 : v90;
                        } else {
                            // 0x810c7f3
                            v92 = *(int32_t *)(v81 + 20);
                            v93 = *(int32_t *)(v81 + 12);
                            v53 = v92 < v93 ? v93 : v92;
                        }
                        // 0x810c857
                        v52 = v53 + 1;
                        *v86 = v52;
                        v55 = v52;
                        v41 = *v86;
                    } else {
                        // 0x810c766
                        v87 = (int32_t *)(v36 + 12);
                        if (v44 == 0) {
                            // 0x810c7a7
                            v94 = *(int32_t *)(v82 + 20);
                            v95 = *(int32_t *)(v82 + 12);
                            v51 = v94 < v95 ? v95 : v94;
                        } else {
                            // 0x810c775
                            v96 = *(int32_t *)(v81 + 20);
                            v97 = *(int32_t *)(v81 + 12);
                            v51 = v96 < v97 ? v97 : v96;
                        }
                        // 0x810c7d9
                        v50 = v51 + 1;
                        *v87 = v50;
                        v55 = v50;
                        v41 = *v87;
                    }
                    // 0x810c860
                    v60 = (int32_t *)*(int32_t *)((int32_t)father_of_element2 + 4);
                    father_of_element2 = v60;
                    v61 = *(int32_t *)(v36 + 4);
                    while ((int32_t *)v41 != (int32_t *)v55 == (v61 != 0)) {
                        // 0x810c756
                        v44 = 0;
                        v36 = v61;
                        v81 = (int32_t)v60;
                        v82 = *(int32_t *)(v81 + 4);
                        if (*(int32_t *)(v36 + 8) != v82) {
                            // 0x810c7e4
                            v86 = (int32_t *)(v36 + 20);
                            if (v44 == 0) {
                                // 0x810c825
                                v90 = *(int32_t *)(v82 + 20);
                                v91 = *(int32_t *)(v82 + 12);
                                v53 = v90 < v91 ? v91 : v90;
                            } else {
                                // 0x810c7f3
                                v92 = *(int32_t *)(v81 + 20);
                                v93 = *(int32_t *)(v81 + 12);
                                v53 = v92 < v93 ? v93 : v92;
                            }
                            // 0x810c857
                            v52 = v53 + 1;
                            *v86 = v52;
                            v55 = v52;
                            v41 = *v86;
                        } else {
                            // 0x810c766
                            v87 = (int32_t *)(v36 + 12);
                            if (v44 == 0) {
                                // 0x810c7a7
                                v94 = *(int32_t *)(v82 + 20);
                                v95 = *(int32_t *)(v82 + 12);
                                v51 = v94 < v95 ? v95 : v94;
                            } else {
                                // 0x810c775
                                v96 = *(int32_t *)(v81 + 20);
                                v97 = *(int32_t *)(v81 + 12);
                                v51 = v96 < v97 ? v97 : v96;
                            }
                            // 0x810c7d9
                            v50 = v51 + 1;
                            *v87 = v50;
                            v55 = v50;
                            v41 = *v87;
                        }
                        // 0x810c860
                        v60 = (int32_t *)*(int32_t *)((int32_t)father_of_element2 + 4);
                        father_of_element2 = v60;
                        v61 = *(int32_t *)(v36 + 4);
                    }
                    // 0x810c884
                    v64 = *v31;
                    v65 = (int32_t *)(v64 + 8);
                    if (*v65 == v107) {
                        // 0x810c898
                        *v65 = (int32_t)father_of_element;
                        *v29 = *(int32_t *)((int32_t)father_of_element + 16);
                        *(int32_t *)((int32_t)father_of_element + 16) = v107;
                    }
                    // 0x810c8b6
                    v68 = (int32_t *)(v64 + 16);
                    if (*v68 == v107) {
                        // 0x810c8c1
                        *v68 = (int32_t)father_of_element;
                        *v29 = *(int32_t *)((int32_t)father_of_element + 16);
                        *(int32_t *)((int32_t)father_of_element + 16) = v107;
                    }
                    // 0x810c8df
                    *(int32_t *)((int32_t)father_of_element + 4) = v64;
                }
                // 0x810c909
                *v31 = (int32_t)father_of_element;
                v80 = *v29;
                if (v80 != 0) {
                    // 0x810c920
                    *(int32_t *)(v80 + 4) = v107;
                }
            } else {
                // 0x810c931
                father_of_element = (int32_t *)v35;
                v76 = *(int32_t *)(v35 + 12);
                *v28 = v76;
                v77 = *v27;
                *(int32_t *)((int32_t)father_of_element + 12) = (v77 < v76 ? v76 : v77) + 1;
                v78 = *v31;
                if (v78 == 0) {
                    // 0x810cb27
                    *(int32_t *)((int32_t)father_of_element + 4) = 0;
                    *v30 = *(int32_t *)((int32_t)father_of_element + 8);
                    *(int32_t *)((int32_t)father_of_element + 8) = v107;
                } else {
                    // 0x810c980
                    *(int32_t *)&father_of_element2 = (int32_t)father_of_element;
                    v45 = 1;
                    v37 = v78;
                    v84 = (int32_t)father_of_element;
                    v85 = *(int32_t *)(v84 + 4);
                    if (*(int32_t *)(v37 + 8) != v85) {
                        // 0x810ca21
                        v88 = (int32_t *)(v37 + 20);
                        if (v45 == 0) {
                            // 0x810ca62
                            v98 = *(int32_t *)(v85 + 20);
                            v99 = *(int32_t *)(v85 + 12);
                            v49 = v98 < v99 ? v99 : v98;
                        } else {
                            // 0x810ca30
                            v100 = *(int32_t *)(v84 + 20);
                            v101 = *(int32_t *)(v84 + 12);
                            v49 = v100 < v101 ? v101 : v100;
                        }
                        // 0x810ca94
                        v48 = v49 + 1;
                        *v88 = v48;
                        v54 = v48;
                        v42 = *v88;
                    } else {
                        // 0x810c9a3
                        v89 = (int32_t *)(v37 + 12);
                        if (v45 == 0) {
                            // 0x810c9e4
                            v56 = *(int32_t *)(v85 + 20);
                            v57 = *(int32_t *)(v85 + 12);
                            v47 = v56 < v57 ? v57 : v56;
                        } else {
                            // 0x810c9b2
                            v58 = *(int32_t *)(v84 + 20);
                            v59 = *(int32_t *)(v84 + 12);
                            v47 = v58 < v59 ? v59 : v58;
                        }
                        // 0x810ca16
                        v46 = v47 + 1;
                        *v89 = v46;
                        v54 = v46;
                        v42 = *v89;
                    }
                    // 0x810ca9d
                    v62 = *(int32_t *)(v37 + 4);
                    v63 = (int32_t *)*(int32_t *)((int32_t)father_of_element2 + 4);
                    father_of_element2 = v63;
                    while ((int32_t *)v42 != (int32_t *)v54 == (v62 != 0)) {
                        // 0x810c993
                        v45 = 0;
                        v37 = v62;
                        v84 = (int32_t)v63;
                        v85 = *(int32_t *)(v84 + 4);
                        if (*(int32_t *)(v37 + 8) != v85) {
                            // 0x810ca21
                            v88 = (int32_t *)(v37 + 20);
                            if (v45 == 0) {
                                // 0x810ca62
                                v98 = *(int32_t *)(v85 + 20);
                                v99 = *(int32_t *)(v85 + 12);
                                v49 = v98 < v99 ? v99 : v98;
                            } else {
                                // 0x810ca30
                                v100 = *(int32_t *)(v84 + 20);
                                v101 = *(int32_t *)(v84 + 12);
                                v49 = v100 < v101 ? v101 : v100;
                            }
                            // 0x810ca94
                            v48 = v49 + 1;
                            *v88 = v48;
                            v54 = v48;
                            v42 = *v88;
                        } else {
                            // 0x810c9a3
                            v89 = (int32_t *)(v37 + 12);
                            if (v45 == 0) {
                                // 0x810c9e4
                                v56 = *(int32_t *)(v85 + 20);
                                v57 = *(int32_t *)(v85 + 12);
                                v47 = v56 < v57 ? v57 : v56;
                            } else {
                                // 0x810c9b2
                                v58 = *(int32_t *)(v84 + 20);
                                v59 = *(int32_t *)(v84 + 12);
                                v47 = v58 < v59 ? v59 : v58;
                            }
                            // 0x810ca16
                            v46 = v47 + 1;
                            *v89 = v46;
                            v54 = v46;
                            v42 = *v89;
                        }
                        // 0x810ca9d
                        v62 = *(int32_t *)(v37 + 4);
                        v63 = (int32_t *)*(int32_t *)((int32_t)father_of_element2 + 4);
                        father_of_element2 = v63;
                    }
                    // 0x810cac1
                    v66 = *v31;
                    v67 = (int32_t *)(v66 + 8);
                    if (*v67 == v107) {
                        // 0x810cad5
                        *v67 = (int32_t)father_of_element;
                        *v30 = *(int32_t *)((int32_t)father_of_element + 8);
                        *(int32_t *)((int32_t)father_of_element + 8) = v107;
                    }
                    // 0x810caf3
                    v69 = (int32_t *)(v66 + 16);
                    if (*v69 == v107) {
                        // 0x810cafe
                        *v69 = (int32_t)father_of_element;
                        *v30 = *(int32_t *)((int32_t)father_of_element + 8);
                        *(int32_t *)((int32_t)father_of_element + 8) = v107;
                    }
                    // 0x810cb1c
                    *(int32_t *)((int32_t)father_of_element + 4) = v66;
                }
                // 0x810cb46
                *v31 = (int32_t)father_of_element;
                v83 = *v30;
                if (v83 != 0) {
                    // 0x810cb59
                    *(int32_t *)(v83 + 4) = v107;
                }
            }
            // 0x810cb65
            v43 = v107;
            if (v40 >= 7) {
                // break (via goto) -> 0x810cb80
                goto lab_0x810cb80;
            }
            v32 = v40;
            v33 = *v27;
            v34 = *v28;
        }
        // 0x810c63f
        v102 = *v31;
        v103 = v102 == 0 ? v107 : v102;
        v104 = v102 == 0 ? 0 : v106;
        v105 = v32;
        v106 = v104;
        v43 = v103;
    }
  lab_0x810cb80:;
    int32_t v108 = v43;
    int32_t v109 = *(int32_t *)(v108 + 4); // 0x810cb83
    while (v109 != 0) {
        // 0x810cb80
        v108 = v109;
        v109 = *(int32_t *)(v108 + 4);
    }
    // 0x810cb8a
    *v1 = v108;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTBTree.c
// Address range: 0x810cb95 - 0x810cc2d
// Line range:    460 - 512
int32_t * HTBTree_next(int32_t * tree, int32_t * ele) {
    int32_t v1; // 0x810cb95
    if (ele != NULL) {
        int32_t v2 = (int32_t)ele;
        int32_t v3 = *(int32_t *)(v2 + 16); // 0x810cbd0
        if (v3 == 0) {
            int32_t v4 = v2;
            int32_t v5 = *(int32_t *)(v4 + 4);
            v1 = 0;
            while (v5 != 0) {
                // 0x810cc17
                v1 = v5;
                if (*(int32_t *)(v5 + 16) != v4) {
                    // break -> 0x810cc28
                    break;
                }
                v4 = v5;
                v5 = *(int32_t *)(v4 + 4);
                v1 = 0;
            }
        } else {
            int32_t v6 = *(int32_t *)(v3 + 8); // 0x810cbee
            v1 = v3;
            while (v6 != 0) {
                int32_t v7 = v6;
                v6 = *(int32_t *)(v7 + 8);
                v1 = v7;
            }
        }
    } else {
        int32_t v8 = *(int32_t *)((int32_t)tree + 4); // 0x810cba4
        if (v8 == 0) {
            // 0x810cc28
            return (int32_t *)0;
        }
        int32_t v9 = *(int32_t *)(v8 + 8); // 0x810cbbe
        v1 = v8;
        while (v9 != 0) {
            int32_t v10 = v9;
            v9 = *(int32_t *)(v10 + 8);
            v1 = v10;
        }
    }
    // 0x810cc28
    return (int32_t *)v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFTP.c
// Address range: 0x811506e - 0x8115096
// Line range:    3925 - 3936
void HTClearFTPPassword(void) {
    // 0x811506e
    if (user_entered_password != 0) {
        // 0x811507d
        free((int32_t *)user_entered_password);
        user_entered_password = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTTCP.c
// Address range: 0x811521a - 0x811535f
// Line range:    324 - 350
char valid_hostname(char * name) {
    // 0x811521a
    if (name == NULL) {
        // 0x8115359
        return 0;
    }
    char v1 = *name; // 0x811523d
    if (v1 == 0) {
        // 0x8115359
        return 0;
    }
    char v2 = v1; // 0x8115307
    char * v3 = name; // 0x811521a
    int32_t v4 = (int32_t)name; // 0x81152fc
    int32_t v5 = 0;
    int32_t v6 = 1; // 0x8115300
    int32_t v7; // 0x811521a
    int32_t v8; // 0x811521a
    char result; // 0x811521a
    while (true) {
      lab_0x8115251:;
        int32_t v9 = v5;
        v8 = v4;
        char v10 = v2;
        if (v10 != 46) {
            // 0x8115276
            if (v9 == 0) {
                // 0x811527c
                result = 0;
                if (v10 != 45 != v10 != 43) {
                    // break -> 0x8115359
                    break;
                }
            }
            int32_t v11 = v9 + 1; // 0x8115299
            result = 0;
            if (v11 >= 64) {
                // break -> 0x8115359
                break;
            }
            int16_t * v12 = *__ctype_b_loc(); // 0x81152b1
            unsigned char v13 = *v3; // 0x81152b6
            v7 = v11;
            if ((*(int16_t *)(2 * (int32_t)v13 + (int32_t)v12) & 8) != 0) {
                goto lab_0x81152fc;
            } else {
                // switch.early.test
                v7 = v11;
                result = 0;
                switch (v13) {
                    case 95: {
                        goto lab_0x81152fc;
                    }
                    case 45: {
                        goto lab_0x81152fc;
                    }
                    case 43: {
                        goto lab_0x81152fc;
                    }
                    case 36: {
                        goto lab_0x81152fc;
                    }
                    default: {
                        return result;
                    }
                }
            }
        } else {
            // 0x811525b
            v7 = 0;
            result = 0;
            if (v9 == 0) {
                // break -> 0x8115359
                break;
            }
            goto lab_0x81152fc;
        }
    }
  lab_0x8115359:
    // 0x8115359
    return result;
  lab_0x81152fc:
    // 0x81152fc
    v5 = v7;
    v4 = v8 + 1;
    v6++;
    char * v14 = (char *)v4; // 0x8115307
    v2 = *v14;
    v3 = v14;
    if (v6 < 254 != v2 != 0) {
        // 0x811531b
        result = 1;
        if (v2 == 0) {
            return result;
        } else {
            if (v5 == 0 || v2 != 46) {
                // 0x811534b
                result = 0;
                return result;
            } else {
                // 0x8115335
                result = 1;
                if (*(char *)(v8 + 2) != 0) {
                    // 0x811534b
                    result = 0;
                    return result;
                } else {
                    return result;
                }
            }
        }
    }
    goto lab_0x8115251;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTTCP.c
// Address range: 0x8115371 - 0x81157f8
// Line range:    378 - 431
void dump_hostent(char * msgprefix, struct hostent * phost) {
    // 0x8115371
    if (WWW_TraceFlag == 0) {
        // 0x81157f2
        return;
    }
    // 0x8115392
    fprintf(TraceFP(), "%s: %p ", msgprefix, phost);
    int32_t v1; // 0x8115371
    bool v2; // 0x8115371
    if (phost == NULL) {
        goto lab_0x81157c3;
    } else {
        char v3 = 0; // 0x81153cc
        if (WWW_TraceFlag != 0) {
            // 0x81153ce
            fprintf(TraceFP(), "{ h_name = %p", (int32_t *)*(int32_t *)phost);
            v3 = WWW_TraceFlag;
        }
        int32_t v4 = *(int32_t *)phost; // 0x81153f1
        if (v4 == 0) {
            if (v3 != 0) {
                // 0x811542f
                fprintf(TraceFP(), ",");
            }
        } else {
            if (v3 != 0) {
                // 0x8115402
                fprintf(TraceFP(), " \"%s\",", (char *)v4);
            }
        }
        // 0x8115446
        v1 = (int32_t)phost;
        int32_t * v5 = (int32_t *)(v1 + 4);
        char v6 = 0; // 0x811544f
        bool v7 = true; // 0x811544f
        if (WWW_TraceFlag != 0) {
            // 0x8115451
            fprintf(TraceFP(), "\n\t h_aliases = %p", (int32_t *)*v5);
            v6 = WWW_TraceFlag;
            v7 = v6 == 0;
        }
        int32_t v8 = *v5; // 0x8115475
        if (v8 == 0) {
            if (!v7) {
                // 0x811556e
                fprintf(TraceFP(), ",\n\t");
            }
            goto lab_0x8115585;
        } else {
            char v9 = v6; // 0x8115489
            int32_t v10 = v8; // 0x8115489
            if (!v7) {
                // 0x811548b
                fprintf(TraceFP(), " {");
                v9 = WWW_TraceFlag;
                v10 = *v5;
            }
            int32_t v11 = *(int32_t *)v10; // 0x8115516
            bool v12 = v9 == 0; // 0x811551a
            if (v11 != 0) {
                char v13 = v9; // 0x81154b6
                char * v14; // 0x8115371
                int32_t v15; // 0x8115371
                if (v9 != 0) {
                    // 0x81154b8
                    v15 = v11;
                    v14 = *v5 != v10 ? ", " : (char *)&g76;
                    fprintf(TraceFP(), "%s %p \"%s\"", v14, (int32_t *)v15, (char *)v15);
                    v13 = WWW_TraceFlag;
                }
                int32_t v16 = v10 + 4; // 0x811550f
                int32_t v17 = *(int32_t *)v16; // 0x8115516
                char v18 = v13; // 0x811551a
                bool v19 = v13 == 0; // 0x811551a
                v12 = v13 == 0;
                while (v17 != 0) {
                    int32_t v20 = v16;
                    v13 = v18;
                    if (!v19) {
                        // 0x81154b8
                        v15 = v17;
                        v14 = *v5 != v20 ? ", " : (char *)&g76;
                        fprintf(TraceFP(), "%s %p \"%s\"", v14, (int32_t *)v15, (char *)v15);
                        v13 = WWW_TraceFlag;
                    }
                    // 0x811550f
                    v16 = v20 + 4;
                    v17 = *(int32_t *)v16;
                    v18 = v13;
                    v19 = v13 == 0;
                    v12 = v13 == 0;
                }
            }
            // 0x811551c
            v2 = true;
            if (v12) {
                goto lab_0x8115609;
            } else {
                int32_t v21 = *(int32_t *)*v5; // 0x811552d
                fprintf(TraceFP(), "%s0x0 },\n\t", v21 == 0 ? (char *)&g76 : ", ");
                goto lab_0x8115585;
            }
        }
    }
  lab_0x81157c3:
    // 0x81157c3
    if (WWW_TraceFlag != 0) {
        // 0x81157ce
        fprintf(TraceFP(), "\n");
    }
    // 0x81157e5
    fflush(TraceFP());
  lab_0x8115585:
    // 0x8115585
    v2 = true;
    if (WWW_TraceFlag != 0) {
        // 0x81155b1
        fprintf(TraceFP(), " h_addrtype = %d,", *(int32_t *)(v1 + 8));
        v2 = true;
        if (WWW_TraceFlag != 0) {
            // 0x81155dd
            fprintf(TraceFP(), " h_length = %d,\n\t", *(int32_t *)(v1 + 12));
            v2 = true;
            if (WWW_TraceFlag != 0) {
                // 0x81155e8
                fprintf(TraceFP(), " h_addr_list = %p", (int32_t *)*(int32_t *)(v1 + 16));
                v2 = WWW_TraceFlag == 0;
            }
        }
    }
    goto lab_0x8115609;
  lab_0x8115609:;
    int32_t * v22 = (int32_t *)(v1 + 16); // 0x811560c
    int32_t v23 = *v22; // 0x811560c
    if (v23 == 0) {
        if (!v2) {
            // 0x81157ac
            fprintf(TraceFP(), "}");
        }
    } else {
        int32_t v24 = v23; // 0x8115620
        if (!v2) {
            // 0x8115622
            fprintf(TraceFP(), " {");
            v24 = *v22;
        }
        int32_t * v25 = (int32_t *)v24;
        int32_t v26 = *v25; // 0x8115743
        int32_t v27 = v26; // 0x8115747
        if (v26 != 0) {
            int32_t * v28 = (int32_t *)(v1 + 12);
            int32_t v29 = v26; // 0x8115371
            int32_t v30 = v24;
            int32_t * v31 = v25;
            char * v32; // 0x8115371
            if (WWW_TraceFlag != 0) {
                // 0x8115652
                v32 = *v22 != v30 ? "," : (char *)&g77;
                fprintf(TraceFP(), "%s %p", v32, (int32_t *)v29);
            }
            int32_t v33 = *v28; // 0x8115730
            int32_t v34 = v33; // 0x8115736
            char * v35; // 0x8115371
            int32_t v36; // 0x8115371
            int32_t v37; // 0x8115371
            int32_t v38; // 0x8115371
            int32_t v39; // 0x8115371
            char * v40; // 0x8115371
            unsigned char v41; // 0x81156de
            if (v33 > 0) {
                v39 = 0;
                v38 = v34;
                v36 = v39 + 1;
                v37 = v38;
                if (WWW_TraceFlag != 0) {
                    // 0x81156b1
                    v35 = v36 != v38 ? (char *)&g77 : (char *)&g78;
                    v41 = *(char *)(*v31 + v39);
                    v40 = v39 != 0 ? (char *)&g79 : " \"";
                    fprintf(TraceFP(), "%s%d%s", v40, (int32_t)v41, v35);
                    v37 = *v28;
                }
                // 0x8115729
                while (v37 > v36) {
                    // 0x81156a6
                    v39 = v36;
                    v38 = v37;
                    v36 = v39 + 1;
                    v37 = v38;
                    if (WWW_TraceFlag != 0) {
                        // 0x81156b1
                        v35 = v36 != v38 ? (char *)&g77 : (char *)&g78;
                        v41 = *(char *)(*v31 + v39);
                        v40 = v39 != 0 ? (char *)&g79 : " \"";
                        fprintf(TraceFP(), "%s%d%s", v40, (int32_t)v41, v35);
                        v37 = *v28;
                    }
                }
            }
            int32_t v42 = v30 + 4; // 0x811573c
            int32_t * v43 = (int32_t *)v42; // 0x8115743
            int32_t v44 = *v43; // 0x8115743
            v29 = v44;
            while (v44 != 0) {
                // 0x8115647
                v30 = v42;
                v31 = v43;
                if (WWW_TraceFlag != 0) {
                    // 0x8115652
                    v32 = *v22 != v30 ? "," : (char *)&g77;
                    fprintf(TraceFP(), "%s %p", v32, (int32_t *)v29);
                }
                // 0x811569a
                v33 = *v28;
                v34 = v33;
                if (v33 > 0) {
                    v39 = 0;
                    v38 = v34;
                    v36 = v39 + 1;
                    v37 = v38;
                    if (WWW_TraceFlag != 0) {
                        // 0x81156b1
                        v35 = v36 != v38 ? (char *)&g77 : (char *)&g78;
                        v41 = *(char *)(*v31 + v39);
                        v40 = v39 != 0 ? (char *)&g79 : " \"";
                        fprintf(TraceFP(), "%s%d%s", v40, (int32_t)v41, v35);
                        v37 = *v28;
                    }
                    // 0x8115729
                    while (v37 > v36) {
                        // 0x81156a6
                        v39 = v36;
                        v38 = v37;
                        v36 = v39 + 1;
                        v37 = v38;
                        if (WWW_TraceFlag != 0) {
                            // 0x81156b1
                            v35 = v36 != v38 ? (char *)&g77 : (char *)&g78;
                            v41 = *(char *)(*v31 + v39);
                            v40 = v39 != 0 ? (char *)&g79 : " \"";
                            fprintf(TraceFP(), "%s%d%s", v40, (int32_t)v41, v35);
                            v37 = *v28;
                        }
                    }
                }
                // 0x811573c
                v42 = v30 + 4;
                v43 = (int32_t *)v42;
                v44 = *v43;
                v29 = v44;
            }
            // 0x8115740
            v27 = *(int32_t *)*v22;
        }
        // 0x811574d
        if (v27 == 0) {
            if (WWW_TraceFlag == 0) {
                // 0x81157e5
                fflush(TraceFP());
                // 0x81157f2
                return;
            }
            // 0x8115788
            fprintf(TraceFP(), " 0x0 } }");
        } else {
            if (WWW_TraceFlag == 0) {
                // 0x81157e5
                fflush(TraceFP());
                // 0x81157f2
                return;
            }
            // 0x8115764
            fprintf(TraceFP(), ", 0x0 } }");
        }
    }
    goto lab_0x81157c3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTTCP.c
// Address range: 0x81157f8 - 0x8115b30
// Line range:    453 - 573
int32_t fill_rehostent(char * rehostent, int32_t rehostentsize, struct hostent * phost) {
    // 0x81157f8
    if (phost == NULL) {
        // 0x8115b2b
        return 0;
    }
    int32_t v1 = (int32_t)phost; // 0x811583d
    int32_t * v2 = (int32_t *)(v1 + 12); // 0x8115840
    uint32_t v3 = *v2 + 4; // 0x8115843
    int32_t * v4 = (int32_t *)(v1 + 16); // 0x811584c
    int32_t v5 = *v4; // 0x811584c
    int32_t v6 = (v5 == 0 ? -20 : -24) + rehostentsize;
    int32_t * v7 = (int32_t *)(v1 + 4); // 0x811585a
    int32_t str = *(int32_t *)phost;
    int32_t v8 = (*v7 == 0 ? v6 : v6 - 4) + (int32_t)(str != 0);
    int32_t * v9 = NULL; // 0x811587a
    int32_t v10 = v8; // 0x811587a
    if (v5 != 0) {
        bool v11 = v8 < v3 | *(int32_t *)v5 == 0;
        v9 = v11 ? NULL : (int32_t *)1;
        v10 = v8 - (v11 ? 0 : v3);
    }
    char * v12 = NULL; // 0x81158a1
    int32_t v13 = v10; // 0x81158a1
    if (str != 0) {
        uint32_t len = strlen((char *)str); // 0x81158ab
        v12 = NULL;
        v13 = v10;
        if (v10 >= len) {
            // 0x81158bb
            v12 = (char *)len;
            v13 = v10 - len;
        }
    }
    int32_t * v14 = NULL; // 0x81158ce
    int32_t v15 = v13; // 0x81158ce
    if (v9 != NULL) {
        int32_t v16 = *v4 + 4;
        v14 = v9;
        v15 = v13;
        if (!((v13 < v3 | *(int32_t *)v16 == 0))) {
            int32_t * v17 = (int32_t *)((int32_t)v9 + 1);
            int32_t v18 = v13 - v3; // 0x81158ed
            int32_t v19 = v16 + 4;
            int32_t v20 = v19; // 0x81158fb
            int32_t v21 = v18; // 0x81158fb
            int32_t * v22 = v17; // 0x81158fb
            v14 = v17;
            v15 = v18;
            while (!((v18 < v3 | *(int32_t *)v19 == 0))) {
                // 0x81158e6
                v17 = (int32_t *)((int32_t)v22 + 1);
                v18 = v21 - v3;
                v19 = v20 + 4;
                v20 = v19;
                v21 = v18;
                v22 = v17;
                v14 = v17;
                v15 = v18;
            }
        }
    }
    int32_t v23 = *v7; // 0x8115906
    int32_t v24 = 4; // 0x811590b
    if (v23 != 0) {
        int32_t str2 = *(int32_t *)v23; // 0x8115944
        v24 = 4;
        if (str2 != 0) {
            int32_t * v25 = NULL;
            uint32_t v26 = v15;
            uint32_t v27 = strlen((char *)str2) + 5; // 0x8115925
            int32_t * v28 = v26 < v27 ? v25 : (int32_t *)((int32_t)v25 + 1);
            int32_t v29 = v23 + 4; // 0x811593d
            int32_t v30 = *(int32_t *)v29; // 0x8115944
            int32_t str3 = v30; // 0x8115948
            int32_t v31 = v29; // 0x8115948
            int32_t v32 = v26 - (v26 < v27 ? 0 : v27); // 0x8115948
            while (v30 != 0) {
                // 0x8115918
                v25 = v28;
                v26 = v32;
                v27 = strlen((char *)str3) + 5;
                v28 = v26 < v27 ? v25 : (int32_t *)((int32_t)v25 + 1);
                v29 = v31 + 4;
                v30 = *(int32_t *)v29;
                str3 = v30;
                v31 = v29;
                v32 = v26 - (v26 < v27 ? 0 : v27);
            }
            // 0x811594a
            v24 = 4 * (int32_t)v28 + 4;
        }
    }
    int32_t v33 = (int32_t)rehostent; // 0x8115950
    *(int32_t *)(v33 + 8) = *(int32_t *)(v1 + 8);
    *(int32_t *)(v33 + 12) = *v2;
    int32_t v34 = v33 + 20; // 0x8115965
    int32_t v35 = *v4; // 0x8115979
    int32_t v36 = v34; // 0x811597e
    if (v35 != 0) {
        // 0x8115980
        v36 = v33 + 24 + 4 * (int32_t)v14;
    }
    char ** v37 = (char **)v34; // 0x8115968
    int32_t v38 = v36 + (*v7 == 0 ? 0 : v24);
    int32_t * v39 = (int32_t *)(v33 + 16);
    int32_t str4; // 0x81157f8
    char ** v40; // 0x81157f8
    if (v35 == 0) {
        // 0x8115a12
        *v39 = 0;
        v40 = v37;
        str4 = v38;
    } else {
        // 0x81159ac
        *v39 = v34;
        char ** v41 = v37; // 0x8115a01
        int32_t v42 = v38; // 0x8115a01
        if (v14 > NULL) {
            int32_t v43 = 0; // 0x81159f7
            int32_t v44 = v38; // 0x81159ef
            char ** v45 = v37;
            int32_t v46 = *v4; // 0x81157f8
            memcpy((int32_t *)v44, (int32_t *)*(int32_t *)v46, 4);
            *(int32_t *)v45 = v44;
            v45 = (char **)((int32_t)v45 + 4);
            v44 += 4;
            v43++;
            v46 += 4;
            v41 = v45;
            v42 = v44;
            while (v43 < (int32_t)v14) {
                // 0x81159c7
                memcpy((int32_t *)v44, (int32_t *)*(int32_t *)v46, 4);
                *(int32_t *)v45 = v44;
                v45 = (char **)((int32_t)v45 + 4);
                v44 += 4;
                v43++;
                v46 += 4;
                v41 = v45;
                v42 = v44;
            }
        }
        // 0x8115a03
        *(int32_t *)v41 = 0;
        v40 = (char **)((int32_t)v41 + 4);
        str4 = v42;
    }
    // 0x8115a1c
    int32_t str6; // 0x81157f8
    if (*(int32_t *)phost == 0) {
        // 0x8115a5e
        *(int32_t *)rehostent = 0;
        str6 = str4;
    } else {
        // 0x8115a25
        *(int32_t *)rehostent = str4;
        if (v12 == NULL) {
            // 0x8115a52
            *(char *)str4 = 0;
            str6 = str4 + 1;
        } else {
            // 0x8115a33
            strcpy((char *)str4, (char *)*(int32_t *)phost);
            str6 = str4 + 1 + (int32_t)v12;
        }
    }
    // 0x8115a67
    if (*v7 == 0) {
        // 0x8115b10
        *(int32_t *)(v33 + 4) = 0;
        // 0x8115b2b
        return str6 - v33;
    }
    // 0x8115a75
    *(int32_t *)(v33 + 4) = (int32_t)v40;
    int32_t v47 = *v7; // 0x8115a81
    int32_t * str7 = (int32_t *)v47; // 0x8115af3
    int32_t str5 = *str7; // 0x8115af3
    int32_t v48 = v47; // 0x8115af7
    char ** v49 = v40; // 0x8115af7
    int32_t v50 = str6; // 0x8115af7
    if (v14 > NULL == (str5 != 0)) {
        int32_t v51 = 0;
        int32_t len2 = strlen((char *)str5); // 0x8115a98
        uint32_t v52 = len2 + 5; // 0x8115aa6
        int32_t v53 = v15; // 0x8115ab2
        char ** v54 = v40; // 0x8115ab2
        int32_t v55 = str6; // 0x8115ab2
        int32_t v56 = v51; // 0x8115ab2
        if (v15 >= v52) {
            // 0x8115ab4
            strcpy((char *)str6, (char *)*str7);
            *(int32_t *)v40 = str6;
            v53 = v15 - v52;
            v54 = (char **)((int32_t)v40 + 4);
            v55 = str6 + 1 + len2;
            v56 = v51 + 1;
        }
        char ** v57 = v54;
        int32_t v58 = v55 + 4; // 0x8115ae4
        v48 += 4;
        int32_t v59 = v56 + 1; // 0x8115aec
        int32_t * v60 = (int32_t *)v48; // 0x8115af3
        int32_t str8 = *v60; // 0x8115af3
        int32_t * str10 = v60; // 0x8115af7
        v49 = v57;
        v50 = v58;
        while (v59 < (int32_t)v14 == (str8 != 0)) {
            int32_t v61 = v53;
            char ** v62 = v57;
            int32_t str9 = v58;
            v51 = v59;
            len2 = strlen((char *)str8);
            v52 = len2 + 5;
            v53 = v61;
            v54 = v62;
            v55 = str9;
            v56 = v51;
            if (v61 >= v52) {
                // 0x8115ab4
                strcpy((char *)str9, (char *)*str10);
                *(int32_t *)v62 = str9;
                v53 = v61 - v52;
                v54 = (char **)((int32_t)v62 + 4);
                v55 = str9 + 1 + len2;
                v56 = v51 + 1;
            }
            // 0x8115ae4
            v57 = v54;
            v58 = v55 + 4;
            v48 += 4;
            v59 = v56 + 1;
            v60 = (int32_t *)v48;
            str8 = *v60;
            str10 = v60;
            v49 = v57;
            v50 = v58;
        }
    }
    // 0x8115b01
    *(int32_t *)v49 = 0;
    // 0x8115b2b
    return v50 - v33;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTTCP.c
// Address range: 0x8115b30 - 0x8115b7e
// Line range:    636 - 651
int32_t readit(int32_t fd, char * buffer, int32_t length) {
    int32_t result = 0; // 0x8115b77
    char * buf = buffer; // 0x8115b77
    if (length == 0) {
        // 0x8115b79
        return 0;
    }
    int32_t nbyte = length; // 0x8115b77
    int32_t v1 = read(fd, (int32_t *)buf, nbyte); // 0x8115b53
    while (v1 != 0) {
        // 0x8115b61
        result += v1;
        nbyte -= v1;
        buf = (char *)(v1 + (int32_t)buf);
        if (nbyte == 0) {
            // break -> 0x8115b79
            break;
        }
        v1 = read(fd, (int32_t *)buf, nbyte);
    }
    // 0x8115b79
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTTCP.c
// Address range: 0x8115b7e - 0x811656f
// Line range:    689 - 1221
struct hostent * LYGetHostByName(char * str) {
    int32_t fds[2]; // 0x8115d1f
    char * rehostent = NULL; // bp-24, 0x8115b9c
    if (str == NULL) {
        if (WWW_TraceFlag != 0) {
            // 0x8115bb4
            fprintf(TraceFP(), "LYGetHostByName: Can't parse `NULL'.\n");
        }
        // 0x8115bcb
        lynx_nsl_status = -900;
        // 0x8116560
        return NULL;
    }
    if (WWW_TraceFlag != 0) {
        // 0x8115bef
        fprintf(TraceFP(), "LYGetHostByName: parsing `%s'.\n", str);
    }
    // 0x8115c0d
    if (HTCheckForInterrupt() != 0) {
        // 0x8115c16
        if (WWW_TraceFlag != 0) {
            // 0x8115c21
            fprintf(TraceFP(), "LYGetHostByName: INTERRUPTED for '%s'.\n", str);
        }
        // 0x8115c3f
        lynx_nsl_status = -0x752e;
        // 0x8116560
        return NULL;
    }
    // 0x8115c58
    if (valid_hostname(str) == 0) {
        // 0x8115c67
        lynx_nsl_status = -406;
        my_errno = 3;
        // 0x8116560
        return NULL;
    }
    // 0x8115c8a
    if (WWW_TraceFlag != 0) {
        // 0x8115c95
        fflush(TraceFP());
    }
    // 0x8115ca2
    lynx_nsl_status = -900;
    int32_t stat_loc = 0; // bp-48, 0x8115cb7
    int32_t time_val = time(NULL); // 0x8115cc5
    while (true) {
        int32_t v1 = waitpid(-1, NULL, WNOHANG); // 0x8115cf2
        if (v1 >= 0 != v1 != 0) {
            if (v1 != -1) {
                // break -> 0x8115d12
                break;
            }
            // 0x8115d06
            if (*__errno_location() != 4) {
                // break -> 0x8115d12
                break;
            }
        }
    }
    // 0x8115d12
    int32_t fd2; // bp-120, 0x8115b7e
    fds[0] = &fd2;
    pipe(fds);
    int32_t set; // bp-404, 0x8115b7e
    sigemptyset((struct _TYPEDEF_sigset_t *)&set);
    sigaddset((struct _TYPEDEF_sigset_t *)&set, SIGTERM);
    sigaddset((struct _TYPEDEF_sigset_t *)&set, SIGINT);
    sigaddset((struct _TYPEDEF_sigset_t *)&set, SIGHUP);
    sigaddset((struct _TYPEDEF_sigset_t *)&set, SIGCHLD);
    sigaddset((struct _TYPEDEF_sigset_t *)&set, SIGWINCH);
    int32_t oset; // bp-276, 0x8115b7e
    sigprocmask(SIG_BLOCK, (struct _TYPEDEF_sigset_t *)&set, (struct _TYPEDEF_sigset_t *)&oset);
    int32_t pid = fork(); // 0x8115dc0
    char * v2; // 0x8115b7e
    int32_t v3; // 0x8115b7e
    int32_t v4; // 0x8115b7e
    int32_t buf; // bp-148, 0x8115b7e
    int32_t v5; // 0x8115b7e
    int32_t v6; // 0x8115b7e
    bool v7; // 0x8115b7e
    int32_t fd; // 0x8115b7e
    int32_t v8; // 0x8115ec6
    if (pid != 0) {
        // 0x8115fe1
        sigprocmask(SIG_SETMASK, (struct _TYPEDEF_sigset_t *)&oset, NULL);
        close(fd);
        if (pid >= 0) {
            // 0x8116337
            int32_t v9; // bp-4, 0x8115b7e
            int32_t v10 = (int32_t)&v9 - 528;
            v5 = 0;
            v7 = true;
            if (v7) {
                // 0x8116341
                if (time(NULL) - time_val >= 30) {
                    // break -> 0x8116359
                    break;
                }
            }
            int32_t readfds; // bp-532, 0x8115b7e
            for (int32_t i = 0; i < 32; i++) {
                // 0x8116036
                *(int32_t *)(4 * i + (int32_t)&readfds) = 0;
            }
            uint32_t v11 = LYConsoleInputFD(1); // 0x8116054
            int32_t * v12; // 0x811606a
            if (v11 != -1) {
                // 0x8116062
                v12 = (int32_t *)(4 * v11 / 32 + v10);
                *v12 = *v12 | 1 << v11 % 32;
            }
            int32_t timeout = 1; // bp-128, 0x8116089
            int32_t * v13 = (int32_t *)(4 * fd2 / 32 + v10); // 0x811609f
            *v13 = 1 << fd2 % 32 | *v13;
            uint32_t v14 = select(fd2 + 1, (struct _TYPEDEF_fd_set *)&readfds, NULL, NULL, (struct timeval *)&timeout); // 0x81160e8
            uint32_t v15; // 0x81160fa
            int32_t v16; // 0x8116184
            if (v14 >= 1) {
                // 0x81160fa
                v15 = fd2;
                if ((1 << v15 % 32 & *(int32_t *)(4 * v15 / 32 + v10)) != 0) {
                    // 0x811611e
                    if (readit(v15, (char *)&buf, 20) != 20) {
                        // 0x81161d7
                        lynx_nsl_status = -1;
                        v3 = 0;
                        goto lab_0x81161e1;
                    } else {
                        // 0x8116148
                        __errno_location();
                        v3 = 0;
                        if (buf < 21) {
                            goto lab_0x81161e1;
                        } else {
                            // 0x811616d
                            v16 = readit(fd2, (char *)&g338, buf);
                            dump_hostent("Read from pipe", (struct hostent *)&g338);
                            if (buf != v16) {
                                // 0x81161cb
                                lynx_nsl_status = -900;
                                v3 = 0;
                                goto lab_0x81161e1;
                            } else {
                                // 0x81161aa
                                *(int32_t *)&rehostent = (int32_t)&g338;
                                lynx_nsl_status = 0;
                                v3 = 1;
                                goto lab_0x81161e1;
                            }
                        }
                    }
                }
            }
            int32_t v17 = waitpid(pid, &stat_loc, WNOHANG);
            v4 = 0;
            v6 = v17;
            while (v7) {
                bool v18 = false; // 0x81162af
                if (v17 < 1) {
                    // 0x81162ba
                    v18 = true;
                    if (HTCheckForInterrupt() != 0) {
                        // 0x81162c3
                        if (WWW_TraceFlag == 0) {
                            goto lab_0x81162e5;
                        } else {
                            // 0x81162ce
                            fprintf(TraceFP(), "LYGetHostByName: INTERRUPTED gethostbyname.\n");
                            goto lab_0x81162e5;
                        }
                    }
                }
                // 0x8116337
                v5 = v17;
                v7 = v18;
                if (v7) {
                    // 0x8116341
                    v4 = 0;
                    v6 = v5;
                    if (time(NULL) - time_val >= 30) {
                        // break -> 0x8116359
                        break;
                    }
                }
                for (int32_t i = 0; i < 32; i++) {
                    // 0x8116036
                    *(int32_t *)(4 * i + (int32_t)&readfds) = 0;
                }
                // 0x811604d
                v11 = LYConsoleInputFD(1);
                if (v11 != -1) {
                    // 0x8116062
                    v12 = (int32_t *)(4 * v11 / 32 + v10);
                    *v12 = *v12 | 1 << v11 % 32;
                }
                // 0x8116089
                timeout = 1;
                v13 = (int32_t *)(4 * fd2 / 32 + v10);
                *v13 = 1 << fd2 % 32 | *v13;
                v14 = select(fd2 + 1, (struct _TYPEDEF_fd_set *)&readfds, NULL, NULL, (struct timeval *)&timeout);
                if (v14 >= 1) {
                    // 0x81160fa
                    v15 = fd2;
                    if ((1 << v15 % 32 & *(int32_t *)(4 * v15 / 32 + v10)) != 0) {
                        // 0x811611e
                        if (readit(v15, (char *)&buf, 20) != 20) {
                            // 0x81161d7
                            lynx_nsl_status = -1;
                            v3 = 0;
                            goto lab_0x81161e1;
                        } else {
                            // 0x8116148
                            __errno_location();
                            v3 = 0;
                            if (buf < 21) {
                                goto lab_0x81161e1;
                            } else {
                                // 0x811616d
                                v16 = readit(fd2, (char *)&g338, buf);
                                dump_hostent("Read from pipe", (struct hostent *)&g338);
                                if (buf != v16) {
                                    // 0x81161cb
                                    lynx_nsl_status = -900;
                                    v3 = 0;
                                    goto lab_0x81161e1;
                                } else {
                                    // 0x81161aa
                                    *(int32_t *)&rehostent = (int32_t)&g338;
                                    lynx_nsl_status = 0;
                                    v3 = 1;
                                    goto lab_0x81161e1;
                                }
                            }
                        }
                    }
                }
                // 0x8116266
                v17 = waitpid(pid, &stat_loc, WNOHANG);
                v4 = 0;
                v6 = v17;
            }
            goto lab_0x8116359;
        } else {
            // 0x8116014
            close(fd2);
            goto lab_0x811652d;
        }
    } else {
        // 0x8115dd2
        signal(SIGTERM, 0x811535f);
        signal(SIGINT, 0x811535f);
        signal(SIGHUP, 0x811535f);
        if (no_suspend == 0) {
            // 0x8115e2f
            signal(SIGCHLD, SIG_DFL);
        } else {
            // 0x8115e19
            signal(SIGCHLD, SIG_IGN);
        }
        // 0x8115e43
        signal(SIGWINCH, SIG_IGN);
        signal(SIGSEGV, SIG_DFL);
        signal(SIGILL, SIG_DFL);
        sigprocmask(SIG_SETMASK, (struct _TYPEDEF_sigset_t *)&oset, NULL);
        close(fd2);
        *__errno_location() = 0;
        struct hostent * v19 = gethostbyname(str); // 0x8115eb9
        v8 = *__errno_location();
        dump_hostent("CHILD gethostbyname", v19);
        if (v19 == NULL) {
            // 0x8115f43
            v2 = NULL;
            goto lab_0x8115f62;
        } else {
            // 0x8115ef2
            if (*(int32_t *)((int32_t)v19 + 12) == 0) {
                // 0x8115f43
                v2 = NULL;
                goto lab_0x8115f62;
            } else {
                char * v20 = (char *)fill_rehostent((char *)&g338, 128, v19); // 0x8115f16
                dump_hostent("CHILD fill_rehostent", (struct hostent *)&g338);
                if (v20 > (char *)20) {
                    // 0x8115f39
                    v2 = v20;
                    if (g339 != 0) {
                        goto lab_0x8115f62;
                    } else {
                        // 0x8115f43
                        v2 = NULL;
                        goto lab_0x8115f62;
                    }
                } else {
                    // 0x8115f43
                    v2 = NULL;
                    goto lab_0x8115f62;
                }
            }
        }
    }
  lab_0x8116359:;
    int32_t v21 = v6;
    close(fd2);
    int32_t v22 = v21; // 0x8116368
    if (v21 >= 0 != v21 != 0) {
        // 0x811636a
        kill(pid, SIGTERM);
        v22 = waitpid(pid, &stat_loc, WNOHANG);
    }
    // 0x811639a
    if (v22 >= 1) {
        uint32_t v23 = stat_loc % 128; // 0x81163ad
        if (v23 != 0) {
            char v24 = (char)stat_loc % 128 + 1; // 0x811640e
            if (v24 < 2 || v24 < 0) {
                // 0x8116492
                if (stat_loc % 256 == 127 && WWW_TraceFlag != 0) {
                    // 0x81164b0
                    fprintf(TraceFP(), "LYGetHostByName: NSL_FORK child %d is stopped, status 0x%x!\n", v22, stat_loc / 256 % 256);
                }
            } else {
                // 0x8116414
                if (WWW_TraceFlag != 0) {
                    // 0x8116451
                    fprintf(TraceFP(), "LYGetHostByName: NSL_FORK child %d got signal, status 0x%x!\n", v22, v23);
                    if ((char)stat_loc <= -1 && WWW_TraceFlag != 0) {
                        // 0x8116472
                        fprintf(TraceFP(), "LYGetHostByName: NSL_FORK child %d dumped core!\n", v22);
                    }
                }
            }
        } else {
            // 0x81163b4
            if (WWW_TraceFlag != 0) {
                // 0x81163c3
                fprintf(TraceFP(), "LYGetHostByName: NSL_FORK child %d exited, status 0x%x.\n", v22, stat_loc / 256 % 256);
            }
        }
    }
    struct hostent * result; // 0x8115b7e
    if (v4 != 0) {
        // 0x81164ed
        dump_hostent("End of LYGetHostByName", (struct hostent *)rehostent);
        result = (struct hostent *)rehostent;
        if (WWW_TraceFlag != 0) {
            // 0x811650b
            fprintf(TraceFP(), "LYGetHostByName: Resolved name to a hostent.\n");
            result = (struct hostent *)rehostent;
        }
      lab_0x8116560:
        // 0x8116560
        return result;
    }
    goto lab_0x811652d;
  lab_0x811652d:
    // 0x811652d
    if (WWW_TraceFlag != 0) {
        // 0x8116538
        fprintf(TraceFP(), "LYGetHostByName: Can't find internet node name `%s'.\n", str);
    }
    // 0x8116560
    return NULL;
  lab_0x8115f62:
    // 0x8115f62
    if (v8 == 0) {
        // 0x8115f6c
        __errno_location();
    }
    int32_t nbyte = (int32_t)v2; // 0x8115f79
    buf = nbyte;
    write(fd, &buf, 20);
    if (v2 == NULL) {
        // 0x8115fd5
        _exit(1);
        // UNREACHABLE
    }
    // 0x8115fa5
    write(fd, (int32_t *)&g338, nbyte);
    close(fd);
    _exit(0);
    // UNREACHABLE
  lab_0x81161e1:;
    int32_t v25 = v5; // 0x81161e5
    if (!v7) {
        goto lab_0x8116204;
    } else {
        // 0x81161e7
        v25 = waitpid(pid, &stat_loc, WNOHANG);
        goto lab_0x8116204;
    }
  lab_0x8116204:
    // 0x8116204
    v4 = v3;
    v6 = v25;
    if (stat_loc % 128 == 0) {
        goto lab_0x8116359;
    } else {
        char v26 = (char)stat_loc % 128 + 1; // 0x8116227
        v4 = v3;
        v6 = v25;
        if (v26 >= 0 == v26 >= 2) {
            goto lab_0x8116359;
        } else {
            // 0x8116231
            kill(pid, SIGTERM);
            int32_t v27 = waitpid(pid, &stat_loc, WNOHANG); // 0x8116259
            v4 = v3;
            v6 = v27;
            goto lab_0x8116359;
        }
    }
  lab_0x81162e5:
    // 0x81162e5
    kill(pid, SIGTERM);
    waitpid(pid, NULL, WNOHANG);
    close(fd2);
    lynx_nsl_status = -0x752e;
    result = NULL;
    goto lab_0x8116560;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTTCP.c
// Address range: 0x811670f - 0x8116799
// Line range:    1451 - 1525
void get_host_details(void) {
    int32_t v1 = __readgsdword(20); // 0x8116716
    if (hostname == 0) {
        // 0x8116731
        int32_t name; // bp-77, 0x811670f
        gethostname((char *)&name, 65);
        HTSACopy((char **)&hostname, (char *)&name);
        if (WWW_TraceFlag != 0) {
            // 0x8116761
            fprintf(TraceFP(), "TCP: Local host name is %s\n", (char *)hostname);
        }
    }
    // 0x8116782
    if (v1 != __readgsdword(20)) {
        // 0x811678e
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTTCP.c
// Address range: 0x8116799 - 0x81167ab
// Line range:    1528 - 1531
char * HTHostName(void) {
    // 0x8116799
    get_host_details();
    return (char *)hostname;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x8119b0b - 0x8119e2f
// Line range:    1366 - 1397
int32_t * SGMLFindTag(int32_t * dtd, char * s) {
    int32_t * v1 = (int32_t *)((int32_t)(4 * *s) + (int32_t)&g340); // 0x8119b2c
    int32_t v2 = *v1; // 0x8119b2c
    if (v2 != 0) {
        int32_t v3 = *(int32_t *)v2; // 0x8119b37
        if (v3 == 0) {
            // 0x8119e26
            return (int32_t *)0;
        }
        // 0x8119b49
        if (strcasecomp((char *)v3, s) == 0) {
            // 0x8119e26
            return (int32_t *)*v1;
        }
    }
    uint32_t v4 = *(int32_t *)((int32_t)dtd + 4); // 0x8119b7a
    int32_t v5 = v4; // 0x8119dec
    int32_t v6 = 0; // 0x8119dec
    if (v4 <= 0) {
      lab_0x8119df2:;
        int16_t v7 = *(int16_t *)(2 * (int32_t)*s + (int32_t)*__ctype_b_loc()); // 0x8119e07
        // 0x8119e26
        return (int32_t *)((v7 & 1024) == 0 ? 0 : (int32_t)&HTTag_unrecognized);
    }
    int32_t v8 = v5 - v6; // 0x8119b8d
    int32_t v9 = (v8 + (int32_t)(v8 < 0) >> 1) + v6; // 0x8119b9a
    int16_t * v10 = *__ctype_b_loc(); // 0x8119ba5
    int32_t v11 = 56 * v9; // 0x8119bbd
    int32_t c = (int32_t)*(char *)*(int32_t *)(v11 + *dtd); // 0x8119bc4
    int32_t v12 = c; // 0x8119bdc
    if ((*(int16_t *)(2 * c + (int32_t)v10) & 512) != 0) {
        // 0x8119bde
        v12 = toupper(c);
    }
    int16_t * v13 = *__ctype_b_loc(); // 0x8119c39
    int32_t c2 = (int32_t)*s; // 0x8119c3e
    int32_t v14 = c2; // 0x8119c56
    if ((*(int16_t *)(2 * c2 + (int32_t)v13) & 512) != 0) {
        // 0x8119c58
        v14 = toupper(c2);
    }
    // 0x8119c7a
    int32_t v15; // 0x8119b0b
    int32_t v16; // 0x8119b0b
    int32_t v17; // 0x8119b0b
    int16_t * v18; // 0x8119cbb
    int32_t c3; // 0x8119cda
    int16_t * v19; // 0x8119d4f
    int32_t c4; // 0x8119d54
    if (v12 != v14) {
        // 0x8119cb6
        v18 = *__ctype_b_loc();
        c3 = (int32_t)*(char *)*(int32_t *)(*dtd + v11);
        v16 = c3;
        if ((*(int16_t *)(2 * c3 + (int32_t)v18) & 512) != 0) {
            // 0x8119cf4
            v16 = toupper(c3);
        }
        // 0x8119d4a
        v19 = *__ctype_b_loc();
        c4 = (int32_t)*s;
        v15 = c4;
        if ((*(int16_t *)(2 * c4 + (int32_t)v19) & 512) != 0) {
            // 0x8119d6e
            v15 = toupper(c4);
        }
        // 0x8119d90
        v17 = v16 - v15;
    } else {
        // 0x8119c82
        v17 = strcasecomp((char *)*(int32_t *)(*dtd + v11), s);
    }
    while (v17 != 0) {
        // 0x8119dcf
        v6 = v17 >= 0 ? v6 : v9 + 1;
        v5 = v17 >= 0 ? v9 : v5;
        if (v5 <= v6) {
            goto lab_0x8119df2;
        }
        v8 = v5 - v6;
        v9 = (v8 + (int32_t)(v8 < 0) >> 1) + v6;
        v10 = *__ctype_b_loc();
        v11 = 56 * v9;
        c = (int32_t)*(char *)*(int32_t *)(v11 + *dtd);
        v12 = c;
        if ((*(int16_t *)(2 * c + (int32_t)v10) & 512) != 0) {
            // 0x8119bde
            v12 = toupper(c);
        }
        // 0x8119c34
        v13 = *__ctype_b_loc();
        c2 = (int32_t)*s;
        v14 = c2;
        if ((*(int16_t *)(2 * c2 + (int32_t)v13) & 512) != 0) {
            // 0x8119c58
            v14 = toupper(c2);
        }
        // 0x8119c7a
        if (v12 != v14) {
            // 0x8119cb6
            v18 = *__ctype_b_loc();
            c3 = (int32_t)*(char *)*(int32_t *)(*dtd + v11);
            v16 = c3;
            if ((*(int16_t *)(2 * c3 + (int32_t)v18) & 512) != 0) {
                // 0x8119cf4
                v16 = toupper(c3);
            }
            // 0x8119d4a
            v19 = *__ctype_b_loc();
            c4 = (int32_t)*s;
            v15 = c4;
            if ((*(int16_t *)(2 * c4 + (int32_t)v19) & 512) != 0) {
                // 0x8119d6e
                v15 = toupper(c4);
            }
            // 0x8119d90
            v17 = v16 - v15;
        } else {
            // 0x8119c82
            v17 = strcasecomp((char *)*(int32_t *)(*dtd + v11), s);
        }
    }
    int32_t v20 = *dtd + v11; // 0x8119dbd
    *v1 = v20;
    // 0x8119e26
    return (int32_t *)v20;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x8120ec3 - 0x8120eda
// Line range:    4509 - 4515
int32_t SGML_offset(void) {
    // 0x8120ec3
    return sgml_offset + (int32_t)psrc_view;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x8120f4b - 0x812100f
// Line range:    4629 - 4641
int32_t IS_SJIS_STR(char * str) {
    char v1 = *str; // 0x8120fea
    if (v1 == 0) {
        // 0x812100a
        return 0;
    }
    int32_t v2 = (int32_t)str;
    char v3 = v1;
    v2++;
    char v4 = *(char *)v2;
    if (v3 < 0) {
        if (v4 != 127 == v4 < 253) {
            // 0x8120f89
            if (v3 < 160 == v3 < 0 == (v3 != -128)) {
                // break -> 0x812100a
                break;
            }
        }
    }
    int32_t result = 0; // 0x8120ffd
    while (v4 != 0) {
        // 0x8120f63
        v3 = v4;
        v2++;
        v4 = *(char *)v2;
        if (v3 < 0) {
            if (v4 != 127 == v4 < 253) {
                // 0x8120f89
                result = 1;
                if (v3 < 160 == v3 < 0 == (v3 != -128)) {
                    // break -> 0x812100a
                    break;
                }
            }
        }
        // 0x8120fe7
        result = 0;
    }
    // 0x812100a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x812100f - 0x812107e
// Line range:    4646 - 4660
char * SJIS_TO_JIS1(unsigned char HI, char LO, char * JCODE) {
    unsigned char v1 = (char)(LO < 0) + LO;
    *JCODE = (2 * (HI - (HI < 160 ? 113 : 49)) | 1) + (char)(v1 >= 158);
    *(char *)((int32_t)JCODE + 1) = (v1 < 158 ? -31 : -125) + v1;
    return JCODE;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x812107e - 0x81210e2
// Line range:    4665 - 4679
char * JIS_TO_SJIS1(unsigned char HI, char LO, char * SJCODE) {
    unsigned char v1 = (HI % 2 == 0 ? 125 : 31) + LO;
    char v2 = ((int32_t)HI + 479) / 2;
    unsigned char v3 = v2 - 127; // 0x81210bb
    *SJCODE = v3 < 160 ? v3 : v2 - 63;
    *(char *)((int32_t)SJCODE + 1) = v1 + (char)(v1 > 126);
    return SJCODE;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x81211ba - 0x8121210
// Line range:    4706 - 4711
char * SJIS_TO_EUC1(char HI, char LO, char * data) {
    // 0x81211ba
    SJIS_TO_JIS1(HI, LO, data);
    *data = *data | -128;
    char * v1 = (char *)((int32_t)data + 1); // 0x8121203
    *v1 = *v1 | -128;
    return data;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x812132d - 0x81213d1
// Line range:    4737 - 4755
char * EUC_TO_SJIS(char * src, char * dst) {
    char * v1 = src; // 0x812133f
    char * v2 = dst; // 0x812133f
    int32_t v3; // 0x812132d
    char * v4; // 0x812132d
    int32_t v5; // 0x812132d
    while (true) {
      lab_0x81213b8_2:
        // 0x81213b8
        v4 = v2;
        char v6 = *v1; // 0x81213bb
        if (v6 == 0) {
            // break (via goto) -> 0x81213c6
            goto lab_0x81213c6;
        }
        char * v7 = v1;
        while (v6 < 0) {
            int32_t v8 = (int32_t)v7;
            char * v9 = (char *)(v8 + 1); // 0x8121351
            char v10 = *v9; // 0x8121351
            char v11 = v10; // 0x8121356
            if (v10 != 0 && v10 < 0) {
                // 0x8121365
                JIS_TO_SJIS1(v6 % 128, v10 % 128, v4);
                v5 = v8 + 2;
                v3 = (int32_t)v4 + 2;
                goto lab_0x81213b8;
            }
            v6 = v11;
            if (v6 == 0) {
                // break (via goto) -> 0x81213c6
                goto lab_0x81213c6;
            }
            // 0x8121341
            v7 = v9;
        }
        // 0x81213a5
        *v4 = v6;
        v5 = (int32_t)v7 + 1;
        v3 = (int32_t)v4 + 1;
        goto lab_0x81213b8;
    }
  lab_0x81213c6:
    // 0x81213c6
    *v4 = 0;
    return dst;
  lab_0x81213b8:
    // 0x81213b8
    v1 = (char *)v5;
    v2 = (char *)v3;
    goto lab_0x81213b8_2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x8121543 - 0x81215f5
// Line range:    4811 - 4831
char * repairJIStoEUC(char * src, char ** dstp) {
    char v1 = *src; // 0x81215c7
    if (v1 == 0) {
        // 0x81215f0
        return NULL;
    }
    int32_t v2 = (int32_t)*dstp; // 0x8121543
    char v3 = v1; // 0x81215c7
    int32_t v4 = (int32_t)src; // 0x81215d3
    char v5 = *(char *)(v4 + 1); // 0x81215d9
    char * result = NULL; // 0x81215e3
    while (v5 != 0) {
        int32_t v6 = v2;
        char * v7 = (char *)(v4 + 2);
        if (v3 == 40) {
            if (v5 != 66 != v5 != 74) {
                // 0x812156f
                *(int32_t *)dstp = v6;
                result = v7;
                return result;
            }
        }
        // 0x812157f
        result = NULL;
        if (v3 < 127 != v5 < 127) {
            // break -> 0x81215f0
            break;
        }
        // 0x81215a0
        *(char *)v6 = v3 | -128;
        *(char *)(v6 + 1) = v5 | -128;
        v3 = *v7;
        v2 = v6 + 2;
        result = NULL;
        if (v3 == 0) {
            // break -> 0x81215f0
            break;
        }
        v4 = (int32_t)v7;
        v5 = *(char *)(v4 + 1);
        result = NULL;
    }
  lab_0x81215f0:
    // 0x81215f0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x81215f5 - 0x81218e5
// Line range:    4835 - 4919
char * TO_EUC(char * jis, char * euc) {
    // 0x81215f5
    g341++;
    char * v1 = euc; // bp-8, 0x812161f
    int32_t v2 = IS_SJIS_STR(jis); // 0x812163a
    char v3 = *jis; // 0x81218c1
    char * v4 = jis; // 0x81218d4
    char v5 = v3; // 0x81218d4
    char * v6 = NULL; // 0x81218d4
    char v7 = 0; // 0x81218d4
    char * v8 = NULL; // 0x81218d4
    int32_t v9 = v2; // 0x81218d4
    if (v3 == 0) {
        // 0x81218da
        *euc = 0;
        return euc;
    }
    int32_t v10; // 0x81215f5
    char v11; // 0x81215f5
    char * v12; // 0x81215f5
    char * v13; // 0x81215f5
    int32_t v14; // 0x81215f5
    char v15; // 0x81215f5
    char * v16; // 0x81215f5
    char * v17; // 0x81215f5
    while (true) {
      lab_0x812164e:
        // 0x812164e
        v14 = v9;
        v12 = v8;
        v15 = v7;
        v13 = v6;
        v11 = v5;
        v10 = (int32_t)v4;
        v17 = (char *)(v10 + 1);
        v9 = v14;
        v8 = v12;
        v16 = v17;
        v7 = v15;
        v6 = v13;
        if (v11 == -128) {
            goto lab_0x81218be;
        } else {
            // 0x8121658
            v9 = v14;
            v8 = v12;
            v16 = v17;
            v7 = v15;
            v6 = v13;
            if (v11 == -96 == (v13 != NULL)) {
                goto lab_0x81218be;
            } else {
                if (v11 != 36) {
                    goto lab_0x81216bd;
                } else {
                    // 0x8121671
                    if (v15 != 0 || repair_JIS == 0) {
                        goto lab_0x81216bd;
                    } else {
                        char v18 = *v17; // 0x8121683
                        if (v18 != 66 == (v18 != 64)) {
                            goto lab_0x81216bd;
                        } else {
                            char * v19 = repairJIStoEUC((char *)(v10 + 2), &v1); // 0x81216a4
                            v9 = v14;
                            v8 = v12;
                            v16 = v19;
                            v7 = v15;
                            v6 = v13;
                            if (v19 == NULL) {
                                goto lab_0x81216bd;
                            } else {
                                goto lab_0x81218be;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x81218be_2:
    // 0x81218da
    *v1 = 0;
    return euc;
  lab_0x81218be:
    // 0x81218be
    v4 = v16;
    v5 = *v4;
    if (v5 == 0) {
        // break -> 0x81218be
        goto lab_0x81218be_2;
    }
    goto lab_0x812164e;
  lab_0x81216bd:;
    char v20 = *v17;
    char v21 = v15; // 0x81216c1
    if (v11 != 27) {
        goto lab_0x8121756;
    } else {
        if (v20 != 36) {
            if (v20 != 40) {
                // 0x8121748
                v21 = v20 != 44 ? v15 : 0;
                goto lab_0x8121756;
            } else {
                char v22 = *(char *)(v10 + 2); // 0x812171e
                switch (v22) {
                    case 66: {
                        goto lab_0x812173f;
                    }
                    case 74: {
                        goto lab_0x812173f;
                    }
                    default: {
                        // 0x8121732
                        v21 = 0;
                        if (v22 != 72) {
                            goto lab_0x8121756;
                        } else {
                            goto lab_0x812173f;
                        }
                    }
                }
            }
        } else {
            char v23 = *(char *)(v10 + 2); // 0x81216db
            v21 = 0;
            if (v23 != 66 == (v23 != 64)) {
                goto lab_0x8121756;
            } else {
                // 0x81216ef
                v9 = v14;
                v8 = v12;
                v16 = (char *)(v10 + 3);
                v7 = -128;
                v6 = (char *)((int32_t)v13 + 1);
                goto lab_0x81218be;
            }
        }
    }
  lab_0x8121756:;
    char v24 = v21;
    char * v25 = v11 >= 0 ? v12 : (char *)((int32_t)v12 + 1);
    int32_t v26; // 0x81215f5
    if (v20 != 127 == v20 < 253) {
        // 0x8121780
        v26 = 1;
        if (v11 < 0 == v11 < 160) {
            goto lab_0x81217d5;
        } else {
            // 0x81217cf
            v26 = v14;
            if ((v11 & -16) == -32 != v14 != 0) {
                goto lab_0x812180b;
            } else {
                goto lab_0x81217d5;
            }
        }
    } else {
        goto lab_0x812180b;
    }
  lab_0x812180b:
    if (v24 == 0) {
        // 0x812189d
        v9 = v14;
        v8 = NULL;
        v16 = v17;
        v7 = 0;
        v6 = v13;
        if ((v11 || 1) == 15 != (v25 == NULL)) {
            // 0x81218af
            *v1 = v11;
            v1 = (char *)((int32_t)v1 + 1);
            v9 = v14;
            v8 = v25;
            v16 = v17;
            v7 = 0;
            v6 = v13;
        }
    } else {
        if (v11 < 127) {
            char * v27 = v1;
            int32_t v28 = (int32_t)v27;
            if (v20 < 127) {
                // 0x8121860
                *v27 = v24 | v11;
                char * v29 = (char *)(v28 + 1); // 0x812186f
                v1 = v29;
                *v29 = *v17 | v24;
                v1 = (char *)(v28 + 2);
                v9 = v14;
                v8 = v25;
                v16 = (char *)(v10 + 2);
                v7 = v24;
                v6 = v13;
            } else {
                // 0x812188c
                *v27 = v11;
                v1 = (char *)(v28 + 1);
                v9 = v14;
                v8 = v25;
                v16 = v17;
                v7 = v24;
                v6 = v13;
            }
        } else {
            // 0x8121821
            *v1 = v11;
            v1 = (char *)((int32_t)v1 + 1);
            v9 = v14;
            v8 = v25;
            v16 = v17;
            v7 = v11 != 10 ? v24 : 0;
            v6 = v13;
        }
    }
    goto lab_0x81218be;
  lab_0x81217d5:
    // 0x81217d5
    SJIS_TO_EUC1(v11, v20, v1);
    v1 = (char *)((int32_t)v1 + 2);
    v9 = v26;
    v8 = v25;
    v16 = (char *)(v10 + 2);
    v7 = v24;
    v6 = (char *)((int32_t)v13 + 1);
    goto lab_0x81218be;
  lab_0x812173f:
    // 0x812173f
    v9 = v14;
    v8 = v12;
    v16 = (char *)(v10 + 3);
    v7 = 0;
    v6 = v13;
    goto lab_0x81218be;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x81218e5 - 0x812197e
// Line range:    4924 - 4943
int32_t is_EUC_JP(char * euc) {
    char v1 = *euc; // 0x8121963
    if (v1 == 0) {
        // 0x8121979
        return 1;
    }
    char * v2 = euc; // 0x81218fd
    unsigned char v3; // 0x8121905
    unsigned char v4; // 0x81218e5
    unsigned char v5; // 0x81218e5
    if (v1 <= 255) {
        // 0x81218ff
        v2 = (char *)((int32_t)euc + 1);
        v3 = *v2;
        if (v3 > -1) {
            // break -> 0x8121979
            break;
        }
        // 0x8121923
        v4 = v1 % 128;
        if (v4 < 33 || v4 == 127) {
            // break -> 0x8121979
            break;
        }
        // 0x8121939
        v5 = v3 % 128;
        if (v5 > 32 != v5 != 127) {
            // break -> 0x8121979
            break;
        }
    }
    char * v6 = (char *)((int32_t)v2 + 1); // 0x812195c
    char v7 = *v6; // 0x8121963
    int32_t result = 1; // 0x8121970
    while (v7 != 0) {
        char * v8 = v6;
        unsigned char v9 = v7;
        v2 = v8;
        if (v9 <= 255) {
            // 0x81218ff
            v2 = (char *)((int32_t)v8 + 1);
            v3 = *v2;
            result = 0;
            if (v3 > -1) {
                // break -> 0x8121979
                break;
            }
            // 0x8121923
            v4 = v9 % 128;
            result = 0;
            if (v4 < 33 || v4 == 127) {
                // break -> 0x8121979
                break;
            }
            // 0x8121939
            v5 = v3 % 128;
            result = 0;
            if (v5 > 32 != v5 != 127) {
                // break -> 0x8121979
                break;
            }
        }
        // 0x812195c
        v6 = (char *)((int32_t)v2 + 1);
        v7 = *v6;
        result = 1;
    }
    // 0x8121979
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/SGML.c
// Address range: 0x812197e - 0x8121a0b
// Line range:    4947 - 4962
void TO_SJIS(char * arg, char * sjis) {
    int32_t * mem = malloc(strlen(arg) + 1); // 0x8121995
    if (mem == NULL) {
        // 0x81219a3
        outofmem("../../../WWW/Library/Implementation/SGML.c", "TO_SJIS");
        // UNREACHABLE
    }
    // 0x81219b7
    TO_EUC(arg, (char *)mem);
    if (is_EUC_JP((char *)mem) == 0) {
        // 0x81219ec
        strcpy(sjis, arg);
    } else {
        // 0x81219d8
        EUC_TO_SJIS((char *)mem, sjis);
    }
    // 0x81219fe
    free(mem);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTMLDTD.c
// Address range: 0x8121aa4 - 0x8121b4e
// Line range:    230 - 242
void HTSwitchDTD(int32_t new_flag) {
    // 0x8121aa4
    if (WWW_TraceFlag != 0) {
        char * v1 = new_flag == 0 ? "tagsoup" : "strict";
        fprintf(TraceFP(), "HTMLDTD: Copying %s DTD element info of size %d, %d * %d\n", v1, 0x1a08, 119, 56);
    }
    if (new_flag == 0) {
        // 0x8121b30
        memcpy(&tags, &tags_table0, 0x1a08);
    } else {
        // 0x8121b12
        memcpy(&tags, &tags_table1, 0x1a08);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x8121de4 - 0x8121e0f
// Line range:    15 - 20
void HTChunkInit(int32_t * ch, int32_t grow) {
    int32_t v1 = (int32_t)ch;
    *(int32_t *)(v1 + 12) = 0;
    *(int32_t *)(v1 + 4) = grow;
    *ch = 0;
    *(int32_t *)(v1 + 8) = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x8121e0f - 0x8121e5d
// Line range:    26 - 34
int32_t * HTChunkCreate(int32_t grow) {
    int32_t * mem = calloc(1, 24); // 0x8121e24
    if (mem != NULL) {
        // 0x8121e46
        HTChunkInit(mem, grow);
        return mem;
    }
    // 0x8121e32
    outofmem("../../../WWW/Library/Implementation/HTChunk.c", "creation of chunk");
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x8121eca - 0x8121fce
// Line range:    56 - 74
int32_t * HTChunkCreate2(int32_t grow, int32_t needed) {
    int32_t * mem = calloc(1, 24); // 0x8121ee1
    if (mem == NULL) {
        // 0x8121eef
        outofmem("../../../WWW/Library/Implementation/HTChunk.c", "HTChunkCreate2");
        // UNREACHABLE
    }
    // 0x8121f03
    HTChunkInit(mem, grow);
    if (needed == 0) {
        // 0x8121fc4
        return mem;
    }
    int32_t v1 = (int32_t)mem; // 0x8121ee1
    uint32_t v2 = needed - 1;
    uint32_t v3 = *(int32_t *)(v1 + 4); // 0x8121f28
    int32_t v4 = v3 + v2 - v2 % v3; // 0x8121f4a
    int32_t * v5 = (int32_t *)(v1 + 8); // 0x8121f52
    *v5 = v4;
    int32_t nmemb = v4; // 0x8121f5e
    if (WWW_TraceFlag != 0) {
        // 0x8121f60
        fprintf(TraceFP(), "HTChunkCreate2: requested %d, allocate %d\n", needed, v4);
        nmemb = *v5;
    }
    int32_t * mem2 = calloc(nmemb, 1); // 0x8121f99
    *(int32_t *)(v1 + 12) = (int32_t)mem2;
    if (mem2 != NULL) {
        // 0x8121fc4
        return mem;
    }
    // 0x8121fb0
    outofmem("../../../WWW/Library/Implementation/HTChunk.c", "HTChunkCreate2 data");
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x8121fce - 0x812200b
// Line range:    80 - 84
void HTChunkClear(int32_t * ch) {
    int32_t v1 = (int32_t)ch;
    int32_t * v2 = (int32_t *)(v1 + 12); // 0x8121fd7
    int32_t v3 = *v2; // 0x8121fd7
    if (v3 != 0) {
        // 0x8121fde
        free((int32_t *)v3);
        *v2 = 0;
    }
    // 0x8121ff6
    *ch = 0;
    *(int32_t *)(v1 + 8) = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x812200b - 0x8122062
// Line range:    90 - 99
void HTChunkFree(int32_t * ch) {
    int32_t v1 = (int32_t)ch;
    int32_t v2 = *(int32_t *)(v1 + 20); // 0x8122014
    int32_t * v3 = (int32_t *)(v1 + 12); // 0x812201d
    int32_t v4 = *v3; // 0x812201d
    if (v4 != 0) {
        // 0x8122024
        free((int32_t *)v4);
        *v3 = 0;
    }
    if (v1 != 0) {
        // 0x8122042
        free((int32_t *)v1);
    }
    while (v2 != 0) {
        // 0x8122011
        v1 = v2;
        v2 = *(int32_t *)(v1 + 20);
        v3 = (int32_t *)(v1 + 12);
        v4 = *v3;
        if (v4 != 0) {
            // 0x8122024
            free((int32_t *)v4);
            *v3 = 0;
        }
        if (v1 != 0) {
            // 0x8122042
            free((int32_t *)v1);
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x8122062 - 0x812210b
// Line range:    105 - 123
char HTChunkRealloc(int32_t * ch, int32_t growby) {
    int32_t v1 = (int32_t)ch;
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x812206b
    int32_t nmemb = *v2 + growby; // 0x8122070
    *v2 = nmemb;
    int32_t * v3 = (int32_t *)(v1 + 12); // 0x812207c
    int32_t v4 = *v3; // 0x812207c
    int32_t * mem; // 0x8122062
    if (v4 == 0) {
        // 0x81220a2
        mem = calloc(nmemb, 1);
    } else {
        // 0x8122083
        mem = realloc(&((struct _IO_FILE *)v4)->e0, nmemb);
    }
    // 0x81220bb
    if (mem != NULL) {
        // 0x81220c7
        *v3 = (int32_t)mem;
        // 0x8122105
        return 1;
    }
    // 0x81220d2
    if (*(int32_t *)(v1 + 16) == 0) {
        // 0x81220ed
        outofmem("../../../WWW/Library/Implementation/HTChunk.c", "HTChunkRealloc");
        // UNREACHABLE
    }
    // 0x81220dc
    HTChunkClear(ch);
    // 0x8122105
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x812210b - 0x812215e
// Line range:    129 - 135
void HTChunkPutc(int32_t * ch, char c) {
    int32_t v1 = (int32_t)ch;
    int32_t v2 = *ch; // 0x812211a
    if (v2 < *(int32_t *)(v1 + 8)) {
        // 0x812213f
        *(char *)(*(int32_t *)(v1 + 12) + v2) = c;
        *ch = v2 + 1;
        // 0x812215c
        return;
    }
    // 0x8122126
    if (HTChunkRealloc(ch, *(int32_t *)(v1 + 4)) == 0) {
        // 0x812215c
        return;
    }
    int32_t v3 = *ch; // 0x8122148
    *(char *)(*(int32_t *)(v1 + 12) + v3) = c;
    *ch = v3 + 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x8122291 - 0x8122328
// Line range:    172 - 183
void HTChunkPutb(int32_t * ch, char * b, int32_t l) {
    if (l < 1) {
        // 0x8122326
        return;
    }
    int32_t v1 = (int32_t)ch;
    int32_t v2 = *ch; // 0x81222a4
    int32_t v3 = v2; // 0x81222b3
    if (v2 + l > *(int32_t *)(v1 + 8)) {
        uint32_t v4 = *(int32_t *)(v1 + 4); // 0x81222b8
        if (HTChunkRealloc(ch, v4 + l - (int32_t)((0x100000000 * (int64_t)(l < 0) | (int64_t)l) % (int64_t)v4)) == 0) {
            // 0x8122326
            return;
        }
        // 0x81222b5
        v3 = *ch;
    }
    // 0x81222f4
    memcpy((int32_t *)(*(int32_t *)(v1 + 12) + v3), (int32_t *)b, l);
    *ch = *ch + l;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x812269e - 0x81226b9
// Line range:    284 - 286
void HTChunkTerminate(int32_t * ch) {
    // 0x812269e
    HTChunkPutc(ch, 0);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTChunk.c
// Address range: 0x81226b9 - 0x8122724
// Line range:    292 - 304
void HTChunkPuts(int32_t * ch, char * s) {
    if (s == NULL) {
        // 0x8122722
        return;
    }
    // 0x81226c5
    char * v1; // bp-8, 0x81226b9
    *(int32_t *)&v1 = (int32_t)s;
    char v2 = *s; // 0x812271b
    if (v2 == 0) {
        // 0x8122722
        return;
    }
    int32_t v3 = (int32_t)ch;
    int32_t v4 = *ch; // 0x812270c
    char v5 = v2; // 0x81226da
    int32_t v6 = v4; // 0x81226da
    if (v4 >= *(int32_t *)(v3 + 8)) {
        // 0x81226dc
        if (HTChunkRealloc(ch, *(int32_t *)(v3 + 4)) == 0) {
            // break -> 0x8122722
            break;
        }
        // 0x81226dc
        v5 = *s;
        v6 = *ch;
    }
    // 0x81226f5
    *(char *)(*(int32_t *)(v3 + 12) + v6) = v5;
    v4 = v6 + 1;
    *ch = v4;
    char * v7 = (char *)((int32_t)v1 + 1); // 0x8122714
    v1 = v7;
    char v8 = *v7; // 0x812271b
    char * v9 = v7; // 0x8122720
    while (v8 != 0) {
        // 0x81226cd
        v5 = v8;
        v6 = v4;
        if (v4 >= *(int32_t *)(v3 + 8)) {
            // 0x81226dc
            if (HTChunkRealloc(ch, *(int32_t *)(v3 + 4)) == 0) {
                // break -> 0x8122722
                break;
            }
            // 0x81226dc
            v5 = *v9;
            v6 = *ch;
        }
        // 0x81226f5
        *(char *)(*(int32_t *)(v3 + 12) + v6) = v5;
        v4 = v6 + 1;
        *ch = v4;
        v7 = (char *)((int32_t)v1 + 1);
        v1 = v7;
        v8 = *v7;
        v9 = v7;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAtom.c
// Address range: 0x81250b8 - 0x8125224
// Line range:    42 - 91
int32_t * HTAtom_for(char * string) {
    int32_t v1 = 0; // 0x81250c7
    char * str; // 0x81250b8
    if (initialised != 0) {
        // 0x81250b8
        str = string;
    } else {
        *(int32_t *)(4 * v1 + (int32_t)&hash_table) = 0;
        v1++;
        while (v1 != 101) {
            // 0x81250d2
            *(int32_t *)(4 * v1 + (int32_t)&hash_table) = 0;
            v1++;
        }
        // 0x81250ea
        initialised = 1;
        str = string;
    }
    int32_t len = strlen(str); // 0x81250f7
    int32_t v2 = 4 * (len * (int32_t)*str % 101) + (int32_t)&hash_table; // 0x8125145
    int32_t v3 = v2; // 0x812514f
    v3 = *(int32_t *)v3;
    while (v3 != 0) {
        int32_t v4 = v3; // 0x8125168
        if (strcasecomp((char *)*(int32_t *)(v3 + 4), str) == 0) {
            // 0x812521f
            return (int32_t *)v4;
        }
        v3 = *(int32_t *)v3;
    }
    int32_t * mem = malloc(8); // 0x812518a
    if (mem == NULL) {
        // 0x8125198
        outofmem("../../../WWW/Library/Implementation/HTAtom.c", "HTAtom_for");
        // UNREACHABLE
    }
    int32_t v5 = (int32_t)mem; // 0x812518a
    int32_t * mem2 = malloc(strlen(string) + 1); // 0x81251bd
    *(int32_t *)(v5 + 4) = (int32_t)mem2;
    if (mem2 == NULL) {
        // 0x81251d4
        outofmem("../../../WWW/Library/Implementation/HTAtom.c", "HTAtom_for");
        // UNREACHABLE
    }
    // 0x81251e8
    strcpy((char *)mem2, string);
    int32_t * v6 = (int32_t *)v2; // 0x8125200
    *mem = *v6;
    *v6 = v5;
    // 0x812521f
    return (int32_t *)v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81253ac - 0x8125421
// Line range:    50 - 58
int16_t HASH_FUNCTION(char * cp_address) {
    char v1 = *cp_address; // 0x8125410
    int32_t result = 0; // 0x8125415
    if (v1 == 0) {
        // 0x8125417
        return 0;
    }
    char * v2 = cp_address; // 0x8125415
    result = (3 * result + (int32_t)v1) % 1001;
    v2 = (char *)((int32_t)v2 + 1);
    char v3 = *v2; // 0x8125410
    while (v3 != 0) {
        // 0x81253c1
        result = (3 * result + (int32_t)v3) % 1001;
        v2 = (char *)((int32_t)v2 + 1);
        v3 = *v2;
    }
    // 0x8125417
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8125421 - 0x812548c
// Line range:    82 - 93
int32_t * HTParentAnchor0_new(char * address, int16_t hash) {
    int32_t * mem = calloc(1, 36); // 0x812543d
    if (mem == NULL) {
        // 0x812544b
        outofmem("../../../WWW/Library/Implementation/HTAnchor.c", "HTParentAnchor0_new");
        // UNREACHABLE
    }
    int32_t v1 = (int32_t)mem; // 0x812543d
    *mem = v1;
    HTSACopy((char **)(v1 + 4), address);
    *(int16_t *)(v1 + 32) = hash;
    return mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x812548c - 0x8125515
// Line range:    96 - 113
int32_t * HTParentAnchor_new(int32_t * parent) {
    int32_t * mem = calloc(1, 184); // 0x81254a1
    if (mem == NULL) {
        // 0x81254af
        outofmem("../../../WWW/Library/Implementation/HTAnchor.c", "HTParentAnchor_new");
        // UNREACHABLE
    }
    int32_t v1 = (int32_t)parent;
    int32_t v2 = (int32_t)mem; // 0x81254a1
    *mem = v1;
    *(int32_t *)(v1 + 8) = v2;
    *(int32_t *)(v2 + 16) = *(int32_t *)(v1 + 4);
    *(char *)(v2 + 84) = 0;
    *(char *)(v2 + 85) = 0;
    *(char *)(v2 + 86) = 0;
    *(char *)(v2 + 108) = 0;
    *(char *)(v2 + 109) = 0;
    *(int32_t *)(v2 + 152) = 0;
    return mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8125515 - 0x8125559
// Line range:    116 - 124
int32_t * HTChildAnchor_new(int32_t * parent) {
    int32_t * mem = calloc(1, 32); // 0x812552a
    if (mem != NULL) {
        // 0x812554c
        *mem = (int32_t)parent;
        return mem;
    }
    // 0x8125538
    outofmem("../../../WWW/Library/Implementation/HTAnchor.c", "HTChildAnchor_new");
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81255a1 - 0x812560b
// Line range:    157 - 168
char HTSEquivalent(char * s, char * t) {
    if (s == NULL || t == NULL) {
        // 0x8125605
        return s == t;
    }
    char v1 = *s; // 0x81255d6
    char v2 = v1; // 0x81255db
    char * v3 = t; // 0x81255db
    char * v4 = s; // 0x81255db
    char v5 = 0; // 0x81255db
    char * v6 = t; // 0x81255db
    if (v1 != 0) {
        char v7 = *v3; // 0x81255e0
        v5 = v2;
        v6 = v3;
        while (v7 != 0) {
            // 0x81255b5
            if (v2 != v7) {
                // 0x8125605
                return false;
            }
            // 0x81255cb
            v4 = (char *)((int32_t)v4 + 1);
            v3 = (char *)((int32_t)v3 + 1);
            v2 = *v4;
            v5 = 0;
            v6 = v3;
            if (v2 == 0) {
                // break -> 0x81255e7
                break;
            }
            v7 = *v3;
            v5 = v2;
            v6 = v3;
        }
    }
    // 0x8125605
    return v5 == *v6;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x812560b - 0x81256f8
// Line range:    181 - 195
char HTBEquivalent(int32_t * s, int32_t * t) {
    if (s == NULL || t == NULL) {
        // 0x81256f2
        return (bool)(s == t);
    }
    uint32_t v1 = *(int32_t *)((int32_t)s + 4); // 0x812562e
    if (v1 != *(int32_t *)((int32_t)t + 4)) {
        // 0x81256f2
        return s == t;
    }
    // 0x81256da
    if (v1 <= 0) {
        // 0x81256f2
        return 1;
    }
    int32_t v2 = 0; // 0x81256d6
    char result = 0; // 0x81256ce
    while (*(char *)(v2 + *s) == *(char *)(v2 + *t)) {
        // 0x81256da
        v2++;
        result = 1;
        if (v2 >= v1) {
            // break -> 0x81256f2
            break;
        }
        result = 0;
    }
    // 0x81256f2
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8125724 - 0x8125894
// Line range:    223 - 261
int32_t * HTAnchor_findNamedChild(int32_t * parent, char * tag) {
    if (parent != NULL && tag != NULL) {
        // 0x812573e
        if (*tag != 0) {
            int32_t * v1 = (int32_t *)((int32_t)parent + 12); // 0x812574f
            int32_t v2 = *v1; // 0x812574f
            if (v2 == 0) {
                // 0x81257be
                *v1 = (int32_t)HTBTree_new((int32_t (*)(char *, char *))0x81256f8);
            } else {
                // 0x8125756
                int32_t v3; // bp-40, 0x8125724
                char * v4 = HTBTree_search((int32_t *)v2, (char *)&v3); // 0x812576c
                if (v4 != NULL) {
                    // 0x812577a
                    if (WWW_TraceFlag != 0) {
                        // 0x8125785
                        fprintf(TraceFP(), "Child anchor %p of parent %p with name `%s' already exists.\n", v4, parent, tag);
                    }
                    // 0x812588f
                    return (int32_t *)(int32_t)v4;
                }
            }
            int32_t * v5 = HTChildAnchor_new(parent); // 0x81257d8
            if (WWW_TraceFlag != 0) {
                // 0x81257eb
                fprintf(TraceFP(), "HTAnchor: New Anchor %p named `%s' is child of %p\n", v5, tag, (int32_t *)*v5);
            }
            int32_t v6 = (int32_t)v5; // 0x8125834
            HTSACopy((char **)(v6 + 4), tag);
            HTBTree_add((int32_t *)*v1, (char *)v5);
            // 0x812588f
            return (int32_t *)v6;
        }
    }
    // 0x8125866
    if (WWW_TraceFlag != 0) {
        // 0x8125871
        fprintf(TraceFP(), "HTAnchor_findNamedChild called with NULL parent.\n");
    }
    // 0x812588f
    return (int32_t *)0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8125c12 - 0x8125d0e
// Line range:    388 - 417
int32_t * HTAnchor_findAddress(int32_t * newdoc2) {
    char * v1 = HTParseAnchor((char *)*newdoc2); // 0x8125c20
    if (WWW_TraceFlag != 0) {
        // 0x8125c33
        fprintf(TraceFP(), "Entered HTAnchor_findAddress\n");
    }
    // 0x8125c4a
    if (*v1 == 0) {
        // 0x8125d09
        return HTAnchor_parent(HTAnchor_findAddress_in_adult_table(newdoc2));
    }
    char * v2 = HTParse((char *)*newdoc2, (char *)&g80, 29); // 0x8125c70
    int32_t v3 = (int32_t)v2; // bp-36, 0x8125c75
    int32_t * v4 = HTAnchor_findAddress_in_adult_table(&v3); // 0x8125cad
    HTAnchor_findNamedChild(v4, v1);
    if (v3 != 0) {
        // 0x8125cd1
        free((int32_t *)v3);
        v3 = 0;
    }
    // 0x8125d09
    return HTAnchor_parent(v4);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8125d0e - 0x8125fc7
// Line range:    422 - 487
int32_t * HTAnchor_findAddress_in_adult_table(int32_t * newdoc2) {
    int32_t v1 = (int32_t)newdoc2;
    int32_t * v2 = (int32_t *)(v1 + 4); // 0x8125d19
    char v3 = 1; // 0x8125d1e
    if (*v2 == 0) {
        // 0x8125d20
        v3 = 1;
        if (*(int32_t *)(v1 + 8) == 0) {
            // 0x8125d2a
            v3 = 1;
            if (*(int32_t *)(v1 + 12) == 0) {
                // 0x8125d34
                v3 = 1;
                if (*(char *)(v1 + 16) == 0) {
                    // 0x8125d3f
                    v3 = *(char *)(v1 + 17) != 0;
                }
            }
        }
    }
    uint16_t v4 = HASH_FUNCTION((char *)(0x10000 * *newdoc2 >> 16)); // 0x8125d69
    int16_t v5 = 8 * v4 + (int16_t)&adult_table; // 0x8125d79
    int32_t v6; // 0x8125d0e
    int32_t v7; // 0x8125e50
    if (v5 != 0) {
        uint32_t v8 = *(int32_t *)((int32_t)v5 + 4); // 0x8125e41
        while (v8 % 0x10000 != 0) {
            // 0x8125e5e
            v7 = *(int32_t *)(0x10000 * v8 / 0x10000);
            int32_t v9 = *newdoc2;
            v6 = v9;
            if (v7 == 0) {
                goto lab_0x8125e6e;
            }
            int32_t v10 = *(int32_t *)(v7 + 4); // 0x8125d94
            if (HTSEquivalent((char *)(0x10000 * v10 >> 16), (char *)v9) != 0) {
                int32_t * v11 = (int32_t *)(v7 + 8); // 0x8125dae
                int32_t v12 = *v11; // 0x8125dae
                if (v3 == 0 == v12 == 0) {
                    goto lab_0x8125df9_2;
                }
                if (v12 != 0) {
                    int32_t v13 = *(int32_t *)(v12 + 20); // 0x8125dd1
                    if (HTBEquivalent((int32_t *)(0x10000 * v13 >> 16), (int32_t *)*v2) != 0) {
                        // 0x8125de4
                        if (*(char *)(*v11 + 85) == *(char *)(v1 + 16)) {
                            goto lab_0x8125df9_2;
                        }
                    }
                }
            }
            int16_t v14 = v8; // 0x8125e44
            if (v14 == 0) {
                // break -> 0x8125e5e
                break;
            }
            v8 = *(int32_t *)((int32_t)v14 + 4);
        }
    }
    // 0x8125e5e
    v6 = *newdoc2;
  lab_0x8125e6e:;
    int32_t * result2 = HTParentAnchor0_new((char *)(0x10000 * v6 >> 16), v4); // 0x8125e7e
    if (WWW_TraceFlag != 0) {
        int32_t v15 = *newdoc2; // 0x8125e94
        fprintf((struct _IO_FILE *)(0x10000 * (int32_t)TraceFP() >> 16), "New anchor %p has hash %d and address `%s'\n", result2, (int32_t)v4, (char *)v15);
    }
    int32_t v16 = (int32_t)result2;
    int32_t * result; // 0x8125d0e
    if (v3 == 0) {
        // 0x8125f9b
        HTList_linkObject((int32_t *)(int32_t)v5, (char *)result2, (int32_t *)(v16 + 24));
        result = result2;
        // 0x8125fbd
        return result;
    }
    int32_t * v17 = HTParentAnchor_new((int32_t *)(0x10000 * v16 >> 16)); // 0x8125ed2
    int32_t v18 = *v2; // 0x8125edd
    if (v18 != 0) {
        int32_t v19 = *(int32_t *)(v18 + 4); // 0x8125ef4
        int32_t v20 = *(int32_t *)v18; // 0x8125f13
        HTSABCopy((int32_t **)(0x10000 * (int32_t)v17 + 0x140000 >> 16), (char *)v20, v19);
    }
    int32_t v21 = *(int32_t *)(v1 + 8); // 0x8125f40
    int32_t v22 = (int32_t)v17;
    if (v21 != 0) {
        // 0x8125f47
        HTSACopy((char **)(0x10000 * v22 + 0x180000 >> 16), (char *)v21);
    }
    int32_t v23 = *(int32_t *)(v1 + 12); // 0x8125f62
    if (v23 != 0) {
        // 0x8125f69
        HTSACopy((char **)(0x10000 * v22 + 0x1c0000 >> 16), (char *)v23);
    }
    // 0x8125f81
    *(char *)(v22 + 85) = *(char *)(v1 + 16);
    *(char *)(v22 + 86) = *(char *)(v1 + 17);
    // 0x8125f9b
    HTList_linkObject((int32_t *)(int32_t)v5, (char *)result2, (int32_t *)(v16 + 24));
    // 0x8125fbd
    return result2;
  lab_0x8125df9_2:;
    int32_t * v24 = (int32_t *)v7; // 0x8125e61
    result = v24;
    if (WWW_TraceFlag == 0) {
        return result;
    } else {
        int32_t v25 = *newdoc2; // 0x8125e07
        fprintf((struct _IO_FILE *)(0x10000 * (int32_t)TraceFP() >> 16), "Anchor %p with address `%s' already exists.\n", v24, (char *)v25);
        result = v24;
        return result;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8125fc7 - 0x8125ffd
// Line range:    496 - 506
int32_t * HTAnchor_findSimpleAddress(char * url) {
    char * v1 = url; // bp-24, 0x8125fd0
    return HTAnchor_findAddress((int32_t *)&v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81260c7 - 0x8126158
// Line range:    550 - 589
void deleteLinks(int32_t * me) {
    int32_t v1 = (int32_t)me;
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x81260d0
    int32_t v3 = *v2; // 0x81260d0
    if (v3 == 0) {
        // 0x8126156
        return;
    }
    int32_t v4 = *(int32_t *)v3; // 0x81260dd
    *v2 = 0;
    int32_t v5 = *me; // 0x81260ef
    if (v5 == v4) {
        // 0x812614c
        *(int32_t *)(v1 + 12) = 0;
        // 0x8126156
        return;
    }
    int32_t v6 = v5; // 0x81260fe
    if (*(int32_t *)(v4 + 20) != 0) {
        // 0x8126100
        HTList_unlinkObject((int32_t *)(v4 + 16), (char *)me);
        v6 = *me;
    }
    // 0x8126115
    if (v6 == v4 || *(char *)(v4 + 34) != 0) {
        // 0x812614c
        *(int32_t *)(v1 + 12) = 0;
        // 0x8126156
        return;
    }
    int32_t v7 = *(int32_t *)(v4 + 8); // 0x812612d
    if (v7 == 0) {
        // 0x8126141
        HTAnchor_delete((int32_t *)v4);
        // 0x812614c
        *(int32_t *)(v1 + 12) = 0;
        // 0x8126156
        return;
    }
    // 0x8126134
    if (*(int32_t *)(v7 + 12) != 0) {
        // 0x812614c
        *(int32_t *)(v1 + 12) = 0;
        // 0x8126156
        return;
    }
    // 0x8126141
    HTAnchor_delete((int32_t *)v4);
    // 0x812614c
    *(int32_t *)(v1 + 12) = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126158 - 0x812634e
// Line range:    594 - 689
char HTAnchor_delete(int32_t * me) {
    // 0x8126158
    if (me == NULL) {
        // 0x8126348
        return 0;
    }
    int32_t v1 = (int32_t)me;
    char * v2 = (char *)(v1 + 34); // 0x8126170
    if (*v2 != 0) {
        // 0x8126348
        return 0;
    }
    int32_t * v3 = (int32_t *)(v1 + 8); // 0x812617b
    int32_t v4 = *v3; // 0x812617b
    if (v4 != 0) {
        // 0x8126182
        if (*(int32_t *)(v4 + 12) != 0) {
            // 0x8126348
            return 0;
        }
    }
    // 0x8126198
    *v2 = 1;
    int32_t * v5 = (int32_t *)(v1 + 12); // 0x81261a2
    int32_t v6 = *v5; // 0x81261a2
    if (v6 != 0) {
        int32_t * v7 = HTBTree_next((int32_t *)(0x10000 * v6 >> 16), NULL); // 0x81261ba
        if (v7 != NULL) {
            int32_t v8 = *v7; // 0x81261c7
            if (*(int32_t *)(v8 + 8) != 0) {
                // 0x81261d6
                deleteLinks((int32_t *)(0x10000 * v8 >> 16));
            }
            int32_t * v9 = HTBTree_next((int32_t *)(0x10000 * *v5 >> 16), v7); // 0x81261f1
            int32_t * v10 = v9; // 0x81261fd
            while (v9 != NULL) {
                // 0x81261c4
                v8 = *v10;
                if (*(int32_t *)(v8 + 8) != 0) {
                    // 0x81261d6
                    deleteLinks((int32_t *)(0x10000 * v8 >> 16));
                }
                // 0x81261e1
                v9 = HTBTree_next((int32_t *)(0x10000 * *v5 >> 16), v10);
                v10 = v9;
            }
        }
    }
    // 0x81261ff
    *v2 = 0;
    if (*(int32_t *)(v1 + 20) != 0) {
        // 0x8126348
        return 0;
    }
    int32_t v11 = *v5; // 0x812621c
    if (v11 != 0) {
        int32_t * v12 = HTBTree_next((int32_t *)(0x10000 * v11 >> 16), NULL); // 0x8126238
        if (v12 != NULL) {
            int32_t v13 = *v12; // 0x8126245
            int32_t * v14 = (int32_t *)(v13 + 4); // 0x812624d
            int32_t v15 = *v14; // 0x812624d
            if (v15 != 0) {
                // 0x8126254
                free((int32_t *)(0x10000 * v15 >> 16));
                *v14 = 0;
            }
            if (v13 != 0) {
                // 0x8126272
                free((int32_t *)(0x10000 * v13 >> 16));
            }
            int32_t * v16 = HTBTree_next((int32_t *)(0x10000 * *v5 >> 16), v12); // 0x8126294
            int32_t * v17 = v16; // 0x81262a0
            while (v16 != NULL) {
                // 0x8126242
                v13 = *v17;
                v14 = (int32_t *)(v13 + 4);
                v15 = *v14;
                if (v15 != 0) {
                    // 0x8126254
                    free((int32_t *)(0x10000 * v15 >> 16));
                    *v14 = 0;
                }
                if (v13 != 0) {
                    // 0x8126272
                    free((int32_t *)(0x10000 * v13 >> 16));
                }
                // 0x8126284
                v16 = HTBTree_next((int32_t *)(0x10000 * *v5 >> 16), v17);
                v17 = v16;
            }
        }
        // 0x81262a2
        HTBTree_free((int32_t *)(0x10000 * *v5 >> 16));
    }
    int32_t v18 = *v3; // 0x81262b3
    if (v18 != 0) {
        // 0x81262ba
        HTParentAnchor_free((int32_t *)(0x10000 * v18 >> 16));
        int32_t v19 = *v3; // 0x81262cb
        if (v19 != 0) {
            // 0x81262d2
            free((int32_t *)(0x10000 * v19 >> 16));
            *v3 = 0;
        }
    }
    int16_t v20 = *(int16_t *)(v1 + 32); // 0x81262ed
    HTList_unlinkObject((int32_t *)(int32_t)(8 * v20 + (int16_t)&adult_table), (char *)me);
    int32_t * v21 = (int32_t *)(v1 + 4); // 0x812630d
    int32_t v22 = *v21; // 0x812630d
    if (v22 != 0) {
        // 0x8126314
        free((int32_t *)(0x10000 * v22 >> 16));
        *v21 = 0;
    }
    // 0x8126332
    free((int32_t *)(0x10000 * v1 >> 16));
    // 0x8126348
    return 1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x812634e - 0x81263ac
// Line range:    697 - 726
void HTAnchor_delete_links(int32_t * me) {
    if (me == NULL) {
        // 0x81263aa
        return;
    }
    int32_t v1 = (int32_t)me;
    if (*(int32_t *)(v1 + 12) == 0) {
        // 0x81263aa
        return;
    }
    // 0x8126364
    *(char *)(*me + 34) = 1;
    if (*(int32_t *)(v1 + 8) == 0) {
        // 0x81263a1
        *(char *)(*me + 34) = 0;
        // 0x81263aa
        return;
    }
    int32_t * v2 = (int32_t *)(v1 + 4); // 0x8126393
    char * v3 = HTList_unlinkLastObject(v2); // 0x8126393
    if (v3 == NULL) {
        // 0x81263a1
        *(char *)(*me + 34) = 0;
        // 0x81263aa
        return;
    }
    deleteLinks((int32_t *)v3);
    char * v4 = HTList_unlinkLastObject(v2); // 0x8126393
    while (v4 != NULL) {
        // 0x8126382
        deleteLinks((int32_t *)v4);
        v4 = HTList_unlinkLastObject(v2);
    }
    // 0x81263a1
    *(char *)(*me + 34) = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81263ac - 0x81268aa
// Line range:    729 - 802
void HTParentAnchor_free(int32_t * me) {
    int32_t v1 = (int32_t)me;
    int32_t * v2 = (int32_t *)(v1 + 72); // 0x81263b5
    int32_t v3 = *v2; // 0x81263b5
    if (v3 != 0) {
        // 0x81263bc
        HTList_delete((int32_t *)v3);
        *v2 = 0;
    }
    int32_t * v4 = (int32_t *)(v1 + 36); // 0x81263d7
    int32_t v5 = *v4; // 0x81263d7
    if (v5 != 0) {
        // 0x81263de
        free((int32_t *)v5);
        *v4 = 0;
    }
    int32_t * v6 = (int32_t *)(v1 + 44); // 0x81263f9
    int32_t v7 = *v6; // 0x81263f9
    if (v7 != 0) {
        // 0x8126400
        free((int32_t *)v7);
        *v6 = 0;
    }
    int32_t * v8 = (int32_t *)(v1 + 48); // 0x812641b
    int32_t v9 = *v8; // 0x812641b
    if (v9 != 0) {
        // 0x8126422
        free((int32_t *)v9);
        *v8 = 0;
    }
    int32_t * v10 = (int32_t *)(v1 + 52); // 0x812643d
    int32_t v11 = *v10; // 0x812643d
    if (v11 != 0) {
        // 0x8126444
        free((int32_t *)v11);
        *v10 = 0;
    }
    int32_t * v12 = (int32_t *)(v1 + 80); // 0x812645f
    int32_t v13 = *v12; // 0x812645f
    if (v13 != 0) {
        // 0x8126466
        free((int32_t *)v13);
        *v12 = 0;
    }
    // 0x812647e
    HTSABFree((int32_t **)(v1 + 20));
    int32_t * v14 = (int32_t *)(v1 + 24); // 0x812648f
    int32_t v15 = *v14; // 0x812648f
    if (v15 != 0) {
        // 0x8126496
        free((int32_t *)v15);
        *v14 = 0;
    }
    int32_t * v16 = (int32_t *)(v1 + 28); // 0x81264b1
    int32_t v17 = *v16; // 0x81264b1
    if (v17 != 0) {
        // 0x81264b8
        free((int32_t *)v17);
        *v16 = 0;
    }
    int32_t * v18 = (int32_t *)(v1 + 56); // 0x81264d3
    int32_t v19 = *v18; // 0x81264d3
    if (v19 != 0) {
        // 0x81264da
        free((int32_t *)v19);
        *v18 = 0;
    }
    int32_t * v20 = (int32_t *)(v1 + 60); // 0x81264f5
    int32_t v21 = *v20; // 0x81264f5
    if (v21 != 0) {
        // 0x81264fc
        free((int32_t *)v21);
        *v20 = 0;
    }
    int32_t * v22 = (int32_t *)(v1 + 64); // 0x8126517
    int32_t v23 = *v22; // 0x8126517
    if (v23 != 0) {
        // 0x812651e
        free((int32_t *)v23);
        *v22 = 0;
    }
    // 0x8126536
    HTAnchor_clearSourceCache(me);
    int32_t * file_path = (int32_t *)(v1 + 96); // 0x8126544
    int32_t v24 = *file_path; // 0x8126544
    if (v24 != 0) {
        struct _IO_FILE * file = fopen64((char *)v24, "r"); // 0x812655c
        if (file != NULL) {
            // 0x812656a
            fclose(file);
            remove((char *)*file_path);
        }
        int32_t v25 = *file_path; // 0x8126586
        if (v25 != 0) {
            // 0x812658d
            free((int32_t *)v25);
            *file_path = 0;
        }
    }
    int32_t * v26 = (int32_t *)(v1 + 100); // 0x81265a8
    int32_t v27 = *v26; // 0x81265a8
    if (v27 != 0) {
        // 0x81265af
        free((int32_t *)v27);
        *v26 = 0;
    }
    int32_t * v28 = (int32_t *)(v1 + 104); // 0x81265ca
    int32_t v29 = *v28; // 0x81265ca
    if (v29 != 0) {
        // 0x81265d1
        free((int32_t *)v29);
        *v28 = 0;
    }
    int32_t * v30 = (int32_t *)(v1 + 112); // 0x81265ec
    int32_t v31 = *v30; // 0x81265ec
    if (v31 != 0) {
        // 0x81265f3
        free((int32_t *)v31);
        *v30 = 0;
    }
    int32_t * v32 = (int32_t *)(v1 + 116); // 0x812660e
    int32_t v33 = *v32; // 0x812660e
    if (v33 != 0) {
        // 0x8126615
        free((int32_t *)v33);
        *v32 = 0;
    }
    int32_t * v34 = (int32_t *)(v1 + 120); // 0x8126630
    int32_t v35 = *v34; // 0x8126630
    if (v35 != 0) {
        // 0x8126637
        free((int32_t *)v35);
        *v34 = 0;
    }
    int32_t * v36 = (int32_t *)(v1 + 124); // 0x8126652
    int32_t v37 = *v36; // 0x8126652
    if (v37 != 0) {
        // 0x8126659
        free((int32_t *)v37);
        *v36 = 0;
    }
    int32_t * v38 = (int32_t *)(v1 + 128); // 0x8126674
    int32_t v39 = *v38; // 0x8126674
    if (v39 != 0) {
        // 0x812667e
        free((int32_t *)v39);
        *v38 = 0;
    }
    int32_t * v40 = (int32_t *)(v1 + 132); // 0x812669f
    int32_t v41 = *v40; // 0x812669f
    if (v41 != 0) {
        // 0x81266a9
        free((int32_t *)v41);
        *v40 = 0;
    }
    int32_t * v42 = (int32_t *)(v1 + 136); // 0x81266ca
    int32_t v43 = *v42; // 0x81266ca
    if (v43 != 0) {
        // 0x81266d4
        free((int32_t *)v43);
        *v42 = 0;
    }
    int32_t * v44 = (int32_t *)(v1 + 140); // 0x81266f5
    int32_t v45 = *v44; // 0x81266f5
    if (v45 != 0) {
        // 0x81266ff
        free((int32_t *)v45);
        *v44 = 0;
    }
    int32_t * v46 = (int32_t *)(v1 + 144); // 0x8126720
    int32_t v47 = *v46; // 0x8126720
    if (v47 != 0) {
        // 0x812672a
        free((int32_t *)v47);
        *v46 = 0;
    }
    int32_t * v48 = (int32_t *)(v1 + 148); // 0x812674b
    int32_t v49 = *v48; // 0x812674b
    if (v49 != 0) {
        // 0x8126755
        free((int32_t *)v49);
        *v48 = 0;
    }
    int32_t * v50 = (int32_t *)(v1 + 156); // 0x8126776
    int32_t v51 = *v50; // 0x8126776
    if (v51 != 0) {
        // 0x8126780
        free((int32_t *)v51);
        *v50 = 0;
    }
    int32_t * v52 = (int32_t *)(v1 + 160); // 0x81267a1
    int32_t v53 = *v52; // 0x81267a1
    if (v53 != 0) {
        // 0x81267ab
        free((int32_t *)v53);
        *v52 = 0;
    }
    int32_t * v54 = (int32_t *)(v1 + 164); // 0x81267cc
    int32_t v55 = *v54; // 0x81267cc
    if (v55 != 0) {
        // 0x81267d6
        free((int32_t *)v55);
        *v54 = 0;
    }
    int32_t * v56 = (int32_t *)(v1 + 168); // 0x81267f7
    int32_t v57 = *v56; // 0x81267f7
    if (v57 != 0) {
        // 0x8126801
        free((int32_t *)v57);
        *v56 = 0;
    }
    int32_t * v58 = (int32_t *)(v1 + 172); // 0x8126822
    int32_t v59 = *v58; // 0x8126822
    if (v59 != 0) {
        // 0x812682c
        free((int32_t *)v59);
        *v58 = 0;
    }
    int32_t * v60 = (int32_t *)(v1 + 68); // 0x812684d
    int32_t v61 = *v60; // 0x812684d
    if (v61 != 0) {
        // 0x8126854
        free((int32_t *)v61);
        *v60 = 0;
    }
    int32_t * v62 = (int32_t *)(v1 + 176); // 0x812686f
    int32_t v63 = *v62; // 0x812686f
    if (v63 != 0) {
        // 0x8126879
        free((int32_t *)v63);
        *v62 = 0;
    }
    // 0x8126897
    ImageMapList_free((int32_t *)*(int32_t *)(v1 + 180));
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81268aa - 0x812696b
// Line range:    806 - 822
void HTAnchor_clearSourceCache(int32_t * me) {
    int32_t v1 = (int32_t)me;
    int32_t * v2 = (int32_t *)(v1 + 88); // 0x81268b4
    int32_t v3 = *v2; // 0x81268b4
    if (v3 != 0) {
        int32_t v4 = v3; // 0x81268c4
        if (WWW_TraceFlag != 0) {
            // 0x81268c6
            fprintf(TraceFP(), "SourceCache: Removing file %s\n", (char *)v3);
            v4 = *v2;
        }
        // 0x81268e7
        LYRemoveTemp((char *)v4);
        int32_t v5 = *v2; // 0x81268f8
        if (v5 != 0) {
            // 0x81268ff
            free(&((struct _IO_FILE *)v5)->e0);
            *v2 = 0;
        }
    }
    int32_t * v6 = (int32_t *)(v1 + 92); // 0x812691a
    int32_t v7 = *v6; // 0x812691a
    if (v7 == 0) {
        // 0x8126965
        return;
    }
    int32_t v8 = v7; // 0x812692a
    if (WWW_TraceFlag != 0) {
        // 0x812692c
        fprintf(TraceFP(), "SourceCache: Removing memory chunk %p\n", (int32_t *)v7);
        v8 = *v6;
    }
    // 0x812694d
    HTChunkFree(&((struct _IO_FILE *)v8)->e0);
    *v6 = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x812696b - 0x81269ae
// Line range:    829 - 838
int32_t * HTAnchor_parent(int32_t * me) {
    // 0x812696b
    if (me == NULL) {
        // 0x81269a9
        return (int32_t *)0;
    }
    int32_t v1 = *me; // 0x8126983
    int32_t v2 = *(int32_t *)(v1 + 8); // 0x8126985
    int32_t v3 = v2; // 0x812698a
    if (v2 == 0) {
        // 0x8126999
        v3 = (int32_t)HTParentAnchor_new((int32_t *)v1);
    }
    // 0x81269a9
    return (int32_t *)v3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81269ae - 0x81269c2
// Line range:    842 - 845
void HTAnchor_setDocument(int32_t * me, int32_t * doc) {
    if (me != NULL) {
        // 0x81269b7
        *(int32_t *)((int32_t)me + 12) = (int32_t)doc;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81269c2 - 0x81269e5
// Line range:    848 - 850
int32_t * HTAnchor_document(int32_t * me) {
    int32_t * result = NULL; // 0x81269cc
    if (me != NULL) {
        // 0x81269ce
        result = (int32_t *)*(int32_t *)((int32_t)me + 12);
    }
    // 0x81269e0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81269e5 - 0x8126a64
// Line range:    853 - 867
char * HTAnchor_address(int32_t * me) {
    char * result = NULL; // bp-8, 0x81269eb
    if (me == NULL) {
        // 0x8126a5f
        return result;
    }
    int32_t v1 = (int32_t)me;
    int32_t v2 = *me; // 0x81269fb
    if (v2 == v1 || *(int32_t *)(v2 + 8) == v1) {
        // 0x8126a1d
        HTSACopy(&result, (char *)*(int32_t *)(v2 + 4));
        // 0x8126a5f
        return result;
    }
    int32_t v3 = *(int32_t *)(v1 + 4); // 0x8126a16
    if (v3 == 0) {
        // 0x8126a1d
        HTSACopy(&result, (char *)*(int32_t *)(v2 + 4));
        // 0x8126a5f
        return result;
    }
    int32_t v4 = *(int32_t *)(v2 + 4); // 0x8126a41
    HTSprintf0(&result, "%s#%s", (char *)v4, (char *)v3);
    // 0x8126a5f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126a78 - 0x8126a9b
// Line range:    877 - 879
int32_t * HTAnchor_format(int32_t * me) {
    int32_t * result = NULL; // 0x8126a82
    if (me != NULL) {
        // 0x8126a84
        result = (int32_t *)*(int32_t *)((int32_t)me + 32);
    }
    // 0x8126a96
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126ae8 - 0x8126b0a
// Line range:    899 - 901
char HTAnchor_isIndex(int32_t * me) {
    char result = 0; // 0x8126af2
    if (me != NULL) {
        // 0x8126af4
        result = *(char *)((int32_t)me + 40);
    }
    // 0x8126b04
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126b0a - 0x8126b3d
// Line range:    907 - 909
char HTAnchor_isISMAPScript(int32_t * me) {
    // 0x8126b0a
    if (me == NULL) {
        // 0x8126b37
        return 0;
    }
    int32_t v1 = *(int32_t *)(*me + 8); // 0x8126b1b
    char result = 0; // 0x8126b20
    if (v1 != 0) {
        // 0x8126b22
        result = *(char *)(v1 + 84);
    }
    // 0x8126b37
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126b3d - 0x8126b60
// Line range:    915 - 917
char * HTAnchor_style(int32_t * me) {
    char * result = NULL; // 0x8126b47
    if (me != NULL) {
        // 0x8126b49
        result = (char *)*(int32_t *)((int32_t)me + 68);
    }
    // 0x8126b5b
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126b83 - 0x8126ba6
// Line range:    931 - 933
char * HTAnchor_title(int32_t * me) {
    char * result = NULL; // 0x8126b8d
    if (me != NULL) {
        // 0x8126b8f
        result = (char *)*(int32_t *)((int32_t)me + 52);
    }
    // 0x8126ba1
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126d8e - 0x8126db1
// Line range:    994 - 996
char * HTAnchor_owner(int32_t * me) {
    char * result = NULL; // 0x8126d98
    if (me != NULL) {
        // 0x8126d9a
        result = (char *)*(int32_t *)((int32_t)me + 56);
    }
    // 0x8126dac
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126db1 - 0x8126dd4
// Line range:    1000 - 1004
void HTAnchor_setOwner(int32_t * me, char * owner) {
    if (me != NULL) {
        // 0x8126dbd
        HTSACopy((char **)((int32_t)me + 56), owner);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126dd4 - 0x8126df7
// Line range:    1009 - 1011
char * HTAnchor_RevTitle(int32_t * me) {
    char * result = NULL; // 0x8126dde
    if (me != NULL) {
        // 0x8126de0
        result = (char *)*(int32_t *)((int32_t)me + 60);
    }
    // 0x8126df2
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126e6f - 0x8126e92
// Line range:    1033 - 1035
char * HTAnchor_citehost(int32_t * me) {
    char * result = NULL; // 0x8126e79
    if (me != NULL) {
        // 0x8126e7b
        result = (char *)*(int32_t *)((int32_t)me + 64);
    }
    // 0x8126e8d
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126eb5 - 0x8126ed8
// Line range:    1051 - 1053
char * HTAnchor_SugFname(int32_t * me) {
    char * result = NULL; // 0x8126ebf
    if (me != NULL) {
        // 0x8126ec1
        result = (char *)*(int32_t *)((int32_t)me + 100);
    }
    // 0x8126ed3
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126efb - 0x8126f1e
// Line range:    1076 - 1078
char * HTAnchor_content_encoding(int32_t * me) {
    char * result = NULL; // 0x8126f05
    if (me != NULL) {
        // 0x8126f07
        result = (char *)*(int32_t *)((int32_t)me + 124);
    }
    // 0x8126f19
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126f1e - 0x8126f41
// Line range:    1083 - 1085
char * HTAnchor_content_type(int32_t * me) {
    char * result = NULL; // 0x8126f28
    if (me != NULL) {
        // 0x8126f2a
        result = (char *)*(int32_t *)((int32_t)me + 116);
    }
    // 0x8126f3c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126f41 - 0x8126f67
// Line range:    1090 - 1092
char * HTAnchor_last_modified(int32_t * me) {
    char * result = NULL; // 0x8126f4b
    if (me != NULL) {
        // 0x8126f4d
        result = (char *)*(int32_t *)((int32_t)me + 164);
    }
    // 0x8126f62
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126f67 - 0x8126f8d
// Line range:    1097 - 1099
char * HTAnchor_date(int32_t * me) {
    char * result = NULL; // 0x8126f71
    if (me != NULL) {
        // 0x8126f73
        result = (char *)*(int32_t *)((int32_t)me + 156);
    }
    // 0x8126f88
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126f8d - 0x8126fb3
// Line range:    1104 - 1106
char * HTAnchor_server(int32_t * me) {
    char * result = NULL; // 0x8126f97
    if (me != NULL) {
        // 0x8126f99
        result = (char *)*(int32_t *)((int32_t)me + 172);
    }
    // 0x8126fae
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126fb3 - 0x8126fd5
// Line range:    1111 - 1113
char HTAnchor_safe(int32_t * me) {
    char result = 0; // 0x8126fbd
    if (me != NULL) {
        // 0x8126fbf
        result = *(char *)((int32_t)me + 86);
    }
    // 0x8126fcf
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126fd5 - 0x8126ffb
// Line range:    1118 - 1120
char * HTAnchor_content_base(int32_t * me) {
    char * result = NULL; // 0x8126fdf
    if (me != NULL) {
        // 0x8126fe1
        result = (char *)*(int32_t *)((int32_t)me + 128);
    }
    // 0x8126ff6
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8126ffb - 0x8127021
// Line range:    1125 - 1127
char * HTAnchor_content_location(int32_t * me) {
    char * result = NULL; // 0x8127005
    if (me != NULL) {
        // 0x8127007
        result = (char *)*(int32_t *)((int32_t)me + 136);
    }
    // 0x812701c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8127021 - 0x8127047
// Line range:    1132 - 1134
char * HTAnchor_messageID(int32_t * me) {
    char * result = NULL; // 0x812702b
    if (me != NULL) {
        // 0x812702d
        result = (char *)*(int32_t *)((int32_t)me + 144);
    }
    // 0x8127042
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x812708b - 0x81270b1
// Line range:    1149 - 1151
char * HTAnchor_subject(int32_t * me) {
    char * result = NULL; // 0x8127095
    if (me != NULL) {
        // 0x8127097
        result = (char *)*(int32_t *)((int32_t)me + 148);
    }
    // 0x81270ac
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81270f5 - 0x8127100
// Line range:    1167 - 1169
int32_t * HTAnchor_followLink(int32_t * me) {
    // 0x81270f5
    return (int32_t *)*(int32_t *)((int32_t)me + 8);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x812714d - 0x8127158
// Line range:    1194 - 1196
char * HTAnchor_protocol(int32_t * me) {
    // 0x812714d
    return (char *)*(int32_t *)((int32_t)me + 76);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8127158 - 0x8127166
// Line range:    1200 - 1202
void HTAnchor_setProtocol(int32_t * me, char * protocol) {
    // 0x8127158
    *(int32_t *)((int32_t)me + 76) = (int32_t)protocol;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8127166 - 0x8127171
// Line range:    1208 - 1210
char * HTAnchor_physical(int32_t * me) {
    // 0x8127166
    return (char *)*(int32_t *)((int32_t)me + 80);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8127171 - 0x8127194
// Line range:    1214 - 1218
void HTAnchor_setPhysical(int32_t * me, char * physical) {
    if (me != NULL) {
        // 0x812717d
        HTSACopy((char **)((int32_t)me + 80), physical);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8127194 - 0x81272e7
// Line range:    1246 - 1280
int32_t * HTAnchor_getUCInfoStage(int32_t * me, int32_t which_stage) {
    // 0x8127194
    if (me == NULL) {
        // 0x81272e2
        return NULL;
    }
    int32_t v1 = (int32_t)me;
    int32_t * v2 = (int32_t *)(v1 + 176); // 0x81271a7
    int32_t v3 = *v2; // 0x81271a7
    if (v3 != 0) {
        // 0x81272e2
        return (int32_t *)(40 * which_stage + 8 + v3);
    }
    int32_t * mem = calloc(1, 160); // 0x81271cc
    int32_t v4 = (int32_t)mem; // 0x81271cc
    int32_t v5 = 0; // 0x81271d8
    if (mem == NULL) {
        // 0x81271da
        outofmem("../../../WWW/Library/Implementation/HTAnchor.c", "HTAnchor_getUCInfoStage");
        // UNREACHABLE
    }
    int32_t v6 = 40 * v5 + v4; // 0x8127207
    *(int32_t *)(v6 + 12) = (int32_t)&g80;
    *(int32_t *)(v6 + 4) = -1;
    v5++;
    while (v5 != 4) {
        // 0x81271f7
        v6 = 40 * v5 + v4;
        *(int32_t *)(v6 + 12) = (int32_t)&g80;
        *(int32_t *)(v6 + 4) = -1;
        v5++;
    }
    int32_t v7 = *(int32_t *)(v1 + 36); // 0x812723c
    int32_t v8 = UCLYhndl_for_unspec; // 0x8127241
    if (v7 != 0) {
        int32_t v9 = UCGetLYhndl_byMIME((char *)v7); // 0x812724c
        int32_t v10 = v9 >= 0 ? v9 : UCLYhndl_for_unrec;
        v8 = v10 >= 0 ? v10 : UCLYhndl_for_unspec;
    }
    // 0x8127270
    memcpy((int32_t *)(v4 + 8), (int32_t *)(32 * v8 + (int32_t)&LYCharSet_UC), 32);
    *mem = 1;
    *(int32_t *)(v4 + 4) = v8;
    *v2 = v4;
    // 0x81272e2
    return (int32_t *)(40 * which_stage + 8 + v4);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81272e7 - 0x812735e
// Line range:    1284 - 1297
int32_t HTAnchor_getUCLYhndl(int32_t * me, int32_t which_stage) {
    // 0x81272e7
    if (me == NULL) {
        // 0x8127359
        return -1;
    }
    int32_t * v1 = (int32_t *)((int32_t)me + 176); // 0x81272f6
    int32_t v2 = *v1; // 0x81272f6
    int32_t v3 = v2; // 0x81272fe
    if (v2 == 0) {
        // 0x8127300
        HTAnchor_getUCInfoStage(me, which_stage);
        v3 = *v1;
    }
    int32_t v4 = v3 + 40 * which_stage; // 0x8127328
    int32_t result = -1; // 0x812732d
    if (*(int32_t *)v4 >= 1) {
        // 0x812732f
        result = *(int32_t *)(v4 + 4);
    }
    // 0x8127359
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x812735e - 0x8127429
// Line range:    1318 - 1349
int32_t * HTAnchor_setUCInfoStage(int32_t * me, int32_t LYhndl, int32_t which_stage, int32_t set_by) {
    // 0x812735e
    if (me == NULL) {
        // 0x8127424
        return NULL;
    }
    int32_t * result = HTAnchor_getUCInfoStage(me, which_stage); // 0x812737b
    int32_t * v1 = (int32_t *)((int32_t)me + 176); // 0x8127386
    int32_t v2 = 40 * which_stage; // 0x8127396
    int32_t * v3 = (int32_t *)(*v1 + v2); // 0x8127399
    if (*v3 > set_by) {
        // 0x8127424
        return NULL;
    }
    // 0x81273a1
    *v3 = set_by;
    *(int32_t *)(*v1 + (v2 | 4)) = LYhndl;
    if (LYhndl < 0) {
        // 0x812740c
        *result = -1;
    } else {
        // 0x81273e8
        memcpy(result, (int32_t *)(32 * LYhndl + (int32_t)&LYCharSet_UC), 32);
    }
    // 0x8127424
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x8127429 - 0x81274d4
// Line range:    1355 - 1369
int32_t * HTAnchor_resetUCInfoStage(int32_t * me, int32_t LYhndl, int32_t which_stage, int32_t set_by) {
    // 0x8127429
    if (me == NULL) {
        // 0x81274cf
        return NULL;
    }
    int32_t * v1 = (int32_t *)((int32_t)me + 176); // 0x8127438
    int32_t v2 = *v1; // 0x8127438
    int32_t * result = NULL; // 0x8127440
    if (v2 != 0) {
        int32_t v3 = 40 * which_stage; // 0x8127461
        *(int32_t *)(v2 + v3) = set_by;
        *(int32_t *)(*v1 + (v3 | 4)) = LYhndl;
        result = (int32_t *)(v3 + 8 + *v1);
    }
    // 0x81274cf
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAnchor.c
// Address range: 0x81274d4 - 0x81275f8
// Line range:    1378 - 1415
int32_t * HTAnchor_copyUCInfoStage(int32_t * me, int32_t to_stage, int32_t from_stage, int32_t set_by) {
    // 0x81274d4
    if (me == NULL) {
        // 0x81275ee
        return NULL;
    }
    int32_t * result = HTAnchor_getUCInfoStage(me, from_stage); // 0x81274f3
    HTAnchor_getUCInfoStage(me, to_stage);
    int32_t * v1 = (int32_t *)((int32_t)me + 176);
    int32_t v2 = *v1;
    int32_t v3 = set_by; // 0x8127514
    if (set_by == -1) {
        // 0x8127516
        v3 = *(int32_t *)(v2 + 40 * from_stage);
    }
    int32_t v4 = v3;
    int32_t v5 = v4 != 0 ? v4 : 1;
    int32_t v6 = 40 * to_stage; // 0x8127552
    int32_t * v7 = (int32_t *)(v2 + v6); // 0x8127555
    if (*v7 > v5) {
        // 0x81275ee
        return NULL;
    }
    // 0x8127561
    *v7 = v5;
    int32_t v8 = *v1 + 4;
    *(int32_t *)(v8 + v6) = *(int32_t *)(v8 + 40 * from_stage);
    if (result != result) {
        // 0x81275c5
        memcpy(result, result, 32);
    }
    // 0x81275ee
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127880 - 0x81278c7
// Line range:    20 - 30
int32_t * HTList_new(void) {
    int32_t * mem = malloc(8); // 0x812788d
    if (mem == NULL) {
        // 0x812789b
        outofmem("../../../WWW/Library/Implementation/HTList.c", "HTList_new");
        // UNREACHABLE
    }
    // 0x81278af
    *mem = 0;
    *(int32_t *)((int32_t)mem + 4) = 0;
    return mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x81278c7 - 0x81278fe
// Line range:    35 - 44
void HTList_delete(int32_t * me) {
    if (me == NULL) {
        // 0x81278fc
        return;
    }
    int32_t v1 = (int32_t)me;
    int32_t v2 = *(int32_t *)(v1 + 4); // 0x81278d2
    free((int32_t *)v1);
    while (v2 != 0) {
        // 0x81278de
        v1 = v2;
        v2 = *(int32_t *)(v1 + 4);
        free((int32_t *)v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x81278fe - 0x8127972
// Line range:    49 - 62
int32_t * HTList_reverse(int32_t * start) {
    if (start == NULL) {
        // 0x812796d
        return start;
    }
    int32_t * v1 = (int32_t *)((int32_t)start + 4); // 0x812790d
    int32_t v2 = *v1; // 0x812790d
    if (v2 == 0) {
        // 0x812796d
        return start;
    }
    int32_t * v3 = (int32_t *)(v2 + 4); // 0x812791a
    int32_t v4 = *v3; // 0x812791a
    if (v4 == 0) {
        // 0x812796d
        return start;
    }
    // 0x812793d
    *v3 = 0;
    int32_t * v5 = (int32_t *)(v4 + 4); // 0x8127940
    int32_t v6 = *v5; // 0x8127940
    *v5 = *v1;
    *v1 = v4;
    int32_t v7 = v4; // 0x8127965
    while (v6 != 0) {
        int32_t v8 = v6;
        v5 = (int32_t *)(v8 + 4);
        v6 = *v5;
        *v5 = v7;
        *v1 = v8;
        v7 = v8;
    }
    // 0x812796d
    return start;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127972 - 0x8127a04
// Line range:    70 - 88
int32_t * HTList_appendList(int32_t * start, int32_t * tail) {
    if (start == NULL) {
        // 0x8127984
        if (WWW_TraceFlag != 0) {
            // 0x812798f
            fprintf(TraceFP(), "HTList: Trying to append list %p to a nonexisting list\n", tail);
        }
        // 0x81279ff
        return (int32_t *)0;
    }
    int32_t v1 = (int32_t)start;
    if (tail == NULL) {
        // 0x81279ff
        return (int32_t *)v1;
    }
    int32_t * v2 = (int32_t *)((int32_t)tail + 4); // 0x81279c1
    int32_t v3 = *v2; // 0x81279c1
    if (v3 == 0) {
        // 0x81279ff
        return (int32_t *)v1;
    }
    int32_t * v4 = (int32_t *)(v1 + 4);
    int32_t v5 = *v4; // 0x81279dc
    while (v5 != 0) {
        // 0x81279d9
        v4 = (int32_t *)(v5 + 4);
        v5 = *v4;
    }
    // 0x81279e3
    *v4 = v3;
    *v2 = 0;
    // 0x81279ff
    return (int32_t *)v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127a04 - 0x8127ad1
// Line range:    98 - 123
void HTList_linkObject(int32_t * me, char * newObject, int32_t * newNode) {
    if (me == NULL) {
        // 0x8127aa6
        if (WWW_TraceFlag != 0) {
            // 0x8127ab1
            fprintf(TraceFP(), "HTList: Trying to link object %p to a nonexisting list\n", newObject);
        }
        // 0x8127acf
        return;
    }
    // 0x8127a14
    if (*newNode == 0) {
        int32_t v1 = (int32_t)newNode;
        int32_t * v2 = (int32_t *)(v1 + 4); // 0x8127a20
        if (*v2 == 0) {
            // 0x8127a27
            *newNode = (int32_t)newObject;
            int32_t * v3 = (int32_t *)((int32_t)me + 4); // 0x8127a32
            *v2 = *v3;
            *v3 = v1;
            // 0x8127acf
            return;
        }
    }
    // 0x8127a49
    if (WWW_TraceFlag == 0) {
        // 0x8127acf
        return;
    }
    // 0x8127a6b
    fprintf(TraceFP(), "*** HTList: Refuse linking already linked obj ");
    if (WWW_TraceFlag != 0) {
        // 0x8127a76
        fprintf(TraceFP(), "%p, node %p, list %p\n", newObject, newNode, me);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127ad1 - 0x8127b50
// Line range:    128 - 145
void HTList_addObject(int32_t * me, char * newObject) {
    if (me == NULL) {
        // 0x8127b25
        if (WWW_TraceFlag != 0) {
            // 0x8127b30
            fprintf(TraceFP(), "HTList: Trying to add object %p to a nonexisting list\n", newObject);
        }
        // 0x8127b4e
        return;
    }
    int32_t * mem = malloc(8); // 0x8127ae4
    if (mem == NULL) {
        // 0x8127af2
        outofmem("../../../WWW/Library/Implementation/HTList.c", "HTList_addObject");
        // UNREACHABLE
    }
    int32_t v1 = (int32_t)mem; // 0x8127ae4
    *mem = (int32_t)newObject;
    int32_t * v2 = (int32_t *)((int32_t)me + 4); // 0x8127b11
    *(int32_t *)(v1 + 4) = *v2;
    *v2 = v1;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127b50 - 0x8127b91
// Line range:    150 - 160
void HTList_appendObject(int32_t * me, char * newObject) {
    if (me == NULL || newObject == NULL) {
        // 0x8127b8f
        return;
    }
    int32_t v1 = (int32_t)me;
    int32_t v2 = *(int32_t *)(v1 + 4); // 0x8127b76
    while (v2 != 0) {
        // 0x8127b73
        v1 = v2;
        v2 = *(int32_t *)(v1 + 4);
    }
    // 0x8127b7d
    HTList_addObject((int32_t *)v1, newObject);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127b91 - 0x8127ca6
// Line range:    168 - 204
void HTList_insertObjectAt(int32_t * me, char * newObject, int32_t pos) {
    if (me == NULL) {
        // 0x8127ba9
        if (WWW_TraceFlag != 0) {
            // 0x8127bb8
            fprintf(TraceFP(), "HTList: Trying to add object %p to a nonexisting list\n", newObject);
        }
        // 0x8127ca4
        return;
    }
    int32_t * v1 = (int32_t *)pos; // 0x8127bdf
    if (pos < 0) {
        // 0x8127be1
        v1 = NULL;
        if (WWW_TraceFlag != 0) {
            // 0x8127bf3
            fprintf(TraceFP(), "HTList: Treating negative object position %d as %d.\n", pos, 0);
            v1 = NULL;
        }
    }
    int32_t v2 = (int32_t)me;
    int32_t * newNode; // bp-16, 0x8127b91
    *(int32_t *)&newNode = v2;
    int32_t v3 = *(int32_t *)(v2 + 4); // 0x8127c80
    int32_t * v4 = me; // 0x8127c8a
    int32_t * v5 = v1; // 0x8127c8a
    if (v3 == 0) {
        goto lab_0x8127c8c;
      lab_0x8127c8c:
        // 0x8127c8c
        if (v5 >= NULL) {
            // 0x8127c92
            HTList_addObject(v4, newObject);
        }
        // 0x8127ca4
        return;
    }
    int32_t v6 = v3;
    while (v5 != NULL) {
        // 0x8127c73
        *(int32_t *)&newNode = v6;
        v5 = (int32_t *)((int32_t)v5 - 1);
        int32_t v7 = *(int32_t *)(v6 + 4); // 0x8127c80
        if (v7 == 0) {
            // 0x8127c7d
            v4 = (int32_t *)v6;
            goto lab_0x8127c8c;
        }
        v6 = v7;
    }
    int32_t * mem = malloc(8); // 0x8127c2f
    if (mem == NULL) {
        // 0x8127c3d
        outofmem("../../../WWW/Library/Implementation/HTList.c", "HTList_addObjectAt");
        // UNREACHABLE
    }
    int32_t v8 = (int32_t)mem; // 0x8127c2f
    *mem = (int32_t)newObject;
    *(int32_t *)(v8 + 4) = v6;
    if (newNode != NULL) {
        // 0x8127c68
        *(int32_t *)((int32_t)newNode + 4) = v8;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127ca6 - 0x8127d12
// Line range:    210 - 227
char HTList_unlinkObject(int32_t * me, char * oldObject) {
    // 0x8127ca6
    if (me == NULL || oldObject == NULL) {
        // 0x8127d0c
        return 0;
    }
    int32_t * v1 = (int32_t *)((int32_t)me + 4);
    int32_t v2 = *v1; // 0x8127d01
    char result = 0; // 0x8127d06
    while (v2 != 0) {
        int32_t * v3 = (int32_t *)v2;
        if (*v3 == (int32_t)oldObject) {
            int32_t * v4 = (int32_t *)(v2 + 4); // 0x8127cdc
            *v1 = *v4;
            *v4 = 0;
            *v3 = 0;
            result = 1;
            return result;
        }
        v1 = (int32_t *)(v2 + 4);
        v2 = *v1;
        result = 0;
    }
  lab_0x8127d0c:
    // 0x8127d0c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127d12 - 0x8127d83
// Line range:    232 - 248
char HTList_removeObject(int32_t * me, char * oldObject) {
    // 0x8127d12
    if (me == NULL || oldObject == NULL) {
        // 0x8127d7d
        return 0;
    }
    int32_t * v1 = (int32_t *)((int32_t)me + 4);
    int32_t v2 = *v1; // 0x8127d72
    char result = 0; // 0x8127d77
    while (v2 != 0) {
        int32_t * v3 = (int32_t *)v2;
        if (*v3 == (int32_t)oldObject) {
            // 0x8127d57
            *v1 = *(int32_t *)(v2 + 4);
            free(v3);
            result = 1;
            return result;
        }
        v1 = (int32_t *)(v2 + 4);
        v2 = *v1;
        result = 0;
    }
  lab_0x8127d7d:
    // 0x8127d7d
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127d83 - 0x8127e11
// Line range:    256 - 277
char * HTList_removeObjectAt(int32_t * me, int32_t position) {
    // 0x8127d83
    if (me != NULL != position >= 0) {
        // 0x8127e0c
        return NULL;
    }
    int32_t * v1 = (int32_t *)((int32_t)me + 4);
    int32_t v2 = *v1; // 0x8127df9
    if (v2 == 0) {
        // 0x8127e0c
        return NULL;
    }
    int32_t * v3 = v1; // 0x8127db6
    int32_t v4 = position; // 0x8127db6
    int32_t v5 = v2; // 0x8127db6
    if (position == 0) {
        goto lab_0x8127de2;
      lab_0x8127de2:
        // 0x8127de2
        *v3 = *(int32_t *)(v5 + 4);
        int32_t * v6 = (int32_t *)v5; // 0x8127dc7
        free(v6);
        // 0x8127e0c
        return (char *)*v6;
    }
    int32_t v7 = v5;
    v5 = *(int32_t *)(v7 + 4);
    while (v5 != 0) {
        // 0x8127db2
        v4--;
        if (v4 == 0) {
            // 0x8127db2
            v3 = (int32_t *)(v7 + 4);
            goto lab_0x8127de2;
        }
        v7 = v5;
        v5 = *(int32_t *)(v7 + 4);
    }
    // 0x8127e0c
    return NULL;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127e11 - 0x8127e6b
// Line range:    284 - 299
char * HTList_unlinkLastObject(int32_t * me) {
    // 0x8127e11
    if (me == NULL) {
        // 0x8127e66
        return NULL;
    }
    int32_t * v1 = (int32_t *)((int32_t)me + 4); // 0x8127e20
    int32_t v2 = *v1; // 0x8127e20
    char * result = NULL; // 0x8127e25
    if (v2 != 0) {
        int32_t * v3 = (int32_t *)v2; // 0x8127e33
        int32_t * v4 = (int32_t *)(v2 + 4); // 0x8127e3b
        *v1 = *v4;
        *v4 = 0;
        *v3 = 0;
        result = (char *)*v3;
    }
    // 0x8127e66
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127e6b - 0x8127eca
// Line range:    305 - 319
char * HTList_removeLastObject(int32_t * me) {
    // 0x8127e6b
    if (me == NULL) {
        // 0x8127ec5
        return NULL;
    }
    int32_t * v1 = (int32_t *)((int32_t)me + 4); // 0x8127e7a
    int32_t v2 = *v1; // 0x8127e7a
    char * result = NULL; // 0x8127e7f
    if (v2 != 0) {
        int32_t * v3 = (int32_t *)v2; // 0x8127e8d
        *v1 = *(int32_t *)(v2 + 4);
        free(v3);
        result = (char *)*v3;
    }
    // 0x8127ec5
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127eca - 0x8127f4e
// Line range:    325 - 347
char * HTList_removeFirstObject(int32_t * me) {
    // 0x8127eca
    if (me == NULL) {
        // 0x8127f49
        return NULL;
    }
    int32_t v1 = (int32_t)me;
    if (*(int32_t *)(v1 + 4) == 0) {
        // 0x8127f49
        return NULL;
    }
    int32_t * v2 = me;
    int32_t v3 = v1;
    int32_t v4 = *(int32_t *)(v3 + 4); // 0x8127f09
    int32_t * v5 = (int32_t *)v3;
    while (v4 != 0) {
        // 0x8127f06
        v2 = v5;
        v3 = v4;
        v4 = *(int32_t *)(v3 + 4);
        v5 = (int32_t *)v3;
    }
    // 0x8127f10
    *(int32_t *)((int32_t)v2 + 4) = 0;
    if (v3 != 0) {
        // 0x8127f28
        free(v5);
    }
    // 0x8127f49
    return (char *)*v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127f4e - 0x8127f81
// Line range:    353 - 362
int32_t HTList_count(int32_t * me) {
    // 0x8127f4e
    if (me == NULL) {
        // 0x8127f7c
        return 0;
    }
    int32_t v1 = *(int32_t *)((int32_t)me + 4); // 0x8127f70
    int32_t v2 = v1; // 0x8127f7a
    if (v1 == 0) {
        // 0x8127f7c
        return 0;
    }
    int32_t result = (int32_t)NULL + 1; // 0x8127f69
    v2 += 4;
    int32_t * v3 = (int32_t *)result; // 0x8127f7a
    while (v2 != 0) {
        // 0x8127f69
        result = (int32_t)v3 + 1;
        v2 += 4;
        v3 = (int32_t *)result;
    }
    // 0x8127f7c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTList.c
// Address range: 0x8127fcd - 0x8128023
// Line range:    388 - 402
char * HTList_objectAt(int32_t * me, int32_t position) {
    // 0x8127fcd
    if (me != NULL != position >= 0) {
        // 0x812801e
        return NULL;
    }
    int32_t v1 = *(int32_t *)((int32_t)me + 4); // 0x812800b
    if (v1 == 0) {
        // 0x812801e
        return NULL;
    }
    int32_t v2 = position; // 0x8128015
    int32_t v3 = v1;
    while (v2 != 0) {
        int32_t v4 = *(int32_t *)(v3 + 4); // 0x812800b
        v2--;
        if (v4 == 0) {
            // 0x812801e
            return NULL;
        }
        v3 = v4;
    }
    // 0x812801e
    return (char *)*(int32_t *)v3;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8128024 - 0x81280b5
// Line range:    44 - 59
int32_t strcasecomp8(char * a, char * b) {
    char v1 = *a;
    char v2 = v1; // 0x8128077
    char * v3 = b; // 0x8128077
    if (v1 == 0) {
        // 0x81280b0
        return *b != 0;
    }
    char * v4 = a; // 0x8128077
    char v5 = *v3; // 0x812807c
    int32_t result = 1; // 0x8128081
    while (v5 != 0) {
        int32_t v6 = UPPER8((int32_t)v2, (int32_t)v5); // 0x8128051
        result = v6;
        if (v6 != 0) {
            // break -> 0x81280b0
            break;
        }
        // 0x8128067
        v4 = (char *)((int32_t)v4 + 1);
        v3 = (char *)((int32_t)v3 + 1);
        v2 = *v4;
        char * v7 = v3; // 0x8128077
        if (v2 == 0) {
            // 0x81280b0
            return *v7 != 0;
        }
        v5 = *v3;
        result = 1;
    }
    // 0x81280b0
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x81280b5 - 0x8128148
// Line range:    71 - 87
int32_t strncasecomp8(char * a, char * b, int32_t n) {
    int32_t v1 = (int32_t)a;
    int32_t v2 = v1; // 0x81280d0
    char * v3 = b; // 0x81280d0
    if (n == 0) {
        // 0x8128143
        return (int32_t)NULL;
    }
    char v4 = *a; // 0x81280de
    char v5 = *v3;
    while (v4 != 0 == (v5 != 0)) {
        int32_t v6 = UPPER8((int32_t)v4, (int32_t)v5); // 0x8128123
        char * v7; // 0x81280b5
        if (v6 != 0) {
            // 0x8128131
            v7 = (char *)v6;
            return (int32_t)v7;
        }
        // 0x8128139
        v2++;
        v3 = (char *)((int32_t)v3 + 1);
        v7 = NULL;
        if (v1 + n == v2) {
            // 0x8128143
            return (int32_t)v7;
        }
        v4 = *(char *)v2;
        v5 = *v3;
    }
    // 0x8128143
    return (int32_t)(char *)((int32_t)v4 - (int32_t)v5);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8128148 - 0x8128254
// Line range:    95 - 110
int32_t strcasecomp(char * a, char * b) {
    char * v1 = b; // 0x8128212
    if (*a == 0) {
        // 0x812824f
        return *b != 0;
    }
    char * v2 = a; // 0x8128212
    int32_t result = 1; // 0x812821c
    while (*v1 != 0) {
        int16_t * v3 = *__ctype_b_loc(); // 0x8128164
        int32_t c = (int32_t)*v2; // 0x8128169
        int32_t v4 = c; // 0x8128181
        if ((*(int16_t *)(2 * c + (int32_t)v3) & 256) != 0) {
            // 0x8128183
            v4 = tolower(c);
        }
        int16_t * v5 = *__ctype_b_loc(); // 0x81281aa
        int32_t c2 = (int32_t)*v1; // 0x81281af
        int32_t v6 = c2; // 0x81281c7
        if ((*(int16_t *)(2 * c2 + (int32_t)v5) & 256) != 0) {
            // 0x81281c9
            v6 = tolower(c2);
        }
        int32_t v7 = v4 - v6; // 0x81281ee
        result = v7;
        if (v7 != 0) {
            // break -> 0x812824f
            break;
        }
        // 0x8128202
        v2 = (char *)((int32_t)v2 + 1);
        v1 = (char *)((int32_t)v1 + 1);
        char * v8 = v1; // 0x8128212
        if (*v2 == 0) {
            // 0x812824f
            return *v8 != 0;
        }
        result = 1;
    }
    // 0x812824f
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8128254 - 0x8128364
// Line range:    118 - 134
int32_t strncasecomp(char * a, char * b, int32_t n) {
    int32_t v1 = (int32_t)a;
    int32_t v2 = v1; // 0x812826f
    char * v3 = b; // 0x812826f
    if (n == 0) {
        // 0x812835f
        return (int32_t)NULL;
    }
    char * v4 = a; // 0x812826f
    char v5 = *v4; // 0x8128280
    char v6 = *v3;
    while (v5 != 0 == (v6 != 0)) {
        int16_t * v7 = *__ctype_b_loc(); // 0x81282b4
        int32_t c = (int32_t)*v4; // 0x81282b9
        int32_t v8 = c; // 0x81282d1
        if ((*(int16_t *)(2 * c + (int32_t)v7) & 256) != 0) {
            // 0x81282d3
            v8 = tolower(c);
        }
        int16_t ** v9 = __ctype_b_loc(); // 0x81282f5
        int32_t c2 = (int32_t)*v3; // 0x81282ff
        int32_t v10 = c2; // 0x8128317
        if ((*(int16_t *)(2 * c2 + (int32_t)*v9) & 256) != 0) {
            // 0x8128319
            v10 = tolower(c2);
        }
        int32_t v11 = v8 - v10; // 0x812833e
        char * v12; // 0x8128254
        if (v11 != 0) {
            // 0x812834a
            v12 = (char *)v11;
            return (int32_t)v12;
        }
        // 0x8128352
        v2++;
        v3 = (char *)((int32_t)v3 + 1);
        v4 = (char *)v2;
        v12 = NULL;
        if (v1 + n == v2) {
            // 0x812835f
            return (int32_t)v12;
        }
        v5 = *v4;
        v6 = *v3;
    }
    // 0x812835f
    return (int32_t)(char *)((int32_t)v5 - (int32_t)v6);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x812853d - 0x81285fd
// Line range:    296 - 311
char * HTSACopy(char ** dest, char * src) {
    char * v1 = *dest;
    if (src == NULL) {
        // 0x81285d7
        if (v1 != NULL) {
            // 0x81285e0
            free((int32_t *)v1);
            *(int32_t *)dest = 0;
        }
        // 0x81285f6
        return NULL;
    }
    // 0x812854d
    if (v1 == src) {
        // 0x81285f6
        return src;
    }
    int32_t len = strlen(src); // 0x8128561
    char * v2 = *dest;
    if (v2 == NULL) {
        // branch -> 0x812858b
    } else {
        // 0x8128575
        free((int32_t *)v2);
        *(int32_t *)dest = 0;
    }
    int32_t size = len + 1; // 0x8128566
    int32_t * mem = malloc(size); // 0x8128591
    *(int32_t *)dest = (int32_t)mem;
    if (mem == NULL) {
        // 0x81285a6
        outofmem("../../../WWW/Library/Implementation/HTString.c", "HTSACopy");
        // UNREACHABLE
    }
    // 0x81285ba
    memcpy(mem, (int32_t *)src, size);
    // 0x81285f6
    return *dest;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x81285fd - 0x81286f8
// Line range:    317 - 334
char * HTSACat(char ** dest, char * src) {
    if (src == NULL || *src == 0) {
        // 0x81286f1
        return *dest;
    }
    char * str = *dest;
    if (str == src) {
        // 0x81286f1
        return *dest;
    }
    if (str == NULL) {
        int32_t * mem = malloc(strlen(src) + 1); // 0x81286b4
        *(int32_t *)dest = (int32_t)mem;
        if (mem == NULL) {
            // 0x81286c9
            outofmem("../../../WWW/Library/Implementation/HTString.c", "HTSACat");
            // UNREACHABLE
        }
        // 0x81286dd
        strcpy((char *)mem, src);
        // 0x81286f1
        return *dest;
    }
    int32_t len = strlen(str); // 0x812863a
    int32_t * mem2 = realloc((int32_t *)*dest, len + 1 + strlen(src)); // 0x812865f
    int32_t v1 = (int32_t)mem2; // 0x812865f
    *(int32_t *)dest = v1;
    if (mem2 == NULL) {
        // 0x8128674
        outofmem("../../../WWW/Library/Implementation/HTString.c", "HTSACat");
        // UNREACHABLE
    }
    // 0x8128688
    strcpy((char *)(len + v1), src);
    // 0x81286f1
    return *dest;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x81287fb - 0x81288d3
// Line range:    388 - 414
char * HTNextField(char ** pstr) {
    char * v1 = *pstr;
    int32_t v2 = (int32_t)v1;
    char * v3; // bp-8, 0x81287fb
    *(int32_t *)&v3 = v2;
    char v4 = *v1; // 0x8128812
    char * v5 = v1; // 0x8128817
    int32_t v6 = v2; // 0x8128817
    char v7 = v4; // 0x8128817
    if (v4 < 33) {
        v6 = (int32_t)v5 + 1;
        v5 = (char *)v6;
        v7 = *v5;
        while (v7 < 33) {
            // 0x812880b
            v6 = (int32_t)v5 + 1;
            v5 = (char *)v6;
            v7 = *v5;
        }
        // 0x812880f
        v3 = v5;
    }
    // 0x8128823
    if (v7 == 0) {
        // 0x812882d
        *(int32_t *)pstr = (int32_t)v5;
        // 0x81288ce
        return NULL;
    }
    int32_t v8; // 0x81287fb
    char * v9; // 0x81287fb
    char v10; // 0x81287fb
    char * p; // bp-12, 0x81287fb
    if (v7 != 34) {
        // 0x812888c
        *(int32_t *)&p = v6;
        char * v11 = (char *)v6;
        char * v12 = v5; // 0x81288a0
        if (*v11 >= 33) {
            char * v13 = (char *)((int32_t)v11 + 1);
            char * v14 = v13; // 0x81288a0
            while (*v13 >= 33) {
                // 0x8128894
                v13 = (char *)((int32_t)v14 + 1);
                v14 = v13;
            }
            // 0x8128898
            v3 = v13;
            v12 = v13;
        }
        // 0x81288ac
        v8 = v6;
        v9 = v12;
        v10 = *v12;
    } else {
        int32_t v15 = (int32_t)v5 + 1; // 0x812884b
        char * v16 = (char *)v15; // 0x812884b
        v3 = v16;
        p = v16;
        char v17 = *v16; // 0x8128879
        v8 = v15;
        v9 = v16;
        v10 = v17;
        if (v17 != 0 == (v17 != 34)) {
            char * v18 = v16; // 0x812885f
            char * v19; // 0x8128867
            if (v17 == 92) {
                // 0x8128861
                v19 = (char *)((int32_t)v16 + 1);
                v18 = v16;
                if (*v19 != 0) {
                    // 0x812886e
                    v3 = v19;
                    v18 = v19;
                }
            }
            char * v20 = (char *)((int32_t)v18 + 1);
            v3 = v20;
            char v21 = *v20; // 0x8128879
            v8 = v15;
            v9 = v20;
            v10 = v21;
            while (v21 != 0 == (v21 != 34)) {
                char * v22 = v20;
                v18 = v22;
                if (v21 == 92) {
                    // 0x8128861
                    v19 = (char *)((int32_t)v22 + 1);
                    v18 = v22;
                    if (*v19 != 0) {
                        // 0x812886e
                        v3 = v19;
                        v18 = v19;
                    }
                }
                // 0x8128872
                v20 = (char *)((int32_t)v18 + 1);
                v3 = v20;
                v21 = *v20;
                v8 = v15;
                v9 = v20;
                v10 = v21;
            }
        }
    }
    int32_t v23 = v8; // 0x81288b4
    char * v24 = v9; // 0x81288b4
    if (v10 != 0) {
        // 0x81288b6
        *v9 = 0;
        v24 = (char *)((int32_t)v3 + 1);
        v3 = v24;
        v23 = (int32_t)p;
    }
    // 0x81288c0
    *(int32_t *)pstr = (int32_t)v24;
    // 0x81288ce
    return (char *)v23;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x81288d3 - 0x8128e4f
// Line range:    445 - 570
char * HTNextTok(char ** pstr, char * delims, char * bracks, char * found) {
    char * v1 = *pstr; // 0x81288dc
    char * p = NULL; // bp-20, 0x81288e1
    if (pstr != NULL != v1 != NULL) {
        // 0x8128e4a
        return NULL;
    }
    char * str = delims != NULL ? delims : " ;,=";
    char * str2 = bracks != NULL ? bracks : "<\"";
    char v2; // 0x81288d3
    if (strchr(str, 32) != NULL) {
        // 0x8128958
        v2 = 0;
        goto lab_0x812895f;
    } else {
        // 0x8128938
        v2 = 1;
        if (strchr(str2, 32) != NULL) {
            // 0x8128958
            v2 = 0;
            goto lab_0x812895f;
        } else {
            goto lab_0x812895f;
        }
    }
  lab_0x8128e17_8:;
    // 0x8128e17
    char v3; // 0x81288d3
    int32_t v4 = v3;
    char * v5 = (char *)v4;
    if (found == NULL) {
        goto lab_0x8128e28;
    } else {
        // 0x8128e1d
        *found = *v5;
        goto lab_0x8128e28;
    }
  lab_0x8128d7e_2:;
    // 0x8128d7e
    char * c4; // 0x81288d3
    char v6 = *c4;
    char c7 = v6; // 0x8128d86
    int32_t v7; // 0x81288d3
    int32_t v8 = v7; // 0x8128d86
    char v9; // 0x81288d3
    v3 = v9;
    if (v6 == 0) {
        goto lab_0x8128e17_8;
    } else {
        goto lab_0x8128d88;
    }
  lab_0x8128a09:;
    // 0x8128a09
    char v10; // 0x81288d3
    int32_t v11 = v10;
    char v12 = *(char *)v11;
    int32_t v13 = v11; // 0x8128a11
    int32_t v14 = v11; // 0x8128a11
    bool v15; // 0x81288d3
    char v16 = v15; // 0x8128a11
    char v17 = v10; // 0x8128a11
    char v18 = v12; // 0x8128a11
    char * v19; // 0x81288d3
    char * v20 = v19; // 0x8128a11
    char * v21; // 0x81288d3
    char * v22 = v21; // 0x8128a11
    char * v23; // 0x81288d3
    char * v24 = v23; // 0x8128a11
    int32_t v25; // 0x81288d3
    int32_t v26 = v25; // 0x8128a11
    if (v12 == 0) {
        // break -> 0x8128a49
        goto lab_0x8128a49_2;
    }
    goto lab_0x8128a13;
  lab_0x8128d88:
    // 0x8128d88
    v25 = v7;
    char * v43; // 0x81288d3
    v23 = v43;
    v21 = v43;
    v19 = v43;
    v10 = v9;
    v15 = true;
    char * result; // 0x81288d3
    int32_t v47; // 0x81288d3
    char v41; // 0x81288d3
    if (strchr(str2, (int32_t)c7) == NULL) {
        // 0x8128dad
        v8 = v7;
        v3 = v9;
        if (v41 == 0 | *c4 != 40) {
            goto lab_0x8128e17_8;
        } else {
            // 0x8128dbd
            *(int32_t *)pstr = v47;
            HTNextTok(pstr, NULL, "(", found);
            *c4 = 0;
            char * v95 = *pstr;
            if (v95 == NULL) {
                // 0x8128e0f
                result = p;
                goto lab_0x8128e4a;
            } else {
                // 0x8128df6
                if (*v95 == 0) {
                    // 0x8128e0f
                    result = p;
                    goto lab_0x8128e4a;
                } else {
                    // 0x8128e02
                    *(int32_t *)pstr = (int32_t)v95 + 1;
                    // 0x8128e0f
                    result = p;
                    goto lab_0x8128e4a;
                }
            }
        }
    }
    goto lab_0x8128a09;
  lab_0x8128c57:;
    // 0x8128c57
    char v53; // 0x81288d3
    char v96 = v53;
    int32_t v97; // 0x81288d3
    char * v98; // 0x81288d3
    int32_t v99; // 0x81288d3
    char * v100; // 0x81288d3
    char * v101; // 0x81288d3
    char * v29; // 0x81288d3
    char * v28; // 0x81288d3
    int32_t v27; // 0x81288d3
    char v36; // 0x81288d3
    char v102; // 0x81288d3
    if (v29 != NULL) {
        int32_t v103 = v36; // 0x8128c88
        v98 = (char *)v103;
        v97 = v103;
        v99 = v27;
        v100 = v28;
        v101 = v29;
        v102 = v36;
    } else {
        char v104 = v36 + 1; // 0x8128c5d
        int32_t v105 = v104;
        char * v106 = (char *)v105;
        p = v106;
        v98 = v106;
        v97 = v105;
        v99 = v105;
        v100 = v106;
        v101 = v106;
        v102 = v104;
    }
    int32_t v107 = v99;
    char v108 = *v98; // 0x8128c8b
    char v109 = v108; // 0x8128c90
    int32_t v110 = v97; // 0x8128c90
    char v111 = v102; // 0x8128c90
    char v112 = v102; // 0x8128c90
    if (v108 != 0 == (v108 != v96)) {
        char v113 = v111;
        char v114 = v113; // 0x8128c71
        char v115; // 0x8128c79
        if (v109 == 92) {
            // 0x8128c73
            v115 = *(char *)(v110 + 1);
            v114 = v113 + (char)(v115 != 0);
        }
        char v116 = v114 + 1; // 0x8128c84
        int32_t v117 = v116; // 0x8128c88
        char v118 = *(char *)v117; // 0x8128c8b
        v112 = v116;
        while (v118 != 0 == (v118 != v96)) {
            // 0x8128c69
            v113 = v116;
            v114 = v113;
            if (v118 == 92) {
                // 0x8128c73
                v115 = *(char *)(v117 + 1);
                v114 = v113 + (char)(v115 != 0);
            }
            // 0x8128c84
            v116 = v114 + 1;
            v117 = v116;
            v118 = *(char *)v117;
            v112 = v116;
        }
    }
    // 0x8128c9d
    v8 = v107;
    v3 = v112;
    char v31; // 0x81288d3
    if (v31 == 0) {
        goto lab_0x8128e17_8;
    }
    char v119 = v112 + 1; // 0x8128ca7
    char * c9 = (char *)(int32_t)v119; // 0x8128cae
    char c8 = *c9; // 0x8128cae
    v8 = v107;
    v3 = v119;
    if (c8 == 0) {
        goto lab_0x8128e17_8;
    }
    // 0x8128cb9
    if (strchr(str2, (int32_t)c8) == NULL) {
        // 0x8128cd5
        v8 = v107;
        v3 = v119;
        if (strchr(str, (int32_t)*c9) != NULL) {
            goto lab_0x8128e17_8;
        }
    }
    // 0x8128cf5
    v25 = v107;
    v23 = v100;
    v21 = v101;
    v19 = v101;
    v10 = v119;
    v15 = strchr(str2, (int32_t)*c9) != NULL;
    goto lab_0x8128a09;
  lab_0x812895f:;
    char * found_char_pos = strchr(str2, 40); // 0x8128974
    char v120; // 0x81288d3
    if (found_char_pos != NULL) {
        // 0x81289ad
        v120 = 0;
        goto lab_0x81289b4;
    } else {
        // 0x8128987
        v120 = 1;
        if (v2 == 0 == strchr(str, 40) == NULL) {
            goto lab_0x81289b4;
        } else {
            // 0x81289ad
            v120 = 0;
            goto lab_0x81289b4;
        }
    }
  lab_0x81289b4:
    // 0x81289b4
    v41 = v120;
    char v121 = (int32_t)v1;
    int32_t v122 = v121;
    unsigned char v123 = *(char *)v122; // 0x81289c4
    char v124 = v121 + 1; // 0x81289c9
    while (v123 < 33 == (v2 == 0 && v123 != 0)) {
        // 0x81289c1
        v121 = v124;
        v122 = v121;
        v123 = *(char *)v122;
        v124 = v121 + 1;
    }
    if (v123 == 0) {
        // 0x81289e5
        *(int32_t *)pstr = v122;
        result = NULL;
        if (found != NULL) {
            // 0x81289f3
            *found = 0;
            result = NULL;
        }
      lab_0x8128e4a:
        // 0x8128e4a
        return result;
    }
    // 0x8128a13
    v14 = v122;
    v16 = 0;
    v17 = v121;
    v18 = v123;
    v20 = NULL;
    v22 = NULL;
    v24 = NULL;
    v26 = 0;
    while (true) {
      lab_0x8128a13:
        // 0x8128a13
        v27 = v26;
        v28 = v24;
        v29 = v22;
        char * v30 = v20;
        v31 = v16;
        char v32 = v18; // 0x8128a0c
        char * v33 = (char *)v14; // 0x81288d3
        int32_t v34 = v14; // 0x81288d3
        char v35 = v17; // 0x8128a05
        while (true) {
            // 0x8128a13
            v36 = v35;
            char c = v32;
            if (v2 == 0 != c < 33) {
                // 0x8128a23
                if (strchr(str, (int32_t)c) == NULL) {
                    // break -> 0x8128a3f
                    break;
                }
            }
            // 0x8128a05
            v35 = v36 + 1;
            int32_t v37 = v35; // 0x8128a09
            char * v38 = (char *)v37;
            v32 = *v38;
            v33 = v38;
            v34 = v37;
            v13 = v37;
            if (v32 == 0) {
                // break (via goto) -> 0x8128a49
                goto lab_0x8128a49_2;
            }
        }
        int32_t v39 = v34;
        char * v40 = v33;
        char c2 = *v40;
        v13 = v39;
        if (c2 == 0) {
            // break -> 0x8128a49
            break;
        }
        if (found_char_pos == NULL == v41 == 0 || c2 != 40) {
            // 0x8128be8
            if (strchr(str2, (int32_t)c2) == NULL) {
                int32_t v42 = v27; // 0x8128d1e
                v43 = v28;
                if (v28 == NULL) {
                    // 0x8128d20
                    p = v40;
                    v42 = (int32_t)v40;
                    v43 = v40;
                }
                // 0x8128d2c
                v7 = v42;
                int32_t v44 = v36; // 0x8128d2c
                char * v45 = (char *)v44;
                char v46 = *v45;
                v8 = v7;
                v3 = v36;
                if (v46 == 0) {
                    goto lab_0x8128e17_8;
                }
                v9 = v36;
                v47 = v44;
                c4 = v45;
                char c3 = v46;
                c7 = c3;
                while (v2 == 0 != c3 < 33) {
                    // 0x8128d46
                    if (strchr(str2, (int32_t)c3) != NULL) {
                        goto lab_0x8128d7e_2;
                    }
                    // 0x8128d62
                    if (strchr(str, (int32_t)*c4) != NULL) {
                        goto lab_0x8128d7e_2;
                    }
                    char v48 = v9 + 1; // 0x8128d28
                    int32_t v49 = v48; // 0x8128d2c
                    char * v50 = (char *)v49;
                    char v51 = *v50;
                    v8 = v7;
                    v3 = v48;
                    if (v51 == 0) {
                        goto lab_0x8128e17_8;
                    }
                    v9 = v48;
                    v47 = v49;
                    c4 = v50;
                    c3 = v51;
                    c7 = c3;
                }
                goto lab_0x8128d88;
            } else {
                char v52 = *v40; // 0x8128c0b
                v53 = 62;
                if (v52 == 60) {
                    goto lab_0x8128c57;
                } else {
                    if (v52 > 60) {
                        // 0x8128c28
                        v53 = 93;
                        switch (v52) {
                            case 91: {
                                goto lab_0x8128c57;
                            }
                            case 123: {
                                // 0x8128c42
                                v53 = 125;
                                goto lab_0x8128c57;
                            }
                            default: {
                                // 0x8128c4e
                                v53 = v52;
                                goto lab_0x8128c57;
                            }
                        }
                    } else {
                        // 0x8128c20
                        v53 = 59;
                        if (v52 == 58) {
                            goto lab_0x8128c57;
                        } else {
                            // 0x8128c4e
                            v53 = v52;
                            goto lab_0x8128c57;
                        }
                    }
                }
            }
        } else {
            int32_t v54 = v27; // 0x8128a9a
            char * v55 = v30; // 0x8128a9a
            if (found_char_pos != NULL == v30 == NULL) {
                // 0x8128aaa
                v54 = v39 + 1;
                v55 = (char *)v54;
                p = v55;
            }
            char * v56 = v55;
            char * v57 = v55;
            char * v58 = v55;
            int32_t v59 = v54;
            char v60 = *(char *)(int32_t)v36; // 0x8128b34
            char v61 = v60; // 0x8128b39
            char v62 = v36; // 0x8128b39
            char v63 = v36; // 0x8128b39
            if (v60 != 0) {
                char v64 = v62;
                char * v65 = NULL;
                char v66 = v61; // 0x8128ab8
                char * v67 = v65; // 0x8128b43
                int32_t v68; // 0x8128b49
                if (v66 == 41) {
                    // 0x8128b49
                    v68 = (int32_t)v65 - 1;
                    v67 = (char *)v68;
                    if (v68 >= 0 != v68 != 0) {
                        // break -> 0x8128b57
                        break;
                    }
                }
                char * v69 = v67;
                char v70; // 0x81288d3
                char v71; // 0x81288d3
                int32_t v72; // 0x81288d3
                char v73; // 0x81288d3
                char * v74; // 0x81288d3
                char v75; // 0x81288d3
                char v76; // 0x81288d3
                char v77; // 0x81288d3
                char v78; // 0x81288d3
                char v79; // 0x81288d3
                char v80; // 0x81288d3
                char v81; // 0x81288d3
                int32_t v82; // 0x8128af4
                char v83; // 0x8128af7
                int32_t v84; // 0x8128af4
                char v85; // 0x8128af7
                char v86; // 0x8128ae5
                if (v66 != 40) {
                    // 0x8128ac5
                    v73 = v64;
                    v74 = v69;
                    if (v66 == 34) {
                        // 0x8128af4
                        v77 = v64 + 1;
                        v82 = v77;
                        v83 = *(char *)v82;
                        v71 = v83;
                        v72 = v82;
                        v78 = v77;
                        v80 = v64;
                        v81 = v77;
                        v70 = v83;
                        if (v83 != 0 == (v83 != 34)) {
                            v79 = v78;
                            v75 = v79;
                            if (v71 == 92) {
                                // 0x8128adf
                                v86 = *(char *)(v72 + 1);
                                v75 = v86 == 0 ? v79 : v80 + 2;
                            }
                            // 0x8128af0
                            v76 = v75 + 1;
                            v84 = v76;
                            v85 = *(char *)v84;
                            v80 = v75;
                            v81 = v76;
                            v70 = v85;
                            while (v85 != 0 == (v85 != 34)) {
                                // 0x8128ad5
                                v79 = v76;
                                v75 = v79;
                                if (v85 == 92) {
                                    // 0x8128adf
                                    v75 = *(char *)(v84 + 1) == 0 ? v79 : v80 + 2;
                                }
                                // 0x8128af0
                                v76 = v75 + 1;
                                v84 = v76;
                                v85 = *(char *)v84;
                                v80 = v75;
                                v81 = v76;
                                v70 = v85;
                            }
                        }
                        // 0x8128b08
                        v73 = v81;
                        v74 = v69;
                        if (v70 == 0) {
                            // break -> 0x8128b57
                            break;
                        }
                    }
                } else {
                    // 0x8128abf
                    v73 = v64;
                    v74 = (char *)((int32_t)v69 + 1);
                }
                char v87 = v73;
                int32_t v88 = v87; // 0x8128b12
                char v89 = v87; // 0x8128b1a
                char v90; // 0x8128b22
                if (*(char *)v88 == 92) {
                    // 0x8128b1c
                    v90 = *(char *)(v88 + 1);
                    v89 = v87 + (char)(v90 != 0);
                }
                char v91 = v89 + 1; // 0x8128b2d
                char v92 = *(char *)(int32_t)v91; // 0x8128b34
                v63 = v91;
                while (v92 != 0) {
                    // 0x8128b3b
                    v64 = v91;
                    v65 = v74;
                    v66 = v92;
                    v67 = v65;
                    if (v66 == 41) {
                        // 0x8128b49
                        v68 = (int32_t)v65 - 1;
                        v67 = (char *)v68;
                        v63 = v64;
                        if (v68 >= 0 != v68 != 0) {
                            // break -> 0x8128b57
                            break;
                        }
                    }
                    // 0x8128ab5
                    v69 = v67;
                    if (v66 != 40) {
                        // 0x8128ac5
                        v73 = v64;
                        v74 = v69;
                        if (v66 == 34) {
                            // 0x8128af4
                            v77 = v64 + 1;
                            v82 = v77;
                            v83 = *(char *)v82;
                            v71 = v83;
                            v72 = v82;
                            v78 = v77;
                            v80 = v64;
                            v81 = v77;
                            v70 = v83;
                            if (v83 != 0 == (v83 != 34)) {
                                v79 = v78;
                                v75 = v79;
                                if (v71 == 92) {
                                    // 0x8128adf
                                    v86 = *(char *)(v72 + 1);
                                    v75 = v86 == 0 ? v79 : v80 + 2;
                                }
                                // 0x8128af0
                                v76 = v75 + 1;
                                v84 = v76;
                                v85 = *(char *)v84;
                                v80 = v75;
                                v81 = v76;
                                v70 = v85;
                                while (v85 != 0 == (v85 != 34)) {
                                    // 0x8128ad5
                                    v79 = v76;
                                    v75 = v79;
                                    if (v85 == 92) {
                                        // 0x8128adf
                                        v75 = *(char *)(v84 + 1) == 0 ? v79 : v80 + 2;
                                    }
                                    // 0x8128af0
                                    v76 = v75 + 1;
                                    v84 = v76;
                                    v85 = *(char *)v84;
                                    v80 = v75;
                                    v81 = v76;
                                    v70 = v85;
                                }
                            }
                            // 0x8128b08
                            v73 = v81;
                            v74 = v69;
                            v63 = v81;
                            if (v70 == 0) {
                                // break -> 0x8128b57
                                break;
                            }
                        }
                    } else {
                        // 0x8128abf
                        v73 = v64;
                        v74 = (char *)((int32_t)v69 + 1);
                    }
                    // 0x8128b12
                    v87 = v73;
                    v88 = v87;
                    v89 = v87;
                    if (*(char *)v88 == 92) {
                        // 0x8128b1c
                        v90 = *(char *)(v88 + 1);
                        v89 = v87 + (char)(v90 != 0);
                    }
                    // 0x8128b2d
                    v91 = v89 + 1;
                    v92 = *(char *)(int32_t)v91;
                    v63 = v91;
                }
            }
            // 0x8128b57
            v8 = v59;
            v3 = v63;
            if (found_char_pos != NULL) {
                goto lab_0x8128e17_8;
            }
            char v93 = *(char *)(int32_t)v63; // 0x8128b64
            char v94 = v63 + (char)(v93 != 0);
            v25 = v59;
            v23 = v58;
            v21 = v57;
            v19 = v56;
            v10 = v94;
            v15 = false;
            if (v31 != 0) {
                char * c6 = (char *)(int32_t)v94; // 0x8128b7c
                char c5 = *c6; // 0x8128b7c
                v8 = v59;
                v3 = v94;
                if (c5 == 0) {
                    goto lab_0x8128e17_8;
                }
                // 0x8128b87
                if (strchr(str2, (int32_t)c5) == NULL) {
                    // 0x8128ba3
                    v8 = v59;
                    v3 = v94;
                    if (strchr(str, (int32_t)*c6) != NULL) {
                        goto lab_0x8128e17_8;
                    }
                }
                // 0x8128bc3
                v25 = v59;
                v23 = v58;
                v21 = v57;
                v19 = v56;
                v10 = v94;
                v15 = strchr(str2, (int32_t)*c6) != NULL;
            }
            goto lab_0x8128a09;
        }
    }
  lab_0x8128a49_2:
    // 0x8128a49
    *(int32_t *)pstr = v13;
    if (found != NULL) {
        // 0x8128a57
        *found = *(char *)(v13 - 1);
    }
    // 0x8128e4a
    return NULL;
  lab_0x8128e28:;
    int32_t v125 = v4; // 0x8128e30
    int32_t v126 = v8; // 0x8128e30
    if (*v5 == 0) {
        goto lab_0x8128e3c;
    } else {
        // 0x8128e32
        *v5 = 0;
        v125 = v3 + 1;
        v126 = (int32_t)p;
        goto lab_0x8128e3c;
    }
  lab_0x8128e3c:
    // 0x8128e3c
    *(int32_t *)pstr = v125;
    result = (char *)v126;
    goto lab_0x8128e4a;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8128e4f - 0x8128e9f
// Line range:    573 - 581
char * HTAlloc(char * ptr, int32_t length) {
    int32_t * mem; // 0x8128e4f
    if (ptr == NULL) {
        // 0x8128e72
        mem = malloc(length);
    } else {
        // 0x8128e5b
        mem = realloc((int32_t *)ptr, length);
    }
    // 0x8128e80
    if (mem != NULL) {
        // 0x8128e9a
        return (char *)mem;
    }
    // 0x8128e86
    outofmem("../../../WWW/Library/Implementation/HTString.c", "HTAlloc");
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8128e9f - 0x8128f9f
// Line range:    621 - 881
char * StrAllocVsprintf(char ** pstr, int32_t dst_len, char * fmt, char ** ap) {
    char * result = NULL; // bp-12, 0x8128eac
    if (pstr != NULL && dst_len == 0) {
        char * v1 = *pstr;
        if (v1 != NULL) {
            // 0x8128ed1
            free((int32_t *)v1);
            *(int32_t *)pstr = 0;
        }
    }
    uint32_t v2 = vasprintf(&result, fmt, (int32_t)*ap); // 0x8128efd
    char * result2 = NULL; // 0x8128f04
    if (v2 >= 0) {
        if (dst_len == 0) {
            // 0x8128f86
            result2 = result;
        } else {
            int32_t len = strlen(result); // 0x8128f16
            char * v3 = NULL; // 0x8128f34
            if (pstr != NULL) {
                // 0x8128f36
                v3 = *pstr;
            }
            char * v4 = HTAlloc(v3, dst_len + 1 + len); // 0x8128f54
            if (v4 != NULL) {
                // 0x8128f62
                strcpy((char *)((int32_t)v4 + dst_len), result);
            }
            // 0x8128f79
            free((int32_t *)result);
            result2 = v4;
        }
    }
    // 0x8128f8c
    if (pstr != NULL) {
        // 0x8128f92
        *(int32_t *)pstr = (int32_t)result2;
    }
    // 0x8128f9a
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8128f9f - 0x8129000
// Line range:    895 - 909
char * HTSprintf(char ** pstr, char * fmt, ...) {
    // 0x8128f9f
    int32_t v1; // bp+12, 0x8128f9f
    char * result = (char *)&v1; // bp-16, 0x8128fb6
    if (pstr == NULL) {
        // 0x8128fd8
        return StrAllocVsprintf(pstr, 0, fmt, &result);
    }
    char * str = *pstr;
    int32_t len = 0; // 0x8128fc6
    if (str != NULL) {
        // 0x8128fc8
        len = strlen(str);
    }
    // 0x8128fd8
    return StrAllocVsprintf(pstr, len, fmt, &result);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129000 - 0x812903c
// Line range:    922 - 933
char * HTSprintf0(char ** pstr, char * fmt, ...) {
    // 0x8129000
    int32_t v1; // bp+12, 0x8129000
    char * result = (char *)&v1; // bp-12, 0x8129010
    return StrAllocVsprintf(pstr, 0, fmt, &result);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x812903c - 0x81291e4
// Line range:    943 - 988
char * HTQuoteParameter(char * parameter) {
    char * str = parameter != NULL ? parameter : (char *)&g81;
    int32_t len = strlen(str); // 0x8129063
    int32_t v1 = 0; // 0x81290cd
    int32_t v2; // 0x812903c
    int32_t v3; // 0x812903c
    int32_t v4; // 0x812903c
    if (len != 0) {
        // 0x8129074
        v4 = 0;
        v3 = 0;
        while (true) {
          lab_0x8129074:;
            int32_t v5 = v3;
            char * c = (char *)(v4 + (int32_t)str); // 0x812907c
            if (strchr("\\&#$^*?(){}<>\"';`|", (int32_t)*c) != NULL) {
                // 0x81290bf
                v2 = v5 + 1;
                goto lab_0x81290c3;
            } else {
                int16_t * v6 = *__ctype_b_loc(); // 0x812909b
                v2 = v5;
                if ((*(int16_t *)(2 * (int32_t)*c + (int32_t)v6) & 0x2000) == 0) {
                    goto lab_0x81290c3;
                } else {
                    // 0x81290bf
                    v2 = v5 + 1;
                    goto lab_0x81290c3;
                }
            }
        }
    }
  lab_0x81290cf:;
    int32_t * mem = malloc(len + 3 + 5 * v1); // 0x81290e2
    if (mem == NULL) {
        // 0x81290f0
        outofmem("../../../WWW/Library/Implementation/HTString.c", "HTQuoteParameter");
        // UNREACHABLE
    }
    int32_t v7 = 0; // 0x812910f
    if (v1 != 0) {
        // 0x8129111
        *(char *)mem = 39;
        v7 = 1;
    }
    int32_t v8 = (int32_t)mem; // 0x81290e2
    int32_t v9 = v7; // 0x81291b8
    if (len != 0) {
        int32_t v10 = 0; // 0x81291ae
        char * v11 = (char *)(v10 + (int32_t)str); // 0x8129135
        char v12 = *v11; // 0x8129135
        int32_t v13 = v7 + v8;
        char * v14 = (char *)v13;
        int32_t v15; // 0x812903c
        if (v12 != 39) {
            // 0x8129194
            *v14 = v12;
            v15 = v7 + 1;
        } else {
            // 0x812913c
            *v14 = 39;
            *(char *)(v13 + 1) = 34;
            *(char *)(v13 + 2) = *v11;
            *(char *)(v13 + 3) = 34;
            *(char *)(v13 + 4) = 39;
            v15 = v7 + 5;
        }
        int32_t v16 = v15;
        v10++;
        v9 = v16;
        while (v10 != len) {
            int32_t v17 = v16;
            v11 = (char *)(v10 + (int32_t)str);
            v12 = *v11;
            v13 = v17 + v8;
            v14 = (char *)v13;
            if (v12 != 39) {
                // 0x8129194
                *v14 = v12;
                v15 = v17 + 1;
            } else {
                // 0x812913c
                *v14 = 39;
                *(char *)(v13 + 1) = 34;
                *(char *)(v13 + 2) = *v11;
                *(char *)(v13 + 3) = 34;
                *(char *)(v13 + 4) = 39;
                v15 = v17 + 5;
            }
            // 0x81291ae
            v16 = v15;
            v10++;
            v9 = v16;
        }
    }
    int32_t v18 = v9; // 0x81291c2
    if (v1 != 0) {
        // 0x81291c4
        *(char *)(v9 + v8) = 39;
        v18 = v9 + 1;
    }
    // 0x81291d4
    *(char *)(v18 + v8) = 0;
    return (char *)mem;
  lab_0x81290c3:;
    int32_t v19 = v4 + 1; // 0x81290c3
    v4 = v19;
    v3 = v2;
    v1 = v2;
    if (v19 == len) {
        // break -> 0x81290cf
        goto lab_0x81290cf;
    }
    goto lab_0x8129074;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x81291e4 - 0x8129221
// Line range:    997 - 1006
int32_t HTCountCommandArgs(char * command) {
    char v1 = *command; // 0x8129215
    char * v2 = command; // 0x812921a
    if (v1 == 0) {
        // 0x812921c
        return 0;
    }
    int32_t result = 0; // 0x812921a
    v2 = (char *)((int32_t)v2 + 1);
    char v3 = *v2;
    result += (int32_t)(v3 == 115 == v1 == 37);
    while (v3 != 0) {
        char v4 = v3;
        v2 = (char *)((int32_t)v2 + 1);
        v3 = *v2;
        result += (int32_t)(v3 == 115 == v4 == 37);
    }
    // 0x812921c
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129221 - 0x812925e
// Line range:    1013 - 1026
char * HTAfterCommandArg(char * command, int32_t number) {
    int32_t v1 = number; // 0x8129257
    if (number >= 0 != number != 0) {
        // 0x8129259
        return command;
    }
    char * v2 = command;
    char v3 = *v2; // 0x8129229
    char * result = v2; // 0x812922e
    while (v3 != 0) {
        int32_t v4 = v1;
        char * v5 = v2; // 0x8129238
        int32_t v6 = v4; // 0x8129238
        if (v3 == 37) {
            char * v7 = (char *)((int32_t)v2 + 1); // 0x8129240
            char v8 = *v7; // 0x8129240
            v5 = v8 != 115 ? v2 : v7;
            v6 = v4 + (int32_t)(v8 == 115);
        }
        // 0x812924f
        v1 = v6;
        char * v9 = (char *)((int32_t)v5 + 1);
        result = v9;
        if (v1 >= 0 != v1 != 0) {
            // break -> 0x8129259
            break;
        }
        v2 = v9;
        v3 = *v2;
        result = v2;
    }
    // 0x8129259
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x812925e - 0x8129394
// Line range:    1043 - 1068
void HTAddXpand(char ** result, char * command, int32_t number, char * parameter) {
    // 0x812925e
    if (number < 1) {
        // 0x812938e
        return;
    }
    char * v1 = HTAfterCommandArg(command, number - 1); // 0x812927f
    if (number == 1) {
        char * v2 = *result;
        if (v2 != NULL) {
            // 0x81292a4
            free((int32_t *)v2);
            *(int32_t *)result = 0;
        }
    }
    char v3 = *v1; // 0x8129383
    if (v3 == 0) {
        // 0x812938e
        return;
    }
    char * v4 = v1;
    char v5 = v3;
    int32_t v6 = (int32_t)v4;
    char * v7 = (char *)(v6 + 1);
    char v8 = *v7;
    while (v5 == 37 != (v8 == 115)) {
        // 0x812937c
        if (v8 == 0) {
            // 0x812938e
            return;
        }
        v4 = v7;
        v5 = v8;
        v6 = (int32_t)v4;
        v7 = (char *)(v6 + 1);
        v8 = *v7;
    }
    // 0x81292de
    if (v4 != v1) {
        char * str = *result;
        int32_t len = 0; // 0x81292fc
        if (str != NULL) {
            // 0x81292fe
            len = strlen(str);
        }
        // 0x8129317
        HTSACat(result, v1);
        char * v9 = *result;
        *(char *)(v6 - (int32_t)v1 + len + (int32_t)v9) = 0;
    }
    // 0x812933d
    HTSACat(result, parameter);
    if (WWW_TraceFlag != 0) {
        // 0x812935a
        fprintf(TraceFP(), "PARAM-EXP:%s\n", *result);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129394 - 0x81294d3
// Line range:    1085 - 1111
void HTAddToCmd(char ** result, char * command, int32_t number, char * string) {
    // 0x8129394
    if (number < 1) {
        // 0x81294cd
        return;
    }
    char * v1 = HTAfterCommandArg(command, number - 1); // 0x81293b5
    if (number == 1) {
        char * v2 = *result;
        if (v2 != NULL) {
            // 0x81293d2
            free((int32_t *)v2);
            *(int32_t *)result = 0;
        }
    }
    char v3 = *v1; // 0x81294c2
    if (v3 == 0) {
        // 0x81294cd
        return;
    }
    char * v4 = v1;
    char v5 = v3;
    int32_t v6 = (int32_t)v4;
    char * v7 = (char *)(v6 + 1);
    char v8 = *v7;
    while (v5 == 37 != (v8 == 115)) {
        // 0x81294bb
        if (v8 == 0) {
            // 0x81294cd
            return;
        }
        v4 = v7;
        v5 = v8;
        v6 = (int32_t)v4;
        v7 = (char *)(v6 + 1);
        v8 = *v7;
    }
    // 0x812941d
    if (v4 != v1) {
        char * str = *result;
        int32_t len = 0; // 0x812943b
        if (str != NULL) {
            // 0x812943d
            len = strlen(str);
        }
        // 0x8129456
        HTSACat(result, v1);
        char * v9 = *result;
        *(char *)(v6 - (int32_t)v1 + len + (int32_t)v9) = 0;
    }
    // 0x812947c
    HTSACat(result, string != NULL ? string : (char *)&g81);
    if (WWW_TraceFlag != 0) {
        // 0x8129499
        fprintf(TraceFP(), "PARAM-ADD:%s\n", *result);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x81294d3 - 0x8129527
// Line range:    1122 - 1133
void HTAddParam(char ** result, char * command, int32_t number, char * parameter) {
    if (number < 1) {
        // 0x8129525
        return;
    }
    char * v1 = HTQuoteParameter(parameter); // 0x81294e5
    HTAddToCmd(result, command, number, v1);
    if (v1 != NULL) {
        // 0x8129513
        free((int32_t *)v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129527 - 0x81295ac
// Line range:    1142 - 1154
void HTEndParam(char ** result, char * command, int32_t number) {
    int32_t v1 = HTCountCommandArgs(command); // 0x8129534
    char * v2 = HTAfterCommandArg(command, v1 < number ? v1 : number); // 0x8129557
    if (*v2 != 0) {
        // 0x8129569
        HTSACat(result, v2);
    }
    // 0x812957b
    if (WWW_TraceFlag != 0) {
        // 0x8129586
        fprintf(TraceFP(), "PARAM-END:%s\n", *result);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x81295ac - 0x81297b0
// Line range:    1164 - 1193
void HTSABCopy(int32_t ** dest, char * src, int32_t len) {
    // 0x81295ac
    if (WWW_TraceFlag != 0) {
        // 0x81295c6
        if ((WWW_TraceMask & 16) != 0) {
            // 0x81295d2
            fprintf(TraceFP(), "HTSABCopy(%p, %p, %d)\n", dest, src, len);
        }
    }
    // 0x8129600
    HTSABFree(dest);
    if (src != NULL) {
        // 0x8129615
        if (WWW_TraceFlag != 0) {
            // 0x8129620
            if ((WWW_TraceMask & 16) != 0) {
                // 0x8129637
                fprintf(TraceFP(), "===    %4d:", len);
                trace_bstring2(src, len);
                if (WWW_TraceFlag != 0) {
                    // 0x8129672
                    fprintf(TraceFP(), "\n");
                }
            }
        }
        int32_t * mem = malloc(8); // 0x8129690
        if (mem == NULL) {
            // 0x812969e
            outofmem("../../../WWW/Library/Implementation/HTString.c", "HTSABCopy");
            // UNREACHABLE
        }
        int32_t * mem2 = malloc(len + 1); // 0x81296b8
        *mem = (int32_t)mem2;
        if (mem2 == NULL) {
            // 0x81296cd
            outofmem("../../../WWW/Library/Implementation/HTString.c", "HTSABCopy");
            // UNREACHABLE
        }
        int32_t v1 = (int32_t)mem; // 0x8129690
        memcpy(mem2, (int32_t *)src, len);
        *(int32_t *)(v1 + 4) = len;
        *(char *)(*mem + len) = 0;
        *(int32_t *)dest = v1;
    }
    // 0x812971e
    if (WWW_TraceFlag == 0 || (WWW_TraceMask & 16) == 0) {
        // 0x81297ae
        return;
    }
    int32_t * v2 = *dest;
    int32_t v3 = 0; // 0x812974b
    if (v2 != NULL) {
        // 0x812974d
        v3 = *(int32_t *)((int32_t)v2 + 4);
    }
    // 0x8129761
    fprintf(TraceFP(), "=>     %4d:", v3);
    trace_bstring(*dest);
    if (WWW_TraceFlag != 0) {
        // 0x8129797
        fprintf(TraceFP(), "\n");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x81297b0 - 0x81297d9
// Line range:    1199 - 1201
void HTSABCopy0(int32_t ** dest, char * src) {
    // 0x81297b0
    HTSABCopy(dest, src, strlen(src));
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x81297d9 - 0x8129a3e
// Line range:    1208 - 1245
void HTSABCat(int32_t ** dest, char * src, int32_t len) {
    int32_t * v1 = *dest; // 0x81297e2
    if (WWW_TraceFlag != 0) {
        // 0x81297f2
        if ((WWW_TraceMask & 16) != 0) {
            // 0x81297fe
            fprintf(TraceFP(), "HTSABCat(%p, %p, %d)\n", dest, src, len);
        }
    }
    if (src != NULL) {
        // 0x8129836
        if (WWW_TraceFlag != 0) {
            // 0x812984a
            if ((WWW_TraceMask & 16) != 0) {
                // 0x8129861
                fprintf(TraceFP(), "===    %4d:", len);
                trace_bstring2(src, len);
                if (WWW_TraceFlag != 0) {
                    // 0x812989c
                    fprintf(TraceFP(), "\n");
                }
            }
        }
        int32_t size = len + 1; // 0x8129839
        int32_t v2; // 0x81297d9
        if (v1 == NULL) {
            int32_t * mem = calloc(1, 8); // 0x812990e
            if (mem == NULL) {
                // 0x812991c
                outofmem("../../../WWW/Library/Implementation/HTString.c", "HTSACat");
                // UNREACHABLE
            }
            // 0x8129930
            *mem = (int32_t)malloc(size);
            v2 = (int32_t)mem;
        } else {
            int32_t v3 = (int32_t)v1; // 0x81297e2
            int32_t * mem2 = realloc((int32_t *)*v1, *(int32_t *)(v3 + 4) + size); // 0x81298d4
            *v1 = (int32_t)mem2;
            v2 = v3;
            if (mem2 == NULL) {
                // 0x81298e9
                outofmem("../../../WWW/Library/Implementation/HTString.c", "HTSACat");
                // UNREACHABLE
            }
        }
        int32_t * v4 = (int32_t *)v2; // 0x8129945
        int32_t v5 = *v4; // 0x8129945
        if (v5 == 0) {
            // 0x812994b
            outofmem("../../../WWW/Library/Implementation/HTString.c", "HTSACat");
            // UNREACHABLE
        }
        int32_t * v6 = (int32_t *)(v2 + 4); // 0x812996a
        memcpy((int32_t *)(*v6 + v5), (int32_t *)src, len);
        int32_t v7 = *v6 + len; // 0x812998a
        *v6 = v7;
        *(char *)(*v4 + v7) = 0;
        *(int32_t *)dest = v2;
    }
    // 0x81299ac
    if (WWW_TraceFlag == 0 || (WWW_TraceMask & 16) == 0) {
        // 0x8129a3c
        return;
    }
    int32_t * v8 = *dest;
    int32_t v9 = 0; // 0x81299d9
    if (v8 != NULL) {
        // 0x81299db
        v9 = *(int32_t *)((int32_t)v8 + 4);
    }
    // 0x81299ef
    fprintf(TraceFP(), "=>     %4d:", v9);
    trace_bstring(*dest);
    if (WWW_TraceFlag != 0) {
        // 0x8129a25
        fprintf(TraceFP(), "\n");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129a3e - 0x8129a67
// Line range:    1251 - 1253
void HTSABCat0(int32_t ** dest, char * src) {
    // 0x8129a3e
    HTSABCat(dest, src, strlen(src));
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129a67 - 0x8129aed
// Line range:    1259 - 1269
char HTSABEql(int32_t * a, int32_t * b) {
    int32_t v1 = (int32_t)a;
    int32_t v2 = 0; // 0x8129a71
    if (a != NULL) {
        // 0x8129a73
        v2 = *(int32_t *)(v1 + 4);
    }
    int32_t v3 = 0; // 0x8129a8f
    if (b != NULL) {
        // 0x8129a91
        v3 = *(int32_t *)((int32_t)b + 4);
    }
    // 0x8129aa3
    if (v2 != v3) {
        // 0x8129ae7
        return 0;
    }
    // 0x8129ab1
    if (v2 == 0) {
        // 0x8129ae7
        return 1;
    }
    // 0x8129ab7
    if (memcmp((int32_t *)*a, (int32_t *)*b, *(int32_t *)(v1 + 4)) == 0) {
        // 0x8129ae7
        return 1;
    }
    // 0x8129ae7
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129aed - 0x8129b4b
// Line range:    1275 - 1281
void HTSABFree(int32_t ** ptr) {
    int32_t * v1 = *ptr;
    if (v1 == NULL) {
        // 0x8129b49
        return;
    }
    int32_t v2 = *v1; // 0x8129b01
    int32_t * v3 = v1; // 0x8129b05
    if (v2 != 0) {
        // 0x8129b21
        free((int32_t *)v2);
        **ptr = 0;
        v3 = *ptr;
        if (v3 == NULL) {
            // 0x8129b40
            *(int32_t *)ptr = 0;
            // 0x8129b49
            return;
        }
    }
    // 0x8129b2a
    free(v3);
    *(int32_t *)ptr = 0;
    // 0x8129b40
    *(int32_t *)ptr = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129b4b - 0x8129be1
// Line range:    1288 - 1305
int32_t * HTBprintf(int32_t ** pstr, char * fmt, ...) {
    int32_t * result = NULL; // bp-12, 0x8129b58
    int32_t v1; // bp+12, 0x8129b4b
    int32_t * result2 = &v1; // bp-16, 0x8129b62
    char * str = StrAllocVsprintf((char **)&result, 0, fmt, (char **)&result2); // 0x8129b81
    result = (int32_t *)str;
    result = (int32_t *)str;
    if (str != NULL) {
        // 0x8129b90
        if (*str == 0) {
            // 0x8129bc2
            free((int32_t *)str);
            result = NULL;
            // 0x8129bd4
            return *pstr;
        }
        // 0x8129b9a
        HTSABCat(pstr, (char *)result, strlen(str));
    }
    // 0x8129bbb
    if (result == NULL) {
        // 0x8129bd4
        return *pstr;
    }
    // 0x8129bc2
    free(result);
    result = NULL;
    // 0x8129bd4
    return *pstr;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129be1 - 0x8129d64
// Line range:    1314 - 1344
void trace_bstring2(char * text, int32_t size) {
    if (text != NULL != size > 0) {
        // 0x8129d62
        return;
    }
    int32_t v1 = 0; // 0x8129d52
    unsigned char v2; // 0x8129c03
    while (true) {
      lab_0x8129bfd:
        // 0x8129bfd
        v2 = *(char *)(v1 + (int32_t)text);
        if (v2 == 12) {
            // 0x8129cbb
            fwrite((int32_t *)"\\f", 1, 2, TraceFP());
            goto lab_0x8129d52;
        } else {
            if (v2 > 12) {
                if (v2 == 13) {
                    // 0x8129c67
                    fwrite((int32_t *)"\\r", 1, 2, TraceFP());
                    goto lab_0x8129d52;
                } else {
                    if (v2 != 92) {
                        goto lab_0x8129ce2;
                    } else {
                        // 0x8129c3d
                        fwrite((int32_t *)"\\\\", 1, 2, TraceFP());
                        goto lab_0x8129d52;
                    }
                }
            } else {
                if (v2 == 9) {
                    // 0x8129c91
                    fwrite((int32_t *)"\\t", 1, 2, TraceFP());
                    goto lab_0x8129d52;
                } else {
                    goto lab_0x8129ce2;
                }
            }
        }
    }
  lab_0x8129d52:
    // 0x8129d52
    v1++;
    if (v1 == size) {
        return;
    }
    goto lab_0x8129bfd;
  lab_0x8129ce2:;
    int32_t c = v2; // 0x8129c03
    int16_t * v3 = *__ctype_b_loc(); // 0x8129ce7
    int32_t v4 = 2 * c; // 0x8129cec
    if ((*(int16_t *)(v4 + (int32_t)v3) & 0x4000) != 0) {
        // 0x8129d1e
        fputc(c, TraceFP());
        goto lab_0x8129d52;
    } else {
        // 0x8129d00
        if ((*(int16_t *)(v4 + (int32_t)*__ctype_b_loc()) & 0x2000) == 0) {
            // 0x8129d34
            fprintf(TraceFP(), "\\%03o", c);
            goto lab_0x8129d52;
        } else {
            // 0x8129d1e
            fputc(c, TraceFP());
            goto lab_0x8129d52;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTString.c
// Address range: 0x8129d64 - 0x8129dad
// Line range:    1347 - 1349
void trace_bstring(int32_t * data) {
    int32_t v1 = 0; // 0x8129d6e
    char * v2 = NULL; // 0x8129d6e
    if (data != NULL) {
        // 0x8129d88
        v1 = *(int32_t *)((int32_t)data + 4);
        v2 = (char *)*data;
    }
    // 0x8129d99
    trace_bstring2(v2, v1);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTRules.c
// Address range: 0x812a069 - 0x812a1c5
// Line range:    166 - 190
char rule_cond_ok(int32_t * r) {
    int32_t v1 = (int32_t)r;
    int32_t * str2 = (int32_t *)(v1 + 16); // 0x812a073
    int32_t str = *str2; // 0x812a073
    if (str == 0) {
        // 0x812a1bb
        return 1;
    }
    // 0x812a083
    if (strcmp((char *)str, "if") != 0) {
        // 0x812a09d
        if (strcmp((char *)*str2, "unless") != 0) {
            // 0x812a0b7
            if (WWW_TraceFlag != 0) {
                // 0x812a0c2
                fprintf(TraceFP(), "....... rule ignored, unrecognized `%s'!\n", (char *)*str2);
            }
            // 0x812a1bb
            return 0;
        }
    }
    int32_t * str3 = (int32_t *)(v1 + 20); // 0x812a0ef
    char v2; // 0x812a069
    if (strcmp((char *)*str3, "redirected") != 0) {
        // 0x812a115
        if (strcmp((char *)*str3, "userspec") != 0) {
            // 0x812a13b
            if (WWW_TraceFlag != 0) {
                int32_t v3 = *str3; // 0x812a149
                char * v4 = v3 == 0 ? "(null)" : (char *)v3;
                fprintf(TraceFP(), "....... rule ignored, unrecognized `%s %s'!\n", (char *)*str2, v4);
            }
            // 0x812a1bb
            return 0;
        }
        // 0x812a12f
        v2 = LYUserSpecifiedURL;
    } else {
        int32_t v5 = redirection_attempts; // 0x812a106
        v2 = v5 >= 0 == (v5 != 0);
    }
    char result = v2; // 0x812a1a8
    if (strcmp((char *)*str2, "if") != 0) {
        // 0x812a1b3
        result = v2 == 0;
    }
    // 0x812a1bb
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTRules.c
// Address range: 0x812a1c5 - 0x812ab3d
// Line range:    212 - 439
char * HTTranslate(char * required) {
    int32_t * r = NULL; // bp-20, 0x812a1d0
    int32_t * r2 = NULL; // bp-24, 0x812a1d7
    HTSACopy((char **)&r, required);
    HTAA_clearProtections();
    if (rules == NULL) {
        // 0x812ab30
        return (char *)r;
    }
    int32_t v1 = (int32_t)rules; // 0x812aac8
    char * v2 = NULL; // 0x812a1c5
    char * v3 = NULL;
    char * v4; // 0x812a1c5
    char v5; // 0x812a1c5
    char * v6; // 0x812a1c5
    char * v7; // 0x812a1c5
    char * v8; // 0x812a1c5
    char * v9; // 0x812a1c5
    int32_t v10; // 0x812a1c5
    int32_t v11; // 0x812a1c5
    int32_t v12; // 0x812a1c5
    int32_t v13; // 0x812a1c5
    while (true) {
      lab_0x812a210:
        // 0x812a210
        v8 = v3;
        v9 = v2;
        v13 = v1;
        int32_t v14 = *(int32_t *)(v13 + 8); // 0x812a213
        int32_t * v15 = r; // 0x812a220
        int32_t v16 = (int32_t)v15; // 0x812a220
        char * v17 = (char *)v14; // 0x812a243
        char v18 = *v17; // 0x812a243
        v12 = v16;
        v6 = v17;
        if (v18 == 0) {
            goto lab_0x812a254_2;
        } else {
            char v19 = *(char *)v15; // 0x812a24d
            int32_t v20 = v14; // 0x812a252
            int32_t v21 = v16; // 0x812a252
            v5 = v18;
            v4 = v17;
            v11 = v16;
            v10 = v14;
            v7 = (char *)v15;
            if (v19 == 0 || v18 != v19) {
                goto lab_0x812a254;
            } else {
                int32_t v22 = v20 + 1; // 0x812a238
                int32_t v23 = v21 + 1; // 0x812a23c
                char * v24 = (char *)v22;
                char v25 = *v24; // 0x812a243
                v12 = v23;
                v6 = v24;
                while (v25 != 0) {
                    char * v26 = (char *)v23;
                    char v27 = *v26; // 0x812a24d
                    v20 = v22;
                    v21 = v23;
                    v5 = v25;
                    v4 = v24;
                    v11 = v23;
                    v10 = v22;
                    v7 = v26;
                    if (v27 == 0 || v25 != v27) {
                        goto lab_0x812a254;
                    }
                    v22 = v20 + 1;
                    v23 = v21 + 1;
                    v24 = (char *)v22;
                    v25 = *v24;
                    v12 = v23;
                    v6 = v24;
                }
                goto lab_0x812a254_2;
            }
        }
    }
  lab_0x812aad7:
    if (v3 == NULL) {
        // 0x812ab30
        return (char *)r;
    }
    int32_t v28 = 0; // bp-68, 0x812aadd
    HTSACopy((char **)&v28, "NoProxy=");
    HTSACat((char **)&v28, (char *)r);
    if (r != NULL) {
        // 0x812ab10
        free(r);
        r = NULL;
    }
    char * result = (char *)v28; // 0x812ab28
  lab_0x812ab30:
    // 0x812ab30
    return result;
  lab_0x812a254:;
    char * str = v7;
    char * v29 = v4;
    char * v30 = str; // 0x812a25c
    char * v31 = v29; // 0x812a25c
    char v32 = v5; // 0x812a25c
    char * v33; // 0x812a1c5
    char * v34; // 0x812a1c5
    char * v35; // 0x812a1c5
    int32_t v36; // 0x812a1c5
    if (v5 != 42) {
        goto lab_0x812a2ae;
    } else {
        int32_t len = strlen(str); // 0x812a264
        char * str2 = (char *)(v10 + 1); // 0x812a274
        int32_t v37 = len - strlen(str2); // 0x812a27b
        v35 = v8;
        v2 = v9;
        if (v37 < 0) {
            goto lab_0x812aac5;
        } else {
            int32_t strcmp_rc = strcmp((char *)(v37 + v11), str2); // 0x812a29f
            v34 = str;
            v33 = v29;
            v36 = v37;
            v35 = v8;
            v2 = v9;
            if (strcmp_rc != 0) {
                goto lab_0x812aac5;
            } else {
                goto lab_0x812a2c2;
            }
        }
    }
  lab_0x812a254_2:
    // 0x812a254
    v30 = (char *)v12;
    v31 = v6;
    v32 = 0;
    goto lab_0x812a2ae;
  lab_0x812a2ae:
    // 0x812a2ae
    v34 = v30;
    v33 = v31;
    v36 = 0;
    v35 = v8;
    v2 = v9;
    if (v32 != *v30) {
        goto lab_0x812aac5;
    } else {
        goto lab_0x812a2c2;
    }
  lab_0x812aac5:
    // 0x812aac5
    v3 = v35;
    v1 = *(int32_t *)v13;
    if (v1 == 0) {
        // break -> 0x812aad7
        goto lab_0x812aad7;
    }
    goto lab_0x812a210;
  lab_0x812a2c2:
    // 0x812a2c2
    v35 = v8;
    v2 = v9;
    char * v38; // 0x812a1c5
    char * v39; // 0x812a1c5
    int32_t v40; // 0x812a1c5
    int32_t * v41; // 0x812a2d8
    int32_t * v42; // 0x812a1c5
    if (rule_cond_ok((int32_t *)v13) == 0) {
        goto lab_0x812aac5;
    } else {
        // 0x812a2d5
        v40 = v36;
        v38 = v33;
        v39 = v34;
        v41 = (int32_t *)(v13 + 4);
        int32_t v43 = *v41; // 0x812a2d8
        g366 = v43;
        v35 = v8;
        v2 = v9;
        switch (v43) {
            case 0: {
                goto lab_0x812aa7a;
            }
            case 1: {
                goto lab_0x812a64e;
            }
            case 2: {
                // 0x812a5bb
                if (*(int32_t *)(v13 + 12) == 0) {
                    if (v8 == NULL) {
                        goto lab_0x812a61a;
                    } else {
                        // 0x812a5cf
                        v28 = 0;
                        HTSACopy((char **)&v28, "NoProxy=");
                        HTSACat((char **)&v28, (char *)r);
                        int32_t * v44 = r; // 0x812a5fb
                        if (v44 == NULL) {
                            // 0x812a614
                            r = (int32_t *)v28;
                            goto lab_0x812a61a;
                        } else {
                            // 0x812a602
                            free(v44);
                            r = NULL;
                            // 0x812a614
                            r = (int32_t *)v28;
                            goto lab_0x812a61a;
                        }
                    }
                }
                goto lab_0x812a64e;
            }
            case 3: {
                goto lab_0x812aa7a;
            }
            case 4: {
                goto lab_0x812a2f4;
            }
            case 5: {
                goto lab_0x812a2f4;
            }
            case 6: {
                // 0x812a484
                LYFixCursesOn("show rule message:");
                goto lab_0x812a490;
            }
            case 7: {
                // 0x812a484
                LYFixCursesOn("show rule message:");
                goto lab_0x812a490;
            }
            case 8: {
                // 0x812a43f
                LYFixCursesOn("show rule message:");
                int32_t v45 = *(int32_t *)(v13 + 12); // 0x812a454
                HTUserMsg2(v45 == 0 ? "Rule: %s" : (char *)v45, (char *)r);
                v35 = v8;
                v2 = v9;
                goto lab_0x812aac5;
            }
            case 9: {
                // 0x812a484
                LYFixCursesOn("show rule message:");
                goto lab_0x812a490;
            }
            case 10: {
                goto lab_0x812a490;
            }
            case 11: {
                goto lab_0x812a64e;
            }
            case 12: {
                goto lab_0x812a64e;
            }
            case 13: {
                // 0x812a589
                v35 = v8;
                v2 = (char *)1;
                if (WWW_TraceFlag != 0) {
                    // 0x812a59f
                    fprintf(TraceFP(), "HTRule: Mark for redirection permitted\n");
                    v35 = v8;
                    v2 = (char *)1;
                }
                goto lab_0x812aac5;
            }
            case 14: {
                // 0x812a91c
                v42 = (int32_t *)(v13 + 12);
                int32_t v46 = *v42; // 0x812a91f
                if (v46 == 0) {
                    goto lab_0x812a975;
                } else {
                    // 0x812a926
                    if (strcasecomp((char *)v46, "none") != 0) {
                        goto lab_0x812a975;
                    } else {
                        // 0x812a940
                        v35 = (char *)1;
                        v2 = v9;
                        if (WWW_TraceFlag != 0) {
                            // 0x812a94b
                            fprintf(TraceFP(), "For `%s' will not use proxy\n", r);
                            v35 = (char *)1;
                            v2 = v9;
                        }
                        goto lab_0x812aac5;
                    }
                }
            }
            default: {
                goto lab_0x812aac5;
            }
        }
    }
  lab_0x812aa7a:
    // 0x812aa7a
    if (WWW_TraceFlag != 0) {
        // 0x812aa85
        fprintf(TraceFP(), "HTRule: *** FAIL `%s'\n", r);
    }
    // 0x812aaa3
    if (r != NULL) {
        // 0x812aaaa
        free(r);
        r = NULL;
    }
    // 0x812ab30
    return NULL;
  lab_0x812a64e:
    // 0x812a64e
    if (*v38 != *v39) {
        int32_t * str3 = (int32_t *)(v13 + 12); // 0x812a6ae
        char * found_char_pos = strchr((char *)*str3, 42); // 0x812a6bc
        v28 = 0;
        if (found_char_pos == NULL) {
            // 0x812a76a
            HTSACopy((char **)&v28, (char *)*str3);
            if (WWW_TraceFlag != 0) {
                // 0x812a791
                fprintf(TraceFP(), "For `%s' using `%s'\n", r, (char *)v28);
            }
            int32_t * v47 = r; // 0x812a7b6
            if (v47 != NULL) {
                // 0x812a7bd
                free(v47);
                r = NULL;
            }
            // 0x812a7cf
            r = (int32_t *)v28;
        } else {
            int32_t v48 = (int32_t)found_char_pos; // 0x812a6bc
            int32_t v49 = *str3; // 0x812a6de
            HTSprintf0((char **)&v28, "%.*s%.*s%s", v48 - v49, (char *)v49, v40, v39, (char *)(v48 + 1));
            if (WWW_TraceFlag != 0) {
                // 0x812a724
                fprintf(TraceFP(), "For `%s' using `%s'\n", r, (char *)v28);
            }
            int32_t * v50 = r; // 0x812a749
            if (v50 != NULL) {
                // 0x812a750
                free(v50);
                r = NULL;
            }
            // 0x812a762
            r = (int32_t *)v28;
        }
    } else {
        int32_t * v51 = (int32_t *)(v13 + 12);
        if (WWW_TraceFlag != 0) {
            // 0x812a669
            fprintf(TraceFP(), "For `%s' using `%s'\n", r, (char *)*v51);
        }
        // 0x812a691
        HTSACopy((char **)&r, (char *)*v51);
    }
    int32_t v52 = *v41; // 0x812a7d8
    if (v52 == 2) {
        if (v8 == NULL) {
            goto lab_0x812a835;
        } else {
            // 0x812a7ea
            v28 = 0;
            HTSACopy((char **)&v28, "NoProxy=");
            HTSACat((char **)&v28, (char *)r);
            int32_t * v53 = r; // 0x812a816
            if (v53 == NULL) {
                // 0x812a82f
                r = (int32_t *)v28;
                goto lab_0x812a835;
            } else {
                // 0x812a81d
                free(v53);
                r = NULL;
                // 0x812a82f
                r = (int32_t *)v28;
                goto lab_0x812a835;
            }
        }
    }
    if (v52 == 11) {
        // 0x812a874
        if (WWW_TraceFlag == 0) {
            goto lab_0x812a89d;
        } else {
            // 0x812a87f
            fprintf(TraceFP(), "HTRule: ...and redirect to `%s'\n", r);
            goto lab_0x812a89d;
        }
    }
    // 0x812a8bd
    v35 = v8;
    v2 = v9;
    if (v52 == 12) {
        // 0x812a8cc
        if (WWW_TraceFlag == 0) {
            goto lab_0x812a8f5;
        } else {
            // 0x812a8d7
            fprintf(TraceFP(), "HTRule: ...and redirect like 301 to `%s'\n", r);
            goto lab_0x812a8f5;
        }
    }
    goto lab_0x812aac5;
  lab_0x812a2f4:;
    int32_t v54 = 0; // bp-52, 0x812a2f4
    int32_t * v55 = (int32_t *)(v13 + 12);
    if (WWW_TraceFlag != 0) {
        int32_t v56 = *v55; // 0x812a31b
        int32_t v57 = *v41;
        int32_t v58 = v56; // 0x812a320
        if (v56 == 0) {
            // 0x812a32d
            v58 = v57 != 5 ? (int32_t)"NULL!!" : (int32_t)"DEFAULT";
        }
        char * v59 = v57 != 5 ? "DefProt" : "Protect";
        fprintf(TraceFP(), "HTRule: `%s' matched %s %s: `%s'\n", r, v59, "rule, setup", (char *)v58);
    }
    int32_t v60 = *v55; // 0x812a3a0
    char * v61 = NULL; // 0x812a3a5
    char * v62 = NULL; // 0x812a3a5
    if (v60 != 0) {
        // 0x812a3a7
        HTSACopy((char **)&v54, (char *)v60);
        v28 = v54;
        char * v63 = HTNextField((char **)&v28); // 0x812a3c8
        v61 = HTNextField((char **)&v28);
        v62 = v63;
    }
    char * v64 = v62;
    char * v65 = v61;
    int32_t * v66 = r;
    if (*v41 != 5) {
        // 0x812a404
        HTAA_setDefaultProtection((char *)v66, v64, v65);
    } else {
        // 0x812a3e9
        HTAA_setCurrentProtection((char *)v66, v64, v65);
    }
    int32_t v67 = v54; // 0x812a41d
    v35 = v8;
    v2 = v9;
    if (v67 != 0) {
        // 0x812a428
        free((int32_t *)v67);
        v54 = 0;
        v35 = v8;
        v2 = v9;
    }
    goto lab_0x812aac5;
  lab_0x812a490:;
    int32_t v68 = *(int32_t *)(v13 + 12); // 0x812a493
    int32_t v69 = v68; // 0x812a498
    if (v68 == 0) {
        // 0x812a4a5
        v69 = *v41 != 10 ? (int32_t)"Rule: %s" : (int32_t)"%s";
    }
    char * str4 = (char *)v69; // 0x812a4c6
    char * found_char_pos2 = strchr(str4, 37); // 0x812a4da
    char * v70 = str4; // 0x812a4e1
    if (found_char_pos2 != NULL) {
        // 0x812a4e3
        HTSprintf0((char **)&r2, str4);
        v70 = (char *)r2;
    }
    char * v71 = v70;
    uint32_t v72 = *v41; // 0x812a505
    if (v72 == 7) {
        // 0x812a52d
        HTInfoMsg(v71);
    } else {
        if (v72 < 8) {
            if (v72 == 6) {
                // 0x812a53a
                HTProgress(v71);
            }
        } else {
            switch (v72) {
                case 9: {
                    // 0x812a547
                    HTAlert(v71);
                    // break -> 0x812a567
                    break;
                }
                case 10: {
                    // 0x812a554
                    HTAlwaysAlert("Rule alert:", v71);
                    // break -> 0x812a567
                    break;
                }
            }
        }
    }
    // 0x812a567
    v35 = v8;
    v2 = v9;
    if (r2 != NULL) {
        // 0x812a572
        free(r2);
        r2 = NULL;
        v35 = v8;
        v2 = v9;
    }
    goto lab_0x812aac5;
  lab_0x812a975:
    if (v8 == NULL) {
        // 0x812a9d0
        v28 = 0;
        HTSACopy((char **)&v28, "Proxied=");
        HTSACat((char **)&v28, (char *)*v42);
        HTSACat((char **)&v28, (char *)r);
        if (WWW_TraceFlag == 0) {
            goto lab_0x812aa56;
        } else {
            int32_t v73 = *v42; // 0x812aa1f
            fprintf(TraceFP(), "HTRule: proxy server found: %s\n", v73 == 0 ? "(null)" : (char *)v73);
            goto lab_0x812aa56;
        }
    }
    // 0x812a97b
    v35 = v8;
    v2 = v9;
    if (WWW_TraceFlag != 0) {
        int32_t v74 = *v42; // 0x812a98d
        char * v75 = v74 == 0 ? "(null)" : (char *)v74;
        fprintf(TraceFP(), "For `%s' proxy server ignored: %s\n", r, v75);
        v35 = v8;
        v2 = v9;
    }
    goto lab_0x812aac5;
  lab_0x812a61a:
    // 0x812a61a
    if (WWW_TraceFlag == 0) {
        // 0x812a643
        result = (char *)r;
        goto lab_0x812ab30;
    } else {
        // 0x812a625
        fprintf(TraceFP(), "HTRule: Pass `%s'\n", r);
        // 0x812a643
        result = (char *)r;
        goto lab_0x812ab30;
    }
  lab_0x812aa56:
    // 0x812aa56
    if (r == NULL) {
        // 0x812aa6f
        result = (char *)v28;
        goto lab_0x812ab30;
    } else {
        // 0x812aa5d
        free(r);
        r = NULL;
        // 0x812aa6f
        result = (char *)v28;
        goto lab_0x812ab30;
    }
  lab_0x812a835:
    // 0x812a835
    if (WWW_TraceFlag == 0) {
        // 0x812a85e
        result = (char *)r;
        goto lab_0x812ab30;
    } else {
        // 0x812a840
        fprintf(TraceFP(), "HTRule: ...and pass `%s'\n", r);
        // 0x812a85e
        result = (char *)r;
        goto lab_0x812ab30;
    }
  lab_0x812a89d:
    // 0x812a89d
    redirecting_url = (int32_t)r;
    HTPermitRedir = v9 == (char *)1;
    result = NULL;
    goto lab_0x812ab30;
  lab_0x812a8f5:
    // 0x812a8f5
    redirecting_url = (int32_t)r;
    permanent_redirection = 1;
    HTPermitRedir = v9 == (char *)1;
    result = NULL;
    goto lab_0x812ab30;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812b744 - 0x812b94f
// Line range:    98 - 145
void HTSetPresentation(char * representation, char * command, char * testcommand, float64_t quality, float64_t secs, float64_t secs_per_byte, int32_t maxbytes, int32_t media) {
    int32_t * mem = calloc(1, 48); // 0x812b77d
    if (mem == NULL) {
        // 0x812b78b
        outofmem("../../../WWW/Library/Implementation/HTFormat.c", "HTSetPresentation");
        // UNREACHABLE
    }
    // 0x812b79f
    if (WWW_TraceFlag != 0) {
        // 0x812b7aa
        if ((WWW_TraceMask & 8) != 0) {
            char * v1 = testcommand == NULL ? (char *)&g82 : testcommand;
            char * v2 = command == NULL ? (char *)&g82 : command; // 0x812b808
            char * v3 = representation == NULL ? (char *)&g82 : representation;
            fprintf(TraceFP(), "HTSetPresentation rep=%s, command=%s, test=%s, qual=%f\n", v3, v2, v1, quality);
        }
    }
    // 0x812b828
    *mem = (int32_t)HTAtom_for(representation);
    int32_t * v4 = HTAtom_for("www/present"); // 0x812b841
    int32_t v5 = (int32_t)mem; // 0x812b848
    *(int32_t *)(v5 + 4) = (int32_t)v4;
    *(int32_t *)(v5 + 8) = 0x80d0a01;
    *(float32_t *)(v5 + 20) = (float32_t)quality;
    *(float32_t *)(v5 + 24) = (float32_t)secs_per_byte;
    *(float32_t *)(v5 + 28) = (float32_t)(float64_t)(int64_t)media;
    int32_t v6; // 0x812b744
    *(int32_t *)(v5 + 36) = v6 >> 31;
    *(char *)(v5 + 40) = 0;
    int32_t v7 = v5 + 12; // 0x812b8a9
    *(int32_t *)v7 = 0;
    HTSACopy((char **)v7, command);
    int32_t v8 = v5 + 16; // 0x812b8c8
    *(int32_t *)v8 = 0;
    HTSACopy((char **)v8, testcommand);
    if (HTPresentations == NULL) {
        int32_t * v9 = HTList_new(); // 0x812b8ed
        *(int32_t *)&HTPresentations = (int32_t)v9;
    }
    // 0x812b8f7
    if (strcmp(representation, "*") != 0) {
        // 0x812b938
        HTList_addObject(HTPresentations, (char *)mem);
        // 0x812b94d
        return;
    }
    // 0x812b90e
    if (default_presentation != NULL) {
        // 0x812b917
        free(default_presentation);
        *(int32_t *)&default_presentation = 0;
    }
    // 0x812b92e
    *(int32_t *)&default_presentation = v5;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812b94f - 0x812baa1
// Line range:    158 - 195
void HTSetConversion(char * representation_in, char * representation_out, int32_t * (*converter)(int32_t, int32_t *, int32_t *), float32_t quality, float32_t secs, float32_t secs_per_byte, int32_t maxbytes, int32_t media) {
    int32_t * mem = calloc(1, 48); // 0x812b964
    if (mem == NULL) {
        // 0x812b972
        outofmem("../../../WWW/Library/Implementation/HTFormat.c", "HTSetConversion");
        // UNREACHABLE
    }
    // 0x812b986
    if (WWW_TraceFlag != 0) {
        // 0x812b991
        if ((WWW_TraceMask & 8) != 0) {
            char * v1 = representation_out == NULL ? (char *)&g82 : representation_out;
            char * v2 = representation_in == NULL ? (char *)&g82 : representation_in; // 0x812b9e0
            fprintf(TraceFP(), "HTSetConversion rep_in=%s, rep_out=%s, qual=%f\n", v2, v1, (float64_t)quality);
        }
    }
    // 0x812b9f9
    *mem = (int32_t)HTAtom_for(representation_in);
    int32_t * v3 = HTAtom_for(representation_out); // 0x812ba11
    int32_t v4 = (int32_t)mem; // 0x812ba18
    *(int32_t *)(v4 + 4) = (int32_t)v3;
    *(int32_t *)(v4 + 8) = (int32_t)converter;
    *(int32_t *)(v4 + 12) = 0;
    *(int32_t *)(v4 + 16) = 0;
    *(int32_t *)(v4 + 20) = (int32_t)quality;
    *(int32_t *)(v4 + 24) = (int32_t)secs;
    *(int32_t *)(v4 + 28) = (int32_t)secs_per_byte;
    *(int32_t *)(v4 + 32) = maxbytes;
    *(int32_t *)(v4 + 36) = maxbytes >> 31;
    *(char *)(v4 + 40) = 1;
    *(int32_t *)(v4 + 44) = media;
    int32_t * v5 = HTPresentations; // 0x812ba7e
    if (HTPresentations == NULL) {
        // 0x812ba80
        v5 = HTList_new();
        *(int32_t *)&HTPresentations = (int32_t)v5;
    }
    // 0x812ba8a
    HTList_addObject(v5, (char *)mem);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812bbd4 - 0x812bc7c
// Line range:    330 - 345
int32_t half_match(char * trial_type, char * target) {
    char * found_char_pos = strchr(trial_type, 47); // 0x812bbe8
    if (found_char_pos == NULL) {
        // 0x812bc77
        return 0;
    }
    int32_t v1 = (int32_t)found_char_pos; // 0x812bbe8
    if (*(char *)(v1 + 1) != 42) {
        // 0x812bc77
        return 0;
    }
    // 0x812bc0c
    if (WWW_TraceFlag != 0) {
        // 0x812bc17
        fprintf(TraceFP(), "HTFormat: comparing %s and %s for half match\n", trial_type, target);
    }
    // 0x812bc77
    return strncmp(trial_type, target, v1 + -1 - (int32_t)trial_type) == 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812bc7c - 0x812bcb8
// Line range:    352 - 359
char failsMailcap(int32_t * pres, int32_t * anchor) {
    int32_t v1 = *(int32_t *)((int32_t)pres + 16); // 0x812bc85
    if (v1 != 0) {
        int32_t v2 = *(int32_t *)((int32_t)anchor + 112); // 0x812bc8f
        if (LYTestMailcapCommand((char *)v1, (char *)v2) != 0) {
            // 0x812bcb2
            return 1;
        }
    }
    // 0x812bcb2
    return 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812bcb8 - 0x812c072
// Line range:    378 - 480
int32_t * HTFindPresentation(int32_t * rep_in, int32_t * rep_out, int32_t * fill_in, int32_t * anchor) {
    int32_t v1 = (int32_t)rep_out;
    int32_t v2 = (int32_t)rep_in;
    if (WWW_TraceFlag != 0) {
        int32_t v3 = *(int32_t *)(v1 + 4); // 0x812bcf1
        int32_t v4 = *(int32_t *)(v2 + 4); // 0x812bcf7
        fprintf(TraceFP(), "HTFormat: Looking up presentation for %s to %s\n", (char *)v4, (char *)v3);
    }
    int32_t v5 = HTList_count(HTPresentations); // 0x812bd21
    int32_t * v6 = NULL; // 0x812bfae
    int32_t * v7 = NULL; // 0x812bfae
    int32_t * v8; // 0x812bcb8
    int32_t * v9; // 0x812bcb8
    int32_t * v10; // 0x812bcb8
    int32_t * v11; // 0x812bcb8
    int32_t * v12; // 0x812bcb8
    int32_t * v13; // 0x812bcb8
    int32_t * v14; // 0x812bcb8
    int32_t v15; // 0x812bcb8
    int32_t v16; // 0x812bcb8
    int32_t v17; // 0x812bcb8
    int32_t v18; // 0x812bcb8
    int32_t * v19; // 0x812bcb8
    int32_t * v20; // 0x812bcb8
    int32_t * v21; // 0x812bcb8
    int32_t * v22; // 0x812bcb8
    int32_t * v23; // 0x812bcb8
    int32_t v24; // 0x812bd3b
    char * v25; // 0x812bd45
    int32_t v26; // 0x812bcb8
    int32_t * v27; // 0x812bcb8
    int32_t * v28; // 0x812bcb8
    int32_t * v29; // 0x812bcb8
    int32_t * v30; // 0x812bcb8
    if (v5 > 0) {
        // 0x812bd35
        v19 = NULL;
        v17 = 0;
        v14 = NULL;
        v9 = NULL;
        v22 = NULL;
        v30 = NULL;
        while (true) {
          lab_0x812bd35:;
            int32_t * v31 = v30;
            v23 = v22;
            v10 = v9;
            int32_t * v32 = v14;
            int32_t v33 = v17;
            v24 = (int32_t)v19;
            v25 = HTList_objectAt(HTPresentations, v24);
            v26 = (int32_t)v25;
            int32_t v34 = *(int32_t *)v25; // 0x812bd50
            if (v34 != v2) {
                // 0x812be5e
                v28 = v31;
                v21 = v23;
                v8 = v10;
                v12 = v32;
                v16 = v33;
                if (fill_in == NULL) {
                    goto lab_0x812bfa4;
                } else {
                    int32_t v35 = *(int32_t *)(v2 + 4); // 0x812be6b
                    v27 = v31;
                    v11 = v32;
                    v15 = v33;
                    if (half_match((char *)*(int32_t *)(v34 + 4), (char *)v35) == 0) {
                        goto lab_0x812bef2;
                    } else {
                        int32_t * v36 = (int32_t *)(v26 + 4); // 0x812be89
                        if (*v36 != v1) {
                            goto lab_0x812bef2;
                        } else {
                            // 0x812be91
                            v28 = v31;
                            v21 = v23;
                            v8 = v10;
                            v12 = v32;
                            v16 = v33;
                            if (failsMailcap((int32_t *)v25, anchor) != 0) {
                                goto lab_0x812bfa4;
                            } else {
                                int32_t * v37 = v31 != NULL ? v31 : (int32_t *)v25;
                                v27 = v37;
                                v11 = v32;
                                v15 = v33;
                                if (WWW_TraceFlag != 0) {
                                    int32_t v38 = *(int32_t *)(*v36 + 4); // 0x812bec8
                                    int32_t v39 = *(int32_t *)(*(int32_t *)v25 + 4); // 0x812bed0
                                    fprintf(TraceFP(), "StreamStack: found strong subtype wildcard match: %s -> %s\n", (char *)v39, (char *)v38);
                                    v27 = v37;
                                    v11 = v32;
                                    v15 = v33;
                                }
                                goto lab_0x812bef2;
                            }
                        }
                    }
                }
            } else {
                int32_t * v40 = (int32_t *)(v26 + 4);
                int32_t v41 = *v40; // 0x812bd5e
                if (v41 != v1) {
                    // 0x812bdc6
                    v28 = v31;
                    v21 = v23;
                    v8 = v10;
                    v12 = v32;
                    v16 = v33;
                    if (fill_in == NULL) {
                        goto lab_0x812bfa4;
                    } else {
                        int32_t v42 = v41; // 0x812bdd4
                        int32_t v43 = v33; // 0x812bdd4
                        if (v33 == 0) {
                            int32_t * v44 = HTAtom_for("*"); // 0x812bddd
                            v42 = *v40;
                            v43 = (int32_t)v44;
                        }
                        int32_t v45 = v43;
                        v27 = v31;
                        v11 = v32;
                        v15 = v45;
                        if (v42 != v45) {
                            goto lab_0x812bef2;
                        } else {
                            // 0x812bdf4
                            v28 = v31;
                            v21 = v23;
                            v8 = v10;
                            v12 = v32;
                            v16 = v45;
                            if (failsMailcap((int32_t *)v25, anchor) != 0) {
                                goto lab_0x812bfa4;
                            } else {
                                int32_t * v46 = v32 != NULL ? v32 : (int32_t *)v25;
                                v27 = v31;
                                v11 = v46;
                                v15 = v45;
                                if (WWW_TraceFlag != 0) {
                                    int32_t v47 = *(int32_t *)(*v40 + 4); // 0x812be2f
                                    int32_t v48 = *(int32_t *)(*(int32_t *)v25 + 4); // 0x812be37
                                    fprintf(TraceFP(), "StreamStack: found strong wildcard match: %s -> %s\n", (char *)v48, (char *)v47);
                                    v27 = v31;
                                    v11 = v46;
                                    v15 = v45;
                                }
                                goto lab_0x812bef2;
                            }
                        }
                    }
                } else {
                    // 0x812bd66
                    v28 = v31;
                    v21 = v23;
                    v8 = v10;
                    v12 = v32;
                    v16 = v33;
                    if (failsMailcap((int32_t *)v25, anchor) == 0) {
                        // 0x812bd80
                        v18 = v26;
                        if (WWW_TraceFlag == 0) {
                            return (int32_t *)v18;
                        } else {
                            int32_t v49 = *(int32_t *)(*v40 + 4); // 0x812bd91
                            int32_t v50 = *(int32_t *)(*(int32_t *)v25 + 4); // 0x812bd99
                            fprintf(TraceFP(), "FindPresentation: found exact match: %s -> %s\n", (char *)v50, (char *)v49);
                            v18 = v26;
                            return (int32_t *)v18;
                        }
                    }
                    goto lab_0x812bfa4;
                }
            }
        }
      lab_0x812bfb4:
        // 0x812bfb4
        v20 = v29;
        if (v29 != NULL) {
            goto lab_0x812bff0;
        } else {
            // 0x812bfba
            v20 = v13;
            if (v13 != NULL) {
                goto lab_0x812bff0;
            } else {
                goto lab_0x812bfc0;
            }
        }
    } else {
        goto lab_0x812bfc0;
    }
  lab_0x812bfa4:
    // 0x812bfa4
    v13 = v12;
    v7 = v8;
    v6 = v21;
    v29 = v28;
    int32_t * v51 = (int32_t *)(v24 + 1); // 0x812bfa4
    v19 = v51;
    v17 = v16;
    v14 = v13;
    v9 = v7;
    v22 = v6;
    v30 = v29;
    if (v51 >= (int32_t *)v5) {
        // break -> 0x812bfb4
        goto lab_0x812bfb4;
    }
    goto lab_0x812bd35;
  lab_0x812bef2:;
    int32_t v52 = v15;
    int32_t * v53 = v11;
    int32_t * v54 = v27;
    v28 = v54;
    v21 = v23;
    v8 = v10;
    v12 = v53;
    v16 = v52;
    if (*(int32_t *)v25 == (int32_t)WWW_SOURCE) {
        int32_t * v55 = (int32_t *)(v26 + 4); // 0x812bf07
        int32_t v56 = *v55; // 0x812bf07
        if (v56 != v1) {
            // 0x812bf62
            v28 = v54;
            v21 = v23;
            v8 = v10;
            v12 = v53;
            v16 = v52;
            if (v23 == NULL) {
                int32_t v57 = v56; // 0x812bf6c
                int32_t v58 = v52; // 0x812bf6c
                if (v52 == 0) {
                    int32_t * v59 = HTAtom_for("*"); // 0x812bf75
                    v57 = *v55;
                    v58 = (int32_t)v59;
                }
                int32_t v60 = v58;
                v28 = v54;
                v21 = v23;
                v8 = v10;
                v12 = v53;
                v16 = v60;
                if (v57 == v60) {
                    int32_t * v61 = failsMailcap((int32_t *)v25, anchor) != 0 ? v23 : (int32_t *)v25;
                    v28 = v54;
                    v21 = v61;
                    v8 = v10;
                    v12 = v53;
                    v16 = v60;
                }
            }
        } else {
            // 0x812bf0f
            v28 = v54;
            v21 = v23;
            v8 = v10;
            v12 = v53;
            v16 = v52;
            if (failsMailcap((int32_t *)v25, anchor) == 0) {
                int32_t * v62 = v10 != NULL ? v10 : (int32_t *)v25;
                v28 = v54;
                v21 = v23;
                v8 = v62;
                v12 = v53;
                v16 = v52;
                if (WWW_TraceFlag != 0) {
                    int32_t v63 = *(int32_t *)(*v55 + 4); // 0x812bf42
                    fprintf(TraceFP(), "StreamStack: found weak wildcard match: %s\n", (char *)v63);
                    v28 = v54;
                    v21 = v23;
                    v8 = v62;
                    v12 = v53;
                    v16 = v52;
                }
            }
        }
    }
    goto lab_0x812bfa4;
  lab_0x812bfc0:;
    int32_t * v64 = v7;
    int32_t * v65 = v64 == NULL ? v6 : v64;
    v20 = v65;
    goto lab_0x812bff0;
  lab_0x812bff0:
    // 0x812bff0
    v18 = 0;
    if (v20 != NULL) {
        int32_t v66 = (int32_t)fill_in;
        int32_t v67 = (int32_t)v20;
        *fill_in = *v20;
        int32_t * v68 = (int32_t *)(v66 + 4); // 0x812c009
        *v68 = *(int32_t *)(v67 + 4);
        *(int32_t *)(v66 + 8) = *(int32_t *)(v67 + 8);
        *(int32_t *)(v66 + 12) = *(int32_t *)(v67 + 12);
        *(int32_t *)(v66 + 16) = *(int32_t *)(v67 + 16);
        *(int32_t *)(v66 + 20) = *(int32_t *)(v67 + 20);
        *(int32_t *)(v66 + 24) = *(int32_t *)(v67 + 24);
        *(int32_t *)(v66 + 28) = *(int32_t *)(v67 + 28);
        *(int32_t *)(v66 + 32) = *(int32_t *)(v67 + 32);
        *(int32_t *)(v66 + 36) = *(int32_t *)(v67 + 36);
        *(int32_t *)(v66 + 40) = *(int32_t *)(v67 + 40);
        *(int32_t *)(v66 + 44) = *(int32_t *)(v67 + 44);
        *fill_in = v2;
        *v68 = v1;
        v18 = v66;
    }
    // 0x812c068
    return (int32_t *)v18;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812c072 - 0x812c276
// Line range:    496 - 540
int32_t * HTStreamStack(int32_t * rep_in, int32_t * rep_out, int32_t * sink, int32_t * anchor) {
    // 0x812c072
    if (WWW_TraceFlag != 0) {
        int32_t v1 = *(int32_t *)((int32_t)anchor + 112); // 0x812c088
        char * v2 = v1 == 0 ? "(null)" : (char *)v1;
        int32_t v3 = *(int32_t *)((int32_t)rep_out + 4); // 0x812c0a4
        int32_t v4 = *(int32_t *)((int32_t)rep_in + 4); // 0x812c0aa
        fprintf(TraceFP(), "HTFormat: Constructing stream stack for %s to %s (%s)\n", (char *)v4, (char *)v3, v2);
    }
    int32_t * result2 = sink; // 0x812c0d9
    if (rep_out != rep_in) {
        // 0x812c0e6
        int32_t v5; // bp-68, 0x812c072
        int32_t * result = HTFindPresentation(rep_in, rep_out, &v5, anchor); // 0x812c101
        result2 = NULL;
        if (result != NULL) {
            // 0x812c113
            if (result != &v5) {
                // 0x812c149
                if (WWW_TraceFlag == 0) {
                    // 0x812c26c
                    return result;
                }
                int32_t v6 = *(int32_t *)(*(int32_t *)((int32_t)result + 4) + 4); // 0x812c15a
                int32_t v7 = *(int32_t *)(*result + 4); // 0x812c162
                fprintf(TraceFP(), "StreamStack: found exact match: %s -> %s\n", (char *)v7, (char *)v6);
                result2 = result;
            } else {
                // 0x812c11b
                if (WWW_TraceFlag == 0) {
                    // 0x812c26c
                    return result;
                }
                // 0x812c126
                int32_t v8; // 0x812c072
                fprintf(TraceFP(), "StreamStack: Using %s\n", (char *)*(int32_t *)(v8 + 4));
                result2 = result;
            }
        }
    }
    // 0x812c1ac
    if (WWW_TraceFlag == 0) {
        // 0x812c26c
        return result2;
    }
    if (result2 == NULL) {
        // 0x812c254
        fprintf(TraceFP(), "StreamStack: Returning NULL!\n");
        if (WWW_TraceFlag != 0) {
            // 0x812c25f
            fflush(TraceFP());
        }
        // 0x812c26c
        return NULL;
    }
    int32_t v9 = *result2; // 0x812c1c4
    if (v9 == 0) {
        // 0x812c219
        fprintf(TraceFP(), "StreamStack: Returning *unknown* stream!\n");
        // 0x812c26c
        return result2;
    }
    int32_t v10 = *(int32_t *)v9; // 0x812c1cf
    if (v10 == 0) {
        // 0x812c219
        fprintf(TraceFP(), "StreamStack: Returning *unknown* stream!\n");
        // 0x812c26c
        return result2;
    }
    // 0x812c1e4
    fprintf(TraceFP(), "StreamStack: Returning \"%s\"\n", (char *)v10);
    // 0x812c26c
    return result2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812c276 - 0x812c2d3
// Line range:    550 - 557
void HTReorderPresentation(int32_t * rep_in, int32_t * rep_out) {
    int32_t * v1 = HTFindPresentation(rep_in, rep_out, NULL, NULL); // 0x812c299
    if (v1 != NULL) {
        // 0x812c2a7
        HTList_removeObject(HTPresentations, (char *)v1);
        HTList_addObject(HTPresentations, (char *)v1);
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812c2d3 - 0x812c495
// Line range:    564 - 597
void HTFilterPresentations(void) {
    uint32_t v1 = HTList_count(HTPresentations); // 0x812c2e2
    if (WWW_TraceFlag != 0) {
        // 0x812c2f5
        fprintf(TraceFP(), "HTFilterPresentations (AcceptMedia %#x)\n", LYAcceptMedia);
    }
    if (v1 <= 0) {
        // 0x812c48f
        return;
    }
    // 0x812c322
    int3_t v2; // 0x812c2d3
    int3_t v3 = v2 - 1;
    int3_t v4 = v2 - 2;
    uint32_t v5 = 0;
    char * v6 = HTList_objectAt(HTPresentations, v5); // 0x812c332
    int32_t v7 = (int32_t)v6; // 0x812c332
    int32_t v8 = *(int32_t *)(*(int32_t *)v6 + 4); // 0x812c33f
    char * v9 = (char *)(v7 + 40); // 0x812c348
    *v9 = 0;
    char v10; // 0x812c2d3
    int32_t v11; // 0x812c2d3
    int32_t v12; // 0x812c2d3
    char * v13; // 0x812c39b
    float32_t * v14; // 0x812c3c6
    int32_t * v15; // 0x812c342
    float80_t v16; // 0x812c3de
    int32_t v17; // 0x812c415
    int32_t v18; // 0x812c469
    if ((LYAcceptMedia & *(int32_t *)(v7 + 44)) != 0) {
        // 0x812c361
        if (*(int32_t *)(v7 + 4) == (int32_t)HTAtom_for("www/present")) {
            // 0x812c37b
            if (*(int32_t *)v6 != (int32_t)WWW_SOURCE) {
                // 0x812c38d
                v13 = (char *)v8;
                if (strcasecomp(v13, "www/mime") != 0) {
                    // 0x812c3a8
                    if (strcasecomp(v13, "www/compressed") != 0) {
                        // 0x812c3c3
                        v14 = (float32_t *)(v7 + 20);
                        __frontend_reg_store_fpr(v3, (float80_t)*v14);
                        __frontend_reg_store_fpr(v4, 1.0L);
                        __frontend_reg_load_fpr(v4);
                        __frontend_reg_load_fpr(v3);
                        if ((v12 & 256) == 0) {
                            // 0x812c3d6
                            v15 = (int32_t *)v8;
                            __frontend_reg_store_fpr(v3, (float80_t)*v14);
                            __frontend_reg_store_fpr(v4, 0.0L);
                            v16 = __frontend_reg_load_fpr(v4);
                            __frontend_reg_store_fpr(v4, __frontend_reg_load_fpr(v3));
                            __frontend_reg_store_fpr(v3, v16);
                            __frontend_reg_load_fpr(v4);
                            __frontend_reg_load_fpr(v3);
                            v10 = 1;
                            if (v5 != 0) {
                                v11 = 0;
                                v17 = *(int32_t *)(*(int32_t *)HTList_objectAt(HTPresentations, v11) + 4);
                                while (strcasecomp(v13, (char *)v17) != 0) {
                                    // 0x812c46d
                                    v18 = v11 + 1;
                                    v10 = 1;
                                    if (v18 >= v5) {
                                        goto lab_0x812c475;
                                    }
                                    v11 = v18;
                                    v17 = *(int32_t *)(*(int32_t *)HTList_objectAt(HTPresentations, v11) + 4);
                                }
                                // 0x812c431
                                v10 = 0;
                                if (WWW_TraceFlag != 0) {
                                    // 0x812c440
                                    fprintf(TraceFP(), "  match %s %s\n", v15, (int32_t *)v17);
                                    v10 = 0;
                                }
                            }
                            // 0x812c475
                            *v9 = v10;
                        }
                    }
                }
            }
        }
    }
    int32_t v19 = v5 + 1; // 0x812c47f
    while (v19 != v1) {
        // 0x812c322
        v5 = v19;
        v6 = HTList_objectAt(HTPresentations, v5);
        v7 = (int32_t)v6;
        v8 = *(int32_t *)(*(int32_t *)v6 + 4);
        v9 = (char *)(v7 + 40);
        *v9 = 0;
        if ((LYAcceptMedia & *(int32_t *)(v7 + 44)) != 0) {
            // 0x812c361
            if (*(int32_t *)(v7 + 4) == (int32_t)HTAtom_for("www/present")) {
                // 0x812c37b
                if (*(int32_t *)v6 != (int32_t)WWW_SOURCE) {
                    // 0x812c38d
                    v13 = (char *)v8;
                    if (strcasecomp(v13, "www/mime") != 0) {
                        // 0x812c3a8
                        if (strcasecomp(v13, "www/compressed") != 0) {
                            // 0x812c3c3
                            v14 = (float32_t *)(v7 + 20);
                            __frontend_reg_store_fpr(v3, (float80_t)*v14);
                            __frontend_reg_store_fpr(v4, 1.0L);
                            __frontend_reg_load_fpr(v4);
                            __frontend_reg_load_fpr(v3);
                            if ((v12 & 256) == 0) {
                                // 0x812c3d6
                                v15 = (int32_t *)v8;
                                __frontend_reg_store_fpr(v3, (float80_t)*v14);
                                __frontend_reg_store_fpr(v4, 0.0L);
                                v16 = __frontend_reg_load_fpr(v4);
                                __frontend_reg_store_fpr(v4, __frontend_reg_load_fpr(v3));
                                __frontend_reg_store_fpr(v3, v16);
                                __frontend_reg_load_fpr(v4);
                                __frontend_reg_load_fpr(v3);
                                v10 = 1;
                                if (v5 != 0) {
                                    v11 = 0;
                                    v17 = *(int32_t *)(*(int32_t *)HTList_objectAt(HTPresentations, v11) + 4);
                                    while (strcasecomp(v13, (char *)v17) != 0) {
                                        // 0x812c46d
                                        v18 = v11 + 1;
                                        v10 = 1;
                                        if (v18 >= v5) {
                                            goto lab_0x812c475;
                                        }
                                        v11 = v18;
                                        v17 = *(int32_t *)(*(int32_t *)HTList_objectAt(HTPresentations, v11) + 4);
                                    }
                                    // 0x812c431
                                    v10 = 0;
                                    if (WWW_TraceFlag != 0) {
                                        // 0x812c440
                                        fprintf(TraceFP(), "  match %s %s\n", v15, (int32_t *)v17);
                                        v10 = 0;
                                    }
                                }
                                // 0x812c475
                                *v9 = v10;
                            }
                        }
                    }
                }
            }
        }
        // 0x812c47f
        v19 = v5 + 1;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812c5ca - 0x812c654
// Line range:    651 - 691
void HTDisplayPartial(void) {
    // 0x812c5ca
    if (display_partial == 0) {
        // 0x812c64e
        return;
    }
    int32_t v1 = LYGetNewline(); // 0x812c5dc
    int32_t v2 = v1 - 1;
    uint32_t v3 = v2 + display_lines; // 0x812c5ec
    if (v3 <= NumOfLines_partial) {
        // 0x812c64e
        return;
    }
    // 0x812c5f8
    bool v4; // 0x812c5ca
    if (partial_threshold < 1) {
        int32_t v5 = HText_getNumOfLines(); // 0x812c624
        int32_t v6 = v3 - v5; // 0x812c629
        v4 = v6 == 0 | v6 < 0 != ((v6 ^ v3) & (v5 ^ v3)) < 0;
    } else {
        int32_t v7 = partial_threshold + v2; // 0x812c609
        int32_t v8 = HText_getNumOfLines(); // 0x812c60c
        int32_t v9 = v7 - v8; // 0x812c611
        v4 = v9 == 0 | v9 < 0 != ((v9 ^ v7) & (v8 ^ v7)) < 0;
    }
    // 0x812c62f
    if (!v4) {
        // 0x812c64e
        return;
    }
    // 0x812c635
    if (LYMainLoop_pageDisplay(v1) != 0) {
        // 0x812c644
        NumOfLines_partial = HText_getNumOfLines();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812c654 - 0x812c660
// Line range:    695 - 702
void HTFinishDisplayPartial(void) {
    // 0x812c654
    display_partial = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812c99a - 0x812cb43
// Line range:    915 - 968
int32_t HTFileCopy(struct _IO_FILE * fp, int32_t * sink) {
    // 0x812c99a
    HTReadProgress(0, 0);
    int32_t v1 = 0;
    int32_t items_read = fread((int32_t *)&input_buffer, 1, 0x1000, fp); // 0x812ca19
    int32_t result; // 0x812c99a
    while (items_read != 0) {
        int32_t v2 = items_read + v1; // 0x812cab0
        HTReadProgress((int64_t)v2, (int64_t)(v2 >> 31));
        if (display_partial != 0 && g198 != v2) {
            // 0x812caf2
            HTDisplayPartial();
        }
        // 0x812caf7
        if (HTCheckForInterrupt() != 0) {
            // 0x812cb04
            mustshow = 1;
            HTProgress(gettext("Data transfer interrupted."));
            result = v2 == 0 ? -1 : -0x752e;
            goto lab_0x812cb35;
        }
        v1 = v2;
        items_read = fread((int32_t *)&input_buffer, 1, 0x1000, fp);
    }
    // 0x812ca27
    if (ferror(fp) == 0) {
        // 0x812cb35
        HTFinishDisplayPartial();
        return 200;
    }
    // 0x812ca42
    if (WWW_TraceFlag != 0) {
        int32_t is_ferror = ferror(fp); // 0x812ca53
        fprintf(TraceFP(), "HTFormat: Read error, read returns %d\n", is_ferror);
    }
    // 0x812ca75
    result = v1 == 0 ? -1 : 206;
  lab_0x812cb35:
    // 0x812cb35
    HTFinishDisplayPartial();
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812cb43 - 0x812cc50
// Line range:    988 - 1019
int32_t HTMemCopy(int32_t * chunk, int32_t * sink) {
    // 0x812cb43
    HTReadProgress(0, 0);
    if (chunk == NULL) {
        // 0x812cc46
        HTFinishDisplayPartial();
        return 0;
    }
    int32_t v1 = (int32_t)chunk; // 0x812cc36
    int32_t v2 = 0; // 0x812cbcb
    v2 += *(int32_t *)v1;
    HTReadProgress((int64_t)v2, (int64_t)(v2 >> 31));
    HTDisplayPartial();
    while (HTCheckForInterrupt() == 0) {
        // 0x812cc33
        v1 += 20;
        if (v1 == 0) {
            // 0x812cc46
            HTFinishDisplayPartial();
            return 0;
        }
        v2 += *(int32_t *)v1;
        HTReadProgress((int64_t)v2, (int64_t)(v2 >> 31));
        HTDisplayPartial();
    }
    // 0x812cc00
    mustshow = 1;
    HTProgress(gettext("Data transfer interrupted."));
    // 0x812cc46
    HTFinishDisplayPartial();
    return v2 == 0 ? -1 : -0x752e;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812d504 - 0x812d6a4
// Line range:    1439 - 1487
int32_t HTParseFile(int32_t * rep_in, int32_t * format_out, int32_t * anchor, struct _IO_FILE * fp, int32_t * sink) {
    int32_t * v1 = HTStreamStack(rep_in, format_out, sink, anchor); // 0x812d527
    if (v1 != NULL) {
        int32_t * v2 = (int32_t *)HTFileCopy(fp, v1); // 0x812d631
        if (v2 == (int32_t *)-1) {
            // 0x812d69a
            return -204;
        }
        // 0x812d672
        if (v2 != (int32_t *)-0x752e) {
            // 0x812d67b
            return v2 < (int32_t *)1 | v2 == (int32_t *)200 ? 200 : 206;
        }
        // 0x812d69a
        return 206;
    }
    int32_t * stream = NULL; // bp-24, 0x812d539
    if (LYCancelDownload != 0) {
        // 0x812d54b
        LYCancelDownload = 0;
        // 0x812d69a
        return -1;
    }
    char * v3 = gettext("Sorry, no known way of converting %s to %s."); // 0x812d571
    HTSprintf0((char **)&stream, v3);
    if (WWW_TraceFlag != 0) {
        // 0x812d598
        fprintf(TraceFP(), "HTFormat(in HTParseFile): %s\n", stream);
    }
    int32_t result = HTLoadError(sink, 501, (char *)stream); // 0x812d5cb
    if (stream != NULL) {
        // 0x812d5da
        free(stream);
        stream = NULL;
    }
    // 0x812d69a
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTFormat.c
// Address range: 0x812d6a4 - 0x812d7cf
// Line range:    1511 - 1534
int32_t HTParseMem(int32_t * rep_in, int32_t * format_out, int32_t * anchor, int32_t * chunk, int32_t * sink) {
    int32_t * v1 = HTStreamStack(rep_in, format_out, sink, anchor); // 0x812d6c7
    if (v1 != NULL) {
        // 0x812d776
        HTMemCopy(chunk, v1);
        // 0x812d7c5
        return 200;
    }
    int32_t * stream = NULL; // bp-24, 0x812d6d9
    char * v2 = gettext("Sorry, no known way of converting %s to %s."); // 0x812d6f3
    HTSprintf0((char **)&stream, v2);
    if (WWW_TraceFlag != 0) {
        // 0x812d71a
        fprintf(TraceFP(), "HTFormat(in HTParseMem): %s\n", stream);
    }
    int32_t result = HTLoadError(sink, 501, (char *)stream); // 0x812d74d
    if (stream != NULL) {
        // 0x812d75c
        free(stream);
        stream = NULL;
    }
    // 0x812d7c5
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTNews.c
// Address range: 0x81334dc - 0x81335c7
// Line range:    145 - 161
void free_NNTP_AuthInfo(void) {
    // 0x81334dc
    if (NNTP_AuthInfo == NULL) {
        // 0x81335c5
        return;
    }
    int32_t v1 = *(int32_t *)((int32_t)NNTP_AuthInfo + 4); // 0x8133581
    int32_t v2 = v1; // 0x813358b
    if (v1 == 0) {
        // 0x81335ae
        HTList_delete(NNTP_AuthInfo);
        *(int32_t *)&NNTP_AuthInfo = 0;
        // 0x81335c5
        return;
    }
    int32_t v3 = *(int32_t *)v2; // 0x8133590
    while (v3 != 0) {
        int32_t * v4 = (int32_t *)v3; // 0x81335a1
        int32_t v5 = *v4; // 0x8133500
        if (v5 != 0) {
            // 0x8133506
            free((int32_t *)v5);
            *v4 = 0;
        }
        int32_t * v6 = (int32_t *)(v3 + 4); // 0x813351f
        int32_t v7 = *v6; // 0x813351f
        if (v7 != 0) {
            // 0x8133526
            free((int32_t *)v7);
            *v6 = 0;
        }
        int32_t * v8 = (int32_t *)(v3 + 8); // 0x8133541
        int32_t v9 = *v8; // 0x8133541
        if (v9 != 0) {
            // 0x8133548
            free((int32_t *)v9);
            *v8 = 0;
        }
        // 0x8133566
        free(v4);
        v2 += 4;
        if (v2 == 0) {
            // break -> 0x81335ae
            break;
        }
        v3 = *(int32_t *)v2;
    }
    // 0x81335ae
    HTList_delete(NNTP_AuthInfo);
    *(int32_t *)&NNTP_AuthInfo = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTNews.c
// Address range: 0x813c961 - 0x813c96e
// Line range:    3036 - 3047
void HTClearNNTPAuthInfo(void) {
    // 0x813c961
    free_NNTP_AuthInfo();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAABrow.c
// Address range: 0x8144ace - 0x8144af6
// Line range:    161 - 163
void HTAAForwardAuth_reset(void) {
    // 0x8144ace
    if (HTAAForwardAuth != 0) {
        // 0x8144add
        free((int32_t *)HTAAForwardAuth);
        HTAAForwardAuth = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAABrow.c
// Address range: 0x8144bc3 - 0x8144d6d
// Line range:    223 - 258
void HTAAServer_delete(int32_t * killme) {
    if (killme == NULL) {
        // 0x8144d6b
        return;
    }
    int32_t v1 = (int32_t)killme;
    int32_t * v2 = (int32_t *)(v1 + 12); // 0x8144bd6
    int32_t v3 = *v2; // 0x8144bd6
    if (v3 != 0) {
        int32_t v4 = HTList_count((int32_t *)v3) - 1;
        int32_t * v5 = (int32_t *)*v2;
        int32_t * v6 = v5; // 0x8144c31
        if (v4 >= 0) {
            char * v7 = HTList_objectAt(v5, v4); // 0x8144c09
            if (v7 != NULL) {
                // 0x8144c17
                HTAASetup_delete((int32_t *)v7);
            }
            int32_t v8 = v4 - 1;
            int32_t * v9 = (int32_t *)*v2;
            int32_t * v10 = v9; // 0x8144c31
            int32_t v11 = v8; // 0x8144c31
            v6 = v9;
            while (v8 >= 0) {
                // 0x8144bf9
                v7 = HTList_objectAt(v10, v11);
                if (v7 != NULL) {
                    // 0x8144c17
                    HTAASetup_delete((int32_t *)v7);
                }
                // 0x8144c29
                v8 = v11 - 1;
                v9 = (int32_t *)*v2;
                v10 = v9;
                v11 = v8;
                v6 = v9;
            }
        }
        // 0x8144c33
        HTList_delete(v6);
        *v2 = 0;
    }
    int32_t * v12 = (int32_t *)(v1 + 16); // 0x8144c4e
    int32_t v13 = *v12; // 0x8144c4e
    int32_t * v14 = NULL; // 0x8144cd5
    if (v13 != 0) {
        int32_t v15 = *(int32_t *)(v13 + 4); // 0x8144cda
        int32_t v16 = v15; // 0x8144ce4
        if (v15 != 0) {
            int32_t v17 = *(int32_t *)v16; // 0x8144ce9
            while (v17 != 0) {
                int32_t * v18 = (int32_t *)v17; // 0x8144c59
                int32_t v19 = *v18; // 0x8144c59
                if (v19 != 0) {
                    // 0x8144c5f
                    free((int32_t *)v19);
                    *v18 = 0;
                }
                int32_t * v20 = (int32_t *)(v17 + 4); // 0x8144c78
                int32_t v21 = *v20; // 0x8144c78
                if (v21 != 0) {
                    // 0x8144c7f
                    free((int32_t *)v21);
                    *v20 = 0;
                }
                int32_t * v22 = (int32_t *)(v17 + 8); // 0x8144c9a
                int32_t v23 = *v22; // 0x8144c9a
                if (v23 != 0) {
                    // 0x8144ca1
                    free((int32_t *)v23);
                    *v22 = 0;
                }
                // 0x8144cbf
                free(v18);
                int32_t v24 = *(int32_t *)(v16 + 4); // 0x8144cda
                v16 = v24;
                if (v24 == 0) {
                    // break -> 0x8144d07
                    break;
                }
                v17 = *(int32_t *)v16;
            }
        }
        // 0x8144d07
        v14 = (int32_t *)*v12;
    }
    // 0x8144d07
    HTList_delete(v14);
    *v12 = 0;
    int32_t v25 = *killme; // 0x8144d22
    if (v25 != 0) {
        // 0x8144d28
        free((int32_t *)v25);
        *killme = 0;
    }
    // 0x8144d3e
    HTList_removeObject(server_table, (char *)killme);
    free(killme);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAABrow.c
// Address range: 0x81450f1 - 0x81451c2
// Line range:    417 - 432
void HTAASetup_delete(int32_t * killme) {
    if (killme == NULL) {
        // 0x81451c0
        return;
    }
    int32_t v1 = (int32_t)killme;
    int32_t * v2 = (int32_t *)(v1 + 4); // 0x8145104
    int32_t v3 = *v2; // 0x8145104
    if (v3 != 0) {
        // 0x814510b
        free((int32_t *)v3);
        *v2 = 0;
    }
    int32_t * v4 = (int32_t *)(v1 + 8); // 0x8145126
    int32_t v5 = *v4; // 0x8145126
    if (v5 != 0) {
        // 0x814512d
        HTList_delete((int32_t *)v5);
        *v4 = 0;
    }
    int32_t * v6 = (int32_t *)(v1 + 12);
    int32_t v7 = *v6;
    for (int32_t i = 0; i < 6; i++) {
        int32_t v8 = *(int32_t *)(4 * i + v7); // 0x814515d
        int32_t v9 = v7; // 0x8145161
        if (v8 != 0) {
            // 0x8145163
            HTAssocList_delete((int32_t *)v8);
            v9 = *v6;
        }
        // 0x814517c
        v7 = v9;
    }
    if (v7 != 0) {
        // 0x8145190
        free((int32_t *)v7);
        *v6 = 0;
    }
    // 0x81451ae
    free(killme);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAABrow.c
// Address range: 0x8145b19 - 0x8145c7a
// Line range:    759 - 784
void free_HTAAGlobals(void) {
    // 0x8145b19
    if (server_table != NULL) {
        int32_t v1 = HTList_count(server_table) - 1;
        int32_t * v2 = server_table; // 0x8145b7a
        if (v1 >= 0) {
            char * v3 = HTList_objectAt(server_table, v1); // 0x8145b52
            if (v3 != NULL) {
                // 0x8145b60
                HTAAServer_delete((int32_t *)v3);
            }
            int32_t v4 = v1 - 1;
            int32_t * v5 = server_table; // 0x8145b7a
            int32_t v6 = v4; // 0x8145b7a
            v2 = server_table;
            while (v4 >= 0) {
                // 0x8145b43
                v3 = HTList_objectAt(v5, v6);
                if (v3 != NULL) {
                    // 0x8145b60
                    HTAAServer_delete((int32_t *)v3);
                }
                // 0x8145b72
                v4 = v6 - 1;
                v5 = server_table;
                v6 = v4;
                v2 = server_table;
            }
        }
        // 0x8145b7c
        HTList_delete(v2);
        *(int32_t *)&server_table = 0;
    }
    // 0x8145b93
    HTAAForwardAuth_reset();
    if (HTAA_composeAuthResult != 0) {
        // 0x8145ba1
        free((int32_t *)HTAA_composeAuthResult);
        HTAA_composeAuthResult = 0;
    }
    // 0x8145bb8
    if (current_hostname != 0) {
        // 0x8145bc1
        free((int32_t *)current_hostname);
        current_hostname = 0;
    }
    // 0x8145bd8
    if (current_docname != 0) {
        // 0x8145be1
        free((int32_t *)current_docname);
        current_docname = 0;
    }
    // 0x8145bf8
    if (proxy_hostname != 0) {
        // 0x8145c01
        free((int32_t *)proxy_hostname);
        proxy_hostname = 0;
    }
    // 0x8145c18
    if (proxy_docname != 0) {
        // 0x8145c21
        free((int32_t *)proxy_docname);
        proxy_docname = 0;
    }
    // 0x8145c38
    if (compose_auth_stringResult != 0) {
        // 0x8145c41
        free((int32_t *)compose_auth_stringResult);
        compose_auth_stringResult = 0;
    }
    // 0x8145c58
    if (secret_key != 0) {
        // 0x8145c61
        free((int32_t *)secret_key);
        secret_key = 0;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAABrow.c
// Address range: 0x81469c0 - 0x81469d4
// Line range:    1254 - 1267
void HTClearHTTPAuthInfo(void) {
    // 0x81469c0
    free_HTAAGlobals();
    free_HTAAGlobalsSet = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x8146b90 - 0x8146c6a
// Line range:    202 - 221
void HTAA_setIds(int32_t * prot, char * ids) {
    int32_t v1 = (int32_t)prot;
    if (ids == NULL) {
        // 0x8146c3c
        HTSACopy((char **)(v1 + 8), "nobody");
        HTSACopy((char **)(v1 + 12), "nogroup");
        // 0x8146c68
        return;
    }
    char ** str = NULL; // bp-8, 0x8146ba0
    HTSACopy((char **)&str, ids);
    char * found_char_pos = strchr((char *)str, 46); // 0x8146bc7
    if (found_char_pos == NULL) {
        // 0x8146bf6
        HTSACopy((char **)(v1 + 12), "nogroup");
    } else {
        // 0x8146bd5
        *found_char_pos = 0;
        HTSACopy((char **)(v1 + 12), (char *)((int32_t)found_char_pos + 1));
    }
    // 0x8146c0c
    HTSACopy((char **)(v1 + 8), (char *)str);
    if (str != NULL) {
        // 0x8146c28
        free((int32_t *)str);
        str = NULL;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x8146c6a - 0x8146ffc
// Line range:    234 - 330
void HTAA_parseProtFile(int32_t * prot, struct _IO_FILE * fp) {
    if (prot == NULL || fp == NULL) {
        // 0x8146ff6
        return;
    }
    char * v1 = NULL; // bp-16, 0x8146c85
    int32_t v2 = lex(fp); // 0x8146fcb
    int32_t v3; // 0x8146c6a
    int32_t v4; // 0x8146c6a
    if (v2 != 1) {
        int32_t v5 = (int32_t)prot;
        int32_t * v6 = (int32_t *)(v5 + 20);
        int32_t * v7 = (int32_t *)(v5 + 16);
        int32_t * v8 = (int32_t *)(v5 + 24);
        v3 = v2;
        while (true) {
          lab_0x8146c9f_2:;
            int32_t v9 = v3; // 0x8146c6a
            int32_t v10; // 0x8146c6a
            while (true) {
              lab_0x8146c9f:
                // 0x8146c9f
                v10 = v9;
                switch (v10) {
                    case 2: {
                        // 0x8146c91
                        v9 = lex(fp);
                        goto lab_0x8146c9f;
                    }
                    case 1: {
                        goto lab_0x8146fdd_2;
                    }
                    default: {
                        goto lab_0x8146caf;
                    }
                }
            }
          lab_0x8146caf:
            // 0x8146caf
            v4 = v10;
            if (v10 != 8) {
                goto lab_0x8146f63;
            } else {
                // 0x8146cb9
                HTSACopy(&v1, HTlex_buffer);
                int32_t v11 = lex(fp); // 0x8146cd2
                if (v11 != 3) {
                    // 0x8146ce0
                    unlex(v11);
                }
                // 0x8146ceb
                if (strncasecomp(v1, "Auth", 4) != 0) {
                    // 0x8146e1c
                    if (strncasecomp(v1, "mask", 4) != 0) {
                        int32_t v12 = lex(fp); // 0x8146eda
                        v4 = v12;
                        if (v12 == 8) {
                            int32_t v13 = *v8; // 0x8146eeb
                            int32_t v14 = v13; // 0x8146ef0
                            if (v13 == 0) {
                                // 0x8146ef2
                                v14 = (int32_t)HTAssocList_new();
                                *v8 = v14;
                            }
                            // 0x8146eff
                            HTAssocList_add((int32_t *)v14, v1, HTlex_buffer);
                            int32_t v15 = lex(fp); // 0x8146f22
                            v4 = v15;
                            if (WWW_TraceFlag != 0) {
                                struct _IO_FILE * stream = TraceFP(); // 0x8146f38
                                fprintf(stream, "%s `%s' bound to value `%s'\n", "HTAA_parseProtFile: Name", v1, HTlex_buffer);
                                v4 = v15;
                            }
                        }
                        goto lab_0x8146f63;
                    } else {
                        int32_t * v16 = HTAA_parseGroupDef(fp); // 0x8146e45
                        *v7 = (int32_t)v16;
                        if (WWW_TraceFlag != 0) {
                            struct _IO_FILE * stream2 = TraceFP();
                            if (v16 == NULL) {
                                // 0x8146eaa
                                fwrite((int32_t *)"HTAA_parseProtFile: Mask group syntax error\n", 1, 44, stream2);
                            } else {
                                // 0x8146e72
                                fwrite((int32_t *)"HTAA_parseProtFile: Mask group:\n", 1, 32, stream2);
                                HTAA_printGroupDef((int32_t *)*v7);
                            }
                        }
                        goto lab_0x8146fc5;
                    }
                } else {
                    int32_t v17 = lex(fp); // 0x8146d14
                    v4 = v17;
                    if (v17 == 8) {
                        while (true) {
                          lab_0x8146d21:;
                            int32_t v18 = HTAAScheme_enum(HTlex_buffer); // 0x8146d28
                            if (v18 == 0) {
                                // 0x8146da7
                                if (WWW_TraceFlag != 0) {
                                    struct _IO_FILE * stream3 = TraceFP(); // 0x8146db2
                                    fprintf(stream3, "%s %s `%s'\n", "HTAA_parseProtFile: unknown", "authentication scheme:", HTlex_buffer);
                                }
                            } else {
                                int32_t v19 = *v6; // 0x8146d39
                                int32_t v20 = v19; // 0x8146d3e
                                if (v19 == 0) {
                                    // 0x8146d40
                                    v20 = (int32_t)HTList_new();
                                    *v6 = v20;
                                }
                                // 0x8146d4d
                                HTList_addObject((int32_t *)v20, (char *)v18);
                                if (WWW_TraceFlag != 0) {
                                    char * v21 = HTAAScheme_name(v18); // 0x8146d73
                                    fprintf(TraceFP(), "%s %s `%s'\n", "HTAA_parseProtFile: valid", "authentication scheme:", v21);
                                }
                            }
                            int32_t v22 = lex(fp); // 0x8146de7
                            v4 = v22;
                            if (v22 != 4) {
                                // break -> 0x8146f63
                                break;
                            }
                            while (true) {
                              lab_0x8146df9:;
                                int32_t v23 = lex(fp); // 0x8146dff
                                v4 = v23;
                                switch (v23) {
                                    case 2: {
                                        goto lab_0x8146df9;
                                    }
                                    case 8: {
                                        goto lab_0x8146d21;
                                    }
                                    default: {
                                        goto lab_0x8146f63;
                                    }
                                }
                            }
                        }
                    }
                    goto lab_0x8146f63;
                }
            }
        }
    }
  lab_0x8146fdd_2:
    // 0x8146fdd
    if (v1 != NULL) {
        // 0x8146fe4
        free((int32_t *)v1);
        v1 = NULL;
    }
  lab_0x8146f63:
    // 0x8146f63
    if (v4 >= 3) {
        // 0x8146f6f
        if (WWW_TraceFlag != 0) {
            // 0x8146f7a
            fprintf(TraceFP(), "%s %s %d (that line ignored)\n", "HTAA_parseProtFile: Syntax error", "in protection setup file at line", HTlex_line);
        }
        int32_t v24 = lex(fp); // 0x8146fb1
        while (v24 != 1 == (v24 != 2)) {
            // 0x8146fab
            v24 = lex(fp);
        }
    }
    goto lab_0x8146fc5;
  lab_0x8146fc5:;
    int32_t v25 = lex(fp); // 0x8146fcb
    v3 = v25;
    if (v25 == 1) {
        // break -> 0x8146fdd
        goto lab_0x8146fdd_2;
    }
    goto lab_0x8146c9f_2;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x8146ffc - 0x8147289
// Line range:    361 - 414
int32_t * HTAAProt_new(char * cur_docname, char * prot_filename, char * ids) {
    // 0x8146ffc
    if (prot_cache == NULL) {
        int32_t * v1 = HTList_new(); // 0x814701a
        *(int32_t *)&prot_cache = (int32_t)v1;
    }
    int32_t v2 = (int32_t)prot_cache; // 0x8147047
    int32_t * result; // 0x8146ffc
    while (v2 != 0) {
        // 0x8147044
        v2 += 4;
        if (v2 == 0) {
            // break -> 0x81470b9
            break;
        }
        int32_t str = *(int32_t *)v2; // 0x8147056
        if (str == 0) {
            // break -> 0x81470b9
            break;
        }
        // 0x8147026
        if (strcmp((char *)*(int32_t *)str, prot_filename) == 0) {
            int32_t * v3 = (int32_t *)*(int32_t *)(str + 4); // 0x814707c
            result = v3;
            if (WWW_TraceFlag == 0) {
                goto lab_0x8147257;
            } else {
                // 0x814708e
                fprintf(TraceFP(), "%s `%s' already in cache\n", "HTAAProt_new: Protection file", prot_filename);
                result = v3;
                goto lab_0x8147257;
            }
        }
    }
    // 0x81470b9
    if (WWW_TraceFlag != 0) {
        // 0x81470c4
        fprintf(TraceFP(), "HTAAProt_new: Loading protection file `%s'\n", prot_filename);
    }
    int32_t * mem = calloc(1, 28); // 0x81470f1
    if (mem == NULL) {
        // 0x81470ff
        outofmem("../../../WWW/Library/Implementation/HTAAProt.c", "HTAAProt_new");
        // UNREACHABLE
    }
    // 0x8147113
    *mem = 0;
    int32_t v4 = (int32_t)mem; // 0x814711c
    *(int32_t *)(v4 + 4) = 0;
    *(int32_t *)(v4 + 8) = 0;
    *(int32_t *)(v4 + 12) = 0;
    *(int32_t *)(v4 + 20) = (int32_t)HTList_new();
    *(int32_t *)(v4 + 16) = 0;
    *(int32_t *)(v4 + 24) = (int32_t)HTAssocList_new();
    if (prot_filename == NULL) {
        goto lab_0x8147211;
    } else {
        struct _IO_FILE * file = fopen64(prot_filename, "r"); // 0x8147176
        if (file == NULL) {
            goto lab_0x8147211;
        } else {
            // 0x8147188
            HTAA_parseProtFile(mem, file);
            fclose(file);
            int32_t * mem2 = calloc(1, 8); // 0x81471b4
            if (mem2 == NULL) {
                // 0x81471c2
                outofmem("../../../WWW/Library/Implementation/HTAAProt.c", "HTAAProt_new");
                // UNREACHABLE
            }
            // 0x81471d6
            *(int32_t *)((int32_t)mem2 + 4) = v4;
            *mem2 = 0;
            HTSACopy((char **)mem2, prot_filename);
            HTList_addObject(prot_cache, (char *)mem2);
            result = mem;
            goto lab_0x8147257;
        }
    }
  lab_0x8147211:
    // 0x8147211
    result = mem;
    if (WWW_TraceFlag != 0) {
        int32_t * v5 = prot_filename == NULL ? (int32_t *)"(null)" : (int32_t *)prot_filename;
        fprintf(TraceFP(), "HTAAProt_new: %s `%s'\n", "Unable to open protection setup file", v5);
        result = mem;
    }
    goto lab_0x8147257;
  lab_0x8147257:
    // 0x8147257
    if (cur_docname != NULL) {
        // 0x814725d
        HTSACopy((char **)((int32_t)result + 4), cur_docname);
    }
    // 0x8147272
    HTAA_setIds(result, ids);
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x8147289 - 0x81472f3
// Line range:    438 - 448
void HTAA_setDefaultProtection(char * cur_docname, char * prot_filename, char * ids) {
    // 0x8147289
    *(int32_t *)&default_prot = 0;
    if (prot_filename != NULL) {
        int32_t * v1 = HTAAProt_new(cur_docname, prot_filename, ids); // 0x81472b3
        *(int32_t *)&default_prot = (int32_t)v1;
        // 0x81472f1
        return;
    }
    // 0x81472bf
    if (WWW_TraceFlag != 0) {
        // 0x81472ca
        fprintf(TraceFP(), "%s %s\n", "HTAA_setDefaultProtection: ERROR: Protection file", "not specified (obligatory for DefProt rule)!!\n");
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x81472f3 - 0x81473cc
// Line range:    472 - 492
void HTAA_setCurrentProtection(char * cur_docname, char * prot_filename, char * ids) {
    // 0x81472f3
    *(int32_t *)&current_prot = 0;
    if (prot_filename != NULL) {
        int32_t * v1 = HTAAProt_new(cur_docname, prot_filename, ids); // 0x814731d
        *(int32_t *)&current_prot = (int32_t)v1;
        // 0x81473ca
        return;
    }
    // 0x814732c
    if (default_prot == NULL) {
        // 0x8147390
        if (WWW_TraceFlag != 0) {
            // 0x814739b
            fprintf(TraceFP(), "%s %s %s\n", "HTAA_setCurrentProtection: ERROR: Protection", "file not specified for Protect rule, and", "default protection is not set!!");
        }
    } else {
        // 0x8147335
        *(int32_t *)&current_prot = (int32_t)default_prot;
        HTAA_setIds(default_prot, ids);
        if (WWW_TraceFlag != 0) {
            // 0x814735f
            fprintf(TraceFP(), "%s %s %s\n", "HTAA_setCurrentProtection: Protection file", "not specified for Protect rule", "-- using default protection");
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x81473fd - 0x8147416
// Line range:    557 - 560
void HTAA_clearProtections(void) {
    // 0x81473fd
    *(int32_t *)&current_prot = 0;
    *(int32_t *)&default_prot = 0;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x8147416 - 0x8147490
// Line range:    599 - 616
void save_gid_info(char * name, int32_t user) {
    int32_t * mem = calloc(1, 8); // 0x814742b
    if (mem == NULL) {
        // 0x814748e
        return;
    }
    // 0x8147439
    if (known_grp != NULL) {
        // 0x814745e
        HTSACopy((char **)mem, name);
        *(int32_t *)((int32_t)mem + 4) = user;
        HTList_addObject(known_grp, (char *)mem);
        // 0x814748e
        return;
    }
    int32_t * v1 = HTList_new(); // 0x8147442
    *(int32_t *)&known_grp = (int32_t)v1;
    if (uidgid_cache_inited == 0) {
        // 0x8147457
        uidgid_cache_inited = 1;
    }
    // 0x814745e
    HTSACopy((char **)mem, name);
    *(int32_t *)((int32_t)mem + 4) = user;
    HTList_addObject(known_grp, (char *)mem);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x8147490 - 0x814750a
// Line range:    621 - 638
void save_uid_info(char * name, int32_t user) {
    int32_t * mem = calloc(1, 8); // 0x81474a5
    if (mem == NULL) {
        // 0x8147508
        return;
    }
    // 0x81474b3
    if (known_pwd != NULL) {
        // 0x81474d8
        HTSACopy((char **)mem, name);
        *(int32_t *)((int32_t)mem + 4) = user;
        HTList_addObject(known_pwd, (char *)mem);
        // 0x8147508
        return;
    }
    int32_t * v1 = HTList_new(); // 0x81474bc
    *(int32_t *)&known_pwd = (int32_t)v1;
    if (uidgid_cache_inited == 0) {
        // 0x81474d1
        uidgid_cache_inited = 1;
    }
    // 0x81474d8
    HTSACopy((char **)mem, name);
    *(int32_t *)((int32_t)mem + 4) = user;
    HTList_addObject(known_pwd, (char *)mem);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x814750a - 0x81475f3
// Line range:    650 - 673
char * HTAA_UidToName(int32_t uid) {
    // 0x814750a
    char * result; // 0x814750a
    if (known_pwd != NULL) {
        int32_t v1 = *(int32_t *)((int32_t)known_pwd + 4); // 0x8147545
        while (v1 != 0) {
            int32_t * v2 = (int32_t *)v1; // 0x8147548
            int32_t v3 = *v2; // 0x8147554
            if (v3 == 0) {
                // break -> 0x814755a
                break;
            }
            // 0x814751c
            if (*(int32_t *)(v3 + 4) == uid) {
                // 0x814752f
                result = (char *)*(int32_t *)v3;
                return result;
            }
            v1 = *(int32_t *)((int32_t)v2 + 4);
        }
    }
    struct passwd * v4 = getpwuid(uid); // 0x8147560
    if (v4 == NULL) {
        // 0x81475e9
        return (char *)&g83;
    }
    int32_t v5 = *(int32_t *)v4; // 0x8147571
    if (v5 == 0) {
        // 0x81475e9
        return (char *)&g83;
    }
    int32_t * v6 = (int32_t *)((int32_t)v4 + 8);
    int32_t v7 = v5; // 0x8147580
    if (WWW_TraceFlag != 0) {
        int32_t v8 = *v6; // 0x8147585
        fprintf(TraceFP(), "%s(%d) returned (%s:%d:...)\n", "HTAA_UidToName: getpwuid", uid, (char *)v5, v8);
        v7 = *(int32_t *)v4;
    }
    // 0x81475bf
    save_uid_info((char *)v7, *v6);
    result = (char *)*(int32_t *)v4;
  lab_0x81475e9:
    // 0x81475e9
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAProt.c
// Address range: 0x81476e2 - 0x81477cb
// Line range:    717 - 740
char * HTAA_GidToName(int32_t gid) {
    // 0x81476e2
    char * result; // 0x81476e2
    if (known_grp != NULL) {
        int32_t v1 = *(int32_t *)((int32_t)known_grp + 4); // 0x814771d
        while (v1 != 0) {
            int32_t * v2 = (int32_t *)v1; // 0x8147720
            int32_t v3 = *v2; // 0x814772c
            if (v3 == 0) {
                // break -> 0x8147732
                break;
            }
            // 0x81476f4
            if (*(int32_t *)(v3 + 4) == gid) {
                // 0x8147707
                result = (char *)*(int32_t *)v3;
                return result;
            }
            v1 = *(int32_t *)((int32_t)v2 + 4);
        }
    }
    struct group * v4 = getgrgid(gid); // 0x8147738
    if (v4 == NULL) {
        // 0x81477c1
        return (char *)&g83;
    }
    int32_t v5 = *(int32_t *)v4; // 0x8147749
    if (v5 == 0) {
        // 0x81477c1
        return (char *)&g83;
    }
    int32_t * v6 = (int32_t *)((int32_t)v4 + 8);
    int32_t v7 = v5; // 0x8147758
    if (WWW_TraceFlag != 0) {
        int32_t v8 = *v6; // 0x814775d
        fprintf(TraceFP(), "%s(%d) returned (%s:%d:...)\n", "HTAA_GidToName: getgrgid", gid, (char *)v5, v8);
        v7 = *(int32_t *)v4;
    }
    // 0x8147797
    save_gid_info((char *)v7, *v6);
    result = (char *)*(int32_t *)v4;
  lab_0x81477c1:
    // 0x81477c1
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAssoc.c
// Address range: 0x81478bc - 0x81478c9
// Line range:    26 - 28
int32_t * HTAssocList_new(void) {
    // 0x81478bc
    return HTList_new();
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAssoc.c
// Address range: 0x81478c9 - 0x8147984
// Line range:    31 - 44
void HTAssocList_delete(int32_t * alist) {
    if (alist == NULL) {
        // 0x8147982
        return;
    }
    int32_t v1 = *(int32_t *)((int32_t)alist + 4); // 0x8147943
    int32_t v2 = v1; // 0x814794d
    if (v1 == 0) {
        // 0x8147970
        HTList_delete(alist);
        // 0x8147982
        return;
    }
    int32_t v3 = *(int32_t *)v2; // 0x8147952
    while (v3 != 0) {
        int32_t * v4 = (int32_t *)v3; // 0x81478e4
        int32_t v5 = *v4; // 0x81478e4
        if (v5 != 0) {
            // 0x81478ea
            free((int32_t *)v5);
            *v4 = 0;
        }
        int32_t * v6 = (int32_t *)(v3 + 4); // 0x8147903
        int32_t v7 = *v6; // 0x8147903
        if (v7 != 0) {
            // 0x814790a
            free((int32_t *)v7);
            *v6 = 0;
        }
        // 0x8147928
        free(v4);
        v2 += 4;
        if (v2 == 0) {
            // break -> 0x8147970
            break;
        }
        v3 = *(int32_t *)v2;
    }
    // 0x8147970
    HTList_delete(alist);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAssoc.c
// Address range: 0x8147984 - 0x8147a3b
// Line range:    49 - 67
void HTAssocList_add(int32_t * alist, char * name, char * value) {
    if (alist == NULL) {
        // 0x8147a17
        if (WWW_TraceFlag != 0) {
            // 0x8147a22
            fprintf(TraceFP(), "HTAssoc_add: ERROR: assoc list NULL!!\n");
        }
        // 0x8147a39
        return;
    }
    int32_t * mem = malloc(8); // 0x814799b
    if (mem == NULL) {
        // 0x81479a9
        outofmem("../../../WWW/Library/Implementation/HTAssoc.c", "HTAssoc_add");
        // UNREACHABLE
    }
    // 0x81479bd
    *mem = 0;
    int32_t v1 = (int32_t)mem + 4; // 0x81479c9
    *(int32_t *)v1 = 0;
    if (name != NULL) {
        // 0x81479d6
        HTSACopy((char **)mem, name);
    }
    if (value != NULL) {
        // 0x81479ee
        HTSACopy((char **)v1, value);
    }
    // 0x8147a03
    HTList_addObject(alist, (char *)mem);
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTLex.c
// Address range: 0x8147abc - 0x8147ac9
// Line range:    37 - 39
void unlex(int32_t lex_item) {
    // 0x8147abc
    lex_pushed_back = lex_item;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTLex.c
// Address range: 0x8147ac9 - 0x8147c4c
// Line range:    42 - 108
int32_t lex(struct _IO_FILE * fp) {
    // 0x8147ac9
    if ((struct _IO_FILE *)cache != fp) {
        // 0x8147ae0
        *(int32_t *)&cache = (int32_t)fp;
        HTlex_line = 1;
    }
    int32_t result = lex_pushed_back; // 0x8147af2
    if (result != 0) {
        // 0x8147afb
        lex_pushed_back = 0;
        // 0x8147c47
        return result;
    }
    // 0x8147b18
    lex_cnt = 0;
    lex_template = 0;
    while (true) {
        int32_t v1 = _IO_getc(fp); // 0x8147b2f
        char v2 = v1;
        g367 = v1 + 1;
        switch (v1) {
            case -1: {
            }
            case 9: {
            }
            case 10: {
            }
            case 13: {
            }
            case 32: {
            }
            case 40: {
            }
            case 41: {
            }
            case 44: {
            }
            case 58: {
            }
            case 64: {
                // 0x8147b56
                if (lex_cnt >= 1) {
                    // break -> 0x8147b5f
                    break;
                }
                int32_t v3 = 0x1000000 * v1 >> 24; // 0x8147b9a
                g368 = v3 + 1;
                switch (v3) {
                    case -1: {
                        // 0x8147c47
                        return 1;
                    }
                    case 10: {
                        // 0x8147bc1
                        HTlex_line++;
                        // 0x8147c47
                        return 2;
                    }
                    case 40: {
                        // 0x8147c47
                        return 5;
                    }
                    case 41: {
                        // 0x8147c47
                        return 6;
                    }
                    case 44: {
                        // 0x8147c47
                        return 4;
                    }
                    case 58: {
                        // 0x8147c47
                        return 3;
                    }
                    case 64: {
                        // 0x8147c47
                        return 7;
                    }
                }
                // break -> 0x8147b29
                break;
            }
            default: {
                // 0x8147c04
                if (lex_cnt <= 38) {
                    // 0x8147c0e
                    HTlex_buffer[0] = v2;
                    lex_cnt++;
                }
                // 0x8147c25
                HTlex_buffer[0] = 0;
                if (v2 == 42) {
                    // 0x8147c3b
                    lex_template = 1;
                }
                // break -> 0x8147b29
                break;
            }
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTLex.c
// Address range: 0x8147c4c - 0x8147d24
// Line range:    111 - 142
char * lex_verbose(int32_t lex_item) {
    // 0x8147c4c
    g370 = lex_item;
    char * result = "NO-LEX-ITEM"; // 0x8147c68
    switch (lex_item) {
        case 1: {
            // 0x8147c76
            result = "end-of-file";
        }
        case 0: {
            // 0x8147d1f
            return result;
        }
        case 2: {
            // 0x8147c82
            result = "record separator (newline)";
            return result;
        }
        case 3: {
            // 0x8147c8e
            result = "field separator ':'";
            return result;
        }
        case 4: {
            // 0x8147c9a
            result = "item separator ','";
            return result;
        }
        case 5: {
            // 0x8147ca3
            result = "'('";
            return result;
        }
        case 6: {
            // 0x8147cac
            result = "')'";
            return result;
        }
        case 7: {
            // 0x8147cb5
            result = "address qualifier '@'";
            return result;
        }
        case 8: {
            // 0x8147cbe
            sprintf((char *)&g342, "alphanumeric string '%.*s'", 40, HTlex_buffer);
            result = (char *)&g342;
            return result;
        }
        case 9: {
            // 0x8147ceb
            sprintf((char *)&g342, "template string '%.*s'", 40, HTlex_buffer);
            result = (char *)&g342;
            return result;
        }
        default: {
            // 0x8147d18
            result = "UNKNOWN-LEX-ITEM";
            return result;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAUtil.c
// Address range: 0x814803c - 0x81481eb
// Line range:    67 - 95
int32_t HTAAScheme_enum(char * name) {
    char * str = NULL; // bp-8, 0x8148042
    if (name == NULL) {
        // 0x81481e6
        return 0;
    }
    // 0x814805b
    HTSACopy(&str, name);
    LYUpperCase(str);
    if (strncmp(str, "NONE", 4) == 0) {
        // 0x8148097
        if (str != NULL) {
            // 0x814809e
            free((int32_t *)str);
            str = NULL;
        }
        // 0x81481e6
        return 1;
    }
    // 0x81480bc
    if (strncmp(str, "BASIC", 5) == 0) {
        // 0x81480db
        if (str != NULL) {
            // 0x81480e2
            free((int32_t *)str);
            str = NULL;
        }
        // 0x81481e6
        return 2;
    }
    // 0x8148100
    if (strncmp(str, "PUBKEY", 6) == 0) {
        // 0x814811f
        if (str != NULL) {
            // 0x8148126
            free((int32_t *)str);
            str = NULL;
        }
        // 0x81481e6
        return 3;
    }
    // 0x8148144
    if (strncmp(str, "KERBEROSV4", 10) == 0) {
        // 0x8148163
        if (str != NULL) {
            // 0x814816a
            free((int32_t *)str);
            str = NULL;
        }
        // 0x81481e6
        return 4;
    }
    char * v1 = str;
    int32_t result; // 0x814803c
    if (strncmp(str, "KERBEROSV5", 10) != 0) {
        // 0x81481c6
        result = 0;
        if (v1 != NULL) {
            // 0x81481cd
            free((int32_t *)v1);
            str = NULL;
            result = 0;
        }
    } else {
        // 0x81481a4
        result = 5;
        if (v1 != NULL) {
            // 0x81481ab
            free((int32_t *)v1);
            str = NULL;
            result = 5;
        }
    }
    // 0x81481e6
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTAAUtil.c
// Address range: 0x81481eb - 0x8148247
// Line range:    108 - 125
char * HTAAScheme_name(int32_t scheme) {
    // 0x81481eb
    g369 = scheme;
    char * result = "None"; // 0x8148203
    switch (scheme) {
        case 0: {
            // 0x8148232
            result = "UNKNOWN";
        }
        case 1: {
            // 0x8148242
            return result;
        }
        case 2: {
            // 0x814820e
            result = "Basic";
            return result;
        }
        case 3: {
            // 0x8148217
            result = "Pubkey";
            return result;
        }
        case 4: {
            // 0x8148220
            result = "KerberosV4";
            return result;
        }
        case 5: {
            // 0x8148229
            result = "KerberosV5";
            return result;
        }
        default: {
            // 0x814823b
            result = "THIS-IS-A-BUG";
            return result;
        }
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTGroup.c
// Address range: 0x8148b20 - 0x8148bf8
// Line range:    71 - 85
void syntax_error(struct _IO_FILE * fp, char * msg, int32_t lex_item) {
    int32_t v1 = __readgsdword(20); // 0x8148b34
    int32_t v2; // bp-4, 0x8148b20
    int32_t v3 = (int32_t)&v2 - 53;
    struct _IO_FILE * v4 = fp; // 0x8148b46
    int32_t v5 = 0; // 0x8148b46
    uint32_t v6; // 0x8148b20
    while (true) {
        // 0x8148b5c
        v6 = v5;
        int32_t v7 = _IO_getc(v4); // 0x8148b62
        if (v7 != -1 != v7 != 10) {
            // break (via goto) -> 0x8148b76
            goto lab_0x8148b76;
        }
        while (v6 > 39) {
            // 0x8148b5c
            v7 = _IO_getc(v4);
            if (v7 != -1 != v7 != 10) {
                // break (via goto) -> 0x8148b76
                goto lab_0x8148b76;
            }
        }
        // 0x8148b4e
        *(char *)(v6 + v3) = (char)v7;
        v4 = fp;
        v5 = v6 + 1;
    }
  lab_0x8148b76:
    // 0x8148b76
    *(char *)(v6 + v3) = 0;
    if (WWW_TraceFlag != 0) {
        char * v8 = lex_verbose(lex_item); // 0x8148b8f
        struct _IO_FILE * stream = TraceFP(); // 0x8148b9c
        int32_t v9; // bp-57, 0x8148b20
        fprintf(stream, "%s %d before: '%s'\nHTGroup.c: %s (got %s)\n", "HTGroup.c: Syntax error in rule file at line", HTlex_line, &v9, msg, v8);
    }
    // 0x8148bd3
    HTlex_line++;
    if (v1 != __readgsdword(20)) {
        // 0x8148bec
        __stack_chk_fail();
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTGroup.c
// Address range: 0x8148bf8 - 0x8148da3
// Line range:    88 - 142
int32_t * parse_address_part(struct _IO_FILE * fp) {
    int32_t v1 = lex(fp); // 0x8148c0f
    int32_t * v2 = (int32_t *)v1; // 0x8148c14
    bool v3 = true; // 0x8148c1b
    if (v1 != 8 == (v2 != (int32_t *)9)) {
        // 0x8148c29
        if (v2 != (int32_t *)5) {
            // 0x8148c49
            syntax_error(fp, "Expecting a single address or '(' beginning list", (int32_t)v2);
            // 0x8148d9e
            return NULL;
        }
        int32_t v4 = lex(fp); // 0x8148c35
        int32_t * v5 = (int32_t *)v4; // 0x8148c3a
        v3 = false;
        if (v4 != 8 && v5 != (int32_t *)9) {
            // 0x8148c49
            syntax_error(fp, "Expecting a single address or '(' beginning list", (int32_t)v5);
            // 0x8148d9e
            return NULL;
        }
    }
    int32_t * v6 = HTList_new(); // 0x8148c6f
    int32_t * mem = calloc(1, 8); // 0x8148c86
    while (mem != NULL) {
        // 0x8148ca8
        *mem = 0;
        *(int32_t *)((int32_t)mem + 4) = 0;
        HTSACopy((char **)mem, HTlex_buffer);
        HTList_addObject(v6, (char *)mem);
        int32_t * result = v6; // 0x8148ce4
        if (v3) {
            // 0x8148d9e
            return result;
        }
        int32_t v7 = lex(fp); // 0x8148cec
        if (v7 != 4) {
            // 0x8148d57
            result = v6;
            if ((int32_t *)v7 == (int32_t *)6) {
                return result;
            } else {
                // 0x8148d63
                HTList_delete(v6);
                syntax_error(fp, "Expecting ')' closing address list", v7);
                result = NULL;
                return result;
            }
        }
        int32_t v8 = lex(fp); // 0x8148d00
        while (v8 == 2) {
            // 0x8148cfa
            v8 = lex(fp);
        }
        if ((v8 & -2) != 8) {
            // 0x8148d22
            syntax_error(fp, "Expecting an address template", v8);
            HTList_delete(v6);
            result = NULL;
            return result;
        }
        mem = calloc(1, 8);
    }
    // 0x8148c94
    outofmem("../../../WWW/Library/Implementation/HTGroup.c", "parse_address_part");
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTGroup.c
// Address range: 0x8148da3 - 0x8148f38
// Line range:    145 - 198
int32_t * parse_user_part(struct _IO_FILE * fp) {
    int32_t v1 = lex(fp); // 0x8148dba
    bool v2 = true; // 0x8148dc6
    if (v1 != 8) {
        int32_t * v3 = (int32_t *)v1; // 0x8148dbf
        if (v3 != (int32_t *)5) {
            // 0x8148de8
            syntax_error(fp, "Expecting a single name or '(' beginning list", (int32_t)v3);
            // 0x8148f33
            return NULL;
        }
        int32_t v4 = lex(fp); // 0x8148dda
        v2 = false;
        if (v4 != 8) {
            // 0x8148de8
            syntax_error(fp, "Expecting a single name or '(' beginning list", (int32_t)(int32_t *)v4);
            // 0x8148f33
            return NULL;
        }
    }
    int32_t * v5 = HTList_new(); // 0x8148e0e
    int32_t * mem = calloc(1, 8); // 0x8148e25
    while (mem != NULL) {
        // 0x8148e47
        *mem = 0;
        *(int32_t *)((int32_t)mem + 4) = 0;
        HTSACopy((char **)mem, HTlex_buffer);
        HTList_addObject(v5, (char *)mem);
        int32_t * result = v5; // 0x8148e83
        if (v2) {
            // 0x8148f33
            return result;
        }
        int32_t v6 = lex(fp); // 0x8148e8b
        if (v6 != 4) {
            // 0x8148eec
            result = v5;
            if ((int32_t *)v6 == (int32_t *)6) {
                return result;
            } else {
                // 0x8148ef8
                HTList_delete(v5);
                syntax_error(fp, "Expecting ')' closing user/group list", v6);
                result = NULL;
                return result;
            }
        }
        int32_t v7 = lex(fp); // 0x8148e9f
        while (v7 == 2) {
            // 0x8148e99
            v7 = lex(fp);
        }
        if ((int32_t *)v7 != (int32_t *)8) {
            // 0x8148eb7
            syntax_error(fp, "Expecting user or group name", v7);
            HTList_delete(v5);
            result = NULL;
            return result;
        }
        mem = calloc(1, 8);
    }
    // 0x8148e33
    outofmem("../../../WWW/Library/Implementation/HTGroup.c", "parse_user_part");
    // UNREACHABLE
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTGroup.c
// Address range: 0x8148f38 - 0x814909a
// Line range:    201 - 242
int32_t * parse_item(struct _IO_FILE * fp) {
    int32_t v1 = lex(fp); // 0x8148f59
    int32_t * v2 = (int32_t *)v1; // 0x8148f5e
    int32_t * v3 = NULL; // 0x8148f65
    int32_t * v4 = v2; // 0x8148f65
    if (v1 != 8 != v2 != (int32_t *)5) {
        // 0x8148f6d
        unlex(v1);
        v3 = parse_user_part(fp);
        v4 = (int32_t *)lex(fp);
    }
    // 0x8148f94
    int32_t * v5; // 0x8148f38
    int32_t * v6; // 0x8148f38
    if (v4 != (int32_t *)7) {
        // 0x8149013
        unlex((int32_t)v4);
        v5 = NULL;
        v6 = v4;
    } else {
        int32_t v7 = lex(fp); // 0x8148fa0
        int32_t * v8 = (int32_t *)v7; // 0x8148fa5
        if (v7 != 8 == (v8 != (int32_t *)9) == (v8 != (int32_t *)5)) {
            if (v3 != NULL) {
                // 0x8148fdb
                HTList_delete(v3);
            }
            // 0x8148fed
            syntax_error(fp, "Expected address part (single address or list)", v7);
            // 0x8149095
            return NULL;
        }
        // 0x8148fba
        unlex(v7);
        v5 = parse_address_part(fp);
        v6 = v8;
    }
    // 0x814901e
    if (v3 == NULL == v5 == NULL) {
        // 0x814902a
        syntax_error(fp, "Empty item not allowed", (int32_t)v6);
        // 0x8149095
        return NULL;
    }
    int32_t * mem = calloc(1, 8); // 0x814905c
    if (mem == NULL) {
        // 0x814906a
        outofmem("../../../WWW/Library/Implementation/HTGroup.c", "parse_item");
        // UNREACHABLE
    }
    // 0x814907e
    *mem = (int32_t)v3;
    *(int32_t *)((int32_t)mem + 4) = (int32_t)v5;
    // 0x8149095
    return mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTGroup.c
// Address range: 0x814909a - 0x8149139
// Line range:    245 - 272
int32_t * parse_item_list(struct _IO_FILE * fp) {
    int32_t * result = HTList_new(); // 0x81490a0
    int32_t * v1 = parse_item(fp); // 0x81490ae
    if (v1 == NULL) {
      lab_0x81490bc:
        // 0x81490bc
        HTList_delete(result);
        // 0x8149134
        return NULL;
    }
    HTList_addObject(result, (char *)v1);
    int32_t v2 = lex(fp); // 0x81490ef
    while (v2 == 4) {
        int32_t v3 = lex(fp); // 0x8149116
        while (v3 == 2) {
            // 0x8149110
            v3 = lex(fp);
        }
        // 0x8149124
        unlex(v3);
        int32_t * v4 = parse_item(fp); // 0x81490ae
        if (v4 == NULL) {
            goto lab_0x81490bc;
        }
        HTList_addObject(result, (char *)v4);
        v2 = lex(fp);
    }
    // 0x81490fd
    unlex(v2);
    // 0x8149134
    return result;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTGroup.c
// Address range: 0x8149139 - 0x81491e6
// Line range:    275 - 294
int32_t * HTAA_parseGroupDef(struct _IO_FILE * fp) {
    int32_t * v1 = parse_item_list(fp); // 0x8149153
    if (v1 == NULL) {
        // 0x81491e1
        return NULL;
    }
    int32_t * mem = calloc(1, 8); // 0x8149179
    if (mem == NULL) {
        // 0x8149187
        outofmem("../../../WWW/Library/Implementation/HTGroup.c", "HTAA_parseGroupDef");
        // UNREACHABLE
    }
    // 0x814919b
    *mem = 0;
    *(int32_t *)((int32_t)mem + 4) = (int32_t)v1;
    int32_t v2 = lex(fp); // 0x81491b3
    if (v2 != 2) {
        // 0x81491c1
        syntax_error(fp, "Garbage after group definition", v2);
    }
    // 0x81491e1
    return mem;
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTGroup.c
// Address range: 0x81491e6 - 0x814945a
// Line range:    392 - 419
void print_item(int32_t * item) {
    if (item == NULL) {
        // 0x81491f3
        fwrite((int32_t *)"\tNULL-ITEM\n", 1, 11, TraceFP());
        // 0x8149454
        return;
    }
    int32_t v1 = *item; // 0x8149220
    int32_t v2 = *(int32_t *)((int32_t)item + 4); // 0x8149228
    int32_t v3 = 0; // 0x8149232
    int32_t v4 = 0; // 0x8149232
    if (v1 != 0) {
        int32_t v5 = *(int32_t *)(v1 + 4); // 0x8149237
        v3 = 0;
        v4 = 0;
        if (v5 != 0) {
            // 0x8149243
            v3 = v5;
            v4 = *(int32_t *)v5;
        }
    }
    int32_t v6 = 0; // 0x814925e
    int32_t v7 = 0; // 0x814925e
    if (v2 != 0) {
        int32_t v8 = *(int32_t *)(v2 + 4); // 0x8149263
        v6 = 0;
        v7 = 0;
        if (v8 != 0) {
            // 0x814926f
            v6 = v8;
            v7 = *(int32_t *)v8;
        }
    }
    // 0x8149280
    if (v4 == 0) {
        // 0x8149369
        fwrite((int32_t *)"\tANYBODY ", 1, 9, TraceFP());
    } else {
        char * v9 = *(int32_t *)(v4 + 4) == 0 ? (char *)&g84 : "*REF*";
        fprintf(TraceFP(), "\t[%s%s", (char *)*(int32_t *)v4, v9);
        if (v3 != 0) {
            int32_t v10 = *(int32_t *)(v3 + 4); // 0x8149319
            int32_t v11 = v10; // 0x8149323
            if (v10 != 0) {
                int32_t v12 = *(int32_t *)v11; // 0x8149328
                while (v12 != 0) {
                    char * v13 = *(int32_t *)(v12 + 4) == 0 ? (char *)&g84 : "*REF*";
                    fprintf(TraceFP(), "; %s%s", (char *)*(int32_t *)v12, v13);
                    int32_t v14 = *(int32_t *)(v11 + 4); // 0x8149319
                    v11 = v14;
                    if (v14 == 0) {
                        // break -> 0x8149342
                        break;
                    }
                    v12 = *(int32_t *)v11;
                }
            }
        }
        // 0x8149342
        fwrite((int32_t *)"] ", 1, 2, TraceFP());
    }
    if (v7 == 0) {
        // 0x814942f
        fwrite((int32_t *)"@ ANYADDRESS\n", 1, 13, TraceFP());
        // 0x8149454
        return;
    }
    // 0x8149398
    fprintf(TraceFP(), "@ [%s", (char *)*(int32_t *)v7);
    if (v6 != 0) {
        int32_t v15 = *(int32_t *)(v6 + 4); // 0x81493df
        int32_t v16 = v15; // 0x81493e9
        if (v15 == 0) {
            // 0x8149408
            fwrite((int32_t *)"]\n", 1, 2, TraceFP());
            // 0x8149454
            return;
        }
        int32_t v17 = *(int32_t *)v16; // 0x81493ee
        while (v17 != 0) {
            // 0x81493b8
            fprintf(TraceFP(), "; %s", (char *)*(int32_t *)v17);
            v16 += 4;
            if (v16 == 0) {
                // break -> 0x8149408
                break;
            }
            v17 = *(int32_t *)v16;
        }
    }
    // 0x8149408
    fwrite((int32_t *)"]\n", 1, 2, TraceFP());
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTGroup.c
// Address range: 0x814945a - 0x81494d2
// Line range:    422 - 431
void print_item_list(int32_t * item_list) {
    if (item_list == NULL) {
        // 0x814946c
        fwrite((int32_t *)"EMPTY", 1, 5, TraceFP());
        // 0x81494d0
        return;
    }
    int32_t v1 = *(int32_t *)((int32_t)item_list + 4); // 0x81494a7
    if (v1 == 0) {
        // 0x81494d0
        return;
    }
    int32_t v2 = v1; // 0x81494b1
    int32_t v3 = *(int32_t *)v2; // 0x81494b6
    while (v3 != 0) {
        // 0x8149493
        print_item((int32_t *)v3);
        v2 += 4;
        if (v2 == 0) {
            // break -> 0x81494d0
            break;
        }
        v3 = *(int32_t *)v2;
    }
}

// From module:   /home/naftali/source/lynx-cur-2.8.7dev11/WWW/Library/Implementation/../../../WWW/Library/Implementation/HTGroup.c
// Address range: 0x81494d2 - 0x8149560
// Line range:    434 - 445
void HTAA_printGroupDef(int32_t * group_def) {
    if (group_def != NULL) {
        int32_t v1 = *group_def; // 0x8149508
        fprintf(TraceFP(), "\nGroup %s:\n", v1 == 0 ? "NULL" : (char *)v1);
        print_item_list(&((struct _IO_FILE *)*(int32_t *)((int32_t)group_def + 4))->e0);
        fputc(10, TraceFP());
    } else {
        // 0x81494de
        fwrite((int32_t *)"\nNULL RECORD\n", 1, 13, TraceFP());
    }
}

// Address range: 0x8149560 - 0x81496ed
int32_t __divdi3(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    int32_t v1; // 0x8149560
    int32_t v2; // 0x8149560
    int32_t v3; // 0x8149560
    int32_t v4; // 0x8149560
    int32_t v5; // 0x8149560
    int32_t v6; // 0x8149560
    int32_t v7; // 0x8149560
    int32_t v8; // 0x8149560
    if (a2 < 0) {
        int32_t v9 = -a1; // 0x8149613
        int32_t v10 = -(((int32_t)(a1 != 0) + a2)); // 0x8149618
        v7 = -1;
        v1 = a3;
        v4 = a4;
        v5 = v9;
        v2 = v10;
        v8 = 0;
        v6 = v9;
        v3 = v10;
        if (a4 >= 0) {
            goto lab_0x8149594;
        } else {
            goto lab_0x8149629;
        }
    } else {
        // 0x8149589
        v7 = 0;
        v1 = a3;
        v4 = a4;
        v5 = a1;
        v2 = a2;
        v8 = -1;
        v6 = a1;
        v3 = a2;
        if (a4 < 0) {
            goto lab_0x8149629;
        } else {
            goto lab_0x8149594;
        }
    }
  lab_0x8149594:;
    uint32_t v11 = v2;
    uint32_t v12 = v1;
    int32_t v13; // 0x8149560
    if (v4 == 0) {
        int32_t v14; // 0x8149560
        if (v12 > v11) {
            // 0x81495aa
            v14 = (0x100000000 * (int64_t)v11 | (int64_t)v5) / (int64_t)v12;
        } else {
            uint32_t v15 = v12 != 0 ? v12 : (int32_t)(v12 == 1);
            v14 = (0x100000000 * (int64_t)(v11 % v15) | (int64_t)v5) / (int64_t)v15;
        }
        // 0x81495c5
        v13 = v14;
        return v7 == 0 ? v13 : -v13;
    }
    // 0x81495b8
    if (v4 > v11) {
        // 0x81495c5
        v13 = 0;
        return v7 == 0 ? v13 : -v13;
    }
    uint32_t v16 = llvm_ctlz_i32(v4, true); // 0x8149640
    if (v16 == 0) {
        // 0x81495c5
        v13 = v12 <= v5 | v4 < v11;
        return v7 == 0 ? v13 : -v13;
    }
    uint32_t v17 = -v16 % 32; // 0x814967f
    uint64_t v18 = 0x100000000 * (int64_t)(v11 >> v17) | (int64_t)(v5 >> v17 | v11 << v16); // 0x81496ab
    uint64_t v19 = (int64_t)(v12 >> v17 | v4 << v16); // 0x81496ab
    uint64_t v20 = v18 / v19; // 0x81496ab
    int32_t v21 = v20; // 0x81496ab
    uint32_t v22 = (int32_t)(v18 % v19); // 0x81496ab
    uint64_t v23 = (v20 & 0xffffffff) * (int64_t)(v12 << v16); // 0x81496b5
    uint32_t v24 = (int32_t)(v23 / 0x100000000); // 0x81496b5
    if (v22 < v24) {
        // 0x81495c5
        v13 = v21 - 1;
        return v7 == 0 ? v13 : -v13;
    }
    // 0x81496be
    if (v22 != v24 || v5 << v16 >= (int32_t)v23) {
        // 0x81495c5
        v13 = v21;
        return v7 == 0 ? v13 : -v13;
    }
    // 0x81495c5
    v13 = v21 - 1;
    return v7 == 0 ? v13 : -v13;
  lab_0x8149629:
    // 0x8149629
    v7 = v8;
    v1 = -a3;
    v4 = -(((int32_t)(a3 != 0) + a4));
    v5 = v6;
    v2 = v3;
    goto lab_0x8149594;
}

// Address range: 0x814975a - 0x814975e
int32_t __i686_get_pc_thunk_bx(int32_t a1) {
    // 0x814975a
    int32_t result; // 0x814975a
    return result;
}

// Address range: 0x8149760 - 0x8149792
int32_t stat64(int32_t a1, int32_t * a2) {
    // 0x8149760
    int32_t v1; // 0x8149760
    return __xstat64(3, (char *)a1, (struct stat64 *)__i686_get_pc_thunk_bx(v1));
}

// Address range: 0x81497a0 - 0x81497d2
int32_t lstat64(int32_t a1, int32_t * a2) {
    // 0x81497a0
    int32_t v1; // 0x81497a0
    return __lxstat64(3, (char *)a1, (struct stat64 *)__i686_get_pc_thunk_bx(v1));
}

// --------------- Dynamically Linked Functions ---------------

// void __assert_fail(const char * assertion, const char * file, unsigned int line, const char * function);
// const unsigned short int ** __ctype_b_loc(void);
// int * __errno_location(void);
// int __lxstat64(int ver, const char * filename, struct stat64 * stat_buf);
// void __stack_chk_fail(void);
// int __xstat64(int ver, const char * filename, struct stat64 * stat_buf);
// void _exit(int status);
// int _IO_getc(_IO_FILE * fp);
// int32_t assume_default_colors(void);
// double atof(const char * nptr);
// int atoi(const char * nptr);
// long int atol(const char * nptr);
// char * bindtextdomain(const char * domainname, const char * dirname);
// void * bsearch(const void * key, const void * base, size_t nmemb, size_t size, __compar_fn_t compar);
// void * calloc(size_t nmemb, size_t size);
// int32_t cbreak(void);
// int chdir(const char * path);
// int chmod(const char * file, __mode_t mode);
// void clearerr(FILE * stream);
// int32_t clearok(void);
// int close(int fd);
// void closelog(void);
// char * ctermid(char * s);
// char * ctime(const time_t * timer);
// int32_t define_key(void);
// int32_t delwin(void);
// int32_t derwin(void);
// int32_t doupdate(void);
// int32_t echo(void);
// int32_t endwin(void);
// int execv(const char * path, char * const argv[]);
// void exit(int status);
// int fclose(FILE * stream);
// FILE * fdopen(int fd, const char * modes);
// int feof(FILE * stream);
// int ferror(FILE * stream);
// int fflush(FILE * stream);
// int fgetc(FILE * stream);
// char * fgets(char * restrict s, int n, FILE * restrict stream);
// int fileno(FILE * stream);
// FILE * fopen64(const char * restrict filename, const char * restrict modes);
// __pid_t fork(void);
// int fprintf(FILE * restrict stream, const char * restrict format, ...);
// int fputc(int c, FILE * stream);
// int fputs(const char * restrict s, FILE * restrict stream);
// size_t fread(void * restrict ptr, size_t size, size_t n, FILE * restrict stream);
// void free(void * ptr);
// FILE * freopen64(const char * restrict filename, const char * restrict modes, FILE * restrict stream);
// size_t fwrite(const void * restrict ptr, size_t size, size_t n, FILE * restrict s);
// int getaddrinfo(const char * restrict name, const char * restrict service, const struct addrinfo * restrict req, struct addrinfo ** restrict pai);
// char * getcwd(char * buf, size_t size);
// char * getenv(const char * name);
// __uid_t geteuid(void);
// struct group * getgrgid(__gid_t gid);
// int getgroups(int size, __gid_t list[]);
// struct hostent * gethostbyname(const char * name);
// int gethostname(char * name, size_t len);
// int32_t getmouse(void);
// __pid_t getpid(void);
// struct passwd * getpwuid(__uid_t uid);
// char * gettext(const char * msgid);
// int gettimeofday(struct timeval * restrict tv, __timezone_ptr_t tz);
// __uid_t getuid(void);
// int32_t has_colors(void);
// size_t iconv(iconv_t cd, char ** restrict inbuf, size_t * restrict inbytesleft, char ** restrict outbuf, size_t * restrict outbytesleft);
// int iconv_close(iconv_t cd);
// iconv_t iconv_open(const char * tocode, const char * fromcode);
// int32_t init_pair(void);
// int32_t initscr(void);
// int ioctl(int fd, unsigned long int request, ...);
// int isatty(int fd);
// int32_t keypad(void);
// int kill(__pid_t pid, int sig);
// void * malloc(size_t size);
// int memcmp(const void * s1, const void * s2, size_t n);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memset(void * s, int c, size_t n);
// int mkdir(const char * path, __mode_t mode);
// char * mkdtemp(char * template);
// int32_t mouseinterval(void);
// int32_t mousemask(void);
// int32_t napms(void);
// int32_t newpad(void);
// int32_t newwin(void);
// int32_t nl(void);
// char * nl_langinfo(nlitem __item);
// int32_t noecho(void);
// int32_t nonl(void);
// int open64(const char * file, int oflag, ...);
// void openlog(const char * ident, int option, int facility);
// int32_t pair_content(void);
// int pclose(FILE * stream);
// void perror(const char * s);
// int pipe(int pipedes[2]);
// int32_t pnoutrefresh(void);
// FILE * popen(const char * command, const char * modes);
// int printf(const char * restrict format, ...);
// int putchar(int c);
// int putenv(char * string);
// int puts(const char * s);
// void qsort(void * base, size_t nmemb, size_t size, __compar_fn_t compar);
// long int random(void);
// ssize_t read(int fd, void * buf, size_t nbytes);
// ssize_t readlink(const char * restrict path, char * restrict buf, size_t len);
// void * realloc(void * ptr, size_t size);
// int remove(const char * filename);
// int rename(const char * old, const char * new);
// int32_t resizeterm(void);
// int rmdir(const char * path);
// int32_t scrollok(void);
// int select(int nfds, fd_set * restrict readfds, fd_set * restrict writefds, fd_set * restrict exceptfds, struct timeval * restrict timeout);
// char * setlocale(int category, const char * locale);
// int sigaction(int sig, const struct sigaction * restrict act, struct sigaction * restrict oact);
// int sigaddset(sigset_t * set, int signo);
// int sigemptyset(sigset_t * set);
// __sighandler_t signal(int sig, __sighandler_t handler);
// int sigprocmask(int how, const sigset_t * restrict set, sigset_t * restrict oset);
// unsigned int sleep(unsigned int seconds);
// int sprintf(char * restrict s, const char * restrict format, ...);
// void srandom(unsigned int seed);
// int sscanf(const char * restrict s, const char * restrict format, ...);
// int32_t start_color(void);
// char * strcat(char * restrict dest, const char * restrict src);
// char * strchr(char * s, int c);
// int strcmp(const char * s1, const char * s2);
// char * strcpy(char * restrict dest, const char * restrict src);
// char * strerror(int errnum);
// size_t strlen(const char * s);
// char * strncat(char * restrict dest, const char * restrict src, size_t n);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strncpy(char * restrict dest, const char * restrict src, size_t n);
// char * strpbrk(char * s, const char * accept);
// char * strrchr(char * s, int c);
// char * strstr(char * haystack, const char * needle);
// double strtod(const char * restrict nptr, char ** restrict endptr);
// char * strtok(char * restrict s, const char * restrict delim);
// long int strtol(const char * restrict nptr, char ** restrict endptr, int base);
// void syslog(int pri, const char * fmt, ...);
// int system(const char * command);
// int tcsetattr(int fd, int optional_actions, const struct termios * termios_p);
// char * textdomain(const char * domainname);
// time_t time(time_t * timer);
// int tolower(int c);
// int toupper(int c);
// int truncate64(const char * file, __off64_t length);
// char * ttyname(int fd);
// __mode_t umask(__mode_t mask);
// int ungetc(int c, FILE * stream);
// int32_t ungetmouse(void);
// int unsetenv(const char * name);
// int vasprintf(char ** restrict ptr, const char * restrict f, _G_va_list arg);
// int32_t waddch(void);
// int32_t waddnstr(void);
// __pid_t waitpid(__pid_t pid, int * stat_loc, int options);
// int32_t wattr_off(void);
// int32_t wattr_on(void);
// int32_t wbkgd(void);
// int32_t wbkgdset(void);
// int32_t wborder(void);
// int32_t wclear(void);
// int32_t wclrtoeol(void);
// int32_t werase(void);
// int32_t wgetch(void);
// int32_t wmove(void);
// int32_t wnoutrefresh(void);
// int32_t wrefresh(void);
// int32_t wresize(void);
// ssize_t write(int fd, const void * buf, size_t n);
// int32_t wtouchln(void);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (4.3.3)
// Detected functions: 1164


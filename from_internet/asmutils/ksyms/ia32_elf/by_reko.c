// subject_seg08048000_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C(Stack ci8 bArg00, Stack (ptr32 word16) dwArg08, Stack (ptr32 char) dwArg0C)
void fn0804804C(ci8 bArg00, word16 * dwArg08, char * dwArg0C)
{
	int32 eax_108;
	if (bArg00 >= 0x02)
	{
		if (*dwArg08 == 22061)
		{
			fn0804824A(&g_b804826B);
			goto l080480E8;
		}
		if (*dwArg08 != 26669)
			fn0804824A(&g_b8048281);
		if (*dwArg08 == 0x6F2D)
		{
			if (bArg00 < 0x03)
				fn080480F1(null);
			else
				fn080480F1(dwArg0C);
			goto l080480E8;
		}
	}
	eax_108 = sys_query_module();
	word24 eax_24_8_115 = SLICE(eax_108, word24, 8);
	if (eax_108 < 0x00)
		goto l080480EA;
	word32 ecx_46 = g_dw80A82CE;
	char * esi_47 = &g_b80482CA;
	do
	{
		fn080480F1(esi_47);
		do
		{
			byte al_56 = *esi_47;
			++esi_47;
			eax_108 = SEQ(eax_24_8_115, al_56);
		} while (al_56 != 0x00);
		--ecx_46;
	} while (ecx_46 != 0x00);
	if (bArg00 < 0x02)
	{
l080480EA:
		sys_exit(eax_108);
	}
	if (*dwArg08 == 24877)
		fn080480F1(null);
l080480E8:
	eax_108 = 0x00;
	goto l080480EA;
}

// 080480F1: void fn080480F1(Register (ptr32 char) esi)
// Called from:
//      fn0804804C
void fn080480F1(char * esi)
{
	Eq_82 eax_43 = sys_query_module();
	if (eax_43 < 0x00)
	{
		fn08048214(eax_43, 0x10, &g_b80682CA);
		sys_write(0x01, &g_b80682CA, 0x08);
		fn0804824A(&g_b80482B9);
		fn0804824A(&g_b80482C3);
		fn0804824A(esi);
		fn0804824A(&g_b80482BF);
	}
	else
	{
		word32 ecx_185 = g_dw80A82CA;
		struct Eq_91 * dwLoc0C_277 = g_a80882CA;
		do
		{
			fn08048214(dwLoc0C_277->dw0000, 0x10, &g_b80682CA);
			sys_write(0x01, &g_b80682CA, 0x08);
			fn0804824A(&g_b80482C3);
			word32 eax_97 = fn0804824A(dwLoc0C_277->dw0004 + 0x080882CA);
			if (esi != null)
			{
				up32 ecx_111 = 0x20 - eax_97;
				if (ecx_111 > 0x00)
				{
					do
					{
						fn0804824A(&g_b80482C1);
						--ecx_111;
					} while (ecx_111 != 0x00);
				}
				fn0804824A(&g_b80482C3);
				fn0804824A(&g_b80482C6);
				fn0804824A(esi);
				fn0804824A(&g_b80482C8);
			}
			fn0804824A(&g_b80482BF);
			++dwLoc0C_277;
			--ecx_185;
		} while (ecx_185 != 0x01);
	}
}

// 08048214: void fn08048214(Register Eq_82 eax, Register uint32 ecx, Register (ptr32 ci8) edi)
// Called from:
//      fn080480F1
void fn08048214(Eq_82 eax, uint32 ecx, ci8 * edi)
{
	byte cl_22 = (byte) ecx;
	struct Eq_184 * edi_10 = fn0804822C(eax, ecx, edi);
	edi_10->b0000 = 0x09;
	if (cl_22 == 0x10 && (byte) edi - ((byte) edi_10 + 0x01) > ~0x06)
		edi_10->b0001 = 0x09;
}

// 0804822C: Register (ptr32 ci8) fn0804822C(Register Eq_82 eax, Register uint32 ecx, Register (ptr32 ci8) edi)
// Called from:
//      fn08048214
//      fn0804822C
ci8 * fn0804822C(Eq_82 eax, uint32 ecx, ci8 * edi)
{
	uint64 edx_eax_6 = (uint64) eax;
	uint32 edx_9 = (uint32) (edx_eax_6 % ecx);
	byte dl_23 = (byte) edx_9;
	Eq_82 eax_10 = (uint32) (edx_eax_6 /u ecx);
	if (eax_10 != 0x00)
	{
		fn0804822C(eax_10, ecx, edi);
		dl_23 = (byte) edx_9;
	}
	ci8 dl_26 = dl_23 + 0x30;
	if (dl_26 > 0x39)
		dl_26 += 0x27;
	*edi = dl_26;
	return edi + 1;
}

// 0804824A: Register Eq_105 fn0804824A(Register (ptr32 char) esi)
// Called from:
//      fn0804804C
//      fn080480F1
Eq_105 fn0804824A(char * esi)
{
	Eq_105 eax;
	if (esi != null)
	{
		size_t ecx_14 = 0x00;
		esi_18 = esi;
		while (true)
		{
			char * esi_18;
			++esi_18;
			if (*esi_18 == 0x00)
				break;
			ecx_14 = (Eq_105) ((word32) ecx_14 + 1);
		}
		sys_write(0x01, esi, ecx_14);
		eax = ecx_14;
	}
	return eax;
}

char g_b804826B = 'h'; // 0804826B
char g_b8048281 = 'A'; // 08048281
char g_b80482B9 = 'e'; // 080482B9
char g_b80482BF = '\n'; // 080482BF
char g_b80482C1 = ' '; // 080482C1
char g_b80482C3 = ' '; // 080482C3
char g_b80482C6 = '['; // 080482C6
char g_b80482C8 = ']'; // 080482C8
char g_b80482CA = '\0'; // 080482CA
// subject_seg08048000_0002.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

ci8 g_b80682CA = 0x00; // 080682CA
// subject_seg08048000_0004.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

Eq_257 g_a80882CA[] = // 080882CA
	{
	};
// subject_seg08048000_0006.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw80A82CA = 0x00; // 080A82CA
word32 g_dw80A82CE = 0x00; // 080A82CE

// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804806E: void fn0804806E(Stack byte bArg00, Stack (ptr32 byte) dwArg08, Stack (ptr32 byte) dwArg0C)
void fn0804806E(byte bArg00, byte * dwArg08, byte * dwArg0C)
{
	if ((byte) dwArg00 <= 0x03)
	{
		__syscall(0x80);
		__syscall(0x80);
	}
	byte * esi_151 = dwArg08;
	byte * ecx_157 = g_a8048199;
	do
	{
		int32 ebx_149 = 0x00;
		while (true)
		{
			cu8 al_44 = *esi_151;
			byte bl_51 = (byte) ebx_149;
			++esi_151;
			uint32 eax_148 = (uint32) (al_44 - 0x30);
			if (al_44 < 0x30)
				break;
			ebx_149 = ebx_149 *s 0x0A + eax_148;
		}
		*ecx_157 = bl_51;
		++ecx_157;
	} while (ecx_157 != (byte *) 4160454251);
	g_w8048195 = 0x02;
	byte * esi_60 = dwArg0C;
	Eq_49 ebx_142 = 0x00;
	while (true)
	{
		byte al_68 = *esi_60;
		++esi_60;
		if (al_68 == 0x00)
			break;
		ebx_142 = ebx_142 *s 0x0A + (uint32) (al_68 - 0x30);
	}
	g_t80481AB = ebx_142;
	Eq_53 ebx_137 = 0x00;
	while (true)
	{
		byte al_86 = *esi_60;
		++esi_60;
		if (al_86 == 0x00)
			break;
		ebx_137 = ebx_137 *s 0x0A + (uint32) (al_86 - 0x30);
	}
	g_t80481AD = ebx_137;
	uint32 esi_102 = (uint32) g_t80481AB;
	do
	{
		esi_164 = SEQ(esi_16_16_163, si_113 + 0x01);
		word32 esi_108 = fn08048105(esi_102, &g_w8048195);
		word16 si_113 = (word16) esi_108;
		word16 esi_16_16_163 = SLICE(esi_108, word16, 16);
		esi_102 = esi_164;
	} while (si_113 + 0x01 != g_t80481AD);
	__syscall(0x80);
	fn0804817A(0x01, &g_w8048195);
}

// 08048105: Register uint32 fn08048105(Register uint32 esi, Register (ptr32 Eq_99) edi)
// Called from:
//      fn0804806E
uint32 fn08048105(uint32 esi, struct Eq_99 * edi)
{
	word16 si = (word16) esi;
	__syscall(0x80);
	edi->b0003 = (byte) si;
	edi->b0002 = SLICE(si, byte, 8);
	__syscall(0x80);
	__syscall(0x80);
	return esi;
}

// 0804817A: void fn0804817A(Register uint32 eax, Register (ptr32 byte) edi)
// Called from:
//      fn0804806E
//      fn08048105
void fn0804817A(uint32 eax, byte * edi)
{
	word32 ecx_11 = 0x06;
	while (true)
	{
		word24 ecx_24_8_45 = SLICE(ecx_11, word24, 8);
		if (ecx_11 == 0x00)
			break;
		*edi = 0x20;
		++edi;
		--ecx_11;
	}
	uint32 eax_14 = eax;
	uint32 ecx_46 = SEQ(ecx_24_8_45, 0x0A);
	do
	{
		Eq_155 edx_eax_21 = (int64) eax_14;
		--edi;
		*edi = (byte) (edx_eax_21 % ecx_46) + 0x30;
		uint32 eax_27 = (uint32) (edx_eax_21 /u ecx_46);
		eax_14 = eax_27;
	} while (eax_27 != 0x00);
}

word16 g_w8048195 = 0x00; // 08048195
byte g_a8048199[5] = // 08048199
	{
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
	};
Eq_49 g_t80481AB = // 080481AB
	{
		0
	};
Eq_53 g_t80481AD = // 080481AD
	{
		?? /* Can't read address 080481AD */ 
	};

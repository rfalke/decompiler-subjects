/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __noreturn start(); // weak
// int __usercall sub_8048105@<eax>(int@<edi>, __int16@<si>);
// int __usercall sub_804817A@<eax>(int result@<eax>, char *@<edi>);

//-------------------------------------------------------------------------
// Data declarations

char byte_804804D[3] = { 'U', 'S', 'A' }; // weak
char byte_8048195[3]; // weak
int dword_80481AB; // weak


//----- (0804806E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn start()
{
  int v0; // eax
  int v1; // eax
  unsigned __int8 *v2; // esi
  int v3; // ecx
  int v4; // edx
  char i; // bl
  unsigned __int8 v6; // al
  bool v7; // cf
  char v8; // al
  _BYTE *v9; // esi
  int v10; // eax
  int j; // ebx
  int v12; // eax
  int k; // ebx
  __int16 v14; // si
  int v15; // eax
  unsigned __int8 v16; // [esp-10h] [ebp-10h]
  unsigned __int8 *v17; // [esp-8h] [ebp-8h]
  _BYTE *v18; // [esp-4h] [ebp-4h]

  if ( v16 <= 3u )
  {
    v0 = sys_write(1, byte_804804D, 0x21u);
    v1 = sys_exit(1);
  }
  v2 = v17;
  v3 = 0;
  v4 = 0;
  do
  {
    for ( i = 0; ; i = v8 + 10 * i )
    {
      v6 = *v2++;
      ++v4;
      v7 = v6 < 0x30u;
      v8 = v6 - 48;
      if ( v7 )
        break;
    }
    byte_8048195[v3++ + 4] = i;
  }
  while ( v3 != 4 );
  *(_WORD *)byte_8048195 = 2;
  v9 = v18;
  v10 = 0;
  for ( j = 0; ; j = v10 + 10 * j )
  {
    LOBYTE(v10) = *v9++;
    if ( !(_BYTE)v10 )
      break;
    LOBYTE(v10) = v10 - 48;
  }
  dword_80481AB = j;
  v12 = 0;
  for ( k = 0; ; k = v12 + 10 * k )
  {
    LOBYTE(v12) = *v9++;
    if ( !(_BYTE)v12 )
      break;
    LOBYTE(v12) = v12 - 48;
  }
  *(int *)((char *)&dword_80481AB + 2) = k;
  v14 = dword_80481AB;
  do
    sub_8048105((int)byte_8048195, v14++);
  while ( v14 != HIWORD(dword_80481AB) );
  v15 = sys_exit(0);
}
// 80480BA: positive sp value 10 has been found
// 8048072: variable 'v16' is possibly undefined
// 804808F: variable 'v17' is possibly undefined
// 80480B9: variable 'v18' is possibly undefined
// 804806E: using guessed type void __noreturn start();
// 80481AB: using guessed type int dword_80481AB;

//----- (08048105) --------------------------------------------------------
int __usercall sub_8048105@<eax>(int a1@<edi>, __int16 a2@<si>)
{
  __asm { int     80h; LINUX - sys_socket }
  *(_BYTE *)(a1 + 3) = a2;
  *(_BYTE *)(a1 + 2) = HIBYTE(a2);
  __asm { int     80h; LINUX - sys_connect }
  return sys_close(102);
}
// 8048105: could not find valid save-restore pair for ebx

//----- (0804817A) --------------------------------------------------------
int __usercall sub_804817A@<eax>(int result@<eax>, char *a2@<edi>)
{
  char *v2; // edi
  unsigned __int64 v3; // rt2

  memset(a2, 32, 6u);
  v2 = a2 + 6;
  do
  {
    v3 = result % 0xAuLL;
    result /= 0xAuLL;
    *--v2 = v3 + 48;
  }
  while ( result );
  return result;
}

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

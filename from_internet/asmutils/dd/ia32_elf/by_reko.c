// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08048082: void fn08048082(Stack word32 dwArg00, Stack (ptr32 Eq_3) dwArg08)
void fn08048082(word32 dwArg00, struct Eq_3 * dwArg08)
{
	if (dwArg00 == 0x01)
	{
		__syscall(0x80);
		__syscall(0x80);
	}
	g_b804836C = 0x02;
	if (dwArg08 == null)
	{
		__syscall(0x80);
		__syscall(0x80);
		__syscall(0x80);
		Mem77 = Mem54;
		word32 esi_157 = g_dw8048367;
		do
		{
			word32 ecx_120 = 0x0804838B;
			up32 edx_101 = g_dw804836B;
			do
			{
				__syscall(0x80);
				ecx_120 += 0x03;
				edx_101 -= 0x03;
			} while (edx_101 > 0x00);
			++g_dw8048377;
			fn080482A7(ecx_120);
			__syscall(0x80);
			if (ecx_120 != 134513551)
			{
				fn08048153();
				return;
			}
			++g_dw804837B;
			--esi_157;
		} while (esi_157 != 0x00);
	}
	else if (dwArg08->b0000 == 0x666F)
	{
		fn08048149(dwArg08);
		__syscall(0x80);
	}
	else if (dwArg08->b0000 == 0x6669)
		fn08048116(dwArg08);
	else
	{
		word32 * edx_328 = &g_dw8048367;
		if (dwArg08->b0000 != 1853189987)
		{
			edx_328 = &g_dw804836B;
			if (dwArg08->b0000 != 0x7362)
			{
				edx_328 = &g_dw804836F;
				if (dwArg08->b0000 != 0x70696B73)
				{
					edx_328 = &g_dw8048373;
					if (dwArg08->b0000 != 0x6B656573)
					{
						if (dwArg08->b0000 != 0x766E6F63)
							return;
						if (dwArg08[5] == 0x636E7973)
						{
							g_b8048381 = 0x01;
							return;
						}
						else
						{
							if (dwArg08[5] != 0x62617773)
								return;
							g_b8048382 = 0x01;
							return;
						}
					}
				}
			}
		}
		*edx_328 = fn0804832F(fn08048149(dwArg08));
	}
}

// 08048116: void fn08048116(Register (ptr32 Eq_3) esi)
// Called from:
//      fn08048082
void fn08048116(struct Eq_3 * esi)
{
	fn08048149(esi);
	__syscall(0x80);
}

// 08048149: Register (ptr32 Eq_3) fn08048149(Register (ptr32 Eq_3) esi)
// Called from:
//      fn08048082
//      fn08048116
struct Eq_3 * fn08048149(struct Eq_3 * esi)
{
	do
	{
		byte al_5 = esi->b0000;
		++esi;
		if (al_5 == 0x00)
		{
			fn0804816A();
			return;
		}
	} while (al_5 != 0x3D);
	return;
}

// 08048153: void fn08048153()
// Called from:
//      fn08048082
//      fn08048116
void fn08048153()
{
	__syscall(0x80);
	fn080482C8();
	fn0804816A();
}

// 0804816A: Register word32 fn0804816A()
// Called from:
//      fn08048082
//      fn08048149
//      fn0804832F
word32 fn0804816A()
{
	__syscall(0x80);
	g_b8048381 = 0x01;
	return 0x01;
}

// 080482A7: void fn080482A7(Register word32 ecx)
// Called from:
//      fn08048082
void fn080482A7(word32 ecx)
{
	if ((g_b8048382 & 0x01) != 0x00)
	{
		word16 * esi_31 = g_a804838B;
		word16 * edi_32 = g_a804838B;
		word32 ecx_34 = ecx - 0x0804838B;
		if (ecx != 0x0804838B)
		{
			do
			{
				word16 ax_40 = *esi_31;
				*edi_32 = SEQ((byte) ax_40, SLICE(ax_40, byte, 8));
				++esi_31;
				++edi_32;
				--ecx_34;
			} while (ecx_34 != 0x00);
		}
	}
}

// 080482C8: Register word32 fn080482C8()
// Called from:
//      fn08048082
word32 fn080482C8()
{
	struct Eq_217 * edi_10 = fn08048318(g_dw8048377, g_a804838B);
	edi_10->dw0000 = SEQ(0x00, g_b804837F, 0x00) + 0x0020302B;
	edi_10->dw0004 = 170684009;
	struct Eq_217 * edi_32 = fn08048318(g_dw804837B, &edi_10->dw0004 + 1);
	edi_32->dw0000 = SEQ(0x00, g_b8048380, 0x00) + 0x0020302B;
	edi_32->dw0004 = 175404399;
	__syscall(0x80);
	return 0x0804838B;
}

// 08048318: Register (ptr32 byte) fn08048318(Register uint32 eax, Register (ptr32 byte) edi)
// Called from:
//      fn080482C8
byte * fn08048318(uint32 eax, byte * edi)
{
	word32 * esp_19 = fp;
	word32 ecx_24 = 0x00;
	do
	{
		uint64 edx_eax_12 = (uint64) eax;
		uint32 edx_15 = (uint32) (edx_eax_12 % 0x0A);
		esp_19 -= 4;
		*esp_19 = SEQ(SLICE(edx_15, word24, 8), (byte) edx_15 + 0x30);
		uint32 eax_16 = (uint32) (edx_eax_12 /u 0x0A);
		++ecx_24;
		eax = eax_16;
	} while (eax_16 != 0x00);
	do
	{
		*edi = 0x0A;
		++edi;
		--ecx_24;
	} while (ecx_24 != 0x00);
	return edi;
}

// 0804832F: Register Eq_165 fn0804832F(Register (ptr32 byte) esi)
// Called from:
//      fn08048082
Eq_165 fn0804832F(byte * esi)
{
	Eq_165 ebx_27 = 0x00;
	while (true)
	{
		cu8 al_9 = *esi;
		++esi;
		if (al_9 == 0x00)
			break;
		if (al_9 > 0x39)
		{
			if (al_9 != 0x77)
			{
				if (al_9 != 0x62)
				{
					if (al_9 != 0x6B)
					{
						if (al_9 != 0x6D)
							return fn0804816A();
						ebx_27 <<= 0x0A;
					}
					ebx_27 <<= 0x01;
				}
				ebx_27 <<= 0x08;
			}
			ebx_27 <<= 0x01;
			return ebx_27;
		}
		ebx_27 = ebx_27 *s 0x0A + (uint32) (al_9 - 0x30);
	}
	return ebx_27;
}

word32 g_dw8048367 = 0x00; // 08048367
up32 g_dw804836B = 0x00; // 0804836B
byte g_b804836C = 0x00; // 0804836C
word32 g_dw804836F = 0x00; // 0804836F
word32 g_dw8048373 = 0x00; // 08048373
uint32 g_dw8048377 = 0x00; // 08048377
uint32 g_dw804837B = 0x00; // 0804837B
byte g_b804837F = 0x00; // 0804837F
byte g_b8048380 = 0x00; // 08048380
byte g_b8048381 = 0x00; // 08048381
byte g_b8048382 = 0x00; // 08048382
word16 g_a804838B[] = // 0804838B
	{
	};

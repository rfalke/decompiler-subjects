// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C(Stack (ptr32 Eq_2) dwArg04, Stack (ptr32 Eq_2) dwArg08, Stack (ptr32 Eq_2) dwArg0C, Stack (ptr32 Eq_2) dwArg10)
void fn0804804C(struct Eq_2 * dwArg04, struct Eq_2 * dwArg08, struct Eq_2 * dwArg0C, struct Eq_2 * dwArg10)
{
	struct Eq_2 * esi_142 = dwArg04;
	if (dwArg08 != null)
	{
		word32 ebp_201;
		ptr32 esp_55;
		__syscall(0x80);
		ptr32 esp_168 = fp + 0x0C;
		struct Eq_2 * ebx_41 = dwArg08;
		if (dwArg08->t0000 != 28205)
		{
			if (dwArg08->t0000 != 0x6E692D2D)
			{
				ebp_201 = 0x02;
				esp_55 = fp + 0x0C;
			}
			else
			{
				esi_142 = dwArg08;
				do
				{
					Eq_165 al_63 = esi_142->t0000;
					++esi_142;
					if (al_63 == 0x00)
						goto l08048110;
				} while (al_63 != 0x3D);
				ebp_201 = fn0804812B(esi_142);
				ebx_41 = dwArg0C;
				esp_55 = fp + 16;
			}
		}
		else
		{
			ebp_201 = fn0804812B(dwArg0C);
			ebx_41 = dwArg10;
			esp_55 = fp + 20;
		}
		struct Eq_2 * esp_86 = esp_55 - 4;
		esp_86->t0000 = ebx_41;
		esi_142 = esp_86;
		do
		{
			esi_142 = esi_226 + 4;
			esi_226 = esi_142;
		} while (esi_226->t0000 != 0x00);
		esp_86->ptrFFFFFFFC = ebx_41;
		esp_86->ptrFFFFFFF8 = esp_86;
		esp_86->ptrFFFFFFF4 = esi_142;
		while (true)
		{
			struct Eq_62 * esp_108 = esp_55 - 16;
			word32 edx_110 = esp_108->dw0000;
			word32 ecx_112 = esp_108->dw0004;
			word32 ebx_114 = esp_108->dw0008;
			esp_108->dw0008 = 0x02;
			word32 eax_118 = esp_108->dw0008;
			__syscall(0x80);
			if (eax_118 == 0x00)
				break;
			esp_108->dw0008 = ebx_114;
			esp_108->dw0004 = ecx_112;
			esp_108->dw0000 = edx_110;
			esp_108->dwFFFFFFFC = 114;
			__syscall(0x80);
			esp_108->dwFFFFFFFC = 0x00;
			esp_108->dwFFFFFFF8 = ebp_201;
			esp_108->dwFFFFFFF4 = 0x00;
			esp_108->dwFFFFFFF0 = 0x00;
			__syscall(0x80);
			esp_108->dwFFFFFFFC = 0x04;
			esp_108->dwFFFFFFFC = 0x01;
			esp_108->dwFFFFFFFC = 0x04;
			__syscall(0x80);
			esi_142 = esp_108 - 8;
		}
		esp_108->dw0008 = 11;
		__syscall(0x80);
		esp_168 = &esp_108->dw0008 + 1;
l08048110:
		word32 * esp_172 = esp_168 - 4;
		*esp_172 = 0x01;
		*esp_172 = 0x04;
		__syscall(0x80);
	}
	else
		__syscall(0x80);
	__syscall(0x80);
	fn0804812F(esi_142);
}

// 0804812B: Register word32 fn0804812B(Register (ptr32 Eq_2) esi)
// Called from:
//      fn0804804C
word32 fn0804812B(struct Eq_2 * esi)
{
	fn0804812F(esi);
	return 0x00;
}

// 0804812F: void fn0804812F(Register (ptr32 Eq_2) esi)
// Called from:
//      fn0804804C
//      fn0804812B
void fn0804812F(struct Eq_2 * esi)
{
	do
		++esi;
	while (esi->t0000 != 0x00);
}


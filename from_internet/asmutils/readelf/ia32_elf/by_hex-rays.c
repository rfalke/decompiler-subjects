/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall __noreturn start(mode_t@<edx>, int@<ebx>, char *@<esi>);
// void __usercall sub_804838D(char *a1@<esi>);
// void __usercall sub_8048445(__int64 a1@<edx:eax>, char *a2@<esi>);
// void __usercall sub_8048580(int a1@<esi>);
// void __usercall sub_8048689(int a1@<edx>, unsigned __int8 a2@<cl>, int a3@<esi>);
// void __usercall sub_80487FB(int a1@<ebx>, int a2@<esi>);
// int __usercall sub_8048CC6@<eax>(int@<ebx>);
// int __usercall sub_8048CE3@<eax>(int@<ebx>);
void sub_8048D00();
// int __usercall sub_8048D11@<eax>(unsigned int@<eax>, unsigned int@<ecx>, _BYTE *@<edi>);
// __int64 __usercall sub_8048D34@<edx:eax>(__int64@<edx:eax>, int@<ebx>, _BYTE *@<edi>, int@<esi>);

//-------------------------------------------------------------------------
// Data declarations

int dword_804804C[86] =
{
  1734439765,
  1936269413,
  1701978170,
  1818584161,
  1866211430,
  1869182064,
  540963694,
  1818846811,
  1634607205,
  173892973,
  1919248471,
  1866211429,
  1869182064,
  540963694,
  979726945,
  541601056,
  1766072381,
  1634496627,
  1752440953,
  1279598693,
  1768300614,
  1746953580,
  1701077349,
  538970738,
  538976288,
  538976288,
  538976288,
  538976288,
  757080096,
  540876883,
  1886611780,
  544825708,
  543516788,
  1952671091,
  544108393,
  1684104552,
  175338085,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  542125344,
  1766072381,
  1634496627,
  1752440953,
  1919950949,
  1634887535,
  1701322861,
  1919247457,
  538970739,
  538976288,
  538976288,
  538976288,
  538976288,
  757080096,
  540876865,
  2003789907,
  1718511904,
  1634562671,
  1852795252,
  1650532467,
  544503151,
  543976545,
  543516788,
  1987011169,
  1868106341,
  1918967925,
  1969430629,
  1953391986,
  1965062508,
  1735289203,
  1634038304,
  1718379876,
  774927904,
  1344286258,
  1935762796,
  1701978213,
  1953656688,
  1735746080,
  1869881459,
  1701148192,
  1080386916,
  1634562913,
  778135918,
  174944099
}; // weak
char byte_80481A5[3] = { 'r', 'e', 'a' }; // weak
int dword_80481F4[3] = { 1179403530, 1634027552, 980575588 }; // weak
char byte_8048201[3] = { '\n', '\n', 'S' }; // weak
int dword_8048214[4] = { 1917848074, 1634887535, 1699225709, 1919247457 }; // weak
__int16 word_8048226 = 28225; // weak
int dword_8048230[9] =
{
  1701336074,
  1629513074,
  1847616882,
  1702043759,
  1869182051,
  1763734382,
  1752440942,
  1713402729,
  778398825
}; // weak
__int16 word_8048256 = 21514; // weak
__int16 word_8048D79 = 0; // weak
char byte_8048D7B[2] = { 'E', 'T' }; // weak
__int16 word_8048E60[] = { 0 }; // weak
__int16 word_8048E62[] = { 19781 }; // weak
int dword_80490A0[4] = { 2036475936, 544433524, 1869901417, 1818846752 }; // weak
char byte_80490B3 = ' '; // weak
int dword_80490BC[2] = { 1632444448, 979593575 }; // weak
char byte_80490C7 = ' '; // weak
int dword_80490EC[6] = { 1128680517, 1397965132, 673198643, 1647129139, 1864397929, 1667590754 }; // weak
char byte_8049107 = 'E'; // weak
__int16 word_8049122 = 8224; // weak
char byte_8049147 = 'E'; // weak
char byte_8049171[3] = { 'E', 'L', 'F' }; // weak
int dword_8049198[9] =
{
  2035556384,
  540697968,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288
}; // weak
char byte_80491BD[3] = { ' ', ' ', 'M' }; // weak
__int16 word_80491E2 = 8224; // weak
char byte_8049207 = 'E'; // weak
int dword_8049224[6] = { 1314870853, 541412943, 1986939176, 1684630625, 1919252000, 1852795251 }; // weak
__int16 word_804923E = 8224; // weak
char byte_8049263 = ' '; // weak
int dword_8049288[9] =
{
  1951604768,
  544502369,
  1931503215,
  1769235301,
  1746955887,
  1701077349,
  540701554,
  538976288,
  538976288
}; // weak
char byte_80492AD[3] = { ' ', ' ', 'F' }; // weak
int dword_80492D4[9] =
{
  1767055392,
  1864394106,
  1752440934,
  1746957161,
  1701077349,
  538983026,
  538976288,
  538976288,
  538976288
}; // weak
char byte_80492F9[3] = { ' ', ' ', 'S' }; // weak
__int16 word_804931E = 8224; // weak
char byte_8049343 = ' '; // weak
int dword_8049368[9] =
{
  1968054304,
  1919246957,
  543584032,
  1952671091,
  544108393,
  1684104552,
  980644453,
  538976288,
  538976288
}; // weak
char byte_804938D[3] = { ' ', ' ', 'S' }; // weak
char byte_80493B2 = '\n'; // weak
char byte_80493B3[] = { '\0' }; // weak
char byte_80493B7[2] = { 'S', 'H' }; // weak
int dword_8049557 = 0; // weak
char byte_804955B[] = { 'P' }; // weak
char byte_8049615 = '\0'; // weak
char byte_8049616 = '\0'; // weak
char byte_8049617 = '\0'; // weak
int fd = 544747521; // idb
__int16 word_804963E = 30768; // weak
int dword_8049640[9] =
{
  673194016,
  1852534357,
  544110447,
  1763734127,
  1818326638,
  1679844457,
  543257697,
  1868787301,
  1735289188
}; // weak
__int16 word_8049666 = 30768; // weak
int dword_8049668[8] =
{
  538976288,
  1851074592,
  2003791467,
  1651449966,
  1952671082,
  1818846752,
  2037653605,
  170485104
}; // weak
char byte_8049688[2] = { '0', 'x' }; // weak
__int16 word_804968A = 8224; // weak
char byte_80496A4[2] = { '0', 'x' }; // weak
__int16 word_80496A6 = 8224; // weak
__int16 word_80496C2 = 30768; // weak
int dword_80496C4[5] = { 538976288, 1851074592, 2003791467, 1702240366, 1869181810 }; // weak
char byte_80496DB = '0'; // weak
char byte_80496DD[3] = { ' ', ' ', ' ' }; // weak
int dword_80496E8[20] =
{
  1314594848,
  1310743922,
  543518049,
  538976288,
  538976288,
  538976288,
  1886999584,
  538976357,
  538976288,
  538976288,
  1684291872,
  538976370,
  1716461600,
  538976358,
  2053722912,
  538976357,
  1176523589,
  1277192044,
  1850286187,
  1816207462
}; // weak
char byte_8049739[3] = { ' ', ' ', '[' }; // weak
char byte_804973C[3] = { ' ', ' ', ']' }; // weak
char byte_804973F = ' '; // weak
int dword_8049740[4] = { 538976288, 538976288, 538976288, 538976288 }; // weak
__int16 word_8049752 = 8224; // weak
__int16 word_8049762 = 8224; // weak
char byte_804976B = ' '; // weak
__int16 word_8049772 = 8224; // weak
char byte_8049779[3] = { ' ', ' ', ' ' }; // weak
int dword_804977C = 538976288; // weak
int dword_8049780 = 538976288; // weak
char byte_8049784[3] = { ' ', ' ', ' ' }; // weak
char byte_8049787 = ' '; // weak
__int16 word_804978A = 8224; // weak
char byte_80497DB = '\n'; // weak
__int16 word_80497E6 = 8224; // weak
char byte_804980F = ' '; // weak
int dword_8049814[2] = { 1701336074, 1629513074 }; // weak
char byte_804981F = ' '; // weak
__int16 word_8049846 = 8224; // weak
char byte_804984B[]; // weak
char byte_804984F; // weak
char byte_8049850; // weak
__int16 word_804985B; // weak
__int16 word_804985D; // weak
int dword_804985F; // weak
int dword_8049863; // weak
off_t offset; // idb
off_t dword_804986B; // idb
int dword_804986F; // weak
__int16 word_8049877; // weak
__int16 word_804987B; // weak
int dword_804987D; // weak
int dword_8049883; // weak
int dword_8049887; // weak
int dword_804988B; // weak
off_t dword_804988F; // idb
size_t len; // idb
int dword_8049897; // weak
int dword_804989B; // weak
int dword_804989F; // weak
int dword_80498A3; // weak
int dword_80498A7; // weak
int dword_80498AB; // weak
int dword_80498AF; // weak
int dword_80498B3; // weak
int dword_80498B7; // weak
int dword_80498BB; // weak
int dword_80498BF; // weak
int dword_80498C3; // weak
char byte_80498C7; // weak
char byte_80498C9[3]; // weak
__int16 word_80498D8; // weak
__int16 word_80498DA; // weak
__int16 word_80498E1; // weak
char byte_80498E3; // weak
__int16 word_80498EC; // weak
__int16 word_80498EE; // weak
__int16 word_80498F7; // weak
char byte_80498F9[3]; // weak
__int16 word_80498FF; // weak
char byte_8049901[3]; // weak
char byte_8049907; // weak
__int16 word_804990B; // weak
char byte_804990D[3]; // weak
char byte_8049917; // weak
int dword_8049918[256]; // weak
char byte_8049D18; // weak
char byte_8049D1A; // weak
char byte_8049D23; // weak


//----- (08048283) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn start(mode_t a1@<edx>, int a2@<ebx>, char *a3@<esi>)
{
  int v3; // eax
  int v4; // ebx
  int v5; // eax
  _DWORD *v6; // ecx
  int v7; // eax
  int v8; // eax
  int v9; // eax
  char *v10; // ecx
  int v11; // eax
  int v12; // eax
  unsigned int v13; // [esp-10h] [ebp-10h]
  _BYTE *v14; // [esp-8h] [ebp-8h]
  char *v15; // [esp-4h] [ebp-4h]

  if ( v13 >= 3 && *v14 == 45 )
  {
    if ( v14[1] == 72 )
      ++byte_8049615;
    if ( v14[1] == 83 )
      ++byte_8049616;
    if ( v14[1] == 80 )
      ++byte_8049617;
    if ( v14[1] == 65 )
    {
      ++byte_8049617;
      ++byte_8049616;
      ++byte_8049615;
    }
    v4 = sys_open(v15, 0, a1);
    fd = v4;
    v5 = sys_read(v4, byte_804984B, 0x34u);
    if ( *v6 == 1179403647 )
    {
      v9 = sys_write(1, &word_8048226, 0xAu);
      v10 = v15;
      do
        ++v10;
      while ( *v10 );
      v11 = sys_write(1, v15, v10 - v15);
      v12 = sys_write(1, dword_80481F4, 1u);
      if ( byte_8049615 )
        sub_80487FB(1, (int)a3);
      if ( byte_8049616 )
        sub_8048580((int)a3);
      if ( byte_8049617 )
        sub_804838D(a3);
      v3 = sys_close(fd);
    }
    else
    {
      v7 = sys_close(v4);
      v3 = sys_write(1, byte_80481A5, 0x4Fu);
    }
  }
  else
  {
    v3 = sys_write(a2, dword_804804C, 0x159u);
  }
  v8 = sys_exit(v3);
}
// 80482E1: positive sp value 10 has been found
// 8048287: variable 'v13' is possibly undefined
// 804829F: variable 'v14' is possibly undefined
// 80482EA: variable 'v15' is possibly undefined
// 8048302: variable 'v6' is possibly undefined
// 804804C: using guessed type int dword_804804C[86];
// 80481F4: using guessed type int dword_80481F4[3];
// 8048226: using guessed type __int16 word_8048226;
// 8049615: using guessed type char byte_8049615;
// 8049616: using guessed type char byte_8049616;
// 8049617: using guessed type char byte_8049617;

//----- (0804838D) --------------------------------------------------------
void __usercall sub_804838D(char *a1@<esi>)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax
  int v4; // eax
  int v5; // eax
  __int64 v6; // rax
  __int16 v7; // cx

  if ( word_8049877 )
  {
    sub_8048D11((unsigned __int16)word_8049877, 0xAu, &byte_804981F);
    *(_DWORD *)&byte_8049D23 = a1;
    sub_8048D11(offset, 0x10u, &word_8049846);
    *(_DWORD *)&byte_8049D23 = a1;
    v2 = sys_write(1, dword_8049814, 0x37u);
    v3 = sys_write(1, dword_8048214, 0x12u);
    v4 = sys_write(1, &word_804978A, 0x51u);
    v5 = sys_lseek(fd, offset, 0);
    do
    {
      LODWORD(v6) = sys_read(fd, &dword_80498A7, 0x20u);
      sub_8048445(v6, a1);
    }
    while ( v7 + 1 != word_8049877 );
  }
  else
  {
    v1 = sys_write(1, &word_8048256, 0x2Du);
  }
}
// 804838D: could not find valid save-restore pair for ebp
// 8048435: variable 'v6' is possibly undefined
// 804843A: variable 'v7' is possibly undefined
// 8048214: using guessed type int dword_8048214[4];
// 8048256: using guessed type __int16 word_8048256;
// 804978A: using guessed type __int16 word_804978A;
// 8049814: using guessed type int dword_8049814[2];
// 804981F: using guessed type char byte_804981F;
// 8049846: using guessed type __int16 word_8049846;
// 8049877: using guessed type __int16 word_8049877;
// 80498A7: using guessed type int dword_80498A7;
// 8049D23: using guessed type char byte_8049D23;

//----- (08048445) --------------------------------------------------------
void __usercall sub_8048445(__int64 a1@<edx:eax>, char *a2@<esi>)
{
  int v2; // ebp
  __int64 v3; // rax
  __int64 v4; // rax
  __int64 v5; // rax
  __int64 v6; // rax
  char v7; // al
  int v8; // eax

  memset(&byte_80498C7, 32, 0x50u);
  v2 = 0;
  while ( dword_80498A7 != *(int *)((char *)&dword_8049557 + v2) )
  {
    v2 += 19;
    if ( v2 == 190 )
      goto LABEL_5;
  }
  qmemcpy(byte_80498C9, &byte_804955B[v2], 0xFu);
  a2 = &byte_804955B[v2 + 15];
LABEL_5:
  word_80498D8 = 30768;
  LODWORD(a1) = dword_80498AB;
  v3 = sub_8048D34(a1, 6, &word_80498DA, (int)a2);
  word_80498E1 = 30768;
  LODWORD(v3) = dword_80498AF;
  v4 = sub_8048D34(v3, 8, &byte_80498E3, (int)a2);
  word_80498EC = 30768;
  LODWORD(v4) = dword_80498B3;
  v5 = sub_8048D34(v4, 8, &word_80498EE, (int)a2);
  word_80498F7 = 30768;
  LODWORD(v5) = dword_80498B7;
  v6 = sub_8048D34(v5, 5, byte_80498F9, (int)a2);
  word_80498FF = 30768;
  LODWORD(v6) = dword_80498BB;
  sub_8048D34(v6, 5, byte_8049901, (int)a2);
  v7 = dword_80498BF;
  if ( (dword_80498BF & 4) != 0 )
    byte_8049907 = 82;
  if ( (dword_80498BF & 2) != 0 )
    *(&byte_8049907 + 1) = 87;
  if ( (v7 & 1) != 0 )
    *(&byte_8049907 + 2) = 88;
  word_804990B = 30768;
  sub_8048D11(dword_80498C3, 0x10u, byte_804990D);
  *(_DWORD *)&byte_8049D23 = a2;
  byte_8049917 = 10;
  v8 = sys_write(1, &byte_80498C7, 0x51u);
}
// 8049557: using guessed type int dword_8049557;
// 80498A7: using guessed type int dword_80498A7;
// 80498AB: using guessed type int dword_80498AB;
// 80498AF: using guessed type int dword_80498AF;
// 80498B3: using guessed type int dword_80498B3;
// 80498B7: using guessed type int dword_80498B7;
// 80498BB: using guessed type int dword_80498BB;
// 80498BF: using guessed type int dword_80498BF;
// 80498C3: using guessed type int dword_80498C3;
// 80498C7: using guessed type char byte_80498C7;
// 80498D8: using guessed type __int16 word_80498D8;
// 80498DA: using guessed type __int16 word_80498DA;
// 80498E1: using guessed type __int16 word_80498E1;
// 80498E3: using guessed type char byte_80498E3;
// 80498EC: using guessed type __int16 word_80498EC;
// 80498EE: using guessed type __int16 word_80498EE;
// 80498F7: using guessed type __int16 word_80498F7;
// 80498FF: using guessed type __int16 word_80498FF;
// 8049907: using guessed type char byte_8049907;
// 804990B: using guessed type __int16 word_804990B;
// 8049917: using guessed type char byte_8049917;
// 8049D23: using guessed type char byte_8049D23;

//----- (08048580) --------------------------------------------------------
void __usercall sub_8048580(int a1@<esi>)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax
  int v4; // eax
  int v5; // ebx
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  __int16 v11; // cx
  int v12; // eax
  int v13; // edx
  __int16 v14; // cx
  unsigned __int8 v15; // [esp-4h] [ebp-4h]

  if ( word_804987B )
  {
    sub_8048D11((unsigned __int16)word_804987B, 0xAu, &word_80497E6);
    *(_DWORD *)&byte_8049D23 = a1;
    sub_8048D11(dword_804986B, 0x10u, &byte_804980F);
    *(_DWORD *)&byte_8049D23 = a1;
    v2 = sys_write(1, &byte_80497DB, 0x39u);
    v3 = sys_write(1, byte_8048201, 0x13u);
    v4 = sys_write(1, dword_80496E8, 0x51u);
    v5 = fd;
    v6 = sys_lseek(fd, dword_804986B + 40 * dword_804987D, 0);
    v7 = sys_read(v5, (char *)&dword_804987D + 2, 0x28u);
    v8 = sys_lseek(v5, dword_804988F, 0);
    v9 = sys_read(v5, dword_8049918, len);
    v10 = sys_lseek(fd, dword_804986B, 0);
    LOBYTE(v11) = 0;
    do
    {
      v15 = v11;
      v12 = sys_read(fd, (char *)&dword_804987D + 2, 0x28u);
      sub_8048689(v13, v15, a1);
      v11 = v14 + 1;
    }
    while ( v11 != word_804987B );
  }
  else
  {
    v1 = sys_write(1, dword_8048230, 0x26u);
  }
}
// 8048580: could not find valid save-restore pair for ebp
// 8048679: variable 'v13' is possibly undefined
// 804867E: variable 'v14' is possibly undefined
// 8048230: using guessed type int dword_8048230[9];
// 80496E8: using guessed type int dword_80496E8[20];
// 80497DB: using guessed type char byte_80497DB;
// 80497E6: using guessed type __int16 word_80497E6;
// 804980F: using guessed type char byte_804980F;
// 804987B: using guessed type __int16 word_804987B;
// 804987D: using guessed type int dword_804987D;
// 8049918: using guessed type int dword_8049918[256];
// 8049D23: using guessed type char byte_8049D23;

//----- (08048689) --------------------------------------------------------
void __usercall sub_8048689(int a1@<edx>, unsigned __int8 a2@<cl>, int a3@<esi>)
{
  char *v3; // edi
  __int64 v4; // rax
  char *v5; // esi
  int *v6; // edi
  char v7; // al
  int v8; // ebp
  __int64 v9; // rax
  __int64 v10; // rax
  char *v11; // edi
  char v12; // al
  int *v13; // edi
  char *v14; // edi
  int v15; // eax

  v3 = byte_804973C;
  if ( a2 <= 9u )
    v3 = &byte_804973C[1];
  sub_8048D11(a2, 0xAu, v3);
  *(_DWORD *)&byte_8049D23 = a3;
  HIDWORD(v4) = a1;
  memset(&byte_804973F, 32, 0x4Au);
  v5 = (char *)dword_8049918 + *(int *)((char *)&dword_804987D + 2);
  v6 = dword_8049740;
  do
  {
    v7 = *v5++;
    *(_BYTE *)v6 = v7;
    v6 = (int *)((char *)v6 + 1);
  }
  while ( v7 );
  *((_BYTE *)v6 - 1) = 32;
  v8 = 0;
  while ( dword_8049883 != *(_DWORD *)&byte_80493B3[v8] )
  {
    v8 += 21;
    if ( v8 == 420 )
      goto LABEL_9;
  }
  qmemcpy(&word_8049752, &byte_80493B7[v8], 0x11u);
  v5 = &byte_80493B7[v8 + 17];
LABEL_9:
  LODWORD(v4) = dword_804988B;
  v9 = sub_8048D34(v4, 8, &word_8049762, (int)v5);
  LODWORD(v9) = dword_804988F;
  v10 = sub_8048D34(v9, 6, &byte_804976B, (int)v5);
  LODWORD(v10) = len;
  sub_8048D34(v10, 6, &word_8049772, (int)v5);
  v11 = byte_8049779;
  if ( (unsigned __int8)dword_80498A3 <= 0xFu )
  {
    byte_8049779[0] = 48;
    v11 = &byte_8049779[1];
  }
  sub_8048D11((unsigned __int8)dword_80498A3, 0x10u, v11);
  *(_DWORD *)&byte_8049D23 = v5;
  v12 = dword_8049887;
  if ( (dword_8049887 & 1) != 0 )
    LOBYTE(dword_804977C) = 87;
  if ( (dword_8049887 & 2) != 0 )
    BYTE1(dword_804977C) = 65;
  if ( (v12 & 4) != 0 )
    BYTE2(dword_804977C) = 88;
  v13 = &dword_8049780;
  if ( (unsigned __int8)dword_8049897 <= 9u )
    v13 = (int *)((char *)&dword_8049780 + 1);
  sub_8048D11((unsigned __int8)dword_8049897, 0xAu, v13);
  *(_DWORD *)&byte_8049D23 = v5;
  v14 = byte_8049784;
  if ( (unsigned __int8)dword_804989B <= 0xFu )
    v14 = &byte_8049784[1];
  sub_8048D11((unsigned __int8)dword_804989B, 0x10u, v14);
  *(_DWORD *)&byte_8049D23 = v5;
  sub_8048D11((unsigned __int8)dword_804989F, 0xAu, &byte_8049787);
  *(_DWORD *)&byte_8049D23 = v5;
  v15 = sys_write(1, byte_8049739, 0x51u);
}
// 804973F: using guessed type char byte_804973F;
// 8049740: using guessed type int dword_8049740[4];
// 8049752: using guessed type __int16 word_8049752;
// 8049762: using guessed type __int16 word_8049762;
// 804976B: using guessed type char byte_804976B;
// 8049772: using guessed type __int16 word_8049772;
// 804977C: using guessed type int dword_804977C;
// 8049780: using guessed type int dword_8049780;
// 8049787: using guessed type char byte_8049787;
// 804987D: using guessed type int dword_804987D;
// 8049883: using guessed type int dword_8049883;
// 8049887: using guessed type int dword_8049887;
// 804988B: using guessed type int dword_804988B;
// 8049897: using guessed type int dword_8049897;
// 804989B: using guessed type int dword_804989B;
// 804989F: using guessed type int dword_804989F;
// 80498A3: using guessed type int dword_80498A3;
// 8049918: using guessed type int dword_8049918[256];
// 8049D23: using guessed type char byte_8049D23;

//----- (080487FB) --------------------------------------------------------
void __usercall sub_80487FB(int a1@<ebx>, int a2@<esi>)
{
  int v2; // eax
  int v3; // eax
  int i; // ebp
  char *v5; // edi
  unsigned int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int *v10; // ecx
  size_t v11; // edx
  int v12; // eax
  int v13; // eax
  char *v14; // ecx
  size_t v15; // edx
  int v16; // eax
  int v17; // eax
  int j; // ebp
  char *v19; // ecx
  size_t v20; // edx
  int v21; // eax
  int v22; // eax
  int k; // ebp
  __int16 *v24; // ecx
  int v25; // eax
  int v26; // eax
  __int16 *v27; // ecx
  size_t v28; // edx
  int v29; // eax
  int v30; // eax
  int v31; // eax
  int v32; // eax
  int v33; // eax
  int v34; // eax
  int v35; // eax
  int v36; // eax
  unsigned int v37; // eax
  int v38; // eax
  unsigned int v39; // eax
  int v40; // eax
  unsigned int v41; // eax
  int v42; // eax
  int v43; // eax
  unsigned int v44; // eax
  int v45; // eax
  unsigned int v46; // eax
  int v47; // eax
  int v48; // eax
  unsigned int v49; // eax
  int v50; // eax

  v2 = sys_write(a1, dword_80481F4, 0xDu);
  v3 = sys_write(a1, dword_80490BC, 0xBu);
  for ( i = 0; i != 16; ++i )
  {
    v5 = &byte_8049D18;
    v6 = (unsigned __int8)byte_804984B[i];
    if ( (unsigned __int8)v6 <= 9u )
    {
      byte_8049D18 = 48;
      v5 = &byte_8049D18 + 1;
    }
    sub_8048D11(v6, 0x10u, v5);
    *(_DWORD *)&byte_8049D23 = a2;
    byte_8049D1A = 32;
    v7 = sys_write(a1, &byte_8049D18, (size_t)&byte_8049D23);
  }
  v8 = sys_write(a1, &byte_80493B2, 1u);
  v9 = sys_write(a1, &byte_80490C7, 0x25u);
  if ( byte_804984F == 1 )
  {
    v10 = dword_80490EC;
    v11 = 27;
  }
  else if ( byte_804984F == 2 )
  {
    v10 = (int *)&byte_8049107;
    v11 = 27;
  }
  else
  {
    sub_8048D11((unsigned __int8)byte_804984F, 0x10u, (_BYTE *)&fd + 3);
    *(_DWORD *)&byte_8049D23 = a2;
    v10 = &fd + 1;
    v11 = 37;
  }
  v12 = sys_write(a1, v10, v11);
  v13 = sys_write(a1, &word_8049122, 0x25u);
  if ( byte_8049850 == 1 )
  {
    v14 = &byte_8049147;
    v15 = 42;
  }
  else if ( byte_8049850 == 2 )
  {
    v14 = byte_8049171;
    v15 = 39;
  }
  else
  {
    sub_8048D11((unsigned __int8)byte_8049850, 0x10u, dword_8049640);
    *(_DWORD *)&byte_8049D23 = a2;
    v14 = (char *)&word_804963E;
    v15 = 40;
  }
  v16 = sys_write(a1, v14, v15);
  v17 = sys_write(a1, dword_8049198, 0x25u);
  for ( j = 0; j != 231; j += 33 )
  {
    if ( word_804985B == *(__int16 *)((char *)&word_8048D79 + j) )
    {
      v19 = &byte_8048D7B[j];
      v20 = 31;
      goto LABEL_22;
    }
  }
  if ( (unsigned __int16)word_804985B < 0xFF00u )
  {
    sub_8048D11((unsigned __int16)word_804985B, 0x10u, dword_8049668);
    *(_DWORD *)&byte_8049D23 = a2;
    v19 = (char *)&word_8049666;
    v20 = 34;
  }
  else
  {
    sub_8048D11((unsigned __int16)word_804985B, 0x10u, &word_804968A);
    *(_DWORD *)&byte_8049D23 = a2;
    v19 = byte_8049688;
    v20 = 28;
  }
LABEL_22:
  v21 = sys_write(a1, v19, v20);
  v22 = sys_write(a1, byte_80491BD, 0x25u);
  for ( k = 0; k != 288; k += 16 )
  {
    if ( word_804985D == word_8048E60[k] )
    {
      v24 = &word_8048E62[k];
      goto LABEL_27;
    }
  }
  sub_8048D11((unsigned __int16)word_804985D, 0x10u, &word_80496A6);
  *(_DWORD *)&byte_8049D23 = a2;
  v24 = (__int16 *)byte_80496A4;
LABEL_27:
  v25 = sys_write(a1, v24, 0x1Eu);
  v26 = sys_write(a1, &word_80491E2, 0x25u);
  if ( dword_804985F )
  {
    if ( dword_804985F == 1 )
    {
      v27 = (__int16 *)&byte_8049207;
      v28 = 29;
    }
    else
    {
      sub_8048D11(dword_804985F, 0x10u, dword_80496C4);
      *(_DWORD *)&byte_8049D23 = a2;
      v27 = &word_80496C2;
      v28 = 24;
    }
  }
  else
  {
    v27 = (__int16 *)dword_8049224;
    v28 = 26;
  }
  v29 = sys_write(a1, v27, v28);
  v30 = sys_write(a1, &word_804923E, 0x25u);
  sub_8048D11(dword_8049863, 0x10u, byte_80496DD);
  *(_DWORD *)&byte_8049D23 = a2;
  v31 = sys_write(a1, &byte_80496DB, 0xDu);
  v32 = sys_write(a1, &byte_8049263, 0x25u);
  sub_8048D00();
  sub_8048D11(offset, 0xAu, &byte_8049D18);
  *(_DWORD *)&byte_8049D23 = a2;
  sub_8048CC6(a1);
  v33 = sys_write(a1, dword_8049288, 0x25u);
  sub_8048D00();
  sub_8048D11(dword_804986B, 0xAu, &byte_8049D18);
  *(_DWORD *)&byte_8049D23 = a2;
  sub_8048CC6(a1);
  v34 = sys_write(a1, byte_80492AD, 0x27u);
  sub_8048D00();
  sub_8048D11(dword_804986F, 0x10u, &byte_8049D18);
  *(_DWORD *)&byte_8049D23 = a2;
  byte_8049D23 = 10;
  v35 = sys_write(a1, &byte_8049D18, (size_t)&byte_8049D23);
  v36 = sys_write(a1, dword_80492D4, 0x25u);
  sub_8048D00();
  sub_8048D11(v37, 0xAu, &byte_8049D18);
  *(_DWORD *)&byte_8049D23 = a2;
  sub_8048CE3(a1);
  v38 = sys_write(a1, byte_80492F9, 0x25u);
  sub_8048D00();
  sub_8048D11(v39, 0xAu, &byte_8049D18);
  *(_DWORD *)&byte_8049D23 = a2;
  sub_8048CE3(a1);
  v40 = sys_write(a1, &word_804931E, 0x25u);
  sub_8048D00();
  sub_8048D11(v41, 0xAu, &byte_8049D18);
  *(_DWORD *)&byte_8049D23 = a2;
  byte_8049D23 = 10;
  v42 = sys_write(a1, &byte_8049D18, (size_t)&byte_8049D23);
  v43 = sys_write(a1, &byte_8049343, 0x25u);
  sub_8048D00();
  sub_8048D11(v44, 0xAu, &byte_8049D18);
  *(_DWORD *)&byte_8049D23 = a2;
  sub_8048CE3(a1);
  v45 = sys_write(a1, dword_8049368, 0x25u);
  sub_8048D00();
  sub_8048D11(v46, 0xAu, &byte_8049D18);
  *(_DWORD *)&byte_8049D23 = a2;
  byte_8049D23 = 10;
  v47 = sys_write(a1, &byte_8049D18, (size_t)&byte_8049D23);
  v48 = sys_write(a1, byte_804938D, 0x25u);
  sub_8048D00();
  sub_8048D11(v49, 0xAu, &byte_8049D18);
  *(_DWORD *)&byte_8049D23 = a2;
  byte_8049D23 = 10;
  v50 = sys_write(a1, &byte_8049D18, (size_t)&byte_8049D23);
}
// 80487FB: could not find valid save-restore pair for ebx
// 8048B72: variable 'v37' is possibly undefined
// 8048BA8: variable 'v39' is possibly undefined
// 8048BDE: variable 'v41' is possibly undefined
// 8048C25: variable 'v44' is possibly undefined
// 8048C5B: variable 'v46' is possibly undefined
// 8048CA2: variable 'v49' is possibly undefined
// 80481F4: using guessed type int dword_80481F4[3];
// 8048D79: using guessed type __int16 word_8048D79;
// 8048E60: using guessed type __int16 word_8048E60[];
// 8048E62: using guessed type __int16 word_8048E62[];
// 80490BC: using guessed type int dword_80490BC[2];
// 80490C7: using guessed type char byte_80490C7;
// 80490EC: using guessed type int dword_80490EC[6];
// 8049107: using guessed type char byte_8049107;
// 8049122: using guessed type __int16 word_8049122;
// 8049147: using guessed type char byte_8049147;
// 8049198: using guessed type int dword_8049198[9];
// 80491E2: using guessed type __int16 word_80491E2;
// 8049207: using guessed type char byte_8049207;
// 8049224: using guessed type int dword_8049224[6];
// 804923E: using guessed type __int16 word_804923E;
// 8049263: using guessed type char byte_8049263;
// 8049288: using guessed type int dword_8049288[9];
// 80492D4: using guessed type int dword_80492D4[9];
// 804931E: using guessed type __int16 word_804931E;
// 8049343: using guessed type char byte_8049343;
// 8049368: using guessed type int dword_8049368[9];
// 80493B2: using guessed type char byte_80493B2;
// 804963E: using guessed type __int16 word_804963E;
// 8049640: using guessed type int dword_8049640[9];
// 8049666: using guessed type __int16 word_8049666;
// 8049668: using guessed type int dword_8049668[8];
// 804968A: using guessed type __int16 word_804968A;
// 80496A6: using guessed type __int16 word_80496A6;
// 80496C2: using guessed type __int16 word_80496C2;
// 80496C4: using guessed type int dword_80496C4[5];
// 80496DB: using guessed type char byte_80496DB;
// 804984F: using guessed type char byte_804984F;
// 8049850: using guessed type char byte_8049850;
// 804985B: using guessed type __int16 word_804985B;
// 804985D: using guessed type __int16 word_804985D;
// 804985F: using guessed type int dword_804985F;
// 8049863: using guessed type int dword_8049863;
// 804986F: using guessed type int dword_804986F;
// 8049877: using guessed type __int16 word_8049877;
// 804987B: using guessed type __int16 word_804987B;
// 804987D: using guessed type int dword_804987D;
// 8049D18: using guessed type char byte_8049D18;
// 8049D1A: using guessed type char byte_8049D1A;
// 8049D23: using guessed type char byte_8049D23;

//----- (08048CC6) --------------------------------------------------------
int __usercall sub_8048CC6@<eax>(int a1@<ebx>)
{
  int v1; // eax

  v1 = sys_write(a1, &byte_8049D18, (size_t)&byte_8049D23);
  return sys_write(a1, dword_80490A0, 0x13u);
}
// 80490A0: using guessed type int dword_80490A0[4];
// 8049D18: using guessed type char byte_8049D18;
// 8049D23: using guessed type char byte_8049D23;

//----- (08048CE3) --------------------------------------------------------
int __usercall sub_8048CE3@<eax>(int a1@<ebx>)
{
  int v1; // eax

  v1 = sys_write(a1, &byte_8049D18, (size_t)&byte_8049D23);
  return sys_write(a1, &byte_80490B3, 9u);
}
// 80490B3: using guessed type char byte_80490B3;
// 8049D18: using guessed type char byte_8049D18;
// 8049D23: using guessed type char byte_8049D23;

//----- (08048D00) --------------------------------------------------------
void sub_8048D00()
{
  memset(&byte_8049D18, 0, 0xBu);
}
// 8049D18: using guessed type char byte_8049D18;

//----- (08048D11) --------------------------------------------------------
int __usercall sub_8048D11@<eax>(unsigned int a1@<eax>, unsigned int a2@<ecx>, _BYTE *a3@<edi>)
{
  int v3; // ebx
  int v4; // edx
  unsigned int v5; // et2
  int result; // eax

  v3 = 0;
  do
  {
    v5 = a1 % a2;
    a1 /= a2;
    v4 = v5;
    if ( (unsigned __int8)v5 < 0xAu )
      LOBYTE(v4) = v4 + 48;
    else
      LOBYTE(v4) = v4 + 55;
    ++v3;
  }
  while ( a1 );
  do
  {
    result = v4;
    *a3++ = v4;
    --v3;
  }
  while ( v3 );
  return result;
}

//----- (08048D34) --------------------------------------------------------
__int64 __usercall sub_8048D34@<edx:eax>(__int64 a1@<edx:eax>, int a2@<ebx>, _BYTE *a3@<edi>, int a4@<esi>)
{
  unsigned int v4; // eax
  int v5; // ecx
  unsigned int v7; // [esp-40h] [ebp-40h]
  int v8; // [esp-38h] [ebp-38h]
  _BYTE *v9; // [esp-28h] [ebp-28h]

  v9 = a3;
  v7 = a1;
  sub_8048D11(a1, 0x10u, a3);
  *(_DWORD *)&byte_8049D23 = a4;
  v4 = v7;
  if ( (unsigned __int8)a4 < 8u )
  {
    v5 = a2 - *(_DWORD *)&byte_8049D23;
    if ( a2 != *(_DWORD *)&byte_8049D23 )
    {
      v8 = a2 - *(_DWORD *)&byte_8049D23;
      do
      {
        *a3++ = 48;
        --v5;
      }
      while ( v5 );
      v4 = v7;
      v5 = v8;
      a3 = v9;
    }
    sub_8048D11(v4, 0x10u, &a3[v5]);
    *(_DWORD *)&byte_8049D23 = a4;
  }
  return a1;
}
// 8048D34: could not find valid save-restore pair for ebx
// 8048D34: could not find valid save-restore pair for ebp
// 8048D34: could not find valid save-restore pair for edi
// 8048D34: could not find valid save-restore pair for esi
// 8049D23: using guessed type char byte_8049D23;

// nfuncs=11 queued=11 decompiled=11 lumina nreq=0 worse=0 better=0
// ALL OK, 11 function(s) have been successfully decompiled

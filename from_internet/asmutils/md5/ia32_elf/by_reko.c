// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08048076: void fn08048076(Register Eq_2 edx, Stack word32 dwArg08)
void fn08048076(Eq_2 edx, word32 dwArg08)
{
	ptr32 fp;
	__wait();
	__fldcw(__fstcw() | 0x0400);
	word32 * edi_10 = g_a80482CD;
	do
	{
		edx = (word32) edx + 1;
		*edi_10 = (word32) (fabs(sin((real64) edx)) * g_r804825B);
		++edi_10;
	} while (edx < 0x40);
	Eq_41 ebx_123;
	Eq_41 eax_115;
	struct Eq_43 * esp_110 = fp + 8;
	Eq_41 ebp_39 = 0x00;
	if (dwArg08 == 0x00)
	{
l080480C5:
		g_a80483CD[0].u1 = 0x67452301;
		g_dw80483D1 = 4023233417;
		g_dw80483D5 = 2562383102;
		g_dw80483D9 = 271733878;
		g_t80483DD.u0 = 0x00;
		g_t80483E1.u1 = 0x00;
		while (true)
		{
			struct Eq_43 * esp_96 = esp_110 - 4;
			esp_96->dw0000 = 0x40;
			Eq_2 edx_111 = esp_96->dw0000;
			esp_96->dw0000 = 0x0804828D;
			char * edi_102 = g_a804828D;
			do
			{
				esp_96->dwFFFFFFFC = 0x03;
				Eq_41 eax_112 = sys_read(ebp_39, edi_102, edx_111);
				esp_110 = esp_96;
				edx_111 -= eax_112;
				edi_102 += eax_112;
				eax_115 = eax_112;
				if (eax_112 < 0x00)
					goto l08048255;
			} while (eax_112 != 0x00);
			Eq_126 edx_137 = 0x40 - edx_111;
			Eq_2 edi_134 = esp_96->dw0000;
			g_t80483DD.u0 = (word32) edx_137 + g_t80483DD.u0;
			if (edx_137 < 0x40)
			{
				Eq_126 edx_142 = edx_137;
				if (edx_137 == 0x00 && g_t80483E1.u0 != 0x00)
				{
					esp_96->dw0000 = 0x080483E3;
					esp_96->dwFFFFFFFC = 0x10;
					byte * esi_149 = g_a80483CD;
					byte * edi_150 = g_a80483E3;
					word32 ecx_155 = esp_96->dwFFFFFFFC;
					do
					{
						bcu8 al_159 = *esi_149;
						*edi_150 = (byte) __aad(__aam(al_159 >> 0x04)) + 0x30;
						byte * edi_169 = edi_150 + 1;
						*edi_169 = (byte) __aad(__aam(al_159 & 0x0F)) + 0x30;
						++esi_149;
						edi_150 = edi_169 + 1;
						--ecx_155;
					} while (ecx_155 != 0x00);
					Eq_2 ecx_190 = esp_96->dw0000;
					esp_96->dw0000 = 0x01;
					Eq_2 ebx_194 = esp_96->dw0000;
					esp_96->dw0000 = 0x20;
					Eq_2 edx_198 = esp_96->dw0000;
					esp_96->dw0000 = 0x04;
					sys_write(ebx_194, ecx_190, edx_198);
					ptr32 esp_203 = &esp_96->ptr0004;
					if (ebp_39 != 0x00)
					{
						esp_96->dw0000 = 0x01;
						Eq_2 edx_210 = esp_96->dw0000;
						esp_96->dw0000 = 0x04;
						sys_write(ebx_194, &g_b8048263, edx_210);
						char * esi_218 = esp_96->ptr0004;
						esp_96->ptr0004 = esi_218;
						Eq_2 edx_222 = ~0x00;
						do
						{
							edx_222 = (word32) edx_222 + 1;
							esi_218 = esi_489 + 1;
							esi_489 = esi_218;
						} while (*esi_489 != 0x00);
						char * ecx_235 = esp_96->ptr0004;
						esp_96->ptr0004 = (char *) 0x04;
						sys_write(ebx_194, ecx_235, edx_222);
						esp_203 = esp_96 + 1;
					}
					union Eq_2 * esp_244 = esp_203 - 4;
					esp_244->u0 = 0x01;
					edx.u0 = esp_244->u0;
					esp_244->u0 = 0x04;
					sys_write(ebx_194, &g_b8048264, edx);
					esp_110 = (struct Eq_43 *) ((char *) esp_244 + 4);
					goto l080480AB;
				}
				if (g_b80483E2 == 0x00)
				{
					++g_b80483E2;
					Mem262[edi_134 + edx_137:byte] = 0x80;
					edx_142 = (word32) edx_137 + 1;
				}
				if (edx_142 <= 0x38)
				{
					esp_96->dw0000 = 0x38;
					word32 edi_291 = edi_134 + edx_142;
					Eq_523 ecx_292;
					for (ecx_292 = esp_96->dw0000 - edx_142; ecx_292 != 0x00; --ecx_292)
					{
						edi_291->dw0000 = (word32) 0x00;
						++edi_291;
					}
					Eq_2 eax_299 = g_t80483DD.u0;
					esp_96->dw0000 = (word32) eax_299;
					edi_291->dw0000 = eax_299 << 0x03;
					edi_291[4] = (struct Eq_521) (esp_96->dw0000 >> 0x1D);
					g_t80483E1.u0 = (byte) (g_t80483E1.u0 + 0x01);
				}
				else
				{
					esp_96->dw0000 = 0x40;
					word32 edi_275 = edi_134 + edx_142;
					Eq_512 ecx_276;
					for (ecx_276 = esp_96->dw0000 - edx_142; ecx_276 != 0x00; --ecx_276)
					{
						*edi_275 = 0x00;
						++edi_275;
					}
				}
			}
			struct Eq_139 * esp_318 = esp_110 - 4;
			esp_318->t0000 = ebp_39;
			word32 ecx_337 = g_dw80483D5;
			word32 ebx_346 = g_dw80483D1;
			Eq_50 eax_347 = g_a80483CD[0].u1;
			esp_318->ptrFFFFFFFC = (struct Eq_154 *) 0x03;
			struct Eq_154 * ebp_352 = esp_318->ptrFFFFFFFC;
			esp_318->ptrFFFFFFFC = (struct Eq_154 *) 0x0F;
			struct Eq_166 * esi_349 = g_a80482CD;
			do
			{
				struct Eq_292 * esp_356 = esp_110 - 8;
				esp_356->tFFFFFFFC.u1 = (word32) eax_347;
				uint32 edi_370 = (uint32) ebp_352[134513273];
				eax_347.u1 = esp_356->tFFFFFFFC.u1;
				do
				{
					esp_110->dwFFFFFFF4 = ecx_337;
					esp_110->dwFFFFFFF0 = (word32) eax_347;
					Eq_50 edx_382;
					word32 eax_383;
					(*((char *) g_a804827D + ebp_352 * 0x04))();
					esp_110->dwFFFFFFF0 += eax_383;
					word32 eax_400 = __rol<word32,byte>(esp_110->dwFFFFFFF0 + esi_349->dw0000 + g_a804828D[edi_370 * 0x04], (esp_110->dwFFFFFFF8 & 0x03)->a8048265[ebp_352].b0000) + ebx_490;
					edi_370 = edi_370 + (uint32) ebp_352[0x08048275] & 0x0F;
					word32 ecx_408 = esp_110->dwFFFFFFF4;
					int32 v38_419 = esp_110->dwFFFFFFF8 - 0x01;
					esp_110->dwFFFFFFF8 = v38_419;
					++esi_349;
					ecx_337 = ebx_490;
					ebx_346 = eax_400;
					eax_347 = edx_382;
					ebx_490 = ebx_346;
				} while (v38_419 >= 0x00);
				esp_110->dwFFFFFFF8 &= 0x0F;
				--ebp_352;
			} while (ebp_352 >= null);
			esi_349->dw0000 = (word32) edx_382.u1 + esi_349->dw0000;
			esi_349[1] = (struct Eq_166) ((word32) esi_349[1].dw0000 + eax_400);
			esi_349[2] = (struct Eq_166) ((word32) esi_349[2].dw0000 + ebx_490);
			esi_349[3] = (struct Eq_166) ((word32) esi_349[3].dw0000 + ecx_408);
			ebp_39 = esp_356->t0004;
		}
	}
	else
	{
l080480AB:
		struct Eq_68 * esp_48 = &esp_110->ptr0004;
		Eq_41 ebx_47 = esp_110->dw0000;
		esp_48->tFFFFFFFC = ebx_47;
		esp_110 = esp_48 - 4;
		ebx_123 = ebx_47;
		if (ebx_47 != 0x00)
		{
			esp_48->dwFFFFFFF8 = 0x05;
			Eq_41 eax_62 = sys_open(ebx_47, 0x00, edx);
			esp_110 = esp_48 - 4;
			eax_115 = eax_62;
			if (eax_62 >= 0x00)
			{
				ebp_39 = eax_62;
				goto l080480C5;
			}
l08048255:
			ebx_123 = eax_115;
		}
		esp_110->dwFFFFFFFC = 0x01;
		sys_exit(ebx_123);
	}
}

real64 g_r804825B = 4294967296.0; // 0804825B
char g_b8048263 = ' '; // 08048263
char g_b8048264 = '\n'; // 08048264
byte g_a8048275[] = // 08048275
	{
	};
byte g_a8048279[] = // 08048279
	{
	};
<anonymous> * g_a804827D[] = // 0804827D
	{
	};
word32 g_a804828D[] = // 0804828D
	{
	};
word32 g_a80482CD[] = // 080482CD
	{
	};
Eq_50 g_a80483CD[] = // 080483CD
	{
	};
word32 g_dw80483D1 = 0x00; // 080483D1
word32 g_dw80483D5 = 0x00; // 080483D5
word32 g_dw80483D9 = 0x00; // 080483D9
Eq_2 g_t80483DD = // 080483DD
	{
		0x00
	};
Eq_65 g_t80483E1 = // 080483E1
	{
		0x00
	};
byte g_b80483E2 = 0x00; // 080483E2
byte g_a80483E3[] = // 080483E3
	{
	};

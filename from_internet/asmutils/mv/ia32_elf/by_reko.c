// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C(Register (ptr32 Eq_2) esi, Register (ptr32 Eq_2) edi, Stack int32 dwArg00)
void fn0804804C(struct Eq_2 * esi, struct Eq_2 * edi, int32 dwArg00)
{
	if (dwArg00 >= 0x03)
	{
		struct Eq_2 * v10_15 = (&fp->a0008[dwArg00 - 0x02].a0000)[0];
		(&fp->a0008[dwArg00 - 0x02].a0000)[0] = (byte) 0x00;
		struct Eq_2 * esp_18[] = fp->a0008;
		edi = v10_15;
		while (true)
		{
			esi = (struct Eq_2 *) (&esp_18[0].a0000)[0];
			if (esi == null)
				break;
			edi = fn08048071(esi, edi);
			esp_18 = (struct Eq_2 * (*)[]) <invalid>;
		}
	}
	__syscall(0x80);
	if (fn080480E7())
		fn080480AD();
	else
		fn08048079(esi, edi);
}

// 08048071: Register (ptr32 Eq_2) fn08048071(Register (ptr32 Eq_2) esi, Register (ptr32 Eq_2) edi)
// Called from:
//      fn0804804C
struct Eq_2 * fn08048071(struct Eq_2 * esi, struct Eq_2 * edi)
{
	if (fn080480E7())
		return fn080480AD();
	return fn08048079(esi, edi);
}

// 08048079: Register (ptr32 Eq_2) fn08048079(Register (ptr32 Eq_2) esi, Register (ptr32 Eq_2) edi)
// Called from:
//      fn0804804C
//      fn08048071
struct Eq_2 * fn08048079(struct Eq_2 * esi, struct Eq_2 * edi)
{
	int32 edx_7 = fn0804810E(esi);
	byte * edi_17 = esi + (edx_7 - 0x01);
	int32 ecx_14 = edx_7;
	bool v20_77 = *edi_17 != 0x2F;
	if (*edi_17 == 0x2F)
		*edi_17 = 0x00;
	while (ecx_14 != 0x00)
	{
		v20_77 = *edi_17 != 0x2F;
		--edi_17;
		--ecx_14;
		if (*edi_17 != 0x2F)
			break;
	}
	if (!v20_77)
		++edi_17;
	fn080480B8(edi_17 + 1, edi, &g_t8048184);
	return fn080480AD();
}

// 080480AD: Register word32 fn080480AD()
// Called from:
//      fn0804804C
//      fn08048071
//      fn08048079
word32 fn080480AD()
{
	__syscall(0x80);
	return dwArg00;
}

// 080480B8: void fn080480B8(Register (ptr32 Eq_2) edx, Register (ptr32 Eq_2) esi, Register (ptr32 Eq_2) edi)
// Called from:
//      fn08048079
void fn080480B8(struct Eq_2 * edx, struct Eq_2 * esi, struct Eq_2 * edi)
{
	fn0804811F(esi, edi);
	fn080480CC(edi);
	fn0804812C(edx, edi);
}

// 080480CC: void fn080480CC(Register (ptr32 Eq_2) edi)
// Called from:
//      fn080480B8
void fn080480CC(struct Eq_2 * edi)
{
	int32 edx_11 = fn0804810E(edi);
	if (edi[edx_11 - 0x01] != 0x2F)
		edi[edx_11] = (struct Eq_2) 0x2F;
}

// 080480E7: FlagGroup bool fn080480E7()
// Called from:
//      fn0804804C
//      fn08048071
bool fn080480E7()
{
	__syscall(0x80);
	bool Z_82 = SLICE(cond(((word32) g_w804814C & 0x4000) - 0x4000), bool, 2);
	return Z_82;
}

// 0804810E: Register word32 fn0804810E(Register (ptr32 Eq_2) esi)
// Called from:
//      fn0804804C
//      fn080480CC
//      fn0804811F
//      fn0804812C
word32 fn0804810E(struct Eq_2 * esi)
{
	word32 edx_13 = ~0x00;
	do
	{
		++edx_13;
		esi = esi_36 + 1;
		esi_36 = esi;
	} while (esi_36->a0000[0] != 0x00);
	return edx_13;
}

// 0804811F: void fn0804811F(Register (ptr32 Eq_2) esi, Register (ptr32 Eq_2) edi)
// Called from:
//      fn080480B8
void fn0804811F(struct Eq_2 * esi, struct Eq_2 * edi)
{
	word32 ecx_35;
	for (ecx_35 = fn0804810E(esi) + 0x01; ecx_35 != 0x00; --ecx_35)
	{
		edi->a0000[0] = esi->a0000[0];
		++esi;
		++edi;
	}
}

// 0804812C: void fn0804812C(Register (ptr32 Eq_2) esi, Register (ptr32 Eq_2) edi)
// Called from:
//      fn080480B8
void fn0804812C(struct Eq_2 * esi, struct Eq_2 * edi)
{
	byte * edi_39 = edi + fn0804810E(edi);
	struct Eq_2 * esi_38 = esi;
	word32 ecx_49;
	for (ecx_49 = fn0804810E(esi) + 0x01; ecx_49 != 0x00; --ecx_49)
	{
		*edi_39 = esi_38->a0000[0];
		++esi_38;
		++edi_39;
	}
}

word16 g_w804814C = 0x00; // 0804814C
struct Eq_2 g_t8048184 = // 08048184
	{
		
		{
		},
	};

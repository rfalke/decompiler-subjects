// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C()
// Called from:
//      fn08048057
void fn0804804C()
{
	g_t804813D.u0 = ~0x00;
}

// 08048057: void fn08048057(Stack word32 dwArg00, Stack Eq_2 dwArg08)
void fn08048057(word32 dwArg00, Eq_2 dwArg08)
{
	ptr32 fp;
	g_t8048139.u0 = ~0x00;
	int32 ebp_30 = 0x00;
	struct Eq_13 * esp_12 = fp + 8;
	if (dwArg00 != 0x01)
	{
		int32 edx_16 = fn08048129(dwArg08);
		esp_12 = fp + 0x0C;
		ci8 al_22 = *dwArg08.u0;
		if (al_22 > 0x2F && al_22 < 0x3A)
		{
			Eq_2 esi_28 = dwArg08;
			ebp_30 = 0x01;
			if (dwArg08.u0[edx_16 - 0x01] != 0x2E)
			{
				ebp_30 = 0x00;
				int32 ecx_35 = 0x00;
				do
				{
					byte al_43 = *esi_28.u0;
					esi_28.u0 = (word32) esi_28 + 1;
					++ecx_35;
					if (ecx_35 > edx_16)
						goto l080480A9;
				} while (al_43 != 0x2E);
				g_dw804853D = 0x01;
l080480A9:
				g_t804813D.u0 = (gid_t) esi_28;
				dwArg08.u0[ecx_35 - 0x01] = 0x00;
				g_t8048139.u0 = (gid_t) dwArg08;
				g_t804813D.u0 = (gid_t) fn08048115(g_t804813D.u0);
				g_t8048139.u0 = (gid_t) fn08048115(g_t8048139.u0);
				esp_12 = fp + 0x0C;
				if (g_dw804853D != 0x01)
					fn0804804C();
				while (true)
				{
					char * esi_88 = esp_12->dw0000;
					++esp_12;
					if (esi_88 == null)
						break;
					g_ptr8048141 = esi_88;
					sys_chown(g_ptr8048141, g_t8048139.u0, g_t804813D.u0);
				}
			}
		}
	}
	esp_12->dwFFFFFFFC = 0x01;
	sys_exit(ebp_30);
}

// 08048115: Register Eq_110 fn08048115(Register Eq_2 esi)
// Called from:
//      fn08048057
Eq_110 fn08048115(Eq_2 esi)
{
	Eq_110 ebx_17 = 0x00;
	while (true)
	{
		byte al_11 = *esi.u0;
		esi.u0 = (word32) esi + 1;
		if (al_11 == 0x00)
			break;
		ebx_17 = ebx_17 *s 0x0A + (uint32) (al_11 - 0x30);
	}
	return ebx_17;
}

// 08048129: Register word32 fn08048129(Register Eq_2 esi)
// Called from:
//      fn08048057
word32 fn08048129(Eq_2 esi)
{
	word32 edx_13 = ~0x00;
	do
	{
		++edx_13;
		esi.u0 = (word32) esi_37 + 1;
		esi_37 = esi;
	} while (*esi_37.u0 != 0x00);
	return edx_13;
}

Eq_2 g_t8048139 = // 08048139
	{
		null
	};
Eq_2 g_t804813D = // 0804813D
	{
		null
	};
char * g_ptr8048141 = null; // 08048141
word32 g_dw804853D = 0x00; // 0804853D

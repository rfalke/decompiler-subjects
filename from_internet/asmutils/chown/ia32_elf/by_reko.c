// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C()
// Called from:
//      fn08048057
void fn0804804C()
{
	g_ptr804813D = (byte *) ~0x00;
}

// 08048057: void fn08048057(Register (ptr32 byte) esi, Stack word32 dwArg00, Stack (ptr32 byte) dwArg08)
void fn08048057(byte * esi, word32 dwArg00, byte * dwArg08)
{
	g_ptr8048139 = (byte *) ~0x00;
	if (dwArg00 != 0x01)
	{
		int32 edx_15 = fn08048129(dwArg08);
		ci8 al_20 = *dwArg08;
		esi = dwArg08 + 1;
		if (al_20 > 0x2F && al_20 < 0x3A)
		{
			esi = dwArg08;
			if (dwArg08[edx_15 - 0x01] != 0x2E)
			{
				int32 ecx_33 = 0x00;
				do
				{
					byte al_40 = *esi;
					++esi;
					++ecx_33;
					if (ecx_33 > edx_15)
						goto l080480A9;
				} while (al_40 != 0x2E);
				g_dw804853D = 0x01;
l080480A9:
				g_ptr804813D = esi;
				dwArg08[ecx_33 - 0x01] = 0x00;
				g_ptr8048139 = dwArg08;
				g_ptr804813D = fn08048115(g_ptr804813D);
				g_ptr8048139 = fn08048115(g_ptr8048139);
				word32 * esp_58 = fp + 0x0C;
				if (g_dw804853D != 0x01)
					fn0804804C();
				while (true)
				{
					byte * esi_83 = *esp_58;
					++esp_58;
					esi = esi_83;
					if (esi_83 == null)
						break;
					g_ptr8048141 = esi_83;
					__syscall(0x80);
				}
			}
		}
	}
	__syscall(0x80);
	fn08048119(0x00, 0x00, esi);
}

// 08048115: Register word32 fn08048115(Register (ptr32 byte) esi)
// Called from:
//      fn08048057
word32 fn08048115(byte * esi)
{
	return fn08048119(0x00, 0x00, esi);
}

// 08048119: Register int32 fn08048119(Register word24 eax_24_8, Register int32 ebx, Register (ptr32 byte) esi)
// Called from:
//      fn08048057
//      fn08048115
int32 fn08048119(word24 eax_24_8, int32 ebx, byte * esi)
{
	while (true)
	{
		byte al_5 = *esi;
		++esi;
		if (al_5 == 0x00)
			break;
		ebx = ebx *s 0x0A + SEQ(eax_24_8, al_5 - 0x30);
	}
	return ebx;
}

// 08048129: Register word32 fn08048129(Register (ptr32 byte) esi)
// Called from:
//      fn08048057
word32 fn08048129(byte * esi)
{
	word32 edx_12 = ~0x00;
	do
	{
		++edx_12;
		esi = esi_34 + 1;
		esi_34 = esi;
	} while (*esi_34 != 0x00);
	return edx_12;
}

byte * g_ptr8048139 = null; // 08048139
byte * g_ptr804813D = null; // 0804813D
byte * g_ptr8048141 = null; // 08048141
word32 g_dw804853D = 0x00; // 0804853D

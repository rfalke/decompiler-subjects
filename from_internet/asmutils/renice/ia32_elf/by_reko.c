// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08048067: void fn08048067(Stack word32 dwArg00, Stack (ptr32 byte) dwArg08, Stack (ptr32 byte) dwArg0C)
void fn08048067(word32 dwArg00, byte * dwArg08, byte * dwArg0C)
{
	ptr32 esp_12;
	ptr32 esp_56 = fp + 8;
	if (dwArg00 == 0x01)
	{
l080480A9:
		word32 * esp_58 = esp_56 - 4;
		*esp_58 = 0x1B;
		*esp_58 = 0x01;
		*esp_58 = 0x04;
		__syscall(0x80);
		esp_12 = esp_58 + 1;
		goto l080480B9;
	}
	else
	{
		esp_12 = fp + 0x0C;
		if (dwArg08 != null)
		{
			g_dw80480E6 = fn080480BE(dwArg08);
			byte * esi_23 = dwArg0C;
			esp_12 = fp + 16;
			if (dwArg0C != null)
			{
				do
				{
					g_dw80480E2 = fn080480BE(esi_23);
					struct Eq_62 * esp_40 = esp_12 - 4;
					esp_40->dw0000 = 0x61;
					__syscall(0x80);
					esi_23 = esp_40->ptr0004;
					esp_12 = (char *) &esp_40->ptr0004 + 4;
				} while (esi_23 != null);
l080480A4:
				word32 * esp_53 = esp_12 - 4;
				*esp_53 = 0x01;
				__syscall(0x80);
				esp_56 = esp_53 + 1;
				goto l080480A9;
			}
		}
l080480B9:
		word32 * esp_72 = esp_12 - 4;
		*esp_72 = 0x01;
		esp_12 = esp_72 + 1;
		goto l080480A4;
	}
}

// 080480BE: Register Eq_91 fn080480BE(Register (ptr32 byte) esi)
// Called from:
//      fn08048067
Eq_91 fn080480BE(byte * esi)
{
	byte * esi_11;
	Eq_91 ebx_19 = 0x00;
	esi_11 = esi;
	if (*esi == 0x2D)
		esi_11 = esi + 1;
	while (true)
	{
		byte al_14 = *esi_11;
		++esi_11;
		if (al_14 == 0x00)
			break;
		ebx_19 = ebx_19 *s 0x0A + (uint32) (al_14 - 0x30);
	}
	if (*esi == 0x2D)
		return -ebx_19;
	return ebx_19;
}

word32 g_dw80480E2 = 0x00; // 080480E2
word32 g_dw80480E6 = 0x00; // 080480E6

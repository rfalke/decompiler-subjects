// subject_seg08048000_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C(Stack word32 dwArg00, Stack (ptr32 word16) dwArg08, Stack (ptr32 cu8) dwArg0C)
void fn0804804C(word32 dwArg00, word16 * dwArg08, cu8 * dwArg0C)
{
	ptr32 fp;
	Eq_6 edx_55;
	word32 ebp_113 = 0x00;
	int32 ebx_44 = 0x03;
	struct Eq_11 * esp_11 = fp + 4;
	if (dwArg00 != 0x01)
	{
		esp_11 = fp + 0x0C;
		if (*dwArg08 == 28205)
		{
			if (dwArg00 != 0x02)
			{
				esp_11 = fp + 16;
				cu8 dl_31 = *dwArg0C;
				if (dl_31 > 0x30)
				{
					edx_55.u1 = (uint32) (dl_31 - 0x30);
					if (dl_31 <= 0x38 && dl_31 >= 0x30)
					{
						ebx_44 = 0x08;
						esp_11 = fp + 16;
l08048081:
						union Eq_51 * esp_49 = esp_11 - 4;
						esp_49->u0 = 0x67;
						int32 eax_61 = sys_syslog(ebx_44, &g_b80480D1, edx_55);
						if (eax_61 >= 0x00 && eax_61 != 0x00)
						{
							byte * edi_67 = g_a80500D1;
							struct Eq_78 * esi_139 = &g_b80480D1;
							int32 ecx_70 = eax_61;
							do
							{
								byte al_73 = esi_139->b0000;
								esi_139 = (struct Eq_78 *) &esi_139->b0001;
								bool v28_140 = al_73 != 0x3C;
								if (al_73 == 0x3C)
								{
									v28_140 = esi_139->b0001 != 0x3E;
									if (esi_139->b0001 == 0x3E)
									{
										ecx_70 -= 0x03;
										al_73 = esi_139->b0002;
										++esi_139;
										v28_140 = ecx_70 != 0x00;
									}
								}
								*edi_67 = al_73;
								++edi_67;
								--ecx_70;
							} while (v28_140 && ecx_70 != 0x00);
							esp_49->u0 = 0x01;
							Eq_51 ebx_104 = esp_49->u0;
							esp_49->u0 = 0x04;
							sys_write(ebx_104, g_a80500D1, edi_67 - 0x080500D1);
							if (ebp_113 != 0x00)
							{
								esp_49->u0 = 0x04;
								Eq_51 ebx_122 = esp_49->u0;
								esp_49->u0 = 0x67;
								sys_syslog(ebx_122, g_a80500D1, edi_67 - 0x080500D1);
							}
						}
						esp_11->dwFFFFFFFC = 0x01;
						sys_exit(0x00);
					}
				}
			}
		}
		else if (*dwArg08 == 0x632D)
			ebp_113 = 0x01;
	}
	edx_55.u0 = 0x8000;
	goto l08048081;
}

char g_b80480D1 = '\0'; // 080480D1
byte g_a80500D1[] = // 080500D1
	{
	};

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __noreturn start(); // weak

//-------------------------------------------------------------------------
// Data declarations

char buf[65536]; // idb


//----- (0804804C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn start()
{
  int v0; // ebp
  int v1; // ebx
  bool v2; // cc
  int v3; // edx
  int v4; // eax
  char *v5; // ecx
  char *v6; // edi
  char *v7; // esi
  int v8; // ecx
  char v9; // al
  bool v10; // zf
  char *v11; // esi
  int v12; // eax
  int v13; // edx
  char *v14; // ecx
  int v15; // eax
  int v16; // eax
  int v17; // [esp-10h] [ebp-10h]
  _WORD *v18; // [esp-8h] [ebp-8h]
  unsigned __int8 *v19; // [esp-4h] [ebp-4h]

  v0 = 0;
  v1 = 3;
  if ( v17 != 1 )
  {
    if ( *v18 == 28205 )
    {
      if ( v17 != 2 )
      {
        v3 = *v19;
        v2 = (unsigned __int8)v3 <= 0x30u;
        LOBYTE(v3) = v3 - 48;
        if ( !v2 && (unsigned __int8)v3 <= 8u )
        {
          v1 = 8;
          goto LABEL_10;
        }
      }
    }
    else if ( *v18 == 25389 )
    {
      v0 = 1;
    }
  }
  v3 = 0x8000;
LABEL_10:
  v4 = sys_syslog(v1, buf, v3);
  if ( v4 > 0 )
  {
    v6 = &buf[0x8000];
    v7 = v5;
    v8 = v4;
    do
    {
      v9 = *v7++;
      v10 = v9 == 60;
      if ( v9 == 60 )
      {
        v10 = v7[1] == 62;
        if ( v7[1] == 62 )
        {
          v11 = v7 + 2;
          v9 = *v11;
          v7 = v11 + 1;
          v8 -= 3;
          v10 = v8 == 0;
        }
      }
      *v6++ = v9;
      --v8;
    }
    while ( !v10 && v8 );
    v12 = sys_write(1, &buf[0x8000], v6 - &buf[0x8000]);
    if ( v0 )
      v15 = sys_syslog(4, v14, v13);
  }
  v16 = sys_exit(0);
}
// 8048062: positive sp value 10 has been found
// 8048053: variable 'v17' is possibly undefined
// 8048057: variable 'v18' is possibly undefined
// 8048064: variable 'v19' is possibly undefined
// 8048098: variable 'v5' is possibly undefined
// 80480C8: variable 'v14' is possibly undefined
// 80480C8: variable 'v13' is possibly undefined
// 804804C: using guessed type void __noreturn start();

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

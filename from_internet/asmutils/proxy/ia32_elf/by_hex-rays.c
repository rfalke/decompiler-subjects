/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall __noreturn start(int@<ebx>);
// int __usercall sub_80480D1@<eax>(unsigned __int8 *@<esi>);
// char __usercall sub_80480E5@<al>(unsigned __int8 *@<esi>);

//-------------------------------------------------------------------------
// Data declarations

int dword_80481FD; // weak
int dword_804820D; // weak
int dword_8048211; // weak


//----- (0804805C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn start(int a1@<ebx>)
{
  int v1; // edi
  int v2; // edx
  char v3; // t0
  int v4; // ebx
  int v5; // eax
  int v6; // [esp-14h] [ebp-14h]
  unsigned __int8 *v7; // [esp-Ch] [ebp-Ch]
  unsigned __int8 *v8; // [esp-8h] [ebp-8h]
  unsigned __int8 *v9; // [esp-4h] [ebp-4h]

  if ( v6 == 4 )
  {
    sub_80480E5(v7);
    v1 = a1;
    sub_80480D1(v8);
    dword_8048211 = v2;
    sub_80480E5(v9);
    v3 = BYTE1(a1);
    BYTE1(a1) = a1;
    LOBYTE(a1) = v3;
    v4 = a1 << 16;
    LOBYTE(v4) = 2;
    dword_804820D = v4;
    HIWORD(v4) = HIWORD(v1);
    LOBYTE(v4) = BYTE1(v1);
    BYTE1(v4) = v1;
    v4 <<= 16;
    LOBYTE(v4) = 2;
    dword_80481FD = v4;
    __asm
    {
      int     80h; LINUX - sys_socket
      int     80h; LINUX - sys_setsockopt
      int     80h; LINUX - sys_bind
    }
  }
  v5 = sys_exit(1);
}
// 8048078: positive sp value 14 has been found
// 8048060: variable 'v6' is possibly undefined
// 8048064: variable 'v7' is possibly undefined
// 804806C: variable 'v8' is possibly undefined
// 8048071: variable 'v2' is possibly undefined
// 8048078: variable 'v9' is possibly undefined
// 80481FD: using guessed type int dword_80481FD;
// 804820D: using guessed type int dword_804820D;
// 8048211: using guessed type int dword_8048211;
// 804A21D: using guessed type char byte_804A21D;

//----- (080480D1) --------------------------------------------------------
int __usercall sub_80480D1@<eax>(unsigned __int8 *a1@<esi>)
{
  int result; // eax
  int v2; // ecx

  do
    LOBYTE(result) = sub_80480E5(a1);
  while ( v2 != 1 );
  return result;
}
// 80480E2: variable 'v2' is possibly undefined

//----- (080480E5) --------------------------------------------------------
char __usercall sub_80480E5@<al>(unsigned __int8 *a1@<esi>)
{
  int v1; // eax
  int i; // ebx
  unsigned __int8 v3; // al
  bool v4; // cf

  v1 = 0;
  for ( i = 0; ; i = v1 + 10 * i )
  {
    v3 = *a1++;
    v4 = v3 < 0x30u;
    LOBYTE(v1) = v3 - 48;
    if ( v4 || (unsigned __int8)v1 > 9u )
      break;
  }
  return v1;
}

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

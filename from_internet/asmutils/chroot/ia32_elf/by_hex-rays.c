/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall __noreturn start(int@<eax>, int);


//----- (0804804C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn start(int a1@<eax>, int a2)
{
  const char *v2; // ebx
  int v3; // eax
  int v4; // [esp-Ch] [ebp-Ch]
  const char *v5; // [esp-4h] [ebp-4h]
  const char *retaddr; // [esp+0h] [ebp+0h] BYREF

  if ( v4 != 1 )
  {
    a1 = sys_chroot(v5);
    if ( a1 >= 0 )
    {
      v2 = retaddr;
      if ( !retaddr )
        v2 = "/bin/sh";
      a1 = sys_execve(v2, &retaddr, (const char **)&a2 + v4 - 1);
    }
  }
  v3 = sys_exit(a1);
}
// 8048052: positive sp value C has been found
// 804804E: variable 'v4' is possibly undefined
// 8048055: variable 'v5' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

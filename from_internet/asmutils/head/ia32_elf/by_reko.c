// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C(Stack word32 dwArg00)
void fn0804804C(word32 dwArg00)
{
	g_dw804811E = 0x00;
	g_dw804811A = 0x0A;
	word16 * edi_133 = null;
	int32 ebp_140 = 0x00;
	struct Eq_13 * esp_13 = fp + 8;
	if (dwArg00 != 0x01)
	{
		while (true)
		{
			while (true)
			{
l0804808D:
				word16 * ebx_17 = esp_13->dw0000;
				++esp_13;
				word16 * ebx_19 = ebx_17;
				if (ebx_17 == null)
				{
					if (ebp_140 == 0x00)
						goto l080480BA;
					esp_13->dwFFFFFFFC = 0x01;
					__syscall(0x80);
					ebx_19 = edi_133;
				}
				if (*ebx_19 != 28205)
					break;
				g_dw804811A = fn08048106(esp_13->dw0000);
				++esp_13;
			}
			if (*ebx_19 != 0x632D)
				break;
			g_dw804811E = fn08048106(esp_13->dw0000);
			++esp_13;
		}
		esp_13->dwFFFFFFFC = 0x05;
		int32 eax_64 = esp_13->dwFFFFFFFC;
		__syscall(0x80);
		ebp_140 = eax_64;
		if (eax_64 < 0x00)
		{
l080480B7:
			edi_133 = (word16 *) ((char *) edi_133 + 1);
			goto l0804808D;
		}
	}
l080480BA:
	struct Eq_22 ** esp_79 = esp_13 - 4;
	*esp_79 = (struct Eq_22 **) (struct Eq_22 *) 0x03;
	struct Eq_22 * eax_81 = *esp_79;
	__syscall(0x80);
	esp_13 = (struct Eq_13 *) ((char *) esp_79 + 4);
	if (eax_81 < null)
		goto l080480B7;
	if (eax_81 != null)
	{
		if (g_dw804811E <= 0x00)
		{
			struct Eq_22 * esi_102 = (struct Eq_22 *) ~0x00;
			do
			{
				++esi_102;
				if (esi_102 > eax_81)
					break;
				if (esi_102[0x08048122] != 0x0A)
					continue;
				--g_dw804811A;
			} while (g_dw804811A != 0x00);
		}
		*esp_79 = (struct Eq_22 **) (struct Eq_22 *) 0x01;
		*esp_79 = (struct Eq_22 **) (struct Eq_22 *) 0x04;
		__syscall(0x80);
		esp_13 = (struct Eq_13 *) ((char *) esp_79 + 4);
	}
	else
	{
		*esp_79 = (struct Eq_22 **) (struct Eq_22 *) 0x06;
		__syscall(0x80);
		esp_13 = (struct Eq_13 *) ((char *) esp_79 + 4);
		++ebp_140;
	}
	goto l0804808D;
}

// 08048106: Register Eq_152 fn08048106(Register (ptr32 byte) esi)
// Called from:
//      fn0804804C
Eq_152 fn08048106(byte * esi)
{
	Eq_152 ebx_14 = 0x00;
	while (true)
	{
		byte al_9 = *esi;
		++esi;
		if (al_9 == 0x00)
			break;
		ebx_14 = ebx_14 *s 0x0A + (uint32) (al_9 - 0x30);
	}
	return ebx_14;
}

int32 g_dw804811A = 0; // 0804811A
int32 g_dw804811E = 0; // 0804811E

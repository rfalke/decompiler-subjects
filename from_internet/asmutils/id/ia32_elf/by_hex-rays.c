/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __fastcall __noreturn start(int);
unsigned int sub_8048083();
// signed int __usercall sub_80480D4@<eax>(signed int@<eax>, int@<ecx>, int@<ebx>);
// unsigned int __usercall sub_8048108@<eax>(unsigned int@<eax>, _BYTE *@<edi>);

//-------------------------------------------------------------------------
// Data declarations

int dword_8048120 = 1970238055; // weak
gid_t list; // idb
char byte_80481A7; // weak


//----- (0804804C) --------------------------------------------------------
void __fastcall __noreturn start(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // eax
  int v4; // eax
  int v5; // [esp-4h] [ebp-4h] BYREF

  __asm { int     80h; LINUX - sys_getuid }
  sub_80480D4(24, a1, 1029990773);
  __asm { int     80h; LINUX - sys_getgid }
  sub_80480D4(47, v1, 1029990759);
  sub_8048083();
  LOBYTE(v2) = 10;
  v5 = v2;
  v3 = sys_write(1, &v5, 1u);
  v4 = sys_exit(0);
}
// 8048062: variable 'v1' is possibly undefined
// 804806E: variable 'v2' is possibly undefined

//----- (08048083) --------------------------------------------------------
unsigned int sub_8048083()
{
  int v0; // ebp
  size_t v1; // edx
  unsigned int result; // eax
  gid_t *i; // esi
  char *v4; // edi

  v0 = sys_getgroups(64, &list);
  LOBYTE(v1) = 7;
  result = sys_write(1, &dword_8048120, v1);
  for ( i = &list; v0; result = sys_write(1, &byte_80481A7, v4 - &byte_80481A7) )
  {
    v4 = &byte_80481A7;
    LOWORD(result) = *(_WORD *)i;
    i = (gid_t *)((char *)i + 2);
    sub_8048108(result, &byte_80481A7);
    if ( --v0 )
    {
      byte_80481A7 = 44;
      v4 = &byte_80481A7 + 1;
    }
  }
  return result;
}
// 804809F: variable 'v1' is possibly undefined
// 8048120: using guessed type int dword_8048120;
// 80481A7: using guessed type char byte_80481A7;

//----- (080480D4) --------------------------------------------------------
signed int __usercall sub_80480D4@<eax>(signed int a1@<eax>, int a2@<ecx>, int a3@<ebx>)
{
  size_t v3; // edx
  int v4; // eax
  int v5; // eax
  int v7; // [esp-28h] [ebp-28h] BYREF
  char *v8; // [esp-24h] [ebp-24h]
  signed int v9; // [esp-20h] [ebp-20h]
  int v10; // [esp-18h] [ebp-18h]
  void **v11; // [esp-10h] [ebp-10h]
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  v11 = &retaddr;
  v10 = a2;
  v9 = a1;
  if ( a1 >= 0 )
  {
    v8 = &byte_80481A7;
    v7 = a3;
    sub_8048108(a1, &byte_80481A7);
    byte_80481A7 = 9;
    LOBYTE(v3) = 4;
    v4 = sys_write(1, &v7, v3);
    v5 = sys_write(1, v8, &byte_80481A7 + 1 - v8);
  }
  return v9;
}
// 80480F4: variable 'v3' is possibly undefined
// 80481A7: using guessed type char byte_80481A7;

//----- (08048108) --------------------------------------------------------
unsigned int __usercall sub_8048108@<eax>(unsigned int a1@<eax>, _BYTE *a2@<edi>)
{
  int v2; // ecx
  unsigned int v3; // et2
  unsigned int v4; // edx
  unsigned int result; // eax

  v2 = 0;
  do
  {
    v3 = a1 % 0xA;
    a1 /= 0xAu;
    v4 = v3;
    LOBYTE(v4) = v3 + 48;
    ++v2;
  }
  while ( a1 );
  do
  {
    result = v4;
    *a2++ = v4;
    --v2;
  }
  while ( v2 );
  return result;
}

// nfuncs=4 queued=4 decompiled=4 lumina nreq=0 worse=0 better=0
// ALL OK, 4 function(s) have been successfully decompiled

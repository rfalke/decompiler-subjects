/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __noreturn start(); // weak
// int __usercall sub_80480E5@<eax>(unsigned int@<edi>, unsigned __int8 *@<esi>);
int sub_8048118();
int sub_8048129();
int sub_8048144();
void sub_804816C();
int sub_8048194();
// int __usercall sub_8048205@<eax>(mode_t@<edx>, char *@<ebx>);
int sub_8048227();
char sub_8048233();
int sub_804832E(void); // weak
int sub_8048330();
int sub_8048348();
int sub_804835D();
int sub_8048372();
void sub_804838F();
int sub_80483A0();
int sub_80483CF();
// unsigned int __usercall sub_80484FD@<eax>(unsigned int@<eax>, int@<ecx>, _BYTE *@<edi>);
int sub_8048514();
// char __usercall sub_8048522@<al>(_BYTE *@<edi>, char *@<esi>);
char *sub_8048529();
int sub_8048622();
int sub_804865E(void); // weak
// unsigned int __usercall sub_8048660@<eax>(unsigned int@<eax>);
int sub_8048788();
int __fastcall sub_80487B2(int);
int __fastcall sub_80487C3(int);

//-------------------------------------------------------------------------
// Data declarations

__int16 word_8048466 = 20297; // weak
int (*funcs_80482B9[8])() =
{
  &sub_80483CF,
  &sub_8048348,
  &sub_804835D,
  &sub_804838F,
  &sub_80483A0,
  &sub_8048330,
  &sub_8048372,
  &sub_804832E
}; // weak
char path[2] = "."; // idb
char byte_80487F7 = 'N'; // weak
int dword_80487FE = 134516403; // weak
__int16 word_8048802 = 29525; // weak
__int16 word_8048862 = 31776; // weak
int fd; // idb
int dword_804886B; // idb
uid_t uid; // idb
char filename[256]; // idb
struct stat buf; // idb
int dword_8048AB3; // weak
char addr[100]; // idb
mode_t mode; // idb
uid_t dword_8048B23; // idb
gid_t gid; // idb
int dword_8048B33; // weak
char byte_8048B4B; // weak
char byte_8048B53; // weak
char oldpath[100]; // idb
int dword_8048BB8; // weak
char byte_8048BBE; // weak
int dword_8048C00; // weak
dev_t dev; // idb
int dword_8048C10[38]; // weak
char byte_8048CAB; // weak
int dword_8048EAF; // weak


//----- (0804804C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn start()
{
  int v0; // eax
  mode_t v1; // edx
  int v2; // eax
  int v3; // eax
  int v4; // ebx
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  size_t v11; // edx
  const void *v12; // ecx
  int v13; // eax
  _WORD *v14; // [esp-Ch] [ebp-Ch]
  char *v15; // [esp-8h] [ebp-8h]
  char *v16; // [esp-4h] [ebp-4h] BYREF

  __asm { int     80h; LINUX - sys_getuid }
  uid = 0;
  v0 = sys_setreuid(0, 0x18u);
  if ( v14 )
  {
    switch ( *v14 )
    {
      case 0x742D:
        sub_8048205(v1, v15);
        sub_8048194();
        sub_8048227();
        v4 = 0;
        break;
      case 0x782D:
        sub_8048205(v1, v15);
        v5 = sys_setuid(0);
        v6 = sys_chroot(path);
        v4 = uid;
        v7 = sys_setuid(uid);
        dword_8048AB3 = (int)&v16;
        sub_8048233();
        sub_8048227();
        break;
      case 0x632D:
        v4 = (int)v15;
        if ( v15 )
        {
          v9 = 1;
          if ( *(_WORD *)v15 == 45 || (v9 = sys_open(v15, 577, 0x1B6u), v9 >= 0) )
          {
            fd = v9;
            while ( v16 )
            {
              sub_8048522(filename, v16);
              sub_8048529();
            }
            sub_8048514();
            v4 = fd;
            v10 = sys_write(fd, addr, 0x200u);
            v13 = sys_write(v4, v12, v11);
            sub_8048227();
          }
        }
        break;
      default:
        goto LABEL_5;
    }
    v8 = sys_exit(v4);
  }
LABEL_5:
  v2 = sys_write(1, &word_8048802, 0x60u);
  v3 = sys_exit(0);
}
// 80484C0: positive sp value 14 has been found
// 8048064: variable 'v14' is possibly undefined
// 8048099: variable 'v1' is possibly undefined
// 8048099: variable 'v15' is possibly undefined
// 80484F1: variable 'v12' is possibly undefined
// 80484F1: variable 'v11' is possibly undefined
// 804804C: using guessed type void __noreturn start();
// 8048802: using guessed type __int16 word_8048802;
// 8048AB3: using guessed type int dword_8048AB3;

//----- (080480E5) --------------------------------------------------------
int __usercall sub_80480E5@<eax>(unsigned int a1@<edi>, unsigned __int8 *a2@<esi>)
{
  int v2; // ecx
  int result; // eax
  unsigned __int8 v4; // cl
  bool v5; // cf
  int v6; // eax

  v2 = 0;
  result = 0;
  do
  {
    v4 = *a2;
    if ( !*a2 )
      break;
    if ( v4 != 32 )
    {
      v5 = v4 < 0x30u;
      LOBYTE(v2) = v4 - 48;
      if ( v5 || (unsigned __int8)v2 > 7u )
        v6 = sys_exit(253);
      result = v2 + 8 * result;
    }
    ++a2;
  }
  while ( (unsigned int)a2 < a1 );
  return result;
}

//----- (08048118) --------------------------------------------------------
int sub_8048118()
{
  dword_8048B33 = sub_80480E5((unsigned int)(&dword_8048B33 + 3), (unsigned __int8 *)&dword_8048B33);
  return sub_8048144();
}
// 8048B33: using guessed type int dword_8048B33;

//----- (08048129) --------------------------------------------------------
int sub_8048129()
{
  dword_8048C00 = sub_80480E5((unsigned int)(&dword_8048C00 + 2), (unsigned __int8 *)&dword_8048C00);
  *(&dword_8048C00 + 2) = sub_80480E5((unsigned int)(&dword_8048C00 + 4), (unsigned __int8 *)&dword_8048C00 + 8);
  return sub_8048144();
}
// 8048C00: using guessed type int dword_8048C00;

//----- (08048144) --------------------------------------------------------
int sub_8048144()
{
  int result; // eax

  mode = sub_80480E5((unsigned int)(&mode + 2), (unsigned __int8 *)&mode);
  *(&mode + 2) = sub_80480E5((unsigned int)(&mode + 4), (unsigned __int8 *)&mode + 8);
  result = sub_80480E5((unsigned int)(&mode + 6), (unsigned __int8 *)&mode + 16);
  *(&mode + 4) = result;
  return result;
}

//----- (0804816C) --------------------------------------------------------
void sub_804816C()
{
  timespec *p_st_mtim; // edi
  int *v1; // esi
  int v2; // ecx
  char v3; // al
  _BYTE *v4; // edi
  char *v5; // esi
  char v6; // al

  p_st_mtim = &buf.st_mtim;
  v1 = dword_8048C10;
  v2 = 156;
  do
  {
    v3 = *(_BYTE *)v1;
    v1 = (int *)((char *)v1 + 1);
    LOBYTE(p_st_mtim->tv_sec) = v3;
    p_st_mtim = (timespec *)((char *)p_st_mtim + 1);
    --v2;
  }
  while ( v3 && v2 );
  v4 = (char *)&p_st_mtim[-1].tv_nsec + 3;
  v5 = addr;
  LOBYTE(v2) = 100;
  do
  {
    v6 = *v5++;
    *v4++ = v6;
    --v2;
  }
  while ( v6 && v2 );
  *v4 = 0;
}
// 8048C10: using guessed type int dword_8048C10[38];

//----- (08048194) --------------------------------------------------------
int sub_8048194()
{
  int result; // eax
  size_t v1; // edx
  timespec *p_st_mtim; // ecx
  int v4; // eax
  int v5; // eax

  while ( 1 )
  {
    result = sys_read(fd, addr, 0x200u);
    if ( !result )
      break;
    if ( dword_8048BB8 == 1635021685 )
    {
      sub_804816C();
      v1 = 0;
      p_st_mtim = &buf.st_mtim;
      while ( 1 )
      {
        while ( *((_BYTE *)&p_st_mtim->tv_sec + v1++) != 0 )
          ;
        *(_WORD *)((char *)p_st_mtim + v1 - 1) = 10;
        v4 = sys_write(1, p_st_mtim, v1);
        if ( byte_8048B53 != 50 && byte_8048B53 != 49 )
          break;
        v5 = sys_write(1, &word_8048862, 5u);
        v1 = 0;
        p_st_mtim = (timespec *)oldpath;
        byte_8048B53 = 0;
      }
    }
  }
  return result;
}
// 8048862: using guessed type __int16 word_8048862;
// 8048B53: using guessed type char byte_8048B53;
// 8048BB8: using guessed type int dword_8048BB8;

//----- (08048205) --------------------------------------------------------
int __usercall sub_8048205@<eax>(mode_t a1@<edx>, char *a2@<ebx>)
{
  int result; // eax
  int v3; // eax

  result = 0;
  if ( *(_WORD *)a2 != 45 )
  {
    result = sys_open(a2, 0, a1);
    if ( result < 0 )
      v3 = sys_exit(255);
  }
  fd = result;
  return result;
}

//----- (08048227) --------------------------------------------------------
int sub_8048227()
{
  return sys_close(fd);
}

//----- (08048233) --------------------------------------------------------
char sub_8048233()
{
  size_t v0; // edx
  char *v1; // ecx
  char v2; // bl
  unsigned int v3; // eax
  unsigned int v4; // edx
  int v5; // ecx
  bool v6; // cc
  int v7; // eax
  timespec *p_st_mtim; // esi
  unsigned __int8 *v9; // edi
  unsigned __int8 tv_sec; // al
  unsigned __int8 v11; // cl
  bool v12; // sf
  int v13; // eax
  int v14; // eax
  unsigned int v15; // ebp
  int v16; // ebx
  char *v17; // ecx
  size_t v18; // edx
  int v19; // eax

  while ( 1 )
  {
    v0 = 512;
    v1 = addr;
    do
    {
      v2 = fd;
      v3 = sys_read(fd, v1, v0);
      if ( !v3 )
        JUMPOUT(0x804844F);
      v1 = (char *)(v3 + v5);
      v6 = v4 <= v3;
      v0 = v4 - v3;
    }
    while ( !v6 );
    LOBYTE(v7) = 0;
    if ( byte_8048BBE != 32 || dword_8048BB8 != 1635021685 )
      return v7;
    sub_804816C();
    if ( *(_DWORD *)dword_8048AB3 )
    {
      p_st_mtim = &buf.st_mtim;
      v9 = *(unsigned __int8 **)dword_8048AB3;
      if ( *(_DWORD *)dword_8048AB3 )
      {
        while ( 1 )
        {
          tv_sec = p_st_mtim->tv_sec;
          p_st_mtim = (timespec *)((char *)p_st_mtim + 1);
          v11 = *v9++;
          if ( tv_sec != v11 )
            break;
          if ( !(v11 | tv_sec) )
            goto LABEL_10;
        }
      }
      sub_8048118();
      v15 = (unsigned int)(dword_8048B33 + 511) >> 9;
      if ( v15 )
      {
        v16 = fd;
        v17 = &byte_8048CAB;
        v18 = 512;
        do
        {
          v19 = sys_read(v16, v17, v18);
          --v15;
        }
        while ( v15 );
      }
    }
    else
    {
LABEL_10:
      v7 = (unsigned __int8)byte_8048B53;
      if ( byte_8048B53 )
      {
        if ( (unsigned __int8)byte_8048B53 > 0x37u )
          return v7;
        LOBYTE(v7) = byte_8048B53 - 48;
        if ( (unsigned __int8)byte_8048B53 < 0x30u )
          return v7;
      }
      v12 = funcs_80482B9[v7]() < 0;
      LOBYTE(v7) = v2;
      if ( v12 )
        return v7;
      v13 = sys_lchown((const char *)&buf.st_mtim, dword_8048B23, gid);
      if ( byte_8048B53 != 50 )
        v14 = sys_chmod((const char *)&buf.st_mtim, mode);
    }
  }
}
// 804824F: control flows out of bounds to 804844F
// 8048255: variable 'v5' is possibly undefined
// 8048257: variable 'v4' is possibly undefined
// 8048324: variable 'v17' is possibly undefined
// 8048324: variable 'v18' is possibly undefined
// 804832E: using guessed type int sub_804832E(void);
// 804846F: using guessed type int (*funcs_80482B9[8])();
// 8048AB3: using guessed type int dword_8048AB3;
// 8048B33: using guessed type int dword_8048B33;
// 8048B53: using guessed type char byte_8048B53;
// 8048BB8: using guessed type int dword_8048BB8;
// 8048BBE: using guessed type char byte_8048BBE;
// 8048CAB: using guessed type char byte_8048CAB;

//----- (08048330) --------------------------------------------------------
int sub_8048330()
{
  int v0; // eax

  sub_8048144();
  v0 = sys_mkdir((const char *)&buf.st_mtim, mode);
  return 0;
}

//----- (08048348) --------------------------------------------------------
int sub_8048348()
{
  sub_8048144();
  return sys_link(oldpath, addr);
}

//----- (0804835D) --------------------------------------------------------
int sub_804835D()
{
  sub_8048144();
  return sys_symlink(oldpath, addr);
}

//----- (08048372) --------------------------------------------------------
int sub_8048372()
{
  int v0; // edx

  sub_8048144();
  mode |= 0x1000u;
  return sys_mknod(addr, mode, v0);
}
// 804838C: variable 'v0' is possibly undefined

//----- (0804838F) --------------------------------------------------------
void sub_804838F()
{
  sub_8048129();
  mode |= 0x2000u;
  JUMPOUT(0x80483AF);
}
// 804839E: control flows out of bounds to 80483AF

//----- (080483A0) --------------------------------------------------------
int sub_80483A0()
{
  int v0; // edx

  sub_8048129();
  mode |= 0x6000u;
  v0 = dword_8048C00 << 8;
  LOBYTE(v0) = dev;
  return sys_mknod((const char *)&buf.st_mtim, mode, v0);
}
// 8048C00: using guessed type int dword_8048C00;

//----- (080483CF) --------------------------------------------------------
int sub_80483CF()
{
  int result; // eax
  int v1; // ebx
  int v2; // esi
  char *v3; // ecx
  size_t v4; // edx
  unsigned int v5; // eax
  unsigned int v6; // edx
  int v7; // ecx
  bool v8; // cc
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax

  sub_8048118();
  result = sys_open((char *)&buf.st_mtim, 577, 0x80u);
  if ( result >= 0 )
  {
    dword_804886B = result;
    v1 = result;
    v2 = dword_8048B33;
    v3 = &byte_8048CAB;
    v4 = 512;
    while ( v2 )
    {
      do
      {
        v5 = sys_read(fd, v3, v4);
        if ( !v5 )
        {
          v11 = sys_write(2, &word_8048466, 9u);
          v12 = sys_exit(2);
        }
        v3 = (char *)(v5 + v7);
        v8 = v6 <= v5;
        v4 = v6 - v5;
      }
      while ( !v8 );
      v2 -= 512;
      if ( v2 < 0 )
      {
        v1 = dword_804886B;
        v10 = sys_write(dword_804886B, &byte_8048CAB, v2 + 512);
        return sys_close(v1);
      }
      v1 = dword_804886B;
      v9 = sys_write(dword_804886B, &byte_8048CAB, 0x200u);
    }
    return sys_close(v1);
  }
  return result;
}
// 8048411: variable 'v3' is possibly undefined
// 8048411: variable 'v4' is possibly undefined
// 8048417: variable 'v7' is possibly undefined
// 8048419: variable 'v6' is possibly undefined
// 8048466: using guessed type __int16 word_8048466;
// 8048B33: using guessed type int dword_8048B33;
// 8048CAB: using guessed type char byte_8048CAB;

//----- (080484FD) --------------------------------------------------------
unsigned int __usercall sub_80484FD@<eax>(unsigned int a1@<eax>, int a2@<ecx>, _BYTE *a3@<edi>)
{
  int v3; // ecx
  unsigned int v4; // et2
  unsigned int v5; // edx
  unsigned int result; // eax

  v3 = a2 - 1;
  do
  {
    v4 = a1 % 8;
    a1 /= 8u;
    v5 = v4;
    LOBYTE(v5) = v4 + 48;
    --v3;
  }
  while ( v3 );
  do
  {
    result = v5;
    *a3++ = v5;
  }
  while ( v5 );
  return result;
}

//----- (08048514) --------------------------------------------------------
int sub_8048514()
{
  int result; // eax

  result = 0;
  memset(addr, 0, 0x200u);
  return result;
}

//----- (08048522) --------------------------------------------------------
char __usercall sub_8048522@<al>(_BYTE *a1@<edi>, char *a2@<esi>)
{
  char result; // al

  do
  {
    result = *a2++;
    *a1++ = result;
  }
  while ( result );
  return result;
}

//----- (08048529) --------------------------------------------------------
char *sub_8048529()
{
  int v0; // eax
  unsigned int v1; // eax
  unsigned int v2; // eax
  int v3; // ecx
  char *v4; // edi
  unsigned int v5; // eax
  unsigned int v6; // eax
  int v7; // eax
  char *result; // eax
  mode_t v9; // edx
  int v10; // eax
  int v11; // ebp
  signed int v12; // esi
  int v13; // edi
  char *v14; // ecx
  size_t v15; // eax
  int v16; // eax
  int v17; // eax
  mode_t v18; // edx
  int v19; // ett
  char *v20; // edi
  _BYTE *v21; // edi
  int v22; // ecx
  int v23; // ecx
  unsigned int v24; // eax
  char *v25; // esi
  unsigned int v26; // edx
  bool v27; // cc
  int v28; // [esp-10h] [ebp-10h]
  unsigned int v29; // [esp-8h] [ebp-8h]
  unsigned int st_mode_low; // [esp-4h] [ebp-4h]
  int v31; // [esp-4h] [ebp-4h]

  if ( sys_newlstat(filename, &buf) )
    JUMPOUT(0x8048528);
  v0 = sub_8048514();
  LOWORD(v0) = buf.__pad1;
  v1 = sub_80484FD(v0, 8, &mode);
  LOWORD(v1) = buf.st_ino;
  v2 = sub_80484FD(v1, 8, &mode);
  LOWORD(v2) = HIWORD(buf.st_ino);
  sub_80484FD(v2, 8, &mode);
  LOBYTE(v3) = 12;
  v4 = (char *)&mode + v3;
  sub_80484FD(*(unsigned int *)&buf.__pad2, v3, (_BYTE *)&mode + v3);
  strcpy(v4 + 109, "ustar  ");
  sub_8048522(addr, filename);
  LOWORD(v5) = buf.__pad1;
  v6 = v5 >> 12;
  switch ( (_BYTE)v6 )
  {
    case 0xA:
      sub_804865E();
      byte_8048B53 = 50;
      v7 = sys_readlink(filename, oldpath, 0x64u);
      return (char *)sub_8048622();
    case 8:
      sub_8048660(buf.st_nlink);
      byte_8048B53 = 48;
      v10 = sys_open(filename, 0, v9);
      if ( v10 < 0 )
        goto LABEL_40;
      v11 = v10;
      sub_8048622();
      v12 = (buf.st_nlink + 511) & 0xFFFFFE00;
      if ( v12 )
      {
        v13 = fd;
        v14 = &byte_8048CAB;
        while ( 1 )
        {
          v15 = sys_read(v11, v14, 0x200u);
          if ( !v15 )
            break;
          v12 -= v15;
          if ( v12 < 0 )
          {
            v12 += v15;
            if ( !v12 )
              return (char *)sys_close(v11);
            break;
          }
          v16 = sys_write(v13, &byte_8048CAB, v15);
        }
        sub_8048514();
        v17 = sys_write(fd, addr, v12);
      }
      return (char *)sys_close(v11);
    case 6:
      byte_8048B53 = 52;
      goto LABEL_13;
    case 4:
      byte_8048B53 = 53;
      sub_8048622();
      v19 = sys_open(filename, 0, v18);
      result = filename;
      if ( v19 >= 0 )
      {
        v20 = &filename[strlen(filename)];
        *v20 = 47;
        v21 = v20 + 1;
        *v21 = 0;
        sub_8048788();
        v31 = v22;
        while ( 1 )
        {
          v23 = v31;
          v24 = 141;
          __asm { int     80h; LINUX - sys_getdents }
          do
          {
            v25 = (char *)(v23 + 10);
            if ( *(_BYTE *)(v23 + 10) && *(_WORD *)v25 != 46 && (*(_WORD *)v25 != 11822 || *(_BYTE *)(v23 + 12)) )
            {
              v29 = v24;
              v28 = v23;
              sub_8048522(v21, v25);
              if ( (unsigned int)v21 <= 0x80488D7 )
                sub_8048529();
              v23 = v28;
              v24 = v29;
            }
            v26 = *(unsigned __int16 *)(v23 + 8);
            v23 += v26;
            v27 = v24 <= v26;
            v24 -= v26;
          }
          while ( !v27 );
        }
      }
      break;
    case 2:
      byte_8048B53 = 51;
LABEL_13:
      sub_804865E();
      st_mode_low = LOBYTE(buf.st_mode);
      sub_80484FD((LOBYTE(buf.st_mode) ^ buf.st_mode) >> 8, 8, &dword_8048C00);
      sub_80484FD(st_mode_low, 8, &dword_8048C00);
      return (char *)sub_8048622();
    default:
      if ( v6 == 1 )
      {
        sub_804865E();
        byte_8048B53 = 54;
        return (char *)sub_8048622();
      }
LABEL_40:
      JUMPOUT(0x804865D);
  }
  return result;
}
// 804853A: control flows out of bounds to 8048528
// 80485C5: control flows out of bounds to 804865D
// 8048576: variable 'v3' is possibly undefined
// 80485A5: variable 'v5' is possibly undefined
// 8048687: variable 'v9' is possibly undefined
// 80486BB: variable 'v14' is possibly undefined
// 8048709: variable 'v18' is possibly undefined
// 804872A: variable 'v22' is possibly undefined
// 804865E: using guessed type int sub_804865E(void);
// 8048B53: using guessed type char byte_8048B53;
// 8048C00: using guessed type int dword_8048C00;
// 8048CAB: using guessed type char byte_8048CAB;

//----- (08048622) --------------------------------------------------------
int sub_8048622()
{
  __int64 v0; // rax
  char *v1; // esi
  int v2; // ecx

  v0 = 32LL;
  memset(&byte_8048B4B, 32, 8u);
  v1 = addr;
  v2 = 512;
  do
  {
    LOBYTE(v0) = *v1++;
    HIDWORD(v0) += v0;
    --v2;
  }
  while ( v2 );
  sub_80484FD(HIDWORD(v0), 7, &byte_8048B4B);
  return sys_write(fd, addr, 0x200u);
}
// 8048622: could not find valid save-restore pair for edi
// 8048B4B: using guessed type char byte_8048B4B;

//----- (08048660) --------------------------------------------------------
unsigned int __usercall sub_8048660@<eax>(unsigned int a1@<eax>)
{
  return sub_80484FD(a1, 11, &dword_8048B33);
}
// 8048B33: using guessed type int dword_8048B33;

//----- (08048788) --------------------------------------------------------
int sub_8048788()
{
  int v0; // ecx
  int result; // eax
  int v2; // ecx
  int v3; // et0

  v0 = dword_8048EAF;
  if ( dword_8048EAF )
  {
    result = *(_DWORD *)dword_8048EAF;
    dword_8048EAF = *(_DWORD *)dword_8048EAF;
  }
  else
  {
    v3 = sub_80487C3(1028);
    result = v2;
    v0 = v3;
  }
  *(_DWORD *)(v0 + 1024) = 0;
  return result;
}
// 80487AF: variable 'v2' is possibly undefined
// 8048EAF: using guessed type int dword_8048EAF;

//----- (080487B2) --------------------------------------------------------
int __fastcall sub_80487B2(int a1)
{
  _DWORD *v1; // ecx
  int result; // eax

  v1 = (_DWORD *)(a1 - 4);
  result = dword_8048EAF;
  *v1 = dword_8048EAF;
  dword_8048EAF = (int)v1;
  return result;
}
// 8048EAF: using guessed type int dword_8048EAF;

//----- (080487C3) --------------------------------------------------------
int __fastcall sub_80487C3(int a1)
{
  int v1; // ebx
  int result; // eax
  int v3; // eax
  int v4; // eax

  v1 = a1 + dword_80487FE;
  if ( !sys_brk((void *)(a1 + dword_80487FE)) )
  {
    v3 = sys_write(2, &byte_80487F7, 7u);
    v4 = sys_exit(250);
  }
  result = dword_80487FE;
  dword_80487FE = v1;
  return result;
}
// 80487F7: using guessed type char byte_80487F7;
// 80487FE: using guessed type int dword_80487FE;

// nfuncs=28 queued=26 decompiled=26 lumina nreq=0 worse=0 better=0
// ALL OK, 26 function(s) have been successfully decompiled

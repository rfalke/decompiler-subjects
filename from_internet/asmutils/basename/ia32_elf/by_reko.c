// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C(Register (ptr32 char) ecx, Stack int32 dwArg00, Stack (ptr32 char) dwArg08, Stack (ptr32 char) dwArg0C)
void fn0804804C(char * ecx, int32 dwArg00, char * dwArg08, char * dwArg0C)
{
	ptr32 fp;
	int32 ebx_142 = 0x01;
	struct Eq_9 * esp_140 = fp + 4;
	if (dwArg00 == 0x01 || dwArg00 > 0x03)
	{
l0804809C:
		esp_140->dwFFFFFFFC = 0x01;
		sys_exit(ebx_142);
	}
	char * eax_18 = dwArg08;
	ptr32 esp_106 = fp + 0x0C;
	char * edx_103 = null;
	if (*dwArg08 != 0x00)
	{
		do
			++eax_18;
		while (*eax_18 != 0x00);
		do
		{
			--eax_18;
			if (eax_18 < dwArg08)
			{
				edx_103 = null;
				goto l0804808D;
			}
		} while (*eax_18 == 0x2F);
		word32 eax_38 = eax_18 + 0x01;
		do
		{
			eax_38 -= (char *) 0x01;
			if (*eax_38 == 0x2F)
			{
				++eax_38;
				break;
			}
		} while (eax_38 != dwArg08);
		ecx = eax_38;
		edx_103 = eax_18 + 0x01 - eax_38;
		if (dwArg00 != 0x02)
		{
			char * eax_65 = dwArg0C;
			word32 ecx_71 = eax_38 + edx_103;
			if (*dwArg0C != 0x00)
			{
				do
					++eax_65;
				while (*eax_65 != 0x00);
				char * eax_81 = eax_65 - dwArg0C;
				if (eax_81 < edx_103)
				{
					word32 eax_85 = eax_81 + dwArg0C;
					eax_90 = eax_85;
					do
					{
						char * eax_90;
						--eax_90;
						ecx_71 -= (char *) 0x01;
						if (*ecx_71 != *eax_90)
							goto l0804808B;
					} while (eax_90 != dwArg0C);
					ecx = eax_38;
					esp_106 = fp + 16;
					edx_103 -= eax_85 - dwArg0C;
					goto l0804808D;
				}
			}
l0804808B:
			ecx = eax_38;
			esp_106 = fp + 16;
			goto l0804808D;
		}
	}
l0804808D:
	Mem128[ecx + edx_103:byte] = 0x0A;
	uint32 * esp_133 = esp_106 - 4;
	*esp_133 = 0x01;
	uint32 ebx_135 = *esp_133;
	*esp_133 = 0x04;
	sys_write(ebx_135, ecx, edx_103 + 1);
	esp_140 = (struct Eq_9 *) (esp_133 + 1);
	ebx_142 = 0x00;
	goto l0804809C;
}


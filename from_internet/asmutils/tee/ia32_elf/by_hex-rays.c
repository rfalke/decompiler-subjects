/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __noreturn start(); // weak

//-------------------------------------------------------------------------
// Data declarations

struct sigaction act = { { (__sighandler_t)1 }, { { 0u, 0u, 0u,  } } }; // idb
char byte_804A0FF; // weak


//----- (0804804C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn start()
{
  char *v0; // edi
  int v1; // ebp
  int v2; // ecx
  char *v3; // ebx
  char *v4; // esi
  char v5; // al
  int v6; // eax
  struct sigaction *v7; // edx
  const struct sigaction *v8; // ecx
  int v9; // eax
  int v10; // eax
  signed int v11; // eax
  const void *v12; // ecx
  int v13; // eax
  size_t v14; // edx
  const void *v15; // ecx
  int *v16; // esi
  int v17; // eax
  int v18; // eax
  int v19; // eax
  int v20; // [esp-10h] [ebp-10h]
  char *v21; // [esp-8h] [ebp-8h]
  int v22; // [esp-8h] [ebp-8h]
  char *v23; // [esp-4h] [ebp-4h]

  v0 = &byte_804A0FF;
  v1 = 0;
  if ( v20 != 1 )
  {
    v2 = 577;
    v3 = v21;
    v4 = v21 + 1;
    if ( *v21 != 45 )
      goto LABEL_9;
    while ( 1 )
    {
      v5 = *v4++;
      if ( !v5 )
        break;
      if ( v5 == 97 )
      {
        v2 = 1089;
      }
      else
      {
        if ( v5 != 105 )
          goto LABEL_19;
        v22 = v2;
        v6 = sys_sigaction(13, &act, 0);
        v9 = sys_sigaction(2, v8, v7);
        v2 = v22;
      }
    }
    while ( 1 )
    {
      v3 = v23;
      if ( !v23 )
        break;
LABEL_9:
      v10 = sys_open(v3, v2, 0x1B4u);
      if ( v10 >= 0 )
      {
        *(_DWORD *)v0 = v10;
        v0 += 4;
      }
      else
      {
        ++v1;
      }
    }
  }
  *(_DWORD *)v0 = 0;
  while ( 1 )
  {
    v11 = sys_read(0, &act.sa_mask.__val[3], 0x2000u);
    if ( v11 < 0 )
      break;
    if ( !v11 )
      goto LABEL_19;
    v13 = sys_write(1, v12, v11);
    v16 = (int *)&byte_804A0FF;
    while ( 1 )
    {
      v17 = *v16++;
      if ( !v17 )
        break;
      v18 = sys_write(v17, v15, v14);
    }
  }
  ++v1;
LABEL_19:
  v19 = sys_exit(v1);
}
// 8048099: positive sp value 10 has been found
// 8048056: variable 'v20' is possibly undefined
// 804805D: variable 'v21' is possibly undefined
// 8048093: variable 'v8' is possibly undefined
// 8048093: variable 'v7' is possibly undefined
// 8048098: variable 'v23' is possibly undefined
// 80480A5: variable 'v2' is possibly undefined
// 80480D2: variable 'v12' is possibly undefined
// 80480E3: variable 'v15' is possibly undefined
// 80480E3: variable 'v14' is possibly undefined
// 804804C: using guessed type void __noreturn start();
// 804A0FF: using guessed type char byte_804A0FF;

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

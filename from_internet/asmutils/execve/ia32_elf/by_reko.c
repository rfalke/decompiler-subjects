// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: Register ptr32 fn0804804C(Register ui32 edi)
// Called from:
//      fn080480A7
ptr32 fn0804804C(ui32 edi)
{
	byte * edi_10 = edi - 0x01;
	do
		++edi_10;
	while (*edi_10 != 0x00);
	return edi_10 - edi;
}

// 0804805C: void fn0804805C(Register uint32 eax, Register (ptr32 word16) edi)
// Called from:
//      fn080480A7
void fn0804805C(uint32 eax, word16 * edi)
{
	*edi = 0x7830;
	byte * edi_32 = edi + 1;
	uint32 dwLoc24_129 = eax;
	uint32 esi_41 = 0x00;
	do
	{
		uint64 edx_eax_51 = (uint64) dwLoc24_129;
		cu8 dl_57 = (byte) (edx_eax_51 % 0x10);
		*edi_32 = dl_57 - 0x69 - (byte) (dl_57 < 0x0A);
		uint32 eax_55 = (uint32) (edx_eax_51 /u 0x10);
		++esi_41;
		dwLoc24_129 = eax_55;
		++edi_32;
	} while (eax_55 != 0x00);
	*edi_32 = 0x00;
	uint32 ecx_78 = esi_41 >> 0x01;
	if (esi_41 >> 0x01 != 0x00)
	{
		byte * edi_83 = edi + 1;
		byte * esi_85 = edi_32 - 0x01;
		do
		{
			byte v24_91 = *esi_85;
			*esi_85 = *edi_83;
			*edi_83 = v24_91;
			++edi_83;
			--esi_85;
			--ecx_78;
		} while (ecx_78 != 0x00);
	}
}

// 080480A7: void fn080480A7(Register word32 ecx)
// Called from:
//      fn080481CA
void fn080480A7(word32 ecx)
{
	word32 * esi_34 = g_a80482B6;
	char * ebp_10 = &g_b80480F3;
	do
	{
		ebp_12 = ebp_10;
		do
		{
			char * ebp_12;
			++ebp_12;
		} while (*ebp_12 != 0x00);
		sys_write(0x01, ebp_10, ebp_12 - ebp_10);
		fn0804805C(*esi_34, &g_w8048302);
		sys_write(0x01, &g_w8048302, fn0804804C(0x08048302));
		sys_write(0x01, &g_b8048185, 0x01);
		ebp_10 = ebp_12 + 1;
		++esi_34;
		ecx = ecx_81 - 0x01;
		ecx_81 = ecx;
	} while (ecx_81 != 0x01);
}

char g_b80480F3 = 'E'; // 080480F3
char g_b8048185 = '\n'; // 08048185
char g_b80481A1 = 'B'; // 080481A1
char g_b80481B3 = '\n'; // 080481B3
// 080481CA: void fn080481CA(Register word32 eax, Register ptr32 ecx, Register (ptr32 (ptr32 char)) edx, Register (ptr32 char) ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register (ptr16 Eq_153) es, Register (ptr16 Eq_154) cs, Register (ptr16 Eq_155) ss, Register (ptr16 Eq_156) ds, Register (ptr16 Eq_157) fs, Register (ptr16 Eq_158) gs, Stack ui32 dwArg00, Stack (ptr32 Eq_160) dwArg04, Stack (ptr32 char) dwArg08)
void fn080481CA(word32 eax, ptr32 ecx, char ** edx, char * ebx, word32 ebp, word32 esi, word32 edi, struct Eq_153 * es, struct Eq_154 * cs, struct Eq_155 * ss, struct Eq_156 * ds, struct Eq_157 * fs, struct Eq_158 * gs, ui32 dwArg00, struct Eq_160 * dwArg04, char * dwArg08)
{
	struct Eq_162 * fp;
	Eq_163 SCZDOP;
	g_a80482B6[0] = eax;
	g_t80482D6.u1 = (word32) SCZDOP;
	g_ptr80482BA = ebx;
	g_ptr80482BE = ecx;
	g_ptr80482C2 = edx;
	g_dw80482C6 = esi;
	g_dw80482CA = edi;
	g_dw80482CE = ebp;
	g_ptr80482D2 = fp;
	g_ptr80482DA = cs;
	g_ptr80482DE = ds;
	g_ptr80482E2 = es;
	g_ptr80482E6 = fs;
	g_ptr80482EA = gs;
	g_ptr80482EE = ss;
	g_dw80482F2 = dwArg00;
	g_ptr80482F6 = dwArg04;
	g_ptr80482FA = dwArg08;
	g_dw80482FE = fp->a000C[dwArg00];
	struct Eq_160 * esi_40 = dwArg04;
	do
	{
		esi_40 = esi_344 + 1;
		esi_344 = esi_40;
	} while (esi_344->b0000 != 0x00);
	struct Eq_162 * esp_295;
	if (esi_40->dwFFFFFFFB == 0x73676572)
	{
		fn080480A7(0x13);
		esp_295 = fp;
	}
	else
	{
		esp_295 = &fp->dwFFFFFFFC + 2;
		if (dwArg00 != 0x01)
		{
			g_ptr80482BA = dwArg08;
			g_ptr80482BE = &fp->dwFFFFFFFC + 3;
			char ** edx_75 = fp->a000C + (dwArg00 - 0x01);
			g_ptr80482C2 = edx_75;
			g_dw80482C6 = 0x11223344;
			g_dw80482CA = 0x55667788;
			g_dw80482CE = 0x9900AABB;
			sys_write(0x01, &g_b80481A1, 0x12);
			sys_write(0x01, &g_b8048185, 0x1C);
			fn080480A7(0x0F);
			sys_write(0x01, &g_b80481B3, 0x17);
			sys_write(0x01, &g_b8048185, 0x1C);
			byte * eax_173 = sys_execve(dwArg08, &fp->dwFFFFFFFC + 3, edx_75);
			byte al_174 = (byte) eax_173;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
			*eax_173 += al_174;
		}
	}
	esp_295->dwFFFFFFFC = 0x01;
	sys_exit(0x00);
}

word32 g_a80482B6[] = // 080482B6
	{
	};
char * g_ptr80482BA = null; // 080482BA
ptr32 g_ptr80482BE = 0x00; // 080482BE
char ** g_ptr80482C2 = null; // 080482C2
word32 g_dw80482C6 = 0x00; // 080482C6
word32 g_dw80482CA = 0x00; // 080482CA
word32 g_dw80482CE = 0x00; // 080482CE
struct Eq_162 * g_ptr80482D2 = null; // 080482D2
Eq_163 g_t80482D6 = // 080482D6
	{
		0x00
	};
struct Eq_154 * g_ptr80482DA = null; // 080482DA
struct Eq_156 * g_ptr80482DE = null; // 080482DE
struct Eq_153 * g_ptr80482E2 = null; // 080482E2
struct Eq_157 * g_ptr80482E6 = null; // 080482E6
struct Eq_158 * g_ptr80482EA = null; // 080482EA
struct Eq_155 * g_ptr80482EE = null; // 080482EE
ui32 g_dw80482F2 = 0x00; // 080482F2
struct Eq_160 * g_ptr80482F6 = null; // 080482F6
char * g_ptr80482FA = null; // 080482FA
word32 g_dw80482FE = 0x00; // 080482FE
word16 g_w8048302 = 0x00; // 08048302

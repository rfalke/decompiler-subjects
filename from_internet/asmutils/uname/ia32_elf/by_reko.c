// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

byte g_b804804C = 115; // 0804804C
char g_b8048052 = '\n'; // 08048052
// 08048053: void fn08048053(Register uint32 edx, Stack word32 dwArg00, Stack (ptr32 Eq_4) dwArg04)
void fn08048053(uint32 edx, word32 dwArg00, struct Eq_4 * dwArg04)
{
	ptr32 fp;
	word24 edx_24_8 = SLICE(edx, word24, 8);
	uint32 edx_92;
	struct Eq_4 * esi_7 = dwArg04;
	struct Eq_10 * esp_12 = fp + 8;
	Eq_13 ebx_100 = dwArg00 - 0x01;
	uint32 edx_226 = edx;
	if (dwArg00 == 0x01)
	{
		edx_92 = SEQ(edx_24_8, 0x01);
		do
		{
			esi_7 = esi_231 + 1;
			esi_231 = esi_7;
		} while (esi_231->b0000 != 0x00);
		if (esi_7->dwFFFFFFFB == 0x68637261)
			edx_92 = SEQ(edx_24_8, 0x10);
	}
	else
	{
		do
		{
			byte * esi_14 = esp_12->dw0000;
			++esp_12;
			byte * esi_17 = esi_14 + 1;
			uint32 edx_223 = edx_226;
			if (*esi_14 != 0x2D)
				goto l080480FA;
			while (true)
			{
				byte al_22 = *esi_17;
				word24 edx_24_8_69 = SLICE(edx_223, word24, 8);
				byte dl_29 = (byte) edx_223;
				++esi_17;
				bool v32_217 = al_22 != 0x00;
				if (al_22 == 0x00)
					break;
				esp_12->dwFFFFFFFC = 0x05;
				word32 ecx_42 = esp_12->dwFFFFFFFC;
				byte * edi_230 = &g_b804804C;
				while (ecx_42 != 0x00)
				{
					v32_217 = al_22 != *edi_230;
					++edi_230;
					--ecx_42;
					if (al_22 != *edi_230)
						break;
				}
				if (v32_217)
				{
					if (al_22 != 0x61)
						goto l080480FA;
					edx_223 = SEQ(edx_24_8_69, 0x3F);
					continue;
				}
				__bts<word32>(edx_223, edi_230 - 0x0804804D, out edx_223);
			}
			edx_92 = edx_223;
			if (dl_29 == 0x00)
				goto l080480FA;
			--ebx_100;
			edx_226 = edx_223;
		} while (ebx_100 != 0x00);
	}
	word32 * esp_88 = esp_12 - 4;
	*esp_88 = 0x05;
	word32 ecx_113 = *esp_88;
	*esp_88 = 122;
	sys_uname(&g_t804810F);
	uint32 edi_107 = edx_92;
	ebx_100 = 0x0804810F;
	byte * ebp_106 = &g_t804810F;
	do
	{
		edi_107 >>= 0x01;
		if (edi_107 < 0x00)
		{
			struct Eq_167 * esp_112 = esp_12 - 4;
			esp_112->dw0000 = ecx_113;
			if (g_b804810E != 0x00)
			{
				esp_112->tFFFFFFFC = 0x01;
				Eq_13 edx_120 = esp_112->tFFFFFFFC;
				esp_112->tFFFFFFFC = 0x01;
				Eq_13 ebx_125 = esp_112->tFFFFFFFC;
				esp_112->tFFFFFFFC = 0x04;
				sys_write(ebx_125, &g_b804810E, edx_120);
			}
			g_b804810E = 0x20;
			byte * esi_136 = ebp_106;
			word32 edx_137 = 0x00;
			do
			{
				esi_136 = esi_232 + 1;
				++edx_137;
				esi_232 = esi_136;
			} while (*esi_232 != 0x00);
			esp_112->tFFFFFFFC = 0x01;
			ebx_100 = esp_112->tFFFFFFFC;
			esp_112->tFFFFFFFC = 0x04;
			sys_write(ebx_100, esi_136 - edx_137, edx_137 - 0x01);
			ecx_113 = esp_112->dw0000;
		}
		ebp_106 += 65;
		--ecx_113;
	} while (ecx_113 != 0x00);
l080480FA:
	size_t * esp_180 = esp_12 - 4;
	*esp_180 = (uint32) 0x01;
	Eq_13 edx_182 = *esp_180;
	*esp_180 = (uint32) 0x04;
	sys_write(ebx_100, &g_b8048052, edx_182);
	*esp_180 = (uint32) 0x01;
	sys_exit(0x00);
}

byte g_b804810E = 0x00; // 0804810E
Eq_65 g_t804810F = // 0804810F
	{
	};

// subject_seg08048000_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

char g_b804804C = '+'; // 0804804C
byte g_b804806B = 0x0A; // 0804806B
char g_b8048071 = '+'; // 08048071
char g_b8048075 = '+'; // 08048075
char g_b8048079 = ' '; // 08048079
char g_b80480A9 = '+'; // 080480A9
char g_b80480B7 = '+'; // 080480B7
char g_b80480C9 = ' '; // 080480C9
char g_b80480D3 = '-'; // 080480D3
char g_b80480E9 = 'H'; // 080480E9
char g_b80480F8 = '.'; // 080480F8
char g_b80480FA = '\n'; // 080480FA
uint32 g_dw80480FB = 0x0A; // 080480FB
char g_b80480FF = ' '; // 080480FF
char g_b8048100 = 'U'; // 08048100
char g_b804811B = '-'; // 0804811B
char g_b804812B = '-'; // 0804812B
char g_b8048142 = '-'; // 08048142
char g_b8048172 = '-'; // 08048172
char g_b804818D = '-'; // 0804818D
char g_b80481A4 = '-'; // 080481A4
char g_b80481CF = 'E'; // 080481CF
char g_b8048203 = 'E'; // 08048203
Eq_159 g_t8048253 = // 08048253;
Eq_206 g_t8048257 = // 08048257;
Eq_141 g_t804825B = // 0804825B;
Eq_367 g_t804825F = // 0804825F;
Eq_404 g_t8048263 = // 08048263;
Eq_233 g_t8048267 = // 08048267;
Eq_337 g_t804826B = // 0804826B;
// 08048279: void fn08048279(Register Eq_2 eax)
// Called from:
//      fn080482EE
//      fn080484BF
void fn08048279(Eq_2 eax)
{
	fn08048292(eax);
	sys_write(g_t805A10D.u0, &g_b80480FA, (byte *) 0x01);
}

// 08048292: void fn08048292(Register Eq_2 eax)
// Called from:
//      fn08048279
//      fn080482EE
//      fn080484BF
void fn08048292(Eq_2 eax)
{
	byte * edi_28 = &g_b805A12F;
	do
	{
		uint64 edx_eax_31 = (uint64) eax;
		Eq_2 eax_35 = (uint32) (edx_eax_31 /u g_dw80480FB);
		*edi_28 = (byte) (edx_eax_31 % g_dw80480FB) + 0x30;
		--edi_28;
		eax = eax_35;
	} while (eax_35 != null);
	sys_write(g_t805A10D.u0, edi_28 + 1, 0x0805A12F - edi_28);
}

// 080482D6: void fn080482D6()
// Called from:
//      fn08048B3F
void fn080482D6()
{
	sys_write(g_t805A10D.u0, &g_b804804C, (byte *) 0x1F);
}

// 080482EE: void fn080482EE()
// Called from:
//      fn08048B3F
void fn080482EE()
{
	byte * esi_11 = g_a8049EDC;
	byte * edi_55 = g_a8059EDB;
	word32 ecx_10;
	for (ecx_10 = 0x0100; ecx_10 != 0x00; --ecx_10)
	{
		byte al_13 = *esi_11;
		++esi_11;
		if (al_13 == 0x20)
		{
			g_t805A0F9.u1 = (uint32) (esi_11 - 0x08049EDD);
			byte * edi_22 = g_a8059EE5;
			word32 ecx_49;
			esi_28 = esi_11;
			for (ecx_49 = 0x0100; ecx_49 != 0x00; --ecx_49)
			{
				byte * esi_28;
				byte al_30 = *esi_28;
				++esi_28;
				if (al_30 == 0x20)
				{
l08048344:
					g_ptr805A109 = esi_28 - esi_11 - 0x01;
					break;
				}
				if (al_30 == 0x0A)
				{
					--esi_28;
					goto l08048344;
				}
				*edi_22 = al_30;
				++edi_22;
			}
			goto l0804834D;
		}
		if (al_13 == 0x0A)
			break;
		*edi_55 = al_13;
		++edi_55;
	}
	g_t805A0F9.u1 = (uint32) (esi_11 - 0x08049EDE);
l0804834D:
	if (g_t805A0F9.u0 >= 0x04)
	{
		if (g_b805A0ED != 0x01)
		{
			Eq_65 ecx_75 = g_t805A0F9.u1;
			memcmp(&g_t8048253, g_a8059EDB, ecx_75);
			if (ecx_75 == __find_first_difference__(&g_t8048253, g_a8059EDB))
			{
				g_b805A0EE = 0x01;
				struct Eq_100 * ecx_856 = g_ptr805A109;
				memcpy(g_a8059EEF, g_a8059EE5, ecx_856);
				ecx_856->b8059EEF = 0x00;
				sys_write(g_t805A10D.u0, &g_b8048071, (byte *) 0x04);
				fn080484BF();
				return;
			}
			if (g_b805A0EE == 0x00)
			{
				sys_write(g_t805A10D.u0, &g_b804811B, (byte *) 0x10);
				fn080484BF();
				return;
			}
			Eq_65 ecx_92 = g_t805A0F9.u1;
			memcmp(&g_t8048257, g_a8059EDB, ecx_92);
			if (ecx_92 == __find_first_difference__(&g_t8048257, g_a8059EDB))
			{
				struct Eq_100 * ecx_763 = g_ptr805A109;
				memcpy(&g_t8059FEE, g_a8059EE5, ecx_763);
				ecx_763->b8059FEF = 0x00;
				g_b805A0ED = 0x01;
				byte * ebx_771 = &g_b8048ECC;
				struct Eq_265 * ecx_772 = g_ptr8048EC8;
				do
				{
					*ebx_771 = ecx_772->b0000;
					++ebx_771;
					++ecx_772;
				} while (ecx_772->b0000 != 0x00);
				byte * ecx_782 = g_a8059EEF;
				while (true)
				{
					*ebx_771 = *ecx_782;
					if (*ebx_771 == 0x00)
						break;
					++ebx_771;
					++ecx_782;
				}
				g_b8048CC6 = 0x01;
				g_b8048CC7 = 0x00;
				fn080484BF();
				sys_write(g_t805A10D.u0, &g_b80480B7, (byte *) 0x12);
				fn08048292(g_t805A130);
				g_b8048CC6 = 0x00;
				sys_write(g_t805A10D.u0, &g_b80480C9, (byte *) 0x0A);
				return;
			}
		}
		Eq_65 ecx_103 = g_t805A0F9.u1;
		memcmp(&g_t804825B, g_a8059EDB, ecx_103);
		if (ecx_103 != __find_first_difference__(&g_t804825B, g_a8059EDB))
		{
			Eq_65 ecx_116 = g_t805A0F9.u1;
			memcmp(&g_t8048267, g_a8059EDB, ecx_116);
			if (ecx_116 != __find_first_difference__(&g_t8048267, g_a8059EDB))
			{
				Eq_65 ecx_129 = g_t805A0F9.u1;
				memcmp(&g_t804826B, g_a8059EDB, ecx_129);
				if (ecx_129 != __find_first_difference__(&g_t804826B, g_a8059EDB))
				{
					Eq_65 ecx_142 = g_t805A0F9.u1;
					memcmp(&g_t804825F, g_a8059EDB, ecx_142);
					if (ecx_142 != __find_first_difference__(&g_t804825F, g_a8059EDB))
					{
						Eq_65 ecx_155 = g_t805A0F9.u1;
						memcmp(&g_t8048263, g_a8059EDB, ecx_155);
						if (ecx_155 != __find_first_difference__(&g_t8048263, g_a8059EDB))
						{
							sys_write(g_t805A10D.u0, &g_b80480D3, (byte *) 22);
							return;
						}
						g_b8048CC8 = 0x01;
					}
					if (g_ptr805A109 > null)
					{
						if (g_ptr805A109 >= (struct Eq_100 *) 0x0A)
							sys_write(g_t805A10D.u0, &g_b80480E9, (byte *) 0x0F);
						int32 edx_195 = 0x01;
						Eq_2 ecx_196 = null;
						byte * edi_199 = (char *) g_ptr805A109 + 0x08059EE5;
						do
						{
							--edi_199;
							Eq_471 eax_207 = (uint32) *edi_199;
							if (eax_207 > 0x39 || eax_207 < 0x30)
							{
								sys_write(g_t805A10D.u0, &g_b80481A4, (byte *) 0x2B);
								return;
							}
							ecx_196 = (Eq_2) (ecx_196 + (eax_207 - 0x30) *s edx_195);
							edx_195 *= 0x0A;
						} while (edi_199 != g_a8059EE5);
						g_t805A134 = ecx_196;
						g_dw805A138 = 0x00;
						g_dw805A13C = 0x00;
						g_b8048CC6 = 0x01;
						fn080484BF();
						Eq_2 eax_246 = g_t805A130;
						if (g_t805A134 < (byte *) 0x01 || g_t805A134 >= eax_246 + 1)
							sys_write(g_t805A10D.u0, &g_b8048172, (byte *) 0x1B);
						else
						{
							fn08048279(g_t805A134);
							Eq_524 eax_272 = sys_open(&g_b8048ECC, 0x00, 0x00);
							g_t805A105.u0 = (int32) eax_272;
							if (eax_272 >= 0x00)
							{
								g_t805A130 = (byte *) 0x01;
								g_dw805A144 = 0x00;
								g_dw8048CC9 = 0x00;
								g_dw805A138 = 0x00;
								g_dw805A13C = 0x00;
								g_dw805A144 = 0x00;
								byte * edi_279 = &g_b804806B;
								while (true)
								{
									int32 eax_327 = sys_read(g_t805A105.u0, g_a8049EDC, (byte *) 0xFFFF);
									g_dw805A158 = eax_327;
									if (eax_327 == 0x00)
										break;
									byte * ecx_370 = g_a8049EDC;
									byte * ebx_371 = g_a8049EDC;
									byte * edx_372 = g_dw805A158 + 134520540;
									ptr32 ebp_373 = 0x00;
									if (g_t805A134 == (byte *) 0x01)
									{
										g_dw805A138 = 0x01;
										g_t805A134 = (Eq_2) (g_t805A134 + 1);
									}
									do
									{
										if (*ecx_370 == *edi_279)
										{
											++edi_279;
											if (edi_279 != &g_b8048071)
												goto l08048900;
											g_t805A130 = (Eq_2) (g_t805A130 + 1);
											if (g_t805A130 == g_t805A134)
											{
												ptr32 ebp_396 = ecx_370 - 0x06;
												g_dw805A144 += ebp_396 - 134520540;
												ebp_373 = ebp_396 - 134520540;
												if (g_dw805A138 != 0x00)
												{
													g_dw805A138 += 0x03;
													g_dw805A13C = g_dw805A144;
													g_dw805A13C += 0x02;
													goto l0804892D;
												}
												g_dw805A138 = g_dw805A144;
												g_t805A134 = (Eq_2) (g_t805A134 + 1);
											}
											g_dw805A144 -= ebp_373;
										}
										edi_279 = &g_b804806B;
										ecx_370 = ebx_371;
										++ebx_371;
l08048900:
										++ecx_370;
									} while (ecx_370 != edx_372);
									g_dw805A144 += g_dw805A158;
								}
								g_dw805A13C = g_dw805A144;
								g_dw805A138 += 0x03;
l0804892D:
								if (g_dw805A138 == 0x04)
									g_dw805A138 = 0x00;
								if (g_dw805A138 == 0x04)
									g_dw805A138 = 0x00;
								g_t805A140 = g_dw805A13C - g_dw805A138;
								if (g_b8048CC8 != 0x01)
								{
									sys_write(g_t805A10D.u0, &g_b8048075, (byte *) 0x04);
									fn08048292(g_t805A140);
									sys_write(g_t805A10D.u0, &g_b8048079, (byte *) 0x08);
									sys_lseek(g_t805A105.u0, SEQ(g_dw805A138, 0x00), 0x08048071);
									g_t805A101 = null;
									do
									{
										Eq_2 edx_467;
										if (g_t805A140 <= (byte *) 0xFFFF)
											edx_467 = g_t805A140;
										else
											edx_467 = (byte *) 0xFFFF;
										Eq_2 eax_479 = sys_read(g_t805A105.u0, g_a8049EDC, edx_467);
										g_t805A0FD = eax_479;
										Mem482[0x0805A101<p32>:word32] = Mem480[0x0805A101<p32>:word32] + eax_479;
										sys_write(g_t805A10D.u0, g_a8049EDC, g_t805A0FD);
									} while (g_t805A101 != g_t805A140);
									sys_close(g_t805A105.u0);
									sys_write(g_t805A10D.u0, &g_b80480F8, (byte *) 0x02);
								}
								else
								{
									sys_write(g_t805A10D.u0, &g_b8048071, (byte *) 0x04);
									sys_close(g_t805A105.u0);
									g_t805A105.u0 = (int32) sys_open(&g_b8048ECC, 0x02, 0x04);
									while (true)
									{
										sys_lseek(g_t805A105.u0, SEQ(g_dw805A13C, 0x00), 0x08048071);
										Eq_2 eax_590 = sys_read(g_t805A105.u0, g_a8049EDC, (byte *) 0xFFFF);
										if (eax_590 == null)
											break;
										g_t805A160 = eax_590;
										sys_lseek(g_t805A105.u0, SEQ(g_dw805A138, 0x00), 0x08048071);
										sys_write(g_t805A105.u0, g_a8049EDC, g_t805A160);
										Eq_2 eax_640 = g_t805A160;
										g_dw805A13C = eax_640 + g_dw805A13C;
										g_dw805A138 = eax_640 + g_dw805A138;
									}
									sys_ftruncate(g_t805A105.u0, g_dw805A138);
									sys_close(g_t805A105.u0);
									g_b8048CC8 = 0x00;
								}
							}
							else
								sys_write(g_t805A10D.u0, &g_b804812B, (byte *) 0x17);
						}
					}
					else
						sys_write(g_t805A10D.u0, &g_b804818D, (byte *) 0x17);
				}
				else
				{
					sys_write(g_t805A10D.u0, &g_b80480A9, (byte *) 0x0E);
					sys_close(g_t805A10D.u0);
					sys_exit(0x00);
				}
			}
			else
			{
				g_b8048CC7 = 0x01;
				fn080484BF();
			}
		}
		else
			fn080484BF();
	}
	else
	{
		sys_write(g_t805A10D.u0, &g_b8048142, (byte *) 0x30);
		fn080484BF();
	}
}

// 080484BF: void fn080484BF()
// Called from:
//      fn080482EE
void fn080484BF()
{
	Eq_524 eax_11 = sys_open(&g_b8048ECC, 0x00, 0x00);
	g_t805A105.u0 = (int32) eax_11;
	if (eax_11 >= 0x00)
	{
		g_t805A130 = null;
		g_t805A148 = null;
		byte * edi_164 = &g_b804806B;
		while (true)
		{
			Eq_2 eax_60 = sys_read(g_t805A105.u0, g_a8049EDC, (byte *) 0xFFFF);
			g_t805A160 = eax_60;
			if (eax_60 == null)
				break;
			byte * ecx_180 = g_a8049EDC;
			byte * ebx_181 = g_a8049EDC;
			word32 edx_182 = Mem61[0x0805A160<p32>:word32] + 134520540;
			do
			{
				if (*ecx_180 == *edi_164)
				{
					++edi_164;
					if (edi_164 != &g_b8048071)
						goto l0804859C;
					g_t805A130 = (Eq_2) (g_t805A130 + 1);
					if (g_b8048CC7 != 0x00)
					{
						fn08048292(g_t805A130);
						sys_write(g_t805A10D.u0, &g_b80480FF, (byte *) 0x01);
						fn08048279(g_t805A148);
						g_t805A148 = null;
					}
				}
				g_t805A148 = (Eq_2) (g_t805A148 + 1);
				edi_164 = &g_b804806B;
				ecx_180 = ebx_181;
				++ebx_181;
l0804859C:
				++ecx_180;
			} while (ecx_180 != edx_182);
		}
		g_t805A130 = (Eq_2) (g_t805A130 + 1);
		if (g_b8048CC7 != 0x00)
		{
			fn08048292(g_t805A130);
			sys_write(g_t805A10D.u0, &g_b80480FF, (byte *) 0x01);
			fn08048279(g_t805A148);
			sys_write(g_t805A10D.u0, &g_b80480F8, (byte *) 0x02);
			g_b8048CC7 = 0x00;
		}
		else
		{
			if (g_b8048CC6 != 0x00)
			{
				g_b8048CC6 = 0x00;
				return;
			}
			sys_write(g_t805A10D.u0, &g_b8048075, (byte *) 0x04);
			fn08048292(g_t805A130);
			sys_write(g_t805A10D.u0, &g_b80480FF, (byte *) 0x01);
			fn08048279(g_t805A148);
		}
		sys_close(g_t805A105.u0);
	}
	else
		sys_write(g_t805A10D.u0, &g_b804812B, (byte *) 0x17);
}

// 08048B3F: void fn08048B3F(Register word24 eax_24_8, Register int32 ebx, Stack word32 dwArg00, Stack uint32 dwArg04, Stack uint32 dwArg08, Stack (ptr32 byte) dwArg0C)
void fn08048B3F(word24 eax_24_8, int32 ebx, word32 dwArg00, uint32 dwArg04, uint32 dwArg08, byte * dwArg0C)
{
	ptr32 fp;
	uint32 dwLoc04;
	Eq_1021 ebx_137;
	struct Eq_1022 * esp_138;
	uint32 * esp_153 = &dwArg04;
	if (dwArg00 == 0x03)
	{
		g_ptr8048EC8 = dwArg08;
		g_b805A0ED = 0x00;
		g_b805A0EE = 0x00;
		byte * esi_13 = dwArg0C;
		int32 ebx_332 = ebx;
		while (true)
		{
			cu8 al_19 = *esi_13;
			++esi_13;
			if (al_19 < 0x30)
				break;
			word32 eax_292 = SEQ(eax_24_8, al_19 - 0x30);
			if (al_19 > 0x39 || al_19 < 0x30)
				break;
			int32 ebx_293 = ebx_332 *s 0x0A + eax_292;
			ebx_332 = SEQ(SLICE(ebx_293, word16, 16), (byte) ebx_293, SLICE(ebx_293, byte, 8));
		}
		g_dw805A111 = SEQ(SLICE(ebx_332 << 0x10, word24, 8), 0x02);
		struct Eq_265 * eax_42 = g_ptr8048EC8;
		do
			++eax_42;
		while (eax_42->b0000 != 0x00);
		if (eax_42->bFFFFFFFF != 0x2F)
		{
			sys_write(0x01, &g_b80481CF, (byte *) 0x34);
			ebx_137.u0 = 0x01;
			esp_138 = fp + 16;
			goto l08048C03;
		}
		dwArg08 = 0x01;
		dwArg04 = 0x02;
		int32 eax_69 = sys_socketcall(0x01, &dwArg04);
		esp_153 = fp + 0x10;
		if (eax_69 >= 0x00)
		{
			dwArg08 = 134515515;
			dwArg04 = 0x02;
			dwLoc04 = (uint32) eax_69;
			esp_153 = fp + 0x10;
			if (sys_socketcall(0x0E, &dwLoc04) != 0x00)
				goto l08048BD7;
			dwArg08 = 0x0805A111;
			dwArg04 = (uint32) eax_69;
			if (sys_socketcall(0x02, &dwArg04) != 0x00)
			{
				sys_write(0x01, &g_b8048203, (byte *) 0x50);
				ebx_137.u0 = 0x01;
				esp_138 = fp + 0x10;
				goto l08048C03;
			}
			dwArg08 = (uint32) eax_69;
			dwArg04 = 0x04;
			int32 ebx_146 = dwArg04;
			dwArg04 = 0x66;
			esp_153 = fp + 0x10;
			if (sys_socketcall(ebx_146, &dwArg08) == 0x00)
			{
				esp_138 = fp + 0x10;
				if (sys_fork() == 0x00)
				{
					while (true)
					{
						do
						{
							g_dw8048DC9 = 0x10;
							dwArg08 = 0x08048CCA;
							dwArg04 = (uint32) eax_69;
							Eq_9 eax_187 = sys_socketcall(0x05, &dwArg04);
						} while (eax_187 < 0x00);
						sys_wait4(~0x00, null, 0x01, null);
						sys_wait4(~0x00, null, 0x01, null);
						struct Eq_1292 * esp_214 = fp + 0x10;
						if (sys_fork() == 0x00)
							break;
						sys_close(eax_187);
					}
					g_t805A10D.u0 = (int32) eax_187;
					fn080482D6();
					while (true)
					{
						Eq_9 ebx_225 = g_t805A10D.u0;
						esp_214->dwFFFFFFFC = 0x03;
						sys_read(ebx_225, g_a8049EDC, (byte *) 0x0FFF);
						fn080482EE();
						esp_214 = (struct Eq_1292 *) <invalid>;
					}
				}
				ebx_137.u0 = 0x00;
l08048C03:
				esp_138->dwFFFFFFFC = 0x01;
				sys_exit(ebx_137);
			}
		}
	}
l08048BD7:
	union Eq_1021 * esp_258 = esp_153 - 4;
	esp_258->u0 = 0x01;
	Eq_1021 ebx_260 = esp_258->u0;
	esp_258->u0 = 0x04;
	sys_write(ebx_260, &g_b8048100, (byte *) 0x1B);
	esp_258->u0 = 0x01;
	ebx_137.u0 = esp_258->u0;
	esp_138 = (struct Eq_1022 *) ((char *) esp_258 + 4);
	goto l08048C03;
}

byte g_b8048CC6 = 0x00; // 08048CC6
byte g_b8048CC7 = 0x00; // 08048CC7
byte g_b8048CC8 = 0x00; // 08048CC8
word32 g_dw8048CC9 = 0x00; // 08048CC9
word32 g_dw8048DC9 = 0x00; // 08048DC9
struct Eq_265 * g_ptr8048EC8 = null; // 08048EC8
byte g_b8048ECC = 0x00; // 08048ECC
byte g_a8049EDC[] = // 08049EDC
	{
	};
// subject_seg08048000_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

byte g_a8059EDB[] = // 08059EDB
	{
	};
byte g_a8059EE5[] = // 08059EE5
	{
	};
byte g_a8059EEF[] = // 08059EEF
	{
	};
Eq_251 g_t8059FEE = // 08059FEE;
byte g_b805A0ED = 0x00; // 0805A0ED
byte g_b805A0EE = 0x00; // 0805A0EE
Eq_65 g_t805A0F9 = // 0805A0F9
	{
		0x00
	};
Eq_2 g_t805A0FD = null; // 0805A0FD
Eq_2 g_t805A101 = null; // 0805A101
Eq_524 g_t805A105 = // 0805A105
	{
		0
	};
struct Eq_100 * g_ptr805A109 = null; // 0805A109
Eq_9 g_t805A10D = // 0805A10D
	{
		0
	};
word32 g_dw805A111 = 0x00; // 0805A111
byte g_b805A12F = 0x00; // 0805A12F
Eq_2 g_t805A130 = null; // 0805A130
Eq_2 g_t805A134 = null; // 0805A134
uint32 g_dw805A138 = 0x00; // 0805A138
uint32 g_dw805A13C = 0x00; // 0805A13C
Eq_2 g_t805A140 = null; // 0805A140
uint32 g_dw805A144 = 0x00; // 0805A144
Eq_2 g_t805A148 = null; // 0805A148
int32 g_dw805A158 = 0; // 0805A158
Eq_2 g_t805A160 = null; // 0805A160

// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C(Register word24 eax_24_8, Stack up32 dwArg00, Stack (ptr32 Eq_4) dwArg04, Stack (ptr32 char) dwArg08, Stack (ptr32 char) dwArg0C, Stack (ptr32 char) dwArg10)
void fn0804804C(word24 eax_24_8, up32 dwArg00, struct Eq_4 * dwArg04, char * dwArg08, char * dwArg0C, char * dwArg10)
{
	ptr32 fp;
	struct Eq_4 * esi_12 = dwArg04;
	struct Eq_10 * esp_44 = fp + 8;
	do
	{
		byte al_11 = esi_12->b0000;
		++esi_12;
		int32 eax_45 = SEQ(eax_24_8, al_11);
	} while (al_11 != 0x00);
	if (dwArg00 >= 0x03)
	{
		ptr32 esp_35;
		char * edi_29;
		char * ebp_24 = dwArg0C;
		if (esi_12->bFFFFFFFC != 115)
		{
			if (*dwArg08 != 0x732D)
			{
				esp_44 = fp + 16;
				eax_45 = sys_link(dwArg08, dwArg0C);
				goto l08048071;
			}
			edi_29 = dwArg10;
			esp_35 = fp + 20;
		}
		else
		{
			sys_unlink(dwArg0C);
			edi_29 = dwArg0C;
			ebp_24 = dwArg08;
			esp_35 = fp + 16;
		}
		word32 * esp_53 = esp_35 - 4;
		*esp_53 = 0x53;
		esp_44 = (struct Eq_10 *) (esp_53 + 1);
		eax_45 = sys_symlink(ebp_24, edi_29);
	}
l08048071:
	esp_44->dwFFFFFFFC = 0x01;
	sys_exit(eax_45);
}


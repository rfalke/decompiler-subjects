// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C(Stack (ptr32 byte) dwArg08)
void fn0804804C(byte * dwArg08)
{
	struct Eq_3 * fp;
	struct Eq_3 * esp_11 = fp;
	int32 eax_15 = sys_readlink(&g_b80480D2, &g_b80480E1, 0x0100);
	if (eax_15 >= 0x00)
	{
		sys_stat(&g_b80480E1, &g_t80481E1);
		eax_15 = g_dw80481E9;
		esp_11 = &fp->dwFFFFFFFC + 4;
		if (dwArg08 == null)
		{
			char * ecx_61;
			if ((eax_15 & 0x10) == 0x10)
				ecx_61 = &g_b80480C8;
			else
				ecx_61 = &g_b80480CD;
			esp_11 = &fp->dwFFFFFFFC + 4;
			eax_15 = sys_write(0x01, ecx_61, 0x05);
		}
		else
		{
			Eq_38 eax_39;
			if (*dwArg08 != 110)
			{
				if (*dwArg08 != 121)
					goto l0804809E;
				eax_39 = eax_15 | 0x10;
			}
			else
				eax_39 = (eax_15 | 0x10) ^ 0x10;
			esp_11 = &fp->dwFFFFFFFC + 4;
			eax_15 = sys_chmod(&g_b80480E1, eax_39);
		}
	}
l0804809E:
	esp_11->dwFFFFFFFC = 0x01;
	sys_exit(eax_15);
}

char g_b80480C8 = 'i'; // 080480C8
char g_b80480CD = 'i'; // 080480CD
char g_b80480D2 = '/'; // 080480D2
char g_b80480E1 = '\0'; // 080480E1
Eq_28 g_t80481E1 = // 080481E1
	{
	};
int32 g_dw80481E9 = 0; // 080481E9

//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>

// ------------------- Function Prototypes --------------------

int32_t entry_point(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_804831c(void);
int32_t function_8048340(void);
int32_t function_8048368(void);
int32_t function_8048374(void);
int32_t function_8048388(void);

// --------------------- Global Variables ---------------------

int32_t g1 = 0; // 0x8048548
char * g2; // 0x804854c
int32_t g3 = 0; // 0x8048550
int32_t g4 = 0; // 0x8048554
int32_t g5 = 0; // 0x8048558
int32_t g6 = 0; // 0x804855c
int16_t * g7 = NULL; // 0x8048560
int16_t * g8 = NULL; // 0x804a560
int32_t g9 = 0; // 0x804a562
int32_t g10 = 0; // 0x804a564
char * g11; // 0x804d9c4
int32_t g12 = 0; // 0x804d9c8
int16_t * g13 = NULL; // 0x804d9c9
int32_t g14 = 0; // 0x804d9ca
int32_t g15 = 0; // 0x804d9cd
char * g16; // 0x804d9d1

// ------------------------ Functions -------------------------

// Address range: 0x804804c - 0x804843b
// Used cryptographic patterns:
//  - B64EncodeTable (8-bit)
//  - UUEncodeTable (8-bit)
int32_t entry_point(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    int32_t v1 = a4;
    int32_t v2 = a3;
    *(int32_t *)&g11 = 0x69676562;
    *(char *)&g12 = 110;
    int32_t v3 = &v2; // 0x8048063
    int32_t * v4; // 0x804804c
    if (a1 < 2) {
        goto lab_0x8048393;
    } else {
        // 0x8048069
        int32_t v5; // 0x804804c
        int32_t v6; // 0x804804c
        int32_t * v7; // 0x804804c
        if (*(int16_t *)a3 != 0x6d2d) {
            // 0x8048093
            g2 = "`!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_";
            *(int16_t *)&g13 = 32;
            v5 = a1 - 1;
            v7 = &v1;
            v6 = &g14;
        } else {
            // 0x8048072
            g2 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
            *(int32_t *)&g13 = 0x7361622d;
            g15 = 0x20343665;
            *(char *)&g16 = 0;
            v5 = a1 - 2;
            int32_t v8; // bp+16, 0x804804c
            v7 = &v8;
            v6 = (int32_t)&g16;
        }
        int32_t v9 = (int32_t)v7;
        v3 = v9;
        if (v5 < 3) {
            if (v5 == 2) {
                // 0x80480ae
                *v7 = 2;
                int32_t * v10 = (int32_t *)(v9 - 4);
                *v10 = 106;
                __asm_int(128);
                g1 = -106;
                function_8048388();
                function_8048374();
                function_8048368();
                *v10 = 4;
                __asm_int(128);
                v4 = v10;
                goto lab_0x8048306;
            } else {
                // 0x80480f8
                v3 = v9;
                if (v5 != 1) {
                    goto lab_0x8048393;
                } else {
                    // 0x8048101
                    *(int32_t *)v6 = 0x20343436;
                    *(char *)(v6 + 4) = 0;
                    function_8048374();
                    g6 = 0;
                    function_8048368();
                    int32_t v11; // 0x804804c
                    *(char *)(v11 + (int32_t)&g11) = 10;
                    int32_t * v12 = (int32_t *)(v9 - 4);
                    *v12 = 4;
                    __asm_int(128);
                    bool v13; // 0x804804c
                    int32_t v14 = v13 ? (int32_t)&g8 - 1 : (int32_t)&g8 + 1;
                    int32_t v15 = v13 ? -1 : 1;
                    g3 = 0x1ffe;
                    *v12 = 3;
                    __asm_int(128);
                    g4 = 3;
                    int32_t v16 = g3 - 3; // 0x804817b
                    g3 = v16;
                    while (v16 != 0) {
                        // 0x8048154
                        *v12 = 3;
                        __asm_int(128);
                        g4 = 3;
                        v16 = g3 - 3;
                        g3 = v16;
                    }
                    // 0x80481a4
                    g5 = 0;
                    int32_t v17 = (int32_t)&g8; // 0x80481ba
                    if (g2 != (char *)0x804847b) {
                        // 0x80481bc
                        *(char *)&g8 = 77;
                        v17 = v14;
                    }
                    int32_t v18 = (int32_t)g2; // 0x80481ae
                    int32_t v19 = (int32_t)&g7; // 0x804804c
                    int32_t v20 = 0x1ffe; // 0x804820c
                    uint32_t v21 = llvm_bswap_i32(*(int32_t *)v19); // 0x80481dc
                    *(char *)v17 = *(char *)(v21 / 0x4000000 + v18);
                    int32_t v22 = v17 + v15; // 0x80481ed
                    *(char *)v22 = *(char *)(v21 / 0x100000 % 64 + v18);
                    int32_t v23 = v22 + v15; // 0x80481f9
                    *(char *)v23 = *(char *)(v21 / 0x4000 % 64 + v18);
                    int32_t v24 = v23 + v15; // 0x8048205
                    *(char *)v24 = *(char *)(v21 / 256 % 64 + v18);
                    int32_t v25 = v24 + v15; // 0x804820b
                    v20 -= 3;
                    int32_t v26 = g5 + 3; // 0x804820f
                    g5 = v26;
                    int32_t v27 = v25; // 0x80481cb
                    v19 += (v13 ? -5 : 3);
                    while (v20 >= 3) {
                        // 0x80481cd
                        if (v26 >= 45) {
                            // 0x80481d6
                            function_804831c();
                        }
                        // 0x80481db
                        v21 = llvm_bswap_i32(*(int32_t *)v19);
                        *(char *)v27 = *(char *)(v21 / 0x4000000 + v18);
                        v22 = v27 + v15;
                        *(char *)v22 = *(char *)(v21 / 0x100000 % 64 + v18);
                        v23 = v22 + v15;
                        *(char *)v23 = *(char *)(v21 / 0x4000 % 64 + v18);
                        v24 = v23 + v15;
                        *(char *)v24 = *(char *)(v21 / 256 % 64 + v18);
                        v25 = v24 + v15;
                        v20 -= 3;
                        v26 = g5 + 3;
                        g5 = v26;
                        v27 = v25;
                        v19 += (v13 ? -5 : 3);
                    }
                    while (v25 != (int32_t)&g8) {
                        // 0x804829c
                        *(char *)v25 = 10;
                        *v12 = 4;
                        __asm_int(128);
                        if (g4 == 0) {
                            // break -> 0x80482c0
                            break;
                        }
                        g3 = 0x1ffe;
                        *v12 = 3;
                        __asm_int(128);
                        g4 = 3;
                        v16 = g3 - 3;
                        g3 = v16;
                        while (v16 != 0) {
                            // 0x8048154
                            *v12 = 3;
                            __asm_int(128);
                            g4 = 3;
                            v16 = g3 - 3;
                            g3 = v16;
                        }
                        // 0x80481a4
                        g5 = 0;
                        v17 = (int32_t)&g8;
                        if (g2 != (char *)0x804847b) {
                            // 0x80481bc
                            *(char *)&g8 = 77;
                            v17 = v14;
                        }
                        // 0x80481c8
                        v18 = (int32_t)g2;
                        v19 = (int32_t)&g7;
                        v20 = 0x1ffe;
                        // 0x80481db
                        v21 = llvm_bswap_i32(*(int32_t *)v19);
                        *(char *)v17 = *(char *)(v21 / 0x4000000 + v18);
                        v22 = v17 + v15;
                        *(char *)v22 = *(char *)(v21 / 0x100000 % 64 + v18);
                        v23 = v22 + v15;
                        *(char *)v23 = *(char *)(v21 / 0x4000 % 64 + v18);
                        v24 = v23 + v15;
                        *(char *)v24 = *(char *)(v21 / 256 % 64 + v18);
                        v25 = v24 + v15;
                        v20 -= 3;
                        v26 = g5 + 3;
                        g5 = v26;
                        v27 = v25;
                        v19 += (v13 ? -5 : 3);
                        while (v20 >= 3) {
                            // 0x80481cd
                            if (v26 >= 45) {
                                // 0x80481d6
                                function_804831c();
                            }
                            // 0x80481db
                            v21 = llvm_bswap_i32(*(int32_t *)v19);
                            *(char *)v27 = *(char *)(v21 / 0x4000000 + v18);
                            v22 = v27 + v15;
                            *(char *)v22 = *(char *)(v21 / 0x100000 % 64 + v18);
                            v23 = v22 + v15;
                            *(char *)v23 = *(char *)(v21 / 0x4000 % 64 + v18);
                            v24 = v23 + v15;
                            *(char *)v24 = *(char *)(v21 / 256 % 64 + v18);
                            v25 = v24 + v15;
                            v20 -= 3;
                            v26 = g5 + 3;
                            g5 = v26;
                            v27 = v25;
                            v19 += (v13 ? -5 : 3);
                        }
                    }
                    // 0x80482c0
                    if (g2 != (char *)0x804843b) {
                        // 0x80482ef
                        *(int32_t *)&g8 = 0x3d3d3d3d;
                        *(char *)&g10 = 10;
                        *v12 = 4;
                        __asm_int(128);
                        v4 = v12;
                    } else {
                        // 0x80482d1
                        *(int16_t *)&g8 = 2656;
                        g9 = 0xa646e65;
                        *v12 = 4;
                        __asm_int(128);
                        v4 = v12;
                    }
                    goto lab_0x8048306;
                }
            }
        } else {
            goto lab_0x8048393;
        }
    }
  lab_0x8048393:;
    int32_t * v28 = (int32_t *)(v3 - 4);
    *v28 = 4;
    __asm_int(128);
    v4 = v28;
    goto lab_0x8048306;
  lab_0x8048306:
    // 0x8048306
    *v4 = 6;
    __asm_int(128);
    *v4 = 1;
    __asm_int(128);
    return 1;
}

// Address range: 0x804831c - 0x8048340
// Used cryptographic patterns:
//  - B64EncodeTable (8-bit)
int32_t function_804831c(void) {
    // 0x804831c
    int32_t v1; // 0x804831c
    uint32_t v2 = v1;
    int32_t v3 = v1 & -256; // 0x804831c
    *(char *)v1 = 10;
    int32_t result = v3 | 10; // 0x8048325
    if (v1 != (int32_t)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/") {
        uint32_t v4 = (v3 | (v2 < 45 ? v2 % 256 : 45)) + 32; // 0x8048332
        bool v5; // 0x804831c
        *(char *)((v5 ? -1 : 1) + v1) = (char)v4;
        result = v4 % 256 | v3;
    }
    // 0x8048335
    g5 = 0;
    return result;
}

// Address range: 0x8048340 - 0x8048368
int32_t function_8048340(void) {
    // 0x8048340
    int32_t v1; // 0x8048340
    uint32_t result = v1;
    int32_t v2 = llvm_bswap_i32(256 * (32 * result & 1792 | result % 8 | 1024 * result & 0x70000) | 0x30303000); // 0x8048362
    *(int32_t *)v1 = v2;
    return result;
}

// Address range: 0x8048368 - 0x8048374
int32_t function_8048368(void) {
    // 0x8048368
    int32_t result; // 0x8048368
    int32_t v1 = result - 1; // 0x804836a
    while (*(char *)(v1 + 1) != 0) {
        // 0x804836b
        v1++;
    }
    // 0x8048371
    return result;
}

// Address range: 0x8048374 - 0x8048388
int32_t function_8048374(void) {
    // 0x8048374
    function_8048368();
    bool v1; // 0x8048374
    int32_t v2 = v1 ? -1 : 1; // 0x8048380
    int32_t result; // 0x8048374
    int32_t v3 = 2 * result; // 0x804837e
    int32_t v4; // 0x8048374
    char v5 = *(char *)v4; // 0x8048380
    *(char *)v3 = v5;
    v4 += v2;
    v3 += v2;
    while (v5 != 0) {
        // 0x8048380
        v5 = *(char *)v4;
        *(char *)v3 = v5;
        v4 += v2;
        v3 += v2;
    }
    // 0x8048386
    return result;
}

// Address range: 0x8048388 - 0x8048393
int32_t function_8048388(void) {
    // 0x8048388
    bool v1; // 0x8048388
    int32_t v2 = v1 ? -1 : 1; // 0x804838a
    int32_t v3; // 0x8048388
    unsigned char v4 = *(char *)v3; // 0x804838a
    int32_t v5; // 0x8048388
    int32_t result = v5 & -256 | (int32_t)v4; // 0x804838a
    int32_t v6; // 0x8048388
    *(char *)v6 = v4;
    v3 += v2;
    v6 += v2;
    while (v4 != 0) {
        // 0x804838a
        v4 = *(char *)v3;
        result = result & -256 | (int32_t)v4;
        *(char *)v6 = v4;
        v3 += v2;
        v6 += v2;
    }
    // 0x8048390
    return result;
}

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (4.7.0)
// Detected functions: 6


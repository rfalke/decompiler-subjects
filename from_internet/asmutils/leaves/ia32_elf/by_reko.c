// subject_seg08048000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804804C: void fn0804804C(Register byte al, Register Eq_3 ebx, Register (ptr32 byte) esi, Stack Eq_5 dwArg04)
// Called from:
//      fn0804805C
void fn0804804C(byte al, Eq_3 ebx, byte * esi, Eq_5 dwArg04)
{
	Mem14[ebx * 0x0280 + dwArg04 + esi:byte] = al;
	fn0804805B();
}

// 0804805B: void fn0804805B()
// Called from:
//      fn0804804C
//      fn0804805C
void fn0804805B()
{
}

// 0804805C: Register word32 fn0804805C(Register (ptr32 Eq_15) ebp, Register (ptr32 byte) esi, Register (ptr32 byte) edi, Stack real32 rArg04, Stack real32 rArg08, Stack byte bArg0C, Register out Eq_3 ebxOut)
// Called from:
//      fn0804805C
//      fn08048117
word32 fn0804805C(struct Eq_15 * ebp, byte * esi, byte * edi, real32 rArg04, real32 rArg08, byte bArg0C, union Eq_3 & ebxOut)
{
	word32 dwArg0C;
	Eq_3 ebx;
	if ((byte) dwArg0C == 0x00)
	{
		fn0804805B();
		ebxOut = ebx;
		return <invalid>;
	}
	else
	{
		real64 rLoc1_160 = (real64) ebp->r0010;
		Eq_3 dwLoc0C_168 = (int32) (rLoc1_160 * (real64) rArg04 + (real64) ebp->r0018);
		byte al_37 = *edi;
		fn0804804C(al_37, dwLoc0C_168, esi, (int32) ((real64) ebp->r0014 - rLoc1_160 * (real64) rArg08));
		fn0804804C(al_37, dwLoc0C_168, esi, (int32) (rLoc1_160 * (real64) rArg08 + (real64) ebp->r001C));
		byte * edi_51 = edi + 1;
		if (edi >= &g_b8048181)
			edi_51 = edi - 0x07;
		real64 rLoc1_176 = (real64) ebp->r0004;
		real64 rLoc2_177 = (real64) ebp->r0000;
		word32 ebx_260;
		word32 ecx_100 = fn0804805C(ebp, esi, edi_51, (real32) (rLoc2_177 * (real64) rArg04 + rLoc1_176 * (real64) rArg08), (real32) (rLoc1_176 * (real64) rArg04 - rLoc2_177 * (real64) rArg08), (byte) dwArg0C - 0x01, out ebx_260);
		real64 rLoc4_201 = (real64) ebp->r0020;
		real64 rLoc1_198 = (real64) ebp->r000C;
		real64 rLoc2_202 = (real64) rArg04 - rLoc4_201;
		real64 rLoc3_200 = (real64) ebp->r0008;
		word32 ebx_261;
		fn0804805C(ebp, esi, edi_51, (real32) (rLoc4_201 + (rLoc2_202 * rLoc3_200 - rLoc1_198 * (real64) rArg08)), (real32) (rLoc1_198 * rLoc2_202 + rLoc3_200 * (real64) rArg08), (byte) ecx_100, out ebx_261);
		ebxOut = dwLoc0C_168;
		return <invalid>;
	}
}

// 08048117: void fn08048117(Register Eq_141 edx)
void fn08048117(Eq_141 edx)
{
	sys_open("/dev/fb", 0x02, edx);
	byte * eax_34 = sys_mmap();
	word32 ecx_16;
	byte * edi_36 = eax_34;
	for (ecx_16 = 0x0004B000; ecx_16 != 0x00; --ecx_16)
	{
		*edi_36 = 0x00;
		++edi_36;
	}
	int32 ebx_56;
	fn0804805C(&g_t8048156, eax_34, &g_b804817A, 0x00, 0x00, 0x1C, out ebx_56);
	sys_exit(ebx_56);
}

Eq_15 g_t8048156 = // 08048156
	{
		0.7F,
		0.2F,
		0.5F,
		0.3F,
		-3.0F,
		187.0F,
		440.0F,
		453.0F,
		112.0F,
	};
byte g_b804817A = 0x00; // 0804817A
byte g_b8048181 = 0x02; // 08048181
char g_str8048182[] = "/dev/fb"; // 08048182

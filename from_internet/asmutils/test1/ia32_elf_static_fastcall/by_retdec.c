//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdint.h>

// ------------------- Function Prototypes --------------------

int32_t __get_GOT(int32_t a1);
int32_t __system_call(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6);
int32_t _fastcall(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6);
int32_t close(void);
int32_t lseek(void);
int32_t open(int32_t a1, int32_t a2);
int32_t read(void);
int32_t strlen(int32_t a1);
int32_t unlink(void);
int32_t write(void);

// --------------------- Global Variables ---------------------

int32_t fd = 0; // 0x804c084
char (*fname)[6] = "_tst_"; // 0x804c00c
int32_t len = 0; // 0x804c088
int32_t g1;

// ------------------------ Functions -------------------------

// From module:   /home/hawk/mess/2022/04/asmutils/lib/test1.c
// Address range: 0x8049000 - 0x8049122
// Line range:    22 - 45
int main() {
    // 0x8049000
    int32_t v1; // 0x8049000
    int32_t v2; // 0x8049000
    _fastcall(v2, v2, v2, &v1, v2, argc);
    len = strlen((int32_t)&g1);
    fd = open((int32_t)fname, 66);
    write();
    close();
    fd = open((int32_t)fname, 0);
    lseek();
    len = read();
    close();
    unlink();
    write();
    len = read();
    write();
    return len;
}

// Address range: 0x804917f - 0x8049183
int32_t __get_GOT(int32_t a1) {
    // 0x804917f
    int32_t result; // 0x804917f
    return result;
}

// Address range: 0x8049183 - 0x8049207
int32_t __system_call(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6) {
    // 0x8049183
    char * v1; // 0x8049183
    if (*v1 >= 1) {
        // 0x8049193
        int32_t v2; // 0x8049183
        __get_GOT(v2);
    }
    // 0x80491d5
    __asm_int(128);
    return (int32_t)*(char *)((int32_t)v1 + 1);
}

// Address range: 0x8049207 - 0x804920d
int32_t open(int32_t a1, int32_t a2) {
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x8049207
    return result;
}

// Address range: 0x804920e - 0x8049215
int32_t close(void) {
    // 0x804920e
    int32_t v1; // 0x804920e
    int32_t v2 = v1;
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x804920e
    *(int32_t *)v2 = result + v2;
    return result;
}

// Address range: 0x8049215 - 0x804921c
int32_t read(void) {
    int32_t v1 = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x8049215
    int32_t v2; // 0x8049215
    return v1 + v2;
}

// Address range: 0x804921c - 0x8049221
int32_t write(void) {
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x804921c
    return result;
}

// Address range: 0x8049223 - 0x804922a
int32_t lseek(void) {
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x8049223
    return result;
}

// Address range: 0x804924d - 0x8049254
int32_t unlink(void) {
    // 0x804924d
    int32_t v1; // 0x804924d
    int32_t v2 = v1;
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x804924d
    *(int32_t *)v2 = v1 + v2;
    return result;
}

// Address range: 0x80492ea - 0x8049300
int32_t _fastcall(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6) {
    // 0x80492ea
    int32_t v1; // 0x80492ea
    int32_t result = __get_GOT(v1); // 0x80492eb
    *(int32_t *)*(int32_t *)(v1 + 0x2d0c) = result;
    return result;
}

// Address range: 0x80493f1 - 0x804941c
int32_t strlen(int32_t a1) {
    // 0x80493f1
    int32_t v1; // 0x80493f1
    int32_t v2 = __get_GOT(v1); // 0x80493f3
    char v3 = *(char *)*(int32_t *)(v1 + 0x2c04); // 0x8049404
    int32_t result = 0; // 0x8049410
    while (*(char *)(result + (v3 != 0 ? v2 : a1)) != 0) {
        // 0x8049412
        result++;
    }
    // 0x8049419
    return result;
}

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (11.2.1)
// Detected functions: 11


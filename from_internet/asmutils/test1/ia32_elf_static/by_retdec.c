//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdint.h>

// ------------------- Function Prototypes --------------------

int32_t __get_GOT(int32_t a1);
int32_t __system_call(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6);
int32_t _fastcall(int32_t * a1, int32_t a2, int32_t a3);
int32_t close(int32_t a1);
int32_t lseek(int32_t a1, int32_t a2, int32_t a3);
int32_t open(int32_t a1, int32_t a2);
int32_t read(int32_t a1, char * a2, int32_t a3);
int32_t strlen(int32_t a1);
int32_t unlink(int32_t a1);
int32_t write(int32_t a1, int32_t a2, int32_t a3);

// --------------------- Global Variables ---------------------

char buf[100]; // 0x804c020
int32_t fd = 0; // 0x804c084
char (*fname)[6] = "_tst_"; // 0x804c00c
int32_t len = 0; // 0x804c088
char * s = "\b\xa0\x04\b"; // 0x804c010
int32_t g1;

// ------------------------ Functions -------------------------

// From module:   /home/hawk/mess/2022/04/asmutils/lib/test1.c
// Address range: 0x8049000 - 0x8049147
// Line range:    22 - 45
int main() {
    // 0x8049000
    int32_t v1; // 0x8049000
    int32_t v2; // 0x8049000
    _fastcall(&v1, v2, argc);
    len = strlen((int32_t)s);
    int32_t v3 = open((int32_t)fname, 66); // 0x8049041
    fd = v3;
    write(v3, (int32_t)s, len);
    close(fd);
    int32_t v4 = open((int32_t)fname, 0); // 0x804908a
    fd = v4;
    lseek(v4, 0, 0);
    len = read(fd, buf, len);
    close(fd);
    unlink((int32_t)fname);
    write(1, (int32_t)&buf, len);
    int32_t v5 = read(0, buf, 10); // 0x8049115
    len = v5;
    write(1, (int32_t)&buf, v5);
    return len;
}

// Address range: 0x804919f - 0x80491a3
int32_t __get_GOT(int32_t a1) {
    // 0x804919f
    int32_t result; // 0x804919f
    return result;
}

// Address range: 0x80491a3 - 0x8049227
int32_t __system_call(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6) {
    // 0x80491a3
    char * v1; // 0x80491a3
    if (*v1 >= 1) {
        // 0x80491b3
        int32_t v2; // 0x80491a3
        __get_GOT(v2);
    }
    // 0x80491f5
    __asm_int(128);
    return (int32_t)*(char *)((int32_t)v1 + 1);
}

// Address range: 0x8049227 - 0x804922d
int32_t open(int32_t a1, int32_t a2) {
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x8049227
    return result;
}

// Address range: 0x804922e - 0x8049235
int32_t close(int32_t a1) {
    // 0x804922e
    int32_t v1; // 0x804922e
    int32_t v2 = v1;
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x804922e
    *(int32_t *)v2 = result + v2;
    return result;
}

// Address range: 0x8049235 - 0x804923c
int32_t read(int32_t a1, char * a2, int32_t a3) {
    int32_t v1 = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x8049235
    int32_t v2; // 0x8049235
    return v1 + v2;
}

// Address range: 0x804923c - 0x8049241
int32_t write(int32_t a1, int32_t a2, int32_t a3) {
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x804923c
    return result;
}

// Address range: 0x8049243 - 0x804924a
int32_t lseek(int32_t a1, int32_t a2, int32_t a3) {
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x8049243
    return result;
}

// Address range: 0x804926d - 0x8049274
int32_t unlink(int32_t a1) {
    // 0x804926d
    int32_t v1; // 0x804926d
    int32_t v2 = v1;
    int32_t result = __system_call((int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1, (int32_t)&g1); // 0x804926d
    *(int32_t *)v2 = v1 + v2;
    return result;
}

// Address range: 0x804930a - 0x8049320
int32_t _fastcall(int32_t * a1, int32_t a2, int32_t a3) {
    // 0x804930a
    int32_t v1; // 0x804930a
    int32_t result = __get_GOT(v1); // 0x804930b
    *(int32_t *)*(int32_t *)(v1 + 0x2cec) = result;
    return result;
}

// Address range: 0x8049411 - 0x804943c
int32_t strlen(int32_t a1) {
    // 0x8049411
    int32_t v1; // 0x8049411
    int32_t v2 = __get_GOT(v1); // 0x8049413
    char v3 = *(char *)*(int32_t *)(v1 + 0x2be4); // 0x8049424
    int32_t result = 0; // 0x8049430
    while (*(char *)(result + (v3 != 0 ? v2 : a1)) != 0) {
        // 0x8049432
        result++;
    }
    // 0x8049439
    return result;
}

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (11.2.1)
// Detected functions: 11


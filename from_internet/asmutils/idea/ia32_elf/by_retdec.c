//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>

// ------------------- Function Prototypes --------------------

int32_t entry_point(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t function_804804c(void);
int32_t function_8048077(void);
int32_t function_804809c(void);
int32_t function_80480e3(void);
int32_t function_804816c(void);
int32_t function_804820a(void);

// --------------------- Global Variables ---------------------

char * g1; // 0x80482ef
char g2 = 0; // 0x80483cf

// ------------------------ Functions -------------------------

// Address range: 0x804804c - 0x8048077
int32_t function_804804c(void) {
    // 0x804804c
    int32_t v1; // 0x804804c
    uint32_t v2 = v1;
    uint32_t v3 = v1;
    int32_t v4; // 0x804804c
    if (v3 == 0) {
        // 0x8048071
        v4 = v2 % 0x10000;
        return (1 - v4) % 0x10000 | v4 & -0x10000;
    }
    if ((int16_t)v2 == 0) {
        // 0x8048071
        int32_t v5; // 0x804804c
        v4 = v5;
        return (1 - v4) % 0x10000 | v4 & -0x10000;
    }
    uint64_t v6 = 0x100000000 * (int64_t)(v3 & -0x10000) | (int64_t)(v3 % 0x10000 * (v2 % 0x10000)); // 0x8048067
    return (int32_t)(v6 / 0x10001) & -0x10000 | (int32_t)(v6 % 0x10001) % 0x10000;
}

// Address range: 0x8048077 - 0x804809c
int32_t function_8048077(void) {
    // 0x8048077
    int32_t v1; // 0x8048077
    uint32_t v2 = (uint32_t)v1 % 0x10000; // 0x8048077
    if (v2 == 0) {
        // 0x804809b
        return 0;
    }
    // 0x8048080
    int32_t v3; // bp-12, 0x8048077
    *(int32_t *)((int32_t)&v3 - 4) = v2;
    int32_t v4 = 0xffff; // 0x8048087
    int32_t result = v4; // 0x8048093
    while ((int64_t)v4 * (int64_t)v2 % 0x10001 != 1) {
        // 0x8048095
        v4--;
        result = 0;
        if (v4 == 0) {
            // break -> 0x804809b
            break;
        }
        result = v4;
    }
    // 0x804809b
    return result;
}

// Address range: 0x804809c - 0x80480e3
int32_t function_804809c(void) {
    // 0x804809c
    int32_t v1; // 0x804809c
    __asm_rep_movsw_memcpy((char *)v1, (char *)v1, 8);
    int32_t v2; // bp-32, 0x804809c
    int32_t v3 = &v2; // 0x80480a4
    int32_t * v4 = (int32_t *)(v3 - 4); // 0x80480a8
    int32_t v5 = 1; // 0x80480a6
    int32_t v6 = 0; // 0x80480a6
    bool v7; // 0x804809c
    int32_t v8 = (v7 ? -16 : 16) + v1; // 0x80480a6
    *v4 = v5;
    int16_t v9 = *(int16_t *)(2 * (v6 | v5 % 8) + v1); // 0x80480af
    uint16_t v10 = *(int16_t *)(2 * ((v5 + 1) % 8 | v6) + v1); // 0x80480ba
    *(int16_t *)v8 = v10 / 128 | 512 * v9;
    uint32_t v11 = *v4; // 0x80480cb
    v5 = v11 + 1;
    v6 += 8 * (int32_t)(v11 % 8 == 0);
    v8 += (v7 ? -2 : 2);
    while (v5 < 45) {
        // 0x80480a8
        *v4 = v5;
        v9 = *(int16_t *)(2 * (v6 | v5 % 8) + v1);
        v10 = *(int16_t *)(2 * ((v5 + 1) % 8 | v6) + v1);
        *(int16_t *)v8 = v10 / 128 | 512 * v9;
        v11 = *v4;
        v5 = v11 + 1;
        v6 += 8 * (int32_t)(v11 % 8 == 0);
        v8 += (v7 ? -2 : 2);
    }
    // 0x80480e1
    return *(int32_t *)(v3 + 28);
}

// Address range: 0x80480e3 - 0x804816c
int32_t function_80480e3(void) {
    // 0x80480e3
    int32_t result; // 0x80480e3
    *(int16_t *)result = (int16_t)function_8048077();
    bool v1; // 0x80480e3
    int32_t v2 = v1 ? -2 : 2; // 0x80480ef
    int32_t v3 = v2 + result; // 0x80480ef
    *(int16_t *)v3 = -*(int16_t *)(result + 98);
    int32_t v4 = v3 + v2; // 0x80480f8
    *(int16_t *)v4 = -*(int16_t *)(result + 100);
    int32_t v5 = v4 + v2; // 0x8048101
    *(int16_t *)v5 = (int16_t)function_8048077();
    int32_t v6 = result + 8; // 0x8048111
    int32_t v7 = v1 ? -4 : 4; // 0x8048115
    int32_t v8 = v5 + v2; // 0x8048110
    for (int32_t i = 42; i > 0; i -= 6) {
        int32_t v9 = 2 * i; // 0x8048111
        *(int32_t *)v8 = *(int32_t *)(v9 + v6);
        int32_t v10 = v8 + v7; // 0x8048115
        *(int16_t *)v10 = (int16_t)function_8048077();
        int32_t v11 = v10 + v2; // 0x804811f
        int32_t v12 = v9 + result;
        *(int16_t *)v11 = -*(int16_t *)(v12 + 4);
        int32_t v13 = v11 + v2; // 0x8048129
        *(int16_t *)v13 = -*(int16_t *)(v12 + 2);
        int32_t v14 = v13 + v2; // 0x8048133
        *(int16_t *)v14 = (int16_t)function_8048077();
        v8 = v14 + v2;
    }
    // 0x8048146
    *(int32_t *)v8 = *(int32_t *)v6;
    int32_t v15 = v8 + v7; // 0x8048149
    int32_t v16 = v2 + result; // 0x804814a
    *(int16_t *)v15 = (int16_t)function_8048077();
    int32_t v17 = v15 + v2; // 0x8048151
    *(int16_t *)v17 = -*(int16_t *)v16;
    int32_t v18 = v17 + v2; // 0x8048158
    *(int16_t *)v18 = -*(int16_t *)(v16 + v2);
    *(int16_t *)(v18 + v2) = (int16_t)function_8048077();
    return result;
}

// Address range: 0x804816c - 0x804820a
int32_t function_804816c(void) {
    // 0x804816c
    int32_t v1; // bp-36, 0x804816c
    int32_t v2 = &v1; // 0x804817f
    int32_t * v3 = (int32_t *)(v2 - 4); // 0x8048180
    bool v4; // 0x804816c
    int32_t v5 = v4 ? -2 : 2; // 0x8048181
    int32_t * v6 = (int32_t *)(v2 - 8);
    int32_t v7; // 0x804816c
    int16_t v8 = *(int16_t *)(v7 + 2);
    *v3 = 8;
    int32_t v9; // 0x804816c
    int32_t v10 = v9 + v5; // 0x8048181
    function_804804c();
    int32_t v11 = v10 + v5; // 0x804818d
    function_804804c();
    *v6 = function_804804c();
    int32_t v12 = v11 + 4 * v5; // 0x80481ba
    int32_t v13 = function_804804c(); // 0x80481bc
    int16_t v14 = *(int16_t *)v11 + *(int16_t *)(v7 + 4) ^ (int16_t)v13; // 0x80481c8
    int16_t v15 = *(int16_t *)v10 + v8 ^ (int16_t)(*v6 + v13); // 0x80481cb
    int32_t v16 = *v3 - 1; // 0x80481d5
    while (v16 != 0) {
        // 0x8048180
        v8 = v14;
        *v3 = v16;
        v10 = v12 + v5;
        function_804804c();
        v11 = v10 + v5;
        function_804804c();
        *v6 = function_804804c();
        v12 = v11 + 4 * v5;
        v13 = function_804804c();
        v14 = *(int16_t *)v11 + v15 ^ (int16_t)v13;
        v15 = *(int16_t *)v10 + v8 ^ (int16_t)(*v6 + v13);
        v16 = *v3 - 1;
    }
    int32_t v17 = v12 + v5; // 0x80481db
    int32_t v18 = function_804804c(); // 0x80481dd
    int32_t v19 = function_804804c(); // 0x80481f3
    *(int16_t *)v1 = (int16_t)v18;
    *(int16_t *)(v1 + 2) = *(int16_t *)v17 + v15;
    *(int16_t *)(v1 + 4) = *(int16_t *)(v17 + v5) + v14;
    *(int16_t *)(v1 + 6) = (int16_t)v19;
    return *(int32_t *)(v2 + 32);
}

// Address range: 0x804820a - 0x804824e
int32_t function_804820a(void) {
    // 0x804820a
    int32_t v1; // bp-8, 0x804820a
    int32_t v2 = &v1; // 0x804820b
    int32_t * v3 = (int32_t *)(v2 - 4); // 0x804820c
    *v3 = 7;
    for (int32_t i = 7; i > -1; i--) {
        // 0x804820f
        *(char *)(i + v2) = 42;
    }
    // 0x8048216
    *v3 = 8;
    while (true) {
        // 0x804821b
        *v3 = 3;
        __asm_int(128);
    }
}

// Address range: 0x804824e - 0x80482ee
int32_t entry_point(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5) {
    int32_t v1 = a5;
    char * v2 = (char *)a4;
    int32_t v3 = (int32_t)&v2; // 0x8048250
    int32_t v4 = v3; // 0x8048253
    int32_t v5; // 0x804824e
    int32_t v6; // 0x804824e
    int32_t v7; // 0x804824e
    if (a3 == 0) {
        goto lab_0x80482bf;
    } else {
        char v8 = *(char *)a3; // 0x8048255
        v4 = v3;
        if (v8 != 101 == (v8 != 100)) {
            goto lab_0x80482bf;
        } else {
            // 0x804825e
            *(char *)0x80483cf = v8;
            int32_t v9 = &v1; // 0x8048263
            v4 = v9;
            if (a4 == 0) {
                goto lab_0x80482bf;
            } else {
                // 0x8048268
                v2 = (char *)&g1;
                bool v10; // 0x804824e
                int32_t v11 = v10 ? -1 : 1;
                int32_t v12 = 16; // 0x8048270
                int32_t v13 = a4; // 0x8048270
                int32_t v14 = (int32_t)&g1; // 0x8048270
                char v15 = *(char *)v13; // 0x8048271
                while (v15 != 0) {
                    // 0x8048276
                    *(char *)v14 = v15;
                    v12--;
                    v13 += v11;
                    v14 += v11;
                    if (v12 == 0) {
                        // break -> 0x8048279
                        break;
                    }
                    v15 = *(char *)v13;
                }
                // 0x8048279
                function_804809c();
                if (g2 != 101) {
                    // 0x804828d
                    function_80480e3();
                }
                // 0x8048299
                v5 = v1;
                v6 = v9;
                v7 = v9;
                if (v1 == 0) {
                    goto lab_0x80482b1;
                } else {
                    goto lab_0x804829f;
                }
            }
        }
    }
  lab_0x80482bf:
    // 0x80482bf
    *(int32_t *)(v4 - 4) = 4;
    __asm_int(128);
    int32_t v16 = 4; // 0x80482cd
    int32_t v17 = (int32_t)"$ idea e/d key [file(s)]\n"; // 0x80482cd
    int32_t v18 = v4; // 0x80482cd
    goto lab_0x80482cf;
  lab_0x80482cf:
    // 0x80482cf
    *(int32_t *)(v18 - 4) = 1;
    __asm_int(128);
    char * v19 = (char *)(v16 + 101); // 0x80482e0
    *v19 = *v19 & (char)(v17 / 256);
    return 0;
  lab_0x80482b1:;
    int32_t v20 = function_804820a(); // 0x80482b4
    v5 = 0;
    v6 = v7;
    v16 = v20;
    v17 = 0;
    v18 = v7;
    if (v20 >= 0) {
        goto lab_0x804829f;
    } else {
        goto lab_0x80482cf;
    }
  lab_0x804829f:;
    int32_t * v21 = (int32_t *)v6; // 0x804829f
    int32_t v22 = v6 + 4; // 0x804829f
    v16 = 0;
    v17 = v5;
    v18 = v22;
    if (*v21 == 0) {
        goto lab_0x80482cf;
    } else {
        // 0x80482a4
        *v21 = 5;
        __asm_int(128);
        v7 = v22;
        goto lab_0x80482b1;
    }
}

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (4.4.3)
// Detected functions: 7


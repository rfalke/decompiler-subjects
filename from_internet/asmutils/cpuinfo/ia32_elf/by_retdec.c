//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>

// ------------------------ Structures ------------------------

struct struct1 {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
};

struct struct2 {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
};

struct struct3 {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
};

struct struct4 {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
};

// ------------------- Function Prototypes --------------------

int32_t entry_point(int32_t a1, int32_t a2, int32_t a3);
int32_t function_8048060(void);
int32_t function_8048142(void);
int32_t function_8048157(void);
int32_t function_80481c8(void);
int32_t function_80481de(void);
int32_t function_8048203(void);

// ------------------------ Functions -------------------------

// Address range: 0x8048060 - 0x804807f
int32_t function_8048060(void) {
    int32_t v1 = -1; // 0x8048066
    int32_t v2; // 0x8048060
    int32_t v3 = v2;
    int32_t v4 = v3; // 0x8048066
    while (v1 != 0) {
        bool v5; // 0x8048060
        int32_t v6 = v3 + (v5 ? -1 : 1); // 0x8048066
        v1--;
        v4 = v6;
        if (*(char *)v3 == 0) {
            // break -> 
            break;
        }
        v3 = v6;
        v4 = v3;
    }
    int32_t result; // 0x8048060
    if (*(int32_t *)(v4 - 5) != 0x64656570) {
        // 0x804807d
        return result;
    }
    // 0x8048071
    return *(int32_t *)(v4 - 9) != 0x73757063 ? result : 0;
}

// Address range: 0x804807f - 0x8048142
int32_t entry_point(int32_t a1, int32_t a2, int32_t a3) {
    struct struct3 v1; // 0x80480e3
    int32_t v2 = a2;
    int32_t v3 = &v2; // 0x8048084
    int32_t v4 = 4 * a1 + 4 + v3; // 0x8048085
    int32_t v5 = function_8048060(); // 0x804808c
    int32_t v6 = v5 - 1; // 0x8048091
    unsigned char v7 = (char)v6; // 0x8048091
    char v8 = llvm_ctpop_i8(v7); // 0x8048091
    char * v9 = (char *)(v4 + 11); // 0x8048092
    *v9 = v7;
    bool v10 = v6 < 0; // 0x8048095
    bool v11 = v6 == 0; // 0x8048095
    bool v12 = v5 % 16 > 16; // 0x8048095
    char v13 = v8; // 0x8048095
    bool v14 = (v5 & -v5) < 0; // 0x8048095
    int32_t v15 = v3; // 0x8048095
    if (v5 < 2) {
        goto lab_0x80480ab;
    } else {
        // 0x8048097
        int32_t v16; // bp+12, 0x804807f
        v15 = &v16;
        uint32_t v17 = *(int32_t *)a3; // 0x8048099
        if ((int16_t)v17 == 0x742d) {
            goto lab_0x80480a8;
        } else {
            // 0x80480a1
            if (v17 != 0x69742d2d) {
                goto lab_0x80480ab;
            } else {
                goto lab_0x80480a8;
            }
        }
    }
  lab_0x80480ab:;
    // 0x80480ab
    bool v18; // 0x804807f
    bool v19; // 0x804807f
    int32_t v20 = 128 * (int32_t)v10 | 256 * (int32_t)v19 | 64 * (int32_t)v11 | 16 * (int32_t)v12 | (int32_t)v18 | 4 * (int32_t)(v13 % 2 == 0); // 0x80480ab
    int32_t v21 = v20 | 512 * (int32_t)v19; // 0x80480ab
    int32_t v22 = v21 | 1024 * (int32_t)v19; // 0x80480ab
    int32_t v23 = v22 | 2048 * (int32_t)v14; // 0x80480ab
    int32_t v24 = v23 | 0x4000 * (int32_t)(bool)v19; // 0x80480ab
    int32_t v25 = v15 - 4; // 0x80480ab
    int32_t * v26 = (int32_t *)v25; // 0x80480ab
    int32_t v27 = v20 | 512 * (int32_t)((v21 & 512) != 0) | 1024 * (int32_t)((v22 & 1024) != 0) | 2048 * (int32_t)((v23 & 2048) != 0) | 0x4000 * (int32_t)((v24 & 0x4000) != 0) | 2; // 0x80480b6
    *v26 = v27;
    int32_t v28 = v15; // 0x80480ba
    int32_t v29; // 0x804807f
    if (v27 == (v24 || 2)) {
        goto lab_0x80480fd;
    } else {
        // 0x80480bc
        if (*v9 < 0) {
            // 0x804813b
            __asm_rdtsc();
            __asm_int(128);
            __asm_rdtsc_3();
            *v26 = 0;
            *(int16_t *)(v4 + 9) = 10;
            *v26 = *v26 + 1;
            *(char *)(v4 + 8) = 48;
            function_80481c8();
            v29 = v25;
        } else {
            // 0x80480c3
            *v26 = __asm_cpuid(0).e0;
            function_8048142();
            if (__asm_cpuid_1(-0x80000000).e0 < 0) {
                // 0x80480d6
                function_8048142();
            }
            uint32_t v30 = *v26; // 0x80480db
            v29 = v15;
            if (v30 >= 2) {
                // 0x80480e1
                v1 = __asm_cpuid_2(v30 & -256 | 2);
                v29 = v15;
                if ((char)v1.e0 >= 2) {
                    // 0x80480e9
                    function_8048142();
                    v29 = v15;
                }
            }
        }
        goto lab_0x80480f6;
    }
  lab_0x80480fd:
    // 0x80480fd
    function_80481c8();
    v29 = v28;
    goto lab_0x80480f6;
  lab_0x80480a8:;
    char v31 = -v7; // 0x80480a8
    v13 = llvm_ctpop_i8(v31);
    *v9 = v31;
    v10 = v31 < 0;
    v11 = v7 == 0;
    v12 = -((v7 % 16)) > 15;
    v14 = false;
    v18 = v7 != 0;
    goto lab_0x80480ab;
  lab_0x80480f6:
    // 0x80480f6
    *(int32_t *)(v29 - 4) = 1;
    __asm_int(128);
    v28 = v29;
    goto lab_0x80480fd;
}

// Address range: 0x8048142 - 0x8048157
int32_t function_8048142(void) {
    int32_t v1; // 0x8048142
    for (char i = (char)v1; i >= 0; i--) {
        // 0x8048148
        function_8048157();
    }
    // 0x8048155
    return i;
}

// Address range: 0x8048157 - 0x80481c8
int32_t function_8048157(void) {
    // 0x8048157
    function_8048203();
    int32_t v1; // 0x8048157
    __asm_cpuid_4(v1 & -0x10000001);
    int32_t v2 = function_80481de(); // 0x804816c
    int32_t v3 = function_80481de(); // 0x8048172
    int32_t v4 = function_80481de(); // 0x8048178
    int32_t v5 = function_80481de(); // 0x804817e
    int32_t result = v5; // 0x8048187
    if (*(char *)(v1 + 11) >= 1) {
        // 0x8048189
        *(int32_t *)(v1 + 1) = 0x2720;
        function_80481c8();
        int32_t * v6 = (int32_t *)v1; // 0x804819f
        *v6 = v2;
        function_80481c8();
        *v6 = v3;
        function_80481c8();
        *v6 = (int16_t)v1 != 0 ? v4 : v5;
        *v6 = function_80481c8();
        function_80481c8();
        *(int16_t *)v1 = 39;
        result = function_80481c8();
    }
    // 0x80481c5
    return result;
}

// Address range: 0x80481c8 - 0x80481de
int32_t function_80481c8(void) {
    // 0x80481c8
    int32_t result; // 0x80481c8
    int32_t v1 = result - 1; // 0x80481cb
    while (*(char *)(v1 + 1) > 8) {
        // 0x80481cc
        v1++;
    }
    // 0x80481d2
    __asm_int(128);
    return result;
}

// Address range: 0x80481de - 0x8048203
int32_t function_80481de(void) {
    // 0x80481de
    int32_t v1; // 0x80481de
    int32_t v2 = v1 + 8; // 0x80481e6
    *(char *)v2 = 32;
    int32_t v3 = v2; // 0x80481ec
    int32_t result = 0; // 0x80481ec
    for (uint32_t i = 8; i >= 1; i--) {
        // 0x80481ed
        v3--;
        int32_t v4; // 0x80481de
        unsigned char v5 = (char)v4 % 16; // 0x80481f5
        char v6 = v5 < 10 ? 106 : 105; // 0x80481f7
        char v7 = v5 - v6; // 0x80481f7
        char v8 = (v7 & 14) > 9 | v5 + (char)(v5 < 10) - (v6 & 11) > 15 ? -102 : -96;
        unsigned char v9 = v8 + v7;
        result = result & -256 | (int32_t)v9;
        *(char *)v3 = v9;
        v4 /= 16;
    }
    // 0x80481ff
    return result;
}

// Address range: 0x8048203 - 0x8048208
int32_t function_8048203(void) {
    // 0x8048203
    int32_t result; // 0x8048203
    return result;
}

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: upx (3.9x [nrv2b])
// Detected functions: 7


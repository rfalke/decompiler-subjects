/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall sub_402020(); // weak
// int get_nprocs(void);
// void __noreturn std::terminate(void); idb
// ssize_t write(int fd, const void *buf, size_t n);
// void __noreturn std::__throw_bad_alloc(void); idb
// void __fastcall std::thread::_State::~_State(std::thread::_State *__hidden this); idb
// _QWORD std::condition_variable::notify_one(std::condition_variable *__hidden this); idb
// void __fastcall __noreturn std::__throw_length_error(const char *); idb
// ssize_t writev(int fd, const struct iovec *iovec, int count);
// void *memset(void *s, int c, size_t n);
// int pthread_create(pthread_t *newthread, const pthread_attr_t *attr, void *(*start_routine)(void *), void *arg);
// void __fastcall __noreturn std::__throw_system_error(int); idb
// _QWORD std::ostream::flush(std::ostream *__hidden this); idb
// int pthread_mutex_unlock(pthread_mutex_t *mutex);
// void *memcpy(void *dest, const void *src, size_t n);
// int __fastcall __cxa_atexit(void (__fastcall *lpfunc)(void *), void *obj, void *lpdso_handle);
// __int64 __fastcall std::thread::_M_start_thread(_QWORD, _QWORD, _QWORD); weak
// _QWORD __fastcall operator new(unsigned __int64); idb
// void __fastcall operator delete(void *, unsigned __int64); idb
// __int64 __fastcall std::__ostream_insert<char,std::char_traits<char>>(_QWORD, _QWORD, _QWORD); weak
// _QWORD std::condition_variable::condition_variable(std::condition_variable *__hidden this); idb
// int pthread_mutex_lock(pthread_mutex_t *mutex);
// _QWORD std::ios_base::Init::Init(std::ios_base::Init *__hidden this); idb
// __int64 __fastcall std::condition_variable::wait(_QWORD, _QWORD); weak
// int snprintf(char *s, size_t maxlen, const char *format, ...);
// void *memmove(void *dest, const void *src, size_t n);
// int __pthread_key_create(pthread_key_t *key, void (*destr_function)(void *));
// _QWORD std::thread::join(std::thread *__hidden this); idb
// __int64 __fastcall std::ostream::operator<<(_QWORD, _QWORD); weak
// void __fastcall std::condition_variable::~condition_variable(std::condition_variable *__hidden this); idb
// void __fastcall std::ios_base::Init::~Init(void *); idb
int __cdecl main(int argc, const char **argv, const char **envp);
int GLOBAL__sub_I_main();
void __fastcall std::thread::_State_impl<std::thread::_Invoker<std::tuple<main::{lambda(worker *)#1},worker *>>>::~_State_impl(std::thread::_State *);
void __fastcall std::thread::_State_impl<std::thread::_Invoker<std::tuple<main::{lambda(worker *)#1},worker *>>>::~_State_impl(void *);
void __fastcall __noreturn worker::loop(worker *__hidden this); // idb
void __fastcall __noreturn std::thread::_State_impl<std::thread::_Invoker<std::tuple<main::{lambda(worker *)#1},worker *>>>::_M_run(__int64);
void __fastcall worker::worker(worker *this, unsigned __int64, unsigned __int64, unsigned __int64, __m128 _XMM0);
std::__cxx11 *__fastcall std::__cxx11::to_string(std::__cxx11 *this, unsigned __int64);
void __fastcall std::vector<std::unique_ptr<worker>>::_M_realloc_insert<std::unique_ptr<worker>>(__int64, __int64 *, __int64 *);
void __fastcall std::vector<std::unique_ptr<std::thread>>::_M_realloc_insert<std::unique_ptr<std::thread>>(__int64, __int64 *, _QWORD *);
void __fastcall std::vector<__gnu_cxx::__normal_iterator<char *,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>::_M_realloc_insert<__gnu_cxx::__normal_iterator<char *,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>(__int64, __int64 *, _QWORD *);
void __fastcall std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_mutate(__int64, size_t, __int64, _BYTE *, size_t);
_QWORD *__fastcall std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_replace_aux(_QWORD *, size_t, __int64, size_t, char);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN _dso_handle; // weak
__int64 (__fastcall *off_405120)() = &std::thread::_State_impl<std::thread::_Invoker<std::tuple<main::{lambda(worker *)#1},worker *>>>::~_State_impl; // weak
char std::__detail::__to_chars_10_impl<unsigned long>(char *,unsigned int,unsigned long)::__digits[] = { '0' }; // weak
char byte_405141[] = { '0' }; // weak
char std::__detail::__to_chars_10_impl<unsigned int>(char *,unsigned int,unsigned int)::__digits[] = { '0' }; // weak
__int64 (*qword_407010)(void) = NULL; // weak
_UNKNOWN std::cout; // weak
_UNKNOWN std::__ioinit; // weak


//----- (0000000000402020) ----------------------------------------------------
__int64 sub_402020()
{
  return qword_407010();
}
// 402020: using guessed type __int64 __fastcall sub_402020();
// 407010: using guessed type __int64 (*qword_407010)(void);

//----- (0000000000402210) ----------------------------------------------------
int __cdecl main(int argc, const char **argv, const char **envp)
{
  __int64 v4; // r15
  int v5; // ebx
  unsigned __int64 v6; // r12
  __int64 v7; // rcx
  unsigned __int64 v8; // r13
  unsigned int v9; // ecx
  int v10; // er15
  unsigned __int64 v11; // rdx
  unsigned int v12; // ebx
  unsigned __int64 v13; // rsi
  unsigned int v14; // eax
  unsigned int v15; // esi
  size_t v16; // rdx
  __int64 *v17; // rax
  char *v18; // rsi
  unsigned int v19; // eax
  unsigned int v20; // edi
  __int64 v21; // rax
  __int64 v22; // r11
  __int64 v23; // rdx
  char v24; // al
  __int64 v25; // rcx
  void *v26; // rbx
  __int64 *v27; // rax
  __int64 *v28; // rdi
  __int64 v29; // rax
  __int64 *v32; // rcx
  unsigned __int64 v36; // rdx
  unsigned __int64 v38; // rdx
  unsigned __int64 v40; // rax
  char *v41; // rcx
  char *v42; // rax
  unsigned __int64 v43; // rbx
  int v44; // er13
  unsigned __int64 v45; // rax
  unsigned __int64 v46; // r15
  worker *v47; // r14
  char *v48; // rsi
  void **v49; // r14
  void *v50; // rdi
  __int64 *v51; // rax
  __int64 v52; // rsi
  __int64 v53; // rcx
  __int64 v54; // rdx
  unsigned __int64 v56; // rbp
  __int64 *v58; // rcx
  unsigned __int64 v63; // rdx
  unsigned __int64 v65; // rdx
  unsigned __int64 v67; // rax
  char *v68; // rcx
  char *v69; // rax
  __int64 *v70; // r12
  __int64 *i; // rbp
  __int64 v72; // r13
  _QWORD *v73; // rax
  void *v74; // rbx
  _QWORD *v75; // rax
  char *v76; // rsi
  __int64 **v77; // rbx
  __int64 *v78; // rax
  pthread_mutex_t *v79; // r12
  int v80; // eax
  __int64 v81; // rdx
  _QWORD **v82; // rbp
  _QWORD **j; // rbx
  _QWORD *v84; // rdi
  __int64 *v85; // r12
  __int64 *k; // rbx
  __int64 v87; // rbp
  void *v88; // rdi
  __int64 *v90; // rax
  char *v91; // rdx
  __int64 v92; // rsi
  __int64 *v93; // rax
  char *v94; // rdx
  __int64 v95; // rsi
  void *v96; // [rsp+0h] [rbp-A8h]
  unsigned __int64 v98; // [rsp+0h] [rbp-A8h]
  size_t na; // [rsp+10h] [rbp-98h]
  size_t n; // [rsp+10h] [rbp-98h]
  int nprocs; // [rsp+18h] [rbp-90h]
  unsigned int v103; // [rsp+1Ch] [rbp-8Ch]
  void *v104; // [rsp+28h] [rbp-80h] BYREF
  void *v105[2]; // [rsp+30h] [rbp-78h] BYREF
  char *v106; // [rsp+40h] [rbp-68h]
  void *v107[2]; // [rsp+50h] [rbp-58h] BYREF
  __int64 v108[9]; // [rsp+60h] [rbp-48h] BYREF

  v4 = 1000LL;
  v5 = 4;
  nprocs = get_nprocs();
  while ( 1 )
  {
    v6 = 3 * v4;
    v7 = 8LL * snprintf(0LL, 0LL, "%zu", v4) + 39;
    if ( 3 * v4 * v7 / 0xFuLL / nprocs > 0x10000 )
      break;
    v6 = 6 * v4;
    if ( 6 * v4 * v7 / 0xFuLL / nprocs > 0x10000 )
      break;
    v6 = 9 * v4;
    if ( 9 * v4 * v7 / 0xFuLL / nprocs > 0x10000 )
      break;
    v4 *= 10LL;
    if ( !--v5 )
    {
      v6 = 9000000LL;
      break;
    }
  }
  std::__cxx11::to_string((std::__cxx11 *)v107, v6);
  v96 = v107[1];
  if ( v107[0] != v108 )
    operator delete(v107[0], v108[0] + 1);
  v8 = 1LL;
  v9 = 1;
  v10 = 1;
LABEL_33:
  v12 = 0;
  v107[0] = v108;
LABEL_46:
  v17 = (__int64 *)v107[0];
  LOBYTE(v108[0]) = 45;
  v16 = 1LL;
  while ( 1 )
  {
    v107[1] = (void *)v16;
    *((_BYTE *)v17 + v16) = 0;
    v18 = (char *)v107[0];
    if ( v8 > 0x63 )
    {
      do
      {
        v19 = v9 % 0x64;
        v20 = v9;
        v9 /= 0x64u;
        v21 = 2 * v19;
        v22 = (unsigned int)(v21 + 1);
        LOBYTE(v21) = std::__detail::__to_chars_10_impl<unsigned int>(char *,unsigned int,unsigned int)::__digits[v21];
        v18[v12] = std::__detail::__to_chars_10_impl<unsigned int>(char *,unsigned int,unsigned int)::__digits[v22];
        v23 = v12 - 1;
        v12 -= 2;
        v18[v23] = v21;
      }
      while ( v20 > 0x270F );
    }
    v24 = v9 + 48;
    if ( v9 > 9 )
    {
      v25 = 2 * v9;
      v18[1] = std::__detail::__to_chars_10_impl<unsigned int>(char *,unsigned int,unsigned int)::__digits[(unsigned int)(v25 + 1)];
      v24 = std::__detail::__to_chars_10_impl<unsigned int>(char *,unsigned int,unsigned int)::__digits[v25];
    }
    *v18 = v24;
    v26 = v107[1];
    if ( v107[0] != v108 )
      operator delete(v107[0], v108[0] + 1);
    if ( v96 < v26 )
      break;
    if ( (unsigned int)(-286331153 * v10) <= 0x11111111 )
    {
      std::__ostream_insert<char,std::char_traits<char>>(&std::cout, "FizzBuzz\n", 9LL);
    }
    else if ( (unsigned int)(-858993459 * v10) <= 0x33333333 )
    {
      std::__ostream_insert<char,std::char_traits<char>>(&std::cout, 4214920LL, 5LL);
    }
    else if ( (unsigned int)(-1431655765 * v10) > 0x55555555 )
    {
      v29 = std::ostream::operator<<(&std::cout, (unsigned int)v10);
      LOBYTE(v107[0]) = 10;
      std::__ostream_insert<char,std::char_traits<char>>(v29, v107, 1LL);
    }
    else
    {
      std::__ostream_insert<char,std::char_traits<char>>(&std::cout, "Fizz\n", 5LL);
    }
    v9 = ++v8;
    v10 = v8;
    if ( v8 <= 9 )
      goto LABEL_33;
    if ( (unsigned int)v8 <= 0x63 )
    {
      v12 = 1;
LABEL_38:
      v15 = v12 + 1;
    }
    else if ( (unsigned int)v8 <= 0x3E7 )
    {
      v12 = 1;
LABEL_40:
      v15 = v12 + 2;
      ++v12;
    }
    else if ( (unsigned int)v8 <= 0x270F )
    {
      v12 = 1;
LABEL_42:
      v15 = v12 + 3;
      v12 += 2;
    }
    else
    {
      v11 = v8;
      v12 = 1;
      while ( 1 )
      {
        v13 = v11;
        v14 = v12;
        v12 += 4;
        v11 /= 0x2710uLL;
        if ( v13 <= 0x1869F )
          break;
        if ( (unsigned int)v11 <= 0x63 )
          goto LABEL_38;
        if ( (unsigned int)v11 <= 0x3E7 )
          goto LABEL_40;
        if ( (unsigned int)v11 <= 0x270F )
          goto LABEL_42;
      }
      v15 = v12;
      v12 = v14 + 3;
    }
    v16 = v15;
    v107[0] = v108;
    if ( v15 > 0xF )
    {
      v27 = (__int64 *)operator new(v15 + 1LL);
      v16 = v15;
      v9 = v8;
      v28 = v27;
      v107[0] = v27;
      v108[0] = v15;
      goto LABEL_35;
    }
    v17 = v108;
    if ( v15 )
    {
      if ( v15 == 1LL )
        goto LABEL_46;
      v28 = v108;
LABEL_35:
      v103 = v9;
      na = v16;
      memset(v28, 45, v16);
      v17 = (__int64 *)v107[0];
      v9 = v103;
      v16 = na;
    }
  }
  std::ostream::flush((std::ostream *)&std::cout);
  __asm { vpxor   xmm0, xmm0, xmm0 }
  v106 = 0LL;
  __asm { vmovdqa xmmword ptr [rsp+0A8h+var_78], xmm0 }
  if ( (unsigned __int64)nprocs >> 60 )
    std::__throw_length_error("vector::reserve");
  if ( !nprocs )
  {
    *(_QWORD *)(*((_QWORD *)v105[1] - 1) + 184LL) = *(_QWORD *)v105[0];
    goto LABEL_71;
  }
  _RAX = (char *)operator new(8LL * nprocs);
  v32 = (__int64 *)v105[1];
  _RDI = (char *)v105[0];
  __asm { vmovq   xmm3, rax }
  _RBX = _RAX;
  __asm { vpunpcklqdq xmm0, xmm3, xmm3 }
  if ( v105[1] == v105[0] )
  {
LABEL_117:
    if ( _RDI )
      goto LABEL_56;
    goto LABEL_57;
  }
  v36 = (char *)v105[1] - 8 - (char *)v105[0];
  if ( _RAX == (char *)v105[0] + 8 || v36 <= 0x10 )
  {
    v90 = (__int64 *)v105[0];
    v91 = _RBX;
    do
    {
      v92 = *v90++;
      v91 += 8;
      *((_QWORD *)v91 - 1) = v92;
    }
    while ( v32 != v90 );
    goto LABEL_117;
  }
  _RAX = 0LL;
  v38 = (v36 >> 3) + 1;
  do
  {
    __asm
    {
      vmovdqu xmm1, xmmword ptr [rdi+rax]
      vmovdqu xmmword ptr [rbx+rax], xmm1
    }
    _RAX += 16LL;
  }
  while ( _RAX != 16 * (v38 >> 1) );
  v40 = 8 * (v38 & 0xFFFFFFFFFFFFFFFELL);
  v41 = &_RBX[v40];
  v42 = &_RDI[v40];
  if ( (v38 & 0xFFFFFFFFFFFFFFFELL) != v38 )
    *(_QWORD *)v41 = *(_QWORD *)v42;
LABEL_56:
  __asm { vmovdqa xmmword ptr [rsp+0A8h+var_A8], xmm0 }
  operator delete(_RDI, v106 - _RDI);
  __asm { vmovdqa xmm0, xmmword ptr [rsp+0A8h+var_A8] }
LABEL_57:
  __asm { vmovdqa xmmword ptr [rsp+0A8h+var_78], xmm0 }
  v106 = &_RBX[8 * nprocs];
  if ( nprocs > 0 )
  {
    v43 = 0LL;
    v44 = 0;
    n = v10;
    do
    {
      while ( 1 )
      {
        v45 = v43;
        v43 += v6;
        ++v44;
        v46 = n + v45 / nprocs;
        v98 = v43 / nprocs - v45 / nprocs;
        v47 = (worker *)operator new(0xC0uLL);
        worker::worker(v47, v46, v98, v6, _XMM0);
        v48 = (char *)v105[1];
        v107[0] = v47;
        if ( v105[1] == v106 )
          break;
        *(_QWORD *)v105[1] = v47;
        v105[1] = v48 + 8;
LABEL_60:
        if ( v44 == nprocs )
          goto LABEL_68;
      }
      std::vector<std::unique_ptr<worker>>::_M_realloc_insert<std::unique_ptr<worker>>(
        (__int64)v105,
        (__int64 *)v105[1],
        (__int64 *)v107);
      v49 = (void **)v107[0];
      if ( !v107[0] )
        goto LABEL_60;
      std::condition_variable::~condition_variable((std::condition_variable *)((char *)v107[0] + 104));
      v50 = v49[4];
      if ( v50 )
        operator delete(v50, (_BYTE *)v49[6] - (_BYTE *)v50);
      if ( *v49 != v49 + 2 )
        operator delete(*v49, (unsigned __int64)v49[2] + 1);
      operator delete(v49, 0xC0uLL);
    }
    while ( v44 != nprocs );
  }
LABEL_68:
  v51 = (__int64 *)v105[0];
  *(_QWORD *)(*((_QWORD *)v105[1] - 1) + 184LL) = *(_QWORD *)v105[0];
  if ( nprocs > 1 )
  {
    v52 = (__int64)&v51[(unsigned int)(nprocs - 2) + 1];
    do
    {
      v53 = v51[1];
      v54 = *v51++;
      *(_QWORD *)(v54 + 184) = v53;
    }
    while ( v51 != (__int64 *)v52 );
  }
LABEL_71:
  __asm { vpxor   xmm0, xmm0, xmm0 }
  v108[0] = 0LL;
  __asm { vmovdqa xmmword ptr [rsp+0A8h+var_58], xmm0 }
  if ( !nprocs )
    goto LABEL_81;
  v56 = 8LL * nprocs;
  _RAX = (char *)operator new(v56);
  v58 = (__int64 *)v107[1];
  _RDI = (char *)v107[0];
  __asm { vmovq   xmm4, rax }
  _RBX = _RAX;
  __asm { vpunpcklqdq xmm0, xmm4, xmm4 }
  if ( v107[1] == v107[0] )
  {
LABEL_121:
    if ( !_RDI )
      goto LABEL_80;
    goto LABEL_79;
  }
  v63 = (char *)v107[1] - 8 - (char *)v107[0];
  if ( _RAX == (char *)v107[0] + 8 || v63 <= 0x10 )
  {
    v93 = (__int64 *)v107[0];
    v94 = _RBX;
    do
    {
      v95 = *v93++;
      v94 += 8;
      *((_QWORD *)v94 - 1) = v95;
    }
    while ( v58 != v93 );
    goto LABEL_121;
  }
  _RAX = 0LL;
  v65 = (v63 >> 3) + 1;
  do
  {
    __asm
    {
      vmovdqu xmm2, xmmword ptr [rdi+rax]
      vmovdqu xmmword ptr [rbx+rax], xmm2
    }
    _RAX += 16LL;
  }
  while ( 16 * (v65 >> 1) != _RAX );
  v67 = 8 * (v65 & 0xFFFFFFFFFFFFFFFELL);
  v68 = &_RBX[v67];
  v69 = &_RDI[v67];
  if ( (v65 & 0xFFFFFFFFFFFFFFFELL) != v65 )
    *(_QWORD *)v68 = *(_QWORD *)v69;
LABEL_79:
  __asm { vmovdqa xmmword ptr [rsp+0A8h+var_A8], xmm0 }
  operator delete(_RDI, v108[0] - (_QWORD)_RDI);
  __asm { vmovdqa xmm0, xmmword ptr [rsp+0A8h+var_A8] }
LABEL_80:
  __asm { vmovdqa xmmword ptr [rsp+0A8h+var_58], xmm0 }
  v108[0] = (__int64)&_RBX[v56];
LABEL_81:
  v70 = (__int64 *)v105[1];
  for ( i = (__int64 *)v105[0]; v70 != i; ++i )
  {
    while ( 1 )
    {
      v72 = *i;
      v73 = (_QWORD *)operator new(8uLL);
      *v73 = 0LL;
      v74 = v73;
      v75 = (_QWORD *)operator new(0x10uLL);
      *v75 = &off_405120;
      v75[1] = v72;
      v104 = v75;
      std::thread::_M_start_thread(v74, &v104, pthread_create);
      if ( v104 )
        (*(void (__fastcall **)(void *))(*(_QWORD *)v104 + 8LL))(v104);
      v76 = (char *)v107[1];
      v104 = v74;
      if ( v107[1] == (void *)v108[0] )
        break;
      *(_QWORD *)v107[1] = v74;
      v107[1] = v76 + 8;
LABEL_84:
      if ( v70 == ++i )
        goto LABEL_91;
    }
    std::vector<std::unique_ptr<std::thread>>::_M_realloc_insert<std::unique_ptr<std::thread>>(
      (__int64)v107,
      (__int64 *)v107[1],
      &v104);
    if ( !v104 )
      goto LABEL_84;
    if ( *(_QWORD *)v104 )
LABEL_125:
      std::terminate();
    operator delete(v104, 8uLL);
  }
LABEL_91:
  v77 = (__int64 **)v105[0];
  v78 = *(__int64 **)v105[0];
  v79 = (pthread_mutex_t *)(*(_QWORD *)v105[0] + 64LL);
  if ( __pthread_key_create )
  {
    v80 = pthread_mutex_lock((pthread_mutex_t *)(*(_QWORD *)v105[0] + 64LL));
    if ( v80 )
      std::__throw_system_error(v80);
    v78 = *v77;
  }
  v81 = *v78;
  v78[20] = 0LL;
  v78[19] = v81;
  if ( __pthread_key_create )
    pthread_mutex_unlock(v79);
  std::condition_variable::notify_one((std::condition_variable *)(*v77 + 13));
  std::thread::join(*(std::thread **)v107[0]);
  v82 = (_QWORD **)v107[1];
  for ( j = (_QWORD **)v107[0]; v82 != j; ++j )
  {
    v84 = *j;
    if ( *j )
    {
      if ( *v84 )
        goto LABEL_125;
      operator delete(v84, 8uLL);
    }
  }
  if ( v107[0] )
    operator delete(v107[0], v108[0] - (unsigned __int64)v107[0]);
  v85 = (__int64 *)v105[1];
  for ( k = (__int64 *)v105[0]; v85 != k; ++k )
  {
    v87 = *k;
    if ( *k )
    {
      std::condition_variable::~condition_variable((std::condition_variable *)(v87 + 104));
      v88 = *(void **)(v87 + 32);
      if ( v88 )
        operator delete(v88, *(_QWORD *)(v87 + 48) - (_QWORD)v88);
      if ( *(_QWORD *)v87 != v87 + 16 )
        operator delete(*(void **)v87, *(_QWORD *)(v87 + 16) + 1LL);
      operator delete((void *)v87, 0xC0uLL);
    }
  }
  if ( v105[0] )
    operator delete(v105[0], v106 - (char *)v105[0]);
  return 0;
}
// 402120: using guessed type __int64 __fastcall std::thread::_M_start_thread(_QWORD, _QWORD, _QWORD);
// 402150: using guessed type __int64 __fastcall std::__ostream_insert<char,std::char_traits<char>>(_QWORD, _QWORD, _QWORD);
// 4021E0: using guessed type __int64 __fastcall std::ostream::operator<<(_QWORD, _QWORD);
// 405120: using guessed type __int64 (__fastcall *off_405120)();

//----- (0000000000402BA0) ----------------------------------------------------
int GLOBAL__sub_I_main()
{
  std::ios_base::Init::Init((std::ios_base::Init *)&std::__ioinit);
  return __cxa_atexit(std::ios_base::Init::~Init, &std::__ioinit, &_dso_handle);
}

//----- (0000000000402CC0) ----------------------------------------------------
void __fastcall std::thread::_State_impl<std::thread::_Invoker<std::tuple<main::{lambda(worker *)#1},worker *>>>::~_State_impl(
        std::thread::_State *a1)
{
  *(_QWORD *)a1 = &off_405120;
  std::thread::_State::~_State(a1);
}
// 405120: using guessed type __int64 (__fastcall *off_405120)();

//----- (0000000000402CD0) ----------------------------------------------------
void __fastcall std::thread::_State_impl<std::thread::_Invoker<std::tuple<main::{lambda(worker *)#1},worker *>>>::~_State_impl(
        void *a1)
{
  *(_QWORD *)a1 = &off_405120;
  std::thread::_State::~_State((std::thread::_State *)a1);
  operator delete(a1, 0x10uLL);
}
// 405120: using guessed type __int64 (__fastcall *off_405120)();

//----- (0000000000402CF0) ----------------------------------------------------
void __fastcall __noreturn worker::loop(worker *this)
{
  pthread_mutex_t *v2; // r12
  std::condition_variable *v3; // rbx
  int v4; // eax
  bool v5; // zf
  unsigned __int64 v6; // r14
  unsigned __int64 v7; // rax
  __int64 v8; // rdx
  pthread_mutex_t *v9; // r15
  __int64 v10; // rax
  __int64 v11; // r15
  _QWORD *v12; // rdi
  _QWORD *v13; // rcx
  unsigned int v14; // esi
  char *v15; // rdx
  char v16; // al
  size_t v17; // r9
  _QWORD *v18; // r14
  __int64 v19; // r15
  size_t v20; // rax
  _BYTE *v21; // rcx
  _BYTE *v22; // rdx
  char *v23; // rax
  char v24; // si
  unsigned __int64 v25; // r15
  size_t v26; // [rsp+8h] [rbp-50h]
  pthread_mutex_t *mutex; // [rsp+10h] [rbp-48h] BYREF
  char v28; // [rsp+18h] [rbp-40h]

  v2 = (pthread_mutex_t *)((char *)this + 64);
  v3 = (worker *)((char *)this + 104);
LABEL_2:
  while ( 1 )
  {
    mutex = v2;
    v28 = 0;
    if ( __pthread_key_create )
    {
      v4 = pthread_mutex_lock(v2);
      if ( v4 )
        break;
    }
    v5 = *((_QWORD *)this + 19) == 0LL;
    v28 = 1;
    if ( v5 )
    {
      do
        std::condition_variable::wait(v3, &mutex);
      while ( !*((_QWORD *)this + 19) );
    }
    *((_QWORD *)this + 22) = 0x10000LL - *((_QWORD *)this + 20);
    writev(1, (const struct iovec *)((char *)this + 152), 2);
    *((_QWORD *)this + 19) = 0LL;
    if ( v28 && mutex && __pthread_key_create )
      pthread_mutex_unlock(mutex);
    std::condition_variable::notify_one(v3);
    v6 = *(_QWORD *)this + *((_QWORD *)this + 22);
    v7 = *((_QWORD *)this + 1) + *(_QWORD *)this;
    if ( v6 + 0x10000 < v7 )
    {
      v25 = v6 + 0x10000;
      do
      {
        v6 = v25;
        write(1, (const void *)(v25 - 0x10000), 0x10000uLL);
        v25 += 0x10000LL;
        v7 = *(_QWORD *)this + *((_QWORD *)this + 1);
      }
      while ( v7 > v25 );
    }
    v8 = *((_QWORD *)this + 23);
    v9 = (pthread_mutex_t *)(v8 + 64);
    if ( __pthread_key_create )
    {
      v4 = pthread_mutex_lock((pthread_mutex_t *)(v8 + 64));
      if ( v4 )
        break;
      v7 = *(_QWORD *)this + *((_QWORD *)this + 1);
      v8 = *((_QWORD *)this + 23);
    }
    *(_QWORD *)(v8 + 152) = v6;
    *(_QWORD *)(v8 + 160) = v7 - v6;
    if ( __pthread_key_create )
      pthread_mutex_unlock(v9);
    std::condition_variable::notify_one((std::condition_variable *)(*((_QWORD *)this + 23) + 104LL));
    v10 = *((_QWORD *)this + 23);
    v28 = 0;
    mutex = (pthread_mutex_t *)(v10 + 64);
    if ( __pthread_key_create )
    {
      v4 = pthread_mutex_lock((pthread_mutex_t *)(v10 + 64));
      if ( v4 )
        break;
      v10 = *((_QWORD *)this + 23);
    }
    v5 = *(_QWORD *)(v10 + 152) == 0LL;
    v28 = 1;
    v11 = v10 + 104;
    if ( v5 )
      goto LABEL_42;
    do
      std::condition_variable::wait(v11, &mutex);
    while ( *(_QWORD *)(*((_QWORD *)this + 23) + 152LL) );
    if ( v28 )
    {
LABEL_42:
      if ( mutex && __pthread_key_create )
        pthread_mutex_unlock(mutex);
    }
    v12 = (_QWORD *)*((_QWORD *)this + 5);
    v13 = (_QWORD *)*((_QWORD *)this + 4);
    v14 = 0;
    if ( v12 != v13 )
    {
      do
      {
        if ( *(_BYTE *)(*v13 - 2LL) != 122 )
        {
          v15 = (char *)(*v13 - *((int *)this + 14));
          v16 = *v15 + *((_BYTE *)this + 60);
          for ( *v15 = v16; v16 > 57; *v15 = v16 )
          {
            *v15-- = v16 - 10;
            v16 = *v15 + 1;
          }
          v14 += v16 == 11;
        }
        ++v13;
      }
      while ( v12 != v13 );
      if ( v14 )
      {
        v17 = *((_QWORD *)this + 1);
        v18 = (_QWORD *)*((_QWORD *)this + 5);
        v19 = *(_QWORD *)this;
        v20 = v17 + v14;
        if ( v20 > v17 )
        {
          v26 = *((_QWORD *)this + 1);
          std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_replace_aux(
            this,
            v26,
            0LL,
            v14,
            0);
          v17 = v26;
          v21 = (_BYTE *)(*(_QWORD *)this + *((_QWORD *)this + 1));
        }
        else
        {
          v21 = (_BYTE *)(v19 + v17);
          if ( __CFADD__(v17, v14) )
          {
            *((_QWORD *)this + 1) = v20;
            *(_BYTE *)(v19 + v20) = 0;
            v21 = (_BYTE *)(*(_QWORD *)this + *((_QWORD *)this + 1));
          }
        }
        v22 = v21 - 1;
        v23 = (char *)(v19 + v17 - 1);
        if ( v23 < v21 - 1 )
        {
          while ( 1 )
          {
            while ( 1 )
            {
              v24 = *v23;
              if ( *v23 == 11 )
              {
                *v23 = 10;
                *(v21 - 1) = 49;
                v24 = *v23;
                v22 = v21 - 2;
              }
              if ( v24 == 10 )
                break;
              *v22 = v24;
              if ( v22 - 1 <= --v23 )
                goto LABEL_2;
              v21 = v22--;
            }
            --v23;
            *v18 = v22 + 1;
            *v22 = v23[1];
            if ( v22 - 1 <= v23 )
              break;
            --v18;
            v21 = v22--;
          }
        }
      }
    }
  }
  std::__throw_system_error(v4);
}
// 402190: using guessed type __int64 __fastcall std::condition_variable::wait(_QWORD, _QWORD);

//----- (0000000000403070) ----------------------------------------------------
void __fastcall __noreturn std::thread::_State_impl<std::thread::_Invoker<std::tuple<main::{lambda(worker *)#1},worker *>>>::_M_run(
        __int64 a1)
{
  worker::loop(*(worker **)(a1 + 8));
}

//----- (0000000000403080) ----------------------------------------------------
void __fastcall worker::worker(
        worker *this,
        unsigned __int64 a2,
        unsigned __int64 a3,
        unsigned __int64 a4,
        __m128 _XMM0)
{
  char *v11; // rax
  unsigned __int64 v13; // rdx
  unsigned int v14; // esi
  unsigned __int64 v15; // rcx
  unsigned int v16; // eax
  __int64 *v17; // rsi
  unsigned int v18; // ecx
  unsigned __int64 v19; // rax
  unsigned __int64 v20; // r8
  char v21; // r9
  __int64 v22; // rdx
  char v23; // al
  __int64 v24; // r13
  unsigned __int64 v25; // rdx
  unsigned __int64 v26; // r13
  unsigned __int64 v27; // r13
  char *v28; // rax
  char *v29; // r15
  char *v30; // r14
  __int64 v31; // rax
  __int64 *v32; // rdi
  signed __int64 v33; // r8
  __int64 *v34; // rsi
  __int64 v36; // rax
  __int64 v37; // rax
  __int64 *v38; // rdx
  __int64 v39; // rsi
  __int64 v40; // rcx
  unsigned __int64 v43; // rbp
  size_t v44; // rsi
  unsigned __int64 v45; // r15
  unsigned __int64 v46; // rdx
  size_t v47; // rax
  void *v48; // rax
  __int64 *v49; // rsi
  size_t v50; // rsi
  unsigned __int64 v51; // rdx
  size_t v52; // rax
  unsigned __int64 v53; // rdx
  unsigned int v54; // esi
  unsigned __int64 v55; // rcx
  unsigned int v56; // eax
  __int64 *v57; // rdi
  unsigned int v58; // esi
  unsigned __int64 v59; // rcx
  unsigned __int64 v60; // rax
  unsigned __int64 v61; // r9
  char v62; // r10
  __int64 v63; // rdx
  char v64; // al
  __int64 v65; // rcx
  size_t v67; // rcx
  size_t v68; // r8
  size_t v69; // rsi
  char *v70; // rdi
  unsigned __int64 v71; // r10
  unsigned __int64 v72; // rax
  char *v73; // rdi
  size_t v74; // rsi
  unsigned __int64 v75; // rdx
  size_t v76; // rax
  __int64 *v77; // rax
  __int64 *v78; // rax
  size_t v79; // rdx
  __int64 *v81; // rax
  __int64 *v82; // rax
  size_t v83; // rdx
  __int64 *v84; // rdi
  size_t v85; // r14
  __int64 *v86; // rdi
  char *v87; // [rsp+0h] [rbp-B8h]
  __int64 v88; // [rsp+10h] [rbp-A8h]
  size_t v89; // [rsp+18h] [rbp-A0h]
  size_t v90; // [rsp+18h] [rbp-A0h]
  size_t v91; // [rsp+18h] [rbp-A0h]
  size_t v92; // [rsp+18h] [rbp-A0h]
  __int64 *v93; // [rsp+20h] [rbp-98h]
  int v94; // [rsp+28h] [rbp-90h]
  __int64 v95[2]; // [rsp+30h] [rbp-88h] BYREF
  void *src; // [rsp+40h] [rbp-78h]
  size_t n; // [rsp+48h] [rbp-70h]
  __int128 v98; // [rsp+50h] [rbp-68h] BYREF
  void *v99; // [rsp+60h] [rbp-58h] BYREF
  size_t v100; // [rsp+68h] [rbp-50h]
  __int64 v101[9]; // [rsp+70h] [rbp-48h] BYREF

  __asm { vpxor   xmm0, xmm0, xmm0 }
  _RBX = this;
  __asm
  {
    vmovdqu xmmword ptr [rdi+20h], xmm0
    vpxor   xmm0, xmm0, xmm0
  }
  *(_QWORD *)this = (char *)this + 16;
  v87 = (char *)this + 16;
  *((_QWORD *)this + 1) = 0LL;
  v11 = (char *)this + 32;
  _RDI = (worker *)((char *)this + 104);
  *((_BYTE *)_RDI - 88) = 0;
  *((_QWORD *)_RDI - 7) = 0LL;
  *((_DWORD *)_RDI - 12) = 0;
  *((_BYTE *)_RDI - 44) = 0;
  __asm
  {
    vmovdqu xmmword ptr [rdi-28h], xmm0
    vmovdqu xmmword ptr [rdi-18h], xmm0
  }
  *((_QWORD *)_RDI - 1) = 0LL;
  v88 = (__int64)v11;
  std::condition_variable::condition_variable(_RDI);
  *((_QWORD *)_RBX + 19) = 0LL;
  *((_QWORD *)_RBX + 20) = 0LL;
  *((_QWORD *)_RBX + 21) = 0LL;
  *((_QWORD *)_RBX + 22) = 0LL;
  *((_QWORD *)_RBX + 23) = 0LL;
  if ( a4 <= 9 )
  {
    v93 = v95;
    goto LABEL_123;
  }
  if ( a4 <= 0x63 )
  {
    v85 = 2LL;
    v93 = v95;
    v86 = v95;
    goto LABEL_108;
  }
  if ( a4 <= 0x3E7 )
  {
    v85 = 3LL;
    v93 = v95;
    v86 = v95;
    goto LABEL_108;
  }
  v13 = a4;
  v14 = 1;
  if ( a4 <= 0x270F )
  {
    v85 = 4LL;
    v93 = v95;
    v86 = v95;
LABEL_108:
    memset(v86, 0, v85);
    v82 = v93;
    goto LABEL_109;
  }
  do
  {
    v15 = v13;
    v16 = v14;
    v14 += 4;
    v13 /= 0x2710uLL;
    if ( v15 <= 0x1869F )
    {
      v85 = v14;
      goto LABEL_11;
    }
    if ( v15 <= 0xF423F )
    {
      v85 = v16 + 5;
      goto LABEL_11;
    }
    if ( v15 <= 0x98967F )
    {
      v85 = v16 + 6;
      goto LABEL_11;
    }
  }
  while ( v15 > 0x5F5E0FF );
  v85 = v16 + 7;
LABEL_11:
  v93 = v95;
  if ( v85 > 0xF )
  {
    v81 = (__int64 *)operator new(v85 + 1);
    v95[0] = v85;
    v86 = v81;
    v93 = v81;
    goto LABEL_108;
  }
  if ( v85 )
  {
    if ( v85 != 1 )
    {
      v86 = v95;
      goto LABEL_108;
    }
LABEL_123:
    v82 = v95;
    LOBYTE(v95[0]) = 0;
    v85 = 1LL;
LABEL_109:
    v94 = v85;
    *((_BYTE *)v82 + v85) = 0;
    v17 = v93;
    v18 = v85 - 1;
    if ( a4 <= 0x63 )
      goto LABEL_15;
    goto LABEL_14;
  }
  v17 = v95;
  v94 = 0;
  LOBYTE(v95[0]) = 0;
  v18 = -1;
  do
  {
LABEL_14:
    v19 = a4 % 0x64;
    v20 = a4;
    a4 /= 0x64uLL;
    v19 *= 2LL;
    v21 = byte_405141[v19];
    LOBYTE(v19) = std::__detail::__to_chars_10_impl<unsigned long>(char *,unsigned int,unsigned long)::__digits[v19];
    *((_BYTE *)v17 + v18) = v21;
    v22 = v18 - 1;
    v18 -= 2;
    *((_BYTE *)v17 + v22) = v19;
  }
  while ( v20 > 0x270F );
LABEL_15:
  v23 = a4 + 48;
  if ( a4 > 9 )
  {
    v24 = 2 * a4;
    *((_BYTE *)v17 + 1) = byte_405141[v24];
    v23 = std::__detail::__to_chars_10_impl<unsigned long>(char *,unsigned int,unsigned long)::__digits[v24];
  }
  *(_BYTE *)v17 = v23;
  *((_DWORD *)_RBX + 14) = v94 + 1;
  *((_BYTE *)_RBX + 60) = *(_BYTE *)v93 - 48;
  v25 = 239 * a3 / 0xF + 1;
  if ( *(char **)_RBX == v87 )
    v26 = 15LL;
  else
    v26 = *((_QWORD *)_RBX + 2);
  if ( v25 > v26 )
  {
    v27 = 2 * v26;
    if ( v27 < v25 )
      v27 = 239 * a3 / 0xF + 1;
    v28 = (char *)operator new(v27 + 1);
    v29 = *(char **)_RBX;
    v30 = v28;
    v31 = *((_QWORD *)_RBX + 1);
    if ( v31 )
    {
      if ( v31 != -1 )
        memcpy(v30, *(const void **)_RBX, v31 + 1);
    }
    else
    {
      *v30 = *v29;
    }
    if ( v29 != v87 )
      operator delete(v29, *((_QWORD *)_RBX + 2) + 1LL);
    *(_QWORD *)_RBX = v30;
    *((_QWORD *)_RBX + 2) = v27;
  }
  if ( a3 >> 60 )
    std::__throw_length_error("vector::reserve");
  v32 = (__int64 *)*((_QWORD *)_RBX + 4);
  v33 = *((_QWORD *)_RBX + 6) - (_QWORD)v32;
  if ( a3 > v33 >> 3 )
  {
    v34 = (__int64 *)*((_QWORD *)_RBX + 5);
    _R15 = 0LL;
    if ( a3 )
    {
      v36 = operator new(8 * a3);
      v32 = (__int64 *)*((_QWORD *)_RBX + 4);
      v34 = (__int64 *)*((_QWORD *)_RBX + 5);
      _R15 = v36;
      v33 = *((_QWORD *)_RBX + 6) - (_QWORD)v32;
    }
    if ( v32 != v34 )
    {
      v37 = _R15;
      v38 = v32;
      v39 = _R15 + (char *)v34 - (char *)v32;
      do
      {
        v40 = *v38;
        v37 += 8LL;
        ++v38;
        *(_QWORD *)(v37 - 8) = v40;
      }
      while ( v37 != v39 );
    }
    if ( v32 )
      operator delete(v32, v33);
    __asm
    {
      vmovq   xmm1, r15
      vpinsrq xmm0, xmm1, r13, 1
    }
    *((_QWORD *)_RBX + 6) = 8 * a3 + _R15;
    __asm { vmovdqu xmmword ptr [rbx+20h], xmm0 }
  }
  v43 = a2 + a3;
  if ( a2 < v43 )
  {
    while ( 1 )
    {
      if ( 0xEEEEEEEEEEEEEEEFLL * a2 <= 0x1111111111111111LL )
      {
        v50 = *((_QWORD *)_RBX + 1);
        if ( 0x7FFFFFFFFFFFFFFFLL - v50 <= 8 )
          goto LABEL_131;
        v45 = v50 + 9;
        if ( v87 == *(char **)_RBX )
          v51 = 15LL;
        else
          v51 = *((_QWORD *)_RBX + 2);
        if ( v45 > v51 )
        {
          std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_mutate(
            (__int64)_RBX,
            v50,
            0LL,
            "FizzBuzz\n",
            9uLL);
        }
        else
        {
          v52 = v50 + *(_QWORD *)_RBX;
          *(_QWORD *)v52 = 0x7A7A75427A7A6946LL;
          *(_BYTE *)(v52 + 8) = 10;
        }
      }
      else if ( 0xCCCCCCCCCCCCCCCDLL * a2 <= 0x3333333333333333LL )
      {
        v74 = *((_QWORD *)_RBX + 1);
        if ( 0x7FFFFFFFFFFFFFFFLL - v74 <= 4 )
LABEL_131:
          std::__throw_length_error("basic_string::append");
        v45 = v74 + 5;
        if ( v87 == *(char **)_RBX )
          v75 = 15LL;
        else
          v75 = *((_QWORD *)_RBX + 2);
        if ( v45 > v75 )
        {
          std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_mutate(
            (__int64)_RBX,
            v74,
            0LL,
            "Buzz\n",
            5uLL);
        }
        else
        {
          v76 = v74 + *(_QWORD *)_RBX;
          *(_DWORD *)v76 = 2054845762;
          *(_BYTE *)(v76 + 4) = 10;
        }
      }
      else
      {
        if ( 0xAAAAAAAAAAAAAAABLL * a2 > 0x5555555555555555LL )
        {
          if ( a2 <= 9 )
          {
            v99 = v101;
            goto LABEL_120;
          }
          if ( a2 <= 0x63 )
          {
            v83 = 2LL;
            v99 = v101;
            v84 = v101;
          }
          else if ( a2 <= 0x3E7 )
          {
            v83 = 3LL;
            v99 = v101;
            v84 = v101;
          }
          else
          {
            v53 = a2;
            v54 = 1;
            if ( a2 <= 0x270F )
            {
              v83 = 4LL;
              v99 = v101;
              v84 = v101;
              goto LABEL_99;
            }
            do
            {
              v55 = v53;
              v56 = v54;
              v54 += 4;
              v53 /= 0x2710uLL;
              if ( v55 <= 0x1869F )
              {
                v83 = v54;
                goto LABEL_68;
              }
              if ( v55 <= 0xF423F )
              {
                v83 = v56 + 5;
                goto LABEL_68;
              }
              if ( v55 <= 0x98967F )
              {
                v83 = v56 + 6;
                goto LABEL_68;
              }
            }
            while ( v55 > 0x5F5E0FF );
            v83 = v56 + 7;
LABEL_68:
            v99 = v101;
            if ( v83 > 0xF )
            {
              v91 = v83;
              v77 = (__int64 *)operator new(v83 + 1);
              v83 = v91;
              v84 = v77;
              v99 = v77;
              v101[0] = v91;
            }
            else
            {
              if ( !v83 )
              {
                v100 = 0LL;
                LOBYTE(v101[0]) = 0;
                v57 = v101;
                v58 = -1;
LABEL_71:
                v59 = a2;
                do
                {
                  v60 = v59 % 0x64;
                  v61 = v59;
                  v59 /= 0x64uLL;
                  v60 *= 2LL;
                  v62 = byte_405141[v60];
                  LOBYTE(v60) = std::__detail::__to_chars_10_impl<unsigned long>(char *,unsigned int,unsigned long)::__digits[v60];
                  *((_BYTE *)v57 + v58) = v62;
                  v63 = v58 - 1;
                  v58 -= 2;
                  *((_BYTE *)v57 + v63) = v60;
                }
                while ( v61 > 0x270F );
LABEL_73:
                v64 = v59 + 48;
                if ( v59 > 9 )
                {
                  v65 = 2 * v59;
                  *((_BYTE *)v57 + 1) = byte_405141[v65];
                  v64 = std::__detail::__to_chars_10_impl<unsigned long>(char *,unsigned int,unsigned long)::__digits[v65];
                }
                *(_BYTE *)v57 = v64;
                _RAX = (void **)std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_replace_aux(
                                  &v99,
                                  v100,
                                  0LL,
                                  1uLL,
                                  10);
                src = &v98;
                if ( *_RAX == _RAX + 2 )
                {
                  __asm
                  {
                    vmovdqu xmm2, xmmword ptr [rax+10h]
                    vmovdqa [rsp+0B8h+var_68], xmm2
                  }
                }
                else
                {
                  src = *_RAX;
                  *(_QWORD *)&v98 = _RAX[2];
                }
                v67 = (size_t)_RAX[1];
                *((_BYTE *)_RAX + 16) = 0;
                n = v67;
                _RAX[1] = 0LL;
                v68 = n;
                v69 = *((_QWORD *)_RBX + 1);
                *_RAX = _RAX + 2;
                v70 = *(char **)_RBX;
                v71 = v68 + v69;
                if ( v87 == *(char **)_RBX )
                  v72 = 15LL;
                else
                  v72 = *((_QWORD *)_RBX + 2);
                if ( v71 > v72 )
                {
                  v90 = v68 + v69;
                  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_mutate(
                    (__int64)_RBX,
                    v69,
                    0LL,
                    src,
                    v68);
                  v70 = *(char **)_RBX;
                  v71 = v90;
                }
                else if ( v68 )
                {
                  v73 = &v70[v69];
                  if ( v68 == 1 )
                  {
                    *v73 = *(_BYTE *)src;
                    v70 = *(char **)_RBX;
                  }
                  else
                  {
                    v89 = v68 + v69;
                    memcpy(v73, src, v68);
                    v70 = *(char **)_RBX;
                    v71 = v89;
                  }
                }
                *((_QWORD *)_RBX + 1) = v71;
                v70[v71] = 0;
                if ( src != &v98 )
                  operator delete(src, v98 + 1);
                if ( v99 != v101 )
                  operator delete(v99, v101[0] + 1);
                goto LABEL_48;
              }
              if ( v83 == 1 )
              {
LABEL_120:
                LOBYTE(v101[0]) = 0;
                v78 = v101;
                v79 = 1LL;
LABEL_100:
                v100 = v79;
                *((_BYTE *)v78 + v79) = 0;
                v57 = (__int64 *)v99;
                v59 = a2;
                v58 = v100 - 1;
                if ( a2 > 0x63 )
                  goto LABEL_71;
                goto LABEL_73;
              }
              v84 = v101;
            }
          }
LABEL_99:
          v92 = v83;
          memset(v84, 0, v83);
          v78 = (__int64 *)v99;
          v79 = v92;
          goto LABEL_100;
        }
        v44 = *((_QWORD *)_RBX + 1);
        if ( 0x7FFFFFFFFFFFFFFFLL - v44 <= 4 )
          goto LABEL_131;
        v45 = v44 + 5;
        if ( v87 == *(char **)_RBX )
          v46 = 15LL;
        else
          v46 = *((_QWORD *)_RBX + 2);
        if ( v45 > v46 )
        {
          std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_mutate(
            (__int64)_RBX,
            v44,
            0LL,
            "Fizz\n",
            5uLL);
        }
        else
        {
          v47 = v44 + *(_QWORD *)_RBX;
          *(_DWORD *)v47 = 2054842694;
          *(_BYTE *)(v47 + 4) = 10;
        }
      }
      *((_QWORD *)_RBX + 1) = v45;
      *(_BYTE *)(*(_QWORD *)_RBX + v45) = 0;
LABEL_48:
      v48 = (void *)(*(_QWORD *)_RBX + *((_QWORD *)_RBX + 1));
      v49 = (__int64 *)*((_QWORD *)_RBX + 5);
      v99 = v48;
      if ( v49 == *((__int64 **)_RBX + 6) )
      {
        ++a2;
        std::vector<__gnu_cxx::__normal_iterator<char *,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>::_M_realloc_insert<__gnu_cxx::__normal_iterator<char *,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>(
          v88,
          v49,
          &v99);
        if ( a2 >= v43 )
          break;
      }
      else
      {
        *v49 = (__int64)v48;
        ++a2;
        *((_QWORD *)_RBX + 5) = v49 + 1;
        if ( v43 <= a2 )
          break;
      }
    }
  }
  *((_QWORD *)_RBX + 21) = *(_QWORD *)_RBX;
  if ( v93 != v95 )
    operator delete(v93, v95[0] + 1);
}

//----- (0000000000403B70) ----------------------------------------------------
std::__cxx11 *__fastcall std::__cxx11::to_string(std::__cxx11 *this, unsigned __int64 a2)
{
  char *v3; // rdi
  unsigned __int64 v4; // rbx
  unsigned __int64 v5; // rdx
  unsigned int v6; // esi
  unsigned __int64 v7; // rcx
  unsigned int v8; // eax
  char *v9; // rsi
  unsigned int v10; // ecx
  unsigned __int64 v11; // rax
  unsigned __int64 v12; // rdi
  char v13; // r9
  __int64 v14; // rdx
  char v15; // al
  __int64 v16; // rbx
  char *v18; // rax
  char *v19; // rax
  size_t v20; // rbp

  v3 = (char *)this + 16;
  v4 = a2;
  if ( a2 <= 9 )
  {
    *(_QWORD *)this = v3;
    goto LABEL_26;
  }
  if ( a2 <= 0x63 )
  {
    *(_QWORD *)this = v3;
    v20 = 2LL;
    goto LABEL_19;
  }
  if ( a2 <= 0x3E7 )
  {
    *(_QWORD *)this = v3;
    v20 = 3LL;
    goto LABEL_19;
  }
  v5 = a2;
  v6 = 1;
  if ( v4 <= 0x270F )
  {
    *(_QWORD *)this = v3;
    v20 = 4LL;
LABEL_19:
    memset(v3, 0, v20);
    v19 = *(char **)this;
    goto LABEL_20;
  }
  do
  {
    v7 = v5;
    v8 = v6;
    v6 += 4;
    v5 /= 0x2710uLL;
    if ( v7 <= 0x1869F )
    {
      v20 = v6;
      goto LABEL_11;
    }
    if ( v7 <= 0xF423F )
    {
      v20 = v8 + 5;
      goto LABEL_11;
    }
    if ( v7 <= 0x98967F )
    {
      v20 = v8 + 6;
      goto LABEL_11;
    }
  }
  while ( v7 > 0x5F5E0FF );
  v20 = v8 + 7;
LABEL_11:
  *(_QWORD *)this = v3;
  if ( v20 > 0xF )
  {
    v18 = (char *)operator new(v20 + 1);
    *((_QWORD *)this + 2) = v20;
    v3 = v18;
    *(_QWORD *)this = v18;
    goto LABEL_19;
  }
  if ( v20 )
  {
    if ( v20 != 1 )
      goto LABEL_19;
LABEL_26:
    v19 = *(char **)this;
    *((_BYTE *)this + 16) = 0;
    v20 = 1LL;
LABEL_20:
    *((_QWORD *)this + 1) = v20;
    v19[v20] = 0;
    v9 = *(char **)this;
    v10 = *((_DWORD *)this + 2) - 1;
    if ( v4 <= 0x63 )
      goto LABEL_15;
    goto LABEL_14;
  }
  *((_QWORD *)this + 1) = 0LL;
  *((_BYTE *)this + 16) = 0;
  v9 = v3;
  v10 = -1;
  do
  {
LABEL_14:
    v11 = v4 % 0x64;
    v12 = v4;
    v4 /= 0x64uLL;
    v11 *= 2LL;
    v13 = byte_405141[v11];
    LOBYTE(v11) = std::__detail::__to_chars_10_impl<unsigned long>(char *,unsigned int,unsigned long)::__digits[v11];
    v9[v10] = v13;
    v14 = v10 - 1;
    v10 -= 2;
    v9[v14] = v11;
  }
  while ( v12 > 0x270F );
LABEL_15:
  v15 = v4 + 48;
  if ( v4 > 9 )
  {
    v16 = 2 * v4;
    v9[1] = byte_405141[v16];
    v15 = std::__detail::__to_chars_10_impl<unsigned long>(char *,unsigned int,unsigned long)::__digits[v16];
  }
  *v9 = v15;
  return this;
}

//----- (0000000000403D90) ----------------------------------------------------
void __fastcall std::vector<std::unique_ptr<worker>>::_M_realloc_insert<std::unique_ptr<worker>>(
        __int64 a1,
        __int64 *a2,
        __int64 *a3)
{
  __int64 *v3; // r15
  __int64 v5; // rcx
  __int64 v6; // rax
  bool v10; // cf
  unsigned __int64 v11; // rax
  char *v12; // r8
  __int64 v13; // rcx
  __int64 *v14; // r12
  __int64 v16; // rax
  char *v17; // rcx
  unsigned __int64 v18; // rdx
  unsigned __int64 v20; // rdx
  unsigned __int64 v22; // rax
  __int64 *v23; // rsi
  __int64 *v24; // rax
  unsigned __int64 v27; // r12
  __int64 *v28; // rax
  __int64 *v29; // rdx
  char *v30; // rax
  __int64 v31; // rsi

  v3 = *(__int64 **)(a1 + 8);
  _RBP = *(__int64 **)a1;
  v5 = ((__int64)v3 - *(_QWORD *)a1) >> 3;
  if ( v5 == 0xFFFFFFFFFFFFFFFLL )
    std::__throw_length_error("vector::_M_realloc_insert");
  v6 = 1LL;
  if ( v5 )
    v6 = (__int64)(*(_QWORD *)(a1 + 8) - *(_QWORD *)a1) >> 3;
  _R14 = a1;
  v10 = __CFADD__(v5, v6);
  v11 = v5 + v6;
  v12 = (char *)((char *)a2 - (char *)_RBP);
  if ( v10 )
  {
    v27 = 0xFFFFFFFFFFFFFFFLL;
  }
  else
  {
    if ( !v11 )
    {
      v13 = 8LL;
      v14 = 0LL;
      _RBX = 0LL;
      goto LABEL_7;
    }
    if ( v11 > 0xFFFFFFFFFFFFFFFLL )
      v11 = 0xFFFFFFFFFFFFFFFLL;
    v27 = v11;
  }
  v28 = (__int64 *)operator new(v27 * 8);
  v12 = (char *)((char *)a2 - (char *)_RBP);
  _RBX = (char *)v28;
  v14 = &v28[v27];
  v13 = (__int64)(v28 + 1);
LABEL_7:
  v16 = *a3;
  *a3 = 0LL;
  *(_QWORD *)&v12[(_QWORD)_RBX] = v16;
  if ( a2 != _RBP )
  {
    v17 = (char *)((char *)a2 - (char *)_RBP);
    v18 = (char *)a2 - (char *)_RBP - 8;
    if ( _RBX == (char *)(_RBP + 1) || v18 <= 0x10 )
    {
      v29 = _RBP;
      v30 = _RBX;
      do
      {
        v31 = *v29;
        v30 += 8;
        ++v29;
        *((_QWORD *)v30 - 1) = v31;
      }
      while ( v30 != &v17[(_QWORD)_RBX] );
    }
    else
    {
      _RAX = 0LL;
      v20 = (v18 >> 3) + 1;
      do
      {
        __asm
        {
          vmovdqu xmm1, xmmword ptr [rbp+rax+0]
          vmovdqu xmmword ptr [rbx+rax], xmm1
        }
        _RAX += 16LL;
      }
      while ( 16 * (v20 >> 1) != _RAX );
      v22 = v20 & 0xFFFFFFFFFFFFFFFELL;
      v23 = (__int64 *)&_RBX[v22 * 8];
      v24 = &_RBP[v22];
      if ( v20 != (v20 & 0xFFFFFFFFFFFFFFFELL) )
        *v23 = *v24;
    }
    v13 = (__int64)&v17[(_QWORD)_RBX + 8];
  }
  if ( a2 != v3 )
    memcpy((void *)v13, a2, (char *)v3 - (char *)a2);
  __asm
  {
    vmovq   xmm2, rbx
    vpinsrq xmm0, xmm2, rcx, 1
  }
  if ( _RBP )
  {
    __asm { vmovdqa [rsp+58h+var_58], xmm0 }
    operator delete(_RBP, *(_QWORD *)(a1 + 16) - (_QWORD)_RBP);
    __asm { vmovdqa xmm0, [rsp+58h+var_58] }
  }
  __asm { vmovdqu xmmword ptr [r14], xmm0 }
  *(_QWORD *)(a1 + 16) = v14;
}

//----- (0000000000403F80) ----------------------------------------------------
void __fastcall std::vector<std::unique_ptr<std::thread>>::_M_realloc_insert<std::unique_ptr<std::thread>>(
        __int64 a1,
        __int64 *a2,
        _QWORD *a3)
{
  __int64 *v3; // r15
  __int64 v5; // rax
  __int64 v6; // rcx
  bool v9; // cf
  unsigned __int64 v10; // rax
  char *v11; // rsi
  __int64 v12; // rcx
  __int64 *v13; // rbx
  __int64 v15; // rax
  char *v16; // rcx
  unsigned __int64 v17; // rdx
  unsigned __int64 v19; // rdx
  unsigned __int64 v21; // rax
  __int64 *v22; // rsi
  __int64 *v23; // rax
  unsigned __int64 v26; // rbx
  __int64 *v27; // rax
  __int64 *v28; // rdx
  char *v29; // rax
  __int64 v30; // rsi
  _QWORD *v32; // [rsp+18h] [rbp-40h]

  v3 = *(__int64 **)(a1 + 8);
  _RBP = *(__int64 **)a1;
  v5 = ((__int64)v3 - *(_QWORD *)a1) >> 3;
  if ( v5 == 0xFFFFFFFFFFFFFFFLL )
    std::__throw_length_error("vector::_M_realloc_insert");
  v6 = 1LL;
  _R14 = a1;
  if ( v5 )
    v6 = (__int64)(*(_QWORD *)(a1 + 8) - *(_QWORD *)a1) >> 3;
  v9 = __CFADD__(v6, v5);
  v10 = v6 + v5;
  v11 = (char *)((char *)a2 - (char *)_RBP);
  if ( v9 )
  {
    v26 = 0xFFFFFFFFFFFFFFFLL;
  }
  else
  {
    if ( !v10 )
    {
      v12 = 8LL;
      v13 = 0LL;
      _R12 = 0LL;
      goto LABEL_7;
    }
    if ( v10 > 0xFFFFFFFFFFFFFFFLL )
      v10 = 0xFFFFFFFFFFFFFFFLL;
    v26 = v10;
  }
  v32 = a3;
  v27 = (__int64 *)operator new(v26 * 8);
  a3 = v32;
  _R12 = (char *)v27;
  v13 = &v27[v26];
  v12 = (__int64)(v27 + 1);
LABEL_7:
  v15 = *a3;
  *a3 = 0LL;
  *(_QWORD *)&v11[(_QWORD)_R12] = v15;
  if ( a2 != _RBP )
  {
    v16 = (char *)((char *)a2 - (char *)_RBP);
    v17 = (char *)a2 - (char *)_RBP - 8;
    if ( _R12 == (char *)(_RBP + 1) || v17 <= 0x10 )
    {
      v28 = _RBP;
      v29 = _R12;
      do
      {
        v30 = *v28;
        v29 += 8;
        ++v28;
        *((_QWORD *)v29 - 1) = v30;
      }
      while ( v29 != &v16[(_QWORD)_R12] );
    }
    else
    {
      _RAX = 0LL;
      v19 = (v17 >> 3) + 1;
      do
      {
        __asm
        {
          vmovdqu xmm1, xmmword ptr [rbp+rax+0]
          vmovdqu xmmword ptr [r12+rax], xmm1
        }
        _RAX += 16LL;
      }
      while ( 16 * (v19 >> 1) != _RAX );
      v21 = v19 & 0xFFFFFFFFFFFFFFFELL;
      v22 = (__int64 *)&_R12[v21 * 8];
      v23 = &_RBP[v21];
      if ( v19 != (v19 & 0xFFFFFFFFFFFFFFFELL) )
        *v22 = *v23;
    }
    v12 = (__int64)&v16[(_QWORD)_R12 + 8];
  }
  if ( a2 != v3 )
    memcpy((void *)v12, a2, (char *)v3 - (char *)a2);
  __asm
  {
    vmovq   xmm2, r12
    vpinsrq xmm0, xmm2, rcx, 1
  }
  if ( _RBP )
  {
    __asm { vmovdqa [rsp+58h+var_58], xmm0 }
    operator delete(_RBP, *(_QWORD *)(a1 + 16) - (_QWORD)_RBP);
    __asm { vmovdqa xmm0, [rsp+58h+var_58] }
  }
  __asm { vmovdqu xmmword ptr [r14], xmm0 }
  *(_QWORD *)(a1 + 16) = v13;
}

//----- (0000000000404170) ----------------------------------------------------
void __fastcall std::vector<__gnu_cxx::__normal_iterator<char *,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>::_M_realloc_insert<__gnu_cxx::__normal_iterator<char *,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>(
        __int64 a1,
        __int64 *a2,
        _QWORD *a3)
{
  __int64 *v3; // r15
  __int64 *v4; // r12
  __int64 v5; // rax
  __int64 v6; // rcx
  bool v9; // cf
  unsigned __int64 v10; // rax
  char *v11; // rsi
  __int64 v12; // rcx
  char *v13; // rbx
  char *v15; // rax
  __int64 *v16; // rdx
  char *v17; // rcx
  __int64 v18; // rsi
  unsigned __int64 v21; // rbx
  char *v22; // rax
  _QWORD *v24; // [rsp+18h] [rbp-40h]

  v3 = *(__int64 **)(a1 + 8);
  v4 = *(__int64 **)a1;
  v5 = ((__int64)v3 - *(_QWORD *)a1) >> 3;
  if ( v5 == 0xFFFFFFFFFFFFFFFLL )
    std::__throw_length_error("vector::_M_realloc_insert");
  v6 = 1LL;
  _R13 = a1;
  if ( v5 )
    v6 = (__int64)(*(_QWORD *)(a1 + 8) - *(_QWORD *)a1) >> 3;
  v9 = __CFADD__(v6, v5);
  v10 = v6 + v5;
  v11 = (char *)((char *)a2 - (char *)v4);
  if ( v9 )
  {
    v21 = 0x7FFFFFFFFFFFFFF8LL;
  }
  else
  {
    if ( !v10 )
    {
      v12 = 8LL;
      v13 = 0LL;
      _R14 = 0LL;
      goto LABEL_7;
    }
    if ( v10 > 0xFFFFFFFFFFFFFFFLL )
      v10 = 0xFFFFFFFFFFFFFFFLL;
    v21 = 8 * v10;
  }
  v24 = a3;
  v22 = (char *)operator new(v21);
  a3 = v24;
  _R14 = v22;
  v13 = &v22[v21];
  v12 = (__int64)(v22 + 8);
LABEL_7:
  *(_QWORD *)&v11[(_QWORD)_R14] = *a3;
  if ( a2 != v4 )
  {
    v15 = _R14;
    v16 = v4;
    v17 = &_R14[(char *)a2 - (char *)v4];
    do
    {
      v18 = *v16;
      v15 += 8;
      ++v16;
      *((_QWORD *)v15 - 1) = v18;
    }
    while ( v17 != v15 );
    v12 = (__int64)(v17 + 8);
  }
  if ( a2 != v3 )
    memcpy((void *)v12, a2, (char *)v3 - (char *)a2);
  __asm
  {
    vmovq   xmm1, r14
    vpinsrq xmm0, xmm1, rcx, 1
  }
  if ( v4 )
  {
    __asm { vmovdqa [rsp+58h+var_58], xmm0 }
    operator delete(v4, *(_QWORD *)(a1 + 16) - (_QWORD)v4);
    __asm { vmovdqa xmm0, [rsp+58h+var_58] }
  }
  __asm { vmovdqu xmmword ptr [r13+0], xmm0 }
  *(_QWORD *)(a1 + 16) = v13;
}

//----- (00000000004042E0) ----------------------------------------------------
void __fastcall std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_mutate(
        __int64 a1,
        size_t a2,
        __int64 a3,
        _BYTE *a4,
        size_t a5)
{
  __int64 v7; // rax
  _BYTE *v8; // r13
  __int64 v9; // rbp
  unsigned __int64 v10; // rax
  __int64 v11; // rax
  _BYTE *v12; // rax
  _BYTE *v13; // r10
  _BYTE *v14; // r9
  _BYTE *v15; // r15
  _BYTE *v16; // rdi
  size_t v17; // rax
  _BYTE *v18; // rdi
  _BYTE *v19; // rsi
  size_t n; // [rsp+0h] [rbp-58h]
  _BYTE *srca; // [rsp+8h] [rbp-50h]
  _BYTE *srcb; // [rsp+8h] [rbp-50h]
  _BYTE *srcc; // [rsp+8h] [rbp-50h]
  size_t v25; // [rsp+10h] [rbp-48h]
  _BYTE *v26; // [rsp+18h] [rbp-40h]

  v7 = *(_QWORD *)(a1 + 8);
  v8 = (_BYTE *)(a1 + 16);
  v25 = a2 + a3;
  v9 = v7 + a5 - a3;
  n = v7 - (a2 + a3);
  if ( a1 + 16 == *(_QWORD *)a1 )
    v10 = 15LL;
  else
    v10 = *(_QWORD *)(a1 + 16);
  if ( v9 < 0 )
    std::__throw_length_error("basic_string::_M_create");
  if ( v9 > v10 )
  {
    v11 = 2 * v10;
    if ( v9 < (unsigned __int64)v11 )
    {
      if ( v11 < 0 )
        goto LABEL_22;
      v9 = v11;
    }
  }
  if ( v9 + 1 < 0 )
LABEL_22:
    std::__throw_bad_alloc();
  v12 = (_BYTE *)operator new(v9 + 1);
  v13 = *(_BYTE **)a1;
  v14 = a4;
  v15 = v12;
  if ( a2 )
  {
    if ( a2 == 1 )
    {
      *v12 = *v13;
    }
    else
    {
      v26 = a4;
      srca = *(_BYTE **)a1;
      memcpy(v12, *(const void **)a1, a2);
      v14 = v26;
      v13 = srca;
    }
  }
  if ( v14 && a5 )
  {
    v16 = &v15[a2];
    if ( a5 == 1 )
    {
      *v16 = *v14;
      v17 = n;
      if ( !n )
        goto LABEL_19;
      goto LABEL_17;
    }
    srcb = v13;
    memcpy(v16, v14, a5);
    v13 = srcb;
  }
  v17 = n;
  if ( !n )
    goto LABEL_19;
LABEL_17:
  v18 = &v15[a2 + a5];
  v19 = &v13[v25];
  if ( v17 == 1 )
  {
    *v18 = *v19;
    if ( v13 == v8 )
      goto LABEL_21;
    goto LABEL_20;
  }
  srcc = v13;
  memcpy(v18, v19, v17);
  v13 = srcc;
LABEL_19:
  if ( v13 != v8 )
LABEL_20:
    operator delete(v13, *(_QWORD *)(a1 + 16) + 1LL);
LABEL_21:
  *(_QWORD *)a1 = v15;
  *(_QWORD *)(a1 + 16) = v9;
}

//----- (00000000004044A0) ----------------------------------------------------
_QWORD *__fastcall std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_replace_aux(
        _QWORD *a1,
        size_t a2,
        __int64 a3,
        size_t a4,
        char a5)
{
  __int64 v6; // rcx
  _QWORD *v8; // rdi
  unsigned __int64 v11; // rbx
  unsigned __int64 v12; // rax
  size_t v13; // rcx
  char *v14; // rdi
  char *v15; // rsi
  char *v16; // rdi
  _BYTE *v17; // rdi
  _QWORD *result; // rax

  v6 = a1[1];
  if ( a4 > a3 + 0x7FFFFFFFFFFFFFFFLL - v6 )
    std::__throw_length_error("basic_string::_M_replace_aux");
  v8 = (_QWORD *)*a1;
  v11 = v6 + a4 - a3;
  if ( v8 == a1 + 2 )
    v12 = 15LL;
  else
    v12 = a1[2];
  if ( v12 < v11 )
  {
    std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>::_M_mutate(
      (__int64)a1,
      a2,
      a3,
      0LL,
      a4);
    v8 = (_QWORD *)*a1;
    if ( !a4 )
      goto LABEL_13;
  }
  else
  {
    v13 = v6 - (a3 + a2);
    if ( !v13 || a3 == a4 )
    {
LABEL_9:
      if ( !a4 )
        goto LABEL_13;
      goto LABEL_10;
    }
    v14 = (char *)v8 + a2;
    v15 = &v14[a3];
    v16 = &v14[a4];
    if ( v13 != 1 )
    {
      memmove(v16, v15, v13);
      v8 = (_QWORD *)*a1;
      goto LABEL_9;
    }
    *v16 = *v15;
    v8 = (_QWORD *)*a1;
    if ( !a4 )
      goto LABEL_13;
  }
LABEL_10:
  v17 = (char *)v8 + a2;
  if ( a4 == 1 )
    *v17 = a5;
  else
    memset(v17, a5, a4);
  v8 = (_QWORD *)*a1;
LABEL_13:
  a1[1] = v11;
  result = a1;
  *((_BYTE *)v8 + v11) = 0;
  return result;
}

// nfuncs=86 queued=14 decompiled=14 lumina nreq=0 worse=0 better=0
// ALL OK, 14 function(s) have been successfully decompiled

// subject_data_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__CloseHandle = &g_t4AD8; // 0000000000405010
<anonymous> * __imp__CreateFileMappingNumaW = &g_t4AE6; // 0000000000405018
<anonymous> * __imp__CreateFileW = &g_t4B00; // 0000000000405020
<anonymous> * __imp__DeviceIoControl = &g_t4B0E; // 0000000000405028
<anonymous> * __imp__ExitProcess = &g_t4B20; // 0000000000405030
<anonymous> * __imp__FlushFileBuffers = &g_t4B2E; // 0000000000405038
<anonymous> * __imp__FreeEnvironmentStringsW = &g_t4B42; // 0000000000405040
<anonymous> * __imp__GetCommandLineW = &g_t4B5C; // 0000000000405048
<anonymous> * __imp__GetEnvironmentStringsW = &g_t4B6E; // 0000000000405050
<anonymous> * __imp__GetFileInformationByHandle = &g_t4B88; // 0000000000405058
<anonymous> * __imp__GetFileInformationByHandleEx = &g_t4BA6; // 0000000000405060
<anonymous> * __imp__GetFileType = &g_t4BC6; // 0000000000405068
<anonymous> * __imp__GetLastError = &g_t4BD4; // 0000000000405070
<anonymous> * __imp__GetStdHandle = &g_t4BE4; // 0000000000405078
<anonymous> * __imp__GetSystemInfo = &g_t4BF4; // 0000000000405080
<anonymous> * __imp__MapViewOfFileExNuma = &g_t4C04; // 0000000000405088
<anonymous> * __imp__SetDefaultDllDirectories = &g_t4C1A; // 0000000000405090
<anonymous> * __imp__UnmapViewOfFile = &g_t4C36; // 0000000000405098
<anonymous> * __imp__WriteFile = &g_t4C48; // 00000000004050A0
// subject_data_0003.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

Eq_213 g_t436000 = // 0000000000436000
	{
		0x00
	};
word32 g_dw436004 = 0x00; // 0000000000436004
cu8 g_b436008 = 0x00; // 0000000000436008
byte g_b43603D = 0x00; // 000000000043603D
Eq_17 g_t4362B8 = // 00000000004362B8
	{
		0x00
	};
<anonymous> * g_ptr4362D0 = null; // 00000000004362D0
uint64 g_a4362E8[30] = // 00000000004362E8
	{
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
	};
word64 g_qw4363D8 = 0x00; // 00000000004363D8
word32 g_dw436750 = 0x00; // 0000000000436750
ui64 g_qw4367A0 = 0x00; // 00000000004367A0
word64 g_qw4367A8 = 0x00; // 00000000004367A8
uint64 g_qw4367B0 = 0x00; // 00000000004367B0
word64 g_qw4367B8 = 0x00; // 00000000004367B8
word64 g_qw4367C0 = 0x00; // 00000000004367C0
word32 g_dw4367C8 = 0x00; // 00000000004367C8
struct Eq_1226 * g_ptr4367E0 = null; // 00000000004367E0
word32 g_dw437DE0 = 0x00; // 0000000000437DE0
word32 g_dw437DE8 = 0x00; // 0000000000437DE8
word64 g_qw437DF0 = 0x00; // 0000000000437DF0
Eq_558 g_t437DF8 = null; // 0000000000437DF8
word32 g_dw437E08 = 0x00; // 0000000000437E08
Eq_558 g_t437E10 = null; // 0000000000437E10
word32 g_dw437E20 = 0x00; // 0000000000437E20
Eq_558 g_t437E28 = null; // 0000000000437E28
word32 g_dw437E38 = 0x00; // 0000000000437E38
struct _SYSTEM_INFO g_t437F80 = // 0000000000437F80
	{
		
		{
			
			{
				0x00,
				0x00,
			}
		},
		0x00,
		null,
		null,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
	};
up32 g_dw437FA8 = 0x00; // 0000000000437FA8
ui32 g_dw437FB4 = 0x00; // 0000000000437FB4
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000000401000: void fn0000000000401000(Register (ptr64 Eq_2) rbp)
// Called from:
//      fn0000000000403CBB
void fn0000000000401000(struct Eq_2 * rbp)
{
}

// 0000000000401158: Register word64 fn0000000000401158(Register (ptr64 ui64) rcx, Register ui64 rdx, Register word32 esi, Register uint64 rdi)
// Called from:
//      fn0000000000401000
word64 fn0000000000401158(ui64 * rcx, ui64 rdx, word32 esi, uint64 rdi)
{
	Eq_153 ecx_69 = 0x27;
	while (true)
	{
		esi = (word32) (uint64) (esi - 0x01);
		uint64 rax_17 = (uint64) ((word32) (rdi >> (byte) ecx_69) & 0x01FF);
		if (esi == ~0x00)
			break;
		ui64 * rdx_22 = rdx + rax_17 * 0x08;
		if (*rdx_22 == 0x00)
		{
			ui64 rax_27 = *rcx;
			*rcx = rax_27 - 0x1000;
			*rdx_22 = rax_27 - 0x1000 | 0x03;
		}
		ecx_69.u0 = (uint64) (ecx_69 - 0x09);
		rdx = *rdx_22 & 0x3FFFFFFFFF000;
	}
	return rdx + rax_17 * 0x08;
}

// 00000000004012F0: void fn00000000004012F0(Register Eq_203 ebx, Register Eq_204 r13, Register Eq_205 r15)
// Called from:
//      Win32CrtStartup
void fn00000000004012F0(Eq_203 ebx, Eq_204 r13, Eq_205 r15)
{
	Eq_206 ebx_317 = (word32) rbx;
	word64 edx_eax_11 = __rdtsc();
	Eq_213 eax_12 = (word32) edx_eax_11;
	g_t436000 = eax_12;
	g_dw436004 = SLICE(edx_eax_11, word32, 32);
	Eq_213 edx_17 = eax_12;
	struct Eq_221 * rdi_20 = &g_b436008;
	word64 * rsp_320 = fp - 44;
	Eq_206 eax_41 = 0x00;
l000000000040131D:
	__cpuid(eax_41, 0x00, &eax_41, &ebx_317, &0x00, &edx_17);
	rdi_20->qw0000 = (word64) eax_41;
	struct Eq_339 * rdi_54 = (char *) &rdi_20->qw0000 + 4;
	rdi_54->t0000 = ebx_317;
	rdi_54->dw0004 = 0x00;
	rdi_54->t0008 = edx_17;
	ebx_317 = eax_41;
	edx_17.u1 = 0x00;
	rdi_20 = (struct Eq_221 *) ((char *) &rdi_54->t0008 + 4);
	while (true)
	{
		word64 rax_72 = *rsp_320;
		eax_41 = (word32) rax_72;
		cu8 al_311 = (byte) rax_72;
		++rsp_320;
		if (eax_41 == 0x00)
			break;
		if (al_311 <= g_b436008)
			goto l000000000040131D;
		++rdi_20;
	}
	byte * rsi_162;
	rdi_20->qw0000 = (word64) r15;
	struct Eq_233 * rdi_90;
	Eq_234 rsi_91;
	Eq_235 rbx_88 = fn00000000004014BA(fp - 8, out rsi_91, out rdi_90);
	rdi_90->qw0000 = ~0x00;
	rdi_90->qw0008 = ~0x00;
	rdi_90->qw0010 = 4212270;
	struct Eq_258 * rsp_92 = (struct Eq_258 *) <invalid>;
	rsp_92->dwFFFFFFFC = 0x20;
	word64 * rdi_118;
	Eq_234 rsi_119 = fn000000000040150F(rsp_92->t0004, 0x00404434, rsi_91, &rdi_90->qw0010 + 1, out rdi_118);
	rsp_92->t0000.u1 = 0x20;
	struct Eq_285 * rdi_136;
	Eq_234 rsi_137 = fn000000000040150F(rsp_92->t0000, 4212092, rsi_119, rdi_118, out rdi_136);
	rdi_136->qw0000 = (word64) *r13;
	rdi_136->qw0008 = 0x00404690;
	rsp_92->t0000 = rbx_88;
	rsp_92->tFFFFFFF8 = rsi_137;
	if ((rdi_136->t0010 & 0x08) == 0x00)
	{
		if ((rdi_136->t0010 & 0x20) == 0x00)
		{
			if ((rdi_136->t0010 & 0x04) == 0x00)
			{
				if (*r15 != 0x00)
				{
					rsp_92->dwFFFFFFF4 = 0x00;
					rsp_92->tFFFFFFF0.u1 = 0x01;
					rsi_162 = &g_b404DA2;
				}
				else
				{
					rsp_92->dwFFFFFFF4 = 0x2A;
					rsp_92->tFFFFFFF0.u1 = 0x10;
					rsi_162 = &g_b404DC9;
				}
			}
			else
			{
				rsp_92->dwFFFFFFF4 = 0x22;
				rsp_92->tFFFFFFF0.u1 = 0x04;
				rsi_162 = &g_b404DF1;
			}
		}
		else
		{
			rsp_92->dwFFFFFFF4 = 0x30;
			rsp_92->tFFFFFFF0.u1 = 0x20;
			rsi_162 = &g_b404D79;
		}
	}
	else
	{
		rsp_92->dwFFFFFFF4 = 0x45;
		rsp_92->tFFFFFFF0.u1 = 0x08;
		rsi_162 = &g_b404E30;
	}
	rdi_136->t0010 = rsp_92->tFFFFFFF0;
	Eq_234 rax_204 = rsp_92->tFFFFFFF8;
	rdi_136->qw0018 = (word64) rax_204 + 0x00404310;
	rsp_92->tFFFFFFF8 = &rdi_136->qw0018 + 1;
	word56 rax_56_8_338 = SLICE((word64) rax_204 + 0x00404310, word56, 8);
	word64 * rdi_212;
	for (rdi_212 = g_a4362E8; rdi_212 < &g_qw4363D8; ++rdi_212)
	{
		uint64 rdx_263 = 0x00;
		Eq_479 ecx_362 = 0x00;
		do
		{
			ecx_362.u0 = (uint64) ((word64) ecx_362 + 7);
			ci8 al_269 = *rsi_162;
			++rsi_162;
			byte cl_294 = (byte) ecx_362;
			rdx_263 |= (uint64) ((word32) SEQ(rax_56_8_338, al_269) & 0x7F) << (byte) ecx_362;
		} while (al_269 < 0x00);
		if ((al_269 & 0x40) != 0x00)
			rdx_263 |= ~0x00 << cl_294;
		uint64 rax_300 = rdx_263;
		if (*rdi_212 != 0x00)
			rax_300 = *rdi_212;
		*rdi_212 = rax_300;
		rax_56_8_338 = SLICE(rax_300, word56, 8);
	}
	Eq_234 rdi_226 = rsp_92->tFFFFFFF8;
	GetSystemInfo(&g_t437F80);
	*rdi_226 = 0x00403817;
	fn0000000000401466();
	*((word64) rdi_226 + 8) = 0x00403312;
	*((word64) rdi_226 + 16) = 0x00403C02;
}

// 0000000000401460: Register word32 fn0000000000401460()
// Called from:
//      Win32CrtStartup
word32 fn0000000000401460()
{
	return 0x2A;
}

// 0000000000401466: Register word64 fn0000000000401466()
// Called from:
//      fn00000000004012F0
word64 fn0000000000401466()
{
	return fn0000000000403CBB();
}

// 00000000004014BA: Register word64 fn00000000004014BA(Register Eq_238 ebp, Register out ptr64 rsiOut, Register out ptr64 rdiOut)
// Called from:
//      fn00000000004012F0
//      Win32CrtStartup
word64 fn00000000004014BA(Eq_238 ebp, ptr64 & rsiOut, ptr64 & rdiOut)
{
	g_dw437DE0 = 0x03;
	g_qw437DF0 = 4423160;
	g_dw437DE8 = 0x10;
	g_dw437E08 = 0x01;
	g_dw437E20 = 0x01;
	g_dw437E38 = 0x01;
	g_t437DF8 = GetStdHandle(SEQ((word32) rbp, ~0x09));
	g_t437E10 = GetStdHandle(SEQ(dwLoc40, ~0x0A));
	g_t437E28 = GetStdHandle(SEQ(dwLoc3C, ~0x0B));
	rsiOut = SEQ(SLICE(rbp, word32, 32), SLICE(rdi, word32, 32));
	rdiOut = qwArg00;
	return SEQ((word32) rdi, SLICE(rsi, word32, 32));
}

// 000000000040150F: Register Eq_234 fn000000000040150F(Register Eq_235 ecx, Register uint64 rdx, Register Eq_234 rsi, Register (ptr64 word64) rdi, Register out ptr64 rdiOut)
// Called from:
//      fn00000000004012F0
Eq_234 fn000000000040150F(Eq_235 ecx, uint64 rdx, Eq_234 rsi, word64 * rdi, ptr64 & rdiOut)
{
	int8 r8b_4 = (int8) Z;
	do
	{
		*rdi = (uint64) *rsi + rdx;
		rsi = (word64) rsi + 1;
		++rdi;
		ecx = (word32) (uint64) (ecx - 0x01);
	} while (ecx != 0x00);
	*rdi = (uint64) *((word64) rsi + (uint64) ((int8) ((g_b43603D & 0x02) != 0x00) | r8b_4 << 0x01)) + rdx;
	rdiOut = rdi + 1;
	return (word64) rsi + 8;
}

// 000000000040153D: void fn000000000040153D(Register word32 edi)
// Called from:
//      Win32CrtStartup
void fn000000000040153D(word32 edi)
{
	fn00000000004041E6(0x00);
	fn00000000004046C1((byte) (uint64) (word32) (uint64) edi);
}

// 0000000000401577: Register Eq_553 Win32CrtStartup()
Eq_553 Win32CrtStartup()
{
	word64 rax_31;
	KernelBase.dll!SetDefaultDllDirectories();
	if ((word32) rax_31 != 0x00)
	{
		g_t4362B8.u1 = 0x04;
		GetCommandLineW();
		Eq_652 rax_64 = SEQ(dwLocE078, GetEnvironmentStringsW());
		fn000000000040180C((word64) fp - 53304, 0x3FFF, (word64) fp - 0x0000C037, 0x0200);
		uint64 rax_360 = 0x00;
		while (true)
		{
			byte * rcx_90 = qwLocD038 + rax_360;
			byte dl_91 = *rcx_90;
			if (dl_91 == 0x00)
				break;
			if (dl_91 == 0x5C)
				*rcx_90 = 0x2F;
			++rax_360;
		}
		word32 eax_112;
		uint64 rax_97 = (uint64) (word32) *rax_64;
		word32 eax_108 = (word32) rax_97;
		if ((word16) rax_97 <= 55295)
		{
			dwLocE04C = eax_108;
			eax_112 = 0x01;
		}
		else
			eax_112 = (word32) (uint64) fn000000000040436D((word64) fp - 0x0000E04C, rax_64);
		word64 rcx_118 = fp + ~0x8037;
		uint64 r8_123 = 0x00;
		Eq_652 rdx_125 = (word64) rax_64 + (uint64) eax_112 * 0x02;
		while (dwLocE04C != 0x00)
		{
			++r8_123;
			if (r8_123 <= 0x01FF)
			{
				Eq_660 rax_258 = 0x00;
				if (rcx_118 < fp - (struct Eq_1499 *) 0x3A)
					rax_258 = rcx_118;
				*((word64) fp + (r8_123 * 0x08 - 0x0000E040)) = rax_258;
			}
			do
			{
				up32 r9d_269 = (word32) (uint64) dwLocE04C;
				Eq_757 rax_271 = (int64) r9d_269;
				if (r9d_269 > 0x7F)
					rax_271 = fn000000000040437C(rcx_118, (word32) (uint64) r9d_269);
				do
				{
					byte al_288 = (byte) rax_542;
					if (rcx_118 >= fp - (struct Eq_1499 *) 0x3A)
						break;
					++rcx_118;
					*((word64) rcx_118 - 1) = al_288;
					rax_271 = rax_542 >> 0x08;
					rax_542 = rax_271;
				} while (rax_542 >> 0x08 != 0x00);
				word32 eax_320;
				uint64 rax_301 = (uint64) (word32) *rdx_125;
				word32 eax_314 = (word32) rax_301;
				if ((word16) rax_301 <= 55295)
				{
					dwLocE04C = eax_314;
					eax_320 = 0x01;
				}
				else
					eax_320 = SLICE(CONVERT(fn000000000040436D(fp + ~0xE04B, rdx_125), uint32, uint64), word32, 0);
				rdx_125 = (word64) rdx_125 + (uint64) eax_320 * 0x02;
			} while (r9d_269 != 0x00);
			word64 rax_342 = rcx_118 - (fp + ~0x8037);
			if (rax_342 > 0x7FFD)
				&rax_342.u0->t0000 = 0x7FFD;
			Mem355[fp + ~0x8037 + rax_342:byte] = 0x00;
		}
		if (rcx_118 < fp - 0x3A)
		{
			*rcx_118 = 0x00;
			++rcx_118;
		}
		word64 rcx_148 = rcx_118 - (fp + ~0x8037);
		if (rcx_148 > (struct Eq_770 *) 0x7FFE)
			rcx_148 = (struct Eq_770 *) 0x7FFE;
		if (r8_123 > 0x01FF)
			r8_123 = 0x01FF;
		Mem169[fp + ~0x8037 + rcx_148:byte] = 0x00;
		*((word64) fp + (r8_123 * 0x08 - 57400)) = 0x00;
		FreeEnvironmentStringsW(rax_64);
		__align(fp - 0xE074);
		fn00000000004012F0(0x00400000, fp + ~0xD037, fp + ~0xE047);
		g_dw437FB4 |= 0x01;
		struct Eq_258 * rsp_203 = (struct Eq_258 *) <invalid>;
		Eq_234 rax_213 = 0x00405008;
		Eq_234 rcx_215 = 0x00405008;
		while (rcx_215 != rax_213)
		{
			rsp_203->tFFFFFFF8 = rax_213;
			rsp_203->tFFFFFFF0 = rcx_215;
			(*rax_213)();
			rcx_215 = rsp_203->tFFFFFFF0;
			rax_213 = (word64) rsp_203->tFFFFFFF8 + 8;
		}
		fn000000000040153D((word32) (uint64) (word32) (uint64) fn0000000000401460());
	}
	else
	{
		WriteFile(GetStdHandle(~0x0B), &g_v4047B1, 0x06, (word64) fp - 0x00008038, SEQ(dwLocE060, 0x00));
		ExitProcess(0x01);
	}
}

// 00000000004017B1: void fn00000000004017B1(Register (ptr64 Eq_911) rdi)
// Called from:
//      fn000000000040180C
void fn00000000004017B1(struct Eq_911 * rdi)
{
	word32 eax_22;
	Eq_652 rdi_6 = rdi->t0000;
	uint64 rax_8 = (uint64) (word32) *rdi_6;
	word32 eax_18 = (word32) rax_8;
	if ((word16) rax_8 <= 55295)
	{
		rdi->dw0018 = eax_18;
		eax_22 = 0x01;
	}
	else
		eax_22 = (word32) (uint64) fn000000000040436D(&rdi->dw0018, rdi_6);
	rdi->t0000 = (word64) rdi->t0000 + (uint64) eax_22 * 0x02;
}

// 00000000004017DC: Register Eq_660 fn00000000004017DC(Register Eq_660 rcx, Register Eq_949 esi, Register (ptr64 Eq_950) rdi)
// Called from:
//      fn000000000040180C
Eq_660 fn00000000004017DC(Eq_660 rcx, Eq_949 esi, struct Eq_950 * rdi)
{
	Eq_949 esi = (word32) rsi;
	word32 edi_14 = (word32) (uint64) esi;
	Eq_660 r8_10 = rdi->t0010;
	Eq_757 rax_11 = (int64) esi;
	if (esi > 0x7F)
		rax_11 = fn000000000040437C(rcx, edi_14);
	do
	{
		byte al_29 = (byte) rax_69;
		Eq_660 rcx_23 = rdi->t0008;
		if (r8_10 <= rcx_23)
			return rcx_23;
		rdi->t0008 = (word64) rcx_23 + 1;
		*rcx_23 = al_29;
		rax_11 = rax_69 >> 0x08;
		rax_69 = rax_11;
	} while (rax_69 >> 0x08 != 0x00);
	return rcx_23;
}

// 000000000040180C: void fn000000000040180C(Register Eq_660 rcx, Register uint64 rdx, Register Eq_662 rsi, Register uint64 r8)
// Called from:
//      Win32CrtStartup
void fn000000000040180C(Eq_660 rcx, uint64 rdx, Eq_662 rsi, uint64 r8)
{
	fn00000000004017B1(fp - 88);
	Eq_662 rax_8 = (word64) rsi.u1 + rdx;
	uint64 rbx_116 = 0x00;
	rcx_236 = rcx;
l000000000040184F:
	Eq_660 rcx_236;
	if (dwLoc40 != 0x00)
	{
		while (true)
		{
			Eq_949 rax_56 = (uint64) dwLoc40;
			up32 eax_57 = (word32) rax_56;
			if (eax_57 == 0x00)
				break;
			if (eax_57 > 0x20 || __bt(0x100002600, rax_56))
			{
				++rbx_116;
				if (rbx_116 < r8)
				{
					Eq_662 rax_162 = rsi;
					if (rsi >= rax_8)
						rax_162.u0 = 0x00;
					(rcx - 0x08)[rbx_116] = rax_162;
				}
				Eq_1039 r14b_189 = 0x00;
				while (true)
				{
					Eq_949 rsi_184 = (uint64) dwLoc40;
					up32 esi_185 = (word32) rsi_184;
					if (esi_185 == 0x00)
						break;
					if (r14b_189 == 0x00 && esi_185 <= 0x20)
					{
						if (!__bt(0x100002600, rsi_184))
							break;
					}
					else if (esi_185 == 0x22 || esi_185 == 0x5C)
					{
						uint64 r12_201 = 0x00;
						while (true)
						{
							byte r12b_500 = (byte) r12_201;
							if (dwLoc40 != 0x5C)
								break;
							fn00000000004017B1(fp - 88);
							++r12_201;
						}
						uint64 r9_210 = 0x00;
						while (dwLoc40 == 0x22)
						{
							fn00000000004017B1(fp - 88);
							++r9_210;
						}
						uint64 rax_222 = r12_201;
						if (r9_210 != 0x00)
						{
							for (; rax_222 > 0x01; rax_222 -= 0x02)
								rcx_236 = fn00000000004017DC(rcx_236, 0x5C, fp - 88);
							if ((r12b_500 & 0x01) != 0x00)
							{
								rcx_236 = fn00000000004017DC(rcx_236, 0x22, fp - 88);
								--r9_210;
								if (r9_210 == 0x00)
									continue;
							}
							uint64 r14_255;
							uint64 r9_258 = r9_210 - (r14b_189 < 0x01);
							for (r14_255 = 0x03; r9_258 + 0x01 >= r14_255; r14_255 += 0x03)
								rcx_236 = fn00000000004017DC(rcx_236, 0x22, fp - 88);
							&rcx_236.u0->t0000 = 0x03;
							r14b_189.u0 = (int8) ((uint64) ((uint128) r9_258 % 0x03) == 0x00);
							continue;
						}
						else
						{
							while (true)
							{
								--r12_201;
								if (r12_201 == ~0x00)
									break;
								rcx_236 = fn00000000004017DC(rcx_236, 0x5C, fp - 88);
							}
							continue;
						}
					}
					rcx_236 = fn00000000004017DC(rcx_236, rsi_184, fp - 88);
					fn00000000004017B1(fp - 88);
				}
				rcx_236 = fn00000000004017DC(rcx_236, 0x00, fp - 88);
				goto l000000000040184F;
			}
			fn00000000004017B1(fp - 88);
		}
	}
	fn00000000004017DC(rcx_236, 0x00, fp - 88);
	if (rdx != 0x00)
	{
		Eq_1030 rax_93 = 0x00;
		if (rdx < 0x01)
			rax_93 = rdx - 0x01;
		Mem99[rsi + rax_93:byte] = 0x00;
	}
	if (r8 != 0x00)
	{
		uint64 r10_108 = r8 - 0x01;
		if (r8 - 0x01 > rbx_116)
			r10_108 = rbx_116;
		*((word64) rcx + r10_108 * 0x08) = 0x00;
	}
}

// 0000000000401ACC: void fn0000000000401ACC()
// Called from:
//      fn00000000004041E6
void fn0000000000401ACC()
{
	g_ptr4362D0();
}

// 0000000000403CBB: Register ptr64 fn0000000000403CBB()
// Called from:
//      fn0000000000401466
ptr64 fn0000000000403CBB()
{
	if (g_qw4367A0 == 0x00)
	{
		up32 eax_10 = 0x00010000;
		if (g_dw437FA8 >= 0x00010000)
			eax_10 = g_dw437FA8;
		uint64 rax_14 = (uint64) eax_10;
		if ((rax_14 - 0x01 & rax_14) != 0x00)
		{
			fn0000000000401000(fp - 8);
			rbp = fp - 8;
		}
		g_qw4367B0 = rax_14;
		Eq_213 rax_27 = g_t436000;
		g_qw4367A8 = 0x1000;
		g_qw4367B8 = 0x00040000;
		g_qw4367C0 = 0x00A00000;
		g_dw4367C8 = 0x05;
		g_dw436750 = 0x05;
		g_qw4367A0 = rax_27 & ~0x07 | 0x08;
	}
	return rbp;
}

// 00000000004041E6: void fn00000000004041E6(Register uint64 rdi)
// Called from:
//      fn000000000040153D
void fn00000000004041E6(uint64 rdi)
{
	while (true)
	{
		struct Eq_1226 * rdi_24 = g_ptr4367E0;
		if (rdi_24 == null)
			break;
l0000000000404204:
		uint64 rax_31 = (uint64) rdi_24->dw0000;
		do
		{
			word32 eax_71 = (word32) rax_31;
			if (rax_31 == 0x00)
			{
				struct Eq_1226 * r13_41 = rdi_24->ptr0008;
				if (rdi != 0x00)
				{
					if (r13_41 == null)
						return;
					rdi_24 = r13_41;
					goto l0000000000404204;
				}
				else
					fn0000000000401ACC();
			}
			word32 ecx_72 = __bsf(eax_71);
			uint64 rdx_84 = (uint64) ~(word32) (uint64) (0x01 << (byte) ecx_72);
			Eq_1251 rcx_81 = (uint64) ecx_72;
			ui32 edx_97 = (word32) rdx_84;
			rax_31 &= rdx_84;
			if (rdi != 0x00 && ((rdi_24->a0020))[rcx_81].qw0000 != rdi)
				continue;
			rdi_24->dw0000 &= edx_97;
			<anonymous> * rdx_102 = *((char *) &(rdi_24 + (rcx_81 *s 0x18) /64 32)->ptr0008 + 8);
		} while (rdx_102 == null);
		word64 rcx_126;
		rdx_102();
	}
}

// 000000000040436D: Register word32 fn000000000040436D(Register Eq_721 rsi, Register Eq_652 rdi)
// Called from:
//      Win32CrtStartup
//      fn00000000004017B1
word32 fn000000000040436D(Eq_721 rsi, Eq_652 rdi)
{
	__align(fp - 8);
	return (word32) (uint64) fn00000000004043AF(rsi, rdi);
}

// 000000000040437C: Register ui64 fn000000000040437C(Register Eq_660 rcx, Register word32 edi)
// Called from:
//      Win32CrtStartup
//      fn00000000004017DC
ui64 fn000000000040437C(Eq_660 rcx, word32 edi)
{
	ui32 rcx_32_32_21 = SLICE(rcx, word32, 32);
	uint64 rdi_11 = (uint64) edi;
	uint32 edi_14 = (word32) rdi_11;
	uint64 rax_13 = 0x00;
	byte al_32 = 0x00;
	Eq_1319 rax_56_8_35 = 0x00;
	if (edi_14 > 0x7F)
	{
		uint64 rcx_24 = (uint64) g_a4047D9[SEQ(rcx_32_32_21, __bsr(edi_14))];
		byte ch_45 = SLICE(rcx_24, byte, 8);
		byte cl_39 = (byte) rcx_24;
		do
		{
			rdi_11 = (uint64) (edi_14 >> 0x06);
			Eq_1319 rax_36 = SEQ(rax_56_8_35, al_32 | 0x80 | (byte) ((uint64) edi_14) & 0x3F);
			edi_14 = (word32) rdi_11;
			al_32 = (byte) (rax_36 << 0x08);
			rax_56_8_35 = rax_36;
			--cl_39;
		} while (cl_39 != 0x00);
		rax_13 = SEQ(rax_36, al_32 | ch_45);
	}
	return rax_13 | rdi_11;
}

// 00000000004043AF: Register word32 fn00000000004043AF(Register Eq_721 rsi, Register Eq_652 rdi)
// Called from:
//      fn000000000040436D
word32 fn00000000004043AF(Eq_721 rsi, Eq_652 rdi)
{
	word32 eax_27 = 0x00;
	do
	{
		uint64 rax_115 = (uint64) (eax_27 + 0x01);
		ui32 edx_38 = (word32) (uint64) (word32) *((word64) rdi + (uint64) eax_27 * 0x02);
		uint64 rbx_31 = (uint64) eax_27;
		eax_27 = (word32) rax_115;
		cui16 cx_41 = (word16) (uint64) edx_38;
	} while ((cx_41 & 0xFC00) == 0xDC00);
	if ((cx_41 & 0xFC00) != 0xD800)
		*rsi = edx_38;
	else
	{
		uint64 rax_48 = (uint64) (word32) *((word64) rdi + rax_115 * 0x02);
		if (((word16) (uint64) (word32) rax_48 & 0xFC00) != 0xDC00)
		{
			*rsi = 0xFFFD;
			rax_115 = 0xFFFFFFFF;
		}
		else
		{
			*rsi = (word32) (uint64) (word32) ((uint64) (edx_38 << 0x0A) + ~0x035FDBFF + rax_48);
			rax_115 = (uint64) (word32) (rbx_31 + 0x02);
		}
	}
	return (word32) rax_115;
}

// 00000000004046C1: void fn00000000004046C1(Register byte dil)
// Called from:
//      fn0000000000401000
//      fn000000000040153D
void fn00000000004046C1(byte dil)
{
	g_dw437FB4 |= 0x04;
	if ((g_t4362B8 & 0x04) == 0x00)
	{
		__syscall();
		__cli();
		__lidt(g_n4046F2);
		__hlt();
	}
	else
		ExitProcess((uint64) (word32) dil);
}

word48 g_n4046F2 = ;
void g_v4047B1 = ??void??; // 00000000004047B1
Eq_1486 g_a4047D9[] = // 00000000004047D9
	{
	};
word64 g_qw404C80 = 19160; // 0000000000404C80
word64 g_qw404C88 = 19174; // 0000000000404C88
word64 g_qw404C90 = 0x4B00; // 0000000000404C90
word64 g_qw404C98 = 0x4B0E; // 0000000000404C98
word64 g_qw404CA0 = 0x4B20; // 0000000000404CA0
word64 g_qw404CA8 = 0x4B2E; // 0000000000404CA8
word64 g_qw404CB0 = 0x4B42; // 0000000000404CB0
word64 g_qw404CB8 = 19292; // 0000000000404CB8
word64 g_qw404CC0 = 19310; // 0000000000404CC0
word64 g_qw404CC8 = 0x4B88; // 0000000000404CC8
word64 g_qw404CD0 = 19366; // 0000000000404CD0
word64 g_qw404CD8 = 19398; // 0000000000404CD8
word64 g_qw404CE0 = 0x4BD4; // 0000000000404CE0
word64 g_qw404CE8 = 0x4BE4; // 0000000000404CE8
word64 g_qw404CF0 = 19444; // 0000000000404CF0
word64 g_qw404CF8 = 0x4C04; // 0000000000404CF8
word64 g_qw404D00 = 0x4C1A; // 0000000000404D00
word64 g_qw404D08 = 19510; // 0000000000404D08
word64 g_qw404D10 = 0x4C48; // 0000000000404D10
byte g_b404D79 = 0x9C; // 0000000000404D79
byte g_b404DA2 = 0x9C; // 0000000000404DA2
byte g_b404DC9 = 0x9C; // 0000000000404DC9
byte g_b404DF1 = 0x9C; // 0000000000404DF1
byte g_b404E30 = 0x7E; // 0000000000404E30

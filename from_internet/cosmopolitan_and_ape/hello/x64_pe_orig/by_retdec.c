//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <windows.h>

// ---------------- Integer Types Definitions -----------------

typedef int64_t int80_t;
typedef int64_t int128_t;
typedef int64_t int256_t;

// ------------------------ Structures ------------------------

struct struct1 {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
};

struct _OVERLAPPED {
    int32_t e0;
    int32_t e1;
    int64_t e2;
    int64_t * e3;
};

// ------------------- Function Prototypes --------------------

int64_t entry_point(void);
int64_t function_401000(int64_t a1, int64_t a2);
int64_t function_4010fb(int64_t a1);
int64_t function_40114f(void);
int64_t function_40117b(void);
int64_t function_401214(void);
int64_t function_401217(void);
int64_t function_401225(void);
int64_t function_401240(void);
int64_t function_401245(void);
int64_t function_40124e(void);
int64_t function_40125e(int64_t a1);
int64_t function_401297(int64_t a1, int64_t a2, int64_t a3, int64_t a4);
int64_t function_40141f(int64_t a1, int64_t a2);
int64_t function_401433(int64_t a1, int64_t a2);
int64_t function_401524(int64_t a1);
int64_t function_40156c(void);
int64_t function_401609(void);
int64_t function_401636(void);
int64_t function_40168d(void);
int64_t function_4017be(int64_t a1, int64_t a2, int64_t a3);
int64_t function_4017ec(int64_t a1);
int64_t function_4017fd(void);
int64_t function_401816(void);
int64_t function_401826(void);
int64_t function_401836(void);
int64_t function_401846(void);
int64_t function_401856(void);
int64_t function_401aa3(void);
int64_t function_401ace(void);
int64_t function_401afe(int64_t * a1, int64_t a2, uint64_t a3);
int64_t function_401d0b(int64_t a1, int64_t a2, int64_t a3);
int64_t function_401dad(void);
int64_t function_401dd2(void);
int64_t function_401deb(void);
int64_t function_401e02(void);
int64_t function_401e0a(void);
int64_t function_401e45(int64_t a1);
int64_t function_401eaa(void);
int64_t function_401f6e(void);
int64_t function_401f97(void);
int64_t function_401fa1(void);
int64_t function_401faf(void);
int64_t function_40205a(void);
int64_t function_402083(void);
int64_t function_4020d8(int64_t a1, int64_t a2, int64_t a3);
int64_t function_402115(int64_t a1, int64_t a2, int64_t a3);
int64_t function_402150(void);
int64_t function_40215b(int64_t a1, int32_t a2);
int64_t function_4021f0(int64_t a1, int64_t result);
int64_t function_402286(int64_t a1, uint64_t a2, int64_t a3);
int64_t function_4023ce(void);
int64_t function_40243f(void);
int64_t function_40245f(void);
int64_t function_40247a(int64_t a1, int64_t a2, int64_t a3, int64_t a4);
int64_t function_4025b0(void);
int64_t function_4025c0(void);
int64_t function_4025d0(int64_t a1);
int64_t function_4025fa(void);
int64_t function_402600(void);
int64_t function_402607(int64_t a1);
int64_t function_402615(void);
int64_t function_40262d(int64_t a1, int64_t a2);
int64_t function_40263c(int64_t a1, int64_t a2);
int64_t function_40266f(int64_t a1, int64_t a2);
int64_t function_4026d0(void);
int64_t function_402750(int64_t a1, int64_t a2);
int64_t function_402764(int64_t a1, uint64_t a2, int64_t a3);
int64_t function_402870(int64_t a1, int64_t a2);
int64_t function_40288a(int64_t a1, uint64_t a2, int64_t a3);
int64_t function_402941(void);
int64_t function_40297a(void);
int64_t function_40297c(int64_t a1);
int64_t function_402998(void);
int64_t function_402efc(int64_t a1, int64_t a2, int64_t a3);

// --------------------- Global Variables ---------------------

int64_t g1 = 0; // 0x403008
int64_t g2 = 0; // 0x403010
int32_t g3 = 0; // 0x403070
int32_t * g4 = NULL; // 0x404000
char g5 = 0; // 0x404035
char * g6; // 0x404320
int32_t g7 = 0; // 0x404630
int64_t g8 = 0; // 0x404648
int64_t g9 = 0; // 0x404650
int32_t g10 = 0; // 0x404658
int32_t g11 = 0; // 0x404660
int32_t g12 = 0; // 0x404668
int32_t g13 = 0; // 0x404670
int32_t g14 = 0; // 0x404678
int32_t g15 = 0; // 0x404688
int64_t g16 = 0; // 0x404690
int64_t g17 = 0; // 0x405000
char * g18; // 0x406000
int64_t g19 = 0; // 0x406004
int64_t g20 = 0; // 0x40600c
int64_t g21 = 0; // 0x406018
int64_t g22 = 0; // 0x406020
int64_t g23 = 0; // 0x406030
char * g24; // 0x406038
int32_t g25 = 0; // 0x406040
int64_t g26 = 0; // 0x406048
int32_t g27 = 0; // 0x406050
int64_t g28 = 0; // 0x406058
int32_t * g29 = NULL; // 0x4060a0
int64_t g30 = 0; // 0x4060a8
int64_t g31 = 0; // 0x4063c0
int64_t g32 = 0; // 0x4076a0
int64_t g33 = 0; // 0x4076a8
int64_t g34 = 0; // 0x4076b0
int64_t g35 = 0; // 0x4076b8
int64_t g36 = 0; // 0x4076c8
int64_t g37 = 0; // 0x4076d0
int64_t g38 = 0; // 0x4076e0
int64_t g39 = 0; // 0x4076e8
int64_t g40 = 0; // 0x4076f8
int32_t g41 = 0; // 0x407838
int32_t g42 = 0; // 0x40783c
int32_t g43;

// ------------------------ Functions -------------------------

// Address range: 0x401000 - 0x4010fb
int64_t function_401000(int64_t a1, int64_t a2) {
    // 0x401000
    int64_t result; // 0x401000
    int64_t v1; // 0x401000
    if (*(int64_t *)(v1 + 8) == 0) {
        // 0x4010ec
        return result;
    }
    int64_t v2 = 0x100000; // 0x40102e
    while (true) {
        uint64_t v3 = v2;
        int64_t v4; // 0x401000
        int64_t v5 = v4;
        int64_t v6 = v5; // 0x401040
        while (*(int32_t *)(v5 + 16) != 1) {
            int64_t v7 = v5 + 24; // 0x40103a
            v6 = v7;
            if (*(int64_t *)(v5 + 32) == 0) {
                // break -> 0x40104e
                break;
            }
            v5 = v7;
            v6 = v5;
        }
        int64_t * v8 = (int64_t *)v6; // 0x40104e
        uint64_t v9 = *v8;
        int64_t v10 = (v9 >= v3 ? v9 : v3) + 4095 & -0x1000; // 0x40105c
        int64_t * v11 = (int64_t *)(v6 + 8); // 0x401063
        int64_t v12 = *v11; // 0x401063
        int64_t v13 = v12 + v9 & -0x1000; // 0x40106a
        int64_t v14 = v9; // 0x401073
        int64_t v15 = v12; // 0x401073
        int64_t v16 = v10; // 0x401073
        int64_t v17; // 0x401000
        int64_t v18 = v17; // 0x401073
        v2 = v10;
        int64_t v19 = v17; // 0x401073
        int64_t v20 = v13; // 0x401073
        if (v10 < v13) {
            int64_t v21 = v14; // 0x401067
            int64_t v22 = v15; // 0x401063
            int64_t v23 = v18; // 0x401000
            int64_t v24 = v16; // 0x4010d3
            int64_t v25; // 0x401000
            int64_t v26; // 0x401000
            int64_t v27; // 0x401067
            int64_t v28; // 0x401063
            uint64_t v29; // 0x401000
            int64_t v30; // 0x401000
            int64_t v31; // 0x401000
            int64_t v32; // 0x401000
            int64_t v33; // 0x401000
            int64_t v34; // 0x401075
            uint64_t v35; // 0x401097
            int64_t v36; // 0x4010c7
            int64_t v37; // 0x40106a
            uint64_t v38; // 0x4010a0
            int64_t v39; // 0x401085
            int64_t v40; // 0x401075
            while (true) {
                // 0x401075
                v29 = v24;
                v28 = v22;
                v27 = v21;
                v34 = *(int64_t *)(v23 + 8);
                v26 = v34;
                v30 = v23;
                v32 = v23;
                v25 = 0;
                if (v34 != 0) {
                    v31 = v30;
                    if (*(int32_t *)(v31 + 16) != 1) {
                        // 0x40108b
                        if (*(int64_t *)v31 + v26 >= v29) {
                            // break -> 0x401097
                            break;
                        }
                    }
                    // 0x401085
                    v39 = v31 + 24;
                    v40 = *(int64_t *)(v31 + 32);
                    v26 = v40;
                    v32 = v39;
                    v25 = 0;
                    while (v40 != 0) {
                        // 0x40107e
                        v31 = v39;
                        if (*(int32_t *)(v31 + 16) != 1) {
                            // 0x40108b
                            v32 = v31;
                            v25 = v26;
                            if (*(int64_t *)v31 + v26 >= v29) {
                                // break -> 0x401097
                                break;
                            }
                        }
                        // 0x401085
                        v39 = v31 + 24;
                        v40 = *(int64_t *)(v31 + 32);
                        v26 = v40;
                        v32 = v39;
                        v25 = 0;
                    }
                }
                // 0x401097
                v33 = v32;
                v35 = *(int64_t *)v33;
                if (v35 <= v29) {
                    // 0x4010a0
                    v38 = v35 + v25;
                    if (v38 > v29) {
                        // break -> 0x40105c
                        break;
                    }
                }
                // 0x4010b1
                v36 = function_4010fb(a2);
                v24 = v29 + 0x1000;
                *(int64_t *)v36 = v29 | 3;
                v22 = *v11;
                v21 = *v8;
                v37 = v21 + v22 & -0x1000;
                v23 = v33;
                v2 = v24;
                v19 = v33;
                v20 = v37;
                if (v24 >= v37) {
                    // break (via goto) -> 0x4010e3
                    goto lab_0x4010e3;
                }
            }
            int64_t v41 = v38 + 4095 & -0x1000; // 0x40105c
            int64_t v42 = v28 + v27 & -0x1000; // 0x40106a
            v2 = v41;
            v19 = v33;
            v20 = v42;
            while (v41 < v42) {
                // 0x401075
                v21 = v27;
                v22 = v28;
                v23 = v33;
                v24 = v41;
                while (true) {
                    // 0x401075
                    v29 = v24;
                    v28 = v22;
                    v27 = v21;
                    v34 = *(int64_t *)(v23 + 8);
                    v26 = v34;
                    v30 = v23;
                    v32 = v23;
                    v25 = 0;
                    if (v34 != 0) {
                        v31 = v30;
                        if (*(int32_t *)(v31 + 16) != 1) {
                            // 0x40108b
                            if (*(int64_t *)v31 + v26 >= v29) {
                                // break -> 0x401097
                                break;
                            }
                        }
                        // 0x401085
                        v39 = v31 + 24;
                        v40 = *(int64_t *)(v31 + 32);
                        v26 = v40;
                        v32 = v39;
                        v25 = 0;
                        while (v40 != 0) {
                            // 0x40107e
                            v31 = v39;
                            if (*(int32_t *)(v31 + 16) != 1) {
                                // 0x40108b
                                v32 = v31;
                                v25 = v26;
                                if (*(int64_t *)v31 + v26 >= v29) {
                                    // break -> 0x401097
                                    break;
                                }
                            }
                            // 0x401085
                            v39 = v31 + 24;
                            v40 = *(int64_t *)(v31 + 32);
                            v26 = v40;
                            v32 = v39;
                            v25 = 0;
                        }
                    }
                    // 0x401097
                    v33 = v32;
                    v35 = *(int64_t *)v33;
                    if (v35 <= v29) {
                        // 0x4010a0
                        v38 = v35 + v25;
                        if (v38 > v29) {
                            // break -> 0x40105c
                            break;
                        }
                    }
                    // 0x4010b1
                    v36 = function_4010fb(a2);
                    v24 = v29 + 0x1000;
                    *(int64_t *)v36 = v29 | 3;
                    v22 = *v11;
                    v21 = *v8;
                    v37 = v21 + v22 & -0x1000;
                    v23 = v33;
                    v2 = v24;
                    v19 = v33;
                    v20 = v37;
                    if (v24 >= v37) {
                        // break (via goto) -> 0x4010e3
                        goto lab_0x4010e3;
                    }
                }
                // 0x40105c
                v41 = v38 + 4095 & -0x1000;
                v42 = v28 + v27 & -0x1000;
                v2 = v41;
                v19 = v33;
                v20 = v42;
            }
        }
      lab_0x4010e3:
        // 0x4010e3
        v4 = v6 + 24;
        v17 = v19;
        result = v20;
        if (*(int64_t *)(v6 + 32) == 0) {
            // break -> 0x4010ec
            break;
        }
    }
    // 0x4010ec
    return result;
}

// Address range: 0x4010fb - 0x40114f
int64_t function_4010fb(int64_t a1) {
    // 0x4010fb
    int64_t v1; // 0x4010fb
    uint64_t v2 = v1;
    int64_t v3 = v1 + 0xffffffff; // 0x401110
    int64_t result = (v2 / 0x1000000000 & 4088) + v1;
    if ((int32_t)v3 == -1) {
        // 0x40111f
        return result;
    }
    int64_t v4 = v3; // 0x401110
    int64_t v5 = 39;
    int64_t * v6 = (int64_t *)result; // 0x401128
    int64_t v7 = *v6; // 0x401128
    int64_t v8 = v7; // 0x40112c
    int64_t v9; // 0x401131
    if (v7 == 0) {
        // 0x40112e
        v9 = v5 - 0x1000;
        *(int64_t *)a1 = v9;
        v8 = v9 | 3;
        *v6 = v8;
    }
    uint64_t v10 = v5 + 0xfffffff7; // 0x401144
    v4 = (v4 & 0xffffffff) + 0xffffffff;
    int64_t result2 = v8 & 0x3fffffffff000 | 8 * (v2 >> v10 % 64) & 4088;
    while ((int32_t)v4 != -1) {
        // 0x401124
        v5 = v10 & 0xffffffff;
        v6 = (int64_t *)result2;
        v7 = *v6;
        v8 = v7;
        if (v7 == 0) {
            // 0x40112e
            v9 = v5 - 0x1000;
            *(int64_t *)a1 = v9;
            v8 = v9 | 3;
            *v6 = v8;
        }
        // 0x401141
        v10 = v5 + 0xfffffff7;
        v4 = (v4 & 0xffffffff) + 0xffffffff;
        result2 = v8 & 0x3fffffffff000 | 8 * (v2 >> v10 % 64) & 4088;
    }
    // 0x40111f
    return result2;
}

// Address range: 0x40114f - 0x40117b
int64_t function_40114f(void) {
    int64_t result = function_4010fb(0x3220); // 0x40116b
    int64_t * v1 = (int64_t *)result; // 0x401170
    *v1 = *v1 & -2;
    int64_t v2; // 0x40114f
    __asm_invlpg(*(char *)&v2);
    return result;
}

// Address range: 0x40117b - 0x401214
int64_t function_40117b(void) {
    // 0x40117b
    int64_t v1; // 0x40117b
    int64_t v2 = v1 + 8; // 0x401188
    if (*(int64_t *)v2 == 0) {
        // 0x4011a4
        return 0;
    }
    int64_t v3 = 1; // 0x401190
    int64_t v4 = v3 & 0xffffffff; // 0x401190
    int64_t result = 24 * v4;
    while (*(int64_t *)(result + v2) != 0) {
        // 0x401190
        v3 = v4 + 1;
        v4 = v3 & 0xffffffff;
        result = 24 * v4;
    }
    uint32_t v5 = (int32_t)v3;
    if (v5 <= 1) {
        // 0x4011a4
        return result;
    }
    int64_t v6 = 1; // 0x4011a2
    int64_t result2; // 0x40117b
    while (true) {
        // 0x4011b0
        int64_t v7; // 0x40117b
        int64_t v8 = v7 + 24;
        int64_t v9 = *(int64_t *)v8; // 0x4011b0
        int64_t v10 = v8;
        int64_t v11 = v6;
        int64_t v12 = v10 - 24; // 0x4011c9
        int64_t v13; // 0x40117b
        while (v9 != *(int64_t *)v12) {
            int64_t v14 = v11 + 0xffffffff; // 0x4011c7
            int64_t v15 = v14 & 0xffffffff; // 0x4011c7
            __asm_rep_movsd_memcpy((char *)v10, (char *)v12, 6);
            v13 = v15;
            if ((int32_t)v14 == 0) {
                goto lab_0x4011e9;
            }
            v10 = v12;
            v11 = v15;
            v12 = v10 - 24;
        }
        // 0x4011e7
        v13 = v11 & 0xffffffff;
      lab_0x4011e9:;
        int64_t v16 = v6 + 1; // 0x4011ed
        int64_t v17 = 24 * v13 + v1; // 0x4011f4
        *(int64_t *)v17 = v9;
        *(int64_t *)(v17 + 8) = *(int64_t *)(v7 + 32);
        *(int32_t *)(v17 + 16) = *(int32_t *)(v7 + 40);
        *(int32_t *)(v17 + 20) = *(int32_t *)(v7 + 44);
        result2 = v17;
        v7 = v8;
        v6 = v16 & 0xffffffff;
        if (v5 <= (int32_t)v16) {
            // break -> 0x4011a4
            break;
        }
    }
    // 0x4011a4
    return result2;
}

// Address range: 0x401214 - 0x401217
int64_t function_401214(void) {
    // 0x401214
    return 0;
}

// Address range: 0x401217 - 0x401225
int64_t function_401217(void) {
    // 0x401217
    __asm_int3();
    while (true) {
        // 0x401222
        __asm_hlt();
    }
}

// Address range: 0x401225 - 0x401240
int64_t function_401225(void) {
    // 0x401225
    int64_t v1; // bp-8, 0x401225
    int64_t v2 = &v1; // 0x40122b
    __asm_rep_stosb_memset((char *)(v2 + 0xfffffff8 & 0xfffffff8), 0, 8);
    while (true) {
        // 0x401237
        __asm_lidt(*(int80_t *)(v2 - 8));
    }
}

// Address range: 0x401240 - 0x401245
int64_t function_401240(void) {
    // 0x401240
    int64_t result; // 0x401240
    return result;
}

// Address range: 0x401245 - 0x40124e
int64_t function_401245(void) {
    // 0x401245
    *(char *)&g7 = 8;
    return function_40125e((int64_t)&g43);
}

// Address range: 0x40124e - 0x40125e
int64_t function_40124e(void) {
    // 0x40124e
    int64_t result; // 0x40124e
    if (result == 0) {
        function_40125e((int64_t)&g43);
        // UNREACHABLE
    }
    // 0x401257
    *(char *)&g7 = 32;
    return result;
}

// Address range: 0x40125e - 0x401297
int64_t function_40125e(int64_t a1) {
    // 0x40125e
    __asm_rep_stosq_memset((char *)0x403018, 0x401214, (int64_t)((int32_t)((int64_t)&g3 - 0x403018) >> 3));
    int64_t v1 = 0xffffffff; // 0x40128c
    int64_t v2; // 0x40125e
    int64_t v3 = (0x100000000 * a1 >> 29) + 24 + v2; // 0x40128c
    int64_t v4 = 0; // 0x40128c
    while (v1 != 0) {
        int64_t v5 = v3;
        v1--;
        bool v6; // 0x40125e
        v3 = v5 + (v6 ? -8 : 8);
        v4 = v1;
        if (*(int64_t *)v5 == 0) {
            // break -> 
            break;
        }
        v4 = 0;
    }
    return function_401524(v4);
}

// Address range: 0x401297 - 0x40141f
int64_t function_401297(int64_t a1, int64_t a2, int64_t a3, int64_t a4) {
    struct struct1 v1; // 0x4012c1
    int64_t v2 = 1; // bp-72, 0x4012b8
    bool v3; // 0x401297
    int64_t v4 = v3 ? -4 : 4;
    int64_t v5 = (int64_t)&g4;
    int64_t v6 = &v2;
    v1 = __asm_cpuid((int32_t)0);
    int32_t v7 = v1.e1; // 0x4012c1
    *(int32_t *)v5 = v1.e0;
    int64_t v8 = v5 + v4; // 0x4012c3
    *(int32_t *)v8 = v7;
    int64_t v9 = v8 + v4; // 0x4012c5
    *(int32_t *)v9 = v1.e2;
    int64_t v10 = v9 + v4; // 0x4012c7
    *(int32_t *)v10 = v1.e3;
    int64_t v11 = v6; // 0x4012cd
    while ((int32_t)*(int64_t *)v6 != 0) {
        // 0x4012bf
        v5 = (int64_t)&g4;
        v6 = &v2;
        v1 = __asm_cpuid((int32_t)0);
        v7 = v1.e1;
        *(int32_t *)v5 = v1.e0;
        v8 = v5 + v4;
        *(int32_t *)v8 = v7;
        v9 = v8 + v4;
        *(int32_t *)v9 = v1.e2;
        v10 = v9 + v4;
        *(int32_t *)v10 = v1.e3;
        v11 = v6;
    }
  lab_0x4012da:;
    int64_t * v12 = (int64_t *)(v6 + 8); // 0x4012db
    int64_t v13 = v3 ? -1 : 1; // 0x4012e5
    int64_t v14 = v3 ? -8 : 8; // 0x4012ec
    int64_t v15 = v7 & -0xff01 | 0x1100; // 0x4012e1
    int64_t v16 = 0x402e68; // 0x4012e1
    int64_t v17 = v16 + v13; // 0x4012e5
    int64_t v18 = v10 + v4; // 0x4012e9
    uint64_t v19 = v15 & -256 | (int64_t)*(char *)v16;
    *(int64_t *)v18 = (int64_t)*(char *)v17 + 0x4026e7;
    int64_t v20 = v18 + v14; // 0x4012ec
    unsigned char v21 = (char)v19 - 1; // 0x4012ee
    int64_t v22 = v19 & -256 | (int64_t)v21; // 0x4012ee
    v18 = v20;
    while (v21 != 0) {
        // 0x4012ec
        v19 = v22;
        *(int64_t *)v18 = (int64_t)*(char *)v17 + 0x4026e7;
        v20 = v18 + v14;
        v21 = (char)v19 - 1;
        v22 = v19 & -256 | (int64_t)v21;
        v18 = v20;
    }
    int64_t v23 = v17 + v13; // 0x4012e8
    unsigned char v24 = (char)(v19 / 256) - 1; // 0x4012f2
    int64_t v25 = v22 & -0xff01 | 256 * (int64_t)v24; // 0x4012f2
    v16 = v23;
    while (v24 != 0) {
        // 0x4012e3
        v17 = v16 + v13;
        v19 = v25 & -256 | (int64_t)*(char *)v16;
        *(int64_t *)v20 = (int64_t)*(char *)v17 + 0x4026e7;
        v20 += v14;
        v21 = (char)v19 - 1;
        v22 = v19 & -256 | (int64_t)v21;
        v18 = v20;
        while (v21 != 0) {
            // 0x4012ec
            v19 = v22;
            *(int64_t *)v18 = (int64_t)*(char *)v17 + 0x4026e7;
            v20 = v18 + v14;
            v21 = (char)v19 - 1;
            v22 = v19 & -256 | (int64_t)v21;
            v18 = v20;
        }
        // 0x4012f2
        v23 = v17 + v13;
        v24 = (char)(v19 / 256) - 1;
        v25 = v22 & -0xff01 | 256 * (int64_t)v24;
        v16 = v23;
    }
    // 0x4012f6
    function_401636();
    function_4017ec(v25);
    *v12 = 32;
    function_4017be(32, 0x402764, (int64_t)&g4);
    *v12 = 32;
    function_4017be(32, 0x40288a, (int64_t)&g4);
    *(int64_t *)v11 = v23 + 6;
    char v26 = *(char *)v20; // 0x40132e
    int64_t v27; // 0x401297
    int64_t v28; // 0x401297
    int64_t v29; // 0x401297
    if ((v26 & 8) != 0) {
        // 0x40136f
        *(int64_t *)(v11 - 8) = 69;
        int64_t v30 = v11 - 16; // 0x401371
        *(int64_t *)v30 = 8;
        v27 = 8;
        v29 = v30;
        v28 = 0x402f33;
    } else {
        if ((v26 & 32) != 0) {
            // 0x401359
            *(int64_t *)(v11 - 8) = 48;
            int64_t v31 = v11 - 16; // 0x40135b
            *(int64_t *)v31 = 32;
            v27 = 32;
            v29 = v31;
            v28 = 0x402f01;
        } else {
            if ((v26 & 4) != 0) {
                // 0x40134e
                *(int64_t *)(v11 - 8) = 34;
                int64_t v32 = v11 - 16; // 0x401350
                *(int64_t *)v32 = 4;
                v27 = 4;
                v29 = v32;
                v28 = 0x402f22;
            } else {
                int64_t * v33 = (int64_t *)(v11 - 8);
                int64_t v34; // 0x401297
                if (v34 == 0) {
                    // 0x401364
                    *v33 = 42;
                    int64_t v35 = v11 - 16; // 0x401366
                    *(int64_t *)v35 = 16;
                    v27 = 16;
                    v29 = v35;
                    v28 = 0x402f17;
                } else {
                    // 0x401343
                    *v33 = 0;
                    int64_t v36 = v11 - 16; // 0x401345
                    *(int64_t *)v36 = 1;
                    v27 = 1;
                    v29 = v36;
                    v28 = 0x402f0c;
                }
            }
        }
    }
    // 0x401378
    *(int64_t *)v20 = v27;
    int64_t v37 = v20 + v14; // 0x40137e
    int64_t * v38 = (int64_t *)(v29 + 8); // 0x401380
    *(int64_t *)v37 = *v38 + 0x4025d0;
    *v38 = v37 + v14;
    int64_t v39 = &g8; // 0x401398
    if (&g8 < &g16) {
        int64_t v40 = 0; // 0x401297
        unsigned char v41 = *(char *)v28; // 0x40139e
        uint64_t v42 = (int64_t)v41; // 0x40139e
        int64_t v43 = v28 + v13; // 0x40139e
        uint64_t v44 = v40 + 7; // 0x4013a9
        int64_t v45 = v42 % 128 << v40 % 64; // 0x4013ac
        v40 = v44 & 0xffffffff;
        int64_t v46 = v45; // 0x4013b1
        int64_t v47 = v43; // 0x4013b1
        while (v41 < 0) {
            // 0x40139e
            v41 = *(char *)v47;
            v42 = (int64_t)v41;
            v43 = v47 + v13;
            v44 = v40 + 7;
            v45 = v42 % 128 << v40 % 64 | v46;
            v40 = v44 & 0xffffffff;
            v46 = v45;
            v47 = v43;
        }
        int64_t v48 = v45; // 0x4013b5
        if ((v42 & 64) != 0) {
            // 0x4013b7
            v48 = v45 | -1 << v44 % 64;
        }
        int64_t * v49 = (int64_t *)v39; // 0x4013c3
        int64_t v50 = *v49;
        *v49 = v50 != 0 ? v50 : v48;
        int64_t v51 = v39 + v14; // 0x4013cb
        v39 = v51;
        while (v51 < (int64_t)&g16) {
            // 0x40139e
            v40 = 0;
            v41 = *(char *)v43;
            v42 = (int64_t)v41;
            v43 += v13;
            v44 = v40 + 7;
            v45 = v42 % 128 << v40 % 64;
            v40 = v44 & 0xffffffff;
            v46 = v45;
            v47 = v43;
            while (v41 < 0) {
                // 0x40139e
                v41 = *(char *)v47;
                v42 = (int64_t)v41;
                v43 = v47 + v13;
                v44 = v40 + 7;
                v45 = v42 % 128 << v40 % 64 | v46;
                v40 = v44 & 0xffffffff;
                v46 = v45;
                v47 = v43;
            }
            // 0x4013b3
            v48 = v45;
            if ((v42 & 64) != 0) {
                // 0x4013b7
                v48 = v45 | -1 << v44 % 64;
            }
            // 0x4013c0
            v49 = (int64_t *)v39;
            v50 = *v49;
            *v49 = v50 != 0 ? v50 : v48;
            v51 = v39 + v14;
            v39 = v51;
        }
    }
    // 0x4013cf
    *(int64_t *)(v29 + 24) = 1;
    g20 = 1;
    *(int32_t *)&g19 = g15;
    g21 = &g17;
    *(int32_t *)&g22 = 0x1000;
    g23 = (*(char *)&g7 & 2) == 0 ? 0x402083 : 0x402115;
    g24 = (char *)&g18;
    return (int64_t)&g18;
}

// Address range: 0x40141f - 0x401433
int64_t function_40141f(int64_t a1, int64_t a2) {
    // 0x40141f
    function_401e0a();
    return 0;
}

// Address range: 0x401433 - 0x401524
int64_t function_401433(int64_t a1, int64_t a2) {
    // 0x401433
    int64_t v1; // 0x401433
    if ((int32_t)v1 == 0 != ((*(char *)&g7 & 4) == 0)) {
        // 0x401458
        *g24 = 1;
    }
    // 0x40145d
    if (g27 == 0) {
        // 0x401481
        g27 = &g28;
        g26 = 8;
        function_40215b(a1, 0);
    }
    int64_t v2 = (int64_t)g24; // 0x40143a
    int64_t v3 = g25; // 0x4014a7
    int64_t v4 = g27;
    int64_t v5 = v3 - 1;
    int64_t result; // 0x401433
    while (v5 != -1) {
        int64_t v6 = v5 - 1; // 0x4014c4
        if (*(int64_t *)(v4 + 8 + 8 * v6) == 0) {
            // 0x4014cf
            *(int64_t *)(8 * v5 + v4) = v2;
            result = 0;
            return result;
        }
        v5 = v6;
    }
    uint64_t v7 = v3 + 1; // 0x4014d6
    int64_t v8 = v4; // 0x4014e2
    if (v7 >= g26) {
        // 0x4014fb
        if ((char)function_402286(1, 8, v1) == 0) {
            // 0x40151b
            return 0xffffffff;
        }
        // 0x4014fb
        v8 = g27;
    }
    // 0x4014e4
    *(int64_t *)(v8 + 8 * v3) = v2;
    g25 = v7;
    result = v3 & 0xffffffff;
  lab_0x40151b:
    // 0x40151b
    return result;
}

// Address range: 0x401524 - 0x40156c
int64_t function_401524(int64_t a1) {
    // 0x401524
    int64_t v1; // 0x401524
    int64_t v2 = &v1; // 0x401524
    int64_t v3; // 0x401524
    function_401297(a1, v3, v3, v3);
    g42 |= 1;
    int64_t * v4 = (int64_t *)(v2 - 8); // 0x40154a
    *v4 = (int64_t)&g1;
    *(int64_t *)(v2 - 16) = (int64_t)&g2;
    int64_t v5 = *v4 + 8; // 0x401550
    while (v5 != (int64_t)&g2) {
        // 0x40154a
        *v4 = v5;
        *(int64_t *)(v2 - 16) = (int64_t)&g2;
        v5 = *v4 + 8;
    }
    // 0x401556
    function_40141f((int64_t)&g2, v3);
    function_4017fd();
    // UNREACHABLE
}

// Address range: 0x40156c - 0x401609
int64_t function_40156c(void) {
    uint32_t result = g7 & 4; // 0x401583
    if (result != 0) {
        // 0x4015b9
        if ((char)function_40245f() == 0) {
            // 0x4015f8
            return 0;
        }
        // 0x4015f8
        return (int32_t)function_401dd2() == 2;
    }
    // 0x401589
    if ((int32_t)function_401609() != -1) {
        // 0x4015f8
        int32_t v1; // 0x40156c
        return (v1 & 0xf000) == 0x2000;
    }
    // 0x4015f8
    return result;
}

// Address range: 0x401609 - 0x401636
int64_t function_401609(void) {
    int64_t v1 = function_4025b0(); // 0x401616
    int64_t result = v1; // 0x40161e
    if ((int32_t)v1 != -1) {
        // 0x401620
        function_40168d();
        result = v1 & 0xffffffff;
    }
    // 0x40162e
    return result;
}

// Address range: 0x401636 - 0x40168d
int64_t function_401636(void) {
    // 0x401636
    g32 = 3;
    g34 = &g35;
    g33 = 16;
    *(int32_t *)&g36 = 1;
    *(int32_t *)&g38 = 1;
    *(int32_t *)&g40 = 1;
    g35 = (int64_t)GetStdHandle(-10);
    g37 = (int64_t)GetStdHandle(-11);
    int64_t result = (int64_t)GetStdHandle(-12); // 0x40167e
    g39 = result;
    return result;
}

// Address range: 0x40168d - 0x4017be
int64_t function_40168d(void) {
    // 0x40168d
    int64_t v1; // 0x40168d
    int64_t v2 = v1;
    if (v2 == 0) {
        // 0x4017b2
        int64_t result; // 0x40168d
        return result;
    }
    // 0x401696
    int64_t * v3; // 0x40168d
    int64_t * v4; // 0x40168d
    int64_t v5; // 0x40168d
    int64_t * v6; // 0x40168d
    int64_t v7; // 0x40168d
    int64_t v8; // 0x40168d
    int64_t result3; // 0x40168d
    int64_t v9; // 0x40168d
    int64_t v10; // 0x40168d
    int64_t v11; // 0x40168d
    if ((g7 & 8) == 0) {
        int64_t result2 = g7; // 0x401697
        int64_t v12; // 0x40168d
        int64_t * v13; // 0x40168d
        int64_t v14; // 0x40168d
        int64_t * v15; // 0x40168d
        int64_t * v16; // 0x40168d
        int64_t * v17; // 0x40168d
        int64_t v18; // 0x40168d
        int32_t v19; // 0x40168d
        int64_t v20; // 0x40168d
        int64_t v21; // 0x40168d
        int64_t v22; // 0x40168d
        int64_t v23; // 0x40168d
        int64_t v24; // 0x40168d
        int64_t v25; // 0x40168d
        int64_t v26; // 0x40168d
        if ((result2 & 32) == 0) {
            // 0x401740
            if ((result2 & 16) == 0) {
                // 0x4017b2
                return result2;
            }
            int64_t v27 = v2 + 28; // 0x401748
            int64_t v28 = v2 + 96;
            int64_t * v29 = (int64_t *)(v2 + 48);
            *(int64_t *)v2 = (int64_t)*(int32_t *)(v2 + 4);
            int64_t v30 = v2 + 16; // 0x401766
            int64_t * v31 = (int64_t *)(v2 + 56);
            int64_t * v32 = (int64_t *)(v2 + 64);
            int64_t * v33 = (int64_t *)(v2 + 72);
            int64_t * v34 = (int64_t *)(v2 + 40); // 0x40177a
            *(int32_t *)(v2 + 24) = (int32_t)v2;
            *(int64_t *)v30 = (int64_t)*(int32_t *)v30;
            *(int64_t *)v27 = *(int64_t *)(v2 + 20);
            *v34 = (int64_t)*(int32_t *)v27;
            v12 = v2 + 112;
            v14 = v28;
            v13 = v33;
            v17 = v32;
            v16 = v31;
            v15 = v29;
            v22 = *v33;
            v24 = *v31;
            v25 = *v32;
            v23 = *(int64_t *)(v2 + 80);
            v26 = *v29;
            v20 = *v34;
            v21 = *(int64_t *)(v2 + 32);
            v18 = *(int64_t *)(v2 + 88);
            v19 = *(int32_t *)v28;
        } else {
            int64_t v35 = v2 + 24; // 0x40170e
            int64_t v36 = v2 + 112;
            int64_t * v37 = (int64_t *)(v2 + 48);
            int64_t * v38 = (int64_t *)(v2 + 56);
            int64_t * v39 = (int64_t *)(v2 + 64);
            int64_t * v40 = (int64_t *)(v2 + 72);
            *(int32_t *)v35 = (int32_t)*(int16_t *)v35;
            v12 = v36;
            v14 = v2 + 96;
            v13 = v40;
            v17 = v39;
            v16 = v38;
            v15 = v37;
            v22 = *(int64_t *)(v2 + 88);
            v24 = *v40;
            v25 = *(int64_t *)(v2 + 80);
            v23 = *(int64_t *)v36;
            v26 = *v39;
            v20 = *v38;
            v21 = *v37;
            v18 = *(int64_t *)(v2 + 120);
            v19 = *(int32_t *)(v2 + 128);
        }
        // 0x40178e
        *v15 = v23;
        *v16 = (int64_t)v19;
        *v17 = v18;
        v5 = v12;
        v4 = (int64_t *)(v2 + 104);
        v3 = (int64_t *)v14;
        v6 = v13;
        result3 = v22;
        v9 = v24;
        v10 = v25;
        v11 = v26;
        v7 = v20;
        v8 = v21;
    } else {
        int32_t * v41 = (int32_t *)(v2 + 24); // 0x4016ad
        int64_t v42 = v2 + 112;
        int64_t * v43 = (int64_t *)(v2 + 16); // 0x4016c2
        int64_t * v44 = (int64_t *)(v2 + 96);
        int64_t * v45 = (int64_t *)(v2 + 40); // 0x4016ca
        *v45 = (int64_t)*v41;
        int64_t * v46 = (int64_t *)(v2 + 104);
        int64_t * v47 = (int64_t *)(v2 + 48); // 0x4016da
        int64_t * v48 = (int64_t *)(v2 + 56); // 0x4016de
        int64_t * v49 = (int64_t *)(v2 + 64); // 0x4016e2
        int64_t * v50 = (int64_t *)(v2 + 72);
        *(int64_t *)v2 = 0x100000000 * v2 >> 32;
        *v43 = (int64_t)*(int16_t *)(v2 + 6);
        *v41 = (int32_t)*(int16_t *)(v2 + 4);
        *(int64_t *)(v2 + 28) = *v43;
        *v47 = *v44;
        *v48 = (int64_t)*(int32_t *)v42;
        *v49 = *v46;
        v5 = v42;
        v4 = v46;
        v3 = v44;
        v6 = v50;
        result3 = *v50;
        v9 = *v48;
        v10 = *v49;
        v11 = *v47;
        v7 = *v45;
        v8 = *(int64_t *)(v2 + 32);
    }
    // 0x40179a
    *v6 = v8;
    *(int64_t *)(v2 + 80) = v7;
    *(int64_t *)(v2 + 88) = v11;
    *v3 = v9;
    *v4 = v10;
    *(int64_t *)v5 = result3;
    // 0x4017b2
    return result3;
}

// Address range: 0x4017be - 0x4017ec
int64_t function_4017be(int64_t a1, int64_t a2, int64_t a3) {
    // 0x4017be
    int64_t v1; // 0x4017be
    bool v2; // 0x4017be
    int64_t v3 = v1 + (v2 ? -1 : 1); // 0x4017c7
    int64_t v4; // 0x4017be
    *(int64_t *)v4 = (int64_t)*(char *)v1 + a2;
    int64_t v5 = v4 + (v2 ? -8 : 8); // 0x4017cb
    uint32_t v6 = (int32_t)a1 - 1; // 0x4017cd
    int64_t v7 = v6; // 0x4017d0
    v1 = v3;
    while (v6 != 0) {
        // 0x4017c5
        v3 = v1 + (v2 ? -1 : 1);
        *(int64_t *)v5 = (int64_t)*(char *)v1 + a2;
        v5 += (v2 ? -8 : 8);
        v6 = (int32_t)v7 - 1;
        v7 = v6;
        v1 = v3;
    }
    unsigned char v8 = *(char *)((2 * (int64_t)!v2 | (int64_t)((g5 & 2) != 0)) + v3); // 0x4017e1
    *(int64_t *)v5 = (int64_t)v8 + a2;
    return *(int64_t *)v3;
}

// Address range: 0x4017ec - 0x4017fd
int64_t function_4017ec(int64_t a1) {
    // 0x4017ec
    int64_t v1; // 0x4017ec
    unsigned char v2 = *(char *)v1; // 0x4017ee
    bool v3; // 0x4017ec
    int64_t v4 = v3 ? -1 : 1; // 0x4017ee
    int64_t v5 = v4 + v1; // 0x4017ee
    unsigned char v6 = *(char *)v5; // 0x4017f1
    int64_t result = v1 & -256 | (int64_t)v6; // 0x4017f1
    if (v2 == 0) {
        // 0x4017fc
        return result;
    }
    int64_t result2 = result; // 0x4017f1
    int64_t v7; // 0x4017ec
    *(char *)v7 = v6;
    int64_t v8 = v7 + v4; // 0x4017f4
    uint32_t v9 = (int32_t)(int64_t)v2 - 1; // 0x4017f5
    int64_t v10 = v9; // 0x4017f5
    int64_t v11 = v8; // 0x4017f8
    while (v9 != 0) {
        // 0x4017f4
        *(char *)v11 = v6;
        v8 = v11 + v4;
        v9 = (int32_t)v10 - 1;
        v10 = v9;
        v11 = v8;
    }
    int64_t v12 = v5 + v4;
    int64_t v13 = v12 + v4; // 0x4017ee
    int64_t v14 = v10 & 0xffffff00 | (int64_t)*(char *)v12; // 0x4017ef
    unsigned char v15 = *(char *)v13; // 0x4017f1
    result2 = result2 & -256 | (int64_t)v15;
    while (v14 != 0) {
        // 0x4017f4
        *(char *)v8 = v15;
        v8 += v4;
        v9 = (int32_t)v14 - 1;
        v10 = v9;
        v11 = v8;
        while (v9 != 0) {
            // 0x4017f4
            *(char *)v11 = v15;
            v8 = v11 + v4;
            v9 = (int32_t)v10 - 1;
            v10 = v9;
            v11 = v8;
        }
        // 0x4017ee
        v12 = v13 + v4;
        v13 = v12 + v4;
        v14 = v10 & 0xffffff00 | (int64_t)*(char *)v12;
        v15 = *(char *)v13;
        result2 = result2 & -256 | (int64_t)v15;
    }
    // 0x4017fc
    return result2;
}

// Address range: 0x4017fd - 0x401816
int64_t function_4017fd(void) {
    // 0x4017fd
    int64_t v1; // 0x4017fd
    function_4021f0(v1, v1);
    function_402941();
    // UNREACHABLE
}

// Address range: 0x401816 - 0x401826
int64_t function_401816(void) {
    // 0x401816
    g41 = *(int32_t *)&g8;
    return -1;
}

// Address range: 0x401826 - 0x401836
int64_t function_401826(void) {
    // 0x401826
    g41 = g10;
    return -1;
}

// Address range: 0x401836 - 0x401846
int64_t function_401836(void) {
    // 0x401836
    g41 = g11;
    return -1;
}

// Address range: 0x401846 - 0x401856
int64_t function_401846(void) {
    // 0x401846
    g41 = g12;
    return -1;
}

// Address range: 0x401856 - 0x401866
int64_t function_401856(void) {
    // 0x401856
    g41 = g13;
    return -1;
}

// Address range: 0x401867 - 0x401aa3
int64_t entry_point(void) {
    // 0x401867
    int64_t lpNumberOfBytesWritten; // bp-32824, 0x401867
    if (!SetDefaultDllDirectories(2048)) {
        // 0x40189e
        WriteFile(GetStdHandle(-12), (int64_t *)"nodll\n", 6, (int32_t *)&lpNumberOfBytesWritten, NULL);
        ExitProcess(1);
        // UNREACHABLE
    }
    // 0x4018e7
    g7 = 4;
    GetCommandLineW();
    int16_t * lpszEnvironmentBlock = GetEnvironmentStringsW(); // 0x4018fd
    int64_t v1; // bp-53304, 0x401867
    function_401afe(&v1, 0x3fff, 512);
    char * v2 = (char *)v1; // 0x40193a
    unsigned char v3 = *v2; // 0x40193a
    int64_t v4 = (int64_t)v3 | 0x3f00; // 0x40193a
    int64_t v5 = v4; // 0x40193e
    int64_t v6 = 0; // 0x40193e
    int64_t v7 = v1; // 0x40193e
    int64_t v8 = v4; // 0x40193e
    if (v3 != 0) {
        if (v3 == 92) {
            // 0x401945
            *v2 = 47;
        }
        int64_t v9 = v1; // 0x401930
        v6++;
        int64_t v10 = v9 + v6; // 0x401937
        char * v11 = (char *)v10; // 0x40193a
        unsigned char v12 = *v11; // 0x40193a
        v5 = v5 & -256 | (int64_t)v12;
        v7 = v10;
        v8 = v5;
        while (v12 != 0) {
            int64_t v13 = v9; // 0x401943
            if (v12 == 92) {
                // 0x401945
                *v11 = 47;
                v13 = v1;
            }
            // 0x401948
            v9 = v13;
            v6++;
            v10 = v9 + v6;
            v11 = (char *)v10;
            v12 = *v11;
            v5 = v5 & -256 | (int64_t)v12;
            v7 = v10;
            v8 = v5;
        }
    }
    uint16_t v14 = *lpszEnvironmentBlock; // 0x40194d
    int32_t v15; // 0x401867
    int64_t v16; // 0x401867
    if (v14 < 0xd800) {
        // 0x401958
        v15 = v14;
        v16 = 2;
    } else {
        // 0x401965
        v16 = 2 * function_40262d(v7, v8) & 0x1fffffffe;
    }
    // 0x401974
    int64_t v17; // bp-8, 0x401867
    int64_t v18 = &v17; // 0x40186f
    int64_t v19 = (int64_t)lpszEnvironmentBlock; // 0x4018fd
    int64_t v20 = &lpNumberOfBytesWritten; // 0x401976
    int64_t v21; // bp-58, 0x401867
    uint64_t v22 = (int64_t)&v21; // 0x40197d
    int64_t v23 = v20; // 0x4019a5
    int64_t v24 = 0; // 0x4019a5
    if (v15 != 0) {
        int64_t v25 = v20;
        int64_t v26 = 1; // 0x4019ab
        if (v26 < 512) {
            // 0x4019b7
            *(int64_t *)(v18 - 0xe038 + 8 * v26) = v25 < v22 ? v25 : 0;
        }
        int64_t v27 = v16 + v19;
        int64_t v28 = v25;
        int32_t v29 = v15;
        int64_t v30 = v29; // 0x4019d7
        if (v29 >= 128) {
            // 0x4019d9
            v30 = function_40263c(v28, v27);
        }
        int64_t v31 = v30; // 0x401867
        int64_t v32 = v28;
        int64_t v33 = v32; // 0x4019e4
        uint64_t v34; // 0x401867
        int64_t v35; // 0x4019e6
        while (v32 < v22) {
            // 0x4019e6
            v34 = v31;
            v35 = v32 + 1;
            *(char *)v32 = (char)v34;
            v31 = v34 / 256;
            v33 = v35;
            if (v34 < 256) {
                // break -> 0x4019f2
                break;
            }
            v32 = v35;
            v33 = v32;
        }
        int64_t v36 = v33;
        uint16_t v37 = *(int16_t *)v27; // 0x4019f2
        int32_t v38; // 0x401867
        int64_t v39; // 0x401867
        if (v37 < 0xd800) {
            // 0x4019fb
            v38 = v37;
            v39 = 1;
        } else {
            // 0x401a08
            v38 = v29;
            v39 = function_40262d(v36, v27);
        }
        int32_t v40 = v38;
        int64_t v41 = (2 * v39 & 0x1fffffffe) + v27; // 0x401a15
        while (v29 != 0) {
            // 0x4019c9
            v27 = v41;
            v28 = v36;
            v29 = v40;
            v30 = v29;
            if (v29 >= 128) {
                // 0x4019d9
                v30 = function_40263c(v28, v27);
            }
            // 0x4019e1
            v31 = v30;
            v32 = v28;
            v33 = v32;
            while (v32 < v22) {
                // 0x4019e6
                v34 = v31;
                v35 = v32 + 1;
                *(char *)v32 = (char)v34;
                v31 = v34 / 256;
                v33 = v35;
                if (v34 < 256) {
                    // break -> 0x4019f2
                    break;
                }
                v32 = v35;
                v33 = v32;
            }
            // 0x4019f2
            v36 = v33;
            v37 = *(int16_t *)v27;
            if (v37 < 0xd800) {
                // 0x4019fb
                v38 = v37;
                v39 = 1;
            } else {
                // 0x401a08
                v38 = v29;
                v39 = function_40262d(v36, v27);
            }
            // 0x401a10
            v40 = v38;
            v41 = (2 * v39 & 0x1fffffffe) + v27;
        }
        uint64_t v42 = v36 - v20; // 0x401a20
        *(char *)(v18 - 0x8030 + (v42 < 0x7ffd ? v42 : 0x7ffd)) = 0;
        int64_t v43 = v26; // 0x4019a5
        v23 = v36;
        v24 = v26;
        while (v40 != 0) {
            // 0x4019ab
            v25 = v36;
            v26 = v43 + 1;
            if (v26 < 512) {
                // 0x4019b7
                *(int64_t *)(v18 - 0xe038 + 8 * v26) = v25 < v22 ? v25 : 0;
            }
            // 0x4019c9
            v27 = v41;
            v28 = v25;
            v29 = v40;
            v30 = v29;
            if (v29 >= 128) {
                // 0x4019d9
                v30 = function_40263c(v28, v27);
            }
            // 0x4019e1
            v31 = v30;
            v32 = v28;
            v33 = v32;
            while (v32 < v22) {
                // 0x4019e6
                v34 = v31;
                v35 = v32 + 1;
                *(char *)v32 = (char)v34;
                v31 = v34 / 256;
                v33 = v35;
                if (v34 < 256) {
                    // break -> 0x4019f2
                    break;
                }
                v32 = v35;
                v33 = v32;
            }
            // 0x4019f2
            v36 = v33;
            v37 = *(int16_t *)v27;
            if (v37 < 0xd800) {
                // 0x4019fb
                v38 = v37;
                v39 = 1;
            } else {
                // 0x401a08
                v38 = v29;
                v39 = function_40262d(v36, v27);
            }
            // 0x401a10
            v40 = v38;
            v41 = (2 * v39 & 0x1fffffffe) + v27;
            while (v29 != 0) {
                // 0x4019c9
                v27 = v41;
                v28 = v36;
                v29 = v40;
                v30 = v29;
                if (v29 >= 128) {
                    // 0x4019d9
                    v30 = function_40263c(v28, v27);
                }
                // 0x4019e1
                v31 = v30;
                v32 = v28;
                v33 = v32;
                while (v32 < v22) {
                    // 0x4019e6
                    v34 = v31;
                    v35 = v32 + 1;
                    *(char *)v32 = (char)v34;
                    v31 = v34 / 256;
                    v33 = v35;
                    if (v34 < 256) {
                        // break -> 0x4019f2
                        break;
                    }
                    v32 = v35;
                    v33 = v32;
                }
                // 0x4019f2
                v36 = v33;
                v37 = *(int16_t *)v27;
                if (v37 < 0xd800) {
                    // 0x4019fb
                    v38 = v37;
                    v39 = 1;
                } else {
                    // 0x401a08
                    v38 = v29;
                    v39 = function_40262d(v36, v27);
                }
                // 0x401a10
                v40 = v38;
                v41 = (2 * v39 & 0x1fffffffe) + v27;
            }
            // 0x401a1d
            v42 = v36 - v20;
            *(char *)(v18 - 0x8030 + (v42 < 0x7ffd ? v42 : 0x7ffd)) = 0;
            v43 = v26;
            v23 = v36;
            v24 = v26;
        }
    }
    uint64_t v44 = v24;
    int64_t v45 = v23; // 0x401a3d
    if (v23 < v22) {
        // 0x401a3f
        *(char *)v23 = 0;
        v45 = v23 + 1;
    }
    uint64_t v46 = v45 - v20; // 0x401a45
    *(char *)(v18 - 0x8030 + (v46 < 0x7ffe ? v46 : 0x7ffe)) = 0;
    *(int64_t *)(v18 - 0xe030 + 8 * (v44 < 511 ? v44 : 511)) = 0;
    FreeEnvironmentStringsW(lpszEnvironmentBlock);
    return function_401524(v19);
}

// Address range: 0x401aa3 - 0x401ace
int64_t function_401aa3(void) {
    // 0x401aa3
    int64_t v1; // 0x401aa3
    int64_t v2 = v1;
    int64_t result; // 0x401aa3
    if ((int16_t)v2 < 0xd800) {
        // 0x401ab2
        *(int32_t *)(v2 + 24) = (int32_t)v2 % 0x10000;
        result = 2;
    } else {
        // 0x401abc
        result = 2 * function_40262d(v1, v2) & 0x1fffffffe;
    }
    // 0x401ac5
    *(int64_t *)v2 = result + v2;
    return result;
}

// Address range: 0x401ace - 0x401afe
int64_t function_401ace(void) {
    // 0x401ace
    int64_t v1; // 0x401ace
    int64_t v2 = 0x100000000 * v1 >> 32; // 0x401add
    if ((int32_t)v1 >= 128) {
        // 0x401adf
        v2 = function_40263c(v1, v1);
    }
    int64_t * v3 = (int64_t *)(v1 + 8); // 0x401ae4
    uint64_t v4 = v2;
    uint64_t v5 = *v3; // 0x401ae4
    int64_t result = v4; // 0x401aeb
    while (*(int64_t *)(v1 + 16) > v5) {
        // 0x401aed
        *v3 = v5 + 1;
        *(char *)v5 = (char)v4;
        int64_t v6 = v4 / 256; // 0x401af7
        result = v6;
        if (v4 < 256) {
            // break -> 0x401afd
            break;
        }
        v4 = v6;
        v5 = *v3;
        result = v4;
    }
    // 0x401afd
    return result;
}

// Address range: 0x401afe - 0x401d0b
int64_t function_401afe(int64_t * a1, int64_t a2, uint64_t a3) {
    // 0x401afe
    int64_t v1; // 0x401afe
    int64_t v2 = v1;
    int32_t v3; // 0x401afe
    uint32_t v4 = v3;
    function_401aa3();
    if (v4 == 0) {
        // 0x401b67
        function_401ace();
        if (a2 != 0) {
            uint64_t v5 = a2 - 1; // 0x401b7a
            uint64_t v6 = (0x100000000 * v2 >> 32) - v2; // 0x401b7d
            *(char *)((v6 > v5 ? v5 : v6) + v2) = 0;
        }
        if (a3 != 0) {
            // 0x401b98
            *a1 = 0;
        }
        // 0x401cfa
        return 0;
    }
    uint64_t v7 = 0x100000000 * v2 >> 32;
    int64_t v8 = 0; // 0x401b55
    if ((1 << (int64_t)(v4 % 64) & 0x100002600) != 0 == v4 < 33) {
        while (true) {
            // 0x401b5d
            function_401aa3();
        }
    }
    while (true) {
        // 0x401bb7
        v8++;
        if (v8 < a3) {
            // 0x401bc0
            *(int64_t *)((int64_t)a1 - 8 + 8 * v8) = v2 + a2 > v7 ? v7 : 0;
        }
        while (true) {
          lab_0x401be3:
            if (v4 < 33) {
                if ((1 << (int64_t)(v4 % 64) & 0x100002600) != 0) {
                    // break -> 0x401ceb
                    break;
                }
                // 0x401cd6
                function_401ace();
                function_401aa3();
                goto lab_0x401be3;
            } else {
                if (v4 != 34 == (v4 != 92)) {
                    // 0x401cd6
                    function_401ace();
                    function_401aa3();
                    goto lab_0x401be3;
                } else {
                    if (v4 == 92) {
                        // break (via goto) -> 0x401c13
                        goto lab_0x401c13;
                    }
                    if (v4 == 34) {
                        // 0x401c29
                        function_401aa3();
                        // 0x401c29
                        function_401aa3();
                        // 0x401c29
                        function_401aa3();
                        // 0x401c29
                        function_401aa3();
                        goto lab_0x401c29;
                    }
                    goto lab_0x401be3;
                }
            }
        }
        // 0x401ceb
        function_401ace();
    }
  lab_0x401c13:
    while (true) {
        // 0x401c13
        function_401aa3();
    }
}

// Address range: 0x401d0b - 0x401dad
int64_t function_401d0b(int64_t a1, int64_t a2, int64_t a3) {
    int64_t v1 = a2; // 0x401d27
    int64_t lpOverlapped; // 0x401d0b
    int32_t nNumberOfBytesToWrite; // 0x401d0b
    int64_t * lpBuffer; // 0x401d0b
    if (a2 == 0) {
      lab_0x401d3a:
        // 0x401d3a
        lpOverlapped = function_401dad();
        nNumberOfBytesToWrite = 0;
        lpBuffer = NULL;
    } else {
        int64_t v2; // 0x401d0b
        int64_t v3 = v2;
        int64_t v4 = v3 + 8;
        while (*(int64_t *)v4 == 0) {
            // 0x401d31
            v1--;
            if (v1 == 0) {
                goto lab_0x401d3a;
            }
            v3 += 16;
            v4 = v3 + 8;
        }
        // 0x401d48
        lpOverlapped = function_401dad();
        nNumberOfBytesToWrite = *(int32_t *)v4;
        lpBuffer = (int64_t *)*(int64_t *)v3;
    }
    int64_t * hFile = (int64_t *)a1; // 0x401d66
    int32_t lpNumberOfBytesWritten; // bp-76, 0x401d0b
    int64_t result; // 0x401d0b
    if (!WriteFile(hFile, lpBuffer, nNumberOfBytesToWrite, &lpNumberOfBytesWritten, (struct _OVERLAPPED *)lpOverlapped)) {
        // 0x401d9d
        result = function_40297a();
    } else {
        // 0x401d86
        FlushFileBuffers(hFile);
        result = lpNumberOfBytesWritten;
    }
    // 0x401da2
    return result;
}

// Address range: 0x401dad - 0x401dd2
int64_t function_401dad(void) {
    // 0x401dad
    int64_t v1; // 0x401dad
    if (v1 != -1) {
        // 0x401db9
        __asm_rep_stosd_memset((char *)v1, 0, 8);
    }
    // 0x401dce
    return 0;
}

// Address range: 0x401dd2 - 0x401deb
int64_t function_401dd2(void) {
    // 0x401dd2
    int64_t hFile; // 0x401dd2
    return GetFileType((int64_t *)hFile);
}

// Address range: 0x401deb - 0x401e01
int64_t function_401deb(void) {
    // 0x401deb
    return GetLastError();
}

// Address range: 0x401e02 - 0x401e0a
int64_t function_401e02(void) {
    // 0x401e02
    return &g41;
}

// Address range: 0x401e0a - 0x401e45
int64_t function_401e0a(void) {
    int64_t v1 = function_401eaa(); // 0x401e1b
    if ((int32_t)v1 == -1) {
        // 0x401e40
        return 0xffffffff;
    }
    int64_t result = 0xffffffff; // 0x401e3b
    int64_t v2; // 0x401e0a
    if ((int32_t)function_401e45(v2) != -1) {
        // 0x401e3d
        result = v1 + 1 & 0xffffffff;
    }
    // 0x401e40
    return result;
}

// Address range: 0x401e45 - 0x401eaa
int64_t function_401e45(int64_t a1) {
    // 0x401e45
    int64_t v1; // 0x401e45
    uint64_t v2 = v1;
    if ((int32_t)v2 == -1) {
        // 0x401e90
        return function_401f6e();
    }
    int32_t * v3 = (int32_t *)(v1 + 20); // 0x401e51
    char v4 = v2; // 0x401e58
    *(char *)(*(int64_t *)(v1 + 24) + (int64_t)*v3) = v4;
    int64_t v5; // 0x401e45
    int64_t v6 = v5;
    uint32_t result = *(int32_t *)(v6 + 32) - 1 & *(int32_t *)(v6 + 20) + 1; // 0x401e67
    int32_t v7 = *(int32_t *)(v1 + 16); // 0x401e69
    *v3 = result;
    if (result != v7) {
        char v8 = *(char *)&v5; // 0x401e75
        if (v8 != 2) {
            if (v4 == 10 != (v8 == 1)) {
                // 0x401e90
                return v2 % 256;
            }
        }
    }
    // 0x401e87
    if (*(int64_t *)(v1 + 48) != 0) {
        // 0x401e90
        return result;
    }
    if (result == v7) {
        // 0x401e90
        return function_401f6e();
    }
    // 0x401e90
    return v2 % 256;
}

// Address range: 0x401eaa - 0x401f6e
int64_t function_401eaa(void) {
    // 0x401eaa
    int64_t v1; // 0x401eaa
    int32_t * v2 = (int32_t *)(v1 + 20);
    int64_t v3 = 1; // 0x401ebb
    int64_t result; // 0x401eaa
    while (true) {
        // 0x401ebe
        int64_t v4; // 0x401eaa
        char v5 = *(char *)v4; // 0x401ebe
        result = v3;
        if (v5 == 0) {
            return result;
        }
        int64_t v6 = v4 + 1; // 0x401ed1
        *(char *)(*(int64_t *)(v1 + 24) + (int64_t)*v2) = v5;
        uint32_t v7 = *(int32_t *)(v1 + 32); // 0x401ed7
        int64_t v8 = v7; // 0x401ed7
        uint32_t v9 = *v2 + 1 & v7 - 1; // 0x401ee2
        int32_t v10 = *(int32_t *)(v1 + 16); // 0x401ee4
        *v2 = v9;
        unsigned char v11; // 0x401eee
        if (v9 != v10) {
            // 0x401eee
            v11 = *(char *)&v8;
            v8 = v8 & -256 | (int64_t)v11;
            if (v11 != 2) {
                if (v5 == 10 != (v11 == 1)) {
                    // break -> 0x401f56
                    break;
                }
            }
        }
        int64_t v12 = v9; // 0x401f08
        if (*(int64_t *)(v1 + 48) == 0) {
            if (v9 != v10) {
                // break -> 0x401f56
                break;
            }
            // 0x401f15
            v12 = function_401f6e();
        }
        int64_t v13 = v12;
        while ((int32_t)v13 == -1) {
            // 0x401f25
            if (0x100000000 * function_401fa1() >> 32 != g9) {
                int64_t v14 = v13 & 0xffffffff; // 0x401f20
                result = v14;
                if ((int32_t)function_401f97() == 0) {
                    return result;
                } else {
                    // 0x401f44
                    *(int32_t *)(v1 + 8) = g14;
                    g41 = g14;
                    result = v14;
                    return result;
                }
            }
            v5 = *(char *)v6;
            result = v3;
            if (v5 == 0) {
                return result;
            }
            // 0x401eca
            v6++;
            *(char *)(*(int64_t *)(v1 + 24) + (int64_t)*v2) = v5;
            v7 = *(int32_t *)(v1 + 32);
            v8 = v7;
            v9 = *v2 + 1 & v7 - 1;
            v10 = *(int32_t *)(v1 + 16);
            *v2 = v9;
            if (v9 != v10) {
                // 0x401eee
                v11 = *(char *)&v8;
                v8 = v8 & -256 | (int64_t)v11;
                if (v11 != 2) {
                    if (v5 == 10 != (v11 == 1)) {
                        // break -> 0x401f56
                        break;
                    }
                }
            }
            // 0x401f01
            v12 = v9;
            if (*(int64_t *)(v1 + 48) == 0) {
                if (v9 != v10) {
                    // break -> 0x401f56
                    break;
                }
                // 0x401f15
                v12 = function_401f6e();
            }
            // 0x401f1d
            v13 = v12;
        }
        // 0x401f56
        v4 = v6;
        v3 = v3 + 1 & 0xffffffff;
    }
  lab_0x401f62:
    // 0x401f62
    return result;
}

// Address range: 0x401f6e - 0x401f97
int64_t function_401f6e(void) {
    // 0x401f6e
    int64_t v1; // 0x401f6e
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x401f7d
    int32_t v3 = *v2; // 0x401f7d
    *v2 = v3 < 1 ? -1 : v3;
    return -1;
}

// Address range: 0x401f97 - 0x401fa1
int64_t function_401f97(void) {
    // 0x401f97
    int64_t v1; // 0x401f97
    return *(int32_t *)(v1 + 8) == -1;
}

// Address range: 0x401fa1 - 0x401faf
int64_t function_401fa1(void) {
    // 0x401fa1
    int64_t v1; // 0x401fa1
    uint32_t v2 = *(int32_t *)(v1 + 8); // 0x401fa1
    return v2 >= 0 ? (int64_t)v2 : 0;
}

// Address range: 0x401faf - 0x40205a
int64_t function_401faf(void) {
    // 0x401faf
    int64_t v1; // 0x401faf
    int64_t v2; // 0x401faf
    if (v2 == 0) {
        // 0x401fc0
        if (g25 == 0) {
            // 0x40204f
            return 0;
        }
        int64_t v3 = g25;
        int64_t v4 = 0;
        v3--;
        int64_t v5 = v4; // 0x401fe2
        int64_t v6; // 0x401fe4
        if (*(int64_t *)(8 * v3 + (int64_t)g27) != 0) {
            // 0x401fe4
            v6 = function_401faf();
            if ((int32_t)v6 == -1) {
                // break -> 0x40204f
                break;
            }
            // 0x401ff4
            v5 = v6 + v4 & 0xffffffff;
        }
        int64_t v7 = v5;
        v1 = v7;
        while (v3 != 0) {
            // 0x401fd4
            v4 = v7;
            v3--;
            v5 = v4;
            if (*(int64_t *)(8 * v3 + (int64_t)g27) != 0) {
                // 0x401fe4
                v6 = function_401faf();
                v1 = 0xffffffff;
                if ((int32_t)v6 == -1) {
                    // break -> 0x40204f
                    break;
                }
                // 0x401ff4
                v5 = v6 + v4 & 0xffffffff;
            }
            // 0x401ff7
            v7 = v5;
            v1 = v7;
        }
        // 0x40204f
        return v1 & 0xffffffff;
    }
    // 0x401ffc
    if (*(int32_t *)(v2 + 12) == -1) {
        // 0x40204f
        return 0;
    }
    int32_t v8 = *(int32_t *)(v2 + 4); // 0x402005
    if ((g15 & v8) == 0) {
        // 0x40204f
        return 0;
    }
    uint32_t v9 = *(int32_t *)(v2 + 8); // 0x402011
    if (v9 != 0) {
        // 0x40204f
        return (int64_t)(v9 == -1 ? 0 : v8) & 0xffffffff;
    }
    int64_t v10 = v9; // 0x402011
    int32_t * v11 = (int32_t *)(v2 + 20); // 0x40201a
    int32_t * v12 = (int32_t *)(v2 + 16); // 0x40201d
    if (*v12 == *v11) {
        // 0x40204f
        return v10 & 0xffffffff;
    }
    int64_t v13 = v10; // 0x402020
    int64_t v14 = function_402083(); // 0x402026
    v1 = 0xffffffff;
    while ((int32_t)v14 != -1) {
        // 0x402030
        v13 = v14 + v13 & 0xffffffff;
        v1 = v13;
        if (*v12 == *v11) {
            // break -> 0x40204f
            break;
        }
        v14 = function_402083();
        v1 = 0xffffffff;
    }
    // 0x40204f
    return v1 & 0xffffffff;
}

// Address range: 0x40205a - 0x402083
int64_t function_40205a(void) {
    int64_t v1 = (int64_t)g25 - 1;
    while (v1 != -1) {
        int64_t result = v1 - 1; // 0x402075
        int64_t * v2 = (int64_t *)(8 * v1 + (int64_t)g27);
        int64_t v3; // 0x40205a
        if (*v2 == v3) {
            // 0x40207d
            *v2 = 0;
            return result;
        }
        v1 = result;
    }
    // 0x402082
    return -1;
}

// Address range: 0x402083 - 0x4020d8
int64_t function_402083(void) {
    // 0x402083
    int64_t v1; // 0x402083
    int32_t * v2 = (int32_t *)(v1 + 16); // 0x40208d
    uint32_t v3 = *v2; // 0x40208d
    uint32_t v4 = *(int32_t *)(v1 + 20); // 0x402090
    int32_t v5 = v4; // 0x402095
    if (v3 >= v4) {
        // 0x402097
        v5 = *(int32_t *)(v1 + 32);
    }
    int64_t v6 = (int64_t)v5 - (int64_t)v3 & 0xffffffff; // 0x40209a
    int64_t v7 = function_40247a(v1, v6, v1, v1); // 0x4020a8
    int64_t result; // 0x402083
    if (v7 != -1) {
        // 0x4020bd
        *v2 = *v2 + (int32_t)v7 & *(int32_t *)(v1 + 32) - 1;
        result = v6;
    } else {
        // 0x4020b3
        result = function_402150();
    }
    // 0x4020d3
    return result;
}

// Address range: 0x4020d8 - 0x402115
int64_t function_4020d8(int64_t a1, int64_t a2, int64_t a3) {
    // 0x4020d8
    int64_t v1; // 0x4020d8
    int32_t * v2 = (int32_t *)(v1 + 20); // 0x4020db
    int32_t v3 = *v2; // 0x4020db
    int32_t * v4 = (int32_t *)(v1 + 16); // 0x4020de
    int64_t result = 0; // 0x4020e1
    if (v3 == *v4) {
      lab_0x402111:
        // 0x402111
        return result;
    }
    int32_t * v5 = (int32_t *)(v1 + 12); // 0x4020e3
    int64_t v6 = 0;
    int16_t v7 = (int16_t)*v5;
    unsigned char v8 = __asm_in(v7 + 5); // 0x4020e9
    int32_t v9 = v3; // 0x4020ec
    int16_t v10 = v7; // 0x4020ec
    int32_t v11; // 0x4020db
    int16_t v12; // 0x4020d8
    unsigned char v13; // 0x4020e9
    if (v8 % 2 == 0) {
        __asm_pause();
        v11 = *v2;
        result = v6;
        if (v11 == *v4) {
            return result;
        }
        // 0x4020e3
        v12 = (int16_t)*v5;
        v13 = __asm_in(v12 + 5);
        v9 = v11;
        v10 = v12;
        while (v13 % 2 == 0) {
            // 0x4020ee
            __asm_pause();
            v11 = *v2;
            result = v6;
            if (v11 == *v4) {
                return result;
            }
            // 0x4020e3
            v12 = (int16_t)*v5;
            v13 = __asm_in(v12 + 5);
            v9 = v11;
            v10 = v12;
        }
    }
    char v14 = __asm_in(v10); // 0x4020f4
    int64_t result2 = v6 + 1 & 0xffffffff; // 0x4020f9
    *(char *)(*(int64_t *)(v1 + 24) + (int64_t)v9) = v14;
    int32_t v15 = *v2 + 1 & *(int32_t *)(v1 + 32) - 1; // 0x40210a
    *v2 = v15;
    while (v15 != *v4) {
        // 0x4020e3
        v6 = result2;
        v7 = (int16_t)*v5;
        v8 = __asm_in(v7 + 5);
        v9 = v15;
        v10 = v7;
        if (v8 % 2 == 0) {
            __asm_pause();
            v11 = *v2;
            result = v6;
            if (v11 == *v4) {
                return result;
            }
            // 0x4020e3
            v12 = (int16_t)*v5;
            v13 = __asm_in(v12 + 5);
            v9 = v11;
            v10 = v12;
            while (v13 % 2 == 0) {
                // 0x4020ee
                __asm_pause();
                v11 = *v2;
                result = v6;
                if (v11 == *v4) {
                    return result;
                }
                // 0x4020e3
                v12 = (int16_t)*v5;
                v13 = __asm_in(v12 + 5);
                v9 = v11;
                v10 = v12;
            }
        }
        // 0x4020f2
        v14 = __asm_in(v10);
        result2 = v6 + 1 & 0xffffffff;
        *(char *)(*(int64_t *)(v1 + 24) + (int64_t)v9) = v14;
        v15 = *v2 + 1 & *(int32_t *)(v1 + 32) - 1;
        *v2 = v15;
    }
    // 0x402111
    return result2;
}

// Address range: 0x402115 - 0x402150
int64_t function_402115(int64_t a1, int64_t a2, int64_t a3) {
    // 0x402115
    int64_t v1; // 0x402115
    int32_t * v2 = (int32_t *)(v1 + 16); // 0x402118
    int32_t v3 = *v2; // 0x402118
    int32_t * v4 = (int32_t *)(v1 + 20); // 0x40211b
    int64_t result = 0; // 0x40211e
    if (*v4 == v3) {
      lab_0x40214c:
        // 0x40214c
        return result;
    }
    int32_t * v5 = (int32_t *)(v1 + 12); // 0x402120
    int64_t * v6 = (int64_t *)(v1 + 24);
    int64_t v7 = 0;
    int16_t v8 = (int16_t)*v5;
    char v9 = __asm_in(v8 + 5); // 0x402126
    int32_t v10 = v3; // 0x402129
    int16_t v11 = v8; // 0x402129
    int32_t v12; // 0x402118
    int16_t v13; // 0x402115
    char v14; // 0x402126
    if ((v9 & 32) == 0) {
        __asm_pause();
        v12 = *v2;
        result = v7;
        if (*v4 == v12) {
            return result;
        }
        // 0x402120
        v13 = (int16_t)*v5;
        v14 = __asm_in(v13 + 5);
        v10 = v12;
        v11 = v13;
        while ((v14 & 32) == 0) {
            // 0x40212b
            __asm_pause();
            v12 = *v2;
            result = v7;
            if (*v4 == v12) {
                return result;
            }
            // 0x402120
            v13 = (int16_t)*v5;
            v14 = __asm_in(v13 + 5);
            v10 = v12;
            v11 = v13;
        }
    }
    // 0x40212f
    __asm_out(v11, *(char *)(*v6 + (int64_t)v10));
    int64_t result2 = v7 + 1 & 0xffffffff; // 0x402140
    int32_t v15 = *(int32_t *)(v1 + 32) - 1 & v10 + 1; // 0x402145
    *v2 = v15;
    while (*v4 != v15) {
        // 0x402120
        v7 = result2;
        v8 = (int16_t)*v5;
        v9 = __asm_in(v8 + 5);
        v10 = v15;
        v11 = v8;
        if ((v9 & 32) == 0) {
            __asm_pause();
            v12 = *v2;
            result = v7;
            if (*v4 == v12) {
                return result;
            }
            // 0x402120
            v13 = (int16_t)*v5;
            v14 = __asm_in(v13 + 5);
            v10 = v12;
            v11 = v13;
            while ((v14 & 32) == 0) {
                // 0x40212b
                __asm_pause();
                v12 = *v2;
                result = v7;
                if (*v4 == v12) {
                    return result;
                }
                // 0x402120
                v13 = (int16_t)*v5;
                v14 = __asm_in(v13 + 5);
                v10 = v12;
                v11 = v13;
            }
        }
        // 0x40212f
        __asm_out(v11, *(char *)(*v6 + (int64_t)v10));
        result2 = v7 + 1 & 0xffffffff;
        v15 = *(int32_t *)(v1 + 32) - 1 & v10 + 1;
        *v2 = v15;
    }
    // 0x40214c
    return result2;
}

// Address range: 0x402150 - 0x40215b
int64_t function_402150(void) {
    // 0x402150
    int64_t result; // 0x402150
    return result;
}

// Address range: 0x40215b - 0x4021f0
int64_t function_40215b(int64_t a1, int32_t a2) {
    int64_t v1 = (int64_t)g29; // 0x402179
    if (g29 == NULL) {
        // 0x40217b
        g29 = (int32_t *)&g30;
        v1 = &g30;
    }
    int32_t * v2 = (int32_t *)v1; // 0x402189
    int32_t v3 = *v2; // 0x402189
    int64_t result; // 0x40215b
    if (v3 != -1) {
        uint32_t v4 = llvm_ctlz_i32(-1 - v3, true) ^ 31; // 0x4021c8
        *v2 = 1 << v4 | v3;
        *(int64_t *)(v1 + (int64_t)(24 * v4) + 32) = (int64_t)a2;
        result = 0;
    } else {
        // 0x40218e
        result = function_401836();
    }
    // 0x4021e7
    return result;
}

// Address range: 0x4021f0 - 0x402286
int64_t function_4021f0(int64_t a1, int64_t result) {
    // 0x4021f0
    if (g29 == NULL) {
        // 0x40227e
        return result;
    }
    int64_t v1 = a1;
    int32_t v2; // 0x4021f0
    int32_t v3; // 0x4021f0
    int32_t v4; // 0x40223a
    int64_t v5; // 0x4021f0
    int64_t v6; // 0x4021f0
    int64_t v7; // 0x4021f0
    int64_t v8; // 0x4021f0
    int64_t v9; // 0x4021f0
    uint32_t v10; // 0x4021f0
    int32_t * v11; // 0x402211
    while (true) {
        int64_t v12 = v1; // 0x40220c
        int64_t v13 = (int64_t)g29; // 0x40220c
        int64_t v14; // 0x4021f0
        int64_t v15; // 0x4021f0
        int64_t v16; // 0x4021f0
        int64_t v17; // 0x4021f0
        uint32_t v18; // 0x402211
        int64_t v19; // 0x402253
        int32_t v20; // 0x402218
        uint32_t v21; // 0x402218
        int64_t v22; // 0x402218
        while (true) {
            // 0x402211
            v16 = v13;
            v14 = v12;
            v11 = (int32_t *)v16;
            v18 = *v11;
            v9 = v14;
            if (v18 != 0) {
                // 0x402218
                v2 = v18;
                v7 = v14;
                v5 = v18;
                while (true) {
                    // 0x402218
                    v6 = v5;
                    v4 = v2;
                    v20 = v6;
                    v21 = v20 == 0 ? (int32_t)v7 : llvm_cttz_i32(v20, true);
                    v22 = v21;
                    v10 = (-1 << v21 % 32) - 1;
                    v1 = 24 * v22 + v16;
                    if (v17 == 0) {
                        goto lab_0x402236;
                    } else {
                        // 0x40222b
                        v3 = v4;
                        v8 = v22;
                        if (*(int64_t *)(v1 + 32) != v17) {
                            goto lab_0x402213;
                        } else {
                            goto lab_0x402236;
                        }
                    }
                }
            }
            // 0x402250
            v15 = v9;
            v19 = *(int64_t *)(v16 + 8);
            if (v17 == 0) {
                // break -> 0x402259
                break;
            }
            // 0x402274
            v12 = v15;
            v13 = v19;
            if (v19 == 0) {
                return result;
            }
        }
        // 0x402259
        *(int64_t *)&g29 = v19;
        while (v19 != 0) {
            // 0x40220c
            v12 = v15;
            v13 = (int64_t)(int32_t *)v19;
            while (true) {
                // 0x402211
                v16 = v13;
                v14 = v12;
                v11 = (int32_t *)v16;
                v18 = *v11;
                v9 = v14;
                if (v18 != 0) {
                    // 0x402218
                    v2 = v18;
                    v7 = v14;
                    v5 = v18;
                    while (true) {
                        // 0x402218
                        v6 = v5;
                        v4 = v2;
                        v20 = v6;
                        v21 = v20 == 0 ? (int32_t)v7 : llvm_cttz_i32(v20, true);
                        v22 = v21;
                        v10 = (-1 << v21 % 32) - 1;
                        v1 = 24 * v22 + v16;
                        if (v17 == 0) {
                            goto lab_0x402236;
                        } else {
                            // 0x40222b
                            v3 = v4;
                            v8 = v22;
                            if (*(int64_t *)(v1 + 32) != v17) {
                                goto lab_0x402213;
                            } else {
                                goto lab_0x402236;
                            }
                        }
                    }
                }
                // 0x402250
                v15 = v9;
                v19 = *(int64_t *)(v16 + 8);
                if (v17 == 0) {
                    // break -> 0x402259
                    break;
                }
                // 0x402274
                v12 = v15;
                v13 = v19;
                if (v19 == 0) {
                    return result;
                }
            }
            // 0x402259
            *(int64_t *)&g29 = v19;
        }
        return result;
      lab_0x402204:
        // 0x402204
        if (g29 == NULL) {
            // break -> 0x40227e
            break;
        }
    }
    // 0x40227e
    return result;
  lab_0x402236:;
    int32_t v23 = v4 & v10; // 0x40223a
    *v11 = v23;
    v3 = v23;
    v8 = v1;
    if (*(int64_t *)(v1 + 16) != 0) {
        // break (via goto) -> 0x402204
        goto lab_0x402204;
    }
    goto lab_0x402213;
  lab_0x402213:;
    int64_t v24 = v6 & (int64_t)v10; // 0x402223
    v2 = v3;
    v7 = v8;
    v5 = v24;
    v9 = v8;
    if (v24 == 0) {
        // break -> 0x402250
        goto lab_0x402250;
    }
    goto lab_0x402218;
}

// Address range: 0x402286 - 0x4023ce
int64_t function_402286(int64_t a1, uint64_t a2, int64_t a3) {
    // 0x402286
    int64_t v1; // 0x402286
    uint64_t v2 = v1;
    function_4023ce();
    function_4023ce();
    int64_t v3; // 0x402286
    if (v1 == 0) {
        // 0x4022d5
        v3 = a2 <= 7 ? 31 / a2 : 4;
    } else {
        // 0x4022ca
        v3 = v2 / 2 + v2;
    }
    // 0x4022ec
    if (v2 != 0 && (v2 || a2) >= 0x10000) {
        if (v2 * a2 / v2 != a2) {
            // 0x4023b8
            function_401856();
            // 0x4023bd
            return 0;
        }
    }
    uint64_t v4 = a1 + 1 + v3; // 0x40231c
    if (v4 == 0 || (v4 || a2) < 0x10000) {
        // 0x40234d
        function_401836();
        // 0x4023bd
        return 0;
    }
    if (v4 * a2 / v4 == a2) {
        // 0x40234d
        function_401836();
        // 0x4023bd
        return 0;
    }
    // 0x4023b8
    function_401856();
    // 0x4023bd
    return 0;
}

// Address range: 0x4023ce - 0x40243f
int64_t function_4023ce(void) {
    // 0x4023ce
    int64_t v1; // 0x4023ce
    uint64_t v2 = v1;
    if ((v2 < 0xfffff00000000001 ? v2 : v2 + 0xfffffffffff) == 0x600000000000) {
        // 0x402437
        return 0;
    }
    int64_t v3 = function_40243f(); // 0x40240c
    if (v3 == 0) {
        // 0x402437
        return 0;
    }
    int64_t v4 = 8 * v3; // 0x40241b
    int32_t v5 = v2 / 0x10000; // 0x40241b
    int64_t result = 1; // 0x402428
    if (*(int32_t *)(v4 + (int64_t)&g31) != v5) {
        int32_t v6 = *(int32_t *)(v4 + (int64_t)&g31 + 4); // 0x40242c
        result = v6 == v5;
    }
    // 0x402437
    return result;
}

// Address range: 0x40243f - 0x40245f
int64_t function_40243f(void) {
    int64_t v1 = 0; // 0x402443
    int64_t v2; // 0x40243f
    if (v2 <= 0) {
      lab_0x40245c:
        // 0x40245c
        return 0x100000000 * v1 >> 32;
    }
    int64_t v3 = 0;
    int64_t v4; // 0x40243f
    int32_t v5 = (int32_t)(v3 + v4) >> 1; // 0x402448
    int64_t v6; // 0x402453
    while (v2 >= (int64_t)*(int32_t *)(8 * (int64_t)v5 + v2)) {
        // 0x402453
        v6 = v5 + 1;
        v1 = v6;
        if (v4 <= v6) {
            return 0x100000000 * v1 >> 32;
        }
        v3 = v6;
        v5 = (int32_t)(v3 + v4) >> 1;
    }
    int64_t v7 = v5; // 0x402448
    while (v3 < v7) {
        uint64_t v8 = v7;
        v5 = (int32_t)(v3 + v8) >> 1;
        while (v2 >= (int64_t)*(int32_t *)(8 * (int64_t)v5 + v2)) {
            // 0x402453
            v6 = v5 + 1;
            v1 = v6;
            if (v8 <= v6) {
                return 0x100000000 * v1 >> 32;
            }
            v3 = v6;
            v5 = (int32_t)(v3 + v8) >> 1;
        }
        // 0x402458
        v7 = v5;
    }
    // 0x40245c
    return 0x100000000 * v3 >> 32;
}

// Address range: 0x40245f - 0x40247a
int64_t function_40245f(void) {
    int64_t result = 0; // 0x402463
    int64_t v1; // 0x40245f
    if ((int32_t)v1 != 0) {
        int32_t v2 = *(int32_t *)(24 * (0x100000000 * v1 >> 32) + 16 + g34); // 0x402473
        result = v2 == (int32_t)v1;
    }
    // 0x402479
    return result;
}

// Address range: 0x40247a - 0x4025a2
int64_t function_40247a(int64_t a1, int64_t a2, int64_t a3, int64_t a4) {
    // 0x40247a
    int64_t v1; // 0x40247a
    if ((int32_t)v1 == -1) {
        // 0x402596
        return 0x100000000 * function_401826() >> 32;
    }
    // 0x40249d
    if ((char)function_40245f() != 0) {
        // 0x402596
        return 0;
    }
    // 0x4024e6
    if ((*(char *)&g7 & 4) == 0) {
        // 0x402596
        return function_4025c0();
    }
    // 0x402502
    if ((char)function_40245f() != 0) {
        // 0x402596
        return 0;
    }
    // 0x402545
    if ((char)function_40245f() != 0) {
        // 0x402596
        return function_401d0b(-1, 1, a3);
    }
    int64_t result = function_40245f(); // 0x40255e
    if ((char)result == 0) {
        // 0x402596
        return result;
    }
    // 0x402596
    return function_401d0b(-1, 1, a3);
}

// Address range: 0x4025b0 - 0x4025c0
int64_t function_4025b0(void) {
    // 0x4025b0
    return 0x35022721530005;
}

// Address range: 0x4025c0 - 0x4025d0
int64_t function_4025c0(void) {
    // 0x4025c0
    return 0x4000420040001;
}

// Address range: 0x4025d0 - 0x4025fa
int64_t function_4025d0(int64_t a1) {
    // 0x4025d0
    int64_t v1; // 0x4025d0
    if ((int32_t)(0x1000000000000 * v1 >> 48) < 0) {
        // 0x4025e7
        g41 = g12;
        return -1;
    }
    uint64_t result = __asm_syscall(); // 0x4025da
    if (result < 0xfffffffffffff001) {
        // 0x4025e4
        return result;
    }
    // 0x4025e7
    g41 = -result & 0xffffffff;
    return -1;
}

// Address range: 0x4025fa - 0x402600
int64_t function_4025fa(void) {
    // 0x4025fa
    int64_t v1; // 0x4025fa
    return function_402607(v1);
}

// Address range: 0x402600 - 0x402607
int64_t function_402600(void) {
    // 0x402600
    int64_t v1; // 0x402600
    return (uint64_t)v1 / 0x100000000 % 0x10000;
}

// Address range: 0x402607 - 0x402615
int64_t function_402607(int64_t a1) {
    // 0x402607
    return __asm_syscall();
}

// Address range: 0x402615 - 0x40262d
int64_t function_402615(void) {
    // 0x402615
    int64_t v1; // 0x402615
    return function_402607(v1);
}

// Address range: 0x40262d - 0x40263c
int64_t function_40262d(int64_t a1, int64_t a2) {
    // 0x40262d
    return function_40266f(a1, a2);
}

// Address range: 0x40263c - 0x40266f
int64_t function_40263c(int64_t a1, int64_t a2) {
    // 0x40263c
    int64_t v1; // 0x40263c
    int64_t result = v1 & 0xffffffff; // 0x40263e
    uint32_t v2 = (int32_t)v1; // 0x402642
    if (v2 < 128) {
        // 0x402669
        return result;
    }
    uint32_t v3 = *(int32_t *)(int64_t)((2 * llvm_ctlz_i32(v2, true) ^ 62) + 0x4029b5); // 0x40264f
    int64_t v4 = 0; // 0x40264f
    uint64_t v5 = (int64_t)v3;
    int64_t v6 = result / 64; // 0x402655
    v4 = 256 * (result % 64 | v4 & 0xffffffffffff00) | 0x8000;
    unsigned char v7 = (char)v5 - 1; // 0x402663
    int64_t v8 = v5 & -256 | (int64_t)v7; // 0x402665
    while (v7 != 0) {
        uint64_t v9 = v6;
        v5 = v8;
        v6 = v9 / 64;
        v4 = 256 * (v9 % 64 | v4 & 0xffffffffffff00) | 0x8000;
        v7 = (char)v5 - 1;
        v8 = v5 & -256 | (int64_t)v7;
    }
    // 0x402669
    return v6 | v4 | v5 / 256 % 256;
}

// Address range: 0x40266f - 0x4026d0
int64_t function_40266f(int64_t a1, int64_t a2) {
    int64_t result2 = 0; // 0x402679
    int64_t v1; // 0x40266f
    uint16_t v2; // 0x402680
    while (true) {
      lab_0x40267a:;
        int64_t v3 = result2;
        result2 = v3 + 1 & 0xffffffff;
        v2 = *(int16_t *)(2 * v3 + v1);
        switch (v2 & -1024) {
            case -0x2400: {
                goto lab_0x40267a;
            }
            case -0x2800: {
                uint16_t v4 = *(int16_t *)(2 * result2 + v1); // 0x40269d
                int64_t result; // 0x40266f
                if ((v4 & -1024) == -0x2400) {
                    // 0x4026ba
                    *(int32_t *)v1 = 1024 * (int32_t)v2 - 0x35fdc00 + (int32_t)v4;
                    result = v3 + 2 & 0xffffffff;
                } else {
                    // 0x4026af
                    *(int32_t *)v1 = 0xfffd;
                    result = 0xffffffff;
                }
                // 0x4026c9
                return result;
            }
            default: {
                goto lab_0x402699;
            }
        }
    }
  lab_0x402699:
    // 0x402699
    *(int32_t *)v1 = (int32_t)v2;
    // 0x4026c9
    return result2;
}

// Address range: 0x4026d0 - 0x40273b
int64_t function_4026d0(void) {
    // 0x4026d0
    int64_t v1; // 0x4026d0
    uint64_t v2 = v1;
    if ((char)v2 < 93) {
        // 0x4026d8
        return 92;
    }
    int64_t result = v2 % 256; // 0x40270b
    if ((int32_t)result >= 128) {
        // 0x4026d8
        return (0x2000 * v2 & 0x70000 | 0x1000000 * v2 | 4 * result) & 0x7070300 | 0x3030305c;
    }
    // 0x402714
    if ((*(char *)(result + (int64_t)&g6) & 16) != 0) {
        // 0x4026d8
        return result;
    }
    // 0x4026d8
    return (0x2000 * v2 & 0x70000 | 0x1000000 * v2 | 4 * result) & 0x7070300 | 0x3030305c;
}

// Address range: 0x402750 - 0x402764
int64_t function_402750(int64_t a1, int64_t a2) {
    // 0x402750
    int64_t result; // 0x402750
    return result;
}

// Address range: 0x402764 - 0x40286d
int64_t function_402764(int64_t a1, uint64_t a2, int64_t a3) {
    // 0x402764
    int64_t result; // 0x402764
    int64_t v1; // 0x402764
    if (a2 < 1024) {
        int64_t v2 = 32;
        int64_t v3 = v2 + 32; // 0x402778
        int64_t v4 = v2 - 32;
        __asm_vmovdqu_1(*(int256_t *)(v4 + v1), __asm_vmovdqu(*(int256_t *)(v4 + v1)));
        while (v3 < a2) {
            // 0x402778
            v2 = v3;
            v3 = v2 + 32;
            v4 = v2 - 32;
            __asm_vmovdqu_1(*(int256_t *)(v4 + v1), __asm_vmovdqu(*(int256_t *)(v4 + v1)));
        }
        int64_t v5 = a2 - 32;
        int256_t v6 = __asm_vmovdqu(*(int256_t *)(v1 + v5)); // 0x40278d
        __asm_vmovdqu_1(*(int256_t *)(v1 + v5), v6);
        __asm_vxorps(v6, v6);
        // 0x4027e7
        return result;
    }
    if (a2 < 0x400001) {
        // 0x402813
        __asm_rep_movsb_memcpy((char *)v1, (char *)v1, a2);
        // 0x4027e7
        return result;
    }
    // 0x40281e
    int64_t v7; // 0x402764
    int128_t v8 = *(int128_t *)&v7; // 0x40281e
    int128_t v9 = __asm_movdqu(v8); // 0x40281e
    int64_t v10; // 0x402764
    int128_t v11 = *(int128_t *)&v10; // 0x402822
    __asm_movdqu_2(v11, v9);
    int64_t v12 = v11;
    int64_t v13 = v12 + 16 & -16; // 0x40282a
    int64_t v14 = v13 - v12; // 0x40282e
    v10 = v13;
    int64_t v15 = v14 + (int64_t)v8; // 0x402834
    v7 = v15;
    uint64_t v16 = a2 - v14; // 0x402837
    int64_t v17 = 16;
    int64_t v18 = v17 + 16; // 0x402841
    int64_t v19 = v17 - 16;
    __asm_movntdq(*(int128_t *)(v19 + v13), __asm_movdqu(*(int128_t *)(v19 + v15)));
    while (v16 > v18) {
        // 0x402841
        v17 = v18;
        v18 = v17 + 16;
        v19 = v17 - 16;
        __asm_movntdq(*(int128_t *)(v19 + v13), __asm_movdqu(*(int128_t *)(v19 + v15)));
    }
    int64_t result2 = __asm_sfence(); // 0x402856
    int64_t v20 = v16 - 16;
    int128_t v21 = __asm_movdqu(*(int128_t *)(v20 + v15)); // 0x402859
    __asm_movdqu_2(*(int128_t *)(v20 + v13), v21);
    __asm_xorps(v21, v21);
    // 0x4027e7
    return result2;
}

// Address range: 0x402870 - 0x40288a
int64_t function_402870(int64_t a1, int64_t a2) {
    // 0x402870
    int64_t result; // 0x402870
    __asm_movd((int32_t)result);
    return result;
}

// Address range: 0x40288a - 0x40293c
int64_t function_40288a(int64_t a1, uint64_t a2, int64_t a3) {
    // 0x40288a
    int64_t result; // 0x40288a
    if (a2 >= 1024) {
        // 0x40292f
        __asm_rep_stosb_memset((char *)result, (char)result, a2);
        // 0x4028ef
        return result;
    }
    // 0x402897
    int128_t v1; // 0x40288a
    int256_t v2 = __asm_vpbroadcastb(v1); // 0x402897
    int64_t v3 = 32; // 0x40289c
    v3 += 32;
    __asm_vmovdqu_1(*(int256_t *)(result - 64 + v3), v2);
    while (v3 < a2) {
        // 0x4028a1
        v3 += 32;
        __asm_vmovdqu_1(*(int256_t *)(result - 64 + v3), v2);
    }
    // 0x4028b0
    __asm_vmovdqu_1(*(int256_t *)(a2 - 32 + result), v2);
    __asm_vxorps(v2, v2);
    // 0x4028ef
    return result;
}

// Address range: 0x402941 - 0x402972
int64_t function_402941(void) {
    // 0x402941
    g42 |= 4;
    if ((*(char *)&g7 & 4) != 0) {
        // 0x402951
        int64_t v1; // 0x402941
        ExitProcess((int32_t)v1 % 256);
        // UNREACHABLE
    }
    // 0x40295e
    __asm_syscall();
    __asm_lidt(*(int80_t *)0x402972);
    while (true) {
        // 0x40296f
        __asm_hlt();
    }
}

// Address range: 0x40297a - 0x40297b
int64_t function_40297a(void) {
    // 0x40297a
    int64_t result; // 0x40297a
    return result;
}

// Address range: 0x40297c - 0x402998
int64_t function_40297c(int64_t a1) {
    // 0x40297c
    int64_t v1; // 0x40297c
    int64_t v2 = v1;
    char * v3 = (char *)(v1 + 2 * v1); // 0x40297f
    char v4 = *v3; // 0x40297f
    *v3 = v4 + (char)(v2 - (int64_t)((int32_t)v1 > (int32_t)v2));
    g41 = function_401deb();
    return -1;
}

// Address range: 0x402998 - 0x40299e
int64_t function_402998(void) {
    // 0x402998
    return function_401846();
}

// Address range: 0x402efc - 0x402f12
int64_t function_402efc(int64_t a1, int64_t a2, int64_t a3) {
    // 0x402efc
    int64_t v1; // 0x402efc
    int64_t v2 = v1;
    *(char *)v2 = 2 * (char)v2;
    int64_t v3; // 0x402efc
    int64_t v4 = v3;
    *(char *)v4 = *(char *)&v3 + (char)v4;
    int32_t * v5 = (int32_t *)(v1 + a2); // 0x402f01
    *v5 = *v5 | (int32_t)v3;
    uint64_t v6 = v3 + 256 * a2;
    int64_t v7 = v6 & 0xff00; // 0x402f06
    int64_t v8 = v3 & -0xffcf | v7 | 206; // 0x402f06
    char * v9 = (char *)v8; // 0x402f08
    *v9 = *v9 + (char)(v6 / 256);
    int32_t v10 = v8; // 0x402f0a
    int64_t v11; // 0x402efc
    *(int32_t *)a1 = *(int32_t *)&v11 + v10;
    *v5 = *v5 | v10;
    return v3 & -0xffef | v7 | 238;
}

// --------------- Dynamically Linked Functions ---------------

// VOID ExitProcess(_In_ UINT uExitCode);
// BOOL FlushFileBuffers(_In_ HANDLE hFile);
// BOOL FreeEnvironmentStringsW(_In_ LPWCH penv);
// LPWSTR GetCommandLineW(VOID);
// LPWCH GetEnvironmentStringsW(void);
// DWORD GetFileType(_In_ HANDLE hFile);
// DWORD GetLastError(VOID);
// HANDLE GetStdHandle(_In_ DWORD nStdHandle);
// BOOL SetDefaultDllDirectories(_In_ DWORD DirectoryFlags);
// BOOL WriteFile(_In_ HANDLE hFile, LPCVOID lpBuffer, _In_ DWORD nNumberOfBytesToWrite, _Out_opt_ LPDWORD lpNumberOfBytesWritten, _Inout_opt_ LPOVERLAPPED lpOverlapped);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: aspack
// Detected functions: 75


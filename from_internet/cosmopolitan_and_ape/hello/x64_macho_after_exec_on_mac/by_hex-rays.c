/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __fastcall sub_400675(unsigned __int8 a1, unsigned __int16 a2);
__int64 __fastcall sub_400748(int, int);
__int64 __fastcall sub_4010FB(unsigned __int64, int, __int64, __int64 *);
__int64 sub_401214();
void sub_401297();
__int64 sub_40141F();
__int64 __fastcall sub_40156C(__int64);
__int64 __fastcall sub_401609(__int64, int *);
__int64 __fastcall sub_401636(__int64, __int64, __int64);
void __fastcall sub_40168D(int *);
__int64 __fastcall sub_4017BE(_QWORD *, unsigned __int8 *, __int64, int);
char __fastcall sub_4017EC(_BYTE *, char *);
void __fastcall __noreturn sub_4017FD(unsigned int, __int64, __int64);
__int64 sub_401816();
__int64 sub_401826();
__int64 sub_401836();
__int64 sub_401846();
__int64 sub_401856();
__int64 __fastcall sub_401AA3(unsigned __int16 **);
unsigned __int64 __fastcall sub_401ACE(__int64, unsigned int);
__int64 __fastcall sub_401AFE(unsigned __int16 *, unsigned __int64, __int64, __int64, unsigned __int64);
__int64 __fastcall sub_401D0B(_QWORD *, __int64 *, __int64, __int64);
__int64 __fastcall sub_401DAD(__int64, __int64);
__int64 __fastcall sub_401DD2(__int64, __int64, __int64);
__int64 sub_401DEB();
__int64 __fastcall sub_401E0A(char *);
__int64 __fastcall sub_401E45(int, __int64);
__int64 __fastcall sub_401EAA(char *, __int64);
__int64 __fastcall sub_401F6E(__int64);
_BOOL8 __fastcall sub_401F97(__int64);
__int64 __fastcall sub_401FA1(__int64);
__int64 __fastcall sub_401FAF(_DWORD *);
void __fastcall sub_402083(__int64);
void sub_402150();
__int64 __fastcall sub_40215B(__int64, __int64, __int64);
__int64 __fastcall sub_4021F0(__int64, __int64, __int64);
__int64 __fastcall sub_402286(__int64 *, unsigned __int64 *, unsigned __int64, __int64);
_BOOL8 __fastcall sub_4023CE(__int64);
__int64 __fastcall sub_40243F(int, __int64, int);
bool __fastcall sub_40245F(int, int);
__int64 __fastcall sub_40247A(int, __int64, __int64);
__int64 sub_4025B0();
__int64 sub_4025C0();
__int64 __fastcall sub_4025D0(); // weak
__int64 __fastcall sub_40262D(__int64, _DWORD *);
__int64 __fastcall sub_40263C(__int64);
__int64 __fastcall sub_40266F(__int64, _DWORD *);
void __fastcall sub_402750(__int64, __int64, unsigned __int64);
void __fastcall sub_402870(__int64, __int64, unsigned __int64);
void __fastcall __noreturn sub_402941(__int64, __int64, __int64);
__int64 sub_40297A();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401F76; // weak
char byte_402972[6] = { '\0', '\0', '\0', '\0', '\0', '\0' }; // weak
char byte_4029C3[5] = { '\x01', '\xC0', '\x01', '\xC0', '\x01' }; // weak
__int64 (__fastcall *qword_403018)(_QWORD, _QWORD, _QWORD, _QWORD) = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))0x2D20LL; // weak
__int64 (__fastcall *qword_403020)(_QWORD, _QWORD, _QWORD, _QWORD) = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))0x2D2ELL; // weak
__int64 (__fastcall *qword_403040)(_QWORD, _QWORD, _QWORD, _QWORD) = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))0x2D88LL; // weak
__int64 (*qword_403048)(void) = (__int64 (*)(void))0x2D96LL; // weak
__int64 qword_403050 = 11686LL; // weak
__int64 (__fastcall *qword_403060)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))0x2DD2LL; // weak
_BYTE byte_404000[27]; // weak
char byte_404035; // weak
int dword_404630; // weak
__int64 (*qword_404638)(void); // weak
int dword_404648; // weak
__int64 qword_404650; // weak
int dword_404658; // weak
int dword_404660; // weak
int dword_404668; // weak
int dword_404670; // weak
__int64 qword_404678; // weak
__int64 qword_404688; // weak
__int64 qword_406038; // weak
__int64 qword_406040; // weak
__int64 qword_406050; // weak
__int64 qword_4060A0; // weak
_UNKNOWN unk_4060A8; // weak
__int64 qword_4063C0[]; // weak
_UNKNOWN unk_4076A0; // weak
__int64 qword_4076B0; // weak
int dword_407838; // weak
int dword_40783C; // weak


//----- (0000000000400675) ----------------------------------------------------
void __fastcall sub_400675(unsigned __int8 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // al

  while ( 1 )
  {
    v2 = __inbyte(a2 + 5);
    if ( (v2 & 0x20) != 0 )
      break;
    _mm_pause();
  }
  __outbyte(a2, a1);
}

//----- (0000000000400748) ----------------------------------------------------
__int64 __fastcall sub_400748(int a1, int a2)
{
  qmemcpy((void *)(a1 & 0xFFFF8000), (const void *)(unsigned int)(a1 - a2), a1 - a2 - (a1 & 0xFFFF8000));
  return (unsigned int)(a1 - a2);
}

//----- (00000000004010FB) ----------------------------------------------------
__int64 __fastcall sub_4010FB(unsigned __int64 a1, int a2, __int64 a3, __int64 *a4)
{
  char i; // cl
  __int64 v6; // rax
  __int64 *v8; // rdx
  __int64 v9; // rax

  for ( i = 39; ; i -= 9 )
  {
    --a2;
    v6 = (a1 >> i) & 0x1FF;
    if ( a2 == -1 )
      break;
    v8 = (__int64 *)(a3 + 8 * v6);
    if ( !*v8 )
    {
      v9 = *a4 - 4096;
      *a4 = v9;
      *v8 = v9 | 3;
    }
    a3 = *v8 & 0x3FFFFFFFFF000LL;
  }
  return a3 + 8 * v6;
}

//----- (0000000000401214) ----------------------------------------------------
__int64 sub_401214()
{
  return 0LL;
}

//----- (0000000000401245) ----------------------------------------------------
#error "401245: function frame is wrong (funcsize=0)"

//----- (0000000000401297) ----------------------------------------------------
void sub_401297()
{
  _DWORD *i; // rdi
  _DWORD *v6; // rdi

  i = byte_404000;
  _RAX = 0LL;
  while ( 1 )
  {
    __asm { cpuid }
    *i = _RAX;
    v6 = i + 1;
    *v6++ = _RBX;
    *v6++ = _RCX;
    *v6 = _RDX;
    for ( i = v6 + 1; ; i += 4 )
    {
      _RAX = 1LL;
      if ( byte_404000[0] )
        break;
    }
  }
}
// 4012CD: conditional instruction was optimized away because %0x10.4==1
// 404000: using guessed type _BYTE byte_404000[27];
// 404630: using guessed type int dword_404630;
// 406038: using guessed type __int64 qword_406038;

//----- (000000000040141F) ----------------------------------------------------
__int64 sub_40141F()
{
  sub_401E0A("hello world");
  return 0LL;
}

//----- (000000000040156C) ----------------------------------------------------
__int64 __fastcall sub_40156C(__int64 a1)
{
  unsigned int v1; // er13
  int v2; // ebx
  __int64 v4; // rdx
  int v6[6]; // [rsp+10h] [rbp-100h] BYREF
  int v7; // [rsp+28h] [rbp-E8h]

  v1 = dword_404630 & 4;
  if ( (dword_404630 & 4) != 0 )
  {
    v1 = 0;
    if ( sub_40245F(a1, 1) )
      return (unsigned int)sub_401DD2(*(_QWORD *)(qword_4076B0 + 24LL * (int)a1), 1LL, v4) == 2;
  }
  else
  {
    v2 = dword_407838;
    if ( (unsigned int)sub_401609(a1, v6) != -1 )
      return (v7 & 0xF000) == 0x2000;
    dword_407838 = v2;
  }
  return v1;
}
// 4015E8: variable 'v4' is possibly undefined
// 404630: using guessed type int dword_404630;
// 4076B0: using guessed type __int64 qword_4076B0;
// 407838: using guessed type int dword_407838;
// 40156C: using guessed type int var_100[6];

//----- (0000000000401609) ----------------------------------------------------
__int64 __fastcall sub_401609(__int64 a1, int *a2)
{
  __int64 result; // rax
  unsigned int v3; // [rsp+Ch] [rbp-14h]

  result = sub_4025B0();
  if ( (_DWORD)result != -1 )
  {
    v3 = result;
    sub_40168D(a2);
    return v3;
  }
  return result;
}

//----- (0000000000401636) ----------------------------------------------------
__int64 __fastcall sub_401636(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 (__fastcall *v3)(__int64, __int64, __int64, __int64); // rbp
  __int64 v4; // rdx
  __int64 v5; // rdx
  __int64 result; // rax

  v3 = (__int64 (__fastcall *)(__int64, __int64, __int64, __int64))qword_403050;
  unk_4076A0 = 3LL;
  *((_QWORD *)&unk_4076A0 + 2) = (char *)&unk_4076A0 + 24;
  *((_QWORD *)&unk_4076A0 + 1) = 16LL;
  *((_DWORD *)&unk_4076A0 + 10) = 1;
  *((_DWORD *)&unk_4076A0 + 16) = 1;
  *((_DWORD *)&unk_4076A0 + 22) = 1;
  *((_QWORD *)&unk_4076A0 + 3) = v3(a1, a2, a3, -10LL);
  *((_QWORD *)&unk_4076A0 + 6) = v3(a1, a2, v4, -11LL);
  result = v3(a1, a2, v5, -12LL);
  *((_QWORD *)&unk_4076A0 + 9) = result;
  return result;
}
// 401675: variable 'v4' is possibly undefined
// 40167E: variable 'v5' is possibly undefined
// 403050: using guessed type __int64 qword_403050;

//----- (000000000040168D) ----------------------------------------------------
void __fastcall sub_40168D(int *a1)
{
  __int64 v1; // r14
  int v2; // er13
  __int64 v3; // r10
  __int64 v4; // r15
  __int64 v5; // r12
  __int64 v6; // r11
  __int64 v7; // r8
  __int64 v8; // rbx
  __int64 v9; // r9
  __int64 v10; // rsi
  __int64 v11; // rcx
  __int64 v12; // rdx
  __int64 v13; // rax
  __int64 v14; // r11
  __int64 v15; // rbx
  __int64 v16; // r10
  __int64 v17; // r12
  int v18; // er14
  __int64 v19; // r13
  __int64 v20; // r15

  if ( a1 )
  {
    if ( (dword_404630 & 8) != 0 )
    {
      v1 = *((unsigned __int16 *)a1 + 3);
      v2 = *((unsigned __int16 *)a1 + 2);
      v3 = a1[28];
      v4 = *a1;
      v5 = *((_QWORD *)a1 + 2);
      v6 = *((_QWORD *)a1 + 12);
      v7 = *((_QWORD *)a1 + 5);
      *((_QWORD *)a1 + 5) = a1[6];
      v8 = *((_QWORD *)a1 + 13);
      v9 = *((_QWORD *)a1 + 4);
      v10 = *((_QWORD *)a1 + 6);
      v11 = *((_QWORD *)a1 + 7);
      v12 = *((_QWORD *)a1 + 8);
      v13 = *((_QWORD *)a1 + 9);
      *(_QWORD *)a1 = v4;
      *((_QWORD *)a1 + 2) = v1;
      a1[6] = v2;
      *(_QWORD *)(a1 + 7) = v5;
      *((_QWORD *)a1 + 6) = v6;
      *((_QWORD *)a1 + 7) = v3;
      *((_QWORD *)a1 + 8) = v8;
    }
    else
    {
      if ( (dword_404630 & 0x20) != 0 )
      {
        v14 = a1[32];
        v15 = *((_QWORD *)a1 + 14);
        v16 = *((_QWORD *)a1 + 15);
        v9 = *((_QWORD *)a1 + 6);
        v7 = *((_QWORD *)a1 + 7);
        v10 = *((_QWORD *)a1 + 8);
        v11 = *((_QWORD *)a1 + 9);
        v12 = *((_QWORD *)a1 + 10);
        v13 = *((_QWORD *)a1 + 11);
        a1[6] = *((unsigned __int16 *)a1 + 12);
      }
      else
      {
        if ( (dword_404630 & 0x10) == 0 )
          return;
        v17 = a1[7];
        v18 = *a1;
        v19 = *(_QWORD *)(a1 + 5);
        v14 = a1[24];
        v15 = *((_QWORD *)a1 + 10);
        v16 = *((_QWORD *)a1 + 11);
        v10 = *((_QWORD *)a1 + 6);
        *(_QWORD *)a1 = a1[1];
        v20 = (unsigned int)a1[4];
        v11 = *((_QWORD *)a1 + 7);
        v12 = *((_QWORD *)a1 + 8);
        v13 = *((_QWORD *)a1 + 9);
        v9 = *((_QWORD *)a1 + 4);
        v7 = *((_QWORD *)a1 + 5);
        a1[6] = v18;
        *((_QWORD *)a1 + 2) = v20;
        *(_QWORD *)(a1 + 7) = v19;
        *((_QWORD *)a1 + 5) = v17;
      }
      *((_QWORD *)a1 + 6) = v15;
      *((_QWORD *)a1 + 7) = v14;
      *((_QWORD *)a1 + 8) = v16;
    }
    *((_QWORD *)a1 + 9) = v9;
    *((_QWORD *)a1 + 10) = v7;
    *((_QWORD *)a1 + 11) = v10;
    *((_QWORD *)a1 + 12) = v11;
    *((_QWORD *)a1 + 13) = v12;
    *((_QWORD *)a1 + 14) = v13;
  }
}
// 404630: using guessed type int dword_404630;

//----- (00000000004017BE) ----------------------------------------------------
__int64 __fastcall sub_4017BE(_QWORD *a1, unsigned __int8 *a2, __int64 a3, int a4)
{
  char v4; // zf
  __int64 v5; // rax

  do
  {
    v5 = *a2++;
    *a1++ = a3 + v5;
    --a4;
  }
  while ( a4 );
  *a1 = a3 + a2[(unsigned __int8)((2 * !v4) | ((byte_404035 & 2) != 0))];
  return *(_QWORD *)a2;
}
// 4017BE: variable 'v4' is possibly undefined
// 404035: using guessed type char byte_404035;

//----- (00000000004017EC) ----------------------------------------------------
char __fastcall sub_4017EC(_BYTE *a1, char *a2)
{
  __int64 v2; // rcx
  char v3; // al
  char *v4; // rsi
  char result; // al

  v2 = 0LL;
  while ( 1 )
  {
    v3 = *a2;
    v4 = a2 + 1;
    LOBYTE(v2) = v3;
    result = *v4;
    a2 = v4 + 1;
    if ( !v2 )
      break;
    do
    {
      *a1++ = result;
      v2 = (unsigned int)(v2 - 1);
    }
    while ( (_DWORD)v2 );
  }
  return result;
}

//----- (00000000004017FD) ----------------------------------------------------
void __fastcall __noreturn sub_4017FD(unsigned int a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdx

  sub_4021F0(0LL, a2, a3);
  sub_402941(a1, a2, v3);
}
// 401811: variable 'v3' is possibly undefined

//----- (0000000000401816) ----------------------------------------------------
__int64 sub_401816()
{
  dword_407838 = dword_404648;
  return -1LL;
}
// 404648: using guessed type int dword_404648;
// 407838: using guessed type int dword_407838;

//----- (0000000000401826) ----------------------------------------------------
__int64 sub_401826()
{
  dword_407838 = dword_404658;
  return -1LL;
}
// 404658: using guessed type int dword_404658;
// 407838: using guessed type int dword_407838;

//----- (0000000000401836) ----------------------------------------------------
__int64 sub_401836()
{
  dword_407838 = dword_404660;
  return -1LL;
}
// 404660: using guessed type int dword_404660;
// 407838: using guessed type int dword_407838;

//----- (0000000000401846) ----------------------------------------------------
__int64 sub_401846()
{
  dword_407838 = dword_404668;
  return -1LL;
}
// 404668: using guessed type int dword_404668;
// 407838: using guessed type int dword_407838;

//----- (0000000000401856) ----------------------------------------------------
__int64 sub_401856()
{
  dword_407838 = dword_404670;
  return -1LL;
}
// 404670: using guessed type int dword_404670;
// 407838: using guessed type int dword_407838;

//----- (0000000000401AA3) ----------------------------------------------------
__int64 __fastcall sub_401AA3(unsigned __int16 **a1)
{
  unsigned __int16 **v1; // rdx
  unsigned __int16 *v2; // rdi
  int v3; // eax
  unsigned int v4; // eax
  __int64 result; // rax

  v1 = a1;
  v2 = *a1;
  v3 = *v2;
  if ( (unsigned __int16)v3 > 0xD7FFu )
  {
    v4 = sub_40262D((__int64)v2, (_DWORD *)v1 + 6);
  }
  else
  {
    *((_DWORD *)v1 + 6) = v3;
    v4 = 1;
  }
  result = 2LL * v4;
  *v1 = (unsigned __int16 *)((char *)*v1 + result);
  return result;
}
// 401ACA: variable 'v1' is possibly undefined

//----- (0000000000401ACE) ----------------------------------------------------
unsigned __int64 __fastcall sub_401ACE(__int64 a1, unsigned int a2)
{
  __int64 v2; // rdx
  unsigned __int64 v3; // r8
  unsigned __int64 result; // rax
  _BYTE *v5; // rcx

  v2 = a1;
  v3 = *(_QWORD *)(a1 + 16);
  result = (int)a2;
  if ( a2 > 0x7F )
    result = sub_40263C(a2);
  do
  {
    v5 = *(_BYTE **)(v2 + 8);
    if ( v3 <= (unsigned __int64)v5 )
      break;
    *(_QWORD *)(v2 + 8) = v5 + 1;
    *v5 = result;
    result >>= 8;
  }
  while ( result );
  return result;
}
// 401AE4: variable 'v2' is possibly undefined
// 401AEB: variable 'v3' is possibly undefined

//----- (0000000000401AFE) ----------------------------------------------------
__int64 __fastcall sub_401AFE(unsigned __int16 *a1, unsigned __int64 a2, __int64 a3, __int64 a4, unsigned __int64 a5)
{
  __int64 v5; // r15
  unsigned __int64 v6; // rbx
  unsigned __int16 **v7; // r9
  __int64 v8; // r11
  unsigned __int64 v9; // r11
  unsigned __int64 v10; // rax
  unsigned __int64 v11; // r8
  unsigned __int64 v12; // rax
  bool v13; // r14
  unsigned __int64 v14; // r12
  __int64 v15; // r10
  __int64 v16; // r10
  unsigned __int64 v17; // rax
  __int64 v18; // r10
  bool v19; // cf
  unsigned __int64 v20; // r14
  unsigned __int64 v21; // r10
  unsigned __int64 v22; // r12
  unsigned __int16 **v23; // r9
  unsigned __int64 v25; // [rsp+8h] [rbp-68h]
  unsigned __int16 *v28; // [rsp+20h] [rbp-50h] BYREF
  unsigned __int64 v29; // [rsp+28h] [rbp-48h]
  unsigned __int64 v30; // [rsp+30h] [rbp-40h]
  unsigned int v31; // [rsp+38h] [rbp-38h]

  v5 = 0x100002600LL;
  v6 = 0LL;
  v28 = a1;
  v29 = a2;
  v30 = a2 + a3;
  sub_401AA3(&v28);
LABEL_2:
  if ( v31 )
  {
    while ( 1 )
    {
      if ( !v31 )
        goto LABEL_7;
      if ( v31 > 0x20 || !_bittest64(&v5, v31) )
        break;
      sub_401AA3(v7);
    }
    if ( ++v6 < a5 )
    {
      v12 = v29;
      if ( v29 >= v30 )
        v12 = 0LL;
      *(_QWORD *)(a4 + 8 * v6 - 8) = v12;
    }
    v13 = 0;
    while ( 1 )
    {
      if ( !v31 )
      {
LABEL_45:
        sub_401ACE((__int64)v7, 0);
        goto LABEL_2;
      }
      if ( v13 || v31 > 0x20 )
      {
        if ( v31 != 34 && v31 != 92 )
          goto LABEL_44;
        v14 = 0LL;
        while ( v31 == 92 )
        {
          ++v14;
          sub_401AA3(v7);
        }
        v15 = 0LL;
        while ( v31 == 34 )
        {
          sub_401AA3(v7);
          v15 = v16 + 1;
        }
        v17 = v14;
        if ( v15 )
        {
          while ( v17 > 1 )
          {
            v25 = v17;
            sub_401ACE((__int64)v7, 0x5Cu);
            v17 = v25 - 2;
          }
          if ( (v14 & 1) == 0 || (sub_401ACE((__int64)v7, 0x22u), (v15 = v18 - 1) != 0) )
          {
            v19 = !v13;
            v20 = 3LL;
            v21 = v15 - v19;
            v22 = v21 + 1;
            while ( v22 >= v20 )
            {
              v20 += 3LL;
              sub_401ACE((__int64)v7, 0x22u);
            }
            v13 = v21 % 3 == 0;
          }
        }
        else
        {
          while ( --v14 != -1LL )
            sub_401ACE((__int64)v7, 0x5Cu);
        }
      }
      else
      {
        if ( _bittest64(&v5, v31) )
          goto LABEL_45;
LABEL_44:
        sub_401ACE((__int64)v7, v31);
        sub_401AA3(v23);
      }
    }
  }
LABEL_7:
  sub_401ACE((__int64)v7, 0);
  if ( v8 )
  {
    v9 = v8 - 1;
    v10 = v29 - a2;
    if ( v29 - a2 > v9 )
      v10 = v9;
    *(_BYTE *)(a2 + v10) = 0;
  }
  if ( a5 )
  {
    v11 = a5 - 1;
    if ( a5 - 1 > v6 )
      v11 = v6;
    *(_QWORD *)(a4 + 8 * v11) = 0LL;
  }
  return (unsigned int)v6;
}
// 401B60: variable 'v7' is possibly undefined
// 401B74: variable 'v8' is possibly undefined
// 401C31: variable 'v16' is possibly undefined
// 401C8A: variable 'v18' is possibly undefined
// 401C9D: variable 'v15' is possibly undefined
// 401CC7: variable 'v21' is possibly undefined
// 401CE1: variable 'v23' is possibly undefined

//----- (0000000000401D0B) ----------------------------------------------------
__int64 __fastcall sub_401D0B(_QWORD *a1, __int64 *a2, __int64 a3, __int64 a4)
{
  __int64 v8; // r8
  __int64 v9; // rdx
  __int64 v10; // rdx
  __int64 i; // rax
  unsigned int v13; // [rsp+Ch] [rbp-44h] BYREF
  char v14[64]; // [rsp+10h] [rbp-40h] BYREF

  while ( a3 && !a2[1] )
  {
    a2 += 2;
    --a3;
  }
  sub_401DAD(a4, (__int64)v14);
  if ( a3 )
  {
    v8 = *((unsigned int *)a2 + 2);
    v9 = *a2;
  }
  else
  {
    v8 = 0LL;
    v9 = 0LL;
  }
  if ( !(unsigned int)qword_403060(a4, v14, v9, *a1, v8, &v13) )
    return sub_40297A();
  if ( !v13 )
  {
    for ( i = 0LL; a3 != i; ++i )
      ;
  }
  qword_403020(a4, v14, v10, *a1);
  return v13;
}
// 401D8E: variable 'v10' is possibly undefined
// 403020: using guessed type __int64 (__fastcall *qword_403020)(_QWORD, _QWORD, _QWORD, _QWORD);
// 403060: using guessed type __int64 (__fastcall *qword_403060)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000401DAD) ----------------------------------------------------
__int64 __fastcall sub_401DAD(__int64 a1, __int64 a2)
{
  __int64 v3; // r8
  __int64 v4; // rcx
  _DWORD *v5; // rdi

  v3 = a2;
  if ( a1 == -1 )
    return 0LL;
  v4 = 8LL;
  v5 = (_DWORD *)a2;
  while ( v4 )
  {
    *v5++ = 0;
    --v4;
  }
  *(_QWORD *)(a2 + 16) = a1;
  return v3;
}

//----- (0000000000401DD2) ----------------------------------------------------
__int64 __fastcall sub_401DD2(__int64 a1, __int64 a2, __int64 a3)
{
  return qword_403040(a1, a2, a3, a1);
}
// 403040: using guessed type __int64 (__fastcall *qword_403040)(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000401DEB) ----------------------------------------------------
__int64 sub_401DEB()
{
  return qword_403048();
}
// 403048: using guessed type __int64 (*qword_403048)(void);

//----- (0000000000401E0A) ----------------------------------------------------
__int64 __fastcall sub_401E0A(char *a1)
{
  __int64 v1; // r12
  int v2; // eax
  int v4; // ebx

  v1 = qword_406038;
  v2 = sub_401EAA(a1, qword_406038);
  if ( v2 == -1 )
    return 0xFFFFFFFFLL;
  v4 = v2;
  if ( (unsigned int)sub_401E45(10, v1) == -1 )
    return 0xFFFFFFFFLL;
  else
    return (unsigned int)(v4 + 1);
}
// 406038: using guessed type __int64 qword_406038;

//----- (0000000000401E45) ----------------------------------------------------
__int64 __fastcall sub_401E45(int a1, __int64 a2)
{
  int v2; // eax
  int v3; // edx
  __int64 (__fastcall *v4)(__int64); // rcx

  if ( a1 == -1 )
    return sub_401F6E(a2);
  *(_BYTE *)(*(_QWORD *)(a2 + 24) + *(unsigned int *)(a2 + 20)) = a1;
  v2 = (*(_DWORD *)(a2 + 32) - 1) & (*(_DWORD *)(a2 + 20) + 1);
  v3 = *(_DWORD *)(a2 + 16);
  *(_DWORD *)(a2 + 20) = v2;
  if ( v2 != v3 && *(_BYTE *)a2 != 2 && (*(_BYTE *)a2 != 1 || (_BYTE)a1 != 10) )
    return (unsigned __int8)a1;
  v4 = *(__int64 (__fastcall **)(__int64))(a2 + 48);
  if ( v4 )
    return v4(a2);
  if ( v2 == v3 )
    return sub_401F6E(a2);
  else
    return (unsigned __int8)a1;
}

//----- (0000000000401EAA) ----------------------------------------------------
__int64 __fastcall sub_401EAA(char *a1, __int64 a2)
{
  int v2; // er14
  char v4; // dl
  int v5; // eax
  int v6; // ecx
  __int64 (__fastcall *v7)(__int64); // rdx
  unsigned int v8; // eax
  unsigned int v9; // er12
  int v10; // eax

  v2 = 0;
  do
  {
    while ( 1 )
    {
      v4 = *a1;
      if ( !*a1 )
        return (unsigned int)(v2 + 1);
      ++a1;
      *(_BYTE *)(*(_QWORD *)(a2 + 24) + *(unsigned int *)(a2 + 20)) = v4;
      v5 = (*(_DWORD *)(a2 + 32) - 1) & (*(_DWORD *)(a2 + 20) + 1);
      v6 = *(_DWORD *)(a2 + 16);
      *(_DWORD *)(a2 + 20) = v5;
      if ( v5 == v6 || *(_BYTE *)a2 == 2 || *(_BYTE *)a2 == 1 && v4 == 10 )
      {
        v7 = *(__int64 (__fastcall **)(__int64))(a2 + 48);
        if ( v7 )
        {
          v8 = v7(a2);
        }
        else
        {
          if ( v5 != v6 )
            goto LABEL_15;
          v8 = sub_401F6E(a2);
        }
        v9 = v8;
        if ( v8 == -1 )
          break;
      }
LABEL_15:
      ++v2;
    }
  }
  while ( (int)sub_401FA1(a2) == qword_404650 );
  if ( sub_401F97(a2) )
  {
    v10 = qword_404678;
    *(_DWORD *)(a2 + 8) = qword_404678;
    dword_407838 = v10;
  }
  return v9;
}
// 404650: using guessed type __int64 qword_404650;
// 404678: using guessed type __int64 qword_404678;
// 407838: using guessed type int dword_407838;

//----- (0000000000401F6E) ----------------------------------------------------
__int64 __fastcall sub_401F6E(__int64 a1)
{
  int v1; // eax

  v1 = *(_DWORD *)(a1 + 8);
  if ( v1 <= 0 )
    v1 = -1;
  *(_DWORD *)(a1 + 8) = v1;
  return -1LL;
}
// 407838: using guessed type int dword_407838;

//----- (0000000000401F97) ----------------------------------------------------
_BOOL8 __fastcall sub_401F97(__int64 a1)
{
  return *(_DWORD *)(a1 + 8) == -1;
}

//----- (0000000000401FA1) ----------------------------------------------------
__int64 __fastcall sub_401FA1(__int64 a1)
{
  __int64 result; // rax

  result = 0LL;
  if ( *(int *)(a1 + 8) >= 0 )
    return *(unsigned int *)(a1 + 8);
  return result;
}

//----- (0000000000401FAF) ----------------------------------------------------
__int64 __fastcall sub_401FAF(_DWORD *a1)
{
  unsigned int v1; // er12
  __int64 i; // r13
  _DWORD *v3; // rdi
  int v4; // eax
  int v5; // eax

  if ( a1 )
  {
    v1 = 0;
    if ( a1[3] != -1 && (a1[1] & (unsigned int)qword_404688) != 0 )
    {
      v1 = a1[2];
      if ( v1 )
      {
        if ( v1 == -1 )
          return 0;
        else
          return (unsigned int)((__int64 (__fastcall *)(_DWORD *, _QWORD))loc_401F76)(a1, v1);
      }
      else
      {
        while ( a1[4] != a1[5] )
        {
          sub_402083((__int64)a1);
          if ( v5 == -1 )
            return (unsigned int)-1;
          v1 += v5;
        }
      }
    }
  }
  else
  {
    v1 = 0;
    for ( i = qword_406040 - 1; i != -1; --i )
    {
      v3 = *(_DWORD **)(qword_406050 + 8 * i);
      if ( v3 )
      {
        v4 = sub_401FAF(v3);
        if ( v4 == -1 )
          return (unsigned int)-1;
        v1 += v4;
      }
    }
  }
  return v1;
}
// 40202E: variable 'v5' is possibly undefined
// 404688: using guessed type __int64 qword_404688;
// 406040: using guessed type __int64 qword_406040;
// 406050: using guessed type __int64 qword_406050;

//----- (0000000000402083) ----------------------------------------------------
void __fastcall sub_402083(__int64 a1)
{
  __int64 v1; // rsi
  unsigned int v2; // ebx
  __int64 v3; // rax

  v1 = *(unsigned int *)(a1 + 16);
  v2 = *(_DWORD *)(a1 + 20);
  if ( (unsigned int)v1 >= v2 )
    v2 = *(_DWORD *)(a1 + 32);
  v3 = sub_40247A(*(_DWORD *)(a1 + 12), *(_QWORD *)(a1 + 24) + v1, v2 - (unsigned int)v1);
  if ( v3 == -1 )
    sub_402150();
  else
    *(_DWORD *)(a1 + 16) = (*(_DWORD *)(a1 + 32) - 1) & (*(_DWORD *)(a1 + 16) + v3);
}

//----- (0000000000402150) ----------------------------------------------------
void sub_402150()
{
  JUMPOUT(0x401F76LL);
}
// 402156: control flows out of bounds to 401F76
// 407838: using guessed type int dword_407838;

//----- (000000000040215B) ----------------------------------------------------
__int64 __fastcall sub_40215B(__int64 a1, __int64 a2, __int64 a3)
{
  _DWORD *v3; // rbx
  __int64 result; // rax
  unsigned int v5; // eax
  _QWORD *v6; // rbx

  v3 = (_DWORD *)qword_4060A0;
  if ( !qword_4060A0 )
  {
    v3 = &unk_4060A8;
    qword_4060A0 = (__int64)&unk_4060A8;
  }
  if ( *v3 == -1 )
    return sub_401836();
  _BitScanReverse(&v5, ~*v3);
  *v3 |= 1 << v5;
  v6 = &v3[6 * v5];
  result = 0LL;
  v6[2] = a1;
  v6[3] = a2;
  v6[4] = a3;
  return result;
}
// 4060A0: using guessed type __int64 qword_4060A0;

//----- (00000000004021F0) ----------------------------------------------------
__int64 __fastcall sub_4021F0(__int64 a1, __int64 a2, __int64 a3)
{
  unsigned int *v4; // rdi
  __int64 v5; // rax
  int v6; // ecx
  __int64 v7; // rdx
  unsigned int *v8; // rcx
  void (__fastcall *v9)(_QWORD, __int64); // rdx

LABEL_1:
  while ( 1 )
  {
    v4 = (unsigned int *)qword_4060A0;
    if ( !qword_4060A0 )
      return a3;
    while ( 1 )
    {
      v5 = *v4;
      while ( v5 )
      {
        _BitScanForward((unsigned int *)&v6, v5);
        v7 = (unsigned int)~(1 << v6);
        v5 &= v7;
        if ( !a1 || *(_QWORD *)&v4[6 * v6 + 8] == a1 )
        {
          *v4 &= v7;
          v8 = &v4[6 * v6];
          v9 = (void (__fastcall *)(_QWORD, __int64))*((_QWORD *)v8 + 2);
          if ( v9 )
          {
            v9(*((_QWORD *)v8 + 3), 1LL);
            goto LABEL_1;
          }
        }
      }
      if ( !a1 )
        break;
      if ( !*((_QWORD *)v4 + 1) )
        return a3;
      v4 = (unsigned int *)*((_QWORD *)v4 + 1);
    }
    qword_4060A0 = *((_QWORD *)v4 + 1);
  }
}
// 4060A0: using guessed type __int64 qword_4060A0;

//----- (0000000000402286) ----------------------------------------------------
__int64 __fastcall sub_402286(__int64 *a1, unsigned __int64 *a2, unsigned __int64 a3, __int64 a4)
{
  unsigned __int64 v7; // rdi
  unsigned __int64 v8; // rsi
  unsigned __int64 v9; // rcx

  sub_4023CE(*a1);
  sub_4023CE(*a1);
  v7 = *a2;
  if ( *a1 )
  {
    v8 = v7 + (v7 >> 1);
  }
  else
  {
    v8 = 4LL;
    if ( 0x1F / a3 >= 4 )
      v8 = 0x1F / a3;
  }
  if ( v7 && ((v7 | a3) & 0xFFFFFFFFFFFF0000LL) != 0 && a3 != v7 * a3 / v7
    || (v9 = v8 + a4 + 1, v8 + a4 != -1LL) && ((v9 | a3) & 0xFFFFFFFFFFFF0000LL) != 0 && a3 != v9 * a3 / v9 )
  {
    sub_401856();
  }
  else
  {
    sub_401836();
  }
  return 0LL;
}

//----- (00000000004023CE) ----------------------------------------------------
_BOOL8 __fastcall sub_4023CE(__int64 a1)
{
  __int64 v1; // rbx
  __int64 v2; // rdx
  _BOOL8 result; // rax
  bool v4; // al

  if ( (unsigned __int64)(a1 - 0x600000000000LL) <= 0xFFFFFFFFFFFLL )
    return 0LL;
  v1 = a1 >> 16;
  v2 = sub_40243F(a1 >> 16, (__int64)&qword_4063C0[1], qword_4063C0[0]);
  result = 0LL;
  if ( v2 )
  {
    v4 = 1;
    if ( LODWORD(qword_4063C0[v2]) != (_DWORD)v1 )
      return HIDWORD(qword_4063C0[v2]) == (_DWORD)v1;
    return v4;
  }
  return result;
}
// 4063C0: using guessed type __int64 qword_4063C0[];

//----- (000000000040243F) ----------------------------------------------------
__int64 __fastcall sub_40243F(int a1, __int64 a2, int a3)
{
  __int64 result; // rax
  int v4; // ecx

  LODWORD(result) = 0;
  while ( a3 > (int)result )
  {
    v4 = (a3 + (int)result) >> 1;
    if ( *(_DWORD *)(a2 + 8LL * v4) > a1 )
      a3 = (a3 + (int)result) >> 1;
    else
      LODWORD(result) = v4 + 1;
  }
  return (int)result;
}

//----- (000000000040245F) ----------------------------------------------------
bool __fastcall sub_40245F(int a1, int a2)
{
  bool result; // al

  result = 0;
  if ( a1 )
    return *(_DWORD *)(qword_4076B0 + 24LL * a1 + 16) == a2;
  return result;
}
// 4076B0: using guessed type __int64 qword_4076B0;

//----- (000000000040247A) ----------------------------------------------------
__int64 __fastcall sub_40247A(int a1, __int64 a2, __int64 a3)
{
  __int64 v5; // [rsp+0h] [rbp-30h] BYREF
  __int64 v6; // [rsp+8h] [rbp-28h]

  if ( a1 == -1 )
    return (int)sub_401826();
  if ( sub_40245F(a1, 5) )
  {
    v5 = a2;
    v6 = a3;
    return MEMORY[0](*(_QWORD *)(qword_4076B0 + 24LL * a1), &v5, 1LL, -1LL);
  }
  else if ( (dword_404630 & 4) != 0 )
  {
    if ( sub_40245F(a1, 2) )
    {
      v5 = a2;
      v6 = a3;
      return MEMORY[0](qword_4076B0 + 24LL * a1, &v5, 1LL, 0LL, 0LL, 0LL);
    }
    else if ( sub_40245F(a1, 1) || sub_40245F(a1, 4) )
    {
      v5 = a2;
      v6 = a3;
      return sub_401D0B((_QWORD *)(qword_4076B0 + 24LL * a1), &v5, 1LL, -1LL);
    }
    else
    {
      return sub_401816();
    }
  }
  else
  {
    return sub_4025C0();
  }
}
// 404630: using guessed type int dword_404630;
// 4076B0: using guessed type __int64 qword_4076B0;

//----- (00000000004025B0) ----------------------------------------------------
__int64 sub_4025B0()
{
  return qword_404638();
}
// 404638: using guessed type __int64 (*qword_404638)(void);

//----- (00000000004025C0) ----------------------------------------------------
__int64 sub_4025C0()
{
  return qword_404638();
}
// 404638: using guessed type __int64 (*qword_404638)(void);

//----- (00000000004025D0) ----------------------------------------------------
__int64 __fastcall sub_4025D0()
{
  __int16 v0; // ax
  __int64 result; // rax

  result = (unsigned int)v0;
  if ( (int)result < 0 )
  {
    dword_407838 = dword_404668;
    return -1LL;
  }
  else
  {
    __asm { syscall; Low latency system call }
  }
  return result;
}
// 4025E2: conditional instruction was optimized away because rax.8<80000000u
// 4025D0: variable 'v0' is possibly undefined
// 4025D0: using guessed type __int64 __fastcall sub_4025D0();
// 404668: using guessed type int dword_404668;
// 407838: using guessed type int dword_407838;

//----- (000000000040262D) ----------------------------------------------------
__int64 __fastcall sub_40262D(__int64 a1, _DWORD *a2)
{
  return sub_40266F(a1, a2);
}

//----- (000000000040263C) ----------------------------------------------------
__int64 __fastcall sub_40263C(__int64 a1)
{
  __int64 v1; // rax
  __int64 v2; // rcx
  int v3; // ecx
  char v4; // dl

  a1 = (unsigned int)a1;
  v1 = 0LL;
  if ( (unsigned int)a1 > 0x7F )
  {
    _BitScanReverse((unsigned int *)&v2, a1);
    v3 = *(_DWORD *)&byte_4029C3[2 * v2 - 14];
    do
    {
      v4 = a1;
      a1 = (unsigned int)a1 >> 6;
      LOBYTE(v1) = v4 & 0x3F | v1 | 0x80;
      v1 <<= 8;
      LOBYTE(v3) = v3 - 1;
    }
    while ( (_BYTE)v3 );
    LOBYTE(v1) = BYTE1(v3) | v1;
  }
  return a1 | v1;
}
// 40264F: variable 'v2' is possibly undefined

//----- (000000000040266F) ----------------------------------------------------
__int64 __fastcall sub_40266F(__int64 a1, _DWORD *a2)
{
  __int64 result; // rax
  __int64 v3; // rdx
  int v4; // ebx
  int v5; // edx
  int v6; // eax

  LODWORD(result) = 0;
  do
  {
    v3 = (unsigned int)result;
    v4 = result;
    result = (unsigned int)(result + 1);
    v5 = *(unsigned __int16 *)(a1 + 2 * v3);
  }
  while ( (v5 & 0xFC00) == 0xDC00 );
  if ( (v5 & 0xFC00) == 0xD800 )
  {
    v6 = *(unsigned __int16 *)(a1 + 2 * result);
    if ( (v6 & 0xFC00) == 0xDC00 )
    {
      *a2 = (v5 << 10) + v6 - 56613888;
      return (unsigned int)(v4 + 2);
    }
    else
    {
      *a2 = 65533;
      return 0xFFFFFFFFLL;
    }
  }
  else
  {
    *a2 = v5;
  }
  return result;
}

//----- (0000000000402750) ----------------------------------------------------
void __fastcall sub_402750(__int64 a1, __int64 a2, unsigned __int64 a3)
{
  __int64 v3; // rcx

  v3 = 32LL;
  if ( a3 < 0x20 )
    v3 = a3;
  __asm { jmp     ds:qword_404420[rcx*8] }
}
// 40275D: unbalanced stack, ignored a potential tail call

//----- (0000000000402870) ----------------------------------------------------
void __fastcall sub_402870(__int64 a1, __int64 a2, unsigned __int64 a3)
{
  __int64 v3; // rcx

  v3 = 32LL;
  if ( a3 < 0x20 )
    v3 = a3;
  __asm { jmp     qword ptr [rbx+rcx*8] }
}
// 402887: unbalanced stack, ignored a potential tail call

//----- (0000000000402941) ----------------------------------------------------
void __fastcall __noreturn sub_402941(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 i; // rcx

  dword_40783C |= 4u;
  if ( (dword_404630 & 4) != 0 )
  {
    for ( i = (unsigned __int8)a1; ; qword_403018(a1, a2, a3, i) )
      ;
  }
  __asm { syscall; Low latency system call }
  _disable();
  __lidt(byte_402972);
  __halt();
}
// 402955: variable 'a3' is possibly undefined
// 402955: variable 'i' is possibly undefined
// 403018: using guessed type __int64 (__fastcall *qword_403018)(_QWORD, _QWORD, _QWORD, _QWORD);
// 404630: using guessed type int dword_404630;
// 40783C: using guessed type int dword_40783C;

//----- (000000000040297A) ----------------------------------------------------
__int64 sub_40297A()
{
  if ( (dword_404630 & 4) == 0 )
    return sub_401846();
  dword_407838 = sub_401DEB();
  return -1LL;
}
// 404630: using guessed type int dword_404630;
// 407838: using guessed type int dword_407838;

// nfuncs=52 queued=52 decompiled=52 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 52 function(s)"

//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <windows.h>

// ---------------- Integer Types Definitions -----------------

typedef int64_t int80_t;

// ------------------- Function Prototypes --------------------

int64_t entry_point(void);
int64_t function_401000(int64_t a1, int64_t a2);
int64_t function_4010fb(int64_t a1);
int64_t function_40114f(void);
int64_t function_40117b(void);
int64_t function_401214(void);
int64_t function_401217(void);
int64_t function_401225(void);
int64_t function_401240(void);
int64_t function_401245(void);
int64_t function_40124e(void);
int64_t function_40125e(int64_t a1);
int64_t function_401297(int64_t a1, int64_t a2, int64_t a3, int64_t a4);
int64_t function_40134d(void);
int64_t function_401353(int64_t a1);
int64_t function_4013b4(void);
int64_t function_401601(void);
int64_t function_40162c(void);
int64_t function_40165c(int64_t * a1, int64_t a2, uint64_t a3);
int64_t function_40186a(void);
int64_t function_401872(int64_t a1, int64_t a2);
int64_t function_401907(int64_t a1, int64_t result);
int64_t function_40199d(int64_t a1);
int64_t function_4019c7(void);
int64_t function_4019cd(void);
int64_t function_4019d4(int64_t a1);
int64_t function_4019e2(void);
int64_t function_4019fa(int64_t a1, int64_t a2);
int64_t function_401a09(int64_t a1, int64_t a2);
int64_t function_401a3c(int64_t a1, int64_t a2);
int64_t function_401aa1(void);

// --------------------- Global Variables ---------------------

int64_t g1 = 0; // 0x402008
int32_t g2 = 0; // 0x402050
int64_t g3 = 0; // 0x403000
int64_t g4 = 0; // 0x403018
int32_t g5 = 0; // 0x403020
int64_t g6 = 0; // 0x403030
int32_t * g7 = NULL; // 0x403040
int64_t g8 = 0; // 0x403048
int64_t g9 = 0; // 0x403358
int32_t g10 = 0; // 0x40335c
int32_t g11;

// ------------------------ Functions -------------------------

// Address range: 0x401000 - 0x4010fb
int64_t function_401000(int64_t a1, int64_t a2) {
    // 0x401000
    int64_t result; // 0x401000
    int64_t v1; // 0x401000
    if (*(int64_t *)(v1 + 8) == 0) {
        // 0x4010ec
        return result;
    }
    int64_t v2 = 0x100000; // 0x40102e
    while (true) {
        uint64_t v3 = v2;
        int64_t v4; // 0x401000
        int64_t v5 = v4;
        int64_t v6 = v5; // 0x401040
        while (*(int32_t *)(v5 + 16) != 1) {
            int64_t v7 = v5 + 24; // 0x40103a
            v6 = v7;
            if (*(int64_t *)(v5 + 32) == 0) {
                // break -> 0x40104e
                break;
            }
            v5 = v7;
            v6 = v5;
        }
        int64_t * v8 = (int64_t *)v6; // 0x40104e
        uint64_t v9 = *v8;
        int64_t v10 = (v9 >= v3 ? v9 : v3) + 4095 & -0x1000; // 0x40105c
        int64_t * v11 = (int64_t *)(v6 + 8); // 0x401063
        int64_t v12 = *v11; // 0x401063
        int64_t v13 = v12 + v9 & -0x1000; // 0x40106a
        int64_t v14 = v9; // 0x401073
        int64_t v15 = v12; // 0x401073
        int64_t v16 = v10; // 0x401073
        int64_t v17; // 0x401000
        int64_t v18 = v17; // 0x401073
        v2 = v10;
        int64_t v19 = v17; // 0x401073
        int64_t v20 = v13; // 0x401073
        if (v10 < v13) {
            int64_t v21 = v14; // 0x401067
            int64_t v22 = v15; // 0x401063
            int64_t v23 = v18; // 0x401000
            int64_t v24 = v16; // 0x4010d3
            int64_t v25; // 0x401000
            int64_t v26; // 0x401000
            int64_t v27; // 0x401067
            int64_t v28; // 0x401063
            uint64_t v29; // 0x401000
            int64_t v30; // 0x401000
            int64_t v31; // 0x401000
            int64_t v32; // 0x401000
            int64_t v33; // 0x401000
            int64_t v34; // 0x401075
            uint64_t v35; // 0x401097
            int64_t v36; // 0x4010c7
            int64_t v37; // 0x40106a
            uint64_t v38; // 0x4010a0
            int64_t v39; // 0x401085
            int64_t v40; // 0x401075
            while (true) {
                // 0x401075
                v29 = v24;
                v28 = v22;
                v27 = v21;
                v34 = *(int64_t *)(v23 + 8);
                v26 = v34;
                v30 = v23;
                v32 = v23;
                v25 = 0;
                if (v34 != 0) {
                    v31 = v30;
                    if (*(int32_t *)(v31 + 16) != 1) {
                        // 0x40108b
                        if (*(int64_t *)v31 + v26 >= v29) {
                            // break -> 0x401097
                            break;
                        }
                    }
                    // 0x401085
                    v39 = v31 + 24;
                    v40 = *(int64_t *)(v31 + 32);
                    v26 = v40;
                    v32 = v39;
                    v25 = 0;
                    while (v40 != 0) {
                        // 0x40107e
                        v31 = v39;
                        if (*(int32_t *)(v31 + 16) != 1) {
                            // 0x40108b
                            v32 = v31;
                            v25 = v26;
                            if (*(int64_t *)v31 + v26 >= v29) {
                                // break -> 0x401097
                                break;
                            }
                        }
                        // 0x401085
                        v39 = v31 + 24;
                        v40 = *(int64_t *)(v31 + 32);
                        v26 = v40;
                        v32 = v39;
                        v25 = 0;
                    }
                }
                // 0x401097
                v33 = v32;
                v35 = *(int64_t *)v33;
                if (v35 <= v29) {
                    // 0x4010a0
                    v38 = v35 + v25;
                    if (v38 > v29) {
                        // break -> 0x40105c
                        break;
                    }
                }
                // 0x4010b1
                v36 = function_4010fb(a2);
                v24 = v29 + 0x1000;
                *(int64_t *)v36 = v29 | 3;
                v22 = *v11;
                v21 = *v8;
                v37 = v21 + v22 & -0x1000;
                v23 = v33;
                v2 = v24;
                v19 = v33;
                v20 = v37;
                if (v24 >= v37) {
                    // break (via goto) -> 0x4010e3
                    goto lab_0x4010e3;
                }
            }
            int64_t v41 = v38 + 4095 & -0x1000; // 0x40105c
            int64_t v42 = v28 + v27 & -0x1000; // 0x40106a
            v2 = v41;
            v19 = v33;
            v20 = v42;
            while (v41 < v42) {
                // 0x401075
                v21 = v27;
                v22 = v28;
                v23 = v33;
                v24 = v41;
                while (true) {
                    // 0x401075
                    v29 = v24;
                    v28 = v22;
                    v27 = v21;
                    v34 = *(int64_t *)(v23 + 8);
                    v26 = v34;
                    v30 = v23;
                    v32 = v23;
                    v25 = 0;
                    if (v34 != 0) {
                        v31 = v30;
                        if (*(int32_t *)(v31 + 16) != 1) {
                            // 0x40108b
                            if (*(int64_t *)v31 + v26 >= v29) {
                                // break -> 0x401097
                                break;
                            }
                        }
                        // 0x401085
                        v39 = v31 + 24;
                        v40 = *(int64_t *)(v31 + 32);
                        v26 = v40;
                        v32 = v39;
                        v25 = 0;
                        while (v40 != 0) {
                            // 0x40107e
                            v31 = v39;
                            if (*(int32_t *)(v31 + 16) != 1) {
                                // 0x40108b
                                v32 = v31;
                                v25 = v26;
                                if (*(int64_t *)v31 + v26 >= v29) {
                                    // break -> 0x401097
                                    break;
                                }
                            }
                            // 0x401085
                            v39 = v31 + 24;
                            v40 = *(int64_t *)(v31 + 32);
                            v26 = v40;
                            v32 = v39;
                            v25 = 0;
                        }
                    }
                    // 0x401097
                    v33 = v32;
                    v35 = *(int64_t *)v33;
                    if (v35 <= v29) {
                        // 0x4010a0
                        v38 = v35 + v25;
                        if (v38 > v29) {
                            // break -> 0x40105c
                            break;
                        }
                    }
                    // 0x4010b1
                    v36 = function_4010fb(a2);
                    v24 = v29 + 0x1000;
                    *(int64_t *)v36 = v29 | 3;
                    v22 = *v11;
                    v21 = *v8;
                    v37 = v21 + v22 & -0x1000;
                    v23 = v33;
                    v2 = v24;
                    v19 = v33;
                    v20 = v37;
                    if (v24 >= v37) {
                        // break (via goto) -> 0x4010e3
                        goto lab_0x4010e3;
                    }
                }
                // 0x40105c
                v41 = v38 + 4095 & -0x1000;
                v42 = v28 + v27 & -0x1000;
                v2 = v41;
                v19 = v33;
                v20 = v42;
            }
        }
      lab_0x4010e3:
        // 0x4010e3
        v4 = v6 + 24;
        v17 = v19;
        result = v20;
        if (*(int64_t *)(v6 + 32) == 0) {
            // break -> 0x4010ec
            break;
        }
    }
    // 0x4010ec
    return result;
}

// Address range: 0x4010fb - 0x40114f
int64_t function_4010fb(int64_t a1) {
    // 0x4010fb
    int64_t v1; // 0x4010fb
    uint64_t v2 = v1;
    int64_t v3 = v1 + 0xffffffff; // 0x401110
    int64_t result = (v2 / 0x1000000000 & 4088) + v1;
    if ((int32_t)v3 == -1) {
        // 0x40111f
        return result;
    }
    int64_t v4 = v3; // 0x401110
    int64_t v5 = 39;
    int64_t * v6 = (int64_t *)result; // 0x401128
    int64_t v7 = *v6; // 0x401128
    int64_t v8 = v7; // 0x40112c
    int64_t v9; // 0x401131
    if (v7 == 0) {
        // 0x40112e
        v9 = v5 - 0x1000;
        *(int64_t *)a1 = v9;
        v8 = v9 | 3;
        *v6 = v8;
    }
    uint64_t v10 = v5 + 0xfffffff7; // 0x401144
    v4 = (v4 & 0xffffffff) + 0xffffffff;
    int64_t result2 = v8 & 0x3fffffffff000 | 8 * (v2 >> v10 % 64) & 4088;
    while ((int32_t)v4 != -1) {
        // 0x401124
        v5 = v10 & 0xffffffff;
        v6 = (int64_t *)result2;
        v7 = *v6;
        v8 = v7;
        if (v7 == 0) {
            // 0x40112e
            v9 = v5 - 0x1000;
            *(int64_t *)a1 = v9;
            v8 = v9 | 3;
            *v6 = v8;
        }
        // 0x401141
        v10 = v5 + 0xfffffff7;
        v4 = (v4 & 0xffffffff) + 0xffffffff;
        result2 = v8 & 0x3fffffffff000 | 8 * (v2 >> v10 % 64) & 4088;
    }
    // 0x40111f
    return result2;
}

// Address range: 0x40114f - 0x40117b
int64_t function_40114f(void) {
    int64_t result = function_4010fb(0x3220); // 0x40116b
    int64_t * v1 = (int64_t *)result; // 0x401170
    *v1 = *v1 & -2;
    int64_t v2; // 0x40114f
    __asm_invlpg(*(char *)&v2);
    return result;
}

// Address range: 0x40117b - 0x401214
int64_t function_40117b(void) {
    // 0x40117b
    int64_t v1; // 0x40117b
    int64_t v2 = v1 + 8; // 0x401188
    if (*(int64_t *)v2 == 0) {
        // 0x4011a4
        return 0;
    }
    int64_t v3 = 1; // 0x401190
    int64_t v4 = v3 & 0xffffffff; // 0x401190
    int64_t result = 24 * v4;
    while (*(int64_t *)(result + v2) != 0) {
        // 0x401190
        v3 = v4 + 1;
        v4 = v3 & 0xffffffff;
        result = 24 * v4;
    }
    uint32_t v5 = (int32_t)v3;
    if (v5 <= 1) {
        // 0x4011a4
        return result;
    }
    int64_t v6 = 1; // 0x4011a2
    int64_t result2; // 0x40117b
    while (true) {
        // 0x4011b0
        int64_t v7; // 0x40117b
        int64_t v8 = v7 + 24;
        int64_t v9 = *(int64_t *)v8; // 0x4011b0
        int64_t v10 = v8;
        int64_t v11 = v6;
        int64_t v12 = v10 - 24; // 0x4011c9
        int64_t v13; // 0x40117b
        while (v9 != *(int64_t *)v12) {
            int64_t v14 = v11 + 0xffffffff; // 0x4011c7
            int64_t v15 = v14 & 0xffffffff; // 0x4011c7
            __asm_rep_movsd_memcpy((char *)v10, (char *)v12, 6);
            v13 = v15;
            if ((int32_t)v14 == 0) {
                goto lab_0x4011e9;
            }
            v10 = v12;
            v11 = v15;
            v12 = v10 - 24;
        }
        // 0x4011e7
        v13 = v11 & 0xffffffff;
      lab_0x4011e9:;
        int64_t v16 = v6 + 1; // 0x4011ed
        int64_t v17 = 24 * v13 + v1; // 0x4011f4
        *(int64_t *)v17 = v9;
        *(int64_t *)(v17 + 8) = *(int64_t *)(v7 + 32);
        *(int32_t *)(v17 + 16) = *(int32_t *)(v7 + 40);
        *(int32_t *)(v17 + 20) = *(int32_t *)(v7 + 44);
        result2 = v17;
        v7 = v8;
        v6 = v16 & 0xffffffff;
        if (v5 <= (int32_t)v16) {
            // break -> 0x4011a4
            break;
        }
    }
    // 0x4011a4
    return result2;
}

// Address range: 0x401214 - 0x401217
int64_t function_401214(void) {
    // 0x401214
    return 0;
}

// Address range: 0x401217 - 0x401225
int64_t function_401217(void) {
    // 0x401217
    __asm_int3();
    while (true) {
        // 0x401222
        __asm_hlt();
    }
}

// Address range: 0x401225 - 0x401240
int64_t function_401225(void) {
    // 0x401225
    int64_t v1; // bp-8, 0x401225
    int64_t v2 = &v1; // 0x40122b
    __asm_rep_stosb_memset((char *)(v2 + 0xfffffff8 & 0xfffffff8), 0, 8);
    while (true) {
        // 0x401237
        __asm_lidt(*(int80_t *)(v2 - 8));
    }
}

// Address range: 0x401240 - 0x401245
int64_t function_401240(void) {
    // 0x401240
    int64_t result; // 0x401240
    return result;
}

// Address range: 0x401245 - 0x40124e
int64_t function_401245(void) {
    // 0x401245
    *(char *)&g3 = 8;
    return function_40125e((int64_t)&g11);
}

// Address range: 0x40124e - 0x40125e
int64_t function_40124e(void) {
    // 0x40124e
    int64_t result; // 0x40124e
    if (result == 0) {
        function_40125e((int64_t)&g11);
        // UNREACHABLE
    }
    // 0x401257
    *(char *)&g3 = 32;
    return result;
}

// Address range: 0x40125e - 0x401297
int64_t function_40125e(int64_t a1) {
    // 0x40125e
    __asm_rep_stosq_memset((char *)0x402010, 0x401214, (int64_t)((int32_t)((int64_t)&g2 - 0x402010) >> 3));
    int64_t v1 = 0xffffffff; // 0x40128c
    int64_t v2; // 0x40125e
    int64_t v3 = (0x100000000 * a1 >> 29) + 24 + v2; // 0x40128c
    int64_t v4 = 0; // 0x40128c
    while (v1 != 0) {
        int64_t v5 = v3;
        v1--;
        bool v6; // 0x40125e
        v3 = v5 + (v6 ? -8 : 8);
        v4 = v1;
        if (*(int64_t *)v5 == 0) {
            // break -> 
            break;
        }
        v4 = 0;
    }
    return function_401353(v4);
}

// Address range: 0x401297 - 0x40134d
int64_t function_401297(int64_t a1, int64_t a2, int64_t a3, int64_t a4) {
    char v1 = *(char *)&g3; // 0x4012a7
    int64_t v2; // 0x401297
    int64_t v3; // 0x401297
    int64_t v4; // bp-40, 0x401297
    if ((v1 & 8) != 0) {
        // 0x4012e8
        v4 = 8;
        v2 = 8;
        v3 = 0x401ef8;
    } else {
        if ((v1 & 32) != 0) {
            // 0x4012d2
            v4 = 32;
            v2 = 32;
            v3 = 0x401ee9;
        } else {
            if ((v1 & 4) != 0) {
                // 0x4012c7
                v4 = 4;
                v2 = 4;
                v3 = 0x401ef5;
            } else {
                int64_t v5; // 0x401297
                if (v5 == 0) {
                    // 0x4012dd
                    v4 = 16;
                    v2 = 16;
                    v3 = 0x401ef1;
                } else {
                    // 0x4012bc
                    v4 = 1;
                    v2 = 1;
                    v3 = 0x401eed;
                }
            }
        }
    }
    // 0x4012f1
    g3 = v2;
    int64_t * v6 = (int64_t *)((int64_t)&v4 + 8); // 0x4012f9
    int64_t result = *v6 + 0x40199d; // 0x4012fa
    bool v7; // 0x401297
    int64_t * v8 = v7 ? (int64_t *)((int64_t)&g3 - 8) : (int64_t *)((int64_t)&g3 + 8); // 0x4012fd
    *v8 = result;
    int64_t v9 = v7 ? (int64_t)&g3 - 16 : (int64_t)&g3 + 16; // 0x4012fd
    *v6 = v9;
    if (&g4 >= &g6) {
        // 0x401348
        return result;
    }
    int64_t v10 = &g4; // 0x401344
    int64_t v11 = v3; // 0x401317
    int64_t v12 = 0; // 0x401297
    unsigned char v13 = *(char *)v11; // 0x401317
    uint64_t v14 = (int64_t)v13; // 0x401317
    v11 += (v7 ? -1 : 1);
    uint64_t v15 = v12 + 7; // 0x401322
    int64_t v16 = v14 % 128 << v12 % 64; // 0x401325
    v12 = v15 & 0xffffffff;
    int64_t v17 = v16; // 0x40132a
    while (v13 < 0) {
        // 0x401317
        v13 = *(char *)v11;
        v14 = (int64_t)v13;
        v11 += (v7 ? -1 : 1);
        v15 = v12 + 7;
        v16 = v14 % 128 << v12 % 64 | v17;
        v12 = v15 & 0xffffffff;
        v17 = v16;
    }
    int64_t v18 = v16; // 0x40132e
    if ((v14 & 64) != 0) {
        // 0x401330
        v18 = v16 | -1 << v15 % 64;
    }
    int64_t * v19 = (int64_t *)v10; // 0x40133c
    int64_t v20 = *v19;
    int64_t result2 = v20 != 0 ? v20 : v18; // 0x401340
    *v19 = result2;
    v10 += (v7 ? -8 : 8);
    while (v10 < (int64_t)&g6) {
        // 0x401317
        v12 = 0;
        v13 = *(char *)v11;
        v14 = (int64_t)v13;
        v11 += (v7 ? -1 : 1);
        v15 = v12 + 7;
        v16 = v14 % 128 << v12 % 64;
        v12 = v15 & 0xffffffff;
        v17 = v16;
        while (v13 < 0) {
            // 0x401317
            v13 = *(char *)v11;
            v14 = (int64_t)v13;
            v11 += (v7 ? -1 : 1);
            v15 = v12 + 7;
            v16 = v14 % 128 << v12 % 64 | v17;
            v12 = v15 & 0xffffffff;
            v17 = v16;
        }
        // 0x40132c
        v18 = v16;
        if ((v14 & 64) != 0) {
            // 0x401330
            v18 = v16 | -1 << v15 % 64;
        }
        // 0x401339
        v19 = (int64_t *)v10;
        v20 = *v19;
        result2 = v20 != 0 ? v20 : v18;
        *v19 = result2;
        v10 += (v7 ? -8 : 8);
    }
    // 0x401348
    return result2;
}

// Address range: 0x40134d - 0x401353
int64_t function_40134d(void) {
    // 0x40134d
    return 42;
}

// Address range: 0x401353 - 0x4013b4
int64_t function_401353(int64_t a1) {
    // 0x401385
    int64_t v1; // 0x401353
    int64_t v2 = &v1; // 0x401353
    int64_t v3; // 0x401353
    function_401297(a1, v3, v3, v3);
    g10 |= 1;
    int64_t v4 = function_40134d(); // 0x40138f
    *(int64_t *)(v2 - 8) = 0;
    *(int64_t *)(v2 - 24) = v4;
    function_401907((int64_t)&g1, v3);
    function_401aa1();
    // UNREACHABLE
}

// Address range: 0x4013b4 - 0x4013c4
int64_t function_4013b4(void) {
    // 0x4013b4
    *(int32_t *)&g9 = *(int32_t *)&g4;
    return -1;
}

// Address range: 0x4013c5 - 0x401601
int64_t entry_point(void) {
    // 0x4013c5
    int64_t lpNumberOfBytesWritten; // bp-32824, 0x4013c5
    if (!SetDefaultDllDirectories(2048)) {
        // 0x4013fc
        WriteFile(GetStdHandle(-12), (int64_t *)"nodll\n", 6, (int32_t *)&lpNumberOfBytesWritten, NULL);
        ExitProcess(1);
        // UNREACHABLE
    }
    // 0x401445
    *(int32_t *)&g3 = 4;
    GetCommandLineW();
    int16_t * lpszEnvironmentBlock = GetEnvironmentStringsW(); // 0x40145b
    int64_t v1; // bp-53304, 0x4013c5
    function_40165c(&v1, 0x3fff, 512);
    char * v2 = (char *)v1; // 0x401498
    unsigned char v3 = *v2; // 0x401498
    int64_t v4 = (int64_t)v3 | 0x3f00; // 0x401498
    int64_t v5 = v4; // 0x40149c
    int64_t v6 = 0; // 0x40149c
    int64_t v7 = v1; // 0x40149c
    int64_t v8 = v4; // 0x40149c
    if (v3 != 0) {
        if (v3 == 92) {
            // 0x4014a3
            *v2 = 47;
        }
        int64_t v9 = v1; // 0x40148e
        v6++;
        int64_t v10 = v9 + v6; // 0x401495
        char * v11 = (char *)v10; // 0x401498
        unsigned char v12 = *v11; // 0x401498
        v5 = v5 & -256 | (int64_t)v12;
        v7 = v10;
        v8 = v5;
        while (v12 != 0) {
            int64_t v13 = v9; // 0x4014a1
            if (v12 == 92) {
                // 0x4014a3
                *v11 = 47;
                v13 = v1;
            }
            // 0x4014a6
            v9 = v13;
            v6++;
            v10 = v9 + v6;
            v11 = (char *)v10;
            v12 = *v11;
            v5 = v5 & -256 | (int64_t)v12;
            v7 = v10;
            v8 = v5;
        }
    }
    uint16_t v14 = *lpszEnvironmentBlock; // 0x4014ab
    int32_t v15; // 0x4013c5
    int64_t v16; // 0x4013c5
    if (v14 < 0xd800) {
        // 0x4014b6
        v15 = v14;
        v16 = 2;
    } else {
        // 0x4014c3
        v16 = 2 * function_4019fa(v7, v8) & 0x1fffffffe;
    }
    // 0x4014d2
    int64_t v17; // bp-8, 0x4013c5
    int64_t v18 = &v17; // 0x4013cd
    int64_t v19 = (int64_t)lpszEnvironmentBlock; // 0x40145b
    int64_t v20 = &lpNumberOfBytesWritten; // 0x4014d4
    int64_t v21; // bp-58, 0x4013c5
    uint64_t v22 = (int64_t)&v21; // 0x4014db
    int64_t v23 = v20; // 0x401503
    int64_t v24 = 0; // 0x401503
    if (v15 != 0) {
        int64_t v25 = v20;
        int64_t v26 = 1; // 0x401509
        if (v26 < 512) {
            // 0x401515
            *(int64_t *)(v18 - 0xe038 + 8 * v26) = v25 < v22 ? v25 : 0;
        }
        int64_t v27 = v16 + v19;
        int64_t v28 = v25;
        int32_t v29 = v15;
        int64_t v30 = v29; // 0x401535
        if (v29 >= 128) {
            // 0x401537
            v30 = function_401a09(v28, v27);
        }
        int64_t v31 = v30; // 0x4013c5
        int64_t v32 = v28;
        int64_t v33 = v32; // 0x401542
        uint64_t v34; // 0x4013c5
        int64_t v35; // 0x401544
        while (v32 < v22) {
            // 0x401544
            v34 = v31;
            v35 = v32 + 1;
            *(char *)v32 = (char)v34;
            v31 = v34 / 256;
            v33 = v35;
            if (v34 < 256) {
                // break -> 0x401550
                break;
            }
            v32 = v35;
            v33 = v32;
        }
        int64_t v36 = v33;
        uint16_t v37 = *(int16_t *)v27; // 0x401550
        int32_t v38; // 0x4013c5
        int64_t v39; // 0x4013c5
        if (v37 < 0xd800) {
            // 0x401559
            v38 = v37;
            v39 = 1;
        } else {
            // 0x401566
            v38 = v29;
            v39 = function_4019fa(v36, v27);
        }
        int32_t v40 = v38;
        int64_t v41 = (2 * v39 & 0x1fffffffe) + v27; // 0x401573
        while (v29 != 0) {
            // 0x401527
            v27 = v41;
            v28 = v36;
            v29 = v40;
            v30 = v29;
            if (v29 >= 128) {
                // 0x401537
                v30 = function_401a09(v28, v27);
            }
            // 0x40153f
            v31 = v30;
            v32 = v28;
            v33 = v32;
            while (v32 < v22) {
                // 0x401544
                v34 = v31;
                v35 = v32 + 1;
                *(char *)v32 = (char)v34;
                v31 = v34 / 256;
                v33 = v35;
                if (v34 < 256) {
                    // break -> 0x401550
                    break;
                }
                v32 = v35;
                v33 = v32;
            }
            // 0x401550
            v36 = v33;
            v37 = *(int16_t *)v27;
            if (v37 < 0xd800) {
                // 0x401559
                v38 = v37;
                v39 = 1;
            } else {
                // 0x401566
                v38 = v29;
                v39 = function_4019fa(v36, v27);
            }
            // 0x40156e
            v40 = v38;
            v41 = (2 * v39 & 0x1fffffffe) + v27;
        }
        uint64_t v42 = v36 - v20; // 0x40157e
        *(char *)(v18 - 0x8030 + (v42 < 0x7ffd ? v42 : 0x7ffd)) = 0;
        int64_t v43 = v26; // 0x401503
        v23 = v36;
        v24 = v26;
        while (v40 != 0) {
            // 0x401509
            v25 = v36;
            v26 = v43 + 1;
            if (v26 < 512) {
                // 0x401515
                *(int64_t *)(v18 - 0xe038 + 8 * v26) = v25 < v22 ? v25 : 0;
            }
            // 0x401527
            v27 = v41;
            v28 = v25;
            v29 = v40;
            v30 = v29;
            if (v29 >= 128) {
                // 0x401537
                v30 = function_401a09(v28, v27);
            }
            // 0x40153f
            v31 = v30;
            v32 = v28;
            v33 = v32;
            while (v32 < v22) {
                // 0x401544
                v34 = v31;
                v35 = v32 + 1;
                *(char *)v32 = (char)v34;
                v31 = v34 / 256;
                v33 = v35;
                if (v34 < 256) {
                    // break -> 0x401550
                    break;
                }
                v32 = v35;
                v33 = v32;
            }
            // 0x401550
            v36 = v33;
            v37 = *(int16_t *)v27;
            if (v37 < 0xd800) {
                // 0x401559
                v38 = v37;
                v39 = 1;
            } else {
                // 0x401566
                v38 = v29;
                v39 = function_4019fa(v36, v27);
            }
            // 0x40156e
            v40 = v38;
            v41 = (2 * v39 & 0x1fffffffe) + v27;
            while (v29 != 0) {
                // 0x401527
                v27 = v41;
                v28 = v36;
                v29 = v40;
                v30 = v29;
                if (v29 >= 128) {
                    // 0x401537
                    v30 = function_401a09(v28, v27);
                }
                // 0x40153f
                v31 = v30;
                v32 = v28;
                v33 = v32;
                while (v32 < v22) {
                    // 0x401544
                    v34 = v31;
                    v35 = v32 + 1;
                    *(char *)v32 = (char)v34;
                    v31 = v34 / 256;
                    v33 = v35;
                    if (v34 < 256) {
                        // break -> 0x401550
                        break;
                    }
                    v32 = v35;
                    v33 = v32;
                }
                // 0x401550
                v36 = v33;
                v37 = *(int16_t *)v27;
                if (v37 < 0xd800) {
                    // 0x401559
                    v38 = v37;
                    v39 = 1;
                } else {
                    // 0x401566
                    v38 = v29;
                    v39 = function_4019fa(v36, v27);
                }
                // 0x40156e
                v40 = v38;
                v41 = (2 * v39 & 0x1fffffffe) + v27;
            }
            // 0x40157b
            v42 = v36 - v20;
            *(char *)(v18 - 0x8030 + (v42 < 0x7ffd ? v42 : 0x7ffd)) = 0;
            v43 = v26;
            v23 = v36;
            v24 = v26;
        }
    }
    uint64_t v44 = v24;
    int64_t v45 = v23; // 0x40159b
    if (v23 < v22) {
        // 0x40159d
        *(char *)v23 = 0;
        v45 = v23 + 1;
    }
    uint64_t v46 = v45 - v20; // 0x4015a3
    *(char *)(v18 - 0x8030 + (v46 < 0x7ffe ? v46 : 0x7ffe)) = 0;
    *(int64_t *)(v18 - 0xe030 + 8 * (v44 < 511 ? v44 : 511)) = 0;
    FreeEnvironmentStringsW(lpszEnvironmentBlock);
    return function_401353(v19);
}

// Address range: 0x401601 - 0x40162c
int64_t function_401601(void) {
    // 0x401601
    int64_t v1; // 0x401601
    int64_t v2 = v1;
    int64_t result; // 0x401601
    if ((int16_t)v2 < 0xd800) {
        // 0x401610
        *(int32_t *)(v2 + 24) = (int32_t)v2 % 0x10000;
        result = 2;
    } else {
        // 0x40161a
        result = 2 * function_4019fa(v1, v2) & 0x1fffffffe;
    }
    // 0x401623
    *(int64_t *)v2 = result + v2;
    return result;
}

// Address range: 0x40162c - 0x40165c
int64_t function_40162c(void) {
    // 0x40162c
    int64_t v1; // 0x40162c
    int64_t v2 = 0x100000000 * v1 >> 32; // 0x40163b
    if ((int32_t)v1 >= 128) {
        // 0x40163d
        v2 = function_401a09(v1, v1);
    }
    int64_t * v3 = (int64_t *)(v1 + 8); // 0x401642
    uint64_t v4 = v2;
    uint64_t v5 = *v3; // 0x401642
    int64_t result = v4; // 0x401649
    while (*(int64_t *)(v1 + 16) > v5) {
        // 0x40164b
        *v3 = v5 + 1;
        *(char *)v5 = (char)v4;
        int64_t v6 = v4 / 256; // 0x401655
        result = v6;
        if (v4 < 256) {
            // break -> 0x40165b
            break;
        }
        v4 = v6;
        v5 = *v3;
        result = v4;
    }
    // 0x40165b
    return result;
}

// Address range: 0x40165c - 0x401869
int64_t function_40165c(int64_t * a1, int64_t a2, uint64_t a3) {
    // 0x40165c
    int64_t v1; // 0x40165c
    int64_t v2 = v1;
    int32_t v3; // 0x40165c
    uint32_t v4 = v3;
    function_401601();
    if (v4 == 0) {
        // 0x4016c5
        function_40162c();
        if (a2 != 0) {
            uint64_t v5 = a2 - 1; // 0x4016d8
            uint64_t v6 = (0x100000000 * v2 >> 32) - v2; // 0x4016db
            *(char *)((v6 > v5 ? v5 : v6) + v2) = 0;
        }
        if (a3 != 0) {
            // 0x4016f6
            *a1 = 0;
        }
        // 0x401858
        return 0;
    }
    uint64_t v7 = 0x100000000 * v2 >> 32;
    int64_t v8 = 0; // 0x4016b3
    if ((1 << (int64_t)(v4 % 64) & 0x100002600) != 0 == v4 < 33) {
        while (true) {
            // 0x4016bb
            function_401601();
        }
    }
    while (true) {
        // 0x401715
        v8++;
        if (v8 < a3) {
            // 0x40171e
            *(int64_t *)((int64_t)a1 - 8 + 8 * v8) = v2 + a2 > v7 ? v7 : 0;
        }
        while (true) {
          lab_0x401741:
            if (v4 < 33) {
                if ((1 << (int64_t)(v4 % 64) & 0x100002600) != 0) {
                    // break -> 0x401849
                    break;
                }
                // 0x401834
                function_40162c();
                function_401601();
                goto lab_0x401741;
            } else {
                if (v4 != 34 == (v4 != 92)) {
                    // 0x401834
                    function_40162c();
                    function_401601();
                    goto lab_0x401741;
                } else {
                    if (v4 == 92) {
                        // break (via goto) -> 0x401771
                        goto lab_0x401771;
                    }
                    if (v4 == 34) {
                        // 0x401787
                        function_401601();
                        // 0x401787
                        function_401601();
                        // 0x401787
                        function_401601();
                        // 0x401787
                        function_401601();
                        goto lab_0x401787;
                    }
                    goto lab_0x401741;
                }
            }
        }
        // 0x401849
        function_40162c();
    }
  lab_0x401771:
    while (true) {
        // 0x401771
        function_401601();
    }
}

// Address range: 0x40186a - 0x401872
int64_t function_40186a(void) {
    // 0x40186a
    return &g9;
}

// Address range: 0x401872 - 0x401907
int64_t function_401872(int64_t a1, int64_t a2) {
    int64_t v1 = (int64_t)g7; // 0x401890
    if (g7 == NULL) {
        // 0x401892
        g7 = (int32_t *)&g8;
        v1 = &g8;
    }
    int32_t * v2 = (int32_t *)v1; // 0x4018a0
    int32_t v3 = *v2; // 0x4018a0
    if (v3 != -1) {
        uint32_t v4 = llvm_ctlz_i32(-1 - v3, true) ^ 31; // 0x4018df
        *v2 = 1 << v4 | v3;
        *(int64_t *)(v1 + (int64_t)(24 * v4) + 32) = a2;
    }
    // 0x4018fe
    return 0;
}

// Address range: 0x401907 - 0x40199d
int64_t function_401907(int64_t a1, int64_t result) {
    // 0x401907
    if (g7 == NULL) {
        // 0x401995
        return result;
    }
    int64_t v1 = a1;
    int32_t v2; // 0x401907
    int32_t v3; // 0x401907
    int32_t v4; // 0x401951
    int64_t v5; // 0x401907
    int64_t v6; // 0x401907
    int64_t v7; // 0x401907
    int64_t v8; // 0x401907
    int64_t v9; // 0x401907
    uint32_t v10; // 0x401907
    int32_t * v11; // 0x401928
    while (true) {
        int64_t v12 = v1; // 0x401923
        int64_t v13 = (int64_t)g7; // 0x401923
        int64_t v14; // 0x401907
        int64_t v15; // 0x401907
        int64_t v16; // 0x401907
        int64_t v17; // 0x401907
        uint32_t v18; // 0x401928
        int64_t v19; // 0x40196a
        int32_t v20; // 0x40192f
        uint32_t v21; // 0x40192f
        int64_t v22; // 0x40192f
        while (true) {
            // 0x401928
            v16 = v13;
            v14 = v12;
            v11 = (int32_t *)v16;
            v18 = *v11;
            v9 = v14;
            if (v18 != 0) {
                // 0x40192f
                v2 = v18;
                v7 = v14;
                v5 = v18;
                while (true) {
                    // 0x40192f
                    v6 = v5;
                    v4 = v2;
                    v20 = v6;
                    v21 = v20 == 0 ? (int32_t)v7 : llvm_cttz_i32(v20, true);
                    v22 = v21;
                    v10 = (-1 << v21 % 32) - 1;
                    v1 = 24 * v22 + v16;
                    if (v17 == 0) {
                        goto lab_0x40194d;
                    } else {
                        // 0x401942
                        v3 = v4;
                        v8 = v22;
                        if (*(int64_t *)(v1 + 32) != v17) {
                            goto lab_0x40192a;
                        } else {
                            goto lab_0x40194d;
                        }
                    }
                }
            }
            // 0x401967
            v15 = v9;
            v19 = *(int64_t *)(v16 + 8);
            if (v17 == 0) {
                // break -> 0x401970
                break;
            }
            // 0x40198b
            v12 = v15;
            v13 = v19;
            if (v19 == 0) {
                return result;
            }
        }
        // 0x401970
        *(int64_t *)&g7 = v19;
        while (v19 != 0) {
            // 0x401923
            v12 = v15;
            v13 = (int64_t)(int32_t *)v19;
            while (true) {
                // 0x401928
                v16 = v13;
                v14 = v12;
                v11 = (int32_t *)v16;
                v18 = *v11;
                v9 = v14;
                if (v18 != 0) {
                    // 0x40192f
                    v2 = v18;
                    v7 = v14;
                    v5 = v18;
                    while (true) {
                        // 0x40192f
                        v6 = v5;
                        v4 = v2;
                        v20 = v6;
                        v21 = v20 == 0 ? (int32_t)v7 : llvm_cttz_i32(v20, true);
                        v22 = v21;
                        v10 = (-1 << v21 % 32) - 1;
                        v1 = 24 * v22 + v16;
                        if (v17 == 0) {
                            goto lab_0x40194d;
                        } else {
                            // 0x401942
                            v3 = v4;
                            v8 = v22;
                            if (*(int64_t *)(v1 + 32) != v17) {
                                goto lab_0x40192a;
                            } else {
                                goto lab_0x40194d;
                            }
                        }
                    }
                }
                // 0x401967
                v15 = v9;
                v19 = *(int64_t *)(v16 + 8);
                if (v17 == 0) {
                    // break -> 0x401970
                    break;
                }
                // 0x40198b
                v12 = v15;
                v13 = v19;
                if (v19 == 0) {
                    return result;
                }
            }
            // 0x401970
            *(int64_t *)&g7 = v19;
        }
        return result;
      lab_0x40191b:
        // 0x40191b
        if (g7 == NULL) {
            // break -> 0x401995
            break;
        }
    }
    // 0x401995
    return result;
  lab_0x40194d:;
    int32_t v23 = v4 & v10; // 0x401951
    *v11 = v23;
    v3 = v23;
    v8 = v1;
    if (*(int64_t *)(v1 + 16) != 0) {
        // break (via goto) -> 0x40191b
        goto lab_0x40191b;
    }
    goto lab_0x40192a;
  lab_0x40192a:;
    int64_t v24 = v6 & (int64_t)v10; // 0x40193a
    v2 = v3;
    v7 = v8;
    v5 = v24;
    v9 = v8;
    if (v24 == 0) {
        // break -> 0x401967
        goto lab_0x401967;
    }
    goto lab_0x40192f;
}

// Address range: 0x40199d - 0x4019c7
int64_t function_40199d(int64_t a1) {
    // 0x40199d
    int64_t v1; // 0x40199d
    if ((int32_t)(0x1000000000000 * v1 >> 48) < 0) {
        // 0x4019b4
        *(int32_t *)&g9 = (int32_t)(int64_t)g5;
        return -1;
    }
    uint64_t result = __asm_syscall(); // 0x4019a7
    if (result < 0xfffffffffffff001) {
        // 0x4019b1
        return result;
    }
    // 0x4019b4
    *(int32_t *)&g9 = (int32_t)(-result & 0xffffffff);
    return -1;
}

// Address range: 0x4019c7 - 0x4019cd
int64_t function_4019c7(void) {
    // 0x4019c7
    int64_t v1; // 0x4019c7
    return function_4019d4(v1);
}

// Address range: 0x4019cd - 0x4019d4
int64_t function_4019cd(void) {
    // 0x4019cd
    int64_t v1; // 0x4019cd
    return (uint64_t)v1 / 0x100000000 % 0x10000;
}

// Address range: 0x4019d4 - 0x4019e2
int64_t function_4019d4(int64_t a1) {
    // 0x4019d4
    return __asm_syscall();
}

// Address range: 0x4019e2 - 0x4019fa
int64_t function_4019e2(void) {
    // 0x4019e2
    int64_t v1; // 0x4019e2
    return function_4019d4(v1);
}

// Address range: 0x4019fa - 0x401a09
int64_t function_4019fa(int64_t a1, int64_t a2) {
    // 0x4019fa
    return function_401a3c(a1, a2);
}

// Address range: 0x401a09 - 0x401a3c
int64_t function_401a09(int64_t a1, int64_t a2) {
    // 0x401a09
    int64_t v1; // 0x401a09
    int64_t result = v1 & 0xffffffff; // 0x401a0b
    uint32_t v2 = (int32_t)v1; // 0x401a0f
    if (v2 < 128) {
        // 0x401a36
        return result;
    }
    uint32_t v3 = *(int32_t *)(int64_t)((2 * llvm_ctlz_i32(v2, true) ^ 62) + 0x401ae9); // 0x401a1c
    int64_t v4 = 0; // 0x401a1c
    uint64_t v5 = (int64_t)v3;
    int64_t v6 = result / 64; // 0x401a22
    v4 = 256 * (result % 64 | v4 & 0xffffffffffff00) | 0x8000;
    unsigned char v7 = (char)v5 - 1; // 0x401a30
    int64_t v8 = v5 & -256 | (int64_t)v7; // 0x401a32
    while (v7 != 0) {
        uint64_t v9 = v6;
        v5 = v8;
        v6 = v9 / 64;
        v4 = 256 * (v9 % 64 | v4 & 0xffffffffffff00) | 0x8000;
        v7 = (char)v5 - 1;
        v8 = v5 & -256 | (int64_t)v7;
    }
    // 0x401a36
    return v6 | v4 | v5 / 256 % 256;
}

// Address range: 0x401a3c - 0x401a9d
int64_t function_401a3c(int64_t a1, int64_t a2) {
    int64_t result2 = 0; // 0x401a46
    int64_t v1; // 0x401a3c
    uint16_t v2; // 0x401a4d
    while (true) {
      lab_0x401a47:;
        int64_t v3 = result2;
        result2 = v3 + 1 & 0xffffffff;
        v2 = *(int16_t *)(2 * v3 + v1);
        switch (v2 & -1024) {
            case -0x2400: {
                goto lab_0x401a47;
            }
            case -0x2800: {
                uint16_t v4 = *(int16_t *)(2 * result2 + v1); // 0x401a6a
                int64_t result; // 0x401a3c
                if ((v4 & -1024) == -0x2400) {
                    // 0x401a87
                    *(int32_t *)v1 = 1024 * (int32_t)v2 - 0x35fdc00 + (int32_t)v4;
                    result = v3 + 2 & 0xffffffff;
                } else {
                    // 0x401a7c
                    *(int32_t *)v1 = 0xfffd;
                    result = 0xffffffff;
                }
                // 0x401a96
                return result;
            }
            default: {
                goto lab_0x401a66;
            }
        }
    }
  lab_0x401a66:
    // 0x401a66
    *(int32_t *)v1 = (int32_t)v2;
    // 0x401a96
    return result2;
}

// Address range: 0x401aa1 - 0x401ad2
int64_t function_401aa1(void) {
    // 0x401aa1
    g10 |= 4;
    if ((*(char *)&g3 & 4) != 0) {
        // 0x401ab1
        int64_t v1; // 0x401aa1
        ExitProcess((int32_t)v1 % 256);
        // UNREACHABLE
    }
    // 0x401abe
    __asm_syscall();
    __asm_lidt(*(int80_t *)0x401ad2);
    while (true) {
        // 0x401acf
        __asm_hlt();
    }
}

// --------------- Dynamically Linked Functions ---------------

// VOID ExitProcess(_In_ UINT uExitCode);
// BOOL FreeEnvironmentStringsW(_In_ LPWCH penv);
// LPWSTR GetCommandLineW(VOID);
// LPWCH GetEnvironmentStringsW(void);
// HANDLE GetStdHandle(_In_ DWORD nStdHandle);
// BOOL SetDefaultDllDirectories(_In_ DWORD DirectoryFlags);
// BOOL WriteFile(_In_ HANDLE hFile, LPCVOID lpBuffer, _In_ DWORD nNumberOfBytesToWrite, _Out_opt_ LPDWORD lpNumberOfBytesWritten, _Inout_opt_ LPOVERLAPPED lpOverlapped);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: aspack
// Detected functions: 31


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int sub_8048310();
// int scanf(const char *format, ...);
// size_t strlen(const char *s);
// int printf(const char *format, ...);
int __fastcall sub_8048384(int, int);
int __cdecl shift(char *s); // idb
int __cdecl test(int, int);
int __cdecl main(int argc, const char **argv, const char **envp);

//-------------------------------------------------------------------------
// Data declarations

int (*dword_8049FFC)(void) = NULL; // weak
// extern _UNKNOWN _gmon_start__; weak


//----- (08048310) --------------------------------------------------------
int sub_8048310()
{
  return dword_8049FFC();
}
// 8049FFC: using guessed type int (*dword_8049FFC)(void);

//----- (08048384) --------------------------------------------------------
int __fastcall sub_8048384(int a1, int a2)
{
  int v3; // [esp-4h] [ebp-8h]

  v3 = a2;
  if ( &_gmon_start__ )
    ((void (__thiscall *)(int, int))_gmon_start__)(a1, a2);
  return v3;
}
// 80483A1: variable 'v3' is possibly undefined

//----- (08048414) --------------------------------------------------------
int __cdecl shift(char *s)
{
  size_t i; // [esp+1Ch] [ebp-7Ch]
  char v3[120]; // [esp+20h] [ebp-78h] BYREF

  for ( i = 0; i < strlen(s); ++i )
    v3[i] = s[i] - 3;
  v3[i] = 0;
  return printf("%s\n", v3);
}
// 8048414: using guessed type char var_78[120];

//----- (0804846E) --------------------------------------------------------
int __cdecl test(int a1, int a2)
{
  if ( a1 == a2 )
    return shift("Sdvvzrug#RN$$$#=,");
  else
    return shift("Lqydolg#Sdvvzrug$");
}

//----- (08048498) --------------------------------------------------------
int __cdecl main(int argc, const char **argv, const char **envp)
{
  void *v3; // esp
  int v5; // [esp+14h] [ebp-4h] BYREF

  v3 = alloca(16);
  printf("IOLI Crackme Level 0x03\n");
  printf("Password: ");
  scanf("%d", &v5);
  test(v5, 338724);
  return 0;
}

// nfuncs=22 queued=5 decompiled=5 lumina nreq=0 worse=0 better=0
// ALL OK, 5 function(s) have been successfully decompiled

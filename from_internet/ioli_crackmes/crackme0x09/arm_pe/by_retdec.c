//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <wchar.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

// ------------------- Function Prototypes --------------------

int32_t entry_point(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_11050(int32_t a1, int32_t a2);
int32_t function_11108(void);
int32_t function_11128(int32_t str, int32_t a2);
int32_t function_111d8(int32_t * str, int32_t a2);
int32_t function_112f0(int32_t a1, int32_t a2, int32_t a3);
int32_t function_1135c(int32_t a1);
int32_t function_113a0(void);
int32_t function_113b0(int32_t a1);
int32_t function_113bc(int32_t uExitCode);
int32_t function_113d4(void);
int32_t function_113e0(int32_t a1, int32_t * a2, int32_t * a3);
int32_t function_11454(void);
int32_t function_11470(int32_t * a1);
int32_t function_11498(void);
int32_t function_11510(void);
int32_t function_11520(int32_t uExitCode);
int32_t function_11538(int32_t a1);
int32_t function_11574(void);
int32_t function_115b8(void);
int32_t function_11620(int32_t result);
int32_t function_11648(int32_t a1, int32_t a2, int32_t wstr);
void function_118a0(void);
bool function_118ac(int32_t * hProcess, int32_t uExitCode);
int32_t function_118b8(char * format, ...);
int32_t function_118c4(char * s);
int32_t function_118d0(char * s, char * format, ...);
int32_t function_118dc(char * s);
int32_t function_118e8(char * format, ...);
int32_t function_118f4(char * s1, char * s2, int32_t n);
int32_t * function_11900(int32_t size);
void function_1190c(int32_t * ptr);
int32_t function_11918(struct _IO_FILE * stream);
int32_t * function_11924(int32_t * ptr, int32_t size);
int32_t function_11930(void);
int32_t function_1193c(char * s, char * accept);
char * function_11948(char * s, int32_t c);
int32_t function_11954(char * s, char * reject);
int32_t function_11960(int32_t * hModule, int16_t * lpFilename, int32_t nSize);
int32_t function_1196c(int16_t * s);
int32_t function_11978(char * s, int16_t * pwcs, int32_t n);

// --------------------- Global Variables ---------------------

int32_t g1 = -0x16d2bff0; // 0x11574
int32_t g2 = -1; // 0x11984
int32_t g3 = 0; // 0x14000
int32_t g4 = 0; // 0x14004
int32_t g5 = 0; // 0x14008
int32_t g6 = 0; // 0x1400c
int32_t g7 = 0; // 0x14010
int32_t g8 = 0; // 0x14014
int32_t g9;

// ------------------------ Functions -------------------------

// Address range: 0x11000 - 0x11050
int32_t entry_point(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x11000
    _fpreset();
    int32_t v1 = function_1135c((int32_t)&g9); // 0x11018
    function_11620(function_11538(v1));
    int32_t uExitCode = function_11648(a1, a2, a3); // 0x11034
    function_11510();
    TerminateProcess((int32_t *)66, uExitCode);
    while (true) {
        // continue -> 0x1104c
    }
}

// Address range: 0x11050 - 0x11100
int32_t function_11050(int32_t a1, int32_t a2) {
    int32_t v1 = 0; // 0x11070
    int32_t str = *(int32_t *)(4 * v1 + a2); // 0x110e0
    int32_t result; // 0x11050
    while (str != 0) {
        // 0x11074
        v1++;
        if (strncmp((char *)str, "LOLO", 3) == 0) {
            // 0x110b4
            g3 = 1;
            result = 1;
            return result;
        }
        str = *(int32_t *)(4 * v1 + a2);
    }
    // 0x110ec
    function_11520(-1);
  lab_0x110f4:
    // 0x110f4
    return result;
}

// Address range: 0x11108 - 0x11124
int32_t function_11108(void) {
    // 0x11108
    puts("Password Incorrect!");
    return function_11520(0);
}

// Address range: 0x11128 - 0x111cc
int32_t function_11128(int32_t str, int32_t a2) {
    // 0x11128
    int32_t v1; // bp-24, 0x11128
    sscanf((char *)str, "%d", &v1);
    int32_t v2 = function_11050(v1, a2); // 0x11160
    int32_t v3 = 0; // 0x1116c
    if (v2 == 0) {
        // 0x111c4
        return 0;
    }
    int32_t v4 = v2; // 0x11188
    if (v1 % 2 == 0) {
        // 0x1118c
        if (g3 == 1) {
            // 0x1119c
            puts("Password OK!");
        }
        // 0x111a4
        v4 = function_11520(0);
    }
    int32_t result = v4;
    v3++;
    while (v3 < 10) {
        // 0x1117c
        v4 = result;
        if (v1 % 2 == 0) {
            // 0x1118c
            if (g3 == 1) {
                // 0x1119c
                puts("Password OK!");
            }
            // 0x111a4
            v4 = function_11520(0);
        }
        // 0x111ac
        result = v4;
        v3++;
    }
    // 0x111c4
    return result;
}

// Address range: 0x111d8 - 0x112e8
int32_t function_111d8(int32_t * str, int32_t a2) {
    int32_t v1 = (int32_t)str;
    int32_t v2 = 0; // 0x11278
    int32_t v3 = 0; // 0x11278
    int32_t v4; // bp-32, 0x111d8
    if (strlen((char *)str) != 0) {
        char str2 = *(char *)(v2 + v1); // bp-33, 0x11218
        sscanf(&str2, "%d", &v4);
        v3 += v4;
        if (v3 == 16) {
            // 0x1124c
            function_11128(v1, a2);
        }
        // 0x11258
        v2++;
        while (v2 < strlen((char *)str)) {
            // 0x11204
            str2 = *(char *)(v2 + v1);
            sscanf(&str2, "%d", &v4);
            v3 += v4;
            if (v3 == 16) {
                // 0x1124c
                function_11128(v1, a2);
            }
            // 0x11258
            v2++;
        }
    }
    // 0x1127c
    function_11108();
    int32_t v5 = function_11050(v4, a2); // 0x1128c
    int32_t v6 = 0; // 0x11298
    if (v5 == 0) {
        // 0x112e0
        return 0;
    }
    int32_t v7 = v5; // 0x112b4
    if (v4 % 2 == 0) {
        // 0x112b8
        puts("wtf?");
        v7 = function_11520(0);
    }
    int32_t result = v7;
    v6++;
    while (v6 < 10) {
        // 0x112a8
        v7 = result;
        if (v4 % 2 == 0) {
            // 0x112b8
            puts("wtf?");
            v7 = function_11520(0);
        }
        // 0x112c8
        result = v7;
        v6++;
    }
    // 0x112e0
    return result;
}

// Address range: 0x112f0 - 0x11350
int32_t function_112f0(int32_t a1, int32_t a2, int32_t a3) {
    // 0x112f0
    function_11620(a1);
    puts("IOLI Crackme Level 0x09");
    printf("Password: ");
    int32_t v1; // bp-116, 0x112f0
    scanf("%s", &v1);
    function_111d8(&v1, a3);
    return 0;
}

// Address range: 0x1135c - 0x11394
int32_t function_1135c(int32_t a1) {
    // 0x1135c
    return 0x1306c;
}

// Address range: 0x113a0 - 0x113ac
int32_t function_113a0(void) {
    // 0x113a0
    return g4;
}

// Address range: 0x113b0 - 0x113bc
int32_t function_113b0(int32_t a1) {
    // 0x113b0
    return _fcloseall();
}

// Address range: 0x113bc - 0x113d4
int32_t function_113bc(int32_t uExitCode) {
    // 0x113bc
    function_113b0(uExitCode);
    TerminateProcess((int32_t *)66, uExitCode);
    while (true) {
        // continue -> 0x113d0
    }
}

// Address range: 0x113d4 - 0x113e0
int32_t function_113d4(void) {
    // 0x113d4
    int32_t v1; // 0x113d4
    return function_113b0(v1);
}

// Address range: 0x113e0 - 0x11454
int32_t function_113e0(int32_t a1, int32_t * a2, int32_t * a3) {
    // 0x113e0
    if (a2 == NULL || a3 == NULL) {
        // 0x1144c
        return 0;
    }
    int32_t v1 = (int32_t)a3 - (int32_t)a2; // 0x11410
    if (v1 < 0) {
        // 0x1144c
        return 0;
    }
    int32_t v2 = v1 + 4 & -4; // 0x11424
    int32_t * mem = realloc(a2, v2); // 0x1142c
    int32_t result = 0; // 0x11434
    if (mem != NULL) {
        int32_t v3 = (int32_t)mem; // 0x1142c
        *a2 = v3;
        int32_t v4 = v2 + v3;
        *a3 = v4;
        *(int32_t *)(v4 - 4) = a1;
        result = a1;
    }
    // 0x1144c
    return result;
}

// Address range: 0x11454 - 0x11468
int32_t function_11454(void) {
    // 0x11454
    int32_t v1; // 0x11454
    return function_113e0(v1, &g4, &g5);
}

// Address range: 0x11470 - 0x11490
int32_t function_11470(int32_t * a1) {
    int32_t v1 = function_113e0((int32_t)a1, &g4, &g5); // 0x1147c
    return v1 == 0;
}

// Address range: 0x11498 - 0x11508
int32_t function_11498(void) {
    uint32_t v1 = g4; // 0x114a0
    if (v1 == 0) {
        // 0x114fc
        return fflush(NULL);
    }
    uint32_t v2 = g5 - 4; // 0x114b4
    if (v1 >= v2 != v1 != v2) {
        int32_t v3 = g5 - 8; // 0x114c4
        while (v1 == v3 || v1 < v3) {
            // 0x114c8
            v3 -= 4;
        }
    }
    // 0x114ec
    free((int32_t *)v1);
    g4 = 0;
    // 0x114fc
    return fflush(NULL);
}

// Address range: 0x11510 - 0x11520
int32_t function_11510(void) {
    // 0x11510
    return function_113b0(function_11498());
}

// Address range: 0x11520 - 0x11538
int32_t function_11520(int32_t uExitCode) {
    // 0x11520
    function_11510();
    TerminateProcess((int32_t *)66, uExitCode);
    while (true) {
        // continue -> 0x11534
    }
}

// Address range: 0x11538 - 0x1156c
int32_t function_11538(int32_t a1) {
    int32_t * mem = malloc(128); // 0x11540
    int32_t result = (int32_t)mem; // 0x11540
    g4 = result;
    if (mem == NULL) {
        return result;
    }
    // 0x11554
    *mem = 0;
    g5 = result;
    return 1;
}

// Address range: 0x11574 - 0x115b4
int32_t function_11574(void) {
    // 0x11574
    int32_t result; // 0x11574
    return result;
}

// Address range: 0x115b8 - 0x11618
int32_t function_115b8(void) {
    int32_t v1 = &g2; // 0x115d0
    while (*(int32_t *)(v1 + 4) != 0) {
        // 0x115d4
        v1 += 4;
    }
    // 0x1160c
    return function_11470(&g1);
}

// Address range: 0x11620 - 0x11644
int32_t function_11620(int32_t result) {
    // 0x11620
    if (g6 != 0) {
        return result;
    }
    // 0x11634
    g6 = 1;
    return function_115b8();
}

// Address range: 0x11648 - 0x1188c
int32_t function_11648(int32_t a1, int32_t a2, int32_t wstr) {
    // 0x11648
    int32_t v1; // bp-28, 0x11648
    *(int16_t *)((int32_t)&v1 - 1024) = 0;
    int32_t lpFilename; // bp-1052, 0x11648
    int32_t v2 = GetModuleFileNameW(NULL, (int16_t *)&lpFilename, 512); // 0x1166c
    int32_t v3 = 0; // 0x1167c
    if (wstr != 0) {
        // 0x11680
        v3 = wcslen((int16_t *)wstr);
    }
    int32_t * mem = malloc(v2 + 2 + v3); // 0x11694
    int32_t v4 = (int32_t)mem; // 0x11694
    if (mem == NULL) {
        // 0x116a0
        TerminateProcess((int32_t *)(v4 + 66), -1);
        while (true) {
            // continue -> 0x116ac
        }
    }
    int32_t * mem2 = malloc(4); // 0x116b4
    int32_t v5 = (int32_t)mem2; // 0x116b4
    g8 = v5;
    if (mem2 == NULL) {
        // 0x116c8
        TerminateProcess((int32_t *)(v5 + 66), -1);
        while (true) {
            // continue -> 0x116d4
        }
    }
    // 0x116d8
    *mem2 = v4;
    int32_t v6 = wcslen((int16_t *)&lpFilename); // 0x116e4
    wcstombs((char *)mem, (int16_t *)&lpFilename, v6 + 1);
    int32_t v7 = g7 + 1; // 0x11700
    g7 = v7;
    int32_t v8 = v7; // 0x1170c
    if (v3 < 1) {
        goto lab_0x11860;
    } else {
        int32_t str = *(int32_t *)g8; // 0x11718
        int32_t v9 = str + 1 + strlen((char *)str); // 0x11728
        char * dest = (char *)v9; // 0x11738
        wcstombs(dest, (int16_t *)wstr, v3 + 1);
        int32_t v10 = strlen(dest) + v9; // 0x11744
        int32_t v11 = 1; // 0x1174c
        if (v9 == 0) {
            // 0x11854
            g7 = 1;
            v8 = 1;
            goto lab_0x11860;
        } else {
            int32_t str2 = v9;
            int32_t v12 = strspn((char *)str2, " \t\r\n") + str2; // 0x11760
            char * str4 = (char *)v12; // 0x11764
            char c = *str4; // 0x11764
            int32_t v13 = v11; // 0x1176c
            while (c != 0) {
                // 0x11770
                int32_t v14; // 0x11648
                int32_t v15 = c == 34 ? v14 : (int32_t)(c == 34 ? 0 : c);
                int32_t v16; // 0x11648
                int32_t v17; // 0x11648
                if (c == 34) {
                    int32_t str3 = v12 + 1; // 0x117b4
                    char * found_char_pos = strchr((char *)str3, (int32_t)c); // 0x117c4
                    v16 = found_char_pos == NULL ? v10 : (int32_t)found_char_pos;
                    v17 = str3;
                } else {
                    int32_t v18 = (int32_t)"\"'" + 1; // 0x117a4
                    char v19 = *(char *)v18; // 0x117a4
                    while (v19 != 0) {
                        // 0x11794
                        if (v15 == (int32_t)v19) {
                            goto lab_0x117b4;
                        }
                        v18++;
                        v19 = *(char *)v18;
                    }
                    // 0x117d4
                    v16 = strcspn(str4, " \t\r\n") + v12;
                    v17 = v12;
                }
                // 0x117e4
                *(char *)v16 = 0;
                int32_t v20 = v11 + 1; // 0x117ec
                int32_t v21 = 4 * v20; // 0x117f4
                int32_t * mem3 = realloc((int32_t *)g8, v21); // 0x11800
                if (mem3 == NULL) {
                    // 0x11844
                    g7 = -1;
                    goto lab_0x11834;
                }
                int32_t v22 = (int32_t)mem3; // 0x11800
                g8 = v22;
                *(int32_t *)(v21 - 4 + v22) = v17;
                v11 = v20;
                v14 = v15;
                v13 = v20;
                if (v16 == v10) {
                    // break -> 0x11824
                    break;
                }
                str2 = v16 + 1;
                v12 = strspn((char *)str2, " \t\r\n") + str2;
                str4 = (char *)v12;
                c = *str4;
                v13 = v11;
            }
            // 0x11824
            g7 = v13;
            v8 = v13;
            if (v13 < 0) {
                goto lab_0x11834;
            } else {
                goto lab_0x11860;
            }
        }
    }
  lab_0x11860:
    // 0x11860
    *(int32_t *)(g8 + 4 * v8) = 0;
    return function_112f0(g7, g8, g8);
  lab_0x11834:
    // 0x11834
    TerminateProcess((int32_t *)66, -1);
    while (true) {
        // continue -> 0x11840
    }
}

// Address range: 0x118a0 - 0x118a8
void function_118a0(void) {
    // 0x118a0
    _fpreset();
}

// Address range: 0x118ac - 0x118b4
bool function_118ac(int32_t * hProcess, int32_t uExitCode) {
    // 0x118ac
    return TerminateProcess(hProcess, uExitCode);
}

// Address range: 0x118b8 - 0x118c0
int32_t function_118b8(char * format, ...) {
    // 0x118b8
    return scanf(format);
}

// Address range: 0x118c4 - 0x118cc
int32_t function_118c4(char * s) {
    // 0x118c4
    return strlen(s);
}

// Address range: 0x118d0 - 0x118d8
int32_t function_118d0(char * s, char * format, ...) {
    // 0x118d0
    return sscanf(s, format);
}

// Address range: 0x118dc - 0x118e4
int32_t function_118dc(char * s) {
    // 0x118dc
    return puts(s);
}

// Address range: 0x118e8 - 0x118f0
int32_t function_118e8(char * format, ...) {
    // 0x118e8
    return printf(format);
}

// Address range: 0x118f4 - 0x118fc
int32_t function_118f4(char * s1, char * s2, int32_t n) {
    // 0x118f4
    return strncmp(s1, s2, n);
}

// Address range: 0x11900 - 0x11908
int32_t * function_11900(int32_t size) {
    // 0x11900
    return malloc(size);
}

// Address range: 0x1190c - 0x11914
void function_1190c(int32_t * ptr) {
    // 0x1190c
    free(ptr);
}

// Address range: 0x11918 - 0x11920
int32_t function_11918(struct _IO_FILE * stream) {
    // 0x11918
    return fflush(stream);
}

// Address range: 0x11924 - 0x1192c
int32_t * function_11924(int32_t * ptr, int32_t size) {
    // 0x11924
    return realloc(ptr, size);
}

// Address range: 0x11930 - 0x11938
int32_t function_11930(void) {
    // 0x11930
    return _fcloseall();
}

// Address range: 0x1193c - 0x11944
int32_t function_1193c(char * s, char * accept) {
    // 0x1193c
    return strspn(s, accept);
}

// Address range: 0x11948 - 0x11950
char * function_11948(char * s, int32_t c) {
    // 0x11948
    return strchr(s, c);
}

// Address range: 0x11954 - 0x1195c
int32_t function_11954(char * s, char * reject) {
    // 0x11954
    return strcspn(s, reject);
}

// Address range: 0x11960 - 0x11968
int32_t function_11960(int32_t * hModule, int16_t * lpFilename, int32_t nSize) {
    // 0x11960
    return GetModuleFileNameW(hModule, lpFilename, nSize);
}

// Address range: 0x1196c - 0x11974
int32_t function_1196c(int16_t * s) {
    // 0x1196c
    return wcslen(s);
}

// Address range: 0x11978 - 0x11980
int32_t function_11978(char * s, int16_t * pwcs, int32_t n) {
    // 0x11978
    return wcstombs(s, pwcs, n);
}

// --------------- Dynamically Linked Functions ---------------

// int __cdecl _fcloseall(void);
// void __cdecl _fpreset(void);
// int fflush(FILE * stream);
// void free(void * ptr);
// DWORD GetModuleFileNameW(_In_opt_ HMODULE hModule, LPWSTR lpFilename, _In_ DWORD nSize);
// void * malloc(size_t size);
// int printf(const char * restrict format, ...);
// int puts(const char * s);
// void * realloc(void * ptr, size_t size);
// int scanf(const char * restrict format, ...);
// int sscanf(const char * restrict s, const char * restrict format, ...);
// char * strchr(char * s, int c);
// size_t strcspn(const char * s, const char * reject);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// size_t strspn(const char * s, const char * accept);
// BOOL TerminateProcess(_In_ HANDLE hProcess, _In_ UINT uExitCode);
// size_t wcslen(const wchar_t * s);
// size_t wcstombs(char * restrict s, const wchar_t * restrict pwcs, size_t n);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft
// Detected functions: 41


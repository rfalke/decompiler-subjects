//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <wchar.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

// ------------------- Function Prototypes --------------------

int32_t entry_point(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_11050(int32_t a1, int32_t a2);
int32_t function_1110c(void);
int32_t function_1112c(int32_t str, int32_t a2);
int32_t function_111dc(int32_t * str, int32_t a2);
int32_t function_112f4(int32_t a1, int32_t a2, int32_t a3);
int32_t function_11360(void);
int32_t function_113a4(void);
int32_t function_113b4(int32_t a1);
int32_t function_113c0(int32_t uExitCode);
int32_t function_113d8(void);
int32_t function_113e4(int32_t a1, int32_t * a2, int32_t * a3);
int32_t function_11458(void);
int32_t function_11474(void);
int32_t function_1149c(void);
int32_t function_11514(void);
int32_t function_11524(int32_t uExitCode);
int32_t function_1153c(void);
int32_t function_11578(void);
int32_t function_115bc(void);
int32_t function_11624(void);
int32_t function_1164c(int32_t a1, int32_t a2, int32_t wstr);
void function_118a4(void);
bool function_118b0(int32_t * hProcess, int32_t uExitCode);
int32_t function_118bc(char * format, ...);
int32_t function_118c8(char * s);
int32_t function_118d4(char * s, char * format, ...);
int32_t function_118e0(char * s);
int32_t function_118ec(char * format, ...);
int32_t function_118f8(char * s1, char * s2, int32_t n);
int32_t * function_11904(int32_t size);
void function_11910(int32_t * ptr);
int32_t function_1191c(struct _IO_FILE * stream);
int32_t * function_11928(int32_t * ptr, int32_t size);
int32_t function_11934(void);
int32_t function_11940(char * s, char * accept);
char * function_1194c(char * s, int32_t c);
int32_t function_11958(char * s, char * reject);
int32_t function_11964(int32_t * hModule, int16_t * lpFilename, int32_t nSize);
int32_t function_11970(int16_t * s);
int32_t function_1197c(char * s, int16_t * pwcs, int32_t n);

// --------------------- Global Variables ---------------------

int32_t g1 = -1; // 0x11988
int32_t g2 = 0; // 0x14000
int32_t g3 = 0; // 0x14004
int32_t g4 = 0; // 0x14008
int32_t g5 = 0; // 0x1400c
int32_t g6 = 0; // 0x14010
int32_t g7 = 0; // 0x14014

// ------------------------ Functions -------------------------

// Address range: 0x11000 - 0x11050
int32_t entry_point(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x11000
    _fpreset();
    function_11360();
    function_1153c();
    function_11624();
    int32_t uExitCode = function_1164c(a1, a2, a3); // 0x11034
    function_11514();
    TerminateProcess((int32_t *)66, uExitCode);
    while (true) {
        // continue -> 0x1104c
    }
}

// Address range: 0x11050 - 0x11104
int32_t function_11050(int32_t a1, int32_t a2) {
    int32_t v1 = 0; // 0x11070
    int32_t str = *(int32_t *)(4 * v1 + a2); // 0x110e0
    int32_t result = 0; // 0x110e8
    while (str != 0) {
        // 0x11074
        v1++;
        if (strncmp((char *)str, "LOLO", 3) == 0) {
            // 0x110b4
            g2 = 1;
            result = 1;
            return result;
        }
        str = *(int32_t *)(4 * v1 + a2);
        result = 0;
    }
  lab_0x110f4:
    // 0x110f4
    return result;
}

// Address range: 0x1110c - 0x11128
int32_t function_1110c(void) {
    // 0x1110c
    puts("Password Incorrect!");
    return function_11524(0);
}

// Address range: 0x1112c - 0x111d0
int32_t function_1112c(int32_t str, int32_t a2) {
    // 0x1112c
    int32_t v1; // bp-24, 0x1112c
    sscanf((char *)str, "%d", &v1);
    int32_t v2 = function_11050(v1, a2); // 0x11164
    int32_t v3 = 0; // 0x11170
    if (v2 == 0) {
        // 0x111c8
        return 0;
    }
    int32_t v4 = v2; // 0x1118c
    if (v1 % 2 == 0) {
        // 0x11190
        if (g2 == 1) {
            // 0x111a0
            puts("Password OK!");
        }
        // 0x111a8
        v4 = function_11524(0);
    }
    int32_t result = v4;
    v3++;
    while (v3 < 10) {
        // 0x11180
        v4 = result;
        if (v1 % 2 == 0) {
            // 0x11190
            if (g2 == 1) {
                // 0x111a0
                puts("Password OK!");
            }
            // 0x111a8
            v4 = function_11524(0);
        }
        // 0x111b0
        result = v4;
        v3++;
    }
    // 0x111c8
    return result;
}

// Address range: 0x111dc - 0x112ec
int32_t function_111dc(int32_t * str, int32_t a2) {
    int32_t v1 = (int32_t)str;
    int32_t v2 = 0; // 0x1127c
    int32_t v3 = 0; // 0x1127c
    int32_t v4; // bp-32, 0x111dc
    if (strlen((char *)str) != 0) {
        char str2 = *(char *)(v2 + v1); // bp-33, 0x1121c
        sscanf(&str2, "%d", &v4);
        v3 += v4;
        if (v3 == 16) {
            // 0x11250
            function_1112c(v1, a2);
        }
        // 0x1125c
        v2++;
        while (v2 < strlen((char *)str)) {
            // 0x11208
            str2 = *(char *)(v2 + v1);
            sscanf(&str2, "%d", &v4);
            v3 += v4;
            if (v3 == 16) {
                // 0x11250
                function_1112c(v1, a2);
            }
            // 0x1125c
            v2++;
        }
    }
    // 0x11280
    function_1110c();
    int32_t v5 = function_11050(v4, a2); // 0x11290
    int32_t v6 = 0; // 0x1129c
    if (v5 == 0) {
        // 0x112e4
        return 0;
    }
    int32_t v7 = v5; // 0x112b8
    if (v4 % 2 == 0) {
        // 0x112bc
        puts("wtf?");
        v7 = function_11524(0);
    }
    int32_t result = v7;
    v6++;
    while (v6 < 10) {
        // 0x112ac
        v7 = result;
        if (v4 % 2 == 0) {
            // 0x112bc
            puts("wtf?");
            v7 = function_11524(0);
        }
        // 0x112cc
        result = v7;
        v6++;
    }
    // 0x112e4
    return result;
}

// Address range: 0x112f4 - 0x11354
int32_t function_112f4(int32_t a1, int32_t a2, int32_t a3) {
    // 0x112f4
    function_11624();
    puts("IOLI Crackme Level 0x07");
    printf("Password: ");
    int32_t v1; // bp-116, 0x112f4
    scanf("%s", &v1);
    function_111dc(&v1, a3);
    return 0;
}

// Address range: 0x11360 - 0x11398
int32_t function_11360(void) {
    // 0x11360
    return 0x1306c;
}

// Address range: 0x113a4 - 0x113b0
int32_t function_113a4(void) {
    // 0x113a4
    return g3;
}

// Address range: 0x113b4 - 0x113c0
int32_t function_113b4(int32_t a1) {
    // 0x113b4
    return _fcloseall();
}

// Address range: 0x113c0 - 0x113d8
int32_t function_113c0(int32_t uExitCode) {
    // 0x113c0
    function_113b4(uExitCode);
    TerminateProcess((int32_t *)66, uExitCode);
    while (true) {
        // continue -> 0x113d4
    }
}

// Address range: 0x113d8 - 0x113e4
int32_t function_113d8(void) {
    // 0x113d8
    int32_t v1; // 0x113d8
    return function_113b4(v1);
}

// Address range: 0x113e4 - 0x11458
int32_t function_113e4(int32_t a1, int32_t * a2, int32_t * a3) {
    // 0x113e4
    if (a2 == NULL || a3 == NULL) {
        // 0x11450
        return 0;
    }
    int32_t v1 = (int32_t)a3 - (int32_t)a2; // 0x11414
    if (v1 < 0) {
        // 0x11450
        return 0;
    }
    int32_t v2 = v1 + 4 & -4; // 0x11428
    int32_t * mem = realloc(a2, v2); // 0x11430
    int32_t result = 0; // 0x11438
    if (mem != NULL) {
        int32_t v3 = (int32_t)mem; // 0x11430
        *a2 = v3;
        int32_t v4 = v2 + v3;
        *a3 = v4;
        *(int32_t *)(v4 - 4) = a1;
        result = a1;
    }
    // 0x11450
    return result;
}

// Address range: 0x11458 - 0x1146c
int32_t function_11458(void) {
    // 0x11458
    int32_t v1; // 0x11458
    return function_113e4(v1, &g3, &g4);
}

// Address range: 0x11474 - 0x11494
int32_t function_11474(void) {
    // 0x11474
    int32_t v1; // 0x11474
    return function_113e4(v1, &g3, &g4) == 0;
}

// Address range: 0x1149c - 0x1150c
int32_t function_1149c(void) {
    uint32_t v1 = g3; // 0x114a4
    if (v1 == 0) {
        // 0x11500
        return fflush(NULL);
    }
    uint32_t v2 = g4 - 4; // 0x114b8
    if (v1 >= v2 != v1 != v2) {
        int32_t v3 = g4 - 8; // 0x114c8
        while (v1 == v3 || v1 < v3) {
            // 0x114cc
            v3 -= 4;
        }
    }
    // 0x114f0
    free((int32_t *)v1);
    g3 = 0;
    // 0x11500
    return fflush(NULL);
}

// Address range: 0x11514 - 0x11524
int32_t function_11514(void) {
    // 0x11514
    return function_113b4(function_1149c());
}

// Address range: 0x11524 - 0x1153c
int32_t function_11524(int32_t uExitCode) {
    // 0x11524
    function_11514();
    TerminateProcess((int32_t *)66, uExitCode);
    while (true) {
        // continue -> 0x11538
    }
}

// Address range: 0x1153c - 0x11570
int32_t function_1153c(void) {
    int32_t * mem = malloc(128); // 0x11544
    int32_t result = (int32_t)mem; // 0x11544
    g3 = result;
    if (mem == NULL) {
        return result;
    }
    // 0x11558
    *mem = 0;
    g4 = result;
    return 1;
}

// Address range: 0x11578 - 0x115b8
int32_t function_11578(void) {
    // 0x11578
    int32_t result; // 0x11578
    return result;
}

// Address range: 0x115bc - 0x1161c
int32_t function_115bc(void) {
    int32_t v1 = &g1; // 0x115d4
    while (*(int32_t *)(v1 + 4) != 0) {
        // 0x115d8
        v1 += 4;
    }
    // 0x11610
    return function_11474();
}

// Address range: 0x11624 - 0x11648
int32_t function_11624(void) {
    // 0x11624
    if (g5 != 0) {
        int32_t result; // 0x11624
        return result;
    }
    // 0x11638
    g5 = 1;
    return function_115bc();
}

// Address range: 0x1164c - 0x11890
int32_t function_1164c(int32_t a1, int32_t a2, int32_t wstr) {
    // 0x1164c
    int32_t v1; // bp-28, 0x1164c
    *(int16_t *)((int32_t)&v1 - 1024) = 0;
    int32_t lpFilename; // bp-1052, 0x1164c
    int32_t v2 = GetModuleFileNameW(NULL, (int16_t *)&lpFilename, 512); // 0x11670
    int32_t v3 = 0; // 0x11680
    if (wstr != 0) {
        // 0x11684
        v3 = wcslen((int16_t *)wstr);
    }
    int32_t * mem = malloc(v2 + 2 + v3); // 0x11698
    int32_t v4 = (int32_t)mem; // 0x11698
    if (mem == NULL) {
        // 0x116a4
        TerminateProcess((int32_t *)(v4 + 66), -1);
        while (true) {
            // continue -> 0x116b0
        }
    }
    int32_t * mem2 = malloc(4); // 0x116b8
    int32_t v5 = (int32_t)mem2; // 0x116b8
    g7 = v5;
    if (mem2 == NULL) {
        // 0x116cc
        TerminateProcess((int32_t *)(v5 + 66), -1);
        while (true) {
            // continue -> 0x116d8
        }
    }
    // 0x116dc
    *mem2 = v4;
    int32_t v6 = wcslen((int16_t *)&lpFilename); // 0x116e8
    wcstombs((char *)mem, (int16_t *)&lpFilename, v6 + 1);
    int32_t v7 = g6 + 1; // 0x11704
    g6 = v7;
    int32_t v8 = v7; // 0x11710
    if (v3 < 1) {
        goto lab_0x11864;
    } else {
        int32_t str = *(int32_t *)g7; // 0x1171c
        int32_t v9 = str + 1 + strlen((char *)str); // 0x1172c
        char * dest = (char *)v9; // 0x1173c
        wcstombs(dest, (int16_t *)wstr, v3 + 1);
        int32_t v10 = strlen(dest) + v9; // 0x11748
        int32_t v11 = 1; // 0x11750
        if (v9 == 0) {
            // 0x11858
            g6 = 1;
            v8 = 1;
            goto lab_0x11864;
        } else {
            int32_t str2 = v9;
            int32_t v12 = strspn((char *)str2, " \t\r\n") + str2; // 0x11764
            char * str4 = (char *)v12; // 0x11768
            char c = *str4; // 0x11768
            int32_t v13 = v11; // 0x11770
            while (c != 0) {
                // 0x11774
                int32_t v14; // 0x1164c
                int32_t v15 = c == 34 ? v14 : (int32_t)(c == 34 ? 0 : c);
                int32_t v16; // 0x1164c
                int32_t v17; // 0x1164c
                if (c == 34) {
                    int32_t str3 = v12 + 1; // 0x117b8
                    char * found_char_pos = strchr((char *)str3, (int32_t)c); // 0x117c8
                    v16 = found_char_pos == NULL ? v10 : (int32_t)found_char_pos;
                    v17 = str3;
                } else {
                    int32_t v18 = (int32_t)"\"'" + 1; // 0x117a8
                    char v19 = *(char *)v18; // 0x117a8
                    while (v19 != 0) {
                        // 0x11798
                        if (v15 == (int32_t)v19) {
                            goto lab_0x117b8;
                        }
                        v18++;
                        v19 = *(char *)v18;
                    }
                    // 0x117d8
                    v16 = strcspn(str4, " \t\r\n") + v12;
                    v17 = v12;
                }
                // 0x117e8
                *(char *)v16 = 0;
                int32_t v20 = v11 + 1; // 0x117f0
                int32_t v21 = 4 * v20; // 0x117f8
                int32_t * mem3 = realloc((int32_t *)g7, v21); // 0x11804
                if (mem3 == NULL) {
                    // 0x11848
                    g6 = -1;
                    goto lab_0x11838;
                }
                int32_t v22 = (int32_t)mem3; // 0x11804
                g7 = v22;
                *(int32_t *)(v21 - 4 + v22) = v17;
                v11 = v20;
                v14 = v15;
                v13 = v20;
                if (v16 == v10) {
                    // break -> 0x11828
                    break;
                }
                str2 = v16 + 1;
                v12 = strspn((char *)str2, " \t\r\n") + str2;
                str4 = (char *)v12;
                c = *str4;
                v13 = v11;
            }
            // 0x11828
            g6 = v13;
            v8 = v13;
            if (v13 < 0) {
                goto lab_0x11838;
            } else {
                goto lab_0x11864;
            }
        }
    }
  lab_0x11864:
    // 0x11864
    *(int32_t *)(g7 + 4 * v8) = 0;
    return function_112f4(g6, g7, g7);
  lab_0x11838:
    // 0x11838
    TerminateProcess((int32_t *)66, -1);
    while (true) {
        // continue -> 0x11844
    }
}

// Address range: 0x118a4 - 0x118ac
void function_118a4(void) {
    // 0x118a4
    _fpreset();
}

// Address range: 0x118b0 - 0x118b8
bool function_118b0(int32_t * hProcess, int32_t uExitCode) {
    // 0x118b0
    return TerminateProcess(hProcess, uExitCode);
}

// Address range: 0x118bc - 0x118c4
int32_t function_118bc(char * format, ...) {
    // 0x118bc
    return scanf(format);
}

// Address range: 0x118c8 - 0x118d0
int32_t function_118c8(char * s) {
    // 0x118c8
    return strlen(s);
}

// Address range: 0x118d4 - 0x118dc
int32_t function_118d4(char * s, char * format, ...) {
    // 0x118d4
    return sscanf(s, format);
}

// Address range: 0x118e0 - 0x118e8
int32_t function_118e0(char * s) {
    // 0x118e0
    return puts(s);
}

// Address range: 0x118ec - 0x118f4
int32_t function_118ec(char * format, ...) {
    // 0x118ec
    return printf(format);
}

// Address range: 0x118f8 - 0x11900
int32_t function_118f8(char * s1, char * s2, int32_t n) {
    // 0x118f8
    return strncmp(s1, s2, n);
}

// Address range: 0x11904 - 0x1190c
int32_t * function_11904(int32_t size) {
    // 0x11904
    return malloc(size);
}

// Address range: 0x11910 - 0x11918
void function_11910(int32_t * ptr) {
    // 0x11910
    free(ptr);
}

// Address range: 0x1191c - 0x11924
int32_t function_1191c(struct _IO_FILE * stream) {
    // 0x1191c
    return fflush(stream);
}

// Address range: 0x11928 - 0x11930
int32_t * function_11928(int32_t * ptr, int32_t size) {
    // 0x11928
    return realloc(ptr, size);
}

// Address range: 0x11934 - 0x1193c
int32_t function_11934(void) {
    // 0x11934
    return _fcloseall();
}

// Address range: 0x11940 - 0x11948
int32_t function_11940(char * s, char * accept) {
    // 0x11940
    return strspn(s, accept);
}

// Address range: 0x1194c - 0x11954
char * function_1194c(char * s, int32_t c) {
    // 0x1194c
    return strchr(s, c);
}

// Address range: 0x11958 - 0x11960
int32_t function_11958(char * s, char * reject) {
    // 0x11958
    return strcspn(s, reject);
}

// Address range: 0x11964 - 0x1196c
int32_t function_11964(int32_t * hModule, int16_t * lpFilename, int32_t nSize) {
    // 0x11964
    return GetModuleFileNameW(hModule, lpFilename, nSize);
}

// Address range: 0x11970 - 0x11978
int32_t function_11970(int16_t * s) {
    // 0x11970
    return wcslen(s);
}

// Address range: 0x1197c - 0x11984
int32_t function_1197c(char * s, int16_t * pwcs, int32_t n) {
    // 0x1197c
    return wcstombs(s, pwcs, n);
}

// --------------- Dynamically Linked Functions ---------------

// int __cdecl _fcloseall(void);
// void __cdecl _fpreset(void);
// int fflush(FILE * stream);
// void free(void * ptr);
// DWORD GetModuleFileNameW(_In_opt_ HMODULE hModule, LPWSTR lpFilename, _In_ DWORD nSize);
// void * malloc(size_t size);
// int printf(const char * restrict format, ...);
// int puts(const char * s);
// void * realloc(void * ptr, size_t size);
// int scanf(const char * restrict format, ...);
// int sscanf(const char * restrict s, const char * restrict format, ...);
// char * strchr(char * s, int c);
// size_t strcspn(const char * s, const char * reject);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// size_t strspn(const char * s, const char * accept);
// BOOL TerminateProcess(_In_ HANDLE hProcess, _In_ UINT uExitCode);
// size_t wcslen(const wchar_t * s);
// size_t wcstombs(char * restrict s, const wchar_t * restrict pwcs, size_t n);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft
// Detected functions: 41

